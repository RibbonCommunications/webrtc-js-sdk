{"version":3,"file":"webrtc.js","mappings":"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EAAAA,YAAG88C,EAAa,SACT98C,EAAAA,mBAAG88C,EAAa,gBAErB98C,EAAAA,cAAG88C,EAAa,WAErB98C,EAAAA,SAAG88C,EAAa,MACT98C,EAAAA,gBAAG88C,EAAa,aAEnB98C,EAAAA,aAAG88C,EAAa,eACT98C,EAAAA,oBAAG88C,EAAa,sBAElB98C,EAAAA,kBAAG88C,EAAa,oBAMtB98C,EAAAA,YAAG88C,EAAa,cAElB98C,EAAAA,UAAG88C,EAAa,OACT98C,EAAAA,iBAAG88C,EAAa,cAErB98C,EAAAA,YAAG88C,EAAa,SACT98C,EAAAA,mBAAG88C,EAAa,gBAEb98C,EAAAA,sBAAG88C,EAAa,wBAEf98C,EAAAA,uBAAG88C,EAAa,yBACT98C,EAAAA,8BAAG88C,EAAa,gCAEpC98C,EAAAA,UAAG88C,EAAa,YACT98C,EAAAA,iBAAG88C,EAAa,mBACjB98C,EAAAA,gBAAG88C,EAAa,kBAEnB98C,EAAAA,aAAG88C,EAAa,eACT98C,EAAAA,oBAAG88C,EAAa,sBACjB98C,EAAAA,mBAAG88C,EAAa,qBAErB98C,EAAAA,cAAG88C,EAAa,gBAEpB98C,EAAAA,UAAG88C,EAAa,YACT98C,EAAAA,iBAAG88C,EAAa,mBAEvB98C,EAAAA,UAAG88C,EAAa,YACT98C,EAAAA,iBAAG88C,EAAa,mBAEX98C,EAAAA,sBAAG88C,EAAa,wBACR98C,EAAAA,8BAAG88C,EAAa,gCACjB98C,EAAAA,6BAAG88C,EAAa,+BAE7B98C,EAAAA,gBAAG88C,EAAa,kBACT98C,EAAAA,uBAAG88C,EAAa,yBAElC98C,EAAAA,KAAG88C,EAAa,OACV98C,EAAAA,WAAG88C,EAAa,aACd98C,EAAAA,aAAG88C,EAAa,eACjB98C,EAAAA,YAAG88C,EAAa,cAEd98C,EAAAA,cAAG88C,EAAa,gBACT98C,EAAAA,qBAAG88C,EAAa,uBAEvB98C,EAAAA,cAAG88C,EAAa,gBACT98C,EAAAA,qBAAG88C,EAAa,uBAE9B98C,EAAAA,OAAG88C,EAAa,SACT98C,EAAAA,cAAG88C,EAAa,gBAEnB98C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","sources":["webpack://WebRTC/webpack/universalModuleDefinition","webpack://WebRTC/../core/basePlugins.js","webpack://WebRTC/../core/index.js","webpack://WebRTC/./index.js","webpack://WebRTC/../../packages/emitter/src/eventEmitter.js","webpack://WebRTC/../../packages/kandy/src/auth/constants.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/api.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/index.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/name.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/auth/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/auth/link/index.js","webpack://WebRTC/../../packages/kandy/src/auth/link/operations/index.js","webpack://WebRTC/../../packages/kandy/src/auth/link/operations/setCredentials.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/OperationTracker.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/StatusTracker.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/ConsultativeTransfer/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/DirectTransfer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/Join.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/LocalNegotiation/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/LocalOperation.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/RemoteCall.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/RemoteNegotiation.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/flows/RemoteUpdate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/models/MultiCall.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/models/Negotiation.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/models/Update.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/callManager/operationMap.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/middleware/callAudit.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/middleware/getSessions.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/middleware/iceCollectionCheck.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/middleware/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/middleware/normalizeIceFailure.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/consultativeTransfer/consultativeTransfer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/consultativeTransfer/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/consultativeTransfer/remoteFailure.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/consultativeTransfer/remoteSuccess.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/consultativeTransfer/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/join.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/joinedFailure.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/remoteFailure.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/remoteSuccess.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/complex/join/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/getAvailableCodecs/getAvailableCodecs.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/getAvailableCodecs/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/iceCollectionCheck/iceCollectionCheck.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/iceCollectionCheck/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/normalizeIceFailure/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/normalizeIceFailure/normalizeIceFailure.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/sendCallAudit/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/misc/sendCallAudit/sendCallAudit.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/local/addMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/local/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/local/validateBasic.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/remote/remoteOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/rollbackAddMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/addMedia/webrtcAddMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/directTransfer/directTransfer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/directTransfer/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/directTransfer/remoteFailure.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/directTransfer/remoteSuccess.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/directTransfer/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/genericRemote/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/genericRemote/remote/remoteOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/hold/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/hold/local/hold.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/hold/local/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/hold/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/hold/remote/remoteOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/hold/rollbackHold.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/iceRestart/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/iceRestart/local/iceRestart.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/iceRestart/local/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/iceRestart/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/local/make.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/local/receiveEarlyMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/local/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/remote/incomingCall.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/setupIncomingCall.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/make/setupOutgoingSession.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/musicOnHold/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/musicOnHold/remote/start.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/musicOnHold/remote/stop.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/local/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/local/removeMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/local/validateBasic.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/remote/remoteOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/rollbackRemoveMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/removeMedia/webrtcRemoveMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/slowStart/finish.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/slowStart/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/slowStart/start.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/unhold/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/unhold/local/remoteAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/unhold/local/unhold.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/unhold/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/unhold/remote/remoteOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/negotiations/unhold/rollbackUnhold.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/answerWebrtcSession.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/local/answer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/slow/remoteSlowAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/slow/slowAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/answer/slow/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/callCancelled/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/callCancelled/remote/callCancelled.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/end/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/end/local/end.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/end/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/end/remote/callStatusUpdateEnded.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/forward/forward.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/forward/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/forward/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/getStats/getStats.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/getStats/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/getStats/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/ignore/ignore.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/ignore/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/ignore/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/playAudioFile/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/playAudioFile/playAudio.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/playAudioFile/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/reject/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/reject/reject.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/reject/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/replaceTrack/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/replaceTrack/replaceTrack.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/replaceTrack/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/replaceTrack/webrtcReplaceTrack.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/resyncCallState/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/resyncCallState/resyncCallState.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/resyncCallState/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendCustomParameters/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendCustomParameters/sendCustomParameters.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendCustomParameters/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendDtmf/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendDtmf/playMethods.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendDtmf/sendDtmf.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendDtmf/tones.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendDtmf/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendRingingFeedback/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendRingingFeedback/local/sendRingingFeedback.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendRingingFeedback/local/validate.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/operations/updates/sendRingingFeedback/remote/callStatusUpdateRinging.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/reporter/constants.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/reporter/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/reporter/metricHandlers.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/handlers/changeDtlsRoleTo.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/handlers/modifySdpBandwidth.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/handlers/sanitizeSdesFromSdp.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/compareMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/compareSummary.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/constants.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/matchMedias.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/operations.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/remoteTracks.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/media/summarizeMedia.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/pipeline/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/pipeline/runDefault.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/pipeline/runYaml.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/pipeline/utils.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/utils/hasMediaFlowing.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/utils/hasTelephoneEvent.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/sdp/utils/setMediaInactive.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/utils/call.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/utils/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/utils/media.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/utils/remoteOperation/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/utils/utils.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/utils/webrtc.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/webrtc/establish/closeCall.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/webrtc/index.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/webrtc/media/createLocal.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/webrtc/negotiation/generateOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/webrtc/negotiation/handleOffer.js","webpack://WebRTC/../../packages/kandy/src/call/callstack/webrtc/negotiation/receivedAnswer.js","webpack://WebRTC/../../packages/kandy/src/call/configs.js","webpack://WebRTC/../../packages/kandy/src/call/constants.js","webpack://WebRTC/../../packages/kandy/src/call/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/call/interface/actions/call.js","webpack://WebRTC/../../packages/kandy/src/call/interface/actions/index.js","webpack://WebRTC/../../packages/kandy/src/call/interface/actions/turn.js","webpack://WebRTC/../../packages/kandy/src/call/interface/api/complex.js","webpack://WebRTC/../../packages/kandy/src/call/interface/api/constants.js","webpack://WebRTC/../../packages/kandy/src/call/interface/api/establish.js","webpack://WebRTC/../../packages/kandy/src/call/interface/api/index.js","webpack://WebRTC/../../packages/kandy/src/call/interface/api/midcall.js","webpack://WebRTC/../../packages/kandy/src/call/interface/api/misc.js","webpack://WebRTC/../../packages/kandy/src/call/interface/constants.js","webpack://WebRTC/../../packages/kandy/src/call/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/call/interface/index.js","webpack://WebRTC/../../packages/kandy/src/call/interface/reducers/call.js","webpack://WebRTC/../../packages/kandy/src/call/interface/reducers/index.js","webpack://WebRTC/../../packages/kandy/src/call/interface/reducers/operations.js","webpack://WebRTC/../../packages/kandy/src/call/interface/reducers/turn.js","webpack://WebRTC/../../packages/kandy/src/call/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/call/interface/utils.js","webpack://WebRTC/../../packages/kandy/src/call/link/index.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/callCancelledNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/callStatusUpdateEndedNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/callStatusUpdateFailedNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/callStatusUpdateRingingNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/incomingCallNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/index.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/remoteAnswerNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/remoteOfferNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/resyncSessionStatuses.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/sessionProgressNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/sessionStatusUpdateEndedNotification.js","webpack://WebRTC/../../packages/kandy/src/call/link/middleware/setTurnCredentials.js","webpack://WebRTC/../../packages/kandy/src/call/link/operations/index.js","webpack://WebRTC/../../packages/kandy/src/call/link/operations/setTurnCredentials/index.js","webpack://WebRTC/../../packages/kandy/src/call/link/operations/setTurnCredentials/setTurnCredentials.js","webpack://WebRTC/../../packages/kandy/src/call/link/requests/complex.js","webpack://WebRTC/../../packages/kandy/src/call/link/requests/establish.js","webpack://WebRTC/../../packages/kandy/src/call/link/requests/index.js","webpack://WebRTC/../../packages/kandy/src/call/link/requests/misc.js","webpack://WebRTC/../../packages/kandy/src/call/link/requests/negotiation.js","webpack://WebRTC/../../packages/kandy/src/call/link/requests/utils.js","webpack://WebRTC/../../packages/kandy/src/call/link/utils.js","webpack://WebRTC/../../packages/kandy/src/call/utils/codecRemover.js","webpack://WebRTC/../../packages/kandy/src/call/utils/defaults.js","webpack://WebRTC/../../packages/kandy/src/call/utils/normalization.js","webpack://WebRTC/../../packages/kandy/src/call/utils/state.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/api.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/callHistory/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/fetch/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/fetch/operation.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/fetch/request.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/remove/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/remove/operation.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/remove/request.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/setCache/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/setCache/operation.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/storeLog/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/features/storeLog/operation.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/index.js","webpack://WebRTC/../../packages/kandy/src/callHistory/link/middleware.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/api.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/index.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/link/index.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/link/operations.js","webpack://WebRTC/../../packages/kandy/src/clickToCall/link/requests.js","webpack://WebRTC/../../packages/kandy/src/common/helpers/intervalFactory.js","webpack://WebRTC/../../packages/kandy/src/common/sdkId.js","webpack://WebRTC/../../packages/kandy/src/common/utils.js","webpack://WebRTC/../../packages/kandy/src/common/validation/index.js","webpack://WebRTC/../../packages/kandy/src/common/version.js","webpack://WebRTC/../../packages/kandy/src/config/index.js","webpack://WebRTC/../../packages/kandy/src/config/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/config/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/config/interface/api.js","webpack://WebRTC/../../packages/kandy/src/config/interface/index.js","webpack://WebRTC/../../packages/kandy/src/config/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/config/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/connectivity/common/websocket.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/api.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/index.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/name.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/connectivity/interface/utils.js","webpack://WebRTC/../../packages/kandy/src/connectivity/plugin/configs.js","webpack://WebRTC/../../packages/kandy/src/connectivity/plugin/index.js","webpack://WebRTC/../../packages/kandy/src/connectivity/plugin/operations.js","webpack://WebRTC/../../packages/kandy/src/connectivity/plugin/utils.js","webpack://WebRTC/../../packages/kandy/src/connectivity/wsManager/constants.js","webpack://WebRTC/../../packages/kandy/src/connectivity/wsManager/index.js","webpack://WebRTC/../../packages/kandy/src/constants.js","webpack://WebRTC/../../packages/kandy/src/errors/codes.js","webpack://WebRTC/../../packages/kandy/src/errors/index.js","webpack://WebRTC/../../packages/kandy/src/events/index.js","webpack://WebRTC/../../packages/kandy/src/events/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/events/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/events/interface/api.js","webpack://WebRTC/../../packages/kandy/src/events/interface/index.js","webpack://WebRTC/../../packages/kandy/src/events/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/factory.js","webpack://WebRTC/../../packages/kandy/src/logs/actions/actionHandler.js","webpack://WebRTC/../../packages/kandy/src/logs/actions/index.js","webpack://WebRTC/../../packages/kandy/src/logs/actions/transformers.js","webpack://WebRTC/../../packages/kandy/src/logs/actions/utils.js","webpack://WebRTC/../../packages/kandy/src/logs/config.js","webpack://WebRTC/../../packages/kandy/src/logs/index.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/api.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/index.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/logs/interface/utils.js","webpack://WebRTC/../../packages/kandy/src/logs/operations.js","webpack://WebRTC/../../packages/kandy/src/logs/plugin.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/actions/conversations.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/actions/index.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/actions/messages.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/api.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/index.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/mixins.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/messaging/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/messaging/link/index.js","webpack://WebRTC/../../packages/kandy/src/messaging/link/middleware.js","webpack://WebRTC/../../packages/kandy/src/messaging/link/operations.js","webpack://WebRTC/../../packages/kandy/src/messaging/link/requests.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/api.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/index.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/mwi/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/mwi/link/index.js","webpack://WebRTC/../../packages/kandy/src/mwi/link/middleware.js","webpack://WebRTC/../../packages/kandy/src/mwi/link/operations.js","webpack://WebRTC/../../packages/kandy/src/mwi/link/requests.js","webpack://WebRTC/../../packages/kandy/src/mwi/link/utils.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/api.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/index.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/notifications/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/index.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/index.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/notification/enableWebsocketChannel.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/notification/index.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/notification/processNotification.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/pushRegistration/index.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/pushRegistration/registerPushDeviceToken.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/operations/pushRegistration/unregisterPushDeviceToken.js","webpack://WebRTC/../../packages/kandy/src/notifications/link/requests.js","webpack://WebRTC/../../packages/kandy/src/notifications/middleware.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/api.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/index.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/presence/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/presence/link/constants.js","webpack://WebRTC/../../packages/kandy/src/presence/link/index.js","webpack://WebRTC/../../packages/kandy/src/presence/link/middleware.js","webpack://WebRTC/../../packages/kandy/src/presence/link/operations.js","webpack://WebRTC/../../packages/kandy/src/presence/link/requests.js","webpack://WebRTC/../../packages/kandy/src/request/authorization.js","webpack://WebRTC/../../packages/kandy/src/request/configs.js","webpack://WebRTC/../../packages/kandy/src/request/index.js","webpack://WebRTC/../../packages/kandy/src/request/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/request/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/request/interface/api.js","webpack://WebRTC/../../packages/kandy/src/request/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/request/interface/index.js","webpack://WebRTC/../../packages/kandy/src/request/interface/name.js","webpack://WebRTC/../../packages/kandy/src/request/makeRequest.js","webpack://WebRTC/../../packages/kandy/src/request/requestModule.js","webpack://WebRTC/../../packages/kandy/src/request/utils/index.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/index.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/api.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/index.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/reducer.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/intervals.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/operations.js","webpack://WebRTC/../../packages/kandy/src/sipEvents/requests.js","webpack://WebRTC/../../packages/kandy/src/subscription/constants.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/api.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/subscription/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/onConnectionLost/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/onConnectionLost/onConnectionLost.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/onSubscriptionGone/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/onSubscriptionGone/onSubscriptionGone.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/onWebsocketOverridden/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/onWebsocketOverridden/onWebsocketOverridden.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/services.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/subscribe/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/subscribe/operation.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/subscribe/request.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/subscribe/subscribeFlow.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/unsubscribe/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/unsubscribe/operation.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/unsubscribe/request.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/unsubscribe/unsubscribeFlow.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/update/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/update/operation.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/features/update/request.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/intervals/index.js","webpack://WebRTC/../../packages/kandy/src/subscription/link/intervals/resubscribe.js","webpack://WebRTC/../../packages/kandy/src/users/interface/actions/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/users/interface/actions/contacts.js","webpack://WebRTC/../../packages/kandy/src/users/interface/actions/users.js","webpack://WebRTC/../../packages/kandy/src/users/interface/api/contacts.js","webpack://WebRTC/../../packages/kandy/src/users/interface/api/index.js","webpack://WebRTC/../../packages/kandy/src/users/interface/api/users.js","webpack://WebRTC/../../packages/kandy/src/users/interface/events/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/users/interface/index.js","webpack://WebRTC/../../packages/kandy/src/users/interface/reducers/contacts.js","webpack://WebRTC/../../packages/kandy/src/users/interface/reducers/index.js","webpack://WebRTC/../../packages/kandy/src/users/interface/reducers/users.js","webpack://WebRTC/../../packages/kandy/src/users/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/users/link/index.js","webpack://WebRTC/../../packages/kandy/src/users/link/operations.js","webpack://WebRTC/../../packages/kandy/src/users/link/requests.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/devices.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/index.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/media.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/mediaManager.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/session.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/sessionManager.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/track.js","webpack://WebRTC/../../packages/kandy/src/webrtc/channels/trackManager.js","webpack://WebRTC/../../packages/kandy/src/webrtc/index.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actions/devices.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actions/index.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actions/media.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actions/misc.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actions/sessions.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/actions/tracks.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/api/index.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/api/media.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/index.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/reducers/browser.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/reducers/devices.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/reducers/index.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/reducers/media.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/reducers/sessions.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/reducers/tracks.js","webpack://WebRTC/../../packages/kandy/src/webrtc/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/webrtc/middleware.js","webpack://WebRTC/../../packages/kandy/src/webrtc/operations/logs.js","webpack://WebRTC/../../packages/kandy/src/webrtc/operations/media.js","webpack://WebRTC/../../packages/kandy/src/webrtc/operations/webrtc.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/channel.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/index.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/actionTypes.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/actions.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/api.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/eventTypes.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/index.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/reducers.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/interface/selectors.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/operations.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/proxies/manager.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/proxies/model.js","webpack://WebRTC/../../packages/kandy/src/webrtcProxy/proxyStack.js","webpack://WebRTC/../../packages/logger/src/constants.js","webpack://WebRTC/../../packages/logger/src/index.js","webpack://WebRTC/../../packages/logger/src/logFormatter.js","webpack://WebRTC/../../packages/logger/src/logHandler.js","webpack://WebRTC/../../packages/logger/src/logManager.js","webpack://WebRTC/../../packages/logger/src/logger.js","webpack://WebRTC/../../packages/logger/src/timer.js","webpack://WebRTC/../../packages/logger/src/validation.js","webpack://WebRTC/../../packages/reporter/src/index.js","webpack://WebRTC/../../packages/reporter/src/report.js","webpack://WebRTC/../../packages/reporter/src/reporter.js","webpack://WebRTC/../../packages/reporter/src/timelineEvent.js","webpack://WebRTC/../../packages/webrtc/src/Peer/config.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/icecandidate.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/iceconnectionstatechange.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/icegatheringstatechange.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/index.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/negotiationneeded.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/signalingstatechange.js","webpack://WebRTC/../../packages/webrtc/src/Peer/events/track.js","webpack://WebRTC/../../packages/webrtc/src/Peer/index.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/addIceCandidate.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/addTransceiver.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/close.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/createAnswer.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/createOffer.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/findReusableTransceiver.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/getState.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/getStats.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/getTransceivers.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/index.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/removeTrack.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/replaceTrack.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/sendDTMF.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/setLocalDescription.js","webpack://WebRTC/../../packages/webrtc/src/Peer/methods/setRemoteDescription.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/index.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/localDescription.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/localTracks.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/remoteDescription.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/remoteTracks.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/remoteTracksActive.js","webpack://WebRTC/../../packages/webrtc/src/Peer/properties/senderTracks.js","webpack://WebRTC/../../packages/webrtc/src/Peer/utils/iceCollectionScheduledCheck.js","webpack://WebRTC/../../packages/webrtc/src/Peer/utils/timer.js","webpack://WebRTC/../../packages/webrtc/src/constants.js","webpack://WebRTC/../../packages/webrtc/src/interface/index.js","webpack://WebRTC/../../packages/webrtc/src/logs.js","webpack://WebRTC/../../packages/webrtc/src/managers/deviceManager.js","webpack://WebRTC/../../packages/webrtc/src/managers/mediaManager.js","webpack://WebRTC/../../packages/webrtc/src/managers/peerManager.js","webpack://WebRTC/../../packages/webrtc/src/managers/renderer.js","webpack://WebRTC/../../packages/webrtc/src/managers/sessionManager.js","webpack://WebRTC/../../packages/webrtc/src/managers/trackManager.js","webpack://WebRTC/../../packages/webrtc/src/managers/webrtcManager.js","webpack://WebRTC/../../packages/webrtc/src/models/media.js","webpack://WebRTC/../../packages/webrtc/src/models/session.js","webpack://WebRTC/../../packages/webrtc/src/models/track.js","webpack://WebRTC/../../packages/webrtc/src/sdpUtils/extractors.js","webpack://WebRTC/../../packages/webrtc/src/sdpUtils/handlers.js","webpack://WebRTC/../../packages/webrtc/src/sdpUtils/pipeline.js","webpack://WebRTC/../../packages/webrtc/src/sdpUtils/transceiverUtils.js","webpack://WebRTC/../../packages/webrtc/src/utils.js","webpack://WebRTC/../../utilities/mergeValues/index.js","webpack://WebRTC/../../utilities/toQueryString/index.js","webpack://WebRTC/../../node_modules/base-64/base64.js","webpack://WebRTC/../../node_modules/bottlejs/dist/bottle-es.js","webpack://WebRTC/../../node_modules/chalk/node_modules/ansi-styles/index.js","webpack://WebRTC/../../node_modules/chalk/node_modules/color-convert/conversions.js","webpack://WebRTC/../../node_modules/chalk/node_modules/color-convert/index.js","webpack://WebRTC/../../node_modules/chalk/node_modules/color-convert/route.js","webpack://WebRTC/../../node_modules/chalk/node_modules/supports-color/browser.js","webpack://WebRTC/../../node_modules/chalk/source/index.js","webpack://WebRTC/../../node_modules/chalk/source/templates.js","webpack://WebRTC/../../node_modules/chalk/source/util.js","webpack://WebRTC/../../node_modules/color-name/index.js","webpack://WebRTC/../../node_modules/decode-uri-component/index.js","webpack://WebRTC/../../node_modules/filter-obj/index.js","webpack://WebRTC/../../node_modules/invariant/browser.js","webpack://WebRTC/../../node_modules/just-curry-it/index.js","webpack://WebRTC/../../node_modules/lodash/_DataView.js","webpack://WebRTC/../../node_modules/lodash/_Hash.js","webpack://WebRTC/../../node_modules/lodash/_LazyWrapper.js","webpack://WebRTC/../../node_modules/lodash/_ListCache.js","webpack://WebRTC/../../node_modules/lodash/_LodashWrapper.js","webpack://WebRTC/../../node_modules/lodash/_Map.js","webpack://WebRTC/../../node_modules/lodash/_MapCache.js","webpack://WebRTC/../../node_modules/lodash/_Promise.js","webpack://WebRTC/../../node_modules/lodash/_Set.js","webpack://WebRTC/../../node_modules/lodash/_SetCache.js","webpack://WebRTC/../../node_modules/lodash/_Stack.js","webpack://WebRTC/../../node_modules/lodash/_Symbol.js","webpack://WebRTC/../../node_modules/lodash/_Uint8Array.js","webpack://WebRTC/../../node_modules/lodash/_WeakMap.js","webpack://WebRTC/../../node_modules/lodash/_apply.js","webpack://WebRTC/../../node_modules/lodash/_arrayEach.js","webpack://WebRTC/../../node_modules/lodash/_arrayFilter.js","webpack://WebRTC/../../node_modules/lodash/_arrayIncludes.js","webpack://WebRTC/../../node_modules/lodash/_arrayIncludesWith.js","webpack://WebRTC/../../node_modules/lodash/_arrayLikeKeys.js","webpack://WebRTC/../../node_modules/lodash/_arrayMap.js","webpack://WebRTC/../../node_modules/lodash/_arrayPush.js","webpack://WebRTC/../../node_modules/lodash/_arraySome.js","webpack://WebRTC/../../node_modules/lodash/_asciiToArray.js","webpack://WebRTC/../../node_modules/lodash/_assignMergeValue.js","webpack://WebRTC/../../node_modules/lodash/_assignValue.js","webpack://WebRTC/../../node_modules/lodash/_assocIndexOf.js","webpack://WebRTC/../../node_modules/lodash/_baseAssign.js","webpack://WebRTC/../../node_modules/lodash/_baseAssignIn.js","webpack://WebRTC/../../node_modules/lodash/_baseAssignValue.js","webpack://WebRTC/../../node_modules/lodash/_baseClone.js","webpack://WebRTC/../../node_modules/lodash/_baseCreate.js","webpack://WebRTC/../../node_modules/lodash/_baseDifference.js","webpack://WebRTC/../../node_modules/lodash/_baseEach.js","webpack://WebRTC/../../node_modules/lodash/_baseFindIndex.js","webpack://WebRTC/../../node_modules/lodash/_baseFlatten.js","webpack://WebRTC/../../node_modules/lodash/_baseFor.js","webpack://WebRTC/../../node_modules/lodash/_baseForOwn.js","webpack://WebRTC/../../node_modules/lodash/_baseGet.js","webpack://WebRTC/../../node_modules/lodash/_baseGetAllKeys.js","webpack://WebRTC/../../node_modules/lodash/_baseGetTag.js","webpack://WebRTC/../../node_modules/lodash/_baseHas.js","webpack://WebRTC/../../node_modules/lodash/_baseHasIn.js","webpack://WebRTC/../../node_modules/lodash/_baseIndexOf.js","webpack://WebRTC/../../node_modules/lodash/_baseIsArguments.js","webpack://WebRTC/../../node_modules/lodash/_baseIsEqual.js","webpack://WebRTC/../../node_modules/lodash/_baseIsEqualDeep.js","webpack://WebRTC/../../node_modules/lodash/_baseIsMap.js","webpack://WebRTC/../../node_modules/lodash/_baseIsMatch.js","webpack://WebRTC/../../node_modules/lodash/_baseIsNaN.js","webpack://WebRTC/../../node_modules/lodash/_baseIsNative.js","webpack://WebRTC/../../node_modules/lodash/_baseIsSet.js","webpack://WebRTC/../../node_modules/lodash/_baseIsTypedArray.js","webpack://WebRTC/../../node_modules/lodash/_baseIteratee.js","webpack://WebRTC/../../node_modules/lodash/_baseKeys.js","webpack://WebRTC/../../node_modules/lodash/_baseKeysIn.js","webpack://WebRTC/../../node_modules/lodash/_baseLodash.js","webpack://WebRTC/../../node_modules/lodash/_baseMap.js","webpack://WebRTC/../../node_modules/lodash/_baseMatches.js","webpack://WebRTC/../../node_modules/lodash/_baseMatchesProperty.js","webpack://WebRTC/../../node_modules/lodash/_baseMerge.js","webpack://WebRTC/../../node_modules/lodash/_baseMergeDeep.js","webpack://WebRTC/../../node_modules/lodash/_baseOrderBy.js","webpack://WebRTC/../../node_modules/lodash/_baseProperty.js","webpack://WebRTC/../../node_modules/lodash/_basePropertyDeep.js","webpack://WebRTC/../../node_modules/lodash/_basePullAt.js","webpack://WebRTC/../../node_modules/lodash/_baseRest.js","webpack://WebRTC/../../node_modules/lodash/_baseSet.js","webpack://WebRTC/../../node_modules/lodash/_baseSetData.js","webpack://WebRTC/../../node_modules/lodash/_baseSetToString.js","webpack://WebRTC/../../node_modules/lodash/_baseSlice.js","webpack://WebRTC/../../node_modules/lodash/_baseSortBy.js","webpack://WebRTC/../../node_modules/lodash/_baseTimes.js","webpack://WebRTC/../../node_modules/lodash/_baseToNumber.js","webpack://WebRTC/../../node_modules/lodash/_baseToString.js","webpack://WebRTC/../../node_modules/lodash/_baseTrim.js","webpack://WebRTC/../../node_modules/lodash/_baseUnary.js","webpack://WebRTC/../../node_modules/lodash/_baseUniq.js","webpack://WebRTC/../../node_modules/lodash/_baseUnset.js","webpack://WebRTC/../../node_modules/lodash/_baseUpdate.js","webpack://WebRTC/../../node_modules/lodash/_baseValues.js","webpack://WebRTC/../../node_modules/lodash/_cacheHas.js","webpack://WebRTC/../../node_modules/lodash/_castFunction.js","webpack://WebRTC/../../node_modules/lodash/_castPath.js","webpack://WebRTC/../../node_modules/lodash/_castSlice.js","webpack://WebRTC/../../node_modules/lodash/_charsEndIndex.js","webpack://WebRTC/../../node_modules/lodash/_charsStartIndex.js","webpack://WebRTC/../../node_modules/lodash/_cloneArrayBuffer.js","webpack://WebRTC/../../node_modules/lodash/_cloneBuffer.js","webpack://WebRTC/../../node_modules/lodash/_cloneDataView.js","webpack://WebRTC/../../node_modules/lodash/_cloneRegExp.js","webpack://WebRTC/../../node_modules/lodash/_cloneSymbol.js","webpack://WebRTC/../../node_modules/lodash/_cloneTypedArray.js","webpack://WebRTC/../../node_modules/lodash/_compareAscending.js","webpack://WebRTC/../../node_modules/lodash/_compareMultiple.js","webpack://WebRTC/../../node_modules/lodash/_composeArgs.js","webpack://WebRTC/../../node_modules/lodash/_composeArgsRight.js","webpack://WebRTC/../../node_modules/lodash/_copyArray.js","webpack://WebRTC/../../node_modules/lodash/_copyObject.js","webpack://WebRTC/../../node_modules/lodash/_copySymbols.js","webpack://WebRTC/../../node_modules/lodash/_copySymbolsIn.js","webpack://WebRTC/../../node_modules/lodash/_coreJsData.js","webpack://WebRTC/../../node_modules/lodash/_countHolders.js","webpack://WebRTC/../../node_modules/lodash/_createAssigner.js","webpack://WebRTC/../../node_modules/lodash/_createBaseEach.js","webpack://WebRTC/../../node_modules/lodash/_createBaseFor.js","webpack://WebRTC/../../node_modules/lodash/_createBind.js","webpack://WebRTC/../../node_modules/lodash/_createCtor.js","webpack://WebRTC/../../node_modules/lodash/_createCurry.js","webpack://WebRTC/../../node_modules/lodash/_createFind.js","webpack://WebRTC/../../node_modules/lodash/_createFlow.js","webpack://WebRTC/../../node_modules/lodash/_createHybrid.js","webpack://WebRTC/../../node_modules/lodash/_createMathOperation.js","webpack://WebRTC/../../node_modules/lodash/_createPartial.js","webpack://WebRTC/../../node_modules/lodash/_createRecurry.js","webpack://WebRTC/../../node_modules/lodash/_createSet.js","webpack://WebRTC/../../node_modules/lodash/_createWrap.js","webpack://WebRTC/../../node_modules/lodash/_customDefaultsMerge.js","webpack://WebRTC/../../node_modules/lodash/_customOmitClone.js","webpack://WebRTC/../../node_modules/lodash/_defineProperty.js","webpack://WebRTC/../../node_modules/lodash/_equalArrays.js","webpack://WebRTC/../../node_modules/lodash/_equalByTag.js","webpack://WebRTC/../../node_modules/lodash/_equalObjects.js","webpack://WebRTC/../../node_modules/lodash/_flatRest.js","webpack://WebRTC/../../node_modules/lodash/_freeGlobal.js","webpack://WebRTC/../../node_modules/lodash/_getAllKeys.js","webpack://WebRTC/../../node_modules/lodash/_getAllKeysIn.js","webpack://WebRTC/../../node_modules/lodash/_getData.js","webpack://WebRTC/../../node_modules/lodash/_getFuncName.js","webpack://WebRTC/../../node_modules/lodash/_getHolder.js","webpack://WebRTC/../../node_modules/lodash/_getMapData.js","webpack://WebRTC/../../node_modules/lodash/_getMatchData.js","webpack://WebRTC/../../node_modules/lodash/_getNative.js","webpack://WebRTC/../../node_modules/lodash/_getPrototype.js","webpack://WebRTC/../../node_modules/lodash/_getRawTag.js","webpack://WebRTC/../../node_modules/lodash/_getSymbols.js","webpack://WebRTC/../../node_modules/lodash/_getSymbolsIn.js","webpack://WebRTC/../../node_modules/lodash/_getTag.js","webpack://WebRTC/../../node_modules/lodash/_getValue.js","webpack://WebRTC/../../node_modules/lodash/_getWrapDetails.js","webpack://WebRTC/../../node_modules/lodash/_hasPath.js","webpack://WebRTC/../../node_modules/lodash/_hasUnicode.js","webpack://WebRTC/../../node_modules/lodash/_hashClear.js","webpack://WebRTC/../../node_modules/lodash/_hashDelete.js","webpack://WebRTC/../../node_modules/lodash/_hashGet.js","webpack://WebRTC/../../node_modules/lodash/_hashHas.js","webpack://WebRTC/../../node_modules/lodash/_hashSet.js","webpack://WebRTC/../../node_modules/lodash/_initCloneArray.js","webpack://WebRTC/../../node_modules/lodash/_initCloneByTag.js","webpack://WebRTC/../../node_modules/lodash/_initCloneObject.js","webpack://WebRTC/../../node_modules/lodash/_insertWrapDetails.js","webpack://WebRTC/../../node_modules/lodash/_isFlattenable.js","webpack://WebRTC/../../node_modules/lodash/_isIndex.js","webpack://WebRTC/../../node_modules/lodash/_isIterateeCall.js","webpack://WebRTC/../../node_modules/lodash/_isKey.js","webpack://WebRTC/../../node_modules/lodash/_isKeyable.js","webpack://WebRTC/../../node_modules/lodash/_isLaziable.js","webpack://WebRTC/../../node_modules/lodash/_isMasked.js","webpack://WebRTC/../../node_modules/lodash/_isPrototype.js","webpack://WebRTC/../../node_modules/lodash/_isStrictComparable.js","webpack://WebRTC/../../node_modules/lodash/_listCacheClear.js","webpack://WebRTC/../../node_modules/lodash/_listCacheDelete.js","webpack://WebRTC/../../node_modules/lodash/_listCacheGet.js","webpack://WebRTC/../../node_modules/lodash/_listCacheHas.js","webpack://WebRTC/../../node_modules/lodash/_listCacheSet.js","webpack://WebRTC/../../node_modules/lodash/_mapCacheClear.js","webpack://WebRTC/../../node_modules/lodash/_mapCacheDelete.js","webpack://WebRTC/../../node_modules/lodash/_mapCacheGet.js","webpack://WebRTC/../../node_modules/lodash/_mapCacheHas.js","webpack://WebRTC/../../node_modules/lodash/_mapCacheSet.js","webpack://WebRTC/../../node_modules/lodash/_mapToArray.js","webpack://WebRTC/../../node_modules/lodash/_matchesStrictComparable.js","webpack://WebRTC/../../node_modules/lodash/_memoizeCapped.js","webpack://WebRTC/../../node_modules/lodash/_mergeData.js","webpack://WebRTC/../../node_modules/lodash/_metaMap.js","webpack://WebRTC/../../node_modules/lodash/_nativeCreate.js","webpack://WebRTC/../../node_modules/lodash/_nativeKeys.js","webpack://WebRTC/../../node_modules/lodash/_nativeKeysIn.js","webpack://WebRTC/../../node_modules/lodash/_nodeUtil.js","webpack://WebRTC/../../node_modules/lodash/_objectToString.js","webpack://WebRTC/../../node_modules/lodash/_overArg.js","webpack://WebRTC/../../node_modules/lodash/_overRest.js","webpack://WebRTC/../../node_modules/lodash/_parent.js","webpack://WebRTC/../../node_modules/lodash/_realNames.js","webpack://WebRTC/../../node_modules/lodash/_reorder.js","webpack://WebRTC/../../node_modules/lodash/_replaceHolders.js","webpack://WebRTC/../../node_modules/lodash/_root.js","webpack://WebRTC/../../node_modules/lodash/_safeGet.js","webpack://WebRTC/../../node_modules/lodash/_setCacheAdd.js","webpack://WebRTC/../../node_modules/lodash/_setCacheHas.js","webpack://WebRTC/../../node_modules/lodash/_setData.js","webpack://WebRTC/../../node_modules/lodash/_setToArray.js","webpack://WebRTC/../../node_modules/lodash/_setToString.js","webpack://WebRTC/../../node_modules/lodash/_setWrapToString.js","webpack://WebRTC/../../node_modules/lodash/_shortOut.js","webpack://WebRTC/../../node_modules/lodash/_stackClear.js","webpack://WebRTC/../../node_modules/lodash/_stackDelete.js","webpack://WebRTC/../../node_modules/lodash/_stackGet.js","webpack://WebRTC/../../node_modules/lodash/_stackHas.js","webpack://WebRTC/../../node_modules/lodash/_stackSet.js","webpack://WebRTC/../../node_modules/lodash/_strictIndexOf.js","webpack://WebRTC/../../node_modules/lodash/_stringToArray.js","webpack://WebRTC/../../node_modules/lodash/_stringToPath.js","webpack://WebRTC/../../node_modules/lodash/_toKey.js","webpack://WebRTC/../../node_modules/lodash/_toSource.js","webpack://WebRTC/../../node_modules/lodash/_trimmedEndIndex.js","webpack://WebRTC/../../node_modules/lodash/_unicodeToArray.js","webpack://WebRTC/../../node_modules/lodash/_updateWrapDetails.js","webpack://WebRTC/../../node_modules/lodash/_wrapperClone.js","webpack://WebRTC/../../node_modules/lodash/add.js","webpack://WebRTC/../../node_modules/lodash/ary.js","webpack://WebRTC/../../node_modules/lodash/clone.js","webpack://WebRTC/../../node_modules/lodash/cloneDeep.js","webpack://WebRTC/../../node_modules/lodash/concat.js","webpack://WebRTC/../../node_modules/lodash/constant.js","webpack://WebRTC/../../node_modules/lodash/curry.js","webpack://WebRTC/../../node_modules/lodash/debounce.js","webpack://WebRTC/../../node_modules/lodash/defaults.js","webpack://WebRTC/../../node_modules/lodash/defaultsDeep.js","webpack://WebRTC/../../node_modules/lodash/difference.js","webpack://WebRTC/../../node_modules/lodash/eq.js","webpack://WebRTC/../../node_modules/lodash/find.js","webpack://WebRTC/../../node_modules/lodash/findIndex.js","webpack://WebRTC/../../node_modules/lodash/flatMap.js","webpack://WebRTC/../../node_modules/lodash/flatten.js","webpack://WebRTC/../../node_modules/lodash/flowRight.js","webpack://WebRTC/../../node_modules/lodash/fp/__.js","webpack://WebRTC/../../node_modules/lodash/fp/_baseConvert.js","webpack://WebRTC/../../node_modules/lodash/fp/_falseOptions.js","webpack://WebRTC/../../node_modules/lodash/fp/_mapping.js","webpack://WebRTC/../../node_modules/lodash/fp/_util.js","webpack://WebRTC/../../node_modules/lodash/fp/add.js","webpack://WebRTC/../../node_modules/lodash/fp/cloneDeep.js","webpack://WebRTC/../../node_modules/lodash/fp/compose.js","webpack://WebRTC/../../node_modules/lodash/fp/concat.js","webpack://WebRTC/../../node_modules/lodash/fp/contains.js","webpack://WebRTC/../../node_modules/lodash/fp/convert.js","webpack://WebRTC/../../node_modules/lodash/fp/debounce.js","webpack://WebRTC/../../node_modules/lodash/fp/defaults.js","webpack://WebRTC/../../node_modules/lodash/fp/defaultsDeep.js","webpack://WebRTC/../../node_modules/lodash/fp/difference.js","webpack://WebRTC/../../node_modules/lodash/fp/find.js","webpack://WebRTC/../../node_modules/lodash/fp/flatMap.js","webpack://WebRTC/../../node_modules/lodash/fp/flowRight.js","webpack://WebRTC/../../node_modules/lodash/fp/has.js","webpack://WebRTC/../../node_modules/lodash/fp/includes.js","webpack://WebRTC/../../node_modules/lodash/fp/isArray.js","webpack://WebRTC/../../node_modules/lodash/fp/isElement.js","webpack://WebRTC/../../node_modules/lodash/fp/isEmpty.js","webpack://WebRTC/../../node_modules/lodash/fp/isEqual.js","webpack://WebRTC/../../node_modules/lodash/fp/isFunction.js","webpack://WebRTC/../../node_modules/lodash/fp/isNil.js","webpack://WebRTC/../../node_modules/lodash/fp/isNull.js","webpack://WebRTC/../../node_modules/lodash/fp/isNumber.js","webpack://WebRTC/../../node_modules/lodash/fp/isPlainObject.js","webpack://WebRTC/../../node_modules/lodash/fp/isString.js","webpack://WebRTC/../../node_modules/lodash/fp/isUndefined.js","webpack://WebRTC/../../node_modules/lodash/fp/join.js","webpack://WebRTC/../../node_modules/lodash/fp/map.js","webpack://WebRTC/../../node_modules/lodash/fp/merge.js","webpack://WebRTC/../../node_modules/lodash/fp/mergeAllWith.js","webpack://WebRTC/../../node_modules/lodash/fp/omit.js","webpack://WebRTC/../../node_modules/lodash/fp/partial.js","webpack://WebRTC/../../node_modules/lodash/fp/placeholder.js","webpack://WebRTC/../../node_modules/lodash/fp/remove.js","webpack://WebRTC/../../node_modules/lodash/fp/reverse.js","webpack://WebRTC/../../node_modules/lodash/fp/sortBy.js","webpack://WebRTC/../../node_modules/lodash/fp/trimCharsStart.js","webpack://WebRTC/../../node_modules/lodash/fp/trimEnd.js","webpack://WebRTC/../../node_modules/lodash/fp/union.js","webpack://WebRTC/../../node_modules/lodash/fp/unionBy.js","webpack://WebRTC/../../node_modules/lodash/fp/unionWith.js","webpack://WebRTC/../../node_modules/lodash/fp/unset.js","webpack://WebRTC/../../node_modules/lodash/fp/update.js","webpack://WebRTC/../../node_modules/lodash/fp/values.js","webpack://WebRTC/../../node_modules/lodash/fp/without.js","webpack://WebRTC/../../node_modules/lodash/get.js","webpack://WebRTC/../../node_modules/lodash/has.js","webpack://WebRTC/../../node_modules/lodash/hasIn.js","webpack://WebRTC/../../node_modules/lodash/identity.js","webpack://WebRTC/../../node_modules/lodash/includes.js","webpack://WebRTC/../../node_modules/lodash/isArguments.js","webpack://WebRTC/../../node_modules/lodash/isArray.js","webpack://WebRTC/../../node_modules/lodash/isArrayLike.js","webpack://WebRTC/../../node_modules/lodash/isArrayLikeObject.js","webpack://WebRTC/../../node_modules/lodash/isBuffer.js","webpack://WebRTC/../../node_modules/lodash/isElement.js","webpack://WebRTC/../../node_modules/lodash/isEmpty.js","webpack://WebRTC/../../node_modules/lodash/isEqual.js","webpack://WebRTC/../../node_modules/lodash/isError.js","webpack://WebRTC/../../node_modules/lodash/isFunction.js","webpack://WebRTC/../../node_modules/lodash/isLength.js","webpack://WebRTC/../../node_modules/lodash/isMap.js","webpack://WebRTC/../../node_modules/lodash/isNil.js","webpack://WebRTC/../../node_modules/lodash/isNull.js","webpack://WebRTC/../../node_modules/lodash/isNumber.js","webpack://WebRTC/../../node_modules/lodash/isObject.js","webpack://WebRTC/../../node_modules/lodash/isObjectLike.js","webpack://WebRTC/../../node_modules/lodash/isPlainObject.js","webpack://WebRTC/../../node_modules/lodash/isSet.js","webpack://WebRTC/../../node_modules/lodash/isString.js","webpack://WebRTC/../../node_modules/lodash/isSymbol.js","webpack://WebRTC/../../node_modules/lodash/isTypedArray.js","webpack://WebRTC/../../node_modules/lodash/isUndefined.js","webpack://WebRTC/../../node_modules/lodash/isWeakMap.js","webpack://WebRTC/../../node_modules/lodash/iteratee.js","webpack://WebRTC/../../node_modules/lodash/join.js","webpack://WebRTC/../../node_modules/lodash/keys.js","webpack://WebRTC/../../node_modules/lodash/keysIn.js","webpack://WebRTC/../../node_modules/lodash/last.js","webpack://WebRTC/../../node_modules/lodash/map.js","webpack://WebRTC/../../node_modules/lodash/memoize.js","webpack://WebRTC/../../node_modules/lodash/merge.js","webpack://WebRTC/../../node_modules/lodash/mergeWith.js","webpack://WebRTC/../../node_modules/lodash/noop.js","webpack://WebRTC/../../node_modules/lodash/now.js","webpack://WebRTC/../../node_modules/lodash/omit.js","webpack://WebRTC/../../node_modules/lodash/partial.js","webpack://WebRTC/../../node_modules/lodash/property.js","webpack://WebRTC/../../node_modules/lodash/rearg.js","webpack://WebRTC/../../node_modules/lodash/remove.js","webpack://WebRTC/../../node_modules/lodash/reverse.js","webpack://WebRTC/../../node_modules/lodash/sortBy.js","webpack://WebRTC/../../node_modules/lodash/stubArray.js","webpack://WebRTC/../../node_modules/lodash/stubFalse.js","webpack://WebRTC/../../node_modules/lodash/toFinite.js","webpack://WebRTC/../../node_modules/lodash/toInteger.js","webpack://WebRTC/../../node_modules/lodash/toNumber.js","webpack://WebRTC/../../node_modules/lodash/toPath.js","webpack://WebRTC/../../node_modules/lodash/toPlainObject.js","webpack://WebRTC/../../node_modules/lodash/toString.js","webpack://WebRTC/../../node_modules/lodash/trimEnd.js","webpack://WebRTC/../../node_modules/lodash/trimStart.js","webpack://WebRTC/../../node_modules/lodash/union.js","webpack://WebRTC/../../node_modules/lodash/unionBy.js","webpack://WebRTC/../../node_modules/lodash/unionWith.js","webpack://WebRTC/../../node_modules/lodash/unset.js","webpack://WebRTC/../../node_modules/lodash/update.js","webpack://WebRTC/../../node_modules/lodash/values.js","webpack://WebRTC/../../node_modules/lodash/without.js","webpack://WebRTC/../../node_modules/lodash/wrapperLodash.js","webpack://WebRTC/../../node_modules/query-string/index.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isFunction.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isSymbol.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isEmpty.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/toString.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isString.js","webpack://WebRTC/../../node_modules/redux-actions/es/constants.js","webpack://WebRTC/../../node_modules/redux-actions/es/combineActions.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/identity.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isNull.js","webpack://WebRTC/../../node_modules/redux-actions/es/createAction.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isPlainObject.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isArray.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isNil.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/getLastElement.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/camelCase.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/arrayToObject.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isMap.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/ownKeys.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/get.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/flattenWhenNode.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/flattenActionMap.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/unflattenActionCreators.js","webpack://WebRTC/../../node_modules/redux-actions/es/createActions.js","webpack://WebRTC/../../node_modules/redux-actions/es/createCurriedAction.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/isUndefined.js","webpack://WebRTC/../../node_modules/redux-actions/es/handleAction.js","webpack://WebRTC/../../node_modules/reduce-reducers/es/index.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/flattenReducerMap.js","webpack://WebRTC/../../node_modules/redux-actions/es/utils/hasGeneratorInterface.js","webpack://WebRTC/../../node_modules/redux-actions/es/handleActions.js","webpack://WebRTC/../../node_modules/redux-devtools-extension/index.js","webpack://WebRTC/../../node_modules/redux-logger/dist/redux-logger.js","webpack://WebRTC/../../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://WebRTC/../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://WebRTC/../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://WebRTC/../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack://WebRTC/../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://WebRTC/../../node_modules/redux/es/redux.js","webpack://WebRTC/../../node_modules/sdp-transform/lib/grammar.js","webpack://WebRTC/../../node_modules/sdp-transform/lib/index.js","webpack://WebRTC/../../node_modules/sdp-transform/lib/parser.js","webpack://WebRTC/../../node_modules/sdp-transform/lib/writer.js","webpack://WebRTC/../../node_modules/split-on-first/index.js","webpack://WebRTC/../../node_modules/strict-uri-encode/index.js","webpack://WebRTC/../../node_modules/to-camel-case/index.js","webpack://WebRTC/../../node_modules/to-no-case/index.js","webpack://WebRTC/../../node_modules/to-space-case/index.js","webpack://WebRTC/../../node_modules/utf8/utf8.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/index.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/md5.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/native.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/nil.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/parse.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/regex.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/rng.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/sha1.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/stringify.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/v1.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/v3.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/v35.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/v4.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/v5.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/validate.js","webpack://WebRTC/../../node_modules/uuid/dist/commonjs-browser/version.js","webpack://WebRTC/../../node_modules/v8n/dist/v8n.esm.js","webpack://WebRTC/../../node_modules/variable-diff/index.js","webpack://WebRTC/../../node_modules/webrtc-adapter/out/adapter.js","webpack://WebRTC/../../node_modules/core-js/internals/a-callable.js","webpack://WebRTC/../../node_modules/core-js/internals/a-possible-prototype.js","webpack://WebRTC/../../node_modules/core-js/internals/a-set.js","webpack://WebRTC/../../node_modules/core-js/internals/add-to-unscopables.js","webpack://WebRTC/../../node_modules/core-js/internals/an-object.js","webpack://WebRTC/../../node_modules/core-js/internals/array-includes.js","webpack://WebRTC/../../node_modules/core-js/internals/array-set-length.js","webpack://WebRTC/../../node_modules/core-js/internals/classof-raw.js","webpack://WebRTC/../../node_modules/core-js/internals/classof.js","webpack://WebRTC/../../node_modules/core-js/internals/copy-constructor-properties.js","webpack://WebRTC/../../node_modules/core-js/internals/create-non-enumerable-property.js","webpack://WebRTC/../../node_modules/core-js/internals/create-property-descriptor.js","webpack://WebRTC/../../node_modules/core-js/internals/define-built-in-accessor.js","webpack://WebRTC/../../node_modules/core-js/internals/define-built-in.js","webpack://WebRTC/../../node_modules/core-js/internals/define-global-property.js","webpack://WebRTC/../../node_modules/core-js/internals/descriptors.js","webpack://WebRTC/../../node_modules/core-js/internals/document-create-element.js","webpack://WebRTC/../../node_modules/core-js/internals/does-not-exceed-safe-integer.js","webpack://WebRTC/../../node_modules/core-js/internals/enum-bug-keys.js","webpack://WebRTC/../../node_modules/core-js/internals/environment-user-agent.js","webpack://WebRTC/../../node_modules/core-js/internals/environment-v8-version.js","webpack://WebRTC/../../node_modules/core-js/internals/error-stack-clear.js","webpack://WebRTC/../../node_modules/core-js/internals/error-stack-install.js","webpack://WebRTC/../../node_modules/core-js/internals/error-stack-installable.js","webpack://WebRTC/../../node_modules/core-js/internals/export.js","webpack://WebRTC/../../node_modules/core-js/internals/fails.js","webpack://WebRTC/../../node_modules/core-js/internals/function-apply.js","webpack://WebRTC/../../node_modules/core-js/internals/function-bind-native.js","webpack://WebRTC/../../node_modules/core-js/internals/function-call.js","webpack://WebRTC/../../node_modules/core-js/internals/function-name.js","webpack://WebRTC/../../node_modules/core-js/internals/function-uncurry-this-accessor.js","webpack://WebRTC/../../node_modules/core-js/internals/function-uncurry-this.js","webpack://WebRTC/../../node_modules/core-js/internals/get-built-in.js","webpack://WebRTC/../../node_modules/core-js/internals/get-iterator-direct.js","webpack://WebRTC/../../node_modules/core-js/internals/get-method.js","webpack://WebRTC/../../node_modules/core-js/internals/get-set-record.js","webpack://WebRTC/../../node_modules/core-js/internals/global-this.js","webpack://WebRTC/../../node_modules/core-js/internals/has-own-property.js","webpack://WebRTC/../../node_modules/core-js/internals/hidden-keys.js","webpack://WebRTC/../../node_modules/core-js/internals/html.js","webpack://WebRTC/../../node_modules/core-js/internals/ie8-dom-define.js","webpack://WebRTC/../../node_modules/core-js/internals/indexed-object.js","webpack://WebRTC/../../node_modules/core-js/internals/inherit-if-required.js","webpack://WebRTC/../../node_modules/core-js/internals/inspect-source.js","webpack://WebRTC/../../node_modules/core-js/internals/install-error-cause.js","webpack://WebRTC/../../node_modules/core-js/internals/internal-state.js","webpack://WebRTC/../../node_modules/core-js/internals/is-array.js","webpack://WebRTC/../../node_modules/core-js/internals/is-callable.js","webpack://WebRTC/../../node_modules/core-js/internals/is-forced.js","webpack://WebRTC/../../node_modules/core-js/internals/is-null-or-undefined.js","webpack://WebRTC/../../node_modules/core-js/internals/is-object.js","webpack://WebRTC/../../node_modules/core-js/internals/is-possible-prototype.js","webpack://WebRTC/../../node_modules/core-js/internals/is-pure.js","webpack://WebRTC/../../node_modules/core-js/internals/is-symbol.js","webpack://WebRTC/../../node_modules/core-js/internals/iterate-simple.js","webpack://WebRTC/../../node_modules/core-js/internals/iterator-close.js","webpack://WebRTC/../../node_modules/core-js/internals/length-of-array-like.js","webpack://WebRTC/../../node_modules/core-js/internals/make-built-in.js","webpack://WebRTC/../../node_modules/core-js/internals/math-trunc.js","webpack://WebRTC/../../node_modules/core-js/internals/normalize-string-argument.js","webpack://WebRTC/../../node_modules/core-js/internals/object-create.js","webpack://WebRTC/../../node_modules/core-js/internals/object-define-properties.js","webpack://WebRTC/../../node_modules/core-js/internals/object-define-property.js","webpack://WebRTC/../../node_modules/core-js/internals/object-get-own-property-descriptor.js","webpack://WebRTC/../../node_modules/core-js/internals/object-get-own-property-names.js","webpack://WebRTC/../../node_modules/core-js/internals/object-get-own-property-symbols.js","webpack://WebRTC/../../node_modules/core-js/internals/object-is-prototype-of.js","webpack://WebRTC/../../node_modules/core-js/internals/object-keys-internal.js","webpack://WebRTC/../../node_modules/core-js/internals/object-keys.js","webpack://WebRTC/../../node_modules/core-js/internals/object-property-is-enumerable.js","webpack://WebRTC/../../node_modules/core-js/internals/object-set-prototype-of.js","webpack://WebRTC/../../node_modules/core-js/internals/ordinary-to-primitive.js","webpack://WebRTC/../../node_modules/core-js/internals/own-keys.js","webpack://WebRTC/../../node_modules/core-js/internals/proxy-accessor.js","webpack://WebRTC/../../node_modules/core-js/internals/require-object-coercible.js","webpack://WebRTC/../../node_modules/core-js/internals/set-clone.js","webpack://WebRTC/../../node_modules/core-js/internals/set-difference.js","webpack://WebRTC/../../node_modules/core-js/internals/set-helpers.js","webpack://WebRTC/../../node_modules/core-js/internals/set-intersection.js","webpack://WebRTC/../../node_modules/core-js/internals/set-is-disjoint-from.js","webpack://WebRTC/../../node_modules/core-js/internals/set-is-subset-of.js","webpack://WebRTC/../../node_modules/core-js/internals/set-is-superset-of.js","webpack://WebRTC/../../node_modules/core-js/internals/set-iterate.js","webpack://WebRTC/../../node_modules/core-js/internals/set-method-accept-set-like.js","webpack://WebRTC/../../node_modules/core-js/internals/set-size.js","webpack://WebRTC/../../node_modules/core-js/internals/set-symmetric-difference.js","webpack://WebRTC/../../node_modules/core-js/internals/set-union.js","webpack://WebRTC/../../node_modules/core-js/internals/shared-key.js","webpack://WebRTC/../../node_modules/core-js/internals/shared-store.js","webpack://WebRTC/../../node_modules/core-js/internals/shared.js","webpack://WebRTC/../../node_modules/core-js/internals/symbol-constructor-detection.js","webpack://WebRTC/../../node_modules/core-js/internals/to-absolute-index.js","webpack://WebRTC/../../node_modules/core-js/internals/to-indexed-object.js","webpack://WebRTC/../../node_modules/core-js/internals/to-integer-or-infinity.js","webpack://WebRTC/../../node_modules/core-js/internals/to-length.js","webpack://WebRTC/../../node_modules/core-js/internals/to-object.js","webpack://WebRTC/../../node_modules/core-js/internals/to-primitive.js","webpack://WebRTC/../../node_modules/core-js/internals/to-property-key.js","webpack://WebRTC/../../node_modules/core-js/internals/to-string-tag-support.js","webpack://WebRTC/../../node_modules/core-js/internals/to-string.js","webpack://WebRTC/../../node_modules/core-js/internals/try-to-string.js","webpack://WebRTC/../../node_modules/core-js/internals/uid.js","webpack://WebRTC/../../node_modules/core-js/internals/use-symbol-as-uid.js","webpack://WebRTC/../../node_modules/core-js/internals/v8-prototype-define-bug.js","webpack://WebRTC/../../node_modules/core-js/internals/validate-arguments-length.js","webpack://WebRTC/../../node_modules/core-js/internals/weak-map-basic-detection.js","webpack://WebRTC/../../node_modules/core-js/internals/well-known-symbol.js","webpack://WebRTC/../../node_modules/core-js/internals/wrap-error-constructor-with-cause.js","webpack://WebRTC/../../node_modules/core-js/modules/es.array.includes.js","webpack://WebRTC/../../node_modules/core-js/modules/es.array.push.js","webpack://WebRTC/../../node_modules/core-js/modules/es.error.cause.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.difference.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.intersection.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.is-disjoint-from.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.is-subset-of.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.is-superset-of.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.symmetric-difference.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/es.set.union.v2.js","webpack://WebRTC/../../node_modules/core-js/modules/web.url-search-params.delete.js","webpack://WebRTC/../../node_modules/core-js/modules/web.url-search-params.has.js","webpack://WebRTC/../../node_modules/core-js/modules/web.url-search-params.size.js","webpack://WebRTC/webpack/bootstrap","webpack://WebRTC/webpack/runtime/compat get default export","webpack://WebRTC/webpack/runtime/define property getters","webpack://WebRTC/webpack/runtime/global","webpack://WebRTC/webpack/runtime/hasOwnProperty shorthand","webpack://WebRTC/webpack/runtime/make namespace object","webpack://WebRTC/webpack/runtime/node module decorator","webpack://WebRTC/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WebRTC\"] = factory();\n\telse\n\t\troot[\"WebRTC\"] = factory();\n})(self, () => {\nreturn ","import logs from '../../packages/kandy/src/logs/plugin'\nimport config from '../../packages/kandy/src/config'\nimport events from '../../packages/kandy/src/events'\n\n/**\n * This is a list of base plugins that most solutions will need. These plugins provide service-like capabilities\n * to the SDK.\n */\nexport default [\n  { name: 'logs', fn: logs },\n  { name: 'config', fn: config },\n  { name: 'events', fn: events }\n]\n","// Disabling eslint for the next comment as we want to be able to use a disallowed word\n// eslint-disable-next-line no-warning-comments\n/**\n * The SDK creation factory. Create an instance of the SDK by calling this factory with the desired configurations.\n * The SDK instance will be referred as 'api' throughout the rest of the documentation content.\n * @public\n * @method create\n * @param {config} config The configuration object.\n * @return {api} The SDK instance.\n * @example\n * // Instantiate the SDK.\n * import { create } from '@rbbn/webrtc-js-sdk'\n * const client = create({\n *     authentication: { ... },\n *     logs: { ... },\n *     ...\n * });\n * // Use the SDK's API.\n * client.on( ... );\n */\n\n/**\n * The 'api' is the type returned by the create function.\n * It contains various top-level functions that pertain to SDK global instance\n * as well as several nested namespaces that pertain to various features (e.g. call, contacts, presence, etc).\n *\n * @public\n * @module api\n */\n\n/**\n * The configuration object. This object defines what different configuration\n * values you can use when instantiating the SDK using the {@link create} function.\n * @public\n * @module config\n */\n\n// Disabling eslint for the next comment as we want to be able to use a disallowed word\n// eslint-disable-next-line no-warning-comments\n/**\n * A set of {@link call.SdpHandlerFunction SdpHandlerFunction}s for manipulating SDP information.\n * These handlers are used to customize low-level call behaviour for very specific\n * environments and/or scenarios.\n *\n * Note that SDP handlers are exposed on the entry point of the SDK. They can be added during\n * initialization of the SDK using the {@link #configconfigcall config.call.sdpHandlers} configuration\n * parameter. They can also be set after the SDK's creation by using the\n * {@link call.setSdpHandlers} function.\n *\n * @public\n * @namespace sdpHandlers\n * @example\n * import { create, sdpHandlers } from '@rbbn/webrtc-js-sdk';\n * const codecRemover = sdpHandlers.createCodecRemover(['VP8', 'VP9'])\n * const client = create({\n *   call: {\n *     sdpHandlers: [ codecRemover, <Your-SDP-Handler-Function>, ...]\n *   }\n * })\n * @example\n * // Through the Call API post-instantiation\n * client.call.setSdpHandlers([ codecRemover, <Your-SDP-Handler-Function>, ...])\n */\n\n/**\n * An object that represents a selector to match codecs of an RTP map in SDP.\n *\n * @public\n * @static\n * @typedef {Object} CodecSelector\n * @memberof sdpHandlers\n * @property {string} name The name of the codec.\n * @property {Array<string>} fmtpParams An array of strings to match against the \"a=fmtp\" format parameters for the corresponding codec.\n *                                      All of the elements in the array must be contained in the \"a=fmtp\" attribute in order to be a match.\n */\n\n/**\n * This function creates an SDP handler that will remove codecs matching the selectors specified for SDP offers and answers.\n *\n * In some scenarios it's necessary to remove certain codecs being offered by the SDK to remote parties. For example, some legacy call services limit the SDP\n * length (usually to 4KB) and will reject calls that have SDP size above this amount.\n *\n * While creating an SDP handler would allow a user to perform this type of manipulation, it is a non-trivial task that requires in-depth knowledge of WebRTC SDP.\n *\n * To facilitate this common task, the createCodecRemover function creates a codec removal handler that can be used for this purpose. Applications can use this codec\n * removal handler in combination with the {@link call.getAvailableCodecs call.getAvailableCodecs} function in order to build logic to determine the best codecs to use\n * for their application.\n *\n * @public\n * @memberof sdpHandlers\n * @method createCodecRemover\n * @param {Array<CodecSelector> | Array<string>} codecs A list of codec selectors to remove from the SDP. If passing a list of strings, they will be converted into\n *                                                      codec selectors that correspond to those names without any extra FMTP parameters.\n * @returns {call.SdpHandlerFunction} The resulting SDP handler that will remove the codec.\n * @example\n * import { create, sdpHandlers } from '@rbbn/webrtc-js-sdk';\n *\n * const codecRemover = sdpHandlers.createCodecRemover([\n *   // Remove all VP8 and VP9 codecs.\n *   'VP8',\n *   'VP9',\n *\n *   // Remove all H264 codecs with the specified FMTP parameters.\n *   {\n *     name: 'H264',\n *     fmtpParams: ['packetization-mode=0']\n *   }\n * ])\n *\n * const client = create({\n *   call: {\n *     sdpHandlers: [codecRemover]\n *   }\n * })\n *\n */\n\n/*\n * Index template file that is used to create pre-defined version of the SDK.\n */\nimport { factory } from '../../packages/kandy/src/factory'\n\nexport default function commonIndex(options = {}, plugins = []) {\n  return factory(plugins, options)\n}\n","import commonIndex from '../core'\n\nimport basePlugins from '../core/basePlugins'\nimport webrtc from '../../packages/kandy/src/webrtc'\nimport proxy from '../../packages/kandy/src/webrtcProxy'\nimport subscription from '../../packages/kandy/src/subscription/link'\nimport auth from '../../packages/kandy/src/auth/link'\nimport call from '../../packages/kandy/src/call/link'\nimport callHistory from '../../packages/kandy/src/callHistory/link'\nimport clickToCall from '../../packages/kandy/src/clickToCall/link'\nimport connectivity from '../../packages/kandy/src/connectivity/plugin'\nimport messaging from '../../packages/kandy/src/messaging/link'\nimport mwi from '../../packages/kandy/src/mwi/link'\nimport notifications from '../../packages/kandy/src/notifications/link'\nimport presence from '../../packages/kandy/src/presence/link'\nimport sipEvents from '../../packages/kandy/src/sipEvents'\nimport users from '../../packages/kandy/src/users/link/index.js'\nimport { linkRequest } from '../../packages/kandy/src/request'\nimport '../../packages/kandy/src/docs/docs'\n\nimport { createCodecRemover } from '../../packages/kandy/src/call/utils/codecRemover.js'\n\nconst defaultPlugins = [\n  ...basePlugins,\n  { name: 'authentication', fn: auth },\n  { name: 'subscription', fn: subscription },\n  { name: 'webrtc', fn: webrtc },\n  // TODO: Don't _always_ include the Proxy Plugin.\n  { name: 'proxy', fn: proxy },\n  { name: 'call', fn: call },\n  { name: 'callHistory', fn: callHistory },\n  { name: 'clickToCall', fn: clickToCall },\n  { name: 'notifications', fn: notifications },\n  { name: 'connectivity', fn: connectivity },\n  { name: 'messaging', fn: messaging },\n  { name: 'mwi', fn: mwi },\n  { name: 'presence', fn: presence },\n  { name: 'sipEvents', fn: sipEvents },\n  { name: 'users', fn: users },\n  { name: 'request', fn: linkRequest }\n]\n\nfunction root(options = {}, plugins = []) {\n  return commonIndex(options, [...defaultPlugins, ...plugins])\n}\n\n// Alias 'create' to be equal to the root function\nroot.create = root\n\nroot.sdpHandlers = {\n  createCodecRemover\n}\n\n// Export this way as a work-around, so it can be used as `<export>();`.\n// See: https://github.com/webpack/webpack/issues/706\nmodule.exports = root\n","/*\n * Event emitter module. Can be used as a standalone factory or as a mixin.\n *\n * @private\n * @class emitter\n * @example\n * ``` javascript\n * var eventEmitter = emitter(); // Create a new emitter.\n * emitter(myEmittingObject.prototype); // Mixin to an existing object.\n * ```\n */\nexport default function eventEmitter(prototype = {}) {\n  var eventMap = []\n  var subscribeMap = []\n  var strictMode = false\n\n  /*\n   * Check if the event is a valid event type.\n   */\n  function checkEvent(type) {\n    if (strictMode && !eventMap[type]) {\n      throw new Error('Invalid event type: ' + type)\n    }\n  }\n\n  /*\n   * Remove a listener for a list by mutating it.\n   */\n  function removeListener(list, listener) {\n    var i = list.length\n    while (i--) {\n      if (listener === list[i]) {\n        list.splice(i, 1)\n      }\n    }\n  }\n\n  return Object.assign(prototype, {\n    /*\n     * Define an event type with the event emitter.\n     *\n     * @method define\n     * @param {String} type The name for the event type.\n     */\n    define: function (type) {\n      eventMap[type] = eventMap[type] || []\n    },\n\n    /*\n     * Define an alias for an event type.\n     *\n     * @method alias\n     * @param {String} type The event type for which to add an alias.\n     * @param {String} alias The alias name for the event type.\n     * @throws {Error} Invalid event type\n     */\n    alias: function (type, alias) {\n      checkEvent(type)\n\n      eventMap[alias] = eventMap[type] = eventMap[type] || []\n    },\n\n    /*\n     * Add an event listener for the specified event type.\n     *\n     * @method on\n     * @param {String} type The event type for which to add the listener.\n     * @param {Function} listener The listener for the event type. The parameters\n     *                            of the listener depend on the event type.\n     * @throws {Error} Invalid event type\n     */\n    on: function (type, listener) {\n      checkEvent(type)\n      ;(eventMap[type] = eventMap[type] || []).push(listener)\n    },\n\n    /*\n     * Removes an event listener for the specified event type.\n     *\n     * @method off\n     * @param {String} type The event type for which to remote the listener.\n     * @param {Function} listener The listener to remove.\n     * @throws {Error} Invalid event type\n     */\n    off: function (type, listener) {\n      checkEvent(type)\n\n      var list = eventMap[type] || []\n      removeListener(list, listener)\n    },\n\n    /*\n     * Add an event listener that will only be called once for the specified event type.\n     *\n     * @method once\n     * @param {String} type The event type for which to add the listener.\n     * @param {Function} listener The listener for the event type. The parameters\n     *                            of the listener depend on the event type.\n     * @throws {Error} Invalid event type\n     */\n    once: function (type, listener) {\n      checkEvent(type)\n      listener.once = true\n      ;(eventMap[type] = eventMap[type] || []).push(listener)\n    },\n\n    /*\n     * Emits an event of the specified type.\n     *\n     * @method emit\n     * @param {String} type The event type to emit.\n     * @param {any} [...args] The arguments to pass to the listeners of the event.\n     * @throws {Error} Invalid event type\n     */\n    emit: function (type) {\n      checkEvent(type)\n\n      var args = Array.prototype.slice.call(arguments, 1)\n      var list = eventMap[type] || []\n      var i = 0\n      var noop = function () {}\n\n      var listCopy = list.slice()\n      for (; i < listCopy.length; i++) {\n        var fn = listCopy[i]\n        if (fn.once) {\n          list[i] = noop\n        }\n        fn.apply(undefined, args)\n      }\n      removeListener(list, noop)\n\n      for (var j = 0; j < subscribeMap.length; j++) {\n        subscribeMap[j].call(undefined, type, args)\n      }\n    },\n\n    /*\n     * Add a subscription for all event types.\n     *\n     * @method subscribe\n     * @param {Function} listener The listener for all event types.\n     * @throws {Error} Listener not a function\n     */\n    subscribe: function (listener) {\n      if (typeof listener === 'function') {\n        subscribeMap.push(listener)\n      } else {\n        throw new Error('Listener not a function')\n      }\n    },\n\n    /*\n     * Remove a subscription for all event types.\n     *\n     * @method unsubscribe\n     * @param {Function} listener The listener for all event types.\n     * @throws {Error} Listener not a function\n     */\n    unsubscribe: function (listener) {\n      if (typeof listener === 'function') {\n        removeListener(subscribeMap, listener)\n      } else {\n        throw new Error('Listener not a function')\n      }\n    },\n\n    /*\n     * Sets the emitter in strict mode where it only allows events that have been defined or aliases.\n     *\n     * @method setStrictMode\n     * @param {Boolean} strict Whether to set strict mode for the emitter.\n     */\n    setStrictMode: function (strict) {\n      strictMode = strict\n    }\n  })\n}\n","/**\n * Possible disconnect reasons.\n * @name DISCONNECT_REASONS\n * @type {Object}\n */\nexport const DISCONNECT_REASONS = {\n  GONE: 'GONE',\n  LOST_CONNECTION: 'LOST_CONNECTION'\n}\n","const prefix = '@@KANDY/'\n\nexport const SET_CONNECTION_INFO = prefix + 'SET_CONNECTION_INFO'\nexport const CONNECTION_OCCURRED = prefix + 'CONNECTION_OCCURRED'\nexport const GET_USER_DETAILS = prefix + 'GET_USER_DETAILS'\nexport const USER_DETAILS_RECEIVED = prefix + 'USER_DETAILS_RECEIVED'\nexport const DISCONNECT_FINISHED = prefix + 'DISCONNECT_FINISHED'\nexport const RESUBSCRIPTION_FINISHED = prefix + 'RESUBSCRIPTION_FINISHED'\n\nexport const SET_CREDENTIALS = prefix + 'SET_CREDENTIALS'\nexport const SET_CREDENTIALS_FINISH = prefix + 'SET_CREDENTIALS_FINISH'\n\nexport const AUTHORIZATION_ERROR = prefix + 'AUTHORIZATION_ERROR'\n\nexport const UPDATE_HMAC_TOKEN = prefix + 'UPDATE_HMAC_TOKEN'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Creates a setCredentials action that takes a credentials object.\n *\n * @method setCredentials\n * @param {Object} $0\n * @param {string} $0.username The username.\n * @param {string} $0.password The user's password.\n * @param {string} $0.authname The user's authorization name.\n * @param {string} $0.hmacToken An HMAC token for the user with the provided user ID.\n * @param {string} $0.bearerAccessToken An access token retrieved using the authentication APIs of the platform.\n * @return {Object} A flux standard action.\n */\nexport function setCredentials({ username, password, authname, hmacToken, bearerAccessToken }) {\n  return {\n    type: actionTypes.SET_CREDENTIALS,\n    payload: { username, password, authname, hmacToken, bearerAccessToken },\n    meta: {\n      isSensitive: true\n    }\n  }\n}\n\n/**\n * Create a setCredentials finished action that takes a userInfo object on success and possibly\n * an error object.\n *\n * @method setCredentialsFinished\n * @param {Object} $0\n * @param {Object} $0.userInfo An object representing the user information.\n * @param {Object} $0.connection A connection object. Information about how to connect to the backend services.\n * @param {boolean} $0.isAnonymous Indicates if this user is an anonymous user.\n * @param {string} [$0.error] An error message. Only present if an error occurred.\n * @return {Object} A flux standard action.\n */\nexport function setCredentialsFinished({ userInfo, connection, error }) {\n  var action = {\n    type: actionTypes.SET_CREDENTIALS_FINISH,\n    meta: {\n      isSensitive: true\n    }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n  } else {\n    action.payload = { userInfo, connection }\n  }\n\n  return action\n}\n\n/**\n * Creates an updateToken action with connection and platform information.\n *\n * @method updateToken\n * @param {string} token A session id retrieved after a successful subscription on the platform.\n * @return {Object} A flux standard action.\n */\nexport function updateHmacToken(token) {\n  var action = {\n    type: actionTypes.UPDATE_HMAC_TOKEN,\n    payload: token,\n    meta: {\n      isSensitive: true\n    }\n  }\n\n  return action\n}\n","import * as actions from './actions'\nimport { getUserInfo as selectUserInfo } from './selectors'\nimport { DISCONNECT_REASONS } from '../constants'\n\n/**\n * Authentication APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context - The factory context.\n * @return {Object} Authentication API.\n */\nexport default function createAPI(container) {\n  const { logManager, context, AuthenticationOperations: operations, API_LOG_TAG } = container\n  const log = logManager.getLogger('AUTH')\n\n  const authenticationApi = {\n    /**\n     * Retrieves information about the current user.\n     *\n     * @public\n     * @memberof api\n     * @method getUserInfo\n     * @returns {Object} user The user data.\n     * @returns {string} user.username The username of the current user. Note that this username can take different encoded forms.\n     *                                 It's not meant to be displayed to a user.\n     * @returns {string} user.token The current access token.\n     */\n    getUserInfo: function () {\n      log.debug(API_LOG_TAG + 'getUserInfo')\n      return selectUserInfo(context.getState())\n    },\n\n    /**\n     * Possible reasons for disconnecting.\n     *\n     * @public\n     * @memberof api\n     * @requires connect\n     * @property {string} GONE Connection was terminated by the server\n     * @property {string} LOST_CONNECTION Internet connection was lost\n     * @property {string} WS_OVERRIDDEN WebSocket was overridden by the server\n     */\n    disconnectReasons: DISCONNECT_REASONS,\n\n    /**\n     * Sets the user credentials necessary to make requests to the platform.\n     *\n     * If credentials has previously been set, they cannot be set again if there is an active\n     * subscription. An {@link api.event:auth:error auth:error} will be emitted in\n     * this scenario.\n     *\n     * @public\n     * @memberof api\n     * @requires userCredentialsAuth\n     * @method setCredentials\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username including the application's domain.\n     * @param {string} credentials.password The user's password.\n     * @param {string} [credentials.authname] The user's authorization name.\n     * @example\n     * client.setCredentials({\n     *   username: 'alfred@example.com',\n     *   password: '********'\n     *   authname: '********'\n     * });\n     */\n    /**\n     * Sets the username and HMAC token necessary to make requests to the platform.\n     * An HMAC token is used to verify a user via the user's authorization within an of organization.\n     * HMAC tokens are generated by using the HmacSHA1 algorithm and a key on a data object\n     * containing an `authenticationTokenRequest` object with the following properties:\n     * - subscriberId - The user's subscriber ID in the organization.\n     * - organizationId - The ID of the organization the user is a part of.\n     *\n     * @public\n     * @memberof api\n     * @requires hmacTokenAuth\n     * @method setCredentials\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username.\n     * @param {string} credentials.hmacToken An HMAC token for the user with the provided user ID.\n     * @example\n     * const hmacToken = HmacSHA1Algorithm({\n     *   authenticationTokenRequest: {\n     *     subscriberId: 'alfred',\n     *     organizationId: 'example.com'\n     *   }\n     * }, key)\n     *\n     * client.setCredentials({\n     *   username: 'alfred@example.com',\n     *   hmacToken\n     * });\n     */\n    /**\n     * Provides a bearerAccessToken to any backend services that the SDK instance deals with.\n     * The bearerAccessToken provided establishes what can be accessed by the SDK. The bearerAccessToken\n     * can be set again after subscription as long as the subscribed username is passed with the updated bearerAccessToken.\n     *\n     * @public\n     * @memberof api\n     * @requires bearerAccessTokenAuth\n     * @method setCredentials\n     * @param {Object} credentials The credentials object.\n     * @param {string} credentials.username The username without the application's domain.\n     * @param {string} credentials.bearerAccessToken A bearerAccessToken retrieved using the authentication APIs of the platform.\n     * @example\n     * client.setCredentials({\n     *   username: 'alfred@example.com',\n     *   bearerAccessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'\n     * });\n     */\n    setCredentials: function ({ username, password, authname, hmacToken, bearerAccessToken }) {\n      log.debug(API_LOG_TAG + 'setCredentials: ', username)\n      // TODO: Refactor into multiple actions for each credential mode\n      // TODO: Validation of two authentication possibility scenario\n      context.dispatch(\n        actions.setCredentials({\n          username,\n          password,\n          authname,\n          hmacToken,\n          bearerAccessToken\n        })\n      )\n\n      operations.setCredentials({ username, password, authname, hmacToken, bearerAccessToken })\n    }\n  }\n\n  return authenticationApi\n}\n","/**\n * The authentication credentials have been set. You can check the set user details with the `getUserInfo` API.\n *\n * @public\n * @static\n * @memberof api\n * @event auth:change\n * @param {Object} params\n */\nexport const AUTH_CHANGE = 'auth:change'\n\n/**\n * There was an error with authentication.\n *\n * @public\n * @static\n * @memberof api\n * @event auth:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n *\n */\nexport const AUTH_ERROR = 'auth:error'\n\n/**\n * An attempt to extend the current user's subscription was made.\n *\n * In a failure scenario, the current user is still connected, and further\n * resubscription attempts will be made, but may become disconnected if the\n * session expires.\n * @public\n * @static\n * @memberof api\n * @requires connect\n * @event auth:resub\n * @param {Object} params\n * @param {number} params.attemptNum The attempt number of this resubscription.\n * @param {boolean} params.isFailure Whether the resubscription failed or not.\n * @param {api.BasicError} [params.error] The Basic error object.\n */\nexport const AUTH_RESUB = 'auth:resub'\n\n/**\n * The information (credentials) needed for connecting have been set.\n *\n * @public\n * @static\n * @memberof api\n * @requires connect\n * @event auth:credentialsSet\n */\nexport const AUTH_CREDENTIALS_SET = 'auth:credentialsSet'\n","import reducer from './reducers'\nimport name from './name'\nimport createAPI from './api'\n\nexport { reducer, name, createAPI }\n","/**\n * This interface is for an authentication plugin.\n * @type {string}\n */\nconst name = 'authentication'\nexport default name\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\nreducers[actionTypes.SET_CREDENTIALS_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      error: undefined,\n      // Store platform connection information to be provided to other plugins.\n      connection: {\n        ...state.connection,\n        ...action.payload.connection\n      },\n      // Store user information to be provided to developers.\n      userInfo: action.payload.userInfo\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      error: action.payload\n    }\n  }\n}\n\n/*\n * Remove the x-token from the request header after subscription is successful.\n */\nreducers[actionTypes.UPDATE_HMAC_TOKEN] = {\n  next(state, action) {\n    const { 'x-token': _removed, ...removeXtoken } = state.connection.requestOptions.headers\n\n    const headers = {\n      ...removeXtoken,\n      'x-session': action.payload\n    }\n\n    return {\n      ...state,\n      connection: {\n        ...state.connection,\n        requestOptions: {\n          ...state.connection.requestOptions,\n          headers\n        }\n      }\n    }\n  }\n}\n\n/**\n * Auth Interface reducer\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n * @example\n * Auth state structure example; connected.\n * authState = {\n *     isConnected: true,\n *     isPending: false,\n *     error: undefined,\n *     subscription: { ... },\n *     connection: { ... },\n *     userInfo: { ... }\n * }\n */\nconst reducer = handleActions(reducers, {\n  isConnected: false,\n  isPending: false\n})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/*\n * Redux state selector functions.\n */\n\n/**\n * Retrieves the config options provided by the auth plugin.\n * @method getAuthConfig\n * @return {Object}\n */\nexport function getAuthConfig(state) {\n  return cloneDeep(state.config.authentication)\n}\n\n/**\n * Retrieves the maximum number of times this client will attempt to subscribe, while getting a\n * 'Service Unavailable' response from backend.\n * @method getServiceUnavailableMaxRetries\n * @param {Object} state Current state object.\n * @return {number}\n */\nexport function getServiceUnavailableMaxRetries(state) {\n  return state.config.authentication.subscription.serviceUnavailableMaxRetries\n}\n\n/**\n * Retrieves the connection information.\n * Includes the info needed to make requests.\n * @method getConnectionInfo\n * @return {Object}\n */\nexport function getConnectionInfo(state) {\n  if (state.authentication.connection) {\n    return cloneDeep(state.authentication.connection)\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Retrieves the domain of the callee address information.\n * @method getDomain\n * @return {string}\n */\nexport function getDomain(state) {\n  const { username = '', identity = username } = getUserInfo(state)\n  const [, domain = ''] = identity.split('@')\n  return domain\n}\n\n/**\n * Retrieves the identity of the currently logged-in user.\n * The identity is of the form: <userName>@<domain>\n * @method getIdentity\n * @return {string}\n */\nexport function getIdentity(state) {\n  const userInfo = getUserInfo(state)\n  return userInfo.identity || userInfo.username || ''\n}\n\n/**\n * Retrieves the user information.\n * @method getUserInfo\n * @return {Object} An object whose properties are: identity & username. Identity is user's primary contact address.\n */\nexport function getUserInfo(state) {\n  return cloneDeep(state.authentication.userInfo) || {}\n}\n\n/**\n * Retrieves info needed to make a REST request.\n * @method getRequestInfo\n * @return {Object}\n */\nexport function getRequestInfo(state) {\n  const { subscription } = getAuthConfig(state)\n  let { server } = getAuthConfig(state)\n  let { userInfo } = cloneDeep(state.authentication)\n\n  // For backwards compatibility, we need to fall back to\n  // subscription for the server connection details\n  if (!server) {\n    server = {\n      protocol: subscription.protocol,\n      base: subscription.server,\n      port: subscription.port,\n      version: subscription.version\n    }\n  }\n\n  // If user info does not exist yet, use an empty object. Requests will still fail, but they will be handled.\n  if (!userInfo) {\n    userInfo = {}\n  }\n\n  let requestInfo = {\n    baseURL: `${server.protocol}://${server.base}:${server.port}`,\n    version: server.version,\n    username: userInfo.username\n  }\n\n  const connInfo = getConnectionInfo(state)\n  if (connInfo && connInfo.requestOptions) {\n    requestInfo.requestOptions = connInfo.requestOptions\n  }\n\n  return requestInfo\n}\n","// The interface to follow.\nimport { createAPI, reducer, name } from '../interface'\n\n// Operations\nimport * as initOperations from './operations'\n\n// State setters.\nimport { update as updateConfig } from '../../config/interface/actions'\n\n// Utilities.\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\n// Parse and/or Validate\nimport { validation as v8n, parse, enums } from '../../../src/common/validation'\n\n/**\n * On link authentication implementation factory.\n * @method authLink\n * @param {Object} [options={}] - Configuration options for authentication. See above.\n * @return {Object} plugin - An authentication plugin.\n */\nexport default function authFactory(bottle, options = {}) {\n  const { logManager } = bottle.container\n\n  // Get the logger\n  const log = logManager.getLogger('AUTH')\n\n  /**\n   * Configuration options for the Authentication feature.\n   * @public\n   * @name config.authentication\n   * @memberof config\n   * @instance\n   * @param {Object} authentication Authentication configs.\n   * @param {Object} authentication.server\n   * @param {string} authentication.server.base Hostname of the server to be used for requests.\n   * @param {string} [authentication.server.protocol='https'] Protocol to be used for requests.\n   * @param {number} [authentication.server.port=443] Port to be used for requests.\n   */\n\n  const defaultOptions = {\n    server: {\n      protocol: 'https',\n      base: null,\n      port: 443,\n      version: '1' // not documented, but important\n    }\n  }\n\n  // config validation\n  const v8nValidation = v8n.schema({\n    server: v8n.schema({\n      protocol: enums(['http', 'https']),\n      base: v8n.string(),\n      port: v8n.positive(),\n      version: enums(['1']) // not documented, but important\n    })\n  })\n  const parseOptions = parse('authentication', v8nValidation)\n\n  options = mergeValues(defaultOptions, options)\n  parseOptions(options)\n\n  if (!options.server.base) {\n    log.error('No server configuration provided. Please provide proper authentication configurations.')\n  }\n\n  function initPlugin(container) {\n    const { context } = container\n    // Send the provided options to the store.\n    // This will be `state.config[name]`.\n    context.dispatch(updateConfig(options, name))\n  }\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('AuthenticationAPI', createAPI)\n\n  bottle.defer(initPlugin)\n\n  for (const name in initOperations) {\n    initOperations[name](bottle)\n  }\n\n  const capabilities = ['userCredentialsAuth', 'hmacTokenAuth', 'bearerAccessTokenAuth']\n\n  return {\n    name,\n    capabilities,\n    reducer\n  }\n}\n","import setCredentials from './setCredentials'\n\n/*\n * Register the operation with the bottle. This will make it available on the\n *    top-level container under its namespace.\n */\nexport default function registerOperations(bottle) {\n  bottle.factory('AuthenticationOperations.setCredentials', () => {\n    return setCredentials(bottle.container)\n  })\n}\n","// Auth\nimport * as actions from '../../interface/actions'\nimport * as eventTypes from '../../interface/eventTypes'\n\n// Subscription plugin\nimport { getSubscribedServices } from '../../../subscription/interface/selectors'\n\n// State selectors\nimport { getAuthConfig, getUserInfo } from '../../interface/selectors'\n\n// Errors\nimport BasicError, { authCodes } from '../../../errors'\n\n// Libraries\nimport base64 from 'base-64'\nimport utf8 from 'utf8'\n\nexport default function createOperation(container) {\n  const { logManager, context, emitEvent } = container\n  const log = logManager.getLogger('AUTH')\n\n  function setCredentials({ username, password, authname, hmacToken, bearerAccessToken, anonUsername, realm }) {\n    const { username: existingUsername } = getUserInfo(context.getState())\n    const activeServices = getSubscribedServices(context.getState())\n\n    if (existingUsername !== username && activeServices.length > 0) {\n      // User wants to change credentials while SDK is already subscribed to some services, under different credentials.\n      // Tell user to first unsubscribe.\n      const error = new BasicError({\n        message: 'Cannot change credentials while previous user has an active subscription.',\n        code: authCodes.INVALID_STATE\n      })\n      context.dispatch(actions.setCredentialsFinished({ error }))\n\n      emitEvent(eventTypes.AUTH_ERROR, { error })\n      return\n    }\n\n    const methodsOfAuthentication = [password, hmacToken, bearerAccessToken].map(Boolean).filter(x => x).length\n    if (username && methodsOfAuthentication >= 2) {\n      // User tries to authenticate using more than one method of authentication, which is ambiguous\n      const error = new BasicError({\n        message:\n          'Multiple methods of authentication detected. Use only one authorization method: Basic authorization (using a password) or Bearer authorization or HMAC authorization.',\n        code: authCodes.INVALID_CREDENTIALS\n      })\n      context.dispatch(actions.setCredentialsFinished({ error }))\n\n      emitEvent(eventTypes.AUTH_ERROR, { error })\n      return\n    }\n\n    // Retrieve the connection info.\n    const config = getAuthConfig(context.getState())\n\n    // Common request options, to be used for all subsequent requests after connect.\n    const requestOptions = {\n      headers: {\n        'Content-Type': 'application/json',\n        Accept: 'application/json'\n      }\n    }\n\n    if (realm) {\n      requestOptions.queryParams = {\n        tokenrealm: realm\n      }\n    }\n\n    if (username && hmacToken) {\n      // Only need the hmacToken in the x-token header when subscribing.\n      log.info('Setting the info for hmacToken scenario.')\n      requestOptions.headers['x-token'] = hmacToken\n    } else if (authname && password) {\n      log.info('Setting the info for authname/password scenario.')\n      requestOptions.headers.Authorization = 'Basic ' + base64.encode(utf8.encode(authname + ':' + password))\n    } else if (username && bearerAccessToken) {\n      log.info('Setting the info for bearerAccessToken/username scenario.')\n      requestOptions.headers.Authorization = `Bearer ${bearerAccessToken}`\n    } else if (username && password) {\n      log.info('Setting the info for username/password scenario.')\n      requestOptions.headers.Authorization = 'Basic ' + base64.encode(utf8.encode(username + ':' + password))\n    } else if (username && anonUsername) {\n      // Anonymous call scenario, auth headers not required.\n    } else {\n      log.info('Unexpected credentials scenario.')\n      const error = new BasicError({\n        message: 'This credentials signature is not valid.',\n        code: authCodes.INVALID_CREDENTIALS\n      })\n      context.dispatch(actions.setCredentialsFinished({ error }))\n\n      emitEvent(eventTypes.AUTH_ERROR, { error })\n      return\n    }\n\n    // Gather information to provide externally.\n    const userInfo = {\n      username: anonUsername || username,\n      isAnonymous: !!anonUsername\n    }\n\n    // Gather information to provide internally, to other plugins.\n    const connection = {\n      server: {\n        server: config.server.base,\n        port: config.server.port,\n        protocol: config.server.protocol,\n        version: config.server.version\n      },\n      username,\n      bearerAccessToken,\n      // Request options that all other (Link) plugins will use.\n      requestOptions\n    }\n\n    context.dispatch(\n      actions.setCredentialsFinished({\n        userInfo,\n        connection\n      })\n    )\n\n    emitEvent(eventTypes.AUTH_CHANGE, {})\n  }\n\n  return setCredentials\n}\n","import { OPERATIONS, OP_STATUS } from '../../interface/constants'\n\n/**\n * Factory for an \"on-going operation\" tracker.\n * An \"operation tracker\" is a utility object for managing the list of on-going\n *    operations for a call.\n * @method createTracker\n * @param {Object} log A logger for the call being tracked.\n */\nexport default function createTracker(log) {\n  // List of on-going operations.\n  const operations = []\n\n  // State getters.\n  const isBlocked = () => Boolean(getBlocking())\n\n  /*\n   * Methods.\n   */\n\n  /**\n   * Adds a new operation to the list of on-going operations.\n   * @method add\n   * @param {Operation} operation\n   */\n  function add(operation) {\n    const opString = `${operation.isLocal ? 'local' : 'remote'} ${operation.type}`\n    log.debug(`Operations: Tracking ${opString} operation with ${operations.length} other on-going operations.`)\n\n    // TODO: operation.isBlocking instead?\n    if (operation.isNegotiation && isBlocked()) {\n      // Avoid glare scenarios with two \"blocking\" operations at the same time.\n      const ongoing = getBy('isNegotiation', true)\n      log.info(`Cannot track new negotiation because of ${ongoing.status} ${ongoing.type} operation.`)\n      throw new Error('Cannot track two blocking operations!')\n    } else if (getBy('id', operation.id)) {\n      // Operations should only be 'added' once. This error indicates a bug.\n      log.warn('Cannot track operation that was previously tracked.')\n      throw new Error('Operation is already being tracked!')\n    } else if (operation.status !== OP_STATUS.NOT_STARTED) {\n      // Operations should be 'added' before they are started. This error indicates a bug.\n      log.warn('Cannot track operation that was previously started.')\n      throw new Error('Operation was already started!')\n    }\n\n    operations.push(operation)\n  }\n\n  /**\n   * Removes a finished operation from the list of on-going operations.\n   * @method remove\n   * @param {Operation} operation\n   */\n  function remove(operation) {\n    const opString = `${operation.isLocal ? 'local' : 'remote'} ${operation.type}`\n    log.debug(\n      `Operations: Done tracking ${opString} operation with ${operations.length - 1} other on-going operations.`\n    )\n\n    if (!getBy('id', operation.id)) {\n      // This error indicates a bug.\n      log.warn('Cannot stop tracking operation that was not previously tracked.')\n      throw new Error('Operation is not being tracked!')\n    } else if (operation.tracker.status !== OP_STATUS.FINISHED) {\n      if (\n        operation.isLocal &&\n        [OPERATIONS.JOIN, OPERATIONS.DIRECT_TRANSFER, OPERATIONS.CONSULTATIVE_TRANSFER].includes(operation.type)\n      ) {\n        // TODO: Fix complex operation flows to properly handle the response notification.\n        // Complex operations are never \"finished\" because the remoteOnly flow does not have\n        //    access to the Operation object, so don't error here.\n      } else {\n        // Operations follow a consistent \"flow\" before being 'removed'. This error indicates a bug.\n        log.warn('Cannot stop tracking operation that has not finished.')\n        throw new Error(`Cannot remove on-going ${opString} operation! (${operation.tracker.status})`)\n      }\n    }\n\n    const index = operations.findIndex(op => op.id === operation.id)\n    operations.splice(index, 1)\n  }\n\n  /*\n   * Getter methods.\n   */\n\n  // Get an operation based on a property.\n  function getBy(prop, val) {\n    return operations.find(op => op[prop] === val)\n  }\n\n  // Get the list of operations in \"pending\" status\"\n  function getPending() {\n    return operations.filter(op => op.tracker.status === OP_STATUS.PENDING)\n  }\n\n  /**\n   * Get the on-going operation that is blocking other ones.\n   * @method getBlocking\n   * @return {Object}\n   */\n  function getBlocking() {\n    return operations.find(op => {\n      return (\n        (op.isNegotiation && op.tracker.status !== OP_STATUS.FINISHED) ||\n        // Prevent new operations if the call is ending.\n        op.type === OPERATIONS.END\n      )\n    })\n  }\n\n  // Get the list of all operations.\n  function getAll() {\n    return operations\n  }\n\n  return {\n    // Methods.\n    add,\n    remove,\n    // TODO: Convert `operations` to redux friendly version.\n    toState: () => {},\n\n    // Getter methods.\n    getById: id => getBy('id', id),\n    // TODO: Does it make sense to have multiple operations of the same type?\n    getByType: type => getBy('type', type),\n    getNegotiation: () => getBy('isNegotiation', true),\n    getPending,\n    getBlocking,\n    getAll,\n\n    // Getter properties.\n    get isBlocked() {\n      return isBlocked()\n    }\n  }\n}\n","// Call plugin.\nimport { callActions as actions } from '../../interface/actions'\nimport * as eventTypes from '../../interface/eventTypes'\nimport { OP_TRANSITIONS, OP_STATUS, OPERATIONS } from '../../interface/constants'\n\n/**\n * Factory for an \"operation status\" tracker.\n * A \"status tracker\" is a utility object for managing call state updates\n *    and events for tracking the status of an operation.\n *\n * Each function is a code-block that was repeated numerous times in the\n *    CallManager. So it was split out to reduce noise.\n * The fact that this utility exists is a sign that how we do this is bad.\n * @method createTracker\n * @param {Object} container\n * @param {string} callId\n * @param {string} operationId\n * @param {string} eventId\n * @param {Object} opInfo\n * @param {string} opInfo.type\n * @param {boolean} opInfo.isLocal\n * @param {boolean} opInfo.isNegotiation\n * @param {Object} [joinOptions] Edge-case parameter when the operation is created elsewhere.\n */\nexport default function createTracker(container, callId, operationId, eventId, opInfo, joinOptions) {\n  const tracker = {\n    status: OP_STATUS.NOT_STARTED\n  }\n\n  const log = container.logManager.getLogger('CALL', callId)\n  // Human-readable operation type+endpoint, eg. \"local HOLD\", \"remote ADD_MEDIA\".\n  const opString = `${opInfo.isLocal ? 'local' : 'remote'} ${opInfo.type}`\n\n  if (opInfo.type === OPERATIONS.JOIN && joinOptions && joinOptions.isJoinedCall) {\n    // JOIN is a special-case. A newly joined call's `tracker.start()` method will not be called,\n    //    so initialize the tracker in an already started state. The join operation needs to be\n    //    changed for this to be fixed.\n    // TechDebt TODO: Have the joined call be put into state by the API, so that it exists when\n    //    `tracker.start()` is called for the other calls.\n    tracker.status = OP_STATUS.ONGOING\n  }\n\n  // The operation has started. Update status and perform side-effects.\n  tracker.start = () => {\n    log.info(`Operations: Starting ${opString} operation. Performing local changes.`)\n\n    if (tracker.status !== OP_STATUS.NOT_STARTED) {\n      log.debug(`Cannot start ${opString} operation; already started.`)\n      throw new Error('Operation tracking has already been started.')\n    }\n\n    startOperation(container, callId, operationId, eventId, opInfo)\n    tracker.status = OP_STATUS.ONGOING\n  }\n\n  // The operation has finished local processing. Update status and perform side-effects.\n  tracker.update = result => {\n    log.info(`Operations: Updating ${opString} operation. Waiting on remote response.`)\n\n    if (tracker.status !== OP_STATUS.ONGOING) {\n      log.debug(`Cannot update ${opString} operation; already pending.`)\n      throw new Error('Operation tracking cannot be updated.')\n    }\n    updateOperation(container, callId, operationId, eventId, opInfo, result)\n    tracker.status = OP_STATUS.PENDING\n  }\n\n  // The operation has received remote input and can resume. Update status and perform side-effects.\n  tracker.resume = () => {\n    log.info(`Operations: Resuming ${opString} operation. Finishing negotiation.`)\n\n    if (tracker.status !== OP_STATUS.PENDING) {\n      log.debug(`Cannot resume ${opString} operation; not pending a remote input.`)\n      throw new Error('Operation tracking cannot be resumed.')\n    }\n\n    resumeOperation(container, callId, operationId, eventId, opInfo)\n    tracker.status = OP_STATUS.RESOLVING\n  }\n\n  // The operation has finished. Update status and perform side-effects.\n  tracker.finish = err => {\n    log.info(`Operations: Finishing ${opString} operation as ${err ? 'failure' : 'success'}.`)\n\n    if (![OP_STATUS.ONGOING, OP_STATUS.PENDING, OP_STATUS.RESOLVING].includes(tracker.status)) {\n      log.debug(`Cannot finish ${opString} operation; already finished.`)\n      throw new Error('Operation tracking cannot be finished.')\n    }\n\n    finishOperation(container, callId, operationId, eventId, opInfo, err, tracker.status)\n    tracker.status = OP_STATUS.FINISHED\n  }\n\n  return tracker\n}\n\n/**\n * Perform side-effects of an operation starting:\n *    - Add an operation event to the call's report.\n *    - Update redux state to add the operation.\n *    - Emit an event to the application.\n * @method startOperation\n * @param {Object} container\n * @param {string} callId\n * @param {string} operationId\n * @param {string} eventId\n * @param {Object} opInfo\n * @param {string} opInfo.type\n * @param {boolean} opInfo.isLocal\n * @param {boolean} opInfo.isNegotiation\n * @returns {undefined}\n */\nexport function startOperation(container, callId, operationId, eventId, opInfo) {\n  const { context, emitEvent } = container\n  const { type, isNegotiation } = opInfo\n\n  // Update call state to indicate that an operation is starting.\n  context.dispatch(\n    actions.operationUpdate(callId, type, opInfo.isLocal, {\n      transition: OP_TRANSITIONS.START,\n      eventId,\n      isBlocking: isNegotiation,\n      operationId\n    })\n  )\n\n  // Emit \"operation start\" event for the call.\n  emitEvent(eventTypes.CALL_OPERATION, {\n    callId,\n    operationId,\n    isLocal: opInfo.isLocal,\n    operation: type,\n    transition: OP_TRANSITIONS.START,\n    previous: undefined\n  })\n}\n\n/**\n * Perform side-effects of an operation updating:\n *    - Update redux state to update the operation.\n *    - Emit an event to the application.\n * @method updateOperation\n * @param {Object} container\n * @param {string} callId\n * @param {string} operationId\n * @param {string} eventId\n * @param {Object} opInfo\n * @param {string} opInfo.type\n * @param {boolean} opInfo.isLocal\n * @param {boolean} opInfo.isNegotiation\n * @param {Object} result\n * @returns {undefined}\n */\nexport function updateOperation(container, callId, operationId, eventId, opInfo, result) {\n  const { context, emitEvent } = container\n\n  context.dispatch(\n    actions.operationUpdate(callId, opInfo.type, opInfo.isLocal, {\n      transition: OP_TRANSITIONS.UPDATE,\n      operationData: result && result.operationData ? result.operationData : undefined,\n      eventId,\n      operationId\n    })\n  )\n\n  // Emit \"operation update/finish\" event for the call.\n  emitEvent(eventTypes.CALL_OPERATION, {\n    callId,\n    operationId,\n    isLocal: opInfo.isLocal,\n    operation: opInfo.type,\n    transition: OP_TRANSITIONS.UPDATE,\n    previous: {\n      operation: opInfo.type,\n      status: OP_STATUS.ONGOING\n    }\n  })\n}\n\n/**\n * Perform side-effects of an operation resuming:\n *    - Update redux state to resume the operation.\n *    - Emit an event to the application.\n * @method resumeOperation\n * @param {Object} container\n * @param {string} callId\n * @param {string} operationId\n * @param {string} eventId\n * @param {Object} opInfo\n * @param {string} opInfo.type\n * @param {boolean} opInfo.isLocal\n * @returns {undefined}\n */\nexport function resumeOperation(container, callId, operationId, eventId, opInfo) {\n  const { context, emitEvent } = container\n\n  context.dispatch(\n    actions.operationUpdate(callId, opInfo.type, opInfo.isLocal, {\n      transition: OP_TRANSITIONS.RESUME,\n      eventId,\n      operationId\n    })\n  )\n\n  // Emit \"operation resume\" event for the call.\n  emitEvent(eventTypes.CALL_OPERATION, {\n    callId,\n    operationId,\n    isLocal: opInfo.isLocal,\n    operation: opInfo.type,\n    transition: OP_TRANSITIONS.RESUME,\n    previous: {\n      operation: opInfo.type,\n      status: OP_STATUS.PENDING\n    }\n  })\n}\n\n/**\n * Perform side-effects of an operation finishing:\n *    - Finish the operation's event in the call report.\n *    - Update redux state to update the operation.\n *    - Emit an event to the application.\n * @method finishOperation\n * @param {Object} container\n * @param {string} callId\n * @param {string} operationId\n * @param {string} eventId\n * @param {Object} opInfo\n * @param {string} opInfo.type\n * @param {boolean} opInfo.isLocal\n * @param {boolean} opInfo.isNegotiation\n * @param {BasicError} err\n * @param {string} status The current status of the operation, before being finished.\n * @returns {undefined}\n */\nexport function finishOperation(container, callId, operationId, eventId, opInfo, err, status) {\n  const { context, emitEvent } = container\n\n  // Update call state to indicate the operation is finished, since it failed.\n  context.dispatch(\n    actions.operationUpdate(callId, opInfo.type, opInfo.isLocal, {\n      transition: OP_TRANSITIONS.FINISH,\n      eventId,\n      operationId\n    })\n  )\n\n  // Emit \"operation finish\" event for the application.\n  emitEvent(eventTypes.CALL_OPERATION, {\n    callId,\n    operationId,\n    isLocal: opInfo.isLocal,\n    operation: opInfo.type,\n    transition: OP_TRANSITIONS.FINISH,\n    error: err,\n    previous: {\n      operation: opInfo.type,\n      status\n    }\n  })\n}\n","/**\n * Operation flow for a consultative transfer operation.\n *\n * This operation has its own flow because of special-handling needed:\n *    - It acts on two local calls, which both need call report / status updates.\n *    - The primary call's \"response\" notification is of two different types,\n *        depending on success or failure.\n *    - The second call receives a generic \"call end\" notification to indicate\n *        success, and no notification on failure.\n */\nexport default function createFlow(container, operation, stages) {\n  const { context } = container\n\n  /*\n   * Boolean map between a call ID and whether that call has received remote feedback or not.\n   */\n  const responsesReceived = operation.calls.reduce((acc, cur) => {\n    acc[cur.callId] = false\n    return acc\n  }, {})\n\n  /*\n   * Boolean whether the flow has performed its \"resolve\" functionality or not yet.\n   *    This is used to ensure multiple notifications can't trigger it multiple times\n   *    in a race-condition.\n   */\n  let hasResolved = false\n\n  /**\n   * Helper function to know if every call has received feedback.\n   *    When this is true, that indicates the operation can resolve successfully.\n   * Note: In a failure scenario, only primary call will receive feedback.\n   * @method hasAllFeedback\n   * @returns {boolean}\n   */\n  function hasAllFeedback() {\n    // The flow has all the feedback needed to complete the operation if it has received\n    //    a notification for every call.\n    return operation.calls.every(call => responsesReceived[call.callId] === true)\n  }\n\n  /**\n   * A consultative transfer operation has been started locally. Perform the\n   *    operation, while tracking it against two calls.\n   * @method localChanges\n   */\n  async function localChanges(calls) {\n    operation.tracker.start()\n\n    /*\n     * Validate the operation before starting it. If the operation deems that it\n     *    can't be done right now, avoid doing any state tracking, etc. for the\n     *    operation.\n     */\n    const validationError = stages.validate(context.getState(), calls)\n    if (validationError) {\n      // Update the Call Report to indicate the operation ended with an error.\n      operation.reportEvent.endEvent(validationError)\n      operation.tracker.finish(validationError)\n      throw validationError\n    }\n\n    try {\n      // Update operation tracking; performing signalling.\n      operation.tracker.update()\n\n      // Perform the operation.\n      await stages.signalling(calls)\n    } catch (err) {\n      operation.reportEvent.endEvent(err)\n\n      // Finish operation tracking; operation has failed.\n      operation.tracker.finish(err)\n      throw err\n    }\n  }\n\n  /**\n   * A \"session complete\" notification has been received for the primay call,\n   *    indicating the consultative transfer succeeded. The primary call needs\n   *    to be cleaned-up. The secondary call will receive a notification in\n   *    this scenario.\n   * @method remoteSuccess\n   */\n  async function remoteSuccess(call, params) {\n    responsesReceived[call.id] = true\n    /*\n     * TODO: Pre-processing logic.\n     *    - KJS-2175 Queue Inputs: Is the operation ready for this notification?\n     *    - Update call report/status: From \"waiting\" to \"processing\"?\n     */\n    await stages.remoteSuccess(call, params)\n\n    if (hasAllFeedback()) {\n      return onComplete()\n    }\n  }\n\n  /**\n   * A \"session failure\" notification has been received for the primary call,\n   *    indicating the consultative transfer failed. The secondary call will not\n   *    receive a notification in this scenario.\n   * @method remoteFailure\n   */\n  async function remoteFailure(call, params) {\n    /*\n     * TODO: Pre-processing logic.\n     *    - KJS-2175 Queue Inputs: Is the operation ready for this notification?\n     *    - Update call report/status: From \"waiting\" to \"processing\"?\n     */\n    const error = await stages.remoteFailure(call, params)\n\n    return onComplete(error)\n  }\n\n  /**\n   * A \"call end\" notification has been received for the secondary call,\n   *    indicating the consultative transfer succeeded. The backend considers\n   *    the secondary call ended, so only need client-side updates.\n   * The primary call's notification will trigger updates to the tracker and call report.\n   * @method callEndSuccess\n   */\n  async function callEnd(call, params) {\n    responsesReceived[call.id] = true\n\n    // Handle the notification the same as the \"sessionComplete\" notification.\n    await stages.remoteSuccess(call, params)\n\n    if (hasAllFeedback()) {\n      return onComplete()\n    }\n  }\n\n  /**\n   * \"Resolve\" functionality for the operation.\n   * @method onComplete\n   * @param {Object} [error] If a failure scenario, the error information.\n   */\n  function onComplete(error) {\n    if (hasResolved) {\n      return\n    }\n    hasResolved = true\n\n    operation.reportEvent.endEvent(error)\n    operation.tracker.finish(error)\n  }\n\n  const feedbackHandlers = {\n    sessionComplete: remoteSuccess,\n    sessionFail: remoteFailure,\n    callEnd\n  }\n\n  /**\n   * Operation method for receiving any/all responses from the remote side.\n   * @method receiveResponse\n   * @param {Object} call\n   * @param {Object} params\n   * @param {string} params.eventType\n   */\n  async function receiveResponse(call, params) {\n    const eventType = params.eventType\n    if (!eventType) {\n      throw new Error(`No event type provided for ${operation.type} feedback!`)\n    } else if (typeof feedbackHandlers[eventType] === 'undefined') {\n      throw new Error(`No ${eventType} on the flow!`)\n    }\n\n    return feedbackHandlers[eventType](call, params)\n  }\n\n  return {\n    start: localChanges,\n    receiveResponse\n  }\n}\n","import localOpFlow from './LocalNegotiation'\n\n/**\n * Operation flow for a direct transfer operation.\n *\n * This operation has its own flow because of special-handling needed:\n *    - The \"response\" notification is of two different types, depending\n *        on success or failure.\n */\nexport default function createFlow(container, operation, stages) {\n  /**\n   * A direct transfer operation has been started locally.\n   * The \"local changes\" portion is identical to a local\n   *    negotiation. Re-use that flow.\n   * @method localChanges\n   */\n  const localChanges = localOpFlow(container, operation, stages).start\n\n  /**\n   * Direct transfer is a Negotiation, but it receives \"complex\" remote responses. Expose a\n   *    `receiveResponse` method that the CallManager expects for a Negotiation, but simply\n   *    have it redirect to the appropriate \"complex\" method.\n   */\n  async function receiveResponse(call, params) {\n    const handler = params.eventType === 'sessionComplete' ? remoteSuccess : remoteFailure\n    return handler(call, params)\n  }\n\n  /**\n   * A \"session complete\" notification has been received, indicating the\n   *    direct transfer succeeded. The original call needs to be cleaned-up.\n   * @method remoteSuccess\n   */\n  async function remoteSuccess(call, params) {\n    /*\n     * TODO: Pre-processing logic.\n     *    - KJS-2175 Queue Inputs: Is the operation ready for this notification?\n     *    - Update call report/status: From \"waiting\" to \"processing\"?\n     */\n    await stages.remoteSuccess(call, params)\n\n    operation.reportEvent.endEvent()\n    operation.tracker.finish()\n  }\n\n  /**\n   * A \"session failure\" notification has been received, indicating the\n   *    direct transfer failed. The original call still exists.\n   * @method remoteFailure\n   */\n  async function remoteFailure(call, params) {\n    /*\n     * TODO: Pre-processing logic.\n     *    - KJS-2175 Queue Inputs: Is the operation ready for this notification?\n     *    - Update call report/status: From \"waiting\" to \"processing\"?\n     */\n    const error = await stages.remoteFailure(call, params)\n\n    operation.reportEvent.endEvent(error)\n    operation.tracker.finish(error)\n  }\n\n  return {\n    start: localChanges,\n    receiveResponse\n  }\n}\n","import createNegFlow from './LocalNegotiation'\n\n// Call plugin.\nimport { OP_STATUS } from '../../../interface/constants'\nimport { getCallById } from '../../../interface/selectors'\n\n/**\n * Operation flow for a join operation.\n *\n * This operation has its own flow because of special-handling needed:\n *    - It acts on three local calls (two existing, one new).\n *    - The existing calls' \"response\" notification is of two different types,\n *        depending on success or failure.\n *    - The new, joined call's response notification is of two different types,\n *        depending on success or failure.\n */\nexport default function createFlow(container, operation, stages) {\n  const { context } = container\n  const negoFlow = createNegFlow(container, operation, stages)\n\n  /**\n   * A join operation has been started locally.\n   * @method localChanges\n   */\n  async function localChanges(calls, params) {\n    operation.tracker.start()\n\n    /*\n     * Validate the operation before starting it. If the operation deems that it\n     *    can't be done right now, avoid doing any state tracking, etc. for the\n     *    operation.\n     */\n    const validationError = stages.validate(context.getState(), calls)\n    if (validationError) {\n      // Update the Call Report to indicate the operation ended with an error.\n      operation.reportEvent.endEvent(validationError)\n      operation.tracker.finish(validationError)\n      throw validationError\n    }\n\n    try {\n      // Perform the operation.\n      const result = await stages.localOffer(calls, ...params)\n\n      // Update operation tracking; performing signalling.\n      operation.tracker.update()\n      await stages.signalling(calls, result)\n    } catch (err) {\n      operation.reportEvent.endEvent(err)\n\n      // Finish operation tracking; operation has failed.\n      operation.tracker.finish(err)\n      throw err\n    }\n  }\n\n  /**\n   * A \"respond call update\" notification has been received for the new, joined\n   *    call, which indicates a successful operation. Process the answer to\n   *    establish the joined call.\n   * @method joinAnswer\n   */\n  async function joinAnswer(call, params) {\n    // KJS-2176 TODO: Improve the handling of the `respondCallUpdate`. If the new call\n    //    is \"Connected\", the other two should be Ended at the same time.\n    return await negoFlow.receiveResponse(call, params)\n  }\n\n  /**\n   * A \"call end\" notification has been received for the new, joined call,\n   *    which indicates a failed operation. The other calls do not receive\n   *    notifications in this scenario, so all must be updated.\n   * @method joinEnd\n   */\n  async function joinEnd(call, params) {\n    let error\n    await operation.calls.map(async info => {\n      const call = getCallById(context.getState(), info.callId)\n      if (info.role === 'joined') {\n        return stages.joinedFailure(call, params)\n      } else {\n        error = await stages.remoteFailure(call, params)\n      }\n    })\n\n    operation.reportEvent.endEvent(error)\n    operation.tracker.finish(error)\n  }\n\n  /**\n   * A \"session complete\" notification has been received for an existing call,\n   *    which indicates operation success. This call needs to be cleaned-up.\n   * Note: Both existing calls receive their own notification, so only update\n   *    one at a time.\n   * @method remoteSuccess\n   */\n  async function remoteSuccess(call, params) {\n    /*\n     * TODO: Pre-processing logic.\n     *    - KJS-2175 Queue Inputs: Is the operation ready for this notification?\n     *    - Update call report/status: From \"waiting\" to \"processing\"?\n     */\n    await stages.remoteSuccess(call, params)\n\n    /*\n     * Note: Don't manage operation tracking with these success operations.\n     * Join receives 3 notifications to indicate it succeeded (a respondCallUpdate for the new, joined\n     *    call, and these sessionComplete for the existing calls). Because of this, there is overlap between\n     *    them for when the operation actually ends. Currently, it is ended by the `respondCallUpdate`\n     *    notification which is received first, so don't try to end it again here.\n     */\n  }\n\n  /**\n   * A \"session fail\" notification has been received for an existing call,\n   *    which indicates a failed operation.\n   * Note: Both existing calls receive their own notification, so only update\n   *    one at a time.\n   * @method remoteFailure\n   */\n  async function remoteFailure(call, params) {\n    /*\n     * TODO: Pre-processing logic.\n     *    - KJS-2175 Queue Inputs: Is the operation ready for this notification?\n     *    - Update call report/status: From \"waiting\" to \"processing\"?\n     */\n    const error = await stages.remoteFailure(call, params)\n\n    if (operation.status !== OP_STATUS.FINISHED) {\n      // Two \"failure\" notifications will be received; one for each call. Only end the\n      //    the operation on the first notification processed to avoid overlap.\n      operation.reportEvent.endEvent(error)\n      operation.tracker.finish(error)\n    }\n  }\n\n  const feedbackHandlers = {\n    respondCallUpdate: joinAnswer,\n    callEnd: joinEnd,\n    sessionComplete: remoteSuccess,\n    sessionFail: remoteFailure\n  }\n\n  /**\n   * Operation method for receiving any/all responses from the remote side.\n   * @method receiveResponse\n   * @param {Object} call\n   * @param {Object} params\n   * @param {string} params.eventType\n   */\n  async function receiveResponse(call, params) {\n    const eventType = params.eventType\n    if (!eventType) {\n      throw new Error(`No event type provided for ${operation.type} feedback!`)\n    } else if (typeof feedbackHandlers[eventType] === 'undefined') {\n      throw new Error(`No ${eventType} on the flow!`)\n    }\n\n    return feedbackHandlers[eventType](call, params)\n  }\n\n  return {\n    start: localChanges,\n    receiveResponse\n  }\n}\n","// Call plugin.\nimport { CALL_STATES } from '../../../../constants'\nimport { OPERATIONS, OP_STATUS } from '../../../../interface/constants'\nimport { callActions as actions } from '../../../../interface/actions'\nimport * as eventTypes from '../../../../interface/eventTypes'\nimport { getMediaState } from '../../../../utils/state'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\nimport { getCallById } from '../../../../interface/selectors'\n\n/**\n * Operation flow for local negotiations.\n *\n * Defines how the \"inputs\" should be handled from each side of the call\n *    (ie. local API call and remote response received). Handles common\n *    logic for all negotiations, leaving actual call/webrtc processing\n *    to the Operation itself.\n *\n * A Local Negotiation can receive the following inputs:\n *    - API Call: To start the local negotiation.\n *    - Notification Response (success): The remote response to complete negotiation.\n *    - Notification Response (error): The remote response to indicate negotiation\n *        failed due to an error on the remote end.\n */\nexport default function createFlow(container, operation, stages) {\n  const { context, emitEvent, logManager } = container\n\n  /*\n   * A negotiation response whose processing was deferred.\n   */\n  let deferredResponse\n  /*\n   * Flag for whether the negotiation has received the remote response.\n   */\n  let responseReceived = false\n  // Whether the REST response has been received or not.\n  let restComplete = false\n\n  /**\n   * Entry for the first half of the flow.\n   * @method start\n   * @async\n   * @param {string} callId ID for the call being operated on.\n   * @param {Object} params Operation\n   * @return {Promise<undefined>}\n   * @throws {Error} Throws if the flow was previously started.\n   */\n  async function start(callId, params) {\n    if (operation.status !== OP_STATUS.NOT_STARTED) {\n      throw new Error('Flow cannot be started a second time.')\n    }\n\n    return localChanges(callId, params)\n  }\n\n  /**\n   * Entry for the first half of the flow: perform local changes on the call\n   *    before signalling to the remote side.\n   * @method resume\n   * @param {Object} call The call being acted on.\n   * @param {Object} params Operation\n   * @return {Promise<undefined>}\n   */\n  async function resume(call, params) {\n    if (operation.status !== OP_STATUS.PENDING) {\n      // The operation is not expecting a remote response in this state. This error indicates a bug.\n      throw new Error('Cannot receive response in current state.')\n    } else if (responseReceived || deferredResponse) {\n      // Negotiations only receive one response. This error indicates a bug.\n      throw new Error('Negotiations should only receive one response.')\n    }\n\n    if (restComplete) {\n      // Expected scenario.\n      return remoteResponse(call, params)\n    } else {\n      // The REST response has not been received yet. Defer processing this notification until later.\n      const log = logManager.getLogger('CALL', call.id)\n      log.debug(`Received negotiation answer for local ${operation.type} too early; delaying processing.`)\n\n      return Promise.race([\n        new Promise((resolve, reject) => {\n          deferredResponse = { params, promise: { resolve, reject } }\n        }),\n        new Promise(resolve =>\n          setTimeout(() => {\n            resolve(new Error('timeout'))\n          }, 500)\n        )\n      ]).then(result => {\n        if (result && result.message === 'timeout') {\n          /*\n           * If we still have not received the REST response 500ms after receiving the websocket\n           *    notification, assume issues. Try to process the notification and just continue with\n           *    the operation.\n           * TODO: Theoretically, we never need to wait for the REST response if we receive the\n           *    remote response, since that implies signaling was successful and is over.\n           */\n          log.debug('Timed-out waiting for signaling response; attempting to process.')\n          deferredResponse = undefined\n          return remoteResponse(call, params)\n        }\n        return result\n      })\n    }\n  }\n\n  /**\n   * Perform local changes on the call before signalling to the remote side.\n   * @method localChanges\n   * @async\n   * @param {string} callId ID for the call being operated on.\n   * @param {Object} params Operation\n   * @return {Promise<undefined>}\n   * @throws {BasicError} Throws if the call is in an invalid state for the operation.\n   * @throws {BasicError} Throws if the local changes fail.\n   */\n  async function localChanges(callId, params) {\n    /*\n     * Check for glare scenarios.\n     * ...\n     */\n\n    // Start tracking this operation in state.\n    operation.tracker.start()\n\n    /*\n     * Validate the operation before starting it. If the operation deems that it\n     *    can't be done right now, avoid doing any state tracking, etc. for the\n     *    operation.\n     */\n    if (stages.validate) {\n      const validationError = stages.validate(context.getState(), callId, ...params)\n      if (validationError) {\n        // Update the Call Report to indicate the operation ended with an error.\n        operation.reportEvent.endEvent(validationError)\n        operation.tracker.finish(validationError)\n        throw validationError\n      }\n    }\n\n    /*\n     * Perform the local portions of the negotiation.\n     */\n    try {\n      const result = await stages.localOffer(callId, ...params)\n\n      // Update status to indicate the operation is now in 'Signalling'.\n      operation.tracker.update(result)\n      await stages.signalling(callId, result)\n      restComplete = true\n\n      /*\n       * If there was a deferred response, that means the websocket response was received\n       *    before the REST response. Process it now, but don't block on it.\n       */\n      if (deferredResponse && operation.status === OP_STATUS.PENDING) {\n        const { params, promise } = deferredResponse\n        const call = getCallById(context.getState(), callId)\n        deferredResponse = undefined\n        remoteResponse(call, params).then(promise.resolve).catch(promise.reject)\n      }\n\n      return result\n    } catch (err) {\n      /*\n       * If `localOffer` failed, but the operation was already finished elsewhere, that means\n       *    the remote response was received & processed. Don't try to update it further.\n       */\n      if (operation.status === OP_STATUS.FINISHED || responseReceived) {\n        return\n      } else {\n        /*\n         * Operation failed, end the operation tracking and throw the error.\n         */\n        operation.reportEvent.endEvent(err)\n        operation.tracker.finish(err)\n\n        throw err\n      }\n    }\n  }\n\n  /**\n   * Entry for the second half of the flow: handle the remote response to complete the negotiation.\n   *    If the response includes an answer SDP, process it to finish the negotiation.\n   *    If the response indicate an error, rollback the local changes.\n   * @method remoteResponse\n   * @async\n   * @param {Object} call The call being operated on.\n   * @param {Object} params Response data provided by the remote endpoint.\n   * @return {Promise<undefined>}\n   */\n  async function remoteResponse(call, params) {\n    responseReceived = true\n\n    const wrtcsSessionId = call.wrtcsSessionId\n    const log = logManager.getLogger('CALL', call ? call.id : undefined)\n\n    // Before processing the response, update status to indicate the operation is resuming.\n    operation.tracker.resume()\n\n    if (call.state === CALL_STATES.ENDED) {\n      // Scenario: The notification is about a call that state says is ended.\n      //    Ignore the notification, since ended calls should not have an active\n      //    webRTC Session.\n      log.info('Update response for ended call. Ignoring.', { wrtcsSessionId })\n      return\n    }\n\n    /**\n     * Check that the notification was not an \"error\" notification.\n     * Status code 49 with a `retryAfter` value indicates the original operation\n     *    failed (likely glare condition) and the SDK should retry the operation.\n     */\n    if (!params.sdp && params.code === 49 && params.retryAfter) {\n      await rollbackLocal(call, params)\n      return\n    }\n\n    // Dispatch a custom parameters received action/event if any custom parameters\n    //    were received as part of the notification.\n    // TODO: Handle this is a more general way, since multiple notifications can\n    //    have custom parameters on them.\n    if (params.customParameters) {\n      const customParameters = params.customParameters\n      const customNames = customParameters.map(param => param.name)\n\n      log.debug(`Received custom parameters as part of the Call: ${customNames}.`)\n      context.dispatch(\n        actions.customParametersReceived(call.id, {\n          customParameters\n        })\n      )\n\n      // Emit the associated event with the above action\n      emitEvent(eventTypes.CUSTOM_PARAMETERS, {\n        callId: call.id,\n        customParameters\n      })\n    }\n\n    return await processResponse(call, params)\n  }\n\n  /**\n   * Negotiation step to process the remote answer SDP.\n   *\n   * Process the answer SDP, update call state to mark the operation as\n   *    finished, then tell the application of the update.\n   * @method processResponse\n   * @async\n   * @param {Object} call The call being operated on.\n   * @param {Object} params Response data provided by the remote endpoint.\n   * @return {Promise<undefined>}\n   */\n  async function processResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    log.info(`Processing remote response for local ${operation.type} operation.`)\n    const mediaState = getMediaState(call)\n    log.debug(`Current call info; State: ${call.state}, MediaState: ${mediaState}.`)\n\n    try {\n      await stages.remoteAnswer(call, params)\n    } catch (err) {\n      operation.reportEvent.endEvent(err)\n      operation.tracker.finish(err)\n      throw err\n    }\n\n    operation.reportEvent.endEvent()\n    operation.tracker.finish()\n  }\n\n  /**\n   * Negotiation step to undo the local changes.\n   * @method rollbackLocal\n   * @async\n   * @param {Object} call\n   * @param {Object} params\n   * @return {Promise<undefined>}\n   */\n  async function rollbackLocal(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n    // TODO:  re-perform operation internally after some time,  as indicated by retryAfter.\n    log.debug(`Response indicates an error scenario (${params.message}). Aborting operation.`)\n    const error = new BasicError({\n      message: 'Operation failed on remote side; aborting local operation by reverting it.',\n      code: callCodes.GENERIC_ERROR\n    })\n    operation.reportEvent.endEvent(error)\n\n    // Trigger a rollback\n    if (stages.rollback) {\n      let opData\n      // Add Media & Add Basic Media require an extra parameter: medias\n      if (operation.type === OPERATIONS.ADD_MEDIA || operation.type === OPERATIONS.ADD_BASIC_MEDIA) {\n        const localOp = call.currentOperations.find(op => {\n          return op.id === operation.id\n        })\n\n        if (localOp && localOp.operationData) {\n          opData = localOp.operationData\n        }\n      }\n\n      try {\n        await stages.rollback(call.webrtcSessionId, opData)\n      } catch (err) {\n        log.info(`Rollbacking back local ${operation.type} failed. Error: ${err.message}`)\n        throw err\n      }\n    }\n    // Finally, finish tracking the current operation\n    operation.tracker.finish(error)\n    return\n  }\n\n  return {\n    start, // Start the negotiation.\n    receiveResponse: resume // Handle remote response.\n  }\n}\n","/**\n * Operation flow for local-only operations.\n *\n * Handles common logic for all local-only operations, leaving actual\n *    call/webrtc processing to the Operation itself.\n *\n * A Local Operation can receive the following inputs:\n *    - API Call: To start the local negotiation.\n */\nexport default function createFlow(container, operation, stages) {\n  const { context } = container\n\n  /**\n   * @method start\n   * @async\n   * @param {string} callId\n   * @param {Object} params\n   * @throws {BasicError} Throws an error if operation validation fails.\n   * @throws {BasicError} Throws an error if the operation itself fails.\n   * @return {Promise<Object|undefined>}\n   */\n  async function start(callId, params) {\n    /*\n     * Check for glare scenarios.\n     * ...\n     */\n\n    // Start tracking this operation in state.\n    operation.tracker.start()\n\n    /*\n     * Validate the operation before starting it. If the operation deems that it\n     *    can't be done right now, avoid doing any state tracking, etc. for the\n     *    operation.\n     */\n    if (stages.validate) {\n      const validationError = stages.validate(context.getState(), callId, ...params)\n      if (validationError) {\n        // Update the Call Report to indicate the operation ended with an error.\n        operation.reportEvent.endEvent(validationError)\n        operation.tracker.finish(validationError)\n        throw validationError\n      }\n    }\n\n    /*\n     * Perform the local portions of the negotiation.\n     */\n    try {\n      const result = await stages.localOffer(callId, ...params)\n\n      if (stages.signalling) {\n        operation.tracker.update()\n        await stages.signalling(callId, ...params, result)\n      }\n\n      operation.reportEvent.endEvent()\n      operation.tracker.finish()\n      return result\n    } catch (err) {\n      /*\n       * Operation failed, end the operation tracking and throw the error.\n       */\n      operation.reportEvent.endEvent(err)\n      operation.tracker.finish(err)\n\n      throw err\n    }\n  }\n\n  return {\n    start // Start the operation.\n  }\n}\n","// Call plugin.\nimport { getCallByWrtcsSessionId } from '../../../interface/selectors'\nimport { callActions as actions } from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\n\n// Libraries\nimport sdpTransform from 'sdp-transform'\n\n/*\n * Operation flow for receiving a new, incoming call.\n *    ie. Only for handling a remote offer when the call doesn not exist already.\n *\n * Handles lots of logic for setting up the call in the SDK, and handling parts\n *    of the notification itself (eg. custom parameters), then hands-off to the\n *    operation itself to setup the WebRTC portions of the call.\n */\nexport default function createFlow(container, operation, stages) {\n  const { context, Callstack, emitEvent, logManager } = container\n\n  /**\n   * Handle incoming call \"establish offer\" messages.\n   * @method newIncoming\n   * @param {string} wrtcsSessionId The ID used by the backend to identify the call.\n   * @param {Object} params Arbitrary parameter object.\n   * @param {string} [channel] The notification channel the message was received on.\n   */\n  async function newIncoming(wrtcsSessionId, params, channel) {\n    const log = logManager.getLogger('CALL', params.callId)\n    log.info('Received new incoming call; initiating.', { wrtcsSessionId })\n\n    const call = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (call) {\n      log.warn('Local call already exists; ignoring incoming call.')\n      return\n    }\n\n    const isSlowStart = !params.sdp\n    let mediaOffered = null\n    if (!isSlowStart) {\n      // For a regular call, parse the SDP & collect what media has been offered by the caller:\n      // We only support two types\n      mediaOffered = { audio: false, video: false }\n      sdpTransform.parse(params.sdp).media.forEach(aMedia => {\n        mediaOffered[aMedia.type] = true\n      })\n    }\n\n    // Dispatch the action right away so the call is in state at this point.\n    context.dispatch(\n      actions.callIncoming(params.callId, {\n        remoteParticipant: {\n          displayName: params.remoteName,\n          displayNumber: params.remoteNumber\n        },\n        to: params.calleeNumber,\n        // Number of the remote participant when the call was established.\n        from: params.remoteNumber,\n        // The ID that the backend uses to track this webRTC session.\n        wrtcsSessionId,\n\n        // Whether the call was received as a slow start call or not.\n        isSlowStart,\n\n        // Capture what the caller offered in terms of media\n        // For a slow-start call, this will be null.\n        mediaOffered\n      })\n    )\n\n    // Start tracking this operation now that the call exists in state.\n    operation.tracker.start()\n\n    emitEvent(eventTypes.CALL_INCOMING, {\n      callId: params.callId,\n      mediaOffered\n    })\n\n    // Dispatch a custom parameters received action/event if any custom parameters\n    //    were received as part of the notification.\n    // TODO: Handle this is a more general way, since multiple notifications can\n    //    have custom parameters on them.\n    if (params.customParameters) {\n      const customParameters = params.customParameters\n      const customNames = customParameters.map(param => param.name)\n\n      log.debug(`Received custom parameters as part of the Call: ${customNames}.`)\n      context.dispatch(\n        actions.customParametersReceived(params.callId, {\n          customParameters\n        })\n      )\n\n      emitEvent(eventTypes.CUSTOM_PARAMETERS, {\n        callId: params.callId,\n        customParameters\n      })\n    }\n\n    try {\n      await stages.remoteOffer(wrtcsSessionId, params)\n    } catch (err) {\n      operation.tracker.finish(err)\n      operation.reportEvent.endEvent(err)\n      return\n    }\n\n    // Workaround for re-syncing incoming calls received via PUSH.\n    // TODO: Check if this can be removed once we start receiving TURN credentials with incoming call notifications.\n    if (channel && channel.toLowerCase() === 'push') {\n      /*\n       * If the incoming call notification came from the push channel, then there\n       *    can be a gap where other notifications can be missed during the time\n       *    it takes to setup the websocket channel. Resync the call state to\n       *    make sure it is not out-of-sync with the backend.\n       */\n      try {\n        await Callstack.operations.resyncCallState.stages.signalling(params.callId)\n      } catch (err) {\n        // Don't do anything with an error here. This is a side-effect, and the\n        //    operation will handle any required changes.\n      }\n    }\n\n    operation.tracker.finish()\n    operation.reportEvent.endEvent()\n  }\n\n  return {\n    start: newIncoming\n  }\n}\n","// Call plugin.\nimport * as eventTypes from '../../../interface/eventTypes'\nimport { callActions as actions } from '../../../interface/actions'\nimport { getCallById } from '../../../interface/selectors'\n\nimport { getMediaState } from '../../../utils/state'\n\n/**\n * Operation flow for remote negotiations.\n *\n * Handles common logic for processing the notification (eg. custom parameters),\n *    then hands-off to the operation itself.\n *\n * A Remote Negotiation can recieve the following inputs:\n *    - Notification: To start the remote negotiation.\n */\nexport default function createFlow(container, operation, stages) {\n  const { context, emitEvent, logManager } = container\n\n  /**\n   * No existing on-going operation; it is a new remote op.\n   * @method newRemoteOperation\n   * @async\n   * @param {Object} call\n   * @param {Object} opInfo\n   * @param {Object} params\n   * @throws {BasicError} Throws an error if the operation itself fails.\n   * @return {Promise<undefined>}\n   */\n  async function newRemoteOperation(call, opInfo, params) {\n    const log = logManager.getLogger('CALL', call.id)\n    operation.tracker.start()\n\n    // Get the new call state after starting the remote operation\n    call = getCallById(context.getState(), call.id)\n    try {\n      const mediaState = getMediaState(call)\n      log.info(`Processing update request as remote ${opInfo.remoteOp} operation in ${mediaState} scenario.`)\n\n      const result = await stages.remoteOffer(call, params, opInfo)\n      operation.tracker.update(result)\n      await stages.signalling(call, params, result)\n    } catch (err) {\n      operation.reportEvent.setError(err)\n      operation.reportEvent.endEvent()\n      operation.tracker.finish(err)\n\n      throw err\n    }\n\n    // Regular operations are finished now.\n    operation.reportEvent.endEvent()\n    operation.tracker.finish()\n  }\n\n  /**\n   * Entry for a new remote negotiation. Performs the whole operation.\n   * @method remoteChanges\n   * @async\n   * @param {Object} call\n   * @param {Object} opInfo\n   * @param {Object} params\n   * @return {Promise<undefined>}\n   */\n  async function remoteChanges(call, opInfo, params) {\n    const log = logManager.getLogger('CALL', call ? call.id : undefined)\n    log.info('Received new update call request; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    // Dispatch a custom parameters received action/event if any custom parameters were received as part of the notification\n    if (params.customParameters) {\n      const customParameters = params.customParameters\n      const customNames = customParameters.map(param => param.name)\n\n      log.debug(`Received custom parameters as part of the Call: ${customNames}.`)\n      context.dispatch(\n        actions.customParametersReceived(call.id, {\n          customParameters\n        })\n      )\n      // Emit the associated event with the above action\n      emitEvent(eventTypes.CUSTOM_PARAMETERS, { callId: call.id, customParameters })\n    }\n\n    return await newRemoteOperation(call, opInfo, params)\n  }\n\n  return {\n    start: remoteChanges\n  }\n}\n","// Call plugin.\nimport { OP_STATUS } from '../../../interface/constants'\n\n// Call Reports.\nimport { REPORTER_OPERATION_EVENTS_MAP } from '../../reporter/constants'\n\nexport function createGeneric(container, operation, stages) {\n  /**\n   * Flow for a generic \"remote update\" notification.\n   * Simply tracks the operation and processes the notification.\n   *\n   * @method generic\n   * @param {Object} call The call object being operated on.\n   * @param {Object} params Operation-specific data.\n   * @return {Promise<undefined>}\n   */\n  async function generic(call, params) {\n    operation.tracker.start()\n    await stages.remoteOffer(call.wrtcsSessionId, params)\n    operation.tracker.finish()\n    operation.reportEvent.endEvent()\n  }\n\n  return { start: generic }\n}\n\nexport function createPending(container, operation, stages) {\n  /**\n   * Flow for an update received while there is a PENDING local operation on-going.\n   *\n   * This is intended for the following scenarios:\n   *    - a WebRTC prAnswer SDP (during MAKE).\n   *    - a \"call ringing\" update (during MAKE).\n   * @method pendingUpdate\n   * @param {Object} call The call object being operated on.\n   * @param {string} stage The name of the stage that should handle the notification.\n   * @param {Object} params Operation-specific data.\n   * @return {Promise<undefined>}\n   */\n  async function pendingUpdate(call, stage, params) {\n    // Add an event as part of the on-going operation event.\n    const notificationEvent = operation.reportEvent.addEvent(REPORTER_OPERATION_EVENTS_MAP[stage])\n\n    // Process the notification as normal.\n    try {\n      await stages[stage](call.wrtcsSessionId, ...params)\n      notificationEvent.endEvent()\n    } catch (err) {\n      notificationEvent.endEvent(err)\n    }\n  }\n\n  return { start: pendingUpdate }\n}\n\nexport function createEnded(container, operation, stages) {\n  const { start: generic } = createGeneric(container, operation, stages)\n\n  /**\n   * Flow for a \"call ended\" update.\n   * This update can be received at any time, either solicited or unsolicited.\n   * @method ended\n   * @param {Object} call The call object being operated on.\n   * @param {Object} params Operation-specific data.\n   * @param {Operation} [pendingOp] The pending Operation that this notification interrupted.\n   * @return {Promise<undefined>}\n   */\n  async function ended(call, params, pendingOp) {\n    // Handle the notification itself the same as a generic update.\n    await generic(call, params)\n\n    // ...but then, if it interrupted another operation, the other operation needs to be ended.\n    if (pendingOp) {\n      pendingOp.reportEvent.endEvent()\n      if (pendingOp.tracker.status !== OP_STATUS.FINISHED) {\n        // KJS-2176 TODO: For transfers, need to coordinate between this \"end call\" notification and the \"transfer success\"\n        //    notification that will be received for the other call. Only one of them should be completing the operation.\n        pendingOp.tracker.finish()\n      }\n    }\n  }\n\n  return { start: ended }\n}\n","// Call plugin.\nimport { CALL_STATES } from '../../constants'\nimport { OPERATIONS } from '../../interface/constants'\nimport { getCallById, getCallByWrtcsSessionId } from '../../interface/selectors'\n\n// Call Manager.\nimport { operationMap, notificationMap } from './operationMap'\n\nimport createTracker from './OperationTracker'\nimport registerNegotiation from './models/Negotiation'\nimport registerUpdate from './models/Update'\nimport registerMulti from './models/MultiCall'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../errors'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\nexport default function createManager(bottle) {\n  registerNegotiation(bottle)\n  registerUpdate(bottle)\n  registerMulti(bottle)\n  bottle.factory('CallManager', () => callManager(bottle.container))\n}\n\n/**\n * @method checkCallExistence\n * @returns {undefined} Returns undefined if the call exists.\n * @throws {BasicError} Throws if the call does not exist.\n */\nfunction checkCallExistence(state, id) {\n  if (!getCallById(state, id) && !getCallByWrtcsSessionId(state, id)) {\n    throw new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: `Call does not exist: ${id}`\n    })\n  }\n}\n\nexport function callManager(container) {\n  const { context, Callstack, CallReporter, logManager, CallRequests } = container\n\n  // Map of calls to their on-going operations.\n  const ongoing = {}\n\n  // APIs exposed by the CallManager.\n  const manager = {\n    getTracker(callId) {\n      return ongoing[callId]\n    },\n    getCallIds() {\n      return Object.keys(ongoing)\n    }\n  }\n\n  /**\n   * CallManager API for making new, outgoing calls.\n   * @method newLocalCall\n   * @async\n   * @param {string} callId\n   * @param {Array} params\n   * @return {Object|undefined}\n   */\n  async function newLocalCall(callId, ...params) {\n    // Other than creating a call report, the \"new outgoing call\" flow\n    //    is the same as the \"local operation\" flow.\n    container.CallReporter.createReport('CALL', callId)\n\n    const operation = Callstack.operations.make.local(callId)\n    // Set up new call mapping for on-going operations.\n    ongoing[callId] = createTracker(logManager.getLogger('CALL', callId))\n    ongoing[callId].add(operation)\n\n    return await operation.start(callId, params)\n  }\n\n  // CallManager method for receiving a new, incoming call.\n  async function newRemoteCall(wrtcsSessionId, params, channel) {\n    // Create an ID for the SDK to use for the call.\n    const callId = uuidV4()\n    container.CallReporter.createReport('CALL', callId)\n\n    // Set up new call mapping for on-going operations.\n    ongoing[callId] = createTracker(logManager.getLogger('CALL', callId))\n\n    // Start tracking this operation.\n    const operation = Callstack.operations.make.remote(callId)\n    ongoing[callId].add(operation)\n\n    params.callId = callId\n    await operation.start(wrtcsSessionId, params, channel)\n    ongoing[callId].remove(operation)\n  }\n\n  /**\n   * CallManager method for receiving a new, remote operation.\n   * @method newRemoteNegotiation\n   * @async\n   * @param {string} wrtcsSessionId\n   * @param {Array} params\n   * @throws {BasicError}\n   * @return {undefined}\n   */\n  async function newRemoteNegotiation(wrtcsSessionId, params) {\n    /**\n     * Utility for determining if the new remote negotiation will cause a glare scenario or not.\n     *\n     * Scenario 1: The on-going negotiation is local, with a new remote negotiation received.\n     *    This is a glare scenario whether we wait for the first negotiation to finish or not. The\n     *    first, local negotiation will change WebRTC state which is not taken into account in the\n     *    second, remote negotiation. It would cause a WebRTC error.\n     *\n     * Scenario 2: The on-going negotiation is remote, with another remote negotiation received.\n     *    Delay processing the second negotiation until the first is finished (or until time-out.)\n     *\n     * Reference: KJS-1152, KJS-1918, KJS-2059\n     * @method isGlare\n     * @param {Object} call The up-to-date call object.\n     * @param {number} [timeDelayed] The time delayed so far; only to be provided recursively.\n     * @return {Promise<boolean>}\n     */\n    async function isGlare(call, timeDelayed = 0) {\n      if (!ongoing[call.id].isBlocked) {\n        return false\n      } else if (timeDelayed >= 3000) {\n        // Time-out after 3 seconds if it's still a glare scenario.\n        return true\n      }\n\n      const { isLocal, type } = ongoing[call.id].getBlocking()\n      log.debug(\n        `Received new remote operation during ${isLocal ? 'local' : 'remote'} ${type} operation. Delaying handling.`\n      )\n      if (isLocal || type === OPERATIONS.END) {\n        // If the on-going negotiation is local, then immediately respond as a glare scenario.\n        //    The local negotiation will have changes that the remote side did not take into\n        //    account, leading to WebRTC errors. Mark this as a glare scenario immediately so\n        //    the remote side will be notified sooner.\n        // If the blocking operation is an \"end\", also immediately respond. New operations\n        //    cannot be started on ending calls.\n        return true\n      } else {\n        // If it is two remote negotiations causing the glare scenario, try to let the first\n        //    negotiation finish before processing the second.\n        await new Promise(resolve => setTimeout(resolve, 250))\n        return isGlare(getCallById(context.getState(), call.id), timeDelayed + 250)\n      }\n    }\n\n    let call = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n\n    const log = logManager.getLogger('CALL', call ? call.id : undefined)\n    log.info('Received new update call request; handling.', { wrtcsSessionId })\n\n    if (!call) {\n      // Scenario: No call is associated with the wrtcsSessionId.\n      log.info('Update request is for unknown wrtcsSession. Ignoring.', { wrtcsSessionId })\n      throw new BasicError({\n        code: callCodes.INVALID_STATE,\n        message: 'Cannot process new remote operation for call that does not exist.'\n      })\n    } else if (call.state === CALL_STATES.ENDED) {\n      // Scenario: The associated call is ended, and should not have an active\n      //    WebRTC session.\n      log.info('Update request is for ended call. Ignoring.', { wrtcsSessionId })\n      throw new BasicError({\n        code: callCodes.INVALID_STATE,\n        message: 'Cannot process new remote operation for Ended call.'\n      })\n    }\n\n    let opInfo\n    const isSlowStart = !params.sdp\n    if (isSlowStart) {\n      opInfo = { remoteOp: OPERATIONS.SLOW_START }\n    } else {\n      opInfo = await Callstack.utils.getRemoteOperationInfo(call, params.sdp)\n    }\n    const stackMethod = operationMap[opInfo.remoteOp]\n    const operation = Callstack.operations[stackMethod].remote(call.id)\n\n    if (await isGlare(call)) {\n      operation.tracker.start()\n      log.warn(`Received new remote operation during on-going operation; cannot process.`)\n      // Call is \"blocked\"; starting a new negotiation is a glare scenario.\n      // Therefore respond to Gateway that operation failed, so that the remote endpoint knows.\n      CallRequests.updateSessionResponse({\n        statusCode: 491,\n        wrtcsSessionId\n      })\n        .then(() => {})\n        .catch(error => {\n          log.warn(`Failed to reply for a remote session update. Error: ${error.message}`)\n        })\n\n      // Locally, we need to mark that remote negotiation as a failure in the Call report.\n      const err = new BasicError({\n        code: callCodes.GLARE,\n        message: `Cannot process new remote ${opInfo.remoteOp} negotiation due to glare scenario.`\n      })\n      operation.reportEvent.setError(err)\n      operation.reportEvent.endEvent()\n      operation.tracker.finish(err) // stop tracking the op because we have an error\n      throw err // don't continue further\n    } else {\n      // Start tracking this operation.\n      ongoing[call.id].add(operation)\n    }\n\n    try {\n      // Get the latest call state, in case there was a delay due to glare.\n      call = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n      await operation.start(call, opInfo, params)\n    } catch (err) {\n      ongoing[call.id].remove(operation)\n      throw err\n    }\n\n    // Regular operations are finished now, but slow-start are not.\n    if (!isSlowStart) {\n      ongoing[call.id].remove(operation)\n    }\n  }\n\n  /**\n   * CallManager method for receiving the answer to an existing, local negotiation.\n   * @method exiLocalNegotiation\n   * @async\n   * @param {string} wrtcsSessionId\n   * @param {Array} params\n   * @throws {BaiscError}\n   * @return {undefined}\n   */\n  async function exiLocalNegotiation(wrtcsSessionId, params) {\n    const call = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    const log = logManager.getLogger('CALL', call ? call.id : undefined)\n\n    /**\n     * Helper to find the local operation that the received notification is a response for.\n     */\n    async function getExistingNegotiation(callId) {\n      const call = getCallById(context.getState(), callId)\n      return call.currentOperations.find((op, ind, arr) => {\n        return (\n          (op.isLocal && op.isBlocking) || // Local pending operation.\n          (!op.isLocal && op.type === OPERATIONS.SLOW_START && op.isBlocking) || // Remote slow-start operation.\n          (op.isLocal && op.type === OPERATIONS.JOIN && arr.length === 1) // Local pending join, as the only op.\n        )\n      })\n    }\n\n    if (!call) {\n      // Scenario: The notification is about a call that state does not know about.\n      //    Ignore the notification.\n      log.info('Update response for unknown wrtcsSession. Ignoring.', { wrtcsSessionId })\n      return\n    }\n    log.info('Received new update call response; handling.', { wrtcsSessionId })\n\n    // Find which operation this \"remote answer\" could be for.\n    const opState = await getExistingNegotiation(call.id)\n    if (!opState) {\n      /*\n       * Scenario #1: A remote (non slow-start) operation is on-going.\n       * Scenario #2: No local or remote operation is on-going.\n       *    We don't know why we're receiving an answer; it doesn't match any\n       *    valid on-going WebRTC negotiation where we would expect it.\n       */\n      log.warn('Received negotiation answer without a matching offer; ignoring.')\n      return\n    }\n\n    const operation = ongoing[call.id].getByType(opState.type)\n    if (!operation) {\n      log.warn('Received negotiation answer without a matching offer; ignoring.')\n      return\n    }\n\n    try {\n      await operation.receiveResponse(call, params)\n    } catch (err) {\n      log.info(`Failed handling ${operation.type} response.`, err.message)\n    } finally {\n      // Remove the operation from the on-going list.\n      ongoing[call.id].remove(operation)\n    }\n  }\n\n  /**\n   * Wrapper for \"new, local negotiation\" operations.\n   * @method newLocalNegotiation\n   * @param {string} stackMethod\n   * @return {Function}\n   */\n  function newLocalNegotiation(stackMethod) {\n    /**\n     * CallManager API for making new, local operation call.\n     * @method localOperation\n     * @async\n     * @param {string} callId\n     * @param {Array} params\n     * @throws {BasicError}\n     * @return {Object|undefined}\n     */\n    return async function localOperation(callId, ...params) {\n      checkCallExistence(context.getState(), callId)\n      const operation = Callstack.operations[stackMethod].local(callId)\n\n      if (ongoing[callId].getByType(OPERATIONS.END)) {\n        // Prevent new operations when the call is ending.\n        throw new BasicError({\n          code: callCodes.GLARE,\n          message: `Cannot start new local ${operation.type} operation while call is ending.`\n        })\n      } else if (operation.isNegotiation && ongoing[callId].isBlocked) {\n        // Call is \"blocked\"; starting a new negotiation is a glare scenario.\n        throw new BasicError({\n          code: callCodes.GLARE,\n          message: `Cannot start new local ${operation.type} negotiation due to glare scenario.`\n        })\n      } else {\n        // Track this operation as on-going.\n        ongoing[callId].add(operation)\n      }\n\n      let result\n      try {\n        result = await operation.start(callId, params)\n      } catch (err) {\n        // Operation failed; no longer on-going.\n        ongoing[callId].remove(operation)\n        throw err\n      }\n\n      if (!operation.isNegotiation) {\n        // Local-only operation are now ended.\n        ongoing[callId].remove(operation)\n      }\n\n      return result\n    }\n  }\n\n  /**\n   * Wrapper for generic \"remote update\" notifications.\n   * @method newRemoteNotify\n   * @param {string} stackMethod\n   * @return {Function}\n   */\n  function newRemoteNotify(stackMethod) {\n    /**\n     * CallManager API for generic 'remote notifications', that aren't\n     *    handled by a different API.\n     * @method remoteNotify\n     * @param {string} wrtcsSessionId\n     * @param {Object} params\n     * @return {Promise<undefined>}\n     */\n    return async function remoteNotify(wrtcsSessionId, params) {\n      const state = context.getState()\n      checkCallExistence(state, wrtcsSessionId)\n      const call = getCallByWrtcsSessionId(state, wrtcsSessionId)\n\n      const operation = Callstack.operations[stackMethod](call.id)\n      ongoing[call.id].add(operation)\n      await operation.start(call, params)\n      ongoing[call.id].remove(operation)\n    }\n  }\n\n  /**\n   * Wrapper for updates to a local \"make\" operation update.\n   * @method makeUpdate\n   * @param {string} stackMethod\n   * @return {Function}\n   */\n  function makeUpdate(stackMethod) {\n    /**\n     * CallManager API for 'local make' update notifications.\n     * Expected Scenarios:\n     *    1. Call ringing\n     *    2. Early media\n     * @method makeUpdate\n     * @param {string} wrtcsSessionId\n     * @param {Array<any>} params\n     * @return {Promise<undefined>}\n     */\n    return async function makeUpdate(wrtcsSessionId, ...params) {\n      const state = context.getState()\n      checkCallExistence(state, wrtcsSessionId)\n      const call = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n      const log = logManager.getLogger('CALL', call ? call.id : undefined)\n\n      const pendingMake = ongoing[call.id].getPending().find(op => {\n        return op.isLocal && [OPERATIONS.MAKE, OPERATIONS.MAKE_ANONYMOUS].includes(op.type)\n      })\n\n      if (pendingMake) {\n        await pendingMake.receiveUpdate(call, stackMethod, params)\n      } else {\n        log.debug(`Received ${stackMethod} notification for non-make operation; ignoring.`)\n      }\n    }\n  }\n\n  /**\n   * CallManager API for \"call ended\" remote notifications.\n   * Expected Scenarios:\n   *    1. Update received unsolicited, with no pending operation.\n   *    2. Update received unsolicited, with an unrelated pending operation.\n   *    3. Update received solicited (ie. with a related pending operation).\n   * @method remoteCallEnded\n   * @param {string} wrtcsSessionId\n   * @param {Object} params Operation-specific data.\n   * @return {Promise<undefined>}\n   */\n  async function remoteCallEnded(wrtcsSessionId, params) {\n    const state = context.getState()\n    checkCallExistence(state, wrtcsSessionId)\n    const call = getCallByWrtcsSessionId(state, wrtcsSessionId)\n\n    const pendingComplex = ongoing[call.id].getAll().filter(op => {\n      return [OPERATIONS.CONSULTATIVE_TRANSFER, OPERATIONS.JOIN].includes(op.type)\n    })[0]\n    /*\n     * Special-cases: The 'call end' notification was for a call in a complex operation.\n     */\n    if (pendingComplex) {\n      const { type, calls } = pendingComplex\n      if (type === OPERATIONS.CONSULTATIVE_TRANSFER && calls.some(({ role }) => role === 'secondary')) {\n        /*\n         * This 'end call' notification is for the secondary call of a `consultative transfer` operation, indicating a success.\n         * Process the response, then stop tracking only this call's operation.\n         */\n        await pendingComplex.receiveResponse(call, params)\n        ongoing[call.id].remove(pendingComplex)\n      } else if (type === OPERATIONS.JOIN && calls.find(info => info.role === 'joined' && info.callId === call.id)) {\n        /*\n         * This 'end call' notification is for the joined call of a `join` operation, indicating a failure.\n         * Process the response, then stop tracking the operation for all calls involved.\n         */\n        await pendingComplex.receiveResponse(call, params)\n        calls.forEach(info => {\n          ongoing[info.callId].remove(pendingComplex)\n        })\n      }\n    } else {\n      const operation = Callstack.operations.end.remote(call.id)\n      ongoing[call.id].add(operation)\n      const pendingOp = ongoing[call.id].getPending()[0]\n      await operation.start(call, params, pendingOp)\n      ongoing[call.id].remove(operation)\n    }\n  }\n\n  /**\n   * CallManager API for \"complex response\" remote notifications.\n   * @method exiComplexResponse\n   * @param {string} wrtcsSessionId\n   * @param {Object} params Data from the notification.\n   * @return {Promise<undefined>}\n   */\n  async function exiComplexResponse(wrtcsSessionId, params) {\n    /*\n     * The JOIN operation will receive a response for each call.\n     * The transfers will receive a single response.\n     */\n\n    // Get the calls for both calls involved in the operation.\n    const state = context.getState()\n    const priCall = getCallByWrtcsSessionId(state, wrtcsSessionId)\n    checkCallExistence(state, priCall.id)\n\n    const operation = ongoing[priCall.id]\n      .getAll()\n      .find(\n        op =>\n          op.isLocal &&\n          [OPERATIONS.JOIN, OPERATIONS.CONSULTATIVE_TRANSFER, OPERATIONS.DIRECT_TRANSFER].includes(op.type)\n      )\n\n    if (operation) {\n      await operation.receiveResponse(priCall, params)\n    } else {\n      // Error: This entry should only be for a complex operation. This path indicates a bug.\n      throw new Error(`Complex response entry cannot be used for notification ${params.eventType}`)\n    }\n\n    // Remove the operation from the on-going lists.\n    ongoing[priCall.id].remove(operation)\n\n    if (operation.type === OPERATIONS.JOIN && priCall.id === operation.data.priCallId) {\n      // If join AND the notification was for the primary call, also stop tracking\n      //    the operation for the new, joined call.\n      if (ongoing[operation.data.joinedCallId].getById(operation.id)) {\n        // TODO: Why is this not tracked?\n        ongoing[operation.data.joinedCallId].remove(operation)\n      }\n    }\n  }\n\n  /**\n   * Wrapper for new, local operations that act on two calls.\n   * @method newDualCall\n   * @param {string} stackMethod\n   * @return {Function}\n   */\n  function newDualCall(stackMethod) {\n    /**\n     * @method dualCall\n     * @async\n     * @param {Array<Object>} calls Array of calls this operation will affect.\n     * @param {Array} params\n     * @throws {BasicError}\n     * @return {undefined}\n     */\n    return async function dualCall(calls, ...params) {\n      const callIds = calls.map(call => call.id)\n      const [priCallId, secCallId, joinedCallId] = callIds\n\n      checkCallExistence(context.getState(), priCallId)\n      checkCallExistence(context.getState(), secCallId)\n      if (joinedCallId) {\n        // Create the CallReport for the joined call.\n        CallReporter.createReport('CALL', joinedCallId)\n      }\n\n      const operation = Callstack.operations[stackMethod].local(calls)\n\n      if (ongoing[priCallId].isBlocked || ongoing[secCallId].isBlocked) {\n        const blockedId = ongoing[priCallId].isBlocked ? priCallId : secCallId\n        // Call is \"blocked\"; starting a new negotiation is a glare scenario.\n        throw new BasicError({\n          code: callCodes.GLARE,\n          message: `Cannot start new local ${operation.type} operation due to glare scenario for call ${blockedId}.`\n        })\n      } else {\n        // Track this operation as on-going for both calls.\n        ongoing[priCallId].add(operation)\n        ongoing[secCallId].add(operation)\n\n        if (operation.type === OPERATIONS.JOIN) {\n          // Have the CallManager track the new call for the join operation.\n          const track = createTracker(logManager.getLogger('CALL', joinedCallId))\n          ongoing[joinedCallId] = track\n          ongoing[joinedCallId].add(operation)\n\n          await operation.start(calls, params)\n        } else if (operation.type === OPERATIONS.CONSULTATIVE_TRANSFER) {\n          await operation.start(calls)\n        } else {\n          // This entry should only be used for the above two operations. This path indicates a bug.\n          throw new Error(`Dual-call entry cannot be used for ${operation.type}`)\n        }\n      }\n    }\n  }\n\n  // CallManager method for making a new, outgoing call.\n  manager.make = newLocalCall\n  // CallManager method for receiving a new, incoming call.\n  manager.establishOffer = newRemoteCall\n  // CallManager method for receiving a new, remote operation.\n  manager.negotiationOffer = newRemoteNegotiation\n  // CallManager method for receiving the answer to a renegotiation.\n  manager.negotiationAnswer = exiLocalNegotiation\n\n  /*\n   * Create CallManager methods for every local operation.\n   *    eg. CallManager.hold or CallManager.reject\n   */\n  ;[\n    // Local Negotiations.\n    OPERATIONS.SLOW_ANSWER,\n    OPERATIONS.HOLD,\n    OPERATIONS.UNHOLD,\n    OPERATIONS.ADD_MEDIA,\n    OPERATIONS.REMOVE_MEDIA,\n    OPERATIONS.ADD_BASIC_MEDIA,\n    OPERATIONS.REMOVE_BASIC_MEDIA,\n    OPERATIONS.MEDIA_RESTART,\n    OPERATIONS.DIRECT_TRANSFER,\n    // Local-only.\n    OPERATIONS.ANSWER,\n    OPERATIONS.REJECT,\n    OPERATIONS.IGNORE,\n    OPERATIONS.FORWARD_CALL,\n    OPERATIONS.END,\n    OPERATIONS.REPLACE_TRACK,\n    OPERATIONS.RESYNC,\n    OPERATIONS.PLAY_AUDIO,\n    OPERATIONS.SEND_RINGING_FEEDBACK,\n    OPERATIONS.SEND_CUSTOM_PARAMETERS,\n    OPERATIONS.SEND_DTMF,\n    OPERATIONS.GET_STATS\n  ].forEach(type => {\n    const stackMethod = operationMap[type]\n    manager[stackMethod] = newLocalNegotiation(stackMethod)\n  })\n\n  /*\n   * For every supported notification, create a CallManager method that routes\n   *    into `remoteOnlyOps`.\n   */\n  ;[\n    // TODO: No magic strings.\n    'CALL_STATUS_RINGING',\n    'RECEIVE_EARLY_MEDIA'\n  ].forEach(type => {\n    const stackMethod = notificationMap[type]\n    manager[stackMethod] = makeUpdate(stackMethod)\n  })\n\n  manager[notificationMap['CALL_CANCELLED']] = newRemoteNotify(notificationMap['CALL_CANCELLED'])\n  manager[notificationMap['CALL_STATUS_ENDED']] = remoteCallEnded\n\n  /*\n   * Handle the response notifications for complex operations.\n   */\n  ;['CALL_STATUS_FAILED', 'SESSION_STATUS_ENDED'].forEach(type => {\n    const stackMethod = notificationMap[type]\n    manager[stackMethod] = exiComplexResponse\n  })\n\n  /*\n   * Create CallManager methods for two \"dual call\" operations.\n   *    These are the complex operations that act on multiple calls at once.\n   *    ie. CallManager.consultativeTransfer and CallManager.join\n   */\n  ;[OPERATIONS.CONSULTATIVE_TRANSFER, OPERATIONS.JOIN].forEach(type => {\n    const stackMethod = operationMap[type]\n    manager[stackMethod] = newDualCall(stackMethod)\n  })\n\n  return manager\n}\n","import statusTracker from '../StatusTracker'\n\n// Call Reports.\nimport { REPORTER_OPERATION_EVENTS_MAP } from '../../reporter/constants'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\nexport default function (bottle) {\n  /**\n   * Factory for creating instances of a generic Operation.\n   * @param {Object} container The nested container; not actually used here.\n   * @param {Object} opInfo Static info about this operation.\n   * @param {string} opInfo.type Type constant of the operation.\n   * @param {boolean} opInfo.isNegotiation Whether this operation is a negotiation or not.\n   * @param {Object} opInfo.stages The methods to handle various stages of this operation.\n   * @param {Function} opInfo.stages.validate\n   * @param {Function} opInfo.stages.localOffer\n   * @param {Function} opInfo.stages.remoteAnswer\n   * @param {Function} opInfo.stages.remoteOffer\n   * @param {Object} instanceInfo Info specific to this instance of the operation.\n   * @param {Array<Object>} instanceInfo.callInfo List of calls affected by this operation.\n   * @return {Operation} An instance of an operation.\n   */\n  bottle.instanceFactory('Callstack.models.MultiCall', (container, opInfo, instanceInfo) => {\n    // Static data for the operation.\n    const { type, isNegotiation, stages, createFlow } = opInfo\n    opInfo.isLocal = true\n\n    // Instance data for the operation.\n    const id = uuidV4()\n    const { callInfo, data } = instanceInfo\n\n    // TechDebt TODO: The Reporter's event map should be consistent so we don't have to guess for the right name.\n    const eventName = REPORTER_OPERATION_EVENTS_MAP[type + '_LOCAL'] || REPORTER_OPERATION_EVENTS_MAP[type]\n\n    const calls = callInfo.map(({ id: callId, role }) => {\n      // TODO: Should the Operation factory add the event immediately or at a later point?\n      const reportEvent = bottle.container.CallReporter.getReport(callId).addEvent(eventName)\n\n      /*\n       * Information about a call involved in the multi-call operation.\n       * @typedef {Object} callInfo\n       * @param {string} callId\n       * @param {string} role\n       * @param {ReportEvent} reportEvent\n       * @param {StatusTracker} tracker\n       */\n      return {\n        callId, // TODO: Have this just ID?\n        role,\n        reportEvent,\n        tracker: statusTracker(bottle.container, callId, id, reportEvent.id, opInfo, {\n          // TechDebt TODO: This is part of join's `tracker.start()` workaround. It tells the tracker\n          //    to have the trackding be started immediately instead of waiting for `start()`.\n          isJoinedCall: role === 'joined'\n        })\n      }\n    })\n\n    const Operation = {\n      // Operation meta-data.\n      type,\n      isNegotiation,\n      isLocal: true,\n\n      // Operation methods.\n      /**\n       * Method to start the operation.\n       * @method start\n       */\n      start: undefined,\n      /**\n       * Method to process the remote response(s) to the operation.\n       * @method receiveResponse\n       */\n      receiveResponse: undefined,\n\n      // Instance specific.\n      calls,\n      id,\n      data: { ...data },\n\n      // Progress tracker.\n      tracker: {\n        // Expose a single \"tracker\" that wraps the trackers of every call.\n        start: () =>\n          calls.forEach(call => {\n            // TechDebt TODO: We can't \"start\" the joined call's operation because the joined\n            //    call does not exist in redux state at this point. The operation adds it to\n            //    state, but the API should do that so join doesn't need special-handling.\n            if (call.role !== 'joined') {\n              call.tracker.start()\n            }\n          }),\n        update: result => calls.forEach(call => call.tracker.update(result)),\n        resume: () => calls.forEach(call => call.tracker.resume()),\n        finish: err => calls.forEach(call => call.tracker.finish(err))\n      },\n      get status() {\n        return calls[0].tracker.status\n      },\n\n      // Operation Event.\n      reportEvent: {\n        // Expose a single \"reportEvent\" that wraps the events of every call.\n        addEvent: type => calls.forEach(call => call.reportEvent.addEvent(type)),\n        setError: err => calls.forEach(call => call.reportEvent.setError(err)),\n        endEvent: err => calls.forEach(call => call.reportEvent.endEvent(err))\n      }\n    }\n\n    const flow = createFlow(bottle.container, Operation, stages)\n    // Add the flow methods to the Operation.\n    Object.assign(Operation, flow)\n\n    return Operation\n  })\n}\n","import statusTracker from '../StatusTracker'\n\nimport createLocal from '../flows/LocalNegotiation'\nimport createRemote from '../flows/RemoteNegotiation'\n\n// Call Reports.\nimport { REPORTER_OPERATION_EVENTS_MAP } from '../../reporter/constants'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\nexport default function (bottle) {\n  /**\n   * Factory for creating instances of a generic Operation.\n   * @param {Object} container The nested container; not actually used here.\n   * @param {Object} opInfo Static info about this operation.\n   * @param {string} opInfo.type Type constant of the operation.\n   * @param {boolean} opInfo.isLocal Whether this operation is locall triggered.\n   * @param {Object} opInfo.stages The methods to handle various stages of this operation.\n   * @param {Function} opInfo.stages.validate\n   * @param {Function} opInfo.stages.localOffer\n   * @param {Function} opInfo.stages.remoteAnswer\n   * @param {Function} opInfo.stages.remoteOffer\n   * @param {Object} instanceInfo Info specific to this instance of the operation.\n   * @param {string} instanceInfo.callId The ID of the call the operation is performed on.\n   * @return {Operation} An instance of an operation.\n   */\n  bottle.instanceFactory('Callstack.models.Negotiation', (container, opInfo, instanceInfo) => {\n    // TODO: Parameter validation.\n    // TODO: Based on which stages were provided, determine the \"flow\" the operation needs to follow.\n\n    // If `createFlow` is defined, use that. Otherwise, default based on `isLocal`.\n    const createFlow = opInfo.createFlow ?? (opInfo.isLocal ? createLocal : createRemote)\n\n    // Static data for the operation.\n    const { type, isLocal, stages } = opInfo\n\n    // Instance data for the operation.\n    const id = uuidV4()\n    const { callId, data } = instanceInfo\n\n    // TechDebt TODO: The Reporter's event map should be consistent so we don't have to guess for the right name.\n    const eventName =\n      REPORTER_OPERATION_EVENTS_MAP[type + (isLocal ? '_LOCAL' : '_REMOTE')] || REPORTER_OPERATION_EVENTS_MAP[type]\n    // TODO: Should the Operation factory add the event immediately or at a later point?\n    const reportEvent = bottle.container.CallReporter.getReport(callId).addEvent(eventName)\n\n    opInfo.isNegotiation = true\n    const tracker = statusTracker(bottle.container, callId, id, reportEvent.id, opInfo)\n\n    const Operation = {\n      // Operation meta-data.\n      type,\n      isNegotiation: true,\n      isLocal,\n\n      // Operation methods.\n      /**\n       * Method to start the operation.\n       * @method start\n       */\n      start: undefined,\n      /**\n       * Method to process the remote response to the negotiation.\n       * @method receiveResponse\n       */\n      receiveResponse: undefined,\n      /**\n       * Method to process a remote update to the negotiation.\n       * @method receiveUpdate\n       */\n      receiveUpdate: undefined,\n\n      // Instance specific.\n      callId,\n      id,\n      data: { ...data },\n\n      // Progress tracker.\n      tracker,\n      get status() {\n        return tracker.status\n      },\n\n      // Operation Event.\n      reportEvent\n    }\n\n    const flow = createFlow(bottle.container, Operation, stages)\n    // Add the flow methods to the Operation.\n    Object.assign(Operation, flow)\n\n    return Operation\n  })\n}\n","import statusTracker from '../StatusTracker'\n\nimport createLocal from '../flows/LocalOperation'\nimport { createGeneric } from '../flows/RemoteUpdate'\n\n// Call Reports.\nimport { REPORTER_OPERATION_EVENTS_MAP } from '../../reporter/constants'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * Helper method to ensure the required stages are defined.\n * @method hasUpdateStages\n * @param {boolean} isLocal\n * @param {Object} stages\n * @throws {Error} When the operation is missing stages.\n */\nfunction hasUpdateStages(isLocal, stages) {\n  const { validate, localOffer, remoteOffer } = stages\n\n  if (isLocal && !(Boolean(validate) || Boolean(localOffer))) {\n    throw new Error('Missing local stage for Update operation.')\n  } else if (!isLocal && !remoteOffer) {\n    throw new Error('Missing remote stage for Update operation.')\n  } else {\n    // Operation has all the required stages for an 'Update'.\n  }\n}\n\nexport default function (bottle) {\n  /**\n   * Factory for creating instances of 'Update' operations.\n   * An \"Update\" operation includes changes being done to the call locally\n   *    and optionally a REST request.\n   *\n   * @param {Object} container The nested container; not actually used here.\n   * @param {Object} opInfo Static info about this operation.\n   * @param {string} opInfo.type Type constant of the operation.\n   * @param {boolean} opInfo.isLocal Whether this operation is locall triggered.\n   * @param {Object} opInfo.stages Methods to handle various stages of an 'update' operation.\n   * @param {Object} instanceInfo Info specific to this instance of the operation.\n   * @param {string} instanceInfo.callId The ID of the call the operation is performed on.\n   * @return {Operation} An instance of an operation.\n   */\n  bottle.instanceFactory('Callstack.models.Update', (container, opInfo, instanceInfo) => {\n    hasUpdateStages(opInfo.isLocal, opInfo.stages)\n\n    // If `createFlow` is defined, use that. Otherwise, default based on `isLocal`.\n    const createFlow = opInfo.createFlow ?? (opInfo.isLocal ? createLocal : createGeneric)\n\n    // Static data for the operation.\n    const { type, isLocal, stages } = opInfo\n\n    // Instance data for the operation.\n    const id = uuidV4()\n    const { callId, data } = instanceInfo\n\n    // TechDebt TODO: The Reporter's event map should be consistent so we don't have to guess for the right name.\n    const eventName =\n      REPORTER_OPERATION_EVENTS_MAP[type + (isLocal ? '_LOCAL' : '_REMOTE')] || REPORTER_OPERATION_EVENTS_MAP[type]\n    // TODO: Should the Operation factory add the event immediately or at a later point?\n    const reportEvent = bottle.container.CallReporter.getReport(callId).addEvent(eventName)\n\n    opInfo.isNegotiation = false\n    const tracker = statusTracker(bottle.container, callId, id, reportEvent.id, opInfo)\n\n    /**\n     * @typedef {Object} UpdateOperation\n     * @property {string}   type The type of operation.\n     * @property {boolean}  isNegotiation Whether the operation is a negotiation or not.\n     * @property {boolean}  isLocal Whether the operation was started locally or not.\n     * @property {Function} start The method to start processing the operation.\n     * @property {string}   callId ID of the call the operation is acting on.\n     * @property {string}   id ID of the operation.\n     * @property {Object}   data Arbitrary information the operation needs.\n     * @property {Object}   tracker The StatusTracker for the operation.\n     * @property {string}   status The current status of the operation.\n     * @property {Object}   reportEvent The CallReport event representing the operation.\n     */\n    const UpdateOperation = {\n      // Operation meta-data.\n      type,\n      isNegotiation: false,\n      isLocal,\n\n      // Operation methods.\n      /**\n       * Method to start the operation.\n       * @method start\n       */\n      start: undefined,\n\n      // Instance specific.\n      callId,\n      id,\n      data: { ...data },\n\n      // Operation Tracking\n      tracker,\n      get status() {\n        return tracker.status\n      },\n      reportEvent\n    }\n\n    const flow = createFlow(bottle.container, UpdateOperation, stages)\n    // Add the flow methods to the Operation.\n    Object.assign(UpdateOperation, flow)\n\n    return UpdateOperation\n  })\n}\n","import { OPERATIONS } from '../../interface/constants'\n/*\n * This is a mapping between the operation constants and the names used for the\n *    operations in various places. This only exists because the Callstack is\n *    inconsistent with the names/casing it uses in various places.\n * TODO: Technical-debt to clean this up.\n */\nexport const operationMap = {\n  // Local operations.\n  [OPERATIONS.MAKE]: 'make',\n  [OPERATIONS.MAKE_ANONYMOUS]: 'makeAnonymousCall',\n  [OPERATIONS.ANSWER]: 'answer',\n  SLOW_ANSWER: 'answerSlow',\n  [OPERATIONS.REJECT]: 'reject',\n  [OPERATIONS.IGNORE]: 'ignore',\n  [OPERATIONS.FORWARD_CALL]: 'forward',\n  [OPERATIONS.END]: 'end',\n  [OPERATIONS.DIRECT_TRANSFER]: 'directTransfer',\n  [OPERATIONS.CONSULTATIVE_TRANSFER]: 'consultativeTransfer',\n  [OPERATIONS.JOIN]: 'join',\n  [OPERATIONS.HOLD]: 'hold',\n  [OPERATIONS.UNHOLD]: 'unhold',\n  [OPERATIONS.ADD_MEDIA]: 'addMedia',\n  [OPERATIONS.REMOVE_MEDIA]: 'removeMedia',\n  [OPERATIONS.ADD_BASIC_MEDIA]: 'addBasicMedia',\n  [OPERATIONS.REMOVE_BASIC_MEDIA]: 'removeBasicMedia',\n  [OPERATIONS.REPLACE_TRACK]: 'replaceTrack',\n  [OPERATIONS.MEDIA_RESTART]: 'iceRestart',\n  [OPERATIONS.RESYNC]: 'resyncCallState',\n  [OPERATIONS.PLAY_AUDIO]: 'playAudioFile',\n  [OPERATIONS.SEND_RINGING_FEEDBACK]: 'sendRingingFeedback',\n  [OPERATIONS.SEND_CUSTOM_PARAMETERS]: 'sendCustomParameters',\n  [OPERATIONS.SEND_DTMF]: 'sendDtmf',\n  [OPERATIONS.GET_STATS]: 'getStats',\n  [OPERATIONS.GET_AVAILABLE_CODECS]: 'getAvailableCodecs',\n  [OPERATIONS.START_MOH]: 'startMOH',\n  [OPERATIONS.STOP_MOH]: 'stopMOH',\n  // Remote-only.\n  [OPERATIONS.SLOW_START]: 'slowStart',\n  UNKNOWN: 'genericRemote',\n  NO_CHANGE: 'genericRemote',\n  [OPERATIONS.GENERIC_REMOTE]: 'genericRemote'\n}\n\n/*\n * List of Callstack notification handlers.\n */\nexport const notificationMap = {\n  CALL_STATUS_ENDED: 'callStatusUpdateEnded',\n  CALL_CANCELLED: 'callCancelled',\n  CALL_STATUS_RINGING: 'callStatusUpdateRinging',\n  CALL_STATUS_FAILED: 'callStatusUpdateFailed',\n  RECEIVE_EARLY_MEDIA: 'receiveEarlyMedia',\n  SESSION_STATUS_ENDED: 'sessionStatusUpdateEnded'\n}\n","import * as callOperations from './operations'\n\nimport initSdpOperations from './sdp'\nimport initWebrtcOperations from './webrtc'\nimport initCallManager from './callManager'\nimport initCallReporter from './reporter'\nimport initUtils from './utils'\n\n/**\n * Callstack  factory function.\n * @method createCallstack\n * @param  {Object} bottle The bottle.\n */\nexport default function createCallstack(bottle) {\n  // Initialize the operation handlers, adding them to the bottle.\n  // They will be at `Callstack.operations` and `Callstack.utils`.\n  for (const name in callOperations) {\n    callOperations[name](bottle)\n  }\n\n  initCallReporter(bottle)\n  // Initialize the SDP and WebRTC operations.\n  initSdpOperations(bottle)\n  initWebrtcOperations(bottle)\n  // Initialize Callstack utils.\n  initUtils(bottle)\n\n  initCallManager(bottle)\n}\n","import { UPDATE_CALL, PENDING_JOIN, PENDING_MAKE_CALL } from '../../interface/actionTypes'\nimport { CALL_STATES } from '../../constants'\n\n/**\n * Factory function for the `callAudit` middleware handler. Creates an instance\n *    of the function in the scope / context of the built SDK.\n * @return {Function} The function which is responsible for triggering a call audit.\n */\nexport default function createActionHandler(context) {\n  const operations = context.container.Callstack.operations\n\n  /**\n   * Handle requests that are meant to trigger a call audit.\n   *\n   * @method callAudit\n   * @param {Object} action Any action.\n   * @return {undefined}\n   */\n  async function callAudit(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return false\n    }\n\n    // Handle it by calling the `sendCallAudit` operation.\n    // For Link, a \"call audit\" means to update the call's status to: 'Connected'\n    // This will be accomplished by the operation by calling a specific request such as: updateSessionStatus\n    operations.sendCallAudit(action.payload.id, {\n      wrtcsSessionId: action.payload.wrtcsSessionId\n    })\n  }\n\n  return callAudit\n}\n\n/**\n * Test function for whether an action should be handled by this handler.\n * @param {Object} action\n * @return {boolean} True if action should be handled, false otherwise.\n */\nexport function shouldHandlePattern(action) {\n  const actionTypesToDoAuditOn = [UPDATE_CALL, PENDING_JOIN, PENDING_MAKE_CALL]\n\n  if (!action.error) {\n    if (actionTypesToDoAuditOn.indexOf(action.type) !== -1) {\n      const preConnectedState =\n        action.payload.state === CALL_STATES.INITIATED || action.payload.state === CALL_STATES.RINGING\n      return preConnectedState\n    }\n  }\n  return false\n}\n","// Call plugin\nimport { callActions } from '../../interface/actions'\nimport * as eventTypes from '../../interface/eventTypes'\nimport { OPERATIONS, OP_TRANSITIONS } from '../../interface/constants'\nimport { getCalls, getOptions, getCallById } from '../../interface/selectors'\nimport { CALL_STATES } from '../../constants'\n\n// Other plugins\nimport { WS_CONNECT_FINISHED } from '../../../connectivity/interface/actionTypes'\n\n/**\n * Factory function for the `getSessions` middleware handler. Creates an instance\n *    of the function in the scope / context of the built SDK.\n * @return {Function} The function which is responsible for triggering a call audit.\n */\nexport default function getSessionsMiddleware(context) {\n  const { logManager, Callstack, CallRequests, CallstackWebrtc, emitEvent } = context.container\n\n  /*\n   * TODO: Rename this middleware (and file).\n   * Should be something like `resyncOnConnect`, after it's updated to use the\n   *    `resyncCallState` operation instead of the `updateCallState` operation.\n   */\n\n  /**\n   * This function is part of the overall middleware.\n   * Check (and update) the session status of all active calls upon websocket connection to ensure all call states are up to date.\n   *\n   * Responsibilities:\n   *   1. Ensure resyncOnConnect config is set\n   *   2. Filter out inactive calls (calls already in an ended state)\n   *   3. Call resyncCallState operation for each active call.\n   * @method getSessions\n   * @param {Object} action Any action.\n   * @return {undefined}\n   */\n  async function getSessions(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    // Don't handle if resyncOnConnect is false\n    const config = getOptions(context.getState())\n    if (!config.resyncOnConnect) {\n      return\n    }\n\n    // Grab all active calls\n    const calls = getCalls(context.getState())\n    const activeCalls = calls.filter(call => call.state !== CALL_STATES.CANCELLED && call.state !== CALL_STATES.ENDED)\n\n    /*\n     * TODO: This operation's logic is not safe. It assumes that an on-going operation will re-sync the call's state,\n     *    but not all operations will do that (eg. some operations are local-only, getStats).\n     * Reference: https://jira.rbbn.com/browse/KJS-1974\n     */\n    function hasNoOperation(call) {\n      return call.currentOperations.length === 0\n    }\n\n    // Check and update the call state of each call if necessary\n    for (const activeCall of activeCalls) {\n      const log = logManager.getLogger('CALL', activeCall.id)\n\n      const callStateAfterConnect = activeCall.state\n\n      // If there is an ongoing operation when the WS connects, the response to that operation will re-sync the state\n      // Otherwise, we need to get the status of the session from the server\n      if (hasNoOperation(activeCall)) {\n        try {\n          const sessionStatusResponse = await CallRequests.getSession({\n            wrtcsSessionId: activeCall.wrtcsSessionId,\n            id: activeCall.id\n          })\n\n          // Get state of the call again before evaluating the response as an operation request and response\n          // could have been processed in between the request to get the session and the response received\n          const currentCall = getCallById(context.getState(), activeCall.id)\n\n          // Do nothing if an operation was triggered in between the GET sessions request and response, and is ongoing\n          if (hasNoOperation(currentCall)) {\n            /*\n             * If the current call state is ringing OR if the state of the call was connected/on hold before we\n             * did the GET, look at the response of the GET request.\n             * If call is ringing and GET session returns ringing, we don't need to do anything\n             * Also, if we were previously connected, but GET returns ringing, this could be due to an operation that was resolved\n             * between the GET request and response. In any case, no need to look at GET response for this scenario.\n             */\n            if (currentCall.state === CALL_STATES.RINGING || callStateAfterConnect !== CALL_STATES.RINGING) {\n              await Callstack.operations.resyncCallState(activeCall.id, sessionStatusResponse)\n            }\n          }\n        } catch (error) {\n          // Get state of the call again before evaluating the response as an operation request and response\n          // could have been processed in between the request to get the session and the response received\n          const currentCall = getCallById(context.getState(), activeCall.id)\n\n          // Do nothing if an operation was triggered in between the GET sessions request and response, and is ongoing\n          if (hasNoOperation(currentCall)) {\n            /*\n             * If the current call state is ringing OR if the state of the call was connected/on hold before we\n             * did the GET, look at the response of the GET request.\n             * If call is ringing and GET session returns ringing, we don't need to do anything\n             * Also, if we were previously connected, but GET returns ringing, this could be due to an operation that was resolved\n             * between the GET request and response. In any case, no need to look at GET response for this scenario.\n             */\n            if (currentCall.state === CALL_STATES.RINGING || callStateAfterConnect !== CALL_STATES.RINGING) {\n              // Call not found\n              if (error.code === 47) {\n                // End the call as the session does not exist on the server anymore (statusCode 47 response)\n                await CallstackWebrtc.closeCall(activeCall.webrtcSessionId)\n\n                log.info(`Call re-sync found that call is ended. Changing to ${CALL_STATES.ENDED}.`)\n                context.dispatch(\n                  callActions.endCallFinish(activeCall.id, {\n                    isLocal: true,\n                    error\n                  })\n                )\n\n                // 1- 'call operation' event\n                emitEvent(eventTypes.CALL_OPERATION, {\n                  callId: activeCall.id,\n                  isLocal: true,\n                  operation: OPERATIONS.END,\n                  transition: OP_TRANSITIONS.FINISH,\n                  previous: {},\n                  error\n                })\n\n                // Tell the application that no tracks are available any longer.\n                emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n                  callId: activeCall.id,\n                  trackIds: [...activeCall.localTracks, ...activeCall.remoteTracks]\n                })\n\n                // 2- 'call state change' event, which updates the state.\n                emitEvent(eventTypes.CALL_STATE_CHANGE, {\n                  callId: activeCall.id,\n                  previous: {\n                    state: activeCall.state,\n                    localHold: activeCall.localHold,\n                    remoteHold: activeCall.remoteHold\n                  },\n                  error\n                })\n\n                // GET response errors other than session not found\n              } else {\n                log.debug(`Call re-sync failure (${error.code}).`, error)\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return getSessions\n}\n\nexport function shouldHandlePattern(action) {\n  return action.type === WS_CONNECT_FINISHED\n}\n","import {\n  SESSION_ICE_GATHERING_STATE_CHANGE,\n  SESSION_ICE_CANDIDATE_COLLECTED,\n  SESSION_ICE_COLLECTION_SCHEDULED_CHECK\n} from '../../../webrtc/interface/actionTypes'\n\n/**\n * Bottle wrapper for \"ICE collection check\" triggers.\n * @return {Function}\n */\nexport default function callCollectionCheckMiddleware(context) {\n  const operations = context.container.Callstack.operations\n\n  async function callCollectionCheck(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    // Handle it.\n    const { id, ...iceCollectionInfo } = action.payload\n    await operations.callIceCollectionCheck(id, iceCollectionInfo)\n  }\n\n  return callCollectionCheck\n}\n\nexport function shouldHandlePattern(action) {\n  return (\n    action.type === SESSION_ICE_GATHERING_STATE_CHANGE ||\n    action.type === SESSION_ICE_CANDIDATE_COLLECTED ||\n    action.type === SESSION_ICE_COLLECTION_SCHEDULED_CHECK\n  )\n}\n","import getSessionsMiddleware from './getSessions'\nimport iceCollectionCheck from './iceCollectionCheck'\nimport normalizeIceFailure from './normalizeIceFailure'\nimport callAudit from './callAudit'\n\nconst callStackMiddlewares = [getSessionsMiddleware, iceCollectionCheck, normalizeIceFailure, callAudit]\n\nexport default callStackMiddlewares\n","import { SESSION_ICE_CONNECTION_STATE_CHANGE } from '../../../webrtc/interface/actionTypes'\nimport { CALL_MEDIA_CONNECTION_STATES } from '../../constants'\n\n/**\n * Bottle wrapper for \"normalize ICE failure\" middleware.\n * @return {Function}\n */\nexport default function normalizeIceFailureMiddleware(context) {\n  const Callstack = context.container.Callstack\n\n  /**\n   * Handle actions that trigger ice failure normalization.\n   * @param {Object} action A flux-standard action.\n   */\n  async function normalizeIceFailure(action) {\n    if (!shouldHandlePattern(action)) {\n      return\n    }\n\n    Callstack.operations.normalizeIceFailure(action.payload.id, action.payload.iceConnectionState)\n  }\n\n  return normalizeIceFailure\n}\n\n/**\n * Pattern check function for the normalize ice failure action pattern.\n * @param {Object} action A flux-standard action.\n */\nexport function shouldHandlePattern(action) {\n  return (\n    action.type === SESSION_ICE_CONNECTION_STATE_CHANGE &&\n    action.payload.iceConnectionState === CALL_MEDIA_CONNECTION_STATES.DISCONNECTED\n  )\n}\n","// Call Plugin\nimport { getCallById } from '../../../../interface/selectors'\n\n/**\n * Bottle wrapper for consultativeTransfer call operation.\n * @return {Function}\n */\nexport default function createConsultativeTransfer(container) {\n  /**\n   * Transfers 2 ongoing calls to one another.\n   */\n  return async function consultativeTransfer(calls) {\n    // No local changes for this operation.\n    // Signal the transfer to the call server.\n    return signalling(container, calls)\n  }\n}\n\n/**\n * Signalling stage for a 'consultative transfer' operation.\n *\n * Sends a REST request to the server to indicate the intention to transfer.\n * @method signalling\n * @param {Array<Object>} calls Array of calls this operation will affect.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws an error if the REST request fails.\n */\nexport async function signalling(container, calls) {\n  const { context, CallRequests, logManager } = container\n\n  const callId = calls[0].id\n  const otherCallId = calls[1].id\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Performing consultative transfer on call.')\n\n  const currentCall = getCallById(context.getState(), callId)\n  const otherCall = getCallById(context.getState(), otherCallId)\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    id: callId,\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    otherWrtcsSessionId: otherCall.wrtcsSessionId,\n    destination: otherCall.direction === 'outgoing' ? otherCall.to : otherCall.from\n  }\n\n  try {\n    await CallRequests.consultativeTransferSessions(callInfo)\n  } catch (responseError) {\n    log.info('Failed to consultative transfer call.')\n    throw responseError\n  }\n  log.info('Finished local portion of consultative transfer. Waiting on remote response.')\n}\n","// Stages.\nimport createSignalling from './consultativeTransfer'\nimport remoteSuccess from './remoteSuccess'\nimport remoteFailure from './remoteFailure'\nimport validate from './validate'\n\nimport createFlow from '../../../callManager/flows/ConsultativeTransfer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.consultativeTransfer', () => {\n    const multiFactory = bottle.container.Callstack.models.MultiCall\n\n    /**\n     * Factory function for a LocalConsultTransfer operation.\n     * @method LocalConsultTransfer\n     * @param {Array<Object>} callInfo List of calls affected by this operation.\n     * @return {Operation} An instance of a local consultative transfer operation.\n     */\n    function LocalConsultTransfer(callInfo) {\n      return multiFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.CONSULTATIVE_TRANSFER,\n          isNegotiation: true,\n          // Operation methods.\n          stages: {\n            validate,\n            // TODO: Don't use negotiation terms for this.\n            signalling: createSignalling(bottle.container),\n            remoteSuccess: remoteSuccess(bottle.container),\n            remoteFailure: remoteFailure(bottle.container)\n          },\n          createFlow\n        },\n        {\n          callInfo\n        }\n      )\n    }\n\n    return {\n      local: LocalConsultTransfer\n    }\n  })\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\nimport * as eventTypes from '../../../../interface/eventTypes'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\nexport default function createHandler(container) {\n  const { context, emitEvent, logManager } = container\n\n  /**\n   * A \"session failure\" notification has been received, indicating the operation failed.\n   *    Finish the operation.\n   *\n   * @method remoteFailure\n   * @param {Object} call The primary call for the operation.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @return {BasicError}\n   */\n  return function remoteFailure(call, params) {\n    const reasonText = params.reasonText || COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_FAILURE\n    const statusCode = params.statusCode || STATUS_CODES.CONSULTATIVE_TRANSFER_FAILURE\n\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received call operation failed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    log.debug(`Processing as a local consultative transfer failure (${statusCode}).`)\n    log.info('Finished handling call operation failed notice.')\n\n    const error = new BasicError({\n      message: `Consultative transfer operation failed: ${reasonText} (${statusCode})`,\n      code: callCodes.GENERIC_ERROR\n    })\n\n    context.dispatch(\n      callActions.consultativeTransferFinish(call.id, {\n        error,\n        transition: { reasonText, statusCode }\n      })\n    )\n\n    // Notify the app that there has been a call state change\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: true,\n        remoteHold: false\n      },\n      error\n    })\n\n    return error\n  }\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { CALL_STATE_CHANGE, CALL_TRACKS_REMOVED } from '../../../../interface/eventTypes'\n\nimport { CALL_STATES, COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\n\n// Helpers\nimport { generateEndParams } from '../../../utils/call'\n\nexport default function createHandler(container) {\n  const { context, CallRequests, CallstackWebrtc, emitEvent, logManager } = container\n\n  /**\n   * A \"session complete\" notification has been received, indicating the operation was\n   *    successful. Finish the operation by ending the call.\n   *\n   * For a consultative transfer, this notification is only for the primary call of the\n   *    operation. The secondary call will receive a separate \"call end\" notification.\n   *\n   * @method consultativeSuccess\n   * @param {Object} call The primary call for the operation.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @return {Promise<undefined>}\n   */\n  async function consultativeSuccess(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received session status completed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    const { reasonText, statusCode } = params\n    if (reasonText) {\n      let customStatusCode\n      if (!statusCode && statusCode !== 0) {\n        customStatusCode = STATUS_CODES.CONSULTATIVE_TRANSFER_SUCCESS\n      } else {\n        customStatusCode = statusCode\n      }\n      log.debug(`Session completed notice caused by ${reasonText} (${customStatusCode}).`)\n    }\n\n    log.info(`Ending webRTC session with id: ${call.webrtcSessionId}, locally ...`)\n    // Close the local webRTC session\n    await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n    // Update call state to 'Ended'.\n    context.dispatch(\n      callActions.consultativeTransferFinish(call.id, {\n        transition: {\n          reasonText: COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_SUCCESS,\n          statusCode: STATUS_CODES.CONSULTATIVE_TRANSFER_SUCCESS\n        }\n      })\n    )\n\n    try {\n      log.debug('Ending call session on server-side.')\n      await CallRequests.endSession({\n        callId: call.id,\n        wrtcsSessionId: call.wrtcsSessionId,\n        isAnonymous: call.isAnonymous,\n        account: call.account\n      })\n    } catch (error) {\n      // Ignore an error from the REST request. End the call locally no matter what.\n      log.debug(`Error received when attempting to end the session: ${error}.`)\n    } finally {\n      log.info(`Finished ending call. Changing call state to ${CALL_STATES.ENDED}.`)\n      // TODO: Is this action needed? The call should be 'Ended' by the above action.\n      context.dispatch(callActions.endCallFinish(call.id, generateEndParams(call.state, true, params)))\n\n      // Tell the application that no tracks are available any longer.\n      emitEvent(CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        }\n      })\n    }\n  }\n\n  return consultativeSuccess\n}\n","// Call plugin\nimport { getCallById } from '../../../../interface/selectors'\n\n// Helpers.\nimport { CALL_STATES } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Array<Object>} calls Array of calls this operation will affect.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, calls) {\n  const call = getCallById(state, calls[0].id)\n  const otherCall = getCallById(state, calls[1].id)\n  /*\n   * `consultativeTransfer` operation validation:\n   *    1. First Call must exist.\n   *    2. Second Call must exist.\n   *    3. First Call must be in `On Hold` state.\n   *    4. Second Call must be in `On Hold` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (!otherCall) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state !== CALL_STATES.ON_HOLD) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state: state=${call.state}. It should be: state=${CALL_STATES.ON_HOLD}.`\n    })\n  } else if (otherCall.state !== CALL_STATES.ON_HOLD) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state: state=${otherCall.state}. It should be: state=${CALL_STATES.ON_HOLD}.`\n    })\n  }\n}\n","// Stages.\nimport createStages from './join'\nimport validate from './validate'\n\nimport remoteAnswer from './remoteAnswer'\nimport remoteSuccess from './remoteSuccess'\nimport remoteFailure from './remoteFailure'\nimport joinedFailure from './joinedFailure'\n\nimport createFlow from '../../../callManager/flows/Join'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.join', () => {\n    const multiFactory = bottle.container.Callstack.models.MultiCall\n\n    /**\n     * Factory function for a LocalJoin operation.\n     * @method LocalJoin\n     * @param {Array<Object>} callInfo List of calls affected by this operation.\n     * @return {Operation} An instance of a local join operation.\n     */\n    function LocalJoin(callInfo) {\n      const stages = createStages(bottle.container)\n\n      return multiFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.JOIN,\n          /*\n           * TechDebt TODO: The join operation should be a blocking negotiation,\n           *    but there are so many failure edge-cases that cause more issues\n           *    with the framework. Allow other operations to happen with a join\n           *    to avoid getting stuck in permanent-glare when a join fails in a`\n           *    bad way.\n           * The main edge-case for this is that `remoteOnly` does not track the\n           *    operations. A join can fail where only the new joined call gets a\n           *    'call end' notification to indicate failure, so that notification\n           *    needs to \"clean-up\" the operation for all 3 calls.\n           */\n          isNegotiation: false,\n          // Operation methods.\n          stages: {\n            validate,\n            localOffer: stages.localChanges,\n            signalling: stages.signalling,\n            // Negotiation handler for the new, joined call.\n            remoteAnswer: remoteAnswer(bottle.container),\n            // Response handlers for the existing calls.\n            remoteSuccess: remoteSuccess(bottle.container),\n            remoteFailure: remoteFailure(bottle.container),\n            joinedFailure: joinedFailure(bottle.container)\n          },\n          createFlow\n        },\n        {\n          callInfo\n        }\n      )\n    }\n\n    return {\n      local: LocalJoin\n    }\n  })\n}\n","// Call plugin.\nimport { CALL_DIRECTION, CALL_STATES } from '../../../../constants'\nimport { callActions } from '../../../../interface/actions'\nimport { checkBandwidthControls } from '../../../utils/call'\nimport * as eventTypes from '../../../../interface/eventTypes'\nimport { getCallById, getOptions, getTurnInfo } from '../../../../interface/selectors'\nimport { OPERATIONS, OP_TRANSITIONS } from '../../../../interface/constants'\nimport { REPORTER_OPERATION_EVENTS_MAP } from '../../../reporter/constants'\n\n// Other plugins.\nimport { getSessionById } from '../../../../../webrtc/interface/selectors'\n\n/**\n * Bottle wrapper for join call operation.\n * @return {Object}\n */\nexport default function createJoin(container) {\n  return {\n    localChanges: (calls, from) => localChanges(container, calls, from),\n    signalling: (calls, params) => signalling(container, calls, params)\n  }\n}\n\nasync function localChanges(container, calls, from) {\n  const { CallReporter, Callstack, context, emitEvent, logManager } = container\n  const { setupOutgoingSession } = Callstack.utils\n\n  const callId = calls[0].id\n  const otherCallId = calls[1].id\n  const newCallId = calls[2].id\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info(`Performing join on calls ${callId} and ${otherCallId}.`)\n\n  const currentCall = getCallById(context.getState(), callId)\n  const otherCall = getCallById(context.getState(), otherCallId)\n\n  // Determine combined participant name if any\n  const currentCallRemoteName = currentCall.remoteParticipant.displayName\n  const otherCallRemoteName = otherCall.remoteParticipant.displayName\n  let participantName\n  if (currentCallRemoteName && otherCallRemoteName) {\n    participantName = `${currentCallRemoteName},${otherCallRemoteName}`\n  } else if (currentCallRemoteName) {\n    participantName = `${currentCallRemoteName},`\n  } else if (otherCallRemoteName) {\n    participantName = `,${otherCallRemoteName}`\n  }\n\n  // Determine combined remote participant address\n  const currentCallRemoteAddress = currentCall.direction === CALL_DIRECTION.OUTGOING ? currentCall.to : currentCall.from\n  const otherCallRemoteAddress = otherCall.direction === CALL_DIRECTION.OUTGOING ? otherCall.to : otherCall.from\n  const participantAddress = `${currentCallRemoteAddress},${otherCallRemoteAddress}`\n\n  // User the audio constraints from the current call and set video to false.\n  const mediaConstraints = {\n    video: false,\n    audio: currentCall.mediaConstraints ? currentCall.mediaConstraints.audio || true : true\n  }\n\n  // Use the bandwidth constraints from the current call\n  const bandwidth = checkBandwidthControls(currentCall.bandwidth)\n\n  const dscpControls = currentCall.dscpControls\n\n  const turnInfo = getTurnInfo(context.getState())\n  const { trickleIceMode, defaultPeerConfig, removeBundling, serverTurnCredentials } = getOptions(context.getState())\n\n  // Get the call report event ID\n  const callReport = CallReporter.getReport(newCallId)\n  const operationEvent = callReport.findLastOngoingEvent(REPORTER_OPERATION_EVENTS_MAP.JOIN)\n  const operation = currentCall.currentOperations.find(op => op.type === OPERATIONS.JOIN)\n\n  // TechDebt TODO: The joined call should be put in state by the API. That way it exists before the CallManager\n  //    starts doing its thing, and it doesn't need so much special-handling.\n  // Create the new joined call in state right away\n  context.dispatch(\n    callActions.joinStart(newCallId, {\n      // The media constraints this call has.\n      mediaConstraints,\n      // The combined addresses of the 2 other participants in the joined call.\n      participantAddress,\n      // The combined names of the 2 other participants in the joined call.\n      participantName,\n      // This call's current user\n      from,\n      // The ids of the calls that were used for joining.\n      usedCallIds: [currentCall.id, otherCall.id],\n      // The custom parameters of the combined call.\n      customParameters: currentCall.customParameters,\n      // The DSCP Controls of the combined call.\n      dscpControls,\n      // The bandwidth from the original call.\n      bandwidth,\n      // The call report event id for this operation\n      eventId: operationEvent.id,\n      operationId: operation.id\n    })\n  )\n\n  let webrtcInfo\n  try {\n    webrtcInfo = await setupOutgoingSession(mediaConstraints, {\n      defaultPeerConfig,\n      turnInfo,\n      trickleIceMode,\n      dscpControls,\n      removeBundling,\n      bandwidth,\n      callId: newCallId,\n      serverTurnCredentials\n    })\n  } catch (error) {\n    // An error occurred while trying to setup the WebRTC portion of the joined call.\n    //    Report the error and mark the call as ended.\n    log.info(`Failed to initiate call. Changing to ${CALL_STATES.ENDED}.`)\n    context.dispatch(\n      callActions.joinFinish(newCallId, {\n        usedCallIds: [currentCall.id, otherCall.id],\n        error\n      })\n    )\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: newCallId,\n      previous: {\n        // JOIN_START action sets the new call's state to initiating and holds to false\n        state: CALL_STATES.INITIATING,\n        localHold: false,\n        remoteHold: false\n      },\n      error\n    })\n    // Emits a call operation event only for the new call\n    emitEvent(eventTypes.CALL_OPERATION, {\n      callId: newCallId,\n      isLocal: true,\n      operation: OPERATIONS.JOIN,\n      transition: OP_TRANSITIONS.FINISH,\n      previous: undefined,\n      error\n    })\n    throw error\n  }\n\n  return {\n    webrtcInfo\n  }\n}\n\nasync function signalling(container, calls, params) {\n  const { CallRequests, CallstackWebrtc, context, emitEvent, logManager } = container\n  const { webrtcInfo } = params\n\n  const callId = calls[0].id\n  const otherCallId = calls[1].id\n  const newCallId = calls[2].id\n  const log = logManager.getLogger('CALL', callId)\n\n  const currentCall = getCallById(context.getState(), callId)\n  const otherCall = getCallById(context.getState(), otherCallId)\n\n  const { offerSdp, sessionId, mediaIds } = webrtcInfo\n\n  // Collect the information needed to make the request.\n  const callInfo = {\n    id: callId,\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    otherWrtcsSessionId: otherCall.wrtcsSessionId,\n    sdp: offerSdp,\n    // Use the customParameters of the current call\n    customParameters: currentCall.customParameters\n  }\n  let newWrtcsSessionId\n  try {\n    newWrtcsSessionId = await CallRequests.joinSessions(callInfo)\n  } catch (error) {\n    log.info('Failed to join call.')\n    context.dispatch(\n      callActions.joinFinish(newCallId, {\n        error,\n        usedCallIds: [callId, otherCallId]\n      })\n    )\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: newCallId,\n      previous: {\n        // JOIN_START action sets the new call's state to initiating and holds to false\n        state: CALL_STATES.INITIATING,\n        localHold: false,\n        remoteHold: false\n      },\n      error\n    })\n    // Emits a call operation event only for the new call\n    emitEvent(eventTypes.CALL_OPERATION, {\n      callId: newCallId,\n      isLocal: true,\n      operation: OPERATIONS.JOIN,\n      transition: OP_TRANSITIONS.FINISH,\n      previous: undefined,\n      error\n    })\n\n    // Clean-up webrtc resources.\n    await CallstackWebrtc.closeCall(sessionId)\n\n    throw error\n  }\n\n  log.info('Finished local portion of join. Waiting on remote response.')\n\n  // Get the list of all local tracks on the Session. Add the local tracks\n  //    to call state now so they are available while the call rings.\n  const sessionState = getSessionById(context.getState(), sessionId)\n  // Dispatch an action to do the following:\n  //  - create a new \"joined\" call in state\n  //  - update calls used in the join to have isPending property\n  context.dispatch(\n    callActions.pendingJoin(newCallId, {\n      // The ID that the backend uses to track this webRTC session.\n      wrtcsSessionId: newWrtcsSessionId,\n      // The ID that the webRTC stack uses to track this webRTC session.\n      webrtcSessionId: sessionId,\n      // The local Media object associated with this call.\n      mediaIds,\n      // The ids of the calls that were used for joining.\n      usedCallIds: [currentCall.id, otherCall.id],\n      localTracks: sessionState.localTracks,\n      // Set the state of the joined call to Initiated.\n      state: CALL_STATES.INITIATED\n    })\n  )\n  emitEvent(eventTypes.CALL_JOIN, {\n    callId: newCallId\n  })\n\n  // Tell the application that local tracks are available on the call now.\n  emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n    callId: newCallId,\n    trackIds: sessionState.localTracks\n  })\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\nimport * as eventTypes from '../../../../interface/eventTypes'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\nexport default function createHandler(container) {\n  const { context, CallstackWebrtc, emitEvent, logManager } = container\n\n  /**\n   * A \"session failure\" notification has been received for the new, joined call.\n   *    Clean-up the call and mark it as Ended.\n   *\n   * @method joinedFailure\n   * @param {Object} call The joined call for the operation.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @emits call#call:stateChange Error event for operation; no actual state change.\n   * @return {Promise<BasicError>}\n   */\n  return async function joinedFailure(call, params) {\n    const reasonText = params.reasonText || COMPLEX_OPERATION_MESSAGES.JOIN_FAILURE\n    const statusCode = params.statusCode || STATUS_CODES.JOIN_FAILURE\n\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received call operation failed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n    log.debug(`Processing as a local join failure (${statusCode}).`)\n\n    await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n    const error = new BasicError({\n      message: `Join operation failed: ${reasonText} (${statusCode})`,\n      code: callCodes.GENERIC_ERROR\n    })\n\n    context.dispatch(\n      callActions.endCallFinish(call.id, {\n        error\n      })\n    )\n\n    // Notify the app that there has been a call state change\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: true,\n        remoteHold: false\n      },\n      error\n    })\n\n    log.info('Finished handling call operation failed notice.')\n\n    return error\n  }\n}\n","import remoteAnswer from '../../negotiations/make/local/remoteAnswer'\n\n/*\n * The `join` operation creates a new outgoing call (the \"joined\" call). This function\n *    handles the remote answer SDP for that new call. (The two existing calls do\n *    not perform any WebRTC negotiation.)\n *\n * The scenario for the new joined call is the same as a new outgoing call. All\n *    events, state changes, etc. are done exactly the same. So, as a shortcut,\n *    re-use the `make` operation's \"remote answer\" handler. If this join operation\n *    would need any special handling, then its own handler should be implemented.\n */\nexport default remoteAnswer\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\nimport * as eventTypes from '../../../../interface/eventTypes'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\nexport default function createHandler(container) {\n  const { context, emitEvent, logManager } = container\n\n  /**\n   * A \"session failure\" notification has been received, indicating the operation failed.\n   *    Finish the operation.\n   *\n   * @method joinFailure\n   * @param {Object} call The primary call for the operation.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @emits call#call:stateChange Error event for operation; no actual state change.\n   * @return {BasicError}\n   */\n  return function joinFailure(call, params) {\n    const reasonText = params.reasonText || COMPLEX_OPERATION_MESSAGES.JOIN_FAILURE\n    const statusCode = params.statusCode || STATUS_CODES.JOIN_FAILURE\n\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received call operation failed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    log.debug(`Processing as a local join failure (${statusCode}).`)\n    log.info('Finished handling call operation failed notice.')\n\n    const error = new BasicError({\n      message: `Join operation failed: ${reasonText} (${statusCode})`,\n      code: callCodes.GENERIC_ERROR\n    })\n\n    context.dispatch(\n      callActions.joinFinish(call.id, {\n        error,\n        transition: { reasonText, statusCode }\n      })\n    )\n\n    // Notify the app that there has been a call state change\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: true,\n        remoteHold: false\n      },\n      error\n    })\n\n    return error\n  }\n}\n","// Call plugin\nimport { callActions } from '../../../../interface/actions'\nimport { CALL_STATES, COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\nimport { CALL_STATE_CHANGE, CALL_TRACKS_REMOVED } from '../../../../interface/eventTypes'\n\n// Helpers\nimport { generateEndParams } from '../../../utils/call'\n\n/**\n * Bottle wrapper for the \"join success\" notification handler.\n * @return {Function}\n */\nexport default function createHandler(container) {\n  const { context, CallRequests, CallstackWebrtc, emitEvent, logManager } = container\n\n  /**\n   * A \"session complete\" notification has been received, indicating the operation was\n   *    successful. Finish the operation by ending the call and notifying the application.\n   *\n   * @method joinSuccess\n   * @param {Object} call The call being operated on.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @emits call#call:tracksRemoved All tracks on the call have been removed.\n   * @emits call#call:stateChange The call has changed to 'Ended' state.\n   * @return {Promise<undefined>}\n   */\n  async function joinSuccess(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received session status completed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    const { reasonText, statusCode } = params\n    if (reasonText) {\n      let customStatusCode\n      if (!statusCode && statusCode !== 0) {\n        customStatusCode = STATUS_CODES.JOIN_SUCCESS\n      } else {\n        customStatusCode = statusCode\n      }\n      log.debug(`Session completed notice caused by ${reasonText} (${customStatusCode}).`)\n    }\n\n    log.info(`Ending webRTC session with id: ${call.webrtcSessionId}, locally ...`)\n    // Close the local webRTC session\n    await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n    // Update call state to 'Ended'.\n    context.dispatch(\n      callActions.joinFinish(call.id, {\n        transition: {\n          reasonText: COMPLEX_OPERATION_MESSAGES.JOIN_SUCCESS,\n          statusCode: STATUS_CODES.JOIN_SUCCESS\n        }\n      })\n    )\n\n    try {\n      log.debug('Ending call session on server-side.')\n      await CallRequests.endSession({\n        callId: call.id,\n        wrtcsSessionId: call.wrtcsSessionId,\n        isAnonymous: call.isAnonymous,\n        account: call.account\n      })\n    } catch (error) {\n      // Ignore an error from the REST request. End the call locally so the call/application isn't\n      //    stuck in a limbo state.\n      log.debug(`Error received when attempting to end the session: ${error}`)\n    } finally {\n      log.info(`Finished ending call. Changing call state to ${CALL_STATES.ENDED}.`)\n      // TODO: Is this action needed? The call should be 'Ended' by the above action.\n      context.dispatch(callActions.endCallFinish(call.id, generateEndParams(call.state, true, params)))\n\n      // Tell the application that no tracks are available any longer.\n      emitEvent(CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        }\n      })\n    }\n  }\n\n  return joinSuccess\n}\n","import { CALL_STATES } from '../../../../constants'\nimport { getCallById } from '../../../../interface/selectors'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Array<Object>} calls Array of calls this operation will affect.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, calls, from) {\n  const primaryCall = getCallById(state, calls[0].id)\n  const secondaryCall = getCallById(state, calls[1].id)\n\n  /*\n   * `join` operation validation:\n   *    1. First Call must exist.\n   *    2. Second Call must exist.\n   *    3. First Call must be in `On Hold` state.\n   *    4. Second Call must be in `On Hold` state.\n   */\n  if (!primaryCall) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (!secondaryCall) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (primaryCall.state !== CALL_STATES.ON_HOLD) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state: state=${primaryCall.state}. It should be: state=${CALL_STATES.ON_HOLD}.`\n    })\n  } else if (secondaryCall.state !== CALL_STATES.ON_HOLD) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state: state=${secondaryCall.state}. It should be: state=${CALL_STATES.ON_HOLD}.`\n    })\n  }\n}\n","/*\n * Call Operations available in the Callstack.\n * This file is where the names for the operations are defined.\n */\nexport { default as createConsultTransfer } from './complex/consultativeTransfer'\nexport { default as createDirectTransfer } from './negotiations/directTransfer'\nexport { default as createJoin } from './complex/join'\n\nexport { default as createMake } from './negotiations/make'\nexport { default as createAnswer } from './updates/answer'\nexport { default as createEnd } from './updates/end'\nexport { default as createForward } from './updates/forward'\nexport { default as createIgnore } from './updates/ignore'\nexport { default as createReject } from './updates/reject'\nexport { default as createCallCancelled } from './updates/callCancelled'\n\nexport { default as createAddMedia } from './negotiations/addMedia'\nexport { default as createHold } from './negotiations/hold'\nexport { default as createUnhold } from './negotiations/unhold'\nexport { default as createRemoveMedia } from './negotiations/removeMedia'\nexport { default as createReplaceTrack } from './updates/replaceTrack'\nexport { default as createPlayAudioFile } from './updates/playAudioFile'\n\nexport { default as createGetCodecs } from './misc/getAvailableCodecs'\nexport { default as createIceRestart } from './negotiations/iceRestart'\nexport { default as createSendDtmf } from './updates/sendDtmf'\nexport { default as createResyncCallState } from './updates/resyncCallState'\n\nexport { default as createIceCollectionCheck } from './misc/iceCollectionCheck'\nexport { default as createGetStats } from './updates/getStats'\nexport { default as createNormalizeIceFailure } from './misc/normalizeIceFailure'\nexport { default as createSendCallAudit } from './misc/sendCallAudit'\nexport { default as createSendCustom } from './updates/sendCustomParameters'\nexport { default as createSendRingingFeedback } from './updates/sendRingingFeedback'\n\nexport { default as createMoH } from './negotiations/musicOnHold'\nexport { default as createGenericRemote } from './negotiations/genericRemote'\nexport { default as createSlowStart } from './negotiations/slowStart'\n","// Other plugins.\nimport BasicError from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"get codecs\" operation.\n * @return {Function}\n */\nexport default function getAvailableCodecsOperation(container) {\n  const { logManager, WebRTC } = container\n\n  /**\n   * Uses the WebRTC stack to get the list of available and supported codecs by the browser\n   *\n   * @method getAvailableCodecs\n   * @param  {string} kind The kind of media, i.e., 'audio' or 'video', to get the list of available codecs of.\n   * @return {Object} An object containing the available codecs.\n   */\n  async function getAvailableCodecs(kind) {\n    const log = logManager.getLogger('CALL')\n\n    // TODO: Remove this once parameter validation is available for APIs\n    if (kind !== 'audio' && kind !== 'video') {\n      const errorMsg = `Cannot retrieve codecs for media kind ${kind}. Only 'audio' or 'video' kind supported.`\n      log.info(errorMsg)\n\n      throw new BasicError({ message: errorMsg })\n    }\n    log.info(`Retrieving list of available codecs for media kind '${kind}'.`)\n\n    // Get the list of codecs from the general WebRTCManager\n    const codecs = await WebRTC.webrtcManager.getAvailableCodecs(kind)\n\n    // NOTE: There does not seem to be a path for failure, as RTCRtpSender.getCapabilities(kind)\n    //       always returns something according to API doc\n    //       (including null, if there are simply no capabilities present)\n    //       As a result of null, may want to consider an empty array of `codecs` as a failure in the furture.\n    log.debug('Successfully retrieved codec list:', codecs)\n    return codecs\n  }\n\n  return getAvailableCodecs\n}\n","import getCodecsOperation from './getAvailableCodecs'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.getAvailableCodecs', () => {\n    // Note: getAvailableCodecs is not a call-specific operation. The CallManager\n    //    does not manage it.\n    return getCodecsOperation(bottle.container)\n  })\n}\n","// Call plugin.\nimport { getOptions, getCallByWebrtcSessionId } from '../../../../interface/selectors'\nimport { callActions } from '../../../../interface/actions'\nimport { ICE_COLLECTION_RESULT_TYPES as RESULT_TYPES } from '../../../../constants'\nimport { ICE_COLLECTION_OPERATIONS, REPORT_EVENTS } from '../../../reporter/constants'\nimport { CALL_STATE_CHANGE } from '../../../../interface/eventTypes'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for ...\"callIceCollectionCheck\".\n * @return {Function}\n */\nexport default function callIceCollectionCheckOperation(container) {\n  const { CallReporter, context, emitEvent, logManager, WebRTC } = container\n\n  /**\n   * Add the necessary information to the ice collection info object and call the\n   *  ice collection check function. Then pass the results of the check back to the\n   *  WebRTC stack for further processing.\n   *\n   * @method callIceCollectionCheck\n   * @param {Object} webrtcSessionId    The id of the call being acted on.\n   * @param {Object} iceCollectionInfo  An object containing necessary info for the call.\n   */\n  async function callIceCollectionCheck(webrtcSessionId, iceCollectionInfo) {\n    // Get info from state for the operation.\n    const currentCall = getCallByWebrtcSessionId(context.getState(), webrtcSessionId)\n    const config = getOptions(context.getState())\n\n    const log = logManager.getLogger('CALL', currentCall ? webrtcSessionId : '')\n\n    // Metrics tracking for relay candidates\n    const callReport = CallReporter.getReport(currentCall.id)\n    const latestMainEvent = callReport.findLastOngoingEvent(Object.values(ICE_COLLECTION_OPERATIONS))\n    let iceCollectionEvent\n    if (latestMainEvent) {\n      const setLocalDescEvent = latestMainEvent.timeline.find(event => event.type === REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n      if (setLocalDescEvent) {\n        const relayCandidates = iceCollectionInfo.iceCandidates.filter(\n          candidate => candidate.component === 'rtp' && candidate.type === 'relay'\n        )\n\n        // Get or create the ice collection reporter event if it doesn't already exist\n        iceCollectionEvent = setLocalDescEvent.timeline.find(event => event.type === REPORT_EVENTS.ICE_COLLECTION)\n        if (!iceCollectionEvent) {\n          iceCollectionEvent = setLocalDescEvent.addEvent(REPORT_EVENTS.ICE_COLLECTION)\n        }\n        if (relayCandidates.length > 0) {\n          const eventData = iceCollectionEvent.getData('relayCandidates') || []\n\n          relayCandidates.forEach(candidate => {\n            if (!eventData.includes(candidate)) {\n              const relayCollectedEvent = iceCollectionEvent.addEvent(REPORT_EVENTS.RELAY_CANDIDATE_COLLECTED)\n              relayCollectedEvent.addData('address', candidate.address)\n              relayCollectedEvent.addData('port', candidate.port)\n              relayCollectedEvent.endEvent()\n              // Update the relayCandidates array\n              iceCollectionEvent.addData('relayCandidates', relayCandidates)\n            }\n          })\n        }\n      }\n    } else {\n      // If latestMainEvent is undefined, that's a bug. Log it loudly.\n      log.error('ICE collection process could not determine current operation.')\n    }\n\n    log.debug('Calling ICE collection check function for reason:', iceCollectionInfo.reason)\n    let result\n    /*\n     * Scenarios expected after calling `iceCollectionCheckFunction`:\n     *    1. Returns a 'Start' or 'Wait' result.\n     *    2. Returns an 'Error' result (with a string error message).\n     *    3. Returns in invalid result object (eg. not expected type).\n     *    4. Throws an error.\n     *\n     * In error scenarios (2, 3, 4), the result will be formatted as:\n     *    { type: 'Error', error: BasicError }\n     * In success scenario, the result will be formatted as `IceCollectionCheckResult`\n     *    is documented.\n     */\n    try {\n      // Find the current operation in the call state.\n      const operation = currentCall.currentOperations.find(op => {\n        // latestMainEvent _should_ be defined, but the above has an if/else around\n        //    it.... so the logic is not confident that is always is. Do the same here.\n        if (latestMainEvent) {\n          return op.eventId === latestMainEvent.id\n        }\n      })\n      result = config.iceCollectionCheckFunction(\n        {\n          callId: currentCall.id,\n          callOperation: operation ? operation.type : 'UNKNOWN',\n          ...iceCollectionInfo\n        },\n        {\n          // TODO: If a call changes these configs in the middle of ICE collection,\n          //    it will change the values given to this function. Very unlikely scenario,\n          //    but could cause issues. Could also change `iceCollectionCheckFunction` itself.\n          iceCollectionIdealTimeout: config.iceCollectionIdealTimeout,\n          iceCollectionMaxTimeout: config.iceCollectionMaxTimeout\n        }\n      )\n\n      if (typeof result !== 'object' || !Object.values(RESULT_TYPES).includes(result.type)) {\n        // Scenario 3:\n        //  If the result is not an IceCollectionCheckResult object, convert it to an Error result.\n        log.error('Configured IceCollectionCheckFunction returned an invalid result type. Ending call.', result)\n        result = {\n          type: RESULT_TYPES.ERROR,\n          error: new BasicError({\n            code: callCodes.INVALID_PARAM,\n            message: 'Malformed IceCollectionCheckResult provided by configured IceCollectionCheckFunction.'\n          })\n        }\n      } else if (result.type === RESULT_TYPES.ERROR) {\n        // Scenario 2:\n        //  If the result was an Error result, format it to match other error scenarios.\n        result = {\n          type: RESULT_TYPES.ERROR,\n          error: new BasicError({\n            message: result.error,\n            code: callCodes.GENERIC_ERROR\n          })\n        }\n      }\n    } catch (e) {\n      // Scenario 4:\n      //  If the function threw an error, format it to match other error scenarios.\n      log.info('Error thrown by the iceCollectionCheckFunction. Ending call.', e)\n      result = {\n        type: RESULT_TYPES.ERROR,\n        error: new BasicError({\n          code: callCodes.UNKNOWN_ERROR,\n          message: 'Configured IceCollectionCheckFunction threw an error during ICE collection.'\n        })\n      }\n    }\n\n    // Get the webrtc Session for the call.\n    const session = await WebRTC.sessionManager.get(webrtcSessionId)\n    // Get the remote description for the Session.\n    log.debug('Handling ICE collection check result:', result.type)\n    await session.iceCollectionCheckResult(result)\n\n    // ICE collection is complete if we are not waiting any longer.\n    // TODO: Is iceCollectionEvent ever not defined here? Why check for it?\n    if (iceCollectionEvent && result.type !== RESULT_TYPES.WAIT) {\n      if (result.type === RESULT_TYPES.ERROR) {\n        iceCollectionEvent.setError(result)\n      }\n      iceCollectionEvent.endEvent()\n    }\n\n    // If the result is an error, the call should be ended. The Session should have\n    //     cleaned-up the WebRTC resources (in `session.iceCollectionCheckResult`),\n    //     so update the call state here.\n    if (result.type === RESULT_TYPES.ERROR) {\n      context.dispatch(\n        callActions.endCallFinish(currentCall.id, {\n          isLocal: true,\n          error: result.error\n        })\n      )\n\n      emitEvent(CALL_STATE_CHANGE, {\n        callId: currentCall.id,\n        previous: {\n          state: currentCall.state,\n          localHold: currentCall.localHold,\n          remoteHold: currentCall.remoteHold\n        },\n        error: result.error\n      })\n    }\n  }\n\n  return callIceCollectionCheck\n}\n","import iceCollectionCheckOperation from './iceCollectionCheck'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.callIceCollectionCheck', () => iceCollectionCheckOperation(bottle.container))\n}\n","import normalizeIceFailureOp from './normalizeIceFailure'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.normalizeIceFailure', () => normalizeIceFailureOp(bottle.container))\n}\n","// Call plugin\nimport { getCallByWebrtcSessionId } from '../../../../interface/selectors'\n\n// Other plugins\nimport { CALL_MEDIA_CONNECTION_STATES, CALL_STATES } from '../../../../constants'\nimport { SESSION_ICE_CONNECTION_STATE_CHANGE } from '../../../../../webrtc/interface/actionTypes'\nimport { END_CALL_FINISH } from '../../../../interface/actionTypes'\nimport * as sessionActions from '../../../../../webrtc/interface/actions/sessions'\nimport { MEDIA_CONNECTION_CHANGE } from '../../../../interface/eventTypes'\n\n/**\n * Bottle wrapper for \"normalize ICE failure\" operation.\n * @return {Function}\n */\nexport default function createNormalizeIceFailureOperation(container) {\n  const { context, emitEvent, logManager, Notifications } = container\n  /**\n   * This operation is meant to normalize ICE connection state changes for Unified-Plan PeerConnections only.\n   *\n   * Expectation: When ICE connection has an issue, it moves into `disconnected`\n   *    state. If it can't automatically fix the issue, it should move into `failed`\n   *    state shortly afterwards.\n   * Reality: Unified-Plan behaves a little differently, where it never transitions\n   *    into `failed` state. Other plans (such as Plan-B) use heuristics to know when to give up and\n   *    transition into `failed` state, but Unified-Plan does not.\n   * Ref: https://docs.google.com/document/d/1-ZfikoUtoJa9k-GZG1daN0BU3IjIanQ_JSscHxQesvU/edit#heading=h.xy9xt6bk24e\n   *\n   * So this function is meant to \"fill-in\" that missing behaviour for Unified-Plan:\n   *    If a Unified-Plan call enters `disconnected` state, we want to wait a short\n   *    amount of time (due to lacking any real heuristic). If the call is still\n   *    disconnect after that time, we assume it should be in `failed` state and\n   *    manually update the call state.\n   *\n   * The purpose for doing this is to enter other behaviours that rely on the `failed`\n   *    state (eg. ICE restart, telling the application there is no media) still occur.\n   * @method normalizeIceFailure\n   * @param  {Action} action A \"ICE connection state change\" action specifically\n   *    for the disconnected state.\n   */\n  async function normalizeIceFailure(webrtcSessionId, mediaConnectionState) {\n    /**\n     * Determines if a call is in limbo disconnected media state.\n     * @param  {CallObject}  targetCall\n     * @return {boolean} Whether the call is on-going but in disconnected ICE state.\n     */\n    function isDisconnected(targetCall) {\n      // 1) Call exists, 2) Call is on-going, 3) Call's media is disconnected.\n      return (\n        targetCall &&\n        ![CALL_STATES.ENDED, CALL_STATES.CANCELLED].includes(targetCall.state) &&\n        mediaConnectionState === CALL_MEDIA_CONNECTION_STATES.DISCONNECTED\n      )\n    }\n\n    const call = getCallByWebrtcSessionId(context.getState(), webrtcSessionId)\n\n    if (!isDisconnected(call, mediaConnectionState)) {\n      // We only want to act if the call is currently disconnected.\n      return\n    }\n\n    try {\n      /*\n       * Wait a short time to let the Call try fixing things itself.\n       * The number \"10000\" was determined by comparing how long it takes for the\n       *    disconnected-->failed transition to happen when on Plan-B. It consistently\n       *    took [almost] exactly 10 seconds for the change to happen, no matter\n       *    if it was an audio-only or audio+video call.\n       * Note: This test was done on Chrome, since it was the only browser to support\n       *       Plan-B.\n       * Note: 10s is also Chrome's timeout for collecting ICE candidates on an\n       *    interface. I assume this isn't a coincidence.\n       */\n      await Notifications.takeAction(action => {\n        return (\n          (action.type === SESSION_ICE_CONNECTION_STATE_CHANGE &&\n            action.payload.id === webrtcSessionId &&\n            action.payload.iceConnectionState !== CALL_MEDIA_CONNECTION_STATES.DISCONNECTED) ||\n          (action.type === END_CALL_FINISH && action.payload.id === call.id)\n        )\n      }, 10000)\n    } catch (error) {\n      // Timed out waiting for ice connection state to change\n      // Get the call state again, to make sure we have the latest state.\n      const currentCall = getCallByWebrtcSessionId(context.getState(), webrtcSessionId)\n      // If the call is still disconnected, assume that it should have moved into\n      //    failed state. Manually trigger the action to transition into failed state.\n      const log = logManager.getLogger('CALL', currentCall.id)\n      log.debug(\n        'Call has remained in disconnected media connection state too long. Manually transitioning to failed state.'\n      )\n\n      context.dispatch(\n        sessionActions.sessionIceConnectionStateChange(currentCall.webrtcSessionId, {\n          iceConnectionState: CALL_MEDIA_CONNECTION_STATES.FAILED\n        })\n      )\n      emitEvent(MEDIA_CONNECTION_CHANGE, {\n        callId: currentCall.id,\n        previous: {\n          state: currentCall.mediaConnectionState\n        }\n      })\n    }\n  }\n\n  return normalizeIceFailure\n}\n","import sendCallAuditOperation from './sendCallAudit'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.sendCallAudit', () => {\n    // `sendCallAudit` operation returns an object of functions instead of the\n    //    operation itself.\n    return sendCallAuditOperation(bottle.container).sendCallAudit\n  })\n}\n","import { getCallById, getOptions } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\nimport { callActions } from '../../../../interface/actions'\nimport * as eventTypes from '../../../../interface/eventTypes'\nimport { OPERATIONS, OP_TRANSITIONS } from '../../../../interface/constants'\n\n/**\n * Bottle wrapper for call audit operation.\n * @return {Function}\n */\nexport default function sendCallAuditOperation(container) {\n  const { context, CallstackWebrtc, CallRequests, logManager, emitEvent } = container\n\n  // Global within the scope of this operation. This is the handle returned by the\n  // call to `setTimeout` which involves a 4000 ms waiting time.\n  let timeoutHandle\n\n  let successDelay\n  let errorDelay\n\n  function getAuditDuration(lastAudit) {\n    return Date.now() - lastAudit\n  }\n\n  /**\n   * This is the first called helper function in a continuous audit loop.\n   * It just instantiates the two tasks that are about to be run: a timeout task and a call audit task.\n   * These two tasks will be competing against each other to see which one executes first.\n   *\n   * @param {Object} currentCall The Call's state.\n   * @returns {Object} An object containing the two tasks.\n   */\n  function prepareRaceTriggers(currentCall, wrtcsSessionId) {\n    const triggerTimeout = new Promise((resolve, reject) => {\n      const result = { timeout: 4000 } // `value` returned when timeout expires.\n      timeoutHandle = setTimeout(resolve, 4000, result)\n    })\n\n    const triggerAudit = new Promise((resolve, reject) => {\n      // Clear the timeout handle since it is still on-going at this point.\n      clearTimeout(timeoutHandle)\n\n      // For Link the function request has the same name.\n      // Note that the caller, wrtcsSessionId is not yet available as part of the currentCall,\n      // as it was not yet commited in Redux state.\n      // This is because the `callAudit` middleware is still in progress at this time.\n      // TODO: Replace the logic in determining value for `wrtcsSessionId` with a better way..\n      const wrtcsSessionIdToUse = currentCall.isCaller ? wrtcsSessionId : currentCall.wrtcsSessionId\n\n      CallRequests.auditCall({\n        wrtcsSessionId: wrtcsSessionIdToUse,\n        isAnonymous: currentCall.isAnonymous,\n        account: currentCall.account,\n        id: currentCall.id\n      })\n        .then(result => {\n          resolve({ audit: { status: result.status } }) // `value` returned when we get a response from request (for either success or failure)\n        })\n        .catch(error => {\n          // Assume for most of errors we can retry..\n          let statusVal = 'Retry'\n          // 42  is the 'Not found' error that LINK may return\n          if (error && error.code === 42) {\n            // We got a 'Not found' error. In this case we can safely assume status is Closed. No need to keep retrying...\n            statusVal = 'Closed'\n          }\n          resolve({ audit: { status: statusVal, error } })\n        })\n    })\n\n    return {\n      triggerTimeout,\n      triggerAudit\n    }\n  }\n\n  /**\n   * This is the second helper function invoked as part of the audit loop.\n   * @param {Object} value The race result. If audit task completed first, then it will have an audit property, otherwise it will have a timeout property.\n   * @param {Object} currentCall The current call we're auditing.\n   * @param {number} lastAudit The most recently generated timestamp as returned by: Date.now().\n   * @param {Object} log The logger necessary to generate some logs along the way.\n   * @returns {number} Milliseconds to wait before next loop. If negative, should not loop again.\n   */\n  async function handleAuditResult(value, currentCall, lastAudit, log) {\n    const config = getOptions(context.getState())\n    successDelay = Math.max(10000, config.callAuditTimer)\n    errorDelay = Math.min(5000, config.callAuditTimer * 0.45)\n\n    /*\n     * Audit response error scenarios include the response having an `error: true` and `status` property.\n     *  The status will be either 'Retry' or 'Closed' (depending on statusCode we get from response),\n     *  and nothing else. See `auditCall` request implementation in Link.\n     * Success scenarios will have `error: false` along with the call's `status`.\n     */\n    if (value.audit.status === 'Retry') {\n      // We have an error but status is not Closed, so we continue sending audit request in hoping audit will recover\n      const basicError = value.audit.error\n      const auditDuration = getAuditDuration(lastAudit)\n      log.debug(\n        `Call audit failed, caused by ${basicError.message} (${\n          basicError.code\n        }); will retry failed audit for call in: ${errorDelay - auditDuration} ms`\n      )\n      return errorDelay - auditDuration\n    } else if (value.audit.status === 'Closed') {\n      // If this audit returned 'Closed', then the audit loop should stop right away.\n      log.info(`Ending audit loop and Call due to Closed status. Changing to ${CALL_STATES.ENDED}.`)\n      // Hangup call automatically (from webRTC perspective)\n      await CallstackWebrtc.closeCall(currentCall.webrtcSessionId)\n\n      const latestCallState = getCallById(context.getState(), currentCall.id)\n      if (latestCallState.state !== CALL_STATES.ENDED && latestCallState.state !== CALL_STATES.CANCELLED) {\n        // Cleanup Redux state by sending END_CALL_FINISH action\n        context.dispatch(\n          callActions.endCallFinish(currentCall.id, {\n            isLocal: true,\n            transition: { statusCode: 9909, reasonText: 'Call has ended due to call audit failure.' }\n          })\n        )\n\n        // Dispatch the same events that are normally triggered by action: END_CALL_FINISH\n        // (see `call/callstack/operations/establish/end` operation)\n\n        // 1- 'call operation' event\n        emitEvent(eventTypes.CALL_OPERATION, {\n          callId: currentCall.id,\n          isLocal: true,\n          operation: OPERATIONS.END,\n          transition: OP_TRANSITIONS.FINISH,\n          previous: {},\n          error: undefined\n        })\n\n        // Tell the application that no tracks are available any longer.\n        emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n          callId: currentCall.id,\n          trackIds: [...currentCall.localTracks, ...currentCall.remoteTracks]\n        })\n\n        // 2- 'call state change' event, which updates the state.\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId: currentCall.id,\n          previous: {\n            state: currentCall.state,\n            localHold: currentCall.localHold,\n            remoteHold: currentCall.remoteHold\n          },\n          transition: {\n            statusCode: 9909,\n            reasonText: 'Call has ended due to call audit failure.'\n          },\n          error: value.audit.error\n        })\n      }\n      // Return a negative number to prevent the task from looping again.\n      return -1\n    } else {\n      const auditDuration = getAuditDuration(lastAudit)\n      log.debug(`Call audit status is ${value.audit.status}. Will retry in ${successDelay - auditDuration} ms`)\n      return successDelay - auditDuration\n    }\n  }\n\n  /**\n   * This is the repeated task executed during each call audit's loop iteration.\n   * @param {string} callId The unique call identifier for which we're auditing.\n   * @param {string} wrtcsSessionId The ID that the server uses to identify the call.\n   */\n  async function repeatingTask(callId, wrtcsSessionId) {\n    const log = logManager.getLogger('CALL', callId || '')\n    let state\n\n    try {\n      /**\n       * KJS-2164 TODO: This task should be stopped when the SDK is destroyed,\n       *  instead of having to check that state exists\n       */\n      state = context.getState()\n    } catch (e) {\n      log.debug('Failed to run repeating task; state has likely been destroyed')\n      return\n    }\n\n    const currentCall = getCallById(state, callId)\n\n    // Stop repeating if the Call has already ended or it has been cancelled.\n    if ([CALL_STATES.ENDED, CALL_STATES.CANCELLED].includes(currentCall.state)) {\n      log.info(`Call is in ${currentCall.state} state; stopping audit loop.`)\n      return\n    }\n    const raceTriggers = prepareRaceTriggers(currentCall, wrtcsSessionId)\n\n    // NOTE: lastAudit value is calculated at the beginning of each loop\n    const lastAudit = Date.now()\n\n    return Promise.race([raceTriggers.triggerTimeout, raceTriggers.triggerAudit])\n      .then(value => {\n        if (value.timeout) {\n          // No need to cancel the audit task since the effect that loses the race is automatically cancelled\n          log.debug('Audit request timed out, retrying in 1 second.')\n          return 1000\n        } else {\n          if (value.audit) {\n            return handleAuditResult(value, currentCall, lastAudit, log)\n          } else {\n            log.debug('Audit loop encountered an unknown scenario; ending.')\n            // Return a negative number to prevent the task from looping again.\n            return -1\n          }\n        }\n      })\n      .then(waitTime => {\n        // If the resolve has a positive wait time, loop again after that.\n        if (waitTime >= 0) {\n          setTimeout(function () {\n            repeatingTask(callId, wrtcsSessionId)\n          }, waitTime)\n        }\n      })\n  }\n\n  /**\n   * Performs a call audit and manages the audit loop.\n   *\n   * This function is responsible for sending a call audit repeatedly on a consistent interval.\n   *  Consistency is ensured by calculating the time it takes to perform the actual\n   *  audit request, and subtracting that from the configured call audit timer.\n   *\n   * The function determines which interval to use for the delay between requests by analyzing\n   *  the response to the audit request:\n   *    - for a successful response we use __Max(10s, configured `callAuditTimer`) - request duration__\n   *    - for an error response we use __Min(5s, 45% of `callAuditTimer`) - request duration__\n   *    - for a \"Closed\" status response, we stop the audit loop and tear down the call\n   *\n   * Responsibilities:\n   *    1. Determine if an audit should be sent.\n   *        - Check call's state.\n   *    2. Perform signaling (if needed).\n   *    3. Return the status of the audit\n   * @method sendCallAudit\n   * @param {string} callId The unique identifier of a call instance.\n   * @param {Object} params\n   * @param {string} params.wrtcsSessionId The ID that the server uses to identify the call.\n   * @return {undefined}\n   */\n  async function sendCallAudit(callId, params) {\n    const wrtcsSessionId = params.wrtcsSessionId\n    const currentCall = getCallById(context.getState(), callId)\n\n    const log = logManager.getLogger('CALL', currentCall ? callId : '')\n    // Basic validation\n    if (!currentCall) {\n      log.debug(`Call ${callId} not found; no audit loop needed.`)\n      return\n    }\n\n    log.info('Starting audit loop for new call.')\n    repeatingTask(callId, wrtcsSessionId)\n  }\n\n  return {\n    sendCallAudit,\n    prepareRaceTriggers,\n    handleAuditResult,\n    repeatingTask,\n    errorDelay,\n    successDelay\n  }\n}\n","// Operations.\nimport createLocalStages from './local/addMedia'\nimport addMediaValidate from './local/validate'\nimport webrtcAddMediaOperation from './webrtcAddMedia'\nimport rollbackOperation from './rollbackAddMedia'\nimport basicValidate from './local/validateBasic'\n\nimport createRemoteStages from './remote/remoteOffer'\nimport remoteAnswer from './local/remoteAnswer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.addMedia', () => {\n    const localStages = createLocalStages(bottle.container)\n    const remoteStages = createRemoteStages(bottle.container)\n\n    return {\n      local: {\n        // Stages of local operation.\n        validate: addMediaValidate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container),\n        rollback: rollbackOperation(bottle.container)\n      },\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: remoteStages.localChanges,\n        signalling: remoteStages.signalling\n      }\n    }\n  })\n\n  bottle.factory('Callstack.stages.addBasicMedia', () => {\n    const localStages = createLocalStages(bottle.container)\n    return {\n      local: {\n        // Stages of local operation.\n        validate: basicValidate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container),\n        rollback: rollbackOperation(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.addMedia', () => {\n    const Callstack = bottle.container.Callstack\n    const negFactory = Callstack.models.Negotiation\n\n    function addMedia(isLocal) {\n      /**\n       * Factory function for AddMedia operation.\n       * @method addMedia\n       * @param {string} callId ID for the call this operation will affect.\n       * @return {Operation} An instance of an addMedia operation.\n       */\n      return callId => {\n        const stages = Callstack.stages.addMedia[isLocal ? 'local' : 'remote']\n        return negFactory.instance(\n          {\n            // Operation meta-data.\n            type: OPERATIONS.ADD_MEDIA,\n            isLocal,\n            // Operation methods.\n            stages\n          },\n          {\n            callId\n          }\n        )\n      }\n    }\n\n    return {\n      local: addMedia(true),\n      remote: addMedia(false)\n    }\n  })\n\n  bottle.factory('Callstack.operations.addBasicMedia', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    function basicAddMedia() {\n      /**\n       * Factory function for basic AddMedia operation.\n       * @method basicAddMedia\n       * @param {string} callId ID for the call this operation will affect.\n       * @return {Operation} An instance of the basic addMedia operation.\n       */\n      return callId => {\n        return negFactory.instance(\n          {\n            // Operation meta-data.\n            type: OPERATIONS.ADD_BASIC_MEDIA,\n            isLocal: true,\n            // Operation methods.\n            stages: bottle.container.Callstack.stages.addBasicMedia.local\n          },\n          {\n            callId\n          }\n        )\n      }\n    }\n\n    return {\n      local: basicAddMedia()\n      // There is no remote 'basic' operation; it is seen as a regular removeMedia operation.\n    }\n  })\n\n  // Helpers used only within the operation.\n  bottle.factory('Callstack.utils.webrtcAddMedia', () => webrtcAddMediaOperation(bottle.container))\n  bottle.factory('Callstack.utils.rollbackAddMedia', () => rollbackOperation(bottle.container))\n}\n","// Call plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { CALL_STATE_CHANGE } from '../../../../../interface/eventTypes'\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Libraries\nimport { getBrowserDetails } from 'kandy-webrtc'\n\n/**\n * Bottle wrapper for addMedia call operation.\n * @return {Object}\n */\nexport default function createAddMedia(container) {\n  return {\n    localChanges: (callId, mediaConstraints, options) => localChanges(container, callId, mediaConstraints, options),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * Local changes for the 'add media' operation.\n *\n * Performs WebRTC changes to the local side of the call.\n * @async\n * @method localChanges\n * @param {Object}   callId The ID of the call.\n * @param {Object}   mediaConstraints The constraints for the new media.\n * @param {Object}   options Extra options for the media.\n * @param {Object}   options.bandwidth Bandwidth options.\n * @param {Object}   options.dscpControls DSCP controls.\n * @return {Promise<Object>}\n */\nexport async function localChanges(container, callId, mediaConstraints, options) {\n  const { context, Callstack, logManager } = container\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Adding media to call.')\n\n  const targetCall = getCallById(context.getState(), callId)\n  const { bandwidth, dscpControls } = options\n\n  // Get some call data.\n  const { webrtcSessionId, bandwidth: callBandwidth } = targetCall\n\n  const finalBandwidth = {\n    audio: bandwidth && bandwidth.audio ? bandwidth.audio : callBandwidth.audio,\n    video: bandwidth && bandwidth.video ? bandwidth.video : callBandwidth.video\n  }\n  // Create media and add tracks using webRTC\n  // TODO: This could so add try/catch and end the event if is an error\n  const { sdp, medias } = await Callstack.utils.webrtcAddMedia(mediaConstraints, {\n    sessionId: webrtcSessionId,\n    bandwidth: finalBandwidth,\n    dscpControls\n  })\n\n  // Meta-data from the operation to be handled by the CallManager.\n  const operationData = {\n    local: true,\n    mediaIds: medias.map(media => media.id),\n    tracks: medias.reduce((acc, currMedia) => {\n      return acc.concat(currMedia.tracks.map(track => track.id))\n    }, []),\n    bandwidth: finalBandwidth\n  }\n\n  log.info('Finished local portion of adding media. Waiting on remote response.')\n  return {\n    operationData, // Operation data for the CallManager.\n    sdp\n  }\n}\n\n/**\n * Signalling stage for the 'add media' operation.\n *\n * Sends a REST request to the server with the local offer SDP.\n * @async\n * @method signalling\n * @param {Object} container\n * @param {string} callId The ID of the call.\n * @param {Object} params Data returned by the `localChanges` stage.\n * @param {SDP} params.sdp The local offer SDP generated by the `localChanges` stage.\n * @param {Object} params.operationData Data about what the `localChanges` stage acted on.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws an error if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, CallRequests, Callstack, CallstackWebrtc, emitEvent, logManager } = container\n  const { operationData, sdp } = params\n\n  const call = getCallById(container.context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  // Perform signalling to add media\n  try {\n    await CallRequests.updateSession({\n      wrtcsSessionId: call.wrtcsSessionId,\n      id: call.id,\n      offer: sdp,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n  } catch (responseError) {\n    log.info('Failed to add media to call.')\n    // Rollback is not supported on safari or for a plan other than unified-plan\n    let rollbackErr\n    try {\n      await Callstack.utils.rollbackAddMedia(call.webrtcSessionId, operationData)\n    } catch (rollbackError) {\n      log.debug('Automatic add media rollback failed:', rollbackError)\n      // TODO:\n      //  1 - Don't handle the error in the catch since we do the chrome behaviour only after rollback operation\n      //  2 - Check if chrome still has a rollback issue\n      // Ideally, we would do the chrome behaviour checks before we even attempt the rollback, but for now we\n      // close the call on chrome after doing the rollback regardless of success/failure\n      rollbackErr = rollbackError\n    }\n\n    const browser = getBrowserDetails().browser\n    // There is an issue on Chrome where the remote track is removed from the call when the SDP rolls back\n    //  leaving the call in an awkward state.\n    if (rollbackErr || browser === 'chrome') {\n      // Although Safari can automatically rollback and set another local offer while in `have-local-offer`\n      //  signalling state, Safari does not perform an automatic rollback when a remote offer is\n      //  received while in that state. An InvalidStateError is thrown instead and call is in an awkward state.\n      if (browser === 'safari' || browser === 'chrome') {\n        log.info('Ending call due to unrecoverable state after call add media failure.')\n        // Hangup the call from WebRTC perspective\n        await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n        // Cleanup Redux state by sending END_CALL_FINISH action\n        context.dispatch(\n          callActions.endCallFinish(call.id, {\n            isLocal: true,\n            transition: { reasonText: 'Call has ended due to call add media failure.' }\n          })\n        )\n\n        emitEvent(CALL_STATE_CHANGE, {\n          callId: call.id,\n          previous: {\n            state: call.state,\n            localHold: call.localHold,\n            remoteHold: call.remoteHold\n          },\n          error: responseError\n        })\n        throw responseError\n      }\n      log.info('Unable to reset state after add media operation failure, future operations may not work as intended.')\n    }\n\n    throw responseError\n  }\n}\n","// Callstack.\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../../reporter/constants'\n\n// Other plugins.\nimport { getMediaById } from '../../../../../../webrtc/interface/selectors'\n\nexport default function createAddMediaResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started add media operation.\n   *\n   * On succesful handling:\n   *    - updates call state to added new local tracks,\n   *    - emits a \"media added\" event\n   *    - emits a \"tracks added\" event\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"tracks removed\" event\n   *    - emits a \"call state change\" event.\n   *\n   * @method addMediaResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function addMediaResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && [OPERATIONS.ADD_MEDIA, OPERATIONS.ADD_BASIC_MEDIA].includes(op.type)\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    processResponseEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.ADD_MEDIA)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      // Tell the application that local tracks are not available, since the\n      //    call is ending in error.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    // Get the list of track IDs added to the call by this operation.\n    const medias = operation.operationData.mediaIds.map(id => getMediaById(context.getState(), id))\n    let affectedLocalTracks = []\n    medias.forEach(media => {\n      affectedLocalTracks = affectedLocalTracks.concat(media.tracks)\n    })\n\n    // call:newMedia event\n    emitEvent(eventTypes.CALL_ADDED_MEDIA, {\n      callId: call.id,\n      local: true,\n      tracks: affectedLocalTracks,\n      mediaId: operation.operationData.mediaIds\n    })\n\n    /*\n     * Update call state:\n     *    - add new tracks to the call.\n     */\n    context.dispatch(\n      callActions.addMediaFinish(call.id, {\n        bandwidth: operation.operationData.bandwidth,\n        // For an add media operation, the newly added media are the affected tracks.\n        localTracks: affectedLocalTracks\n      })\n    )\n\n    // Tell the application that new tracks have been added.\n    emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n      callId: call.id,\n      trackIds: affectedLocalTracks\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return addMediaResponse\n}\n","// Call plugin\nimport { CALL_STATES } from '../../../../../constants'\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId, mediaConstraints, options) {\n  const call = getCallById(state, callId)\n  /*\n   * `addMedia` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state !== CALL_STATES.CONNECTED) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Invalid call state: ${call.state}. It should be: ${CALL_STATES.CONNECTED}.`\n    })\n  }\n}\n","import addMediaValidate from './validate'\n\n// Call plugin.\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Other plugins\nimport BasicError, { callCodes } from '../../../../../../errors'\nimport { getTrackById } from '../../../../../../webrtc/interface/selectors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId, kind, mediaConstraints, options) {\n  const call = getCallById(state, callId)\n  const tracksOfKind = call\n    ? call.localTracks.map(id => getTrackById(state, id)).filter(track => track.kind === kind)\n    : undefined\n\n  /*\n   * `addMedia` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected` state.\n   * `addBasicMedia` operation validation:\n   *    3. Call must not already have a track of `kind` media.\n   */\n  const addMediaError = addMediaValidate(state, callId, mediaConstraints, options)\n  if (addMediaError) {\n    return addMediaError\n  } else if (tracksOfKind.length >= 1) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: `Too many ${kind} tracks for basic scenario!`\n    })\n  }\n}\n","// Callstack.\nimport { getMediaState } from '../../../../../utils/state'\nimport getAffectedRemoteTracks from '../../../../sdp/media/remoteTracks'\nimport setMediaInactive from '../../../../sdp/utils/setMediaInactive'\nimport { CALL_MEDIA_STATES } from '../../../../../constants'\n\nimport { callActions as actions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nexport default function createAddMediaHandler(container) {\n  const { context, emitEvent } = container\n\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    /**\n     * Signalling wrapper to handle state changes and events.\n     *\n     * On succesful handling:\n     *    - updates call state to add new remote tracks,\n     *    - emits a \"tracks added\" event\n     *\n     * On failure to handle, ...?:\n     *    - updates call state ...?,\n     *\n     * @param {Object} call The call being acted on.\n     * @param {Object} params\n     * @param {Object} params.sdp The remote offer SDP.\n     * @param {string} params.remoteNumber\n     * @param {string} params.remoteName\n     * @param {Object} stageData\n     * @param {Object} stageData.answer The remote offer SDP.\n     * @param {Object} stageData.session\n     * @param {Object} stageData.opInfo\n     * @param {Object} stageData.opInfo.mediaDesc\n     * @param {Object} stageData.opInfo.remoteDesc\n     * @throws {Error} Throws when the operation fails.\n     * @return {Promise<undefined>}\n     */\n    signalling: async (call, params, stageData) => {\n      try {\n        // Signal those changes to the remote call session.\n        const { remoteTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.remoteAddMediaFinish(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            // Include the affected tracks as part of the action so the call's\n            //    state can be updated accordingly.\n            remoteTracks\n          })\n        )\n\n        // New remote tracks have become available.\n        emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n          callId: call.id,\n          trackIds: remoteTracks\n        })\n      } catch (error) {\n        // TODO: Does this action update any state? Is it needed?\n        context.dispatch(\n          actions.remoteAddMediaFinish(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * Local changes stage for the remote 'add media' operation.\n *\n * Processes the remote offer SDP\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber\n * @param {string} params.remoteName\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDesc\n * @param {Object} opInfo.remoteDesc\n * @throws {Error} Throws when WebRTC negotiation fails.\n * @return {Promise<Object>} Data for subsequent stages.\n */\nexport async function localChanges(container, call, params, opInfo) {\n  const { WebRTC, CallstackWebrtc, CallstackSDP, logManager } = container\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /*\n   * The remote operation is offering media, so if the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  const mediaState = getMediaState(call)\n  if ([CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    params.sdp = setMediaInactive(params.sdp)\n    if (!params.sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n    // Update the `mediaDiff` after we modified the SDP.\n    opInfo.mediaDiff = CallstackSDP.compareMedia(opInfo.remoteDesc.sdp, params.sdp, true)\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n\n  // Data needed for further stages of the operation.\n  return {\n    answer,\n    session,\n    opInfo\n  }\n}\n\n/**\n * Signalling stage for the remote 'add media' operation.\n *\n * Responds to the remote operation with an answer SDP.\n * @method signalling\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.answer The remote offer SDP.\n * @param {Object} params.session\n * @param {Object} params.opInfo\n * @param {Object} params.opInfo.mediaDesc\n * @param {Object} params.opInfo.remoteDesc\n * @throws {Error} Throws when Gateway signaling fails.\n * @return {Promise<Object>} Tracks affected by the operation.\n */\nexport async function signalling(container, call, params) {\n  const { CallRequests, logManager } = container\n  const { answer, session, opInfo } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished responding to remote update. Changing state based on the remote operation.')\n\n    // Get the list of remote tracks that were added by the remote operation.\n    //    This is done after `handleOffer` so the Transceivers are up-to-date\n    //    with the changes being offered.\n    const remoteTracks = await getAffectedRemoteTracks(OPERATIONS.ADD_MEDIA, opInfo.mediaDiff, session)\n\n    return { remoteTracks }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","// Other plugins.\nimport BasicError from '../../../../../errors'\n\n// Libraries\nimport { isEmpty, isUndefined } from 'lodash/fp'\n\n/**\n * Bottle wrapper for \"rollback AddMedia\" operation.\n * @return {Function}\n */\nexport default function rollbackAddMediaOperation(container) {\n  const { logManager, WebRTC } = container\n\n  /**\n   * Performs the webRTC session functions associated rolling back the local portion\n   *  of an \"Add Media\" offer\n   *\n   * Responsibilities:\n   *  1. Remove and cleanup the tracks added to the peer\n   *  2. Rollback the local description SDP offer\n   * @method rollbackLocalAddMedia\n   * @param {string} sessionId    The local webRTC session id, used to lookup the session object\n   * @param {Object} operationData Meta-data relating to the on-going operation.\n   * @param {Array<string>} operationData.tracks The list track IDs that were added as part of the operation.\n   * @return {Object} offer object containing a Session Description Protocol\n   */\n  async function rollbackAddMedia(sessionId, operationData) {\n    const log = logManager.getLogger('CALLSTACK')\n    const session = await WebRTC.sessionManager.get(sessionId)\n    const { tracks } = operationData\n\n    if (!session) {\n      const message = `WebRTC session ${sessionId} not found.`\n      log.debug(message)\n      throw new BasicError({ message })\n    }\n\n    // Get the tracks that we want to remove\n    const localTracksToRemove = await WebRTC.track.getTracks(tracks)\n    // Get the indexes of undefined tracks.\n    const invalidIndexes = localTracksToRemove.reduce((acc, cur, ind) => {\n      return isUndefined(cur) ? acc.concat(ind) : acc\n    }, [])\n    // Get the track IDs of those indexes.\n    const invalidTracks = invalidIndexes.map(ind => tracks[ind])\n    if (!isEmpty(invalidTracks)) {\n      const message = `The following tracks could not be found for rollback: ${invalidTracks.join(', ')}`\n      log.debug(message)\n    }\n\n    // Removes tracks from peer (Will stop tracks from being sent to remote participant).\n    // Does NOT end the tracks.\n    await session.removeTracks(tracks)\n\n    // Ends the tracks.\n    // Clean-up the local tracks.\n    await Promise.all(localTracksToRemove.map(track => track.stop()))\n\n    // Rollback the local offer\n    let offer\n    try {\n      offer = await session.rollbackLocalDescription()\n    } catch (error) {\n      log.debug('Failed to rollback local description offer SDP:', error)\n      throw error\n    }\n\n    return { offer }\n  }\n\n  return rollbackAddMedia\n}\n","// Call plugin\nimport { getCallByWebrtcSessionId, getOptions } from '../../../../interface/selectors'\nimport { OPERATIONS } from '../../../../interface/constants'\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../reporter/constants'\n\n// Utils\nimport { getTrackDscpMapping } from '../../../utils/call'\nimport { organizeTracks } from '../../../utils/media'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"webrtc AddMedia\" operation.\n * @return {Function}\n */\nexport default function webrtcAddMediaOperation(container) {\n  const { context, CallstackSDP, CallReporter, WebRTC } = container\n\n  /**\n   * Performs the webRTC responsibilities for adding media\n   *\n   * @param  {Object} mediaConstraints Video and audio media constraints\n   * @param  {boolean} mediaConstraints.audio Whether to enable audio or not\n   * @param  {boolean} mediaConstraints.video Whether to enable video or not\n   * @param  {Array<Object>} [mediaConstraints.medias] List of medias containing tracks to be attached to this call.\n   * @param  {Object} sessionOptions\n   * @param  {string} sessionOptions.sessionId the local webrtc session id\n   * @param  {Object} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n   * @param  {Object} [sessionOptions.dscpControls] Contains configuration details for track network priorities\n   * @return {Object} Object\n   * @return {string} Object.sdp An offer in the form of a Session Description Protocol\n   * @return {Object} Object.media media object containing tracks\n   */\n  async function webrtcAddMedia(mediaConstraints, sessionOptions) {\n    const { CallstackWebrtc } = container\n\n    const { sessionId, bandwidth, dscpControls } = sessionOptions\n    const call = getCallByWebrtcSessionId(context.getState(), sessionId)\n    const callId = call.id\n\n    const callReport = CallReporter.getReport(callId)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && [OPERATIONS.ADD_MEDIA, OPERATIONS.ADD_BASIC_MEDIA].includes(op.type)\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n\n    let medias = []\n    // If detached media is passed in, use that.\n    if (mediaConstraints.medias) {\n      for (const media of mediaConstraints.medias) {\n        medias.push({\n          type: media.type,\n          media: await WebRTC.media.get(media.media.id)\n        })\n      }\n    }\n\n    const createdMedias = await CallstackWebrtc.createLocal(mediaConstraints, callId)\n    medias = medias.concat(createdMedias)\n\n    const session = await WebRTC.sessionManager.get(sessionId)\n\n    const trackLists = await organizeTracks(medias)\n    const dscpTrackMapping = getTrackDscpMapping(trackLists, dscpControls)\n\n    // Add all of the tracks to the Session.\n    // TODO: Error handling.\n    await session.addTracks(trackLists.all, dscpTrackMapping)\n\n    /*\n     * Create the local SDP offer, run it through any provided SDP handlers,\n     *    then set it as the Session's local description.\n     */\n    // TODO: Make sure the session is in the correct signaling state to start a\n    //    renegotiation operation.\n    const callConfigOptions = getOptions(context.getState())\n    const setLocalDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n    setLocalDescriptionEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.ADD_MEDIA)\n    let newSdp\n    try {\n      let offer = await session.createOffer()\n      // This is the \"pre set local\" stage.\n      offer.sdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, offer.sdp, {\n        callId,\n        type: offer.type,\n        step: 'set',\n        endpoint: 'local',\n        bandwidth\n      })\n\n      offer = await session.setLocalDescription(offer)\n\n      // This is the \"pre send local\" stage.\n      // Assign it to a new variable because some browsers enforce the read-only\n      //    properties of a RTCSessionDescription object. The object from\n      //    setLocalDescription is enforced read-only, but the `offer` before that\n      //    is not enforced.\n      newSdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, offer.sdp, {\n        callId,\n        type: offer.type,\n        step: 'send',\n        endpoint: 'local',\n        bandwidth\n      })\n    } catch (setLocalError) {\n      const error = new BasicError({\n        message: setLocalError.message,\n        code: callCodes.GENERIC_ERROR\n      })\n\n      setLocalDescriptionEvent.setError(error)\n      setLocalDescriptionEvent.endEvent()\n      throw error\n    }\n\n    setLocalDescriptionEvent.endEvent()\n\n    let mediaStates = []\n\n    for (const eachMedia of medias) {\n      const mediaState = await eachMedia.media.getState()\n\n      mediaStates = [...mediaStates, mediaState]\n    }\n\n    return { medias: mediaStates, sdp: newSdp }\n  }\n\n  return webrtcAddMedia\n}\n","// Call Plugin\nimport { getCallById } from '../../../../interface/selectors'\n\n/**\n * Bottle wrapper for directTransfer call operation.\n * @return {Object}\n */\nexport default function createDirectTransfer(container) {\n  return {\n    // Define no-op `localChanges` stage that simply returns the parameters that `signalling` needs.\n    //    This is needed because of how the LocalNegotiation flow calls these stages with parameters.\n    localChanges: (callId, destination) => {\n      return { destination }\n    },\n    signalling: (callId, { destination }) => signalling(container, callId, destination)\n  }\n}\n\n/**\n * Signalling stage for a 'direct transfer' operation.\n *\n * Sends a REST request to the server to indicate the intention to transfer.\n * @method signalling\n * @param {Object} container\n * @param {string} callId\n * @param {string} destination\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws an error if the REST request fails.\n */\nexport async function signalling(container, callId, destination) {\n  const { context, CallRequests, logManager } = container\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Performing direct transfer on call.')\n\n  const currentCall = getCallById(context.getState(), callId)\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: currentCall.wrtcsSessionId,\n    address: destination,\n    id: callId\n  }\n\n  try {\n    await CallRequests.directTransferSession(callInfo)\n  } catch (responseError) {\n    log.info('Failed to direct transfer call.')\n    throw responseError\n  }\n\n  log.info('Finished local portion of direct transfer. Waiting on remote response.')\n}\n","// Operations.\nimport createLocalStages from './directTransfer'\nimport validate from './validate'\nimport remoteSuccess from './remoteSuccess'\nimport remoteFailure from './remoteFailure'\n\nimport createFlow from '../../../callManager/flows/DirectTransfer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  const localStages = createLocalStages(bottle.container)\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.directTransfer', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a LocalDirectTransfer operation.\n     * @method LocalDirectTransfer\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local direct transfer operation.\n     */\n    function LocalDirectTransfer(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.DIRECT_TRANSFER,\n          isLocal: true,\n          // Operation methods.\n          stages: {\n            validate,\n            localOffer: localStages.localChanges,\n            signalling: localStages.signalling,\n\n            remoteSuccess: remoteSuccess(bottle.container),\n            remoteFailure: remoteFailure(bottle.container)\n          },\n          createFlow\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalDirectTransfer\n    }\n  })\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\nimport * as eventTypes from '../../../../interface/eventTypes'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\nexport default function createHandler(container) {\n  const { context, emitEvent, logManager } = container\n\n  /**\n   * A \"session failure\" notification has been received, indicating the operation failed.\n   *    Finish the operation.\n   *\n   * @method remoteFailure\n   * @param {Object} call The primary call for the operation.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @return {BasicError}\n   */\n  return function remoteFailure(call, params) {\n    const reasonText = params.reasonText || COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_FAILURE\n    const statusCode = params.statusCode || STATUS_CODES.DIRECT_TRANSFER_FAILURE\n\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received call operation failed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    log.debug(`Processing as a local direct transfer failure (${statusCode}).`)\n    log.info('Finished handling call operation failed notice.')\n\n    const error = new BasicError({\n      message: `Direct transfer operation failed: ${reasonText} (${statusCode})`,\n      code: callCodes.GENERIC_ERROR\n    })\n\n    context.dispatch(\n      callActions.directTransferFinish(call.id, {\n        error,\n        transition: { reasonText, statusCode }\n      })\n    )\n\n    // Notify the app that there has been a call state change\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: true,\n        remoteHold: false\n      },\n      error\n    })\n\n    return error\n  }\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { CALL_STATE_CHANGE, CALL_TRACKS_REMOVED } from '../../../../interface/eventTypes'\n\nimport { CALL_STATES, COMPLEX_OPERATION_MESSAGES, STATUS_CODES } from '../../../../constants'\n\n// Helpers\nimport { generateEndParams } from '../../../utils/call'\n\nexport default function createHandler(container) {\n  const { context, CallRequests, CallstackWebrtc, emitEvent, logManager } = container\n\n  /**\n   * A \"session complete\" notification has been received, indicating the operation was\n   *    successful. Finish the operation by ending the call.\n   *\n   * @method consultativeSuccess\n   * @param {Object} call The call being operated on.\n   * @param {Object} params Parameters describing the incoming call.\n   * @param {string} [params.reasonText] Human-readable explanation for the call change.\n   * @param {string} [params.statusCode] Code representing the reason for the call change.\n   * @return {Promise<undefined>}\n   */\n  async function directSuccess(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Received session status completed notice; handling.', { wrtcsSessionId: call.wrtcsSessionId })\n\n    const { reasonText, statusCode } = params\n    if (reasonText) {\n      let customStatusCode\n      if (!statusCode && statusCode !== 0) {\n        customStatusCode = STATUS_CODES.DIRECT_TRANSFER_SUCCESS\n      } else {\n        customStatusCode = statusCode\n      }\n      log.debug(`Session completed notice caused by ${reasonText} (${customStatusCode}).`)\n    }\n\n    log.info(`Ending webRTC session with id: ${call.webrtcSessionId}, locally ...`)\n    // Close the local webRTC session\n    await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n    // Update call state to 'Ended'.\n    context.dispatch(\n      callActions.directTransferFinish(call.id, {\n        transition: {\n          reasonText: COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_SUCCESS,\n          statusCode: STATUS_CODES.DIRECT_TRANSFER_SUCCESS\n        }\n      })\n    )\n\n    try {\n      log.debug('Ending call session on server-side.')\n      await CallRequests.endSession({\n        callId: call.id,\n        wrtcsSessionId: call.wrtcsSessionId,\n        isAnonymous: call.isAnonymous,\n        account: call.account\n      })\n    } catch (error) {\n      // Ignore an error from the REST request. End the call locally no matter what.\n      log.debug(`Error received when attempting to end the session: ${error}.`)\n    } finally {\n      log.info(`Finished ending call. Changing call state to ${CALL_STATES.ENDED}.`)\n      // TODO: Is this action needed? The call should be 'Ended' by the above action.\n      context.dispatch(callActions.endCallFinish(call.id, generateEndParams(call.state, true, params)))\n\n      // Tell the application that no tracks are available any longer.\n      emitEvent(CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        }\n      })\n    }\n  }\n\n  return directSuccess\n}\n","// Call plugin\nimport { getCallById } from '../../../../interface/selectors'\n\n// Helpers.\nimport { CALL_STATES } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, destination) {\n  const call = getCallById(state, callId)\n  /*\n   * `directTransfer` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `On Hold` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Cannot direct transfer call: Invalid call ID.'\n    })\n  } else if (call.state !== CALL_STATES.ON_HOLD) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state: state=${call.state}. It should be: state=${CALL_STATES.ON_HOLD}.`\n    })\n  }\n}\n","// Operation.\nimport createRemoteStages from './remote/remoteOffer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.genericRemote', () => {\n    const remoteStages = createRemoteStages(bottle.container)\n\n    return {\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: remoteStages.localChanges,\n        signalling: remoteStages.signalling\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.genericRemote', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a RemoteGeneric operation.\n     * @method RemoteGeneric\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a remote generic operation.\n     */\n    function RemoteGeneric(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.GENERIC_REMOTE,\n          isLocal: false,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.genericRemote.remote\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      remote: RemoteGeneric\n    }\n  })\n}\n","import { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\nimport setMediaInactive from '../../../../sdp/utils/setMediaInactive'\nimport hasMediaFlowing from '../../../../sdp/utils/hasMediaFlowing'\n\nimport { isSameSdpSessionId } from '../../../../utils/webrtc'\nimport { getMediaState } from '../../../../../utils/state'\nimport { CALL_MEDIA_STATES } from '../../../../../constants'\n\nimport { callActions as actions } from '../../../../../interface/actions'\n\n/**\n * Operation for handling a new offer SDP in a generic way.\n * If this operation is used, it means we don't know what the remote operation\n *    is, so we can follow through with generic WebRTC negotiation without any\n *    added flair.\n *\n * The \"media restart\" operation will be handled as a generic remote (NO_CHANGE)\n *    operation. Other operations are negotiations that we don't understand\n *    (UNKNOWN or other types of NO_CHANGE).\n */\nexport default function createGenericHandler(container) {\n  const { context } = container\n\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    /**\n     * Signalling wrapper to handle state changes and events.\n     *\n     * On succesful handling:\n     *    - updates call state ...?\n     *\n     * On failure to handle, ...?:\n     *    - updates call state ...?,\n     *\n     * @method operation\n     * @param {Object} call The call being acted on.\n     * @param {Object} params\n     * @param {Object} params.sdp The remote offer SDP.\n     * @param {string} params.remoteNumber\n     * @param {string} params.remoteName\n     * @param {Object} opInfo\n     * @param {Object} opInfo.mediaDesc\n     * @param {Object} opInfo.remoteDesc\n     * @throws {Error} Throws when the operation fails.\n     * @return {Promise<undefined>}\n     */\n    signalling: async (call, params, stageData) => {\n      try {\n        // Signal those changes to the remote call session.\n        const { remoteTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.updateCall(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            remoteTracks\n          })\n        )\n\n        // TODO: If there were remote tracks added or removed, we need to emit an\n        //    event for that.\n      } catch (error) {\n        context.dispatch(\n          actions.updateCall(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * Local changes for the 'generic remote' operation.\n * Performs WebRTC changes to the local side of the call.\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber\n * @param {string} params.remoteName\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDesc\n * @param {Object} opInfo.remoteDesc\n * @throws {Error} Throws when Gateway signaling fails.\n * @return {Promise<Object>} Tracks affected by the operation.\n * @throws {Error} Throws when WebRTC negotiation fails.\n */\nexport async function localChanges(container, call, params, opInfo) {\n  const { WebRTC, CallstackWebrtc, CallstackSDP, logManager } = container\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /*\n   * If the remote operation is offering media but the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  const mediaState = getMediaState(call)\n  const isMediaFlowing = hasMediaFlowing(params.sdp)\n  if (isMediaFlowing && [CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    params.sdp = setMediaInactive(params.sdp)\n    if (!params.sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n    // Update the `mediaDiff` after we modified the SDP.\n    opInfo.mediaDiff = CallstackSDP.compareMedia(opInfo.remoteDesc.sdp, params.sdp, true)\n  }\n\n  /**\n   * Decision: When we receive a remote offer SDP that has a different \"session\n   *    ID\" as the currently set remote SDP, recreate the call's PeerConnection.\n   * This is a workaround/fix for scenarios where the remote endpoint changes.\n   *    It avoids possible DTLS role conflict issues.\n   */\n  const sameSession = await isSameSdpSessionId(WebRTC, call.webrtcSessionId, params.sdp)\n  if (!sameSession) {\n    log.debug(`Received offer SDP is from a different session. Recreating Peer for call ${call.id}.`)\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    await session.recreatePeer()\n  }\n\n  /**\n   * If the offer SDP has a DTLS role of active (which is invalid), change it to\n   *    actpass. This is a workaround for transfer scenarios where the offer SDP\n   *    is the remote endpoint's answer SDP from them answering the call. This\n   *    happens when slow-start is not done for the transfer.\n   */\n  if (params.sdp.includes('setup:active')) {\n    log.debug(`Received offer SDP with active role for call ${call.id}. Changing.`)\n    params.sdp = params.sdp.replace(/setup:active/g, 'setup:actpass')\n  }\n\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n\n  // Data for subsequent stages.\n  return {\n    answer,\n    sameSession,\n    session\n  }\n}\n\n/**\n * Signalling stage for the 'add media' operation.\n *\n * Sends a REST request to the server with the remote answer SDP.\n * @async\n * @method signalling\n * @param {Object} container\n * @param {Call} call The call being acted on.\n * @param {Object} params Data returned by the `localChanges` stage.\n * @param {Object} params.answer\n * @param {Object} params.sameSession\n * @param {Object} params.session\n * @return {Promise<Object>} Tracks affected by the operation.\n * @throws {Error} Throws when Gateway signaling fails.\n */\nexport async function signalling(container, call, params) {\n  const { CallRequests, logManager } = container\n  const { answer, sameSession, session } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    // Get the list of remote tracks that are changing (either added or removed) as\n    //    part of the remote operation. This is done after `handleOffer` so the\n    //    Transceivers are up-to-date with the changes being offered.\n    let remoteTracks = []\n    if (!sameSession) {\n      // If the PeerConnection was recreated, then ALL remote tracks will be new.\n      remoteTracks = await getAllRemoteTracks(session)\n    }\n\n    return { remoteTracks }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","// Operations.\nimport createLocalStages from './local/hold'\nimport validate from './local/validate'\nimport rollbackOperation from './rollbackHold'\nimport remoteAnswer from './local/remoteAnswer'\n\nimport createRemoteStages from './remote/remoteOffer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  const localStages = createLocalStages(bottle.container)\n  const remoteStages = createRemoteStages(bottle.container)\n\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.hold', () => {\n    return {\n      local: {\n        // Stages of local operation.\n        validate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container),\n        rollback: rollbackOperation(bottle.container)\n      },\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: remoteStages.localChanges,\n        signalling: remoteStages.signalling\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.hold', () => {\n    const Callstack = bottle.container.Callstack\n    const negFactory = Callstack.models.Negotiation\n\n    function hold(isLocal) {\n      /**\n       * Factory function for a Hold operation.\n       * @method hold\n       * @param {string} callId ID for the call this operation will affect.\n       * @return {Operation} An instance of the hold operation.\n       */\n      return callId => {\n        const stages = Callstack.stages.hold[isLocal ? 'local' : 'remote']\n        return negFactory.instance(\n          {\n            // Operation meta-data.\n            type: OPERATIONS.HOLD,\n            isLocal,\n            // Operation methods.\n            stages\n          },\n          {\n            callId\n          }\n        )\n      }\n    }\n\n    return {\n      local: hold(true),\n      remote: hold(false)\n    }\n  })\n\n  bottle.factory('Callstack.utils.rollbackHold', () => rollbackOperation(bottle.container))\n}\n","// Call plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Libraries\nimport { getBrowserDetails } from 'kandy-webrtc'\n\n/**\n * Updates an existing call to have inactive media.\n * Can be used as a \"hold\" operation for plain webRTC scenarios.\n *\n * This function defines how a call is put \"on hold\". It performs the webRTC and\n *    signaling operations to update the local and server sessions of a call.\n *    This represents the start of the webRTC renegotiation process for the\n *    local side.\n * @return {Object}\n */\nexport default function createHold(container) {\n  return {\n    localChanges: callId => localChanges(container, callId),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * Local changes for the 'hold' operation.\n *\n * Performs WebRTC changes to the local side of the call.\n * @async\n * @method localChanges\n * @param {Object} container\n * @param {Object}   callId The ID of the call.\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nexport async function localChanges(container, callId) {\n  const { context, CallstackWebrtc, logManager } = container\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Holding call.')\n\n  const targetCall = getCallById(context.getState(), callId)\n  // TODO: Make sure the session is in the correct signaling state to start a\n  //    renegotiation operation.\n  let offer\n  try {\n    offer = await CallstackWebrtc.generateOffer(\n      targetCall.webrtcSessionId,\n      {\n        audio: 'inactive',\n        video: 'inactive'\n      },\n      targetCall.bandwidth\n    )\n  } catch (generateOfferError) {\n    log.debug('Failed to generate SDP offer')\n    throw generateOfferError\n  }\n\n  return {\n    offer\n  }\n}\n\n/**\n * Signalling stage for the 'hold' operation.\n *\n * Sends a REST request to the server with the local offer SDP.\n * @async\n * @method signalling\n * @param {Object} container\n * @param {string} callId The ID of the call being acted on.\n * @param {Object} params Data returned by the `localChanges` stage.\n * @param {Object} params.offer The local offer SDP generated by the `localChanges` stage.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws an error if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, CallRequests, Callstack, CallstackWebrtc, logManager } = container\n  const { offer } = params\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    await CallRequests.updateSession({\n      wrtcsSessionId: call.wrtcsSessionId,\n      id: call.id,\n      offer: offer.sdp,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n  } catch (responseError) {\n    log.info('Failed to hold call.')\n    // Rollback is not supported on safari or for a plan other than unified-plan\n    let rollbackErr\n    try {\n      await Callstack.utils.rollbackHold(call.webrtcSessionId)\n    } catch (rollbackError) {\n      log.debug('Automatic hold rollback failed:', rollbackError)\n      rollbackErr = rollbackError\n    }\n\n    // There is a \"browser issue\" with Chrome where the remote track is removed from the call when the local description\n    //  offer is set. This track is not recovered during rollback so call remains in an awkward state.\n    //  See comments on PR-3224.\n    const browser = getBrowserDetails().browser\n    if (rollbackErr || browser === 'chrome') {\n      // Although Safari can automatically rollback and set another local offer while in `have-local-offer`\n      //  signalling state, Safari does not perform an automatic rollback when a remote offer is\n      //  received while in that state. An InvalidStateError is thrown instead and call is in an awkward state.\n      if (browser === 'safari' || browser === 'chrome') {\n        log.info('Ending call due to unrecoverable state after call hold failure.')\n        // Hangup the call from WebRTC perspective\n        await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n        // Cleanup Redux state by sending END_CALL_FINISH action\n        context.dispatch(\n          callActions.endCallFinish(call.id, {\n            isLocal: true,\n            transition: { reasonText: 'Call has ended due to call hold failure.' }\n          })\n        )\n\n        throw responseError\n      }\n      log.info('Unable to reset state after hold operation failure, future operations may not work as intended.')\n    }\n\n    throw responseError\n  }\n  log.info('Finished local portion of holding call. Waiting on remote response.')\n}\n","// Callstack.\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../../reporter/constants'\n\nexport default function createHoldResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started hold operation.\n   *\n   * On succesful handling:\n   *    - updates call state to \"on hold\",\n   *    - emits a \"tracks removed\" event\n   *    - emits a \"call state change\" event.\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"tracks removed\" event\n   *    - emits a \"call state change\" event.\n   *\n   * @method holdResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function holdResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.HOLD\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    processResponseEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.HOLD)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      // Tell the application that local tracks are not available, since the\n      //    call is ending in error.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    /*\n     * Update call state:\n     *    - state change to \"on hold\",\n     *    - tracks affected by operation removed.\n     */\n    context.dispatch(\n      callActions.holdCallFinish(call.id, {\n        ...operation.operationData,\n        // For a hold operation, all tracks currently on the call are affected.\n        localTracks: call.localTracks,\n        remoteTracks: call.remoteTracks\n      })\n    )\n\n    // Tell the application that tracks have been removed.\n    emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n      callId: call.id,\n      trackIds: [...call.localTracks, ...call.remoteTracks]\n    })\n\n    // Tell the application that call state has changed.\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: call.localHold,\n        remoteHold: call.remoteHold\n      }\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return holdResponse\n}\n","// Call plugin\nimport { getCallById } from '../../../../../interface/selectors'\n\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `hold` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be not be held locally.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.localHold !== false) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: 'Call is in an invalid state: localHold=true. It should be: localHold=false.'\n    })\n  }\n}\n","// Callstack.\nimport { isSameSdpSessionId } from '../../../../utils/webrtc'\nimport getAffectedRemoteTracks, { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\n\nimport { callActions as actions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nexport default function createRemoteHold(container) {\n  const { context, emitEvent } = container\n\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    /**\n     * Signalling wrapper to handle state changes and events.\n     *\n     * On succesful handling:\n     *    - updates call state to add \"remote hold\" flag,\n     *    - emits a \"tracks removed\" event\n     *    - emits a \"call state change\" event.\n     *\n     * On failure to handle, ...?:\n     *    - updates call state ...?,\n     *    - emits a \"call state change\" error event.\n     *\n     * @param {Object} call The call being acted on.\n     * @param {Object} params\n     * @param {Object} params.sdp The remote offer SDP.\n     * @param {string} params.remoteNumber The display number of the remote endpoint.\n     * @param {string} params.remoteName The display name of the remote endpoint.\n     * @param {Object} stageData\n     * @param {Object} stageData.answer\n     * @param {Object} stageData.sameSession\n     * @param {Object} stageData.session\n     * @param {Object} stageData.opInfo\n     * @param {Object} stageData.opInfo.mediaDiff\n     * @return {Promise<undefined>}\n     */\n    signalling: async (call, params, stageData) => {\n      try {\n        const { localTracks, remoteTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.remoteHoldFinish(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            // Include the affected tracks as part of the action so the call's\n            //    state can be updated accordingly.\n            localTracks,\n            remoteTracks\n          })\n        )\n\n        // The call has changed to a new state.\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId: call.id,\n          previous: {\n            state: call.state,\n            localHold: call.localHold,\n            remoteHold: call.remoteHold\n          }\n        })\n\n        // All local and remote tracks have become unavailable.\n        emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n          callId: call.id,\n          trackIds: [...localTracks, ...remoteTracks]\n        })\n      } catch (error) {\n        // TODO: Does this action update any state? Is it needed?\n        context.dispatch(\n          actions.remoteHoldFinish(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId: call.id,\n          previous: {\n            state: call.state,\n            localHold: call.localHold,\n            remoteHold: call.remoteHold\n          },\n          error\n        })\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {Object} call\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber\n * @param {string} params.remoteName\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDiff\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nasync function localChanges(container, call, params, opInfo) {\n  const { WebRTC, CallstackWebrtc, logManager } = container\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /**\n   * Decision: When we receive a remote offer SDP that has a different \"session\n   *    ID\" as the currently set remote SDP, recreate the call's PeerConnection.\n   * This is a workaround/fix for scenarios where the remote endpoint changes.\n   *    It avoids possible DTLS role conflict issues.\n   */\n  // TODO: Verify that this is needed for remote hold operations.\n  const sameSession = await isSameSdpSessionId(WebRTC, call.webrtcSessionId, params.sdp)\n  if (!sameSession) {\n    log.debug(`Received offer SDP is from a different session. Recreating Peer for call ${call.id}.`)\n    await session.recreatePeer()\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n\n  return {\n    answer,\n    sameSession,\n    session,\n    opInfo\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call\n * @param {Object} params\n * @param {Object} params.answer\n * @param {Object} params.sameSession\n * @param {Object} params.session\n * @param {Object} params.opInfo\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nasync function signalling(container, call, params) {\n  const { CallRequests, logManager } = container\n  const { answer, sameSession, session, opInfo } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished responding to remote update. Changing state based on the remote operation.')\n\n    // Get the list of remote tracks that are changing (either added or removed) as\n    //    part of the remote operation. This is done after `handleOffer` so the\n    //    Transceivers are up-to-date with the changes being offered.\n    let remoteTracks = []\n    if (!sameSession) {\n      // If the PeerConnection was recreated, then ALL remote tracks will be new.\n      remoteTracks = await getAllRemoteTracks(session)\n    } else {\n      remoteTracks = await getAffectedRemoteTracks(OPERATIONS.HOLD, opInfo.mediaDiff, session)\n    }\n\n    // On remote hold, all local tracks become unavailable.\n    const affectedLocalTracks = call.localTracks\n\n    return {\n      remoteTracks,\n      localTracks: affectedLocalTracks\n    }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","// Call plugin.\nimport { getCallByWebrtcSessionId } from '../../../../interface/selectors'\nimport { callActions as actions } from '../../../../interface/actions'\nimport * as eventTypes from '../../../../interface/eventTypes'\nimport { OPERATIONS, OP_TRANSITIONS } from '../../../../interface/constants'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n//Libraries\nimport { getBrowserDetails } from 'kandy-webrtc'\n\n/**\n * Bottle wrapper for \"rollback hold\" operation.\n * @return {Function}\n */\nexport default function rollbackHoldOperation(container) {\n  const { logManager, WebRTC, CallstackWebrtc, emitEvent, context } = container\n\n  /**\n   * Performs the webRTC session functions associated rolling back the local portion\n   *  of a \"hold\" (inactive media) offer\n   *\n   * Responsibilities:\n   *  1. Revert the direction of the local and remote transceivers to \"sendrecv\"\n   *  2. Rollback the local description SDP offer\n   * @method rollbackHold\n   * @param {string} sessionId the local webRTC session id, used to lookup the session object\n   * @return {Object} offer object containing a Session Description Protocol\n   */\n  async function rollbackHold(sessionId) {\n    const log = logManager.getLogger('CALLSTACK')\n    const session = await WebRTC.sessionManager.get(sessionId)\n\n    if (!session) {\n      const message = `WebRTC session ${sessionId} not found.`\n      throw new BasicError({ message })\n    }\n\n    try {\n      await session.setTransceiversDirection({\n        audio: 'sendrecv',\n        video: 'sendrecv'\n      })\n    } catch (error) {\n      // TODO: Handle this potential error\n      // log.debug('Failed to restore local/remote tranceiver directions for audio/video:', error)\n      // throw error\n    }\n\n    // Rollback the local offer\n    let offer\n    let rollbackErr\n    try {\n      offer = await session.rollbackLocalDescription()\n    } catch (error) {\n      log.debug('Failed to rollback local description offer SDP:', error)\n      rollbackErr = error\n    }\n\n    const browser = getBrowserDetails().browser\n    // For HOLD Operation, there is a \"browser issue\" with Chrome where the remote track is removed from the call when the local description\n    //  offer is set. This track is not recovered during rollback so call remains in an awkward state.\n    //  See comments on PR-3224.\n    if (rollbackErr || browser === 'chrome') {\n      await handleRollbackFailure(sessionId, browser)\n    }\n\n    if (rollbackErr) {\n      throw rollbackErr\n    }\n    return { offer }\n  }\n\n  async function handleRollbackFailure(sessionId, browser) {\n    const call = getCallByWebrtcSessionId(context.getState(), sessionId)\n    const log = logManager.getLogger('CALL', call.id)\n\n    // Although Safari can automatically rollback and set another local offer while in `have-local-offer`\n    //  signalling state, Safari does not perform an automatic rollback when a remote offer is\n    //  received while in that state. An InvalidStateError is thrown instead and call is in an awkward state.\n    if (browser === 'safari' || browser === 'chrome') {\n      log.info('Ending call due to unrecoverable state after call hold failure.')\n      // Hangup the call from WebRTC perspective\n      await CallstackWebrtc.closeCall(call.webrtcSessionId)\n      // Cleanup Redux state by sending END_CALL_FINISH action\n      const reasonText = 'Call has ended due to call hold failure.'\n      context.dispatch(\n        actions.endCallFinish(call.id, {\n          isLocal: true,\n          transition: { reasonText }\n        })\n      )\n\n      // 1- 'call operation' event\n      emitEvent(eventTypes.CALL_OPERATION, {\n        callId: call.id,\n        isLocal: true,\n        operation: OPERATIONS.END,\n        transition: OP_TRANSITIONS.FINISH,\n        previous: {},\n        error: undefined\n      })\n\n      // 2- 'call state change' event, which updates the state.\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        transition: {\n          reasonText\n        },\n        error: new BasicError({\n          message: reasonText,\n          code: callCodes.GENERIC_ERROR\n        })\n      })\n    }\n  }\n\n  return rollbackHold\n}\n","import createLocalStages from './local/iceRestart'\nimport validate from './local/validate'\n\nimport remoteAnswer from './local/remoteAnswer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  const localStages = createLocalStages(bottle.container)\n\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.iceRestart', () => {\n    return {\n      local: {\n        validate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.iceRestart', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a LocalIceRestart operation.\n     * @method LocalIceRestart\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local ICE restart operation.\n     */\n    function LocalIceRestart(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.MEDIA_RESTART,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.iceRestart.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalIceRestart\n      // TODO: KJS-1604. A remote ICE restart is currently handled as a \"generic\n      //    remote\" operation.\n    }\n  })\n}\n","// Call plugin\nimport { getCallById, getOptions } from '../../../../../interface/selectors'\nimport { getLocalTracks } from '../../../../utils/call'\n\n// Other plugins\nimport { getConnectionState } from '../../../../../../connectivity/interface/selectors'\nimport { waitForReconnect } from '../../../../../../connectivity/interface/utils'\nimport BasicError, { callCodes, subscriptionCodes } from '../../../../../../errors'\n\n// Utils\nimport { delay } from '../../../../../../common/utils'\n\n/**\n * Bottle wrapper for iceRestart call operation.\n * @return {Object}\n */\nexport default function createIceRestart(container) {\n  /**\n   * Updates an existing call with unchanged media to trigger an ICE restart and renegotiation.\n   *\n   * This operation defines how a call's media is restarted. It performs the webRTC and\n   *    signaling operations to update the local and server sessions of a call.\n   *    This represents the start of the webRTC renegotiation process for the\n   *    local side.\n   */\n  return {\n    localChanges: callId => localChanges(container, callId),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {string} callId\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nexport async function localChanges(container, callId) {\n  const { context, WebRTC, CallstackWebrtc, logManager } = container\n  const call = getCallById(context.getState(), callId)\n\n  // Get some call data.\n  const {\n    webrtcSessionId,\n    wrtcsSessionId,\n    bandwidth,\n    isAnonymous,\n    account,\n    localHold,\n    customParameters,\n    customBodies\n  } = call\n\n  const session = await WebRTC.sessionManager.get(webrtcSessionId)\n\n  const dtlsRole = await session.getDtlsRole()\n\n  // The passive side of the call should wait a short amount of time before restarting media connection\n  // to avoid a glare scenario where both sides of the call try to restart the media connection\n  // at the same time.\n  if (dtlsRole === 'passive') {\n    const { mediaConnectionRetryDelay } = getOptions(context.getState())\n\n    await delay(mediaConnectionRetryDelay)\n  }\n\n  const log = logManager.getLogger('CALL', callId)\n\n  // Tell the RTCPeerConnection to restart the ICE connection as part of the\n  //    next negotiation.\n  try {\n    await session.restartIce()\n  } catch (error) {\n    log.debug('Peer restartIce function not available. Restarting ICE with createOffer instead.')\n  }\n\n  // Before doing the negotiation for ICE Restart, make sure we have network.\n  // Hardcoding platform to `link` here since the auth plugin has been cleaned of any reference to platforms.\n  // This needs to be removed as part of the `connectivity` plugin cleanup when platform is removed there.\n  const platform = 'link'\n  const { connected: isConnected } = getConnectionState(context.getState(), platform)\n\n  if (!isConnected) {\n    log.debug('Websocket not connected; waiting for reconnect before performing media restart.')\n    const isConnected = await waitForReconnect(container)\n\n    if (!isConnected) {\n      log.info('Subscription lost; stopping media restart attempt.')\n\n      throw new BasicError({\n        code: subscriptionCodes.WS_CONNECTION_ERROR,\n        message: 'No subscription for operation.'\n      })\n    }\n  }\n\n  log.info('Performing call renegotiation to reconnect media connection.')\n\n  // Make sure we have the right media directions in the negotiation.\n  //    We don't want to accidentally unhold media while on local hold.\n  const mediaDirections = {\n    audio: localHold ? 'inactive' : 'sendrecv',\n    video: localHold ? 'inactive' : 'sendrecv'\n  }\n\n  // If we're not on hold nor sending any audio or video, change the media direction(s) to recvonly to\n  //  prevent the other side from getting empty tracks.\n  if (!localHold) {\n    const localTracks = getLocalTracks(context, callId)\n    mediaDirections.audio = localTracks.some(track => track.kind === 'audio') ? 'sendrecv' : 'recvonly'\n    mediaDirections.video = localTracks.some(track => track.kind === 'video') ? 'sendrecv' : 'recvonly'\n  }\n\n  const callInfo = {\n    wrtcsSessionId,\n    id: callId,\n    isAnonymous,\n    account,\n    customParameters,\n    customBodies\n  }\n\n  // Backwards compatibility - can remove after KJS-2044\n  const otherOptions = {\n    iceRestart: true\n  }\n\n  // Generate the offer\n  let offer\n  try {\n    offer = await CallstackWebrtc.generateOffer(webrtcSessionId, mediaDirections, bandwidth, otherOptions)\n    callInfo.offer = offer.sdp\n  } catch (err) {\n    log.debug('Failed to generate offer.')\n\n    throw new BasicError({\n      code: callCodes.INVALID_OFFER,\n      message: 'Failed to generate SDP offer'\n    })\n  }\n\n  return {\n    offer\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call\n * @param {Object} params\n * @param {Object} params.offer\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, CallRequests, logManager } = container\n  const { offer } = params\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  // Update the server\n  try {\n    await CallRequests.updateSession({\n      wrtcsSessionId: call.wrtcsSessionId,\n      id: call.id,\n      offer: offer.sdp,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished local portion of media restart. Waiting on remote response.')\n  } catch (error) {\n    log.info('Failed to renegotiate call.')\n    throw error\n  }\n}\n","// Callstack.\nimport { getMediaState } from '../../../../../utils/state'\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../../reporter/constants'\n\nexport default function createMediaRestartResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started media restart operation.\n   *\n   * On succesful handling:\n   *    - emits a \"media restart\" event\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"tracks removed\" event\n   *    - emits a \"call state change\" event.\n   *\n   * @method mediaRestartResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function mediaRestartResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Processing remote response from regular, local update request.')\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.MEDIA_RESTART\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    processResponseEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.MEDIA_RESTART)\n\n    const mediaState = getMediaState(call)\n    log.debug(`Current call info; State: ${call.state}, MediaState: ${mediaState}.`)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      // Tell the application that local tracks are not available, since the\n      //    call is ending in error.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    /*\n     * Dispatch action. Doesn't update state.\n     */\n    context.dispatch(callActions.restartMediaFinish(call.id))\n\n    // Tell the application that media has restarted.\n    emitEvent(eventTypes.MEDIA_RESTART, {\n      callId: call.id\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return mediaRestartResponse\n}\n","import { getCallById } from '../../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../../constants'\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `iceRestart` operation validation:\n   *    1. Call must exist.\n   *    2. Call must not be in `Ended` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state === CALL_STATES.ENDED) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Invalid call state: ${call.state}. It should be on-going.`\n    })\n  }\n}\n","// Local operation stages.\nimport createLocalStages from './local/make'\nimport remoteAnswer from './local/remoteAnswer'\nimport callRinging from '../../updates/sendRingingFeedback/remote/callStatusUpdateRinging'\nimport earlyMedia from './local/receiveEarlyMedia'\nimport validate from './local/validate'\n\n// Remote operation stages.\nimport createRemoteStages from './remote/incomingCall'\n\nimport createIncoming from '../../../callManager/flows/RemoteCall'\nimport createNeg from '../../../callManager/flows/LocalNegotiation'\nimport { createPending } from '../../../callManager/flows/RemoteUpdate'\n\n// Helpers\nimport setupIncomingCall from './setupIncomingCall'\nimport setupOutgoingSession from './setupOutgoingSession'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  const localMakeStages = createLocalStages(bottle.container)\n\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.make', () => {\n    return {\n      local: {\n        validate,\n        localOffer: localMakeStages.localChanges,\n        signalling: localMakeStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container),\n        // Remote updates while operation is pending.\n        callStatusUpdateRinging: callRinging(bottle.container),\n        receiveEarlyMedia: earlyMedia(bottle.container)\n      },\n      remote: {\n        remoteOffer: createRemoteStages(bottle.container)\n      }\n    }\n  })\n\n  // Register the Operation as a whole entity.\n  bottle.factory('Callstack.operations.make', () => {\n    const Callstack = bottle.container.Callstack\n    const negFactory = Callstack.models.Negotiation\n    const updateFactory = Callstack.models.Update\n\n    /**\n     * Factory function for a LocalMake operation.\n     * @method LocalMake\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local make operation.\n     */\n    function LocalMake(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.MAKE,\n          isLocal: true,\n          // Operation methods.\n          stages: Callstack.stages.make.local,\n          /*\n           * The `make` operation is a special-case negotiation. The \"main\" operation\n           *    follow the negotiation flow, but it can also receive updates while in PENDING\n           *    state. Merge together the two flows to create the `make` flow.\n           */\n          createFlow: (...params) => {\n            return {\n              ...createNeg(...params),\n              receiveUpdate: createPending(...params).start\n            }\n          }\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    function IncomingCall(callId) {\n      return updateFactory.instance(\n        {\n          type: OPERATIONS.MAKE,\n          isLocal: false,\n          stages: Callstack.stages.make.remote,\n          createFlow: createIncoming\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalMake,\n      remote: IncomingCall\n    }\n  })\n\n  bottle.factory('Callstack.utils.setupIncomingCall', () => setupIncomingCall(bottle.container))\n  bottle.factory('Callstack.utils.setupOutgoingSession', () => setupOutgoingSession(bottle.container))\n}\n","// Call plugin.\nimport { callActions } from '../../../../../interface/actions'\nimport { CALL_TRACKS_ADDED } from '../../../../../interface/eventTypes'\nimport { getOptions, getTurnInfo } from '../../../../../interface/selectors'\nimport { checkBandwidthControls } from '../../../../utils/call'\nimport { CALL_STATES } from '../../../../../constants'\n\n// Other plugins.\nimport { getSessionById } from '../../../../../../webrtc/interface/selectors'\n\n/**\n * Bottle wrapper for the local portion of the make operation.\n * @return {Object}\n */\nexport default function createMake(container) {\n  /**\n   * Callstack operation to start a new outgoing call.\n   *\n   * To start a new call, it requires:\n   *    - User media,\n   *    - A local PeerConnection, setup with the media and local offer, and\n   *    - To start the call on the server, providing the local offer.\n   */\n  return {\n    localChanges: (callId, participants, media, options = {}) =>\n      localChanges(container, callId, participants, media, options),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {string} callId\n * @param {Object} participants\n * @param {Object} media\n * @param {Object} [options={}]\n * @return {Promise<Object>} Resolves with data needed for the signalling step.\n * @throws {BasicError} Throws an error if the WebRTC session fails to set up.\n */\nexport async function localChanges(container, callId, participants, media, options = {}) {\n  const { context, Callstack, logManager } = container\n  const { setupOutgoingSession } = Callstack.utils\n\n  const log = logManager.getLogger('CALL', callId)\n\n  log.info('Initiating new outgoing call.')\n  // Get info from state for the operation.\n  const turnInfo = getTurnInfo(context.getState())\n  const callOptions = getOptions(context.getState())\n\n  // Verify input parameter(s).\n  // TODO: Validation of application-input should happen in the API.\n  const bandwidth = checkBandwidthControls(options.bandwidth)\n\n  let callInfo\n  try {\n    // Compile all of the info needed for the WebRTC operation.\n    const webrtcInfo = {\n      defaultPeerConfig: callOptions.defaultPeerConfig,\n      turnInfo,\n      bandwidth,\n      dscpControls: options.dscpControls,\n      callId,\n      // ICE related.\n      trickleIceMode: callOptions.trickleIceMode, // ??? Remove.\n      removeBundling: callOptions.removeBundling\n    }\n\n    /*\n     * Setup local WebRTC resources needed for the call. This includes user media\n     *    and a local PeerConnection.\n     *\n     * Expected return format:\n     * @type {Object}\n     * @param {string} sessionId The ID of the Session object associated with this call.\n     * @param {Array<string>} mediaIds List of Media objects associated with this call.\n     * @param {string} offerSdp The local offer SDP generated during Session setup.\n     */\n    callInfo = await setupOutgoingSession(media, webrtcInfo)\n  } catch (err) {\n    log.info(`Failed to initiate call. Changing to ${CALL_STATES.ENDED}.`)\n    // Rethrow the error so it gets to the API.\n    throw err\n  }\n\n  return {\n    participants,\n    callInfo,\n    options,\n    bandwidth\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {string} callId\n * @param {Object} params\n * @param {Object} params.participants\n * @param {Object} params.callInfo\n * @param {Object} params.options\n * @param {Object} params.bandwidth\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws an error if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, CallRequests, CallstackWebrtc, emitEvent, logManager } = container\n  const { participants, callInfo, options, bandwidth } = params\n\n  const log = logManager.getLogger('CALL', callId)\n  let wrtcsSessionId\n  try {\n    // Info required for the server to create the session.\n    const sessionInfo = {\n      id: callId,\n      to: participants.to,\n      offer: callInfo.offerSdp,\n      // For anonymous calls.\n      isAnonymous: options.isAnonymous,\n      account: options.account,\n      from: participants.from\n    }\n    // Info to augment the server session, but not required.\n    const sessionOptions = {\n      displayName: options.displayName ? options.displayName : '',\n      customParameters: options.customParameters,\n      customBodies: options.customBodies\n    }\n\n    /*\n     * Create the call on the server.\n     *\n     * Expected return format:\n     * @param {string} wrtcsSessionId The ID that the server uses to identify this call.\n     */\n    wrtcsSessionId = await CallRequests.createSession(sessionInfo, sessionOptions)\n  } catch (err) {\n    /*\n     * The call failed being created on the server. Clean up the local WebRTC resources\n     *    and finish the operation by updating state and emitting the \"state change\" error event.\n     */\n    log.info('Failed to initiate call. Ending call and cleaning up WebRTC portions.')\n\n    // TODO: Update redux state that the Media object is stopped.\n    //    Need an event from Media model to notify about the stop, and listener\n    //    set on Media when it is created (in `createLocalMedia` saga).\n    await CallstackWebrtc.closeCall(callInfo.sessionId)\n\n    // Rethrow the error to the API.\n    throw err\n  }\n\n  /*\n   * The call was succesfully created on the server. Finish the local side of\n   *    the operation by updating state and emitting the \"state change\" event.\n   */\n  log.info(`Finished initiating call. Changing to ${CALL_STATES.INITIATED} and waiting on remote answer.`)\n\n  // Get the list of all local tracks on the Session. Add the local tracks\n  //    to call state now so they are available while the call rings.\n  const sessionState = getSessionById(context.getState(), callInfo.sessionId)\n  context.dispatch(\n    callActions.pendingMakeCall(callId, {\n      // The ID that the backend uses to track this webRTC session.\n      wrtcsSessionId: wrtcsSessionId,\n      // The ID that the webRTC stack uses to track this webRTC session.\n      webrtcSessionId: callInfo.sessionId,\n      // The local Media object associated with this call.\n      mediaIds: callInfo.mediaIds,\n      // The bandwidth of the call.\n      bandwidth,\n      // The custom display name to use. Not supported on all environments.\n      displayName: options.displayName,\n      // The custom parameters (headers) and custom bodies of the call\n      customParameters: options.customParameters,\n      customBodies: options.customBodies,\n      localTracks: sessionState.localTracks,\n      // The current state of the call\n      // TODO: Normally, call state should not be part of action because\n      //       whoever checks this action payload, should obtain the call state from\n      //       Redux state, using a selector.\n      //       So further changes are needed in 'callAudit' middleware\n      state: CALL_STATES.INITIATED\n    })\n  )\n\n  // Tell the application that local tracks are available on the call now.\n  emitEvent(CALL_TRACKS_ADDED, {\n    callId,\n    trackIds: sessionState.localTracks\n  })\n}\n","// Call Plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { getOptions, getCallByWrtcsSessionId } from '../../../../../interface/selectors'\nimport { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\nimport { CALL_STATE_CHANGE, CALL_TRACKS_ADDED, CUSTOM_PARAMETERS } from '../../../../../interface/eventTypes'\nimport { CALL_STATES } from '../../../../../constants'\n\n/**\n * Bottle wrapper for \"receive early media\" notification handler.\n * @return {Function}\n */\nexport default function receiveEarlyMediaOperation(container) {\n  const { context, emitEvent, logManager, WebRTC, CallstackSDP } = container\n\n  /**\n   * A \"session progress\" notification has been received. It contains an \"early\n   *    media\" SDP (pranswer) that needs to be processed.\n   *\n   * Processing a pranswer is done by:\n   *    1. Validating the Call / Session.\n   *    2. Running the SDP through the SDP pipeline.\n   *    3. Setting the SDP as the Session's remote description (as pranswer).\n   *    4. Updating the Call state.\n   *\n   * @method receiveEarlyMedia\n   * @param {Object} params       Parameters describing the notification.\n   */\n  async function receiveEarlyMedia(wrtcsSessionId, params) {\n    const { customParameters } = params\n\n    /**\n     * Get the call from state.\n     */\n    const currentCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n\n    const log = logManager.getLogger('CALL', (currentCall || {}).id)\n    log.info('Received early media notice; handling.', { wrtcsSessionId })\n\n    if (!currentCall) {\n      log.info('Early media notice for unknown wrtcsSession. Ignoring.', { wrtcsSessionId })\n      return\n    }\n\n    /**\n     * Get the Webrtc Session.\n     */\n    const session = await WebRTC.sessionManager.get(currentCall.webrtcSessionId)\n\n    if (!session) {\n      log.info('Early media notice for missing wrtcsSession. Ignoring.', { wrtcsSessionId })\n      // TODO: Better error.\n      return\n    }\n    // Dispatch a custom parameters received action/event if any custom parameters were received as part of the notification\n    if (customParameters) {\n      const customNames = customParameters.map(param => param.name)\n      log.debug(`Received custom parameters as part of the Call: ${customNames}.`)\n      context.dispatch(\n        callActions.customParametersReceived(currentCall.id, {\n          customParameters\n        })\n      )\n\n      // Emit the associated event with the above action\n      emitEvent(CUSTOM_PARAMETERS, { callId: currentCall.id, customParameters })\n    }\n\n    try {\n      /*\n       * Run the remote SDP pranswer through any SDP handlers provided, then set it\n       *    as the Session's remote description.\n       * This is the \"pre set remote\" stage.\n       */\n      const callConfigOptions = getOptions(context.getState())\n      const sdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, params.sdp, {\n        callId: currentCall.id,\n        type: 'pranswer',\n        step: 'set',\n        endpoint: 'remote'\n      })\n      await session.processAnswer({\n        type: 'pranswer',\n        sdp: sdp\n      })\n    } catch (err) {\n      log.debug(`Failed to process pranswer for Call ${currentCall.id}; ignoring.`)\n      throw err\n    }\n\n    // Get the list of all remote tracks being offered in this call. This is a\n    //    new call, so this should be the full list of remote tracks available.\n    const remoteTracks = await getAllRemoteTracks(session)\n\n    log.info(`Finished handling early media notice. Changing to ${CALL_STATES.EARLY_MEDIA}.`)\n    context.dispatch(\n      callActions.sessionProgress(currentCall.id, {\n        // Remote participant's information.\n        remoteParticipant: {\n          displayNumber: params.remoteNumber,\n          displayName: params.remoteName\n        },\n        remoteTracks\n      })\n    )\n\n    // Tell the application that tracks are available on the call now.\n    emitEvent(CALL_TRACKS_ADDED, {\n      callId: currentCall.id,\n      trackIds: remoteTracks\n    })\n\n    emitEvent(CALL_STATE_CHANGE, {\n      callId: currentCall.id,\n      previous: {\n        state: currentCall.state,\n        localHold: currentCall.localHold,\n        remoteHold: currentCall.remoteHold\n      }\n    })\n  }\n\n  return receiveEarlyMedia\n}\n","// Callstack.\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\nimport { CALL_STATES } from '../../../../../constants'\nimport { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\n\nimport { REPORT_EVENTS } from '../../../../reporter/constants'\n\nexport default function createMakeResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter, WebRTC } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started make operation.\n   *\n   * On succesful handling:\n   *    - updates call state to \"connected\",\n   *    - emits a \"tracks added\" event\n   *    - emits a \"call state change\" event.\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"tracks removed\" event\n   *    - emits a \"call state change\" event.\n   *\n   * @method makeResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function makeResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      // This response can be for either MAKE or JOIN operations.\n      return op.isLocal && [OPERATIONS.MAKE, OPERATIONS.MAKE_ANONYMOUS, OPERATIONS.JOIN].includes(op.type)\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    processResponseEvent.addData('operation', OPERATIONS.MAKE)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      // Tell the application that local tracks are not available, since the\n      //    call is ending in error.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    // Get the list of all remote tracks being offered in this call. This is a\n    //    new call, so this should be the full list of remote tracks available.\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    const remoteTracks = await getAllRemoteTracks(session)\n\n    /*\n     * Update call state:\n     *    - state change to \"connected\",\n     *    - remote tracks added to call\n     */\n    context.dispatch(\n      callActions.makeCallFinish(call.id, {\n        state: CALL_STATES.CONNECTED,\n        // TODO: Make sure this is the correct units\n        startTime: Date.now(),\n        // Remote participant's information.\n        remoteParticipant: {\n          displayNumber: params.remoteNumber,\n          displayName: params.remoteName\n        },\n        // Add the remote tracks to the call state.\n        remoteTracks\n        // Local tracks have already been added on \"pending make call\".\n      })\n    )\n\n    // Tell the application that tracks have been added.\n    emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n      callId: call.id,\n      trackIds: remoteTracks\n    })\n\n    // Tell the application that call state has changed.\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: call.localHold,\n        remoteHold: call.remoteHold\n      }\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return makeResponse\n}\n","// Call plugin\nimport { getCallById } from '../../../../../interface/selectors'\n\nimport { validateDetachedMedia, validateMediaConstraints, validateDestination } from '../../../../utils/utils'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The current state.\n * @param {string} callId The unique id representing the call instance being operated on.\n * @param {Object} participants The two participants in the call.\n * @param {string} participants.to The callee's address.\n * @param {string} participants.from The caller's address.\n * @param {Object} media The media being offered by the current answer operation.\n * @param {Object} options Any additional call-related options.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId, participants, media, options) {\n  const call = getCallById(state, callId)\n\n  // Validate destination\n  let error = validateDestination(call.to)\n\n  if (!error) {\n    // If no error so far, proceed to next validation\n    // Validate mediaConstraints\n    error = validateMediaConstraints(media)\n  }\n\n  if (!error) {\n    // If no error so far, proceed to next validation\n    // Validating detached media before attempting to start a call.\n    // This verifies that the detached media being provided is, detached, local\n    // and not already in use by a session.\n    if (media.medias) {\n      error = validateDetachedMedia(media.medias)\n    }\n  }\n  return error\n}\n","// Call plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { getOptions, getTurnInfo } from '../../../../../interface/selectors'\nimport { CALL_OPERATION, CALL_STATE_CHANGE } from '../../../../../interface/eventTypes'\nimport { OPERATIONS, OP_TRANSITIONS } from '../../../../../interface/constants'\nimport { CALL_STATES } from '../../../../../constants'\nimport { REPORT_EVENTS } from '../../../../reporter/constants'\n\n/**\n * Bottle wrapper for \"incoming call\" notification handler.\n * @return {Function}\n */\nexport default function createRemoteMake(container) {\n  /**\n   * A \"call incoming\" notification has been received and needs to be handled.\n   *\n   * This operation is intended to be the entry point for all \"call incoming\"\n   *    notifications. A \"call incoming\" notification is the initial offer to\n   *    establish a call with a remote endpoint. It represents the start of both\n   *    the call flow and webRTC negotiation process for the local side.\n   * Handling the notification will create a new call in state.\n   */\n  return async function incomingCall(wrtcsSessionId, params, channel) {\n    await localChanges(container, wrtcsSessionId, params, channel)\n    // No signalling step.\n  }\n}\n/**\n * @method localChanges\n * @param {string}   wrtcsSessionId ID that the server uses to identify the session.\n * @param {Object}   params        Parameters describing the incoming call.\n * @param {string}   [params.sdp]  The remote SDP offer included with the notification (if any).\n * @param {string}   params.remoteNumber   Number of the remote participant.\n * @param {string}   params.remoteName     Display name of the remote participant.\n * @param {string}   params.calleeNumber  Number of the intended call recipient\n */\nexport async function localChanges(container, wrtcsSessionId, params, channel) {\n  const { context, CallRequests, Callstack, emitEvent, CallReporter, logManager } = container\n  const { setupIncomingCall } = Callstack.utils\n\n  const { sdp, callId } = params\n  const callConfig = getOptions(context.getState())\n\n  // Get the call report for this call\n  const callReport = CallReporter.getReport(callId)\n\n  // Get the RECEIVE_CALL event from the report\n  const receiveCallEvent = callReport.findLastOngoingEvent(REPORT_EVENTS.RECEIVE_CALL)\n\n  const log = logManager.getLogger('CALL', callId)\n\n  /**\n   * An incoming call may or may not have an SDP offer associated with it.\n   * If it has an SDP, then it is a \"regular\" call scenario and can be handled\n   *    as a normal webRTC negotiation.\n   * If it has no SDP, then it is a \"slow start\" call scenario. In a slow start\n   *    scenario, the signaling server acts as a webRTC-middleman, requiring\n   *    both sides to provide it with offers and generating the answers itself.\n   */\n  if (sdp) {\n    // Regular call.\n    receiveCallEvent.addData('isSlowStart', false)\n    const turnInfo = getTurnInfo(context.getState())\n\n    // Since we have the remote offer SDP, we can setup a webRTC session.\n    try {\n      // TODO: The call report is missing a \"process remote media\" event as part of the RECEIVE_CALL event.\n      await setupIncomingCall({\n        offer: {\n          sdp,\n          type: 'offer'\n        },\n        trickleIceMode: callConfig.trickleIceMode,\n        defaultPeerConfig: callConfig.defaultPeerConfig,\n        turnInfo,\n        callId,\n        removeBundling: callConfig.removeBundling,\n        serverTurnCredentials: callConfig.serverTurnCredentials\n      })\n    } catch (error) {\n      // The reason we're wrapping the error in an object here is because the setupIncomingCall operation\n      // used to return an object with an error property. Now that we are throwing instead, we throw the\n      // BasicError directly, but our interface is expecting an object with an error property.\n      log.info(`Failed to initiate incoming call. Changing to ${CALL_STATES.ENDED}.`)\n      context.dispatch(\n        callActions.endCallFinish(callId, {\n          isLocal: true,\n          error: {\n            error\n          }\n        })\n      )\n\n      emitEvent(CALL_OPERATION, {\n        callId,\n        isLocal: true,\n        operation: OPERATIONS.END,\n        transition: OP_TRANSITIONS.FINISH,\n        error: {\n          error\n        }\n      })\n\n      emitEvent(CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: CALL_STATES.INITIATING,\n          localHold: false,\n          remoteHold: false\n        },\n        error: {\n          error\n        }\n      })\n\n      throw error\n    }\n  } else {\n    log.debug('Incoming call is a slow-start call.')\n    // Slow start call.\n    receiveCallEvent.addData('isSlowStart', true)\n\n    /*\n     * We can't setup a webRTC session yet because generating an offer requires\n     *   media constraints. We need to wait until the application provides\n     *   media information before we can setup the call.\n     */\n  }\n\n  // Next state will be Initiated normally, or Ringing if ringing feedback is sent.\n  let nextState = CALL_STATES.INITIATED\n\n  // If in 'auto' mode for `ringingFeedbackMode`, send the feedback immediately.\n  if (callConfig.ringingFeedbackMode === 'auto') {\n    log.info('Sending ringing feedback automatically for incoming call.')\n    const callInfo = { wrtcsSessionId, id: callId }\n    try {\n      await CallRequests.updateCallRinging(callInfo)\n      log.debug('Successfully sent ringing feedback.')\n      nextState = CALL_STATES.RINGING\n    } catch (error) {\n      log.info(`Failed to send ringing feedback - ${error.code}: ${error.message} `)\n    }\n  }\n\n  log.info(`Finished initiating incoming call. Changing to ${nextState} and waiting on local answer.`)\n  context.dispatch(\n    callActions.updateCall(callId, {\n      state: nextState\n    })\n  )\n\n  emitEvent(CALL_STATE_CHANGE, {\n    callId,\n    previous: {\n      state: CALL_STATES.INITIATING,\n      localHold: false,\n      remoteHold: false\n    }\n  })\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { getOptions } from '../../../../interface/selectors'\n\n// Helpers\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"setup incoming call\" operation.\n * @return {Function}\n */\nexport default function setupIncomingCallOperation(container) {\n  const { context, logManager, WebRTC, CallstackSDP } = container\n  /**\n   * Prepares the WebRTC portions of setting up an incoming call.\n   *\n   * @method setupIncomingCall\n   * @param  {Object} sessionOptions\n   * @param  {string} sessionOptions.callId the local call id.\n   * @param  {Object} sessionOptions.sdpSemantics semantics for the SDP to use. The only supported value is: `'unified-plan'`. It implies video and audio constraints.\n   * @param  {Object} sessionOptions.turnInfo TURN information, contains server info.\n   * @param  {string} sessionOptions.trickleIceMode the mode to enable for Trickle ICE.\n   * @param  {Object} sessionOptions.offer an offer containing an SDP.\n   * @throws {BasicError} Throws an error if the WebRTC operation fails.\n   * @return {string} sessionId an identifier for the session.\n   */\n  async function setupIncomingCall(sessionOptions) {\n    const { defaultPeerConfig, turnInfo, trickleIceMode, callId, removeBundling } = sessionOptions\n    const offer = sessionOptions.offer\n\n    const log = logManager.getLogger('CALL', callId)\n    log.info('Setting up remote WebRTC portions of call.')\n\n    let session\n    try {\n      let iceServers = defaultPeerConfig.iceServers\n      // Merge the ICE server information together with their credentials.\n      if (turnInfo) {\n        iceServers = iceServers.map(iceInfo => {\n          return {\n            ...iceInfo,\n            username: turnInfo.username,\n            credential: turnInfo.password\n          }\n        })\n      }\n\n      session = await WebRTC.sessionManager.create({\n        peer: {\n          rtcConfig: {\n            ...defaultPeerConfig,\n            iceServers\n          },\n          trickleIceMode,\n          removeBundling\n        }\n      })\n    } catch (error) {\n      log.debug('Failed to create WebRTC Session for incoming Call.', error.message)\n      const createSessionError = new BasicError({\n        message: error.message,\n        code: callCodes.GENERIC_ERROR\n      })\n\n      throw createSessionError\n    }\n\n    // Trigger a new action specifying that the session has been created\n    context.dispatch(\n      callActions.sessionCreated(callId, {\n        webrtcSessionId: session.id\n      })\n    )\n\n    /*\n     * Run the remote SDP offer through any SDP handlers provided, then set it\n     *    as the Session's remote description.\n     * This is the \"pre set remote\" stage.\n     */\n    const callConfigOptions = getOptions(context.getState())\n\n    offer.sdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, offer.sdp, {\n      callId,\n      type: offer.type,\n      step: 'set',\n      endpoint: 'remote'\n    })\n\n    await session.processOffer({\n      type: 'offer',\n      sdp: offer.sdp\n    })\n\n    log.info('Finished setting up remote WebRTC portions of call.')\n    return session.id\n  }\n\n  return setupIncomingCall\n}\n","// Call plugin.\nimport { callActions } from '../../../../interface/actions'\nimport { getCallById, getOptions } from '../../../../interface/selectors'\nimport { OP_STATUS } from '../../../../interface/constants'\n\n// Utils\nimport { organizeTracks } from '../../../utils/media'\nimport { getTrackDscpMapping } from '../../../utils/call'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\nimport { REPORT_EVENTS } from '../../../reporter/constants'\n\n/**\n * Bottle wrapper for \"setup outgoing session\" operation.\n * @return {Function}\n */\nexport default function setupOutgoingSessionOperation(container) {\n  const { context, logManager, CallReporter, CallstackSDP, WebRTC } = container\n\n  /**\n   * Performs the WebRTC portion necessary for establishing outgoing calls\n   *\n   * @method setupOutgoingSession\n   * @async\n   * @param {Object} mediaConstraints\n   * @param {Object|boolean} mediaConstraints.audio\n   * @param {Object|boolean} mediaConstraints.video\n   * @param {Object|boolean} mediaConstraints.screen\n   * @param {Object|Array<string>} mediaConstraints.tracks\n   * @param {Object} options\n   * @param {string} options.callId\n   * @param {Object} options.defaultPeerConfig\n   * @param {Object} options.turnInfo\n   * @param {call.BandwidthControls} options.bandwidth\n   * @param {call.DSCPControls} options.dscpControls\n   * @param {boolean} options.removeBundling\n   * @return {Object} callInfo\n   * @return {string} callInfo.sessionId\n   * @return {Arrray<string>} callInfo.mediaIds\n   * @return {string} callInfo.offerSdp\n   * @throws {BasicError} Throws a USER_MEDIA_ERROR error if cannot get user media.\n   * @throws {BasicError} Throws a GENERIC_ERROR error if cannot create webrtc Session.\n   * @throws {BasicError} Throws a TODO error if cannot add tracks to Session.\n   * @throws {BasicError} Throws a GENERIC_ERROR error if SDP handling fails.\n   */\n  async function setupOutgoingSession(mediaConstraints, options) {\n    const log = logManager.getLogger('CALL', options.callId)\n    log.info('Setting up local WebRTC portions of call.')\n\n    const call = getCallById(context.getState(), options.callId)\n    const callReport = CallReporter.getReport(call.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.status === OP_STATUS.ONGOING\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n\n    let medias = []\n    // If detached media is passed in, use that.\n    if (mediaConstraints.medias) {\n      for (const media of mediaConstraints.medias) {\n        medias.push({\n          type: media.type,\n          media: await WebRTC.media.get(media.media.id)\n        })\n      }\n    }\n\n    // If any further media is requested by the api but not detached, create it.\n    if (mediaConstraints.audio || mediaConstraints.video || mediaConstraints.screen) {\n      try {\n        /*\n         * Create local user media for the call.\n         * Expected return:\n         * @param {Array<Object>} medias List of objects.\n         * @param {Object} mediaObj\n         * @param {Media}  mediaObj.media The WebRTC-Stack Media object.\n         * @param {string} mediaObj.type The kind of media.\n         */\n        const createdMedias = await container.CallstackWebrtc.createLocal(mediaConstraints, options.callId)\n        medias = medias.concat(createdMedias)\n      } catch (err) {\n        log.debug('Failed to get media requested for the call.')\n        throw err\n      }\n    }\n\n    let session\n    try {\n      let iceServers = options.defaultPeerConfig.iceServers\n      // Merge the ICE server information together with their credentials.\n      if (options.turnInfo) {\n        iceServers = iceServers.map(iceInfo => {\n          return {\n            ...iceInfo,\n            username: options.turnInfo.username,\n            credential: options.turnInfo.password\n          }\n        })\n      }\n\n      // Create a WebRTC-Stack Session object.\n      session = await WebRTC.sessionManager.create({\n        peer: {\n          rtcConfig: {\n            ...options.defaultPeerConfig,\n            iceServers\n          },\n          // Follow-up / TODO: Remove `trickleIceMode` option; not used.\n          trickleIceMode: options.trickleIceMode,\n          removeBundling: options.removeBundling\n        }\n      })\n\n      log.debug('Created WebRTC Session for Call.', { webrtcSessionId: session.id })\n    } catch (err) {\n      log.debug('Failed to create WebRTC Session for Call.', err.message)\n      throw new BasicError({\n        message: err.message,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n\n    // Dispatch action to update state; linking the Call to the Session.\n    context.dispatch(\n      callActions.sessionCreated(options.callId, {\n        webrtcSessionId: session.id\n      })\n    )\n\n    const trackLists = await organizeTracks(medias)\n    const dscpTrackMapping = getTrackDscpMapping(trackLists, options.dscpControls)\n\n    // eslint-disable-next-line no-useless-catch\n    try {\n      // Add all of the tracks to the Session.\n      await session.addTracks(trackLists.all, dscpTrackMapping)\n    } catch (err) {\n      // Follow-up / TODO.\n      throw err\n    }\n\n    const callConfig = getOptions(context.getState())\n    let finalSdp\n\n    /*\n     * Create the local SDP offer, run it through any provided SDP handlers,\n     *    then set it as the Session's local description.\n     */\n    const setLocalDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n    setLocalDescriptionEvent.addData('operation', operation.type)\n    try {\n      let offer = await session.createOffer()\n      // Run the SDP through the Pipeline before we set it locally.\n      //    This is the \"pre set local\" stage.\n      offer.sdp = CallstackSDP.runPipeline(callConfig.sdpHandlers, offer.sdp, {\n        callId: options.callId,\n        type: offer.type,\n        step: 'set',\n        endpoint: 'local',\n        bandwidth: options.bandwidth\n      })\n\n      offer = await session.setLocalDescription(offer)\n\n      // Run the SDP through the Pipeline again before we send it to the remote side.\n      //    This is the \"pre send local\" stage.\n      finalSdp = CallstackSDP.runPipeline(callConfig.sdpHandlers, offer.sdp, {\n        callId: options.callId,\n        type: offer.type,\n        step: 'send',\n        endpoint: 'local',\n        bandwidth: options.bandwidth\n      })\n    } catch (err) {\n      log.debug('Failed to set local SDP.', err.message)\n      setLocalDescriptionEvent.setError(err)\n      setLocalDescriptionEvent.endEvent()\n      // Follow-up / TODO: Clean-up Media and Session resources.\n      throw new BasicError({\n        message: err.message,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n    setLocalDescriptionEvent.endEvent()\n\n    log.info('Finished setting up local WebRTC portions of call.')\n    return {\n      offerSdp: finalSdp,\n      sessionId: session.id,\n      mediaIds: medias.map(media => media.media.id)\n    }\n  }\n\n  return setupOutgoingSession\n}\n","// Operations.\nimport createStartStages from './remote/start'\nimport createStopStages from './remote/stop'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  const stages = createStartStages(bottle.container)\n\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.startMOH', () => {\n    return {\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: stages.localChanges,\n        signalling: stages.signalling\n      }\n    }\n  })\n\n  bottle.factory('Callstack.stages.stopMOH', () => {\n    const stages = createStopStages(bottle.container)\n\n    return {\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: stages.localChanges,\n        signalling: stages.signalling\n      }\n    }\n  })\n\n  // Remote-only \"start MOH\" operation.\n  bottle.factory('Callstack.operations.startMOH', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a RemoteStartMOH operation.\n     * @method RemoteStartMOH\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a remote start MOH operation.\n     */\n    function RemoteStartMOH(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.START_MOH,\n          isLocal: false,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.startMOH.remote\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      remote: RemoteStartMOH\n    }\n  })\n\n  // Remote-only \"stop MOH\" operation.\n  bottle.factory('Callstack.operations.stopMOH', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a RemoteStopMOH operation.\n     * @method RemoteStopMOH\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a remote stop MOH operation.\n     */\n    function RemoteStopMOH(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.STOP_MOH,\n          isLocal: false,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.stopMOH.remote\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      remote: RemoteStopMOH\n    }\n  })\n}\n","import { getMediaState } from '../../../../../utils/state'\nimport getAffectedRemoteTracks from '../../../../sdp/media/remoteTracks'\nimport hasMediaFlowing from '../../../../sdp/utils/hasMediaFlowing'\nimport setMediaInactive from '../../../../sdp/utils/setMediaInactive'\nimport { isSameSdpSessionId } from '../../../../utils/webrtc'\n\nimport { CALL_MEDIA_STATES } from '../../../../../constants'\n\nimport { callActions as actions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nexport default function createStartMoH(container) {\n  const { context, emitEvent } = container\n\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    signalling: async (call, params, stageData) => {\n      try {\n        const { remoteTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.remoteStartMohFinish(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            remoteTracks\n          })\n        )\n\n        // New remote tracks have become available.\n        emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n          callId: call.id,\n          trackIds: remoteTracks\n        })\n      } catch (error) {\n        context.dispatch(\n          actions.remoteStartMohFinish(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber\n * @param {string} params.remoteName\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDiff\n * @param {Object} opInfo.remoteDesc\n * @throws {Error} Throws if the WebRTC changes fail.\n * @return {Promise<Object>} Data needed for the signalling step.\n */\nexport async function localChanges(container, call, params, opInfo) {\n  const { CallstackWebrtc, CallstackSDP, WebRTC, logManager } = container\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /*\n   * If the remote operation is offering media but the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  const mediaState = getMediaState(call)\n  const isMediaFlowing = hasMediaFlowing(params.sdp)\n  if (isMediaFlowing && [CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    params.sdp = setMediaInactive(params.sdp)\n    if (!params.sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n    // Update the `mediaDiff` after we modified the SDP.\n    opInfo.mediaDiff = CallstackSDP.compareMedia(opInfo.remoteDesc.sdp, params.sdp, true)\n  }\n\n  /**\n   * Decision: When we receive a remote offer SDP that has a different \"session\n   *    ID\" as the currently set remote SDP, recreate the call's PeerConnection.\n   * This is a workaround/fix for scenarios where the remote endpoint changes.\n   *    It avoids possible DTLS role conflict issues.\n   */\n  const sameSession = await isSameSdpSessionId(WebRTC, call.webrtcSessionId, params.sdp)\n  if (!sameSession) {\n    log.debug(`Received offer SDP is from a different session. Recreating Peer for call ${call.id}.`)\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    await session.recreatePeer()\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n\n  return {\n    answer,\n    opInfo,\n    session\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.answer\n * @param {string} params.session\n * @param {Object} params.opInfo\n * @param {Object} params.opInfo.mediaDiff\n * @param {Object} params.opInfo.remoteDesc\n * @throws {Error} Throws if the REST request fails.\n * @return {Promise<Object>}\n */\nexport async function signalling(container, call, params) {\n  const { CallRequests, logManager } = container\n  const { answer, opInfo, session } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished responding to remote update. Changing state based on the remote operation.')\n\n    // Get the list of remote tracks that were added by the remote operation.\n    //    This is done after `handleOffer` so the Transceivers are up-to-date\n    //    with the changes being offered.\n    const remoteTracks = await getAffectedRemoteTracks(OPERATIONS.START_MOH, opInfo.mediaDiff, session)\n\n    return { remoteTracks }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","import { getMediaState } from '../../../../../utils/state'\nimport getAffectedRemoteTracks from '../../../../sdp/media/remoteTracks'\nimport hasMediaFlowing from '../../../../sdp/utils/hasMediaFlowing'\nimport setMediaInactive from '../../../../sdp/utils/setMediaInactive'\nimport { isSameSdpSessionId } from '../../../../utils/webrtc'\n\nimport { CALL_MEDIA_STATES } from '../../../../../constants'\n\nimport { callActions as actions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nexport default function createStopMoH(container) {\n  const { context, emitEvent } = container\n\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    signalling: async (call, params, stageData) => {\n      try {\n        const { remoteTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.remoteStopMohFinish(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            remoteTracks\n          })\n        )\n\n        // Existing remote tracks have become unavailable.\n        emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n          callId: call.id,\n          trackIds: remoteTracks\n        })\n      } catch (error) {\n        context.dispatch(\n          actions.remoteStopMohFinish(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber\n * @param {string} params.remoteName\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDiff\n * @param {Object} opInfo.remoteDesc\n * @throws {Error} Throws if the WebRTC changes fail.\n * @return {Promise<Object>} Data needed for the signalling step.\n */\nexport async function localChanges(container, call, params, opInfo) {\n  const { CallstackWebrtc, CallstackSDP, WebRTC, logManager } = container\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /*\n   * If the remote operation is offering media but the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  const mediaState = getMediaState(call)\n  const isMediaFlowing = hasMediaFlowing(params.sdp)\n  if (isMediaFlowing && [CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    params.sdp = setMediaInactive(params.sdp)\n    if (!params.sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n    // Update the `mediaDiff` after we modified the SDP.\n    opInfo.mediaDiff = CallstackSDP.compareMedia(opInfo.remoteDesc.sdp, params.sdp, true)\n  }\n\n  /**\n   * Decision: When we receive a remote offer SDP that has a different \"session\n   *    ID\" as the currently set remote SDP, recreate the call's PeerConnection.\n   * This is a workaround/fix for scenarios where the remote endpoint changes.\n   *    It avoids possible DTLS role conflict issues.\n   */\n  const sameSession = await isSameSdpSessionId(WebRTC, call.webrtcSessionId, params.sdp)\n  if (!sameSession) {\n    log.debug(`Received offer SDP is from a different session. Recreating Peer for call ${call.id}.`)\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    await session.recreatePeer()\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n  return {\n    answer,\n    session,\n    opInfo\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.answer\n * @param {string} params.session\n * @param {Object} params.opInfo\n * @param {Object} params.opInfo.mediaDiff\n * @param {Object} params.opInfo.remoteDesc\n * @throws {Error} Throws if the REST request fails.\n * @return {Promise<Object>}\n */\nexport async function signalling(container, call, params) {\n  const { CallRequests, logManager } = container\n  const { answer, opInfo, session } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished responding to remote update. Changing state based on the remote operation.')\n\n    // Get the list of remote tracks that were added by the remote operation.\n    //    This is done after `handleOffer` so the Transceivers are up-to-date\n    //    with the changes being offered.\n    const remoteTracks = await getAffectedRemoteTracks(OPERATIONS.STOP_MOH, opInfo.mediaDiff, session)\n\n    return { remoteTracks }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","// Operations.\nimport createLocalStages from './local/removeMedia'\nimport removeValidate from './local/validate'\n\nimport webrtcRemoveMediaOperation from './webrtcRemoveMedia'\nimport rollbackOperation from './rollbackRemoveMedia'\nimport basicValidate from './local/validateBasic'\n\nimport createRemoteStages from './remote/remoteOffer'\nimport remoteAnswer from './local/remoteAnswer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.removeMedia', () => {\n    const localStages = createLocalStages(bottle.container)\n    const remoteStages = createRemoteStages(bottle.container)\n\n    return {\n      local: {\n        // Stages of local operation.\n        validate: removeValidate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container),\n        rollback: rollbackOperation(bottle.container)\n      },\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: remoteStages.localChanges,\n        signalling: remoteStages.signalling\n      }\n    }\n  })\n\n  bottle.factory('Callstack.stages.removeBasicMedia', () => {\n    const localStages = createLocalStages(bottle.container)\n\n    return {\n      local: {\n        // Only the validate stage is different compared to LocalRemoveMedia.\n        validate: basicValidate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: remoteAnswer(bottle.container),\n        rollback: rollbackOperation(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.removeMedia', () => {\n    const Callstack = bottle.container.Callstack\n    const negFactory = Callstack.models.Negotiation\n\n    function removeMedia(isLocal) {\n      /**\n       * Factory function for a RemoveMedia operation.\n       * @method removeMedia\n       * @param {string} callId ID for the call this operation will affect.\n       * @return {Operation} An instance of the removeMedia operation.\n       */\n      return callId => {\n        const stages = Callstack.stages.removeMedia[isLocal ? 'local' : 'remote']\n        return negFactory.instance(\n          {\n            // Operation meta-data.\n            type: OPERATIONS.REMOVE_MEDIA,\n            isLocal,\n            // Operation methods.\n            stages\n          },\n          {\n            callId\n          }\n        )\n      }\n    }\n\n    return {\n      local: removeMedia(true),\n      remote: removeMedia(false)\n    }\n  })\n\n  bottle.factory('Callstack.operations.removeBasicMedia', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a LocalRemoveBasicMedia operation.\n     *    An \"remove basic media\" operation is identical to an \"remove media\" operation\n     *    except that it has stricter \"validate\" rules.\n     * @method LocalRemoveBasicMedia\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local basic removeMedia operation.\n     */\n    function LocalRemoveBasicMedia(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.REMOVE_BASIC_MEDIA,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.removeBasicMedia.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalRemoveBasicMedia\n      // Note: There is no remote RemoveBasicMedia operation. It's handled as a\n      //    remote RemoveMedia operation.\n    }\n  })\n\n  bottle.factory('Callstack.utils.webrtcRemoveMedia', () => webrtcRemoveMediaOperation(bottle.container))\n  bottle.factory('Callstack.utils.rollbackRemoveMedia', () => rollbackOperation(bottle.container))\n}\n","// Callstack.\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../../reporter/constants'\n\nexport default function createRemoveMediaResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started remove media operation.\n   *\n   * On succesful handling:\n   *    - updates call state to remove specified local tracks,\n   *    - emits a \"media removed\" event\n   *    - emits a \"tracks removed\" event\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"tracks removed\" event\n   *    - emits a \"call state change\" event.\n   *\n   * @method removeMediaResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function removeMediaResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      // This response can be for either regular or basic 'remove media' operations.\n      return op.isLocal && [OPERATIONS.REMOVE_MEDIA, OPERATIONS.REMOVE_BASIC_MEDIA].includes(op.type)\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    processResponseEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.REMOVE_MEDIA)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      // Tell the application that tracks are not available, since the\n      //    call is ending in error.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...call.localTracks, ...call.remoteTracks]\n      })\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    // Get the list of track IDs removed from the call by this operation.\n    const affectedLocalTracks = operation.operationData.tracks\n\n    // call:removedMedia event\n    emitEvent(eventTypes.CALL_REMOVED_MEDIA, {\n      callId: call.id,\n      local: true,\n      tracks: affectedLocalTracks\n    })\n\n    /*\n     * Update call state:\n     *    - remove tracks from the call.\n     */\n    context.dispatch(\n      callActions.removeMediaFinish(call.id, {\n        bandwidth: operation.operationData.bandwidth,\n        // For an remove media operation, the affected tracks are those that\n        //    where specified at the start of the operation.\n        localTracks: affectedLocalTracks\n      })\n    )\n\n    // Tell the application that tracks have been removed.\n    emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n      callId: call.id,\n      trackIds: affectedLocalTracks\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return removeMediaResponse\n}\n","// Call plugin\nimport { CALL_STATE_CHANGE } from '../../../../../interface/eventTypes'\nimport { callActions } from '../../../../../interface/actions'\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Libraries\nimport { getBrowserDetails } from 'kandy-webrtc'\n\n/**\n * Bottle wrapper for removeMedia call operation.\n * @return {Object}\n */\nexport default function createRemoveMedia(container) {\n  /**\n   * Removes media from an existing session.\n   *\n   * This function handles the WebRTC and signalling portions of removing media from an existing call\n   */\n  return {\n    // TechDebt TODO: Are `options` ever defined?\n    localChanges: (callId, tracks, options = {}) => localChanges(container, callId, tracks, options),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {string} callId The ID of the call.\n * @param {Array<string>}  tracks The list of track IDs to be removed.\n * @param {Object} options Extra options for the media.\n * @return {Promise<Object>} Data needed for the signalling step.\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nexport async function localChanges(container, callId, tracks, options) {\n  const { context, Callstack, logManager } = container\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Removing media from call.')\n\n  const { bandwidth } = options\n  const targetCall = getCallById(context.getState(), callId)\n\n  const { webrtcSessionId, bandwidth: callBandwidth } = targetCall\n\n  const finalBandwidth = {\n    audio: bandwidth && bandwidth.audio ? bandwidth.audio : callBandwidth.audio,\n    video: bandwidth && bandwidth.video ? bandwidth.video : callBandwidth.video\n  }\n\n  let sdp\n  try {\n    sdp = await Callstack.utils.webrtcRemoveMedia({\n      sessionId: webrtcSessionId,\n      tracks,\n      bandwidth: finalBandwidth\n    })\n  } catch (removeMediaError) {\n    log.info('Failed to remove media from call.')\n    throw removeMediaError\n  }\n\n  return {\n    operationData: {\n      local: true,\n      tracks,\n      bandwidth: finalBandwidth\n    },\n    sdp\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {string} callId\n * @param {Object} params Data from the localChanges step.\n * @param {Object} params.sdp\n * @param {Array<string>} params.tracks\n * @param {Object} params.finalBandwidth\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, CallRequests, Callstack, CallstackWebrtc, emitEvent, logManager } = container\n  const { sdp } = params\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  // Perform signalling to remove media\n  try {\n    await CallRequests.updateSession({\n      wrtcsSessionId: call.wrtcsSessionId,\n      id: call.id,\n      offer: sdp,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n  } catch (responseError) {\n    log.info('Failed to remove media from call.')\n    // Rollback is not supported on safari or for a plan other than unified-plan\n    try {\n      await Callstack.utils.rollbackRemoveMedia(call.webrtcSessionId)\n    } catch (rollbackError) {\n      log.debug('Automatic remove media rollback failed:', rollbackError)\n      const browser = getBrowserDetails().browser\n      // Although Safari can automatically rollback and set another local offer while in `have-local-offer`\n      // signalling state, Safari does not perform an automatic rollback when a remote offer is\n      // received while in that state. An InvalidStateError is thrown instead and call is in an awkward state.\n      if (browser === 'safari') {\n        log.info('Ending call due to unrecoverable state after call remove media failure.')\n        // Hangup the call from WebRTC perspective\n        await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n        // Cleanup Redux state by sending END_CALL_FINISH action\n        context.dispatch(\n          callActions.endCallFinish(call.id, {\n            isLocal: true,\n            transition: { reasonText: 'Call has ended due to call remove media failure.' }\n          })\n        )\n\n        emitEvent(CALL_STATE_CHANGE, {\n          callId: call.id,\n          previous: {\n            state: call.state,\n            localHold: call.localHold,\n            remoteHold: call.remoteHold\n          },\n          error: responseError\n        })\n        throw responseError\n      }\n      log.info(\n        'Unable to reset state after remove media operation failure, future operations may not work as intended.'\n      )\n    }\n\n    throw responseError\n  }\n\n  log.info('Finished local portion of removing media. Waiting on remote response.')\n}\n","import { CALL_STATES } from '../../../../../constants'\nimport { getCallById } from '../../../../../interface/selectors'\nimport { isArray, isEmpty } from 'lodash/fp'\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, tracks, options = {}) {\n  const call = getCallById(state, callId)\n  /*\n   * `removeMedia` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state !== CALL_STATES.CONNECTED) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Invalid call state: ${call.state}. It should be: ${CALL_STATES.CONNECTED}.`\n    })\n  } else if (!isArray(tracks) || isEmpty(tracks)) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Invalid parameter\"; no track IDs specified to remove.'\n    })\n  }\n}\n","import BasicError, { callCodes } from '../../../../../../errors'\nimport { CALL_STATES } from '../../../../../constants'\nimport { getCallById } from '../../../../../interface/selectors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validateBasic(state, callId, tracks) {\n  const call = getCallById(state, callId)\n\n  /*\n   * `removeMedia` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected` state.\n   * `removeBasicMedia` operation validation:\n   *    3. Call must not already have a track of `kind` media.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state !== CALL_STATES.CONNECTED) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Invalid call state: ${call.state}. It should be: ${CALL_STATES.CONNECTED}.`\n    })\n  } else if (tracks.length !== 1) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Must have only one track for basic scenario!'\n    })\n  }\n}\n","// Callstack.\nimport { getMediaState } from '../../../../../utils/state'\nimport getAffectedRemoteTracks from '../../../../sdp/media/remoteTracks'\nimport hasMediaFlowing from '../../../../sdp/utils/hasMediaFlowing'\nimport setMediaInactive from '../../../../sdp/utils/setMediaInactive'\nimport { CALL_MEDIA_STATES } from '../../../../../constants'\n\nimport { callActions as actions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\nexport default function createRemoteRemoveMedia(container) {\n  const { context, emitEvent } = container\n\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    signalling: async (call, params, stageData) => {\n      try {\n        const { remoteTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.remoteRemoveMediaFinish(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            // Include the affected tracks as part of the action so the call's\n            //    state can be updated accordingly.\n            localTracks: undefined,\n            remoteTracks\n          })\n        )\n\n        // Remote tracks have become unavailable.\n        emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n          callId: call.id,\n          trackIds: remoteTracks\n        })\n      } catch (error) {\n        // TODO: Does this action update any state? Is it needed?\n        context.dispatch(\n          actions.remoteRemoveMediaFinish(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber The display number of the remote endpoint.\n * @param {string} params.remoteName The display name of the remote endpoint.\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDiff\n * @throws {Error} Throws if the WebRTC changes fail.\n * @return {Promise<Object>} Data needed for the signalling step.\n */\nexport async function localChanges(container, call, params, opInfo) {\n  const { WebRTC, CallstackWebrtc, CallstackSDP, logManager } = container\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /*\n   * If the remote operation is offering media but the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  const mediaState = getMediaState(call)\n  const isMediaFlowing = hasMediaFlowing(params.sdp)\n  if (isMediaFlowing && [CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    params.sdp = setMediaInactive(params.sdp)\n    if (!params.sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n    // Update the `mediaDiff` after we modified the SDP.\n    opInfo.mediaDiff = CallstackSDP.compareMedia(opInfo.remoteDesc.sdp, params.sdp, true)\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n\n  return {\n    answer,\n    opInfo,\n    session\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.answer\n * @param {Object} params.session\n * @param {Object} params.opInfo\n * @param {Object} params.opInfo.mediaDiff\n * @throws {Error} Throws if the REST request fails.\n * @return {Promise<Object>} Data needed for state updates and events.\n */\nexport async function signalling(container, call, params) {\n  const { CallRequests, logManager } = container\n  const { answer, opInfo, session } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished responding to remote update. Changing state based on the remote operation.')\n\n    // Get the list of remote tracks that were removed by the remote operation.\n    //    This is done after `handleOffer` so the Transceivers are up-to-date\n    //    with the changes being offered.\n    const remoteTracks = await getAffectedRemoteTracks(OPERATIONS.REMOVE_MEDIA, opInfo.mediaDiff, session)\n\n    return { remoteTracks }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","// Other plugins.\nimport BasicError from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"rollback RemoveMedia\" operation.\n * @return {Function}\n */\nexport default function rollbackRemoveMediaOperation(container) {\n  const { logManager, WebRTC } = container\n\n  /**\n   * Performs the webRTC session functions associated rolling back the local portion\n   *  of a \"Remove Media\" offer.\n   *\n   * Unlike other rollback operations, for a remove media operation we will not try and re-add\n   *  the removed tracks since the application's intention was to stop the media.\n   *\n   * Responsibilities:\n   *  1. Rollback the local description SDP offer\n   * @method rollbackLocalRemoveMedia\n   * @param {Object} deps\n   * @param {Object} deps.webRTC  The WebRTC stack.\n   * @param {string} sessionId    The local webRTC session id, used to lookup the session object\n   * @return {Object} offer object containing a Session Description Protocol\n   */\n  async function rollbackRemoveMedia(sessionId) {\n    const log = logManager.getLogger('CALLSTACK')\n    const session = await WebRTC.sessionManager.get(sessionId)\n\n    if (!session) {\n      const message = `WebRTC session ${sessionId} not found.`\n      log.debug(message)\n      throw new BasicError({ message })\n    }\n\n    // Rollback the local offer\n    let offer\n    try {\n      offer = await session.rollbackLocalDescription()\n    } catch (error) {\n      log.debug('Failed to rollback local description offer SDP:', error)\n      throw error\n    }\n\n    return { offer }\n  }\n\n  return rollbackRemoveMedia\n}\n","// Call plugin\nimport { getCallByWebrtcSessionId, getOptions } from '../../../../interface/selectors'\nimport { OPERATIONS } from '../../../../interface/constants'\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../reporter/constants'\n\n// Libraries\nimport { isEmpty, isUndefined } from 'lodash/fp'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"webrtc RemoveMedia\" operation.\n * @return {Function}\n */\nexport default function webrtcRemoveMediaOperation(container) {\n  const { context, CallstackSDP, CallReporter, WebRTC } = container\n\n  /**\n   * Performs the webRTC responsibilities for removing media\n   *\n   * @param {Object} sessionOptions\n   * @param {string} sessionOptions.sessionId The local webrtc session id\n   * @param {Array}  sessionOptions.tracks A list of track IDs to remove\n   * @param {Object} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n   * @return {string} sdp An offer in the form of a Session Description Protocol\n   */\n  async function webrtcRemoveMedia(sessionOptions) {\n    const { sessionId, bandwidth, tracks } = sessionOptions\n\n    // Get the tracks that we want to remove\n    const localTracksToRemove = await WebRTC.track.getTracks(tracks)\n    // Get the indexes of undefined tracks.\n    const invalidIndexes = localTracksToRemove.reduce((acc, cur, ind) => {\n      return isUndefined(cur) ? acc.concat(ind) : acc\n    }, [])\n    // Get the track IDs of those indexes.\n    const invalidTracks = invalidIndexes.map(ind => tracks[ind])\n\n    if (!isEmpty(invalidTracks)) {\n      const message = `The following invalid track ids were provided: ${invalidTracks.join(', ')}`\n      throw new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message\n      })\n    }\n\n    const session = await WebRTC.sessionManager.get(sessionId)\n    const call = getCallByWebrtcSessionId(context.getState(), sessionId)\n    const callId = call.id\n\n    const callReport = CallReporter.getReport(callId)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && [OPERATIONS.REMOVE_MEDIA, OPERATIONS.REMOVE_BASIC_MEDIA].includes(op.type)\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n\n    // Removes tracks from peer (Will stop tracks from being sent to remote participant).\n    // Does NOT end the tracks.\n    await session.removeTracks(tracks)\n\n    // TODO: This should only cleanup the removed tracks, shouldn't it?\n    // Ends the tracks.\n    // Clean-up the local tracks.\n    try {\n      await Promise.all(localTracksToRemove.map(track => track.stop()))\n    } catch (error) {\n      // TODO: Throw a BasicError (using GENERIC_ERROR code) and abort (see the skipped unit test)\n    }\n\n    /*\n     * Create the local SDP offer, run it through any provided SDP handlers,\n     *    then set it as the Session's local description.\n     */\n    // TODO: Make sure the session is in the correct signaling state to start a\n    //    renegotiation operation.\n    const callConfigOptions = getOptions(context.getState())\n    const setLocalDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n    setLocalDescriptionEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.REMOVE_MEDIA)\n    let newSdp\n    try {\n      let offer = await session.createOffer()\n      // This is the \"pre set local\" stage.\n      offer.sdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, offer.sdp, {\n        callId,\n        type: offer.type,\n        step: 'set',\n        endpoint: 'local',\n        bandwidth\n      })\n\n      offer = await session.setLocalDescription(offer)\n\n      // This is the \"pre send local\" stage.\n      // Assign it to a new variable because some browsers enforce the read-only\n      //    properties of a RTCSessionDescription object. The object from\n      //    setLocalDescription is enforced read-only, but the `offer` before that\n      //    is not enforced.\n      newSdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, offer.sdp, {\n        callId,\n        type: offer.type,\n        step: 'send',\n        endpoint: 'local',\n        bandwidth\n      })\n    } catch (setLocalError) {\n      const error = new BasicError({\n        message: setLocalError.message,\n        code: callCodes.GENERIC_ERROR\n      })\n\n      setLocalDescriptionEvent.setError(error)\n      setLocalDescriptionEvent.endEvent()\n      throw error\n    }\n\n    setLocalDescriptionEvent.endEvent()\n    return newSdp\n  }\n\n  return webrtcRemoveMedia\n}\n","import { getMediaState } from '../../../../utils/state'\nimport hasMediaFlowing from '../../../sdp/utils/hasMediaFlowing'\nimport getAffectedRemoteTracks from '../../../sdp/media/remoteTracks'\nimport { CALL_STATES } from '../../../../constants'\n\n// Call plugin.\nimport { OPERATIONS } from '../../../../interface/constants'\nimport * as callActions from '../../../../interface/actions/call'\nimport * as actionTypes from '../../../../interface/actionTypes'\nimport * as eventTypes from '../../../../interface/eventTypes'\nimport { REPORT_EVENTS } from '../../../reporter/constants'\n\n// Other plugins.\nimport { getSessionById } from '../../../../../webrtc/interface/selectors'\n\n/**\n * Operation for the answer of a slow-start negotiation.\n *\n * A \"call update response\" has been received and needs to be handled.\n * The response is for a remote operation, so this a slow start webRTC scenario.\n *\n * This operation is intended to process all \"call update responses\", that are from\n *    remote operations, received from the call's remote side. This represents\n *    the end of slow start webRTC negotiation process for the local side.\n * Handling the response will affect the call's media, and the call state will\n *    be updated depending on the new media and the current call state.\n */\nexport default function createSlowStartFinish(container) {\n  return async function slowStartFinish(call, params) {\n    await localChanges(container, call, params)\n  }\n}\n\nexport async function localChanges(container, call, params) {\n  const { context, WebRTC, Callstack, CallstackSDP, CallstackWebrtc, emitEvent, logManager, CallReporter } = container\n\n  /**\n   * Helper function to get information about the operation.\n   * Mostly a wrapper around `getRemoteOperationInfo`.\n   *\n   * @method getOpInfo\n   * @param {Object} call\n   * @param {Object} params\n   * @param {Object} params.sdp\n   * @return {Object} opInfo\n   * @return {string} opInfo.remoteOp The type of operation.\n   * @return {MediaDiff} opInfo.mediaDiff\n   * @return {SDP} opInfo.remoteDesc The remote SDP.\n   */\n  async function getOpInfo(call, sdp) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    /*\n     * Determine what the remote operation was. The remote operation and our\n     *    current local state will affect how we update the call's state.\n     */\n    let { remoteOp, mediaDiff, remoteDesc } = await Callstack.utils.getRemoteOperationInfo(call, sdp)\n    const mediaState = getMediaState(call)\n    log.info(`Handling state change as remote ${remoteOp} in ${mediaState} scenario.`)\n\n    /*\n     * If the remote operation was an unhold and we're in a dual hold scenario,\n     *    then make sure the remote SDP can't restart media. Do this by ensuring\n     *    that all media directions in the remote SDP are inactive.\n     *\n     * This won't affect the remote end, but it prevents the local side from\n     *    thinking it is receiving a track when it shouldn't be.\n     *\n     * This can occur during slow start renegotiation, if the server doesn't\n     *    respect the media directions we set (assuming we set them correctly).\n     */\n    if (remoteOp === OPERATIONS.UNHOLD && call.localHold === true) {\n      const undesired = ['sendrecv', 'sendonly', 'recvonly']\n      // If any undesirable direction is found in the SDP, replace it with inactive.\n      if (undesired.some(dir => sdp.includes(dir))) {\n        log.debug('Modifying remote SDP to prevent media in local hold scenario.')\n        sdp = sdp.replace(/sendrecv|sendonly|recvonly/gi, 'inactive')\n        // Update the `mediaDiff` after we modified the SDP.\n        mediaDiff = CallstackSDP.compareMedia(remoteDesc.sdp, sdp, true)\n      }\n    }\n\n    return { remoteOp, mediaDiff, remoteDesc, sdp }\n  }\n\n  /**\n   * Function for handling the WebRTC negotiation and Gateway signaling aspects\n   *    of the operation. Processes the remote answer SDP.\n   *\n   * @method onSlowFinish\n   * @param {Call} call\n   * @param {SDP} sdp\n   * @return {Session} WebRTC-stack Session.\n   */\n  async function onSlowFinish(call, sdp) {\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Processing remote response from slow-start remote update request.')\n\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    if (!session) {\n      log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n      throw new Error(`Session for call ${call.id} not found.`)\n    }\n\n    const callReport = CallReporter.getReport(call.id)\n    const operation = call.currentOperations.find(op => {\n      // always look for remote side\n      return !op.isLocal && op.type === OPERATIONS.SLOW_START\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const setRemoteDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    setRemoteDescriptionEvent.addData('operation', operationEvent.type)\n    try {\n      await CallstackWebrtc.receivedAnswer({ sessionId: call.webrtcSessionId, answerSdp: sdp }, call)\n      setRemoteDescriptionEvent.endEvent()\n    } catch (error) {\n      log.debug('Failed to receive answer SDP', error)\n      setRemoteDescriptionEvent.endEvent(error)\n      // TODO: Dispatch an error action to notify of the error scenario.\n      // The call may now be in a bad state and needs to be fixed.\n      throw error\n    }\n\n    const mediaFlowing = hasMediaFlowing(sdp)\n    const nextState = mediaFlowing ? CALL_STATES.CONNECTED : CALL_STATES.ON_HOLD\n    log.info(`Finished processing remote slow-start response. Changing to ${nextState}.`)\n\n    return session\n  }\n\n  /*\n   * Function to handle the state changes and events related to a slow-start\n   *    operation. The slow-start operation could be any of the other operations,\n   *    so this is really just a copy/paste of how the other operations handle\n   *    their changes.\n   *\n   * TODO: Make use of other operation handling instead of duplicating the logic\n   *    here.\n   */\n  async function handleUpdates(call, params, opInfo, session) {\n    const { remoteOp, mediaDiff } = opInfo\n\n    // Get the list of remote tracks that are changing (either added or removed) as\n    //    part of the remote operation. This is done after `handleOffer` so the\n    //    Transceivers are up-to-date with the changes being offered.\n    const remoteTracks = await getAffectedRemoteTracks(remoteOp, mediaDiff, session)\n\n    let localTracks = []\n    // If we're not in dual-hold (ie. we will be entering or leaving ON_HOLD), then\n    //    local tracks will be affected\n    if (!call.localHold && [OPERATIONS.HOLD, OPERATIONS.UNHOLD].includes(remoteOp)) {\n      // For local tracks, just need to get the local tracks the Session has.\n      const sessionState = getSessionById(context.getState(), call.webrtcSessionId)\n      localTracks = sessionState.localTracks\n    }\n\n    const mediaFlowing = hasMediaFlowing(params.sdp)\n    const nextState = mediaFlowing ? CALL_STATES.CONNECTED : CALL_STATES.ON_HOLD\n\n    const actionCreator = getActionCreator(remoteOp)\n\n    context.dispatch(\n      actionCreator(call.id, {\n        state: nextState,\n        // Remote participant's information.\n        remoteParticipant: {\n          displayNumber: params.remoteNumber,\n          displayName: params.remoteName\n        },\n        // Add the remote tracks to the call state.\n        remoteTracks: remoteTracks,\n        localTracks: localTracks\n      })\n    )\n\n    if (OPERATIONS.HOLD === remoteOp) {\n      // The call has changed to a new state.\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        }\n      })\n\n      // All local and remote tracks have become unavailable.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: [...localTracks, ...remoteTracks]\n      })\n    } else if (OPERATIONS.UNHOLD === remoteOp) {\n      // The call has changed to a new state.\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        }\n      })\n\n      // The affected tracks are now available on the call.\n      emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n        callId: call.id,\n        trackIds: [...localTracks, ...remoteTracks]\n      })\n    } else if ([OPERATIONS.ADD_MEDIA, OPERATIONS.START_MOH].includes(remoteOp)) {\n      // New remote tracks have become available.\n      emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n        callId: call.id,\n        trackIds: remoteTracks\n      })\n    } else if ([OPERATIONS.REMOVE_MEDIA, OPERATIONS.STOP_MOH].includes(remoteOp)) {\n      // Remote tracks have become unavailable.\n      emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n        callId: call.id,\n        trackIds: remoteTracks\n      })\n    }\n  }\n\n  function getActionCreator(remoteOp) {\n    // Maps operations to actions.\n    const actionMap = {\n      [OPERATIONS.HOLD]: callActions.remoteHoldFinish,\n      [OPERATIONS.UNHOLD]: callActions.remoteUnholdFinish,\n      [OPERATIONS.ADD_MEDIA]: callActions.remoteAddMediaFinish,\n      [OPERATIONS.REMOVE_MEDIA]: callActions.remoteRemoveMediaFinish,\n      [OPERATIONS.START_MOH]: callActions.remoteStartMohFinish,\n      [OPERATIONS.STOP_MOH]: callActions.remoteStopMohFinish,\n      [OPERATIONS.SLOW_START]: callActions.remoteSlowStart\n    }\n\n    return function createAction(...params) {\n      const actionCreator = actionMap[remoteOp] || callActions.updateCall\n      const action = actionCreator(...params)\n\n      if (action.type === actionTypes.UPDATE_CALL) {\n        /*\n         * This is a hack. The proper solution would be to never use a generic action for state changes.\n         * This action doesn't work with the SDK's \"operation tracking\" logic in the call reducers, so\n         *     the call state becomes out-of-sync with the operations.\n         *  In this scenario, the operation start was a remote slow-start negotiation, but the SDK fails\n         *      to determine what the actual operation was, so it falls-back to using the generic action\n         *      for the \"finish\". This means that the remoteOp in state never gets cleaned-up, which can\n         *      cause issues later.\n         *  The workaround is to mark the action as a remote update action, so that the reducer can\n         *      manually clean-up the remote operation in this scenario.\n         * Reference: KJS-542, , KJS-571\n         */\n        action.meta = {\n          isRemote: true\n        }\n      }\n      return action\n    }\n  }\n\n  /*\n   * Now that we have the remote SDP, we can compare the previous SDP and the\n   *    new SDP to determine what the remote operation is.\n   */\n  const opInfo = await getOpInfo(call, params.sdp)\n\n  // Handle the remote answer SDP for the slow-start operation.\n  const session = await onSlowFinish(call, opInfo.sdp)\n\n  // Handle state changes and/or events to be emitted.\n  await handleUpdates(call, params, opInfo, session)\n}\n","// Operations.\nimport createStartStages from './start'\nimport remoteFinish from './finish'\n\nimport createLocal from '../../../callManager/flows/LocalNegotiation'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.slowStart', () => {\n    const startStages = createStartStages(bottle.container)\n\n    return {\n      remote: {\n        // Stages of remote operation.\n        localOffer: startStages.localChanges,\n        signalling: startStages.signalling,\n        remoteAnswer: remoteFinish(bottle.container)\n      }\n    }\n  })\n  // Remote-only \"slow start\" operation.\n  bottle.factory('Callstack.operations.slowStart', () => {\n    const negFactory = bottle.container.Callstack.models.Negotiation\n\n    /**\n     * Factory function for a RemoteSlowStart operation.\n     * @method RemoteSlowStart\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a remote hold operation.\n     */\n    function RemoteSlowStart(callId) {\n      return negFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.SLOW_START,\n          isLocal: false,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.slowStart.remote,\n          /*\n           * Special-case operation:\n           * Slow-start is a remote operation, but follows the local negotiation flow.\n           */\n          createFlow: (container, operation, stages) => {\n            const flow = createLocal(container, operation, stages)\n            return {\n              ...flow,\n              // Additionally, convert the `start` function parameters from the\n              //     \"remote negotiation\" to the \"local negotiation\" signature.\n              start: (call, opInfo, ...params) => {\n                return flow.start(call, params)\n              }\n            }\n          }\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      remote: RemoteSlowStart\n    }\n  })\n}\n","import { getMediaState } from '../../../../utils/state'\n\nimport { getOptions } from '../../../../interface/selectors'\nimport * as callActions from '../../../../interface/actions/call'\n\n/**\n * Operation for the \"offer\" of a slow-start negotiation.\n *\n * A \"call update request\" has been received and needs to be handled.\n * The request does not include an SDP, so this is a slow start webRTC scenario.\n *\n * This function is intended to process all \"call update requests\", that have no\n *    SDP, received from the call's remote side. It is assumed the call has\n *    already been established, so this represents the start of the slow start\n *    webRTC renegotiation process for the local side.\n * Handling the request will not affect the call's media at this point. As\n *    opposed to regular negotiation, we require an additional \"call response\"\n *    notification before negotiation is complete. Media and call state will\n *    only be affected by that response notification.\n */\nexport default function createStartSlowStart(container) {\n  /**\n   * Functions for handling the WebRTC negotiation and Gateway signaling aspects\n   *    of the operation. Creates a new offer SDP and sends it to the Gateway.\n   */\n  return {\n    localChanges: (call, params) => localChanges(container, call, params),\n    signalling: (call, params) => signalling(container, call, params)\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @return {Promise<Object>} Data needed for the signalling step.\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nexport async function localChanges(container, call, params) {\n  const { context, WebRTC, CallstackWebrtc, logManager } = container\n\n  const log = logManager.getLogger('CALL', call.id)\n  log.info('Processing slow-start update request from remote endpoint.')\n\n  const mediaState = getMediaState(call)\n  log.debug(`Current call info; State: ${call.state}, MediaState: ${mediaState}.`)\n\n  /**\n   * Decision: Whenever we receive a slow-start notification, recreate the Peer.\n   *    This is needed in certain situations (but not all...)\n   * Known Scenarios:\n   * 1. Direct transfer:\n   *    - The user being transferred will be on remote hold and will receive a\n   *        slow-start notification as part of the \"transfer renegotitions\".\n   *        Not recreating the Peer will result in a DTLS role conflict.\n   *    - The user receiving the transfer will negotiate the initial connection,\n   *        then will receive a slow-start notification (when Connected). Not\n   *        recreating the Peer for the slow-start results in DTLS conflict.\n   * Exception: If client has set the call option 'mediaBrokerOnly' to true, then\n   *    we don't need to recreate the call's PeerConnection.\n   */\n  const { mediaBrokerOnly } = getOptions(context.getState())\n  if (!mediaBrokerOnly) {\n    log.debug(`Recreating Peer for Session ${call.webrtcSessionId}.`)\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    await session.recreatePeer()\n  } else {\n    log.debug('Not recreating PeerConnection as mediaBrokerOnly is set to true in configuration.')\n  }\n\n  /*\n   * Decision: Whenever we receive an offer without an SDP (slow start), and\n   *    we're not locally held, respond with all media directions as sendrecv.\n   *    This is to signal what we are capable of, rather than what we want.\n   *    When we are locally held, we don't want to allow the remote side to\n   *    restart media, hence respond with media directions as inactive.\n   * This handles two (non-local hold) scenarios specifically:\n   *  1. Re-invite: We have already negotiated to perform the remote operation,\n   *      but we received a second offer (without an SDP) as a side-effect to\n   *      further update media.\n   *    Eg. Music on Hold: The remote operation is to set media to inactive,\n   *      and the re-invite updates media so we can receive the hold audio.\n   *  2. Slow start unhold: We receive an offer without an SDP, but we have no\n   *      idea what the remote operation was. If we are on remote hold, we\n   *      assume that it's a remote unhold operation.\n   */\n  const mediaDirections = {\n    audio: call.localHold ? 'inactive' : 'sendrecv',\n    video: call.localHold ? 'inactive' : 'sendrecv'\n  }\n\n  // Create an offer to use for responding to the slow start notification.\n  let slowOffer\n  try {\n    slowOffer = await CallstackWebrtc.generateOffer(call.webrtcSessionId, mediaDirections)\n  } catch (error) {\n    // TODO: Handle this scenario (revert operation if necessary).\n    log.info('Failed to respond to slow-start remote update.', error)\n    throw error\n  }\n\n  return {\n    slowOffer,\n    ...params\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.slowOffer\n * @param {Object} params.remoteNumber\n * @param {Object} params.remoteName\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, call, params) {\n  const { context, CallRequests, logManager } = container\n  const { slowOffer, remoteNumber, remoteName } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Respond with our \"offer\".\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: slowOffer.sdp,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    /*\n     * The operation is not complete until we receive a response to our offer. The\n     *    response will be handled by the `slowStart/finish` handler.\n     */\n    context.dispatch(\n      callActions.remoteSlowStart(call.id, {\n        remoteParticipant: {\n          displayNumber: remoteNumber,\n          displayName: remoteName\n        }\n      })\n    )\n\n    log.info('Finished responding to slow-start remote update. Waiting on remote response.')\n  } catch (error) {\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n\n    context.dispatch(\n      callActions.remoteSlowStart(call.id, {\n        remote: true,\n        error\n      })\n    )\n\n    log.info('Failed to respond to slow-start remote update.', error)\n    throw error\n  }\n}\n","// Operations.\nimport createLocalStages from './local/unhold'\nimport validate from './local/validate'\nimport rollbackOperation from './rollbackUnhold'\n\nimport createRemoteStages from './remote/remoteOffer'\nimport createRemoteAnswer from './local/remoteAnswer'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  const localStages = createLocalStages(bottle.container)\n  const remoteStages = createRemoteStages(bottle.container)\n\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.unhold', () => {\n    return {\n      local: {\n        // Stages of local operation.\n        validate,\n        localOffer: localStages.localChanges,\n        signalling: localStages.signalling,\n        remoteAnswer: createRemoteAnswer(bottle.container),\n        rollback: rollbackOperation(bottle.container)\n      },\n      remote: {\n        // Stages of remote operation.\n        remoteOffer: remoteStages.localChanges,\n        signalling: remoteStages.signalling\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.unhold', () => {\n    const Callstack = bottle.container.Callstack\n    const negFactory = Callstack.models.Negotiation\n\n    function unhold(isLocal) {\n      /**\n       * Factory function for a Hold operation.\n       * @method unhold\n       * @param {string} callId ID for the call this operation will affect.\n       * @return {Operation} An instance of the hold operation.\n       */\n      return callId => {\n        const stages = Callstack.stages.unhold[isLocal ? 'local' : 'remote']\n        return negFactory.instance(\n          {\n            // Operation meta-data.\n            type: OPERATIONS.UNHOLD,\n            isLocal,\n            // Operation methods.\n            stages\n          },\n          {\n            callId\n          }\n        )\n      }\n    }\n\n    return {\n      local: unhold(true),\n      remote: unhold(false)\n    }\n  })\n\n  bottle.factory('Callstack.utils.rollbackUnhold', () => rollbackOperation(bottle.container))\n}\n","// Callstack.\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\nimport { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\n\nimport { REPORT_EVENTS } from '../../../../reporter/constants'\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Other plugins.\nimport { getSessionById } from '../../../../../../webrtc/interface/selectors'\n\n// Libraries\nimport sdpTransform from 'sdp-transform'\n\nexport default function createUnholdResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter, WebRTC } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started unhold operation.\n   *\n   * On succesful handling:\n   *    - updates call state to remove \"local hold\" flag,\n   *    - emits a \"tracks added\" event\n   *    - emits a \"call state change\" event.\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"call state change\" event.\n   *\n   * @method unholdResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function unholdResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.UNHOLD\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    processResponseEvent.addData('operation', OPERATIONS.UNHOLD)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    /*\n     * Handle unexpected media directions after the operation.\n     *    ie. If we were on local-only hold, then unheld, the SDK assumes that\n     *      media is now flowing (`Connected` call state), but that may not be\n     *     the case.\n     *\n     *     Regular hold/unhold\n     *       media.direction == 'sendrecv'\n     *     Dual hold/unhold\n     *       media.direction == 'inactive'\n     *     MOH Dual hold/unhold\n     *       media.direction == 'sendonly'\n     */\n    const parsedSdp = sdpTransform.parse(params.sdp)\n    if (parsedSdp.media.every(media => media.direction === 'inactive' || media.direction === 'sendonly')) {\n      // No active or send only media in sdp means we must be on remote hold, update call state.\n      context.dispatch(callActions.updateCall(call.id, { remoteHold: true }))\n    } else if (call.remoteHold && parsedSdp.media.some(media => media.direction === 'sendrecv')) {\n      context.dispatch(callActions.updateCall(call.id, { remoteHold: false }))\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    // For a local unhold, we need to look at the SDP and what tracks are\n    //    available in the Session to know which remote tracks will be re-added\n    //    by this operation.\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    const affectedRemoteTracks = await getAllRemoteTracks(session)\n\n    // Get an updated call object\n    call = getCallById(context.getState(), call.id)\n\n    let affectedLocalTracks = []\n    // If we're not in dual-hold (ie. we will be Connected after this), then\n    //    local tracks will become available.\n    if (!call.remoteHold) {\n      // For local tracks, just need to get the local tracks the Session has.\n      const sessionState = getSessionById(context.getState(), call.webrtcSessionId)\n      affectedLocalTracks = sessionState.localTracks\n    }\n\n    /*\n     * Update call state:\n     *    - state change to remove local hold flag,\n     *    - add tracks affected by operation.\n     */\n    context.dispatch(\n      callActions.unholdCallFinish(call.id, {\n        ...operation.operationData,\n        // For an unhold operation, only certain tracks are affected.\n        localTracks: affectedLocalTracks,\n        remoteTracks: affectedRemoteTracks\n      })\n    )\n\n    // Tell the application that tracks have been added.\n    if ([...affectedLocalTracks, ...affectedRemoteTracks].length > 0) {\n      emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n        callId: call.id,\n        trackIds: [...affectedLocalTracks, ...affectedRemoteTracks]\n      })\n    }\n\n    // Tell the application that call state has changed.\n    // We use the original 'call' object that was passed to this operation\n    // (as previous call representation) because after triggering\n    // 'unholdCallFinish' action (above), call state already changed.\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: call.localHold,\n        remoteHold: call.remoteHold\n      }\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return unholdResponse\n}\n","// Call plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { getCallById } from '../../../../../interface/selectors'\n\n// Libraries\nimport { getBrowserDetails } from 'kandy-webrtc'\nimport { getSessionById, getTrackById } from '../../../../../../webrtc/interface/selectors'\n\n/**\n * Bottle wrapper for unhold call operation.\n * @return {Object}\n */\nexport default function createUnhold(container) {\n  /**\n   * Updates an existing call to have \"full\" media.\n   * Can be used as an \"unhold\" operation for plain webRTC scenarios.\n   *\n   * This function defines how a call is taken off \"hold\". It performs the webRTC and\n   *    signaling operations to update the local and server sessions of a call.\n   *    This represents the start of the webRTC renegotiation process for the\n   *    local side.\n   */\n  return {\n    localChanges: callId => localChanges(container, callId),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {string} callId  The ID of the call to unhold.\n * @return {Promise<Object>} Data needed for the signalling step.\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nexport async function localChanges(container, callId) {\n  const { context, CallstackWebrtc, logManager } = container\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Unholding call.')\n\n  const targetCall = getCallById(context.getState(), callId)\n  const { webrtcSessionId } = targetCall\n\n  // If the Session doesn't have a local track for a media kind, then don't change\n  //    that direction to say we're sending one. This prevents the other side\n  //    from getting an empty track.\n  const sessionState = getSessionById(context.getState(), webrtcSessionId)\n  const localTracks = sessionState.localTracks\n  const tracks = localTracks.map(id => getTrackById(context.getState(), id))\n  const mediaDirections = {\n    audio: tracks.some(track => track.kind === 'audio') ? 'sendrecv' : 'recvonly',\n    video: tracks.some(track => track.kind === 'video') ? 'sendrecv' : 'recvonly'\n  }\n\n  let offer\n  try {\n    offer = await CallstackWebrtc.generateOffer(webrtcSessionId, mediaDirections, targetCall.bandwidth)\n  } catch (generateOfferError) {\n    log.debug('Invalid SDP offer or SDP offer not received.')\n    throw generateOfferError\n  }\n\n  return {\n    offer\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call\n * @param {Object} params\n * @param {Object} params.offer\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, CallRequests, Callstack, CallstackWebrtc, logManager } = container\n  const { offer } = params\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  const callInfo = {\n    wrtcsSessionId: call.wrtcsSessionId,\n    id: call.id,\n    offer: offer.sdp,\n    isAnonymous: call.isAnonymous,\n    account: call.account,\n    customParameters: call.customParameters,\n    customBodies: call.customBodies\n  }\n\n  try {\n    await CallRequests.updateSession(callInfo)\n  } catch (responseError) {\n    log.info('Failed to unhold call.')\n    // Rollback only supported on unified-plan\n    let rollbackErr\n    try {\n      await Callstack.utils.rollbackUnhold(call.webrtcSessionId)\n    } catch (rollbackError) {\n      log.debug('Automatic unhold rollback failed:', rollbackError)\n      rollbackErr = rollbackError\n    }\n\n    const browser = getBrowserDetails().browser\n    if (rollbackErr) {\n      // Although Safari can automatically rollback and set another local offer while in `have-local-offer`\n      //  signalling state, Safari does not perform an automatic rollback when a remote offer is\n      //  received while in that state. An InvalidStateError is thrown instead and call is in an awkward state.\n      if (browser === 'safari') {\n        log.info('Ending call due to unrecoverable state after call unhold failure.')\n        // Hangup the call from WebRTC perspective\n        await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n        // Cleanup Redux state by sending END_CALL_FINISH action\n        context.dispatch(\n          callActions.endCallFinish(call.id, {\n            isLocal: true,\n            transition: { reasonText: 'Call has ended due to call unhold failure.' }\n          })\n        )\n\n        throw responseError\n      }\n      log.info('Unable to reset state after unhold operation failure, future operations may not work as intended.')\n    }\n\n    throw responseError\n  }\n  log.info('Finished local portion of unholding call. Waiting on remote response.')\n}\n","import { getCallById } from '../../../../../interface/selectors'\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The SDK state.\n * @param {string} callId The ID used by the SDK to identify the call.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `unhold` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be be held locally.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.localHold !== true) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: 'Call is in an invalid state: localHold=false. It should be: localHold=true.'\n    })\n  }\n}\n","// Callstack.\nimport { isSameSdpSessionId } from '../../../../utils/webrtc'\nimport { getMediaState } from '../../../../../utils/state'\nimport getAffectedRemoteTracks, { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\nimport hasMediaFlowing from '../../../../sdp/utils/hasMediaFlowing'\nimport setMediaInactive from '../../../../sdp/utils/setMediaInactive'\nimport { CALL_MEDIA_STATES } from '../../../../../constants'\n\nimport { callActions as actions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { getCallById, getOptions } from '../../../../../interface/selectors'\nimport { OPERATIONS } from '../../../../../interface/constants'\n\n// Other plugins.\nimport { getSessionById } from '../../../../../../webrtc/interface/selectors'\n\nexport default function createRemoteUnhold(container) {\n  const { context, emitEvent } = container\n\n  /**\n   * Operation for handling a new remote unhold offer SDP.\n   *\n   * Offer checks:\n   *    - set media inactive if locally held\n   *    - recreate Peer if remote op is hold + stop MOH in one\n   *    - unset DTLS role in offer if set\n   */\n  return {\n    localChanges: (call, params, opInfo) => localChanges(container, call, params, opInfo),\n    signalling: async (call, params, stageData) => {\n      try {\n        const { remoteTracks, localTracks } = await signalling(container, call, stageData)\n\n        context.dispatch(\n          actions.remoteUnholdFinish(call.id, {\n            remote: true,\n            remoteParticipant: {\n              displayNumber: params.remoteNumber,\n              displayName: params.remoteName\n            },\n            // Include the affected tracks as part of the action so the call's\n            //    state can be updated accordingly.\n            localTracks,\n            remoteTracks\n          })\n        )\n\n        // The call has changed to a new state.\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId: call.id,\n          previous: {\n            state: call.state,\n            localHold: call.localHold,\n            remoteHold: call.remoteHold\n          }\n        })\n\n        // The affected tracks are now available on the call.\n        emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n          callId: call.id,\n          trackIds: [...localTracks, ...remoteTracks]\n        })\n\n        /*\n         * Special-case: If the call was previously on remote hold with a track, then that\n         *    track was MoH and is being removed as part of the unhold operation. Need to\n         *    also emit an event to notify that the track is gone.\n         * This is needed because \"stop MoH\" and \"unhold\" are done in a single renegotiation\n         *    instead of as two.\n         */\n        if (call.localHold === false && call.remoteHold === true && call.remoteTracks.length > 0) {\n          // Get the tracks from original call state that are not in new call state.\n          const newCall = getCallById(context.getState(), call.id)\n          const removedTracks = call.remoteTracks.filter(id => !newCall.remoteTracks.includes(id))\n\n          emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n            callId: call.id,\n            trackIds: removedTracks\n          })\n        }\n      } catch (error) {\n        // TODO: Does this action update any state? Is it needed?\n        context.dispatch(\n          actions.remoteUnholdFinish(call.id, {\n            remote: true,\n            error\n          })\n        )\n\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId: call.id,\n          previous: {\n            state: call.state,\n            localHold: call.localHold,\n            remoteHold: call.remoteHold\n          },\n          error\n        })\n\n        // Rethrow the error so the CallManager knows of the failure.\n        throw error\n      }\n    }\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.sdp The remote offer SDP.\n * @param {string} params.remoteNumber\n * @param {string} params.remoteName\n * @param {Object} opInfo\n * @param {Object} opInfo.mediaDesc\n * @throws {Error} Throws when WeBRTC negotiation fails.\n * @return {Promise<Object>} Data needed for the signalling step.\n */\nexport async function localChanges(container, call, params, opInfo) {\n  const { context, WebRTC, CallstackWebrtc, CallstackSDP, logManager } = container\n\n  const log = logManager.getLogger('CALL', call.id)\n\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  if (!session) {\n    log.debug(`webRTC session ${call.webrtcSessionId} not found.`)\n    throw new Error(`Session for call ${call.id} not found.`)\n  }\n\n  /*\n   * If the remote operation is offering media but the call is locally held,\n   *    then we need to modify the offer to ensure that media does not restart.\n   */\n  const mediaState = getMediaState(call)\n  const isMediaFlowing = hasMediaFlowing(params.sdp)\n  if (isMediaFlowing && [CALL_MEDIA_STATES.DUAL_HOLD, CALL_MEDIA_STATES.LOCAL_HOLD].includes(mediaState)) {\n    log.debug('Modifying remote offer to prevent resetting media while in local hold.')\n    params.sdp = setMediaInactive(params.sdp)\n    if (!params.sdp) {\n      log.debug('SDP is either undefined or not a string.')\n      return\n    }\n    // Update the `mediaDiff` after we modified the SDP.\n    opInfo.mediaDiff = CallstackSDP.compareMedia(opInfo.remoteDesc.sdp, params.sdp, true)\n  }\n\n  /**\n   * Decision: When we receive a remote unhold offer SDP that currently has MoH,\n   *    then we want to recreate the PeerConnection even if it's the same Session.\n   * This is a workaround/fix for to avoid possible DTLS role conflict issues.\n   *    This usually is only for remote offers for a different \"session ID\",\n   *    but is a special-case.\n   * The remote operation is an unhold but it is also stopping MoH. The Peer was\n   *    recreated on start MOH because the SDP was from a different session, but\n   *    the session doesn't change for stop MOH because it was a remote complex\n   *    operation. The Peer needs to be recreated again otherwise local tracks\n   *    will not be properly added back the call (because of how `recreatePeer` works).\n   * Exception: If client has set the call option 'mediaBrokerOnly' to true, then\n   *    we don't need to recreate the call's PeerConnection.\n   * Reference: KJS-934\n   */\n  const { mediaBrokerOnly } = getOptions(context.getState())\n  const sameSession = await isSameSdpSessionId(WebRTC, call.webrtcSessionId, params.sdp)\n  if (sameSession && call.hasMOH && !mediaBrokerOnly) {\n    log.debug(\n      `Received offer SDP is both an unhold and stop MoH on the same session. Recreating Peer for call ${call.id}.`\n    )\n    await session.recreatePeer()\n  } else {\n    log.debug('Not recreating PeerConnection as mediaBrokerOnly is set to true in configuration.')\n  }\n\n  /**\n   * If the offer SDP has a DTLS role of active (which is invalid), change it to\n   *    actpass. This is a workaround for transfer scenarios where the offer SDP\n   *    is the remote endpoint's answer SDP from them answering the call. This\n   *    happens when slow-start is not done for the transfer.\n   * The user being transferred will see the remote operation as an unhold even\n   *    though it is a transfer.\n   */\n  if (params.sdp.includes('setup:active')) {\n    log.debug(`Received offer SDP with active role for call ${call.id}. Changing.`)\n    params.sdp = params.sdp.replace(/setup:active/g, 'setup:actpass')\n  }\n\n  // Handle the offer SDP to receive an answer SDP.\n  let answer\n  try {\n    answer = await CallstackWebrtc.handleOffer(params.sdp, call.webrtcSessionId, call.bandwidth)\n  } catch (error) {\n    log.debug('Failed to receive offer SDP.', error)\n\n    // TODO: Notify the Gateway that negotiation has failed.\n    // The call may now be in a bad state and needs to be fixed.\n\n    throw error\n  }\n\n  return {\n    answer,\n    sameSession,\n    session,\n    opInfo\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} call The call being acted on.\n * @param {Object} params\n * @param {Object} params.answer\n * @param {string} params.sameSession\n * @param {string} params.session\n * @param {Object} params.opInfo\n * @param {Object} params.opInfo.mediaDesc\n * @throws {Error} Throws when Gateway signaling fails.\n * @return {Promise<Object>} Affected local and remote tracks.\n */\nexport async function signalling(container, call, params) {\n  const { context, CallRequests, logManager } = container\n  const { answer, sameSession, session, opInfo } = params\n  const log = logManager.getLogger('CALL', call.id)\n\n  try {\n    // Send answer sdp back to remote side\n    await CallRequests.updateSessionResponse({\n      wrtcsSessionId: call.wrtcsSessionId,\n      answer: answer.answerSDP,\n      isAnonymous: call.isAnonymous,\n      account: call.account,\n      customParameters: call.customParameters,\n      customBodies: call.customBodies\n    })\n\n    log.info('Finished responding to remote update. Changing state based on the remote operation.')\n\n    // Get the list of remote tracks that are changing (either added or removed) as\n    //    part of the remote operation. This is done after `handleOffer` so the\n    //    Transceivers are up-to-date with the changes being offered.\n    let remoteTracks = []\n    if (!sameSession) {\n      // If the PeerConnection was recreated, then ALL remote tracks will be new.\n      remoteTracks = await getAllRemoteTracks(session)\n    } else {\n      remoteTracks = await getAffectedRemoteTracks(OPERATIONS.UNHOLD, opInfo.mediaDiff, session)\n    }\n\n    let affectedLocalTracks = []\n    if (!call.localHold) {\n      // On remote unhold (that isn't a dual-hold), all local tracks on the Session\n      //    become available.\n      const sessionState = getSessionById(context.getState(), call.webrtcSessionId)\n      affectedLocalTracks = sessionState.localTracks\n    }\n\n    return {\n      remoteTracks,\n      localTracks: affectedLocalTracks\n    }\n  } catch (error) {\n    // Scenario: The offer was processed, but failed to respond with the answer.\n    // The remote side needs the answer SDP before the call is \"connected\".\n    // TODO: Handle this scenario (retry request or fail/revert operation?)\n    log.info('Failed to respond to remote offer with an answer.')\n\n    throw error\n  }\n}\n","// Other plugins.\nimport BasicError from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"rollback Unhold\" operation.\n * @return {Function}\n */\nexport default function rollbackUnholdOperation(container) {\n  const { logManager, WebRTC } = container\n\n  /**\n   * Performs the webRTC session functions associated rolling back the local portion\n   *  of an \"unhold\" (full media) offer\n   *\n   * Responsibilities:\n   *  1. Revert the direction of the local and remote transceivers to \"inactive\"\n   *  2. Rollback the local description SDP offer\n   * @method rollbackUnhold\n   * @param {string} sessionId the local webRTC session id, used to lookup the session object\n   * @return {Object} offer object containing a Session Description Protocol\n   */\n  async function rollbackUnhold(sessionId) {\n    const log = logManager.getLogger('CALLSTACK')\n    const session = await WebRTC.sessionManager.get(sessionId)\n\n    if (!session) {\n      const message = `WebRTC session ${sessionId} not found.`\n      throw new BasicError({ message })\n    }\n\n    // Set the direction of the transceivers back to 'inactive'\n    try {\n      await session.setTransceiversDirection({\n        audio: 'inactive',\n        video: 'inactive'\n      })\n    } catch (error) {\n      // TODO: Handle this potential error\n      // log.debug('Failed to restore local/remote tranceiver directions for audio/video to inactive:', error)\n      // throw error\n    }\n\n    // Rollback the local offer\n    let offer\n    try {\n      offer = await session.rollbackLocalDescription()\n    } catch (error) {\n      log.debug('Failed to rollback local description offer SDP:', error)\n      throw error\n    }\n\n    return { offer }\n  }\n\n  return rollbackUnhold\n}\n","// Call plugin.\nimport { getCallById, getOptions } from '../../../../interface/selectors'\nimport { OPERATIONS } from '../../../../interface/constants'\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../reporter/constants'\n\n// Utils\nimport { organizeTracks } from '../../../utils/media'\nimport { getTrackDscpMapping } from '../../../utils/call'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"answer session\" operation.\n * @return {Function}\n */\nexport default function answerWebrtcSessionOperation(container) {\n  const { context, logManager, CallstackSDP, WebRTC } = container\n\n  /**\n   * Prepares the WebRTC portions of answering a call\n   *\n   * @method answerWebrtcSession\n   * @param  {Object} mediaConstraints Video and audio media constraints\n   * @param  {boolean} mediaConstraints.audio Whether to enable audio or not\n   * @param  {boolean} mediaConstraints.video Whether to enable video or not\n   * @param  {Object} sessionOptions\n   * @param  {string} sessionOptions.sessionId the local webrtc session id\n   * @param  {string} sessionOptions.callId the local call id\n   * @param  {call.BandwidthControls} [sessionOptions.bandwidth] Contains configuration details for setting bandwidth\n   * @param  {call.DSCPControls} [sessionOptions.dscpControls] Contains DSCP configuration for media\n   * @return {Object} Object\n   * @return {string} Object.answerSDP Session Description Protocol for answer\n   * @return {string} Object.mediaId an identifier for media\n   */\n  async function answerWebrtcSession(mediaConstraints, sessionOptions) {\n    const { CallReporter } = container\n    const { sessionId, bandwidth, callId, dscpControls } = sessionOptions\n\n    const log = logManager.getLogger('CALL', callId)\n    log.info('Setting up local WebRTC portions of call.')\n\n    const incomingCall = getCallById(context.getState(), callId)\n\n    const report = CallReporter.getReport(callId)\n    const operation = incomingCall.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.ANSWER\n    })\n    const answerEvent = report.getEvent(operation.eventId)\n\n    const gumEvent = answerEvent.addEvent(REPORT_EVENTS.GET_USER_MEDIA)\n    gumEvent.addData('mediaConstraints', mediaConstraints)\n\n    // Remove detached media from mediaConstraints before creating media in session\n    const { medias: detachedMedias } = mediaConstraints\n    delete mediaConstraints.medias\n\n    let session, medias\n    try {\n      const result = await WebRTC.sessionManager.getWithMedia(sessionId, mediaConstraints, dscpControls)\n      session = result.session\n      medias = result.medias\n      gumEvent.endEvent()\n    } catch (err) {\n      log.debug('Failed to get and add new media to call.')\n      const errorObj = new BasicError({\n        message: err.message,\n        code: callCodes.USER_MEDIA_ERROR\n      })\n      gumEvent.endEvent(errorObj)\n      throw errorObj\n    }\n\n    // Get detached media from WebRTC stack\n    if (detachedMedias) {\n      const detachedMediaObjs = []\n      for (const media of detachedMedias) {\n        detachedMediaObjs.push({\n          type: media.type,\n          media: await WebRTC.media.get(media.media.id)\n        })\n      }\n      // Add detached media to session\n      const trackLists = await organizeTracks(detachedMediaObjs)\n      const dscpTrackMapping = getTrackDscpMapping(trackLists, dscpControls)\n\n      // eslint-disable-next-line no-useless-catch\n      try {\n        await session.addTracks(trackLists.all, dscpTrackMapping)\n        detachedMediaObjs.forEach(detachedMedia => medias.push(detachedMedia.media))\n      } catch (err) {\n        // Follow-up / TODO.\n        throw err\n      }\n    }\n\n    /*\n     * Create the local SDP answer, run it through any provided SDP handlers,\n     *    then set it as the Session's local description.\n     */\n    let answer, callConfigOptions\n\n    const setLocalDescriptionEvent = answerEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n    setLocalDescriptionEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.ANSWER)\n    try {\n      answer = await session.createAnswer()\n\n      callConfigOptions = getOptions(context.getState())\n      // This is the \"pre set local\" stage.\n      answer.sdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, answer.sdp, {\n        callId,\n        type: answer.type,\n        step: 'set',\n        endpoint: 'local',\n        bandwidth\n      })\n\n      answer = await session.setLocalDescription(answer)\n    } catch (error) {\n      setLocalDescriptionEvent.setError(error)\n      setLocalDescriptionEvent.endEvent()\n      throw new BasicError({\n        message: error.message,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n    setLocalDescriptionEvent.endEvent()\n\n    // Run the SDP through the Pipeline again before we send it to the remote side.\n    //    This is the \"pre send local\" stage.\n    // Assign it to a new variable because some browsers enforce the read-only\n    //    properties of a RTCSessionDescription object. The object from\n    //    setLocalDescription is enforced read-only, but the `offer` before that\n    //    is not enforced.\n    const newSdp = CallstackSDP.runPipeline(callConfigOptions.sdpHandlers, answer.sdp, {\n      callId,\n      type: answer.type,\n      step: 'send',\n      endpoint: 'local',\n      bandwidth\n    })\n\n    log.info('Finished setting up local WebRTC portions of call.')\n\n    return {\n      error: false,\n      answerSDP: newSdp,\n      mediaIds: medias.map(media => media.id),\n      session\n    }\n  }\n\n  return answerWebrtcSession\n}\n","// Operations.\nimport createLocalStages from './local/answer'\nimport validate from './local/validate'\n\nimport createSlowStages from './slow/slowAnswer'\nimport slowValidate from './slow/validate'\nimport remoteSlowAnswer from './slow/remoteSlowAnswer'\n\n// Helpers\nimport answerWebrtcSession from './answerWebrtcSession'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.answer', () => {\n    const stages = createLocalStages(bottle.container)\n\n    return {\n      local: {\n        validate,\n        // TODO: This is `localOffer` because the \"localOperation\" flow uses that\n        //    function. Eventually this should be \"fixed\" to properly reflect the answer.\n        localOffer: stages.localChanges,\n        signalling: stages.signalling\n      }\n    }\n  })\n\n  bottle.factory('Callstack.stages.answerSlow', () => {\n    const slowStages = createSlowStages(bottle.container)\n\n    return {\n      local: {\n        validate: slowValidate,\n        localOffer: slowStages.localChanges,\n        signalling: slowStages.signalling,\n        remoteAnswer: remoteSlowAnswer(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.answer', () => {\n    const Callstack = bottle.container.Callstack\n    const updateFactory = Callstack.models.Update\n\n    /**\n     * Factory function for a LocalAnswer operation.\n     * @method LocalAnswer\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local answer operation.\n     */\n    function LocalAnswer(callId) {\n      return updateFactory.instance(\n        {\n          type: OPERATIONS.ANSWER,\n          isLocal: true,\n          stages: Callstack.stages.answer.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalAnswer\n    }\n  })\n\n  bottle.factory('Callstack.operations.answerSlow', () => {\n    const Callstack = bottle.container.Callstack\n    const negFactory = Callstack.models.Negotiation\n\n    /**\n     * Factory function for a SlowAnswer operation.\n     * @method SlowAnswer\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local slow-start answer operation.\n     */\n    function SlowAnswer(callId) {\n      return negFactory.instance(\n        {\n          type: OPERATIONS.ANSWER,\n          isLocal: true,\n          stages: Callstack.stages.answerSlow.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: SlowAnswer\n    }\n  })\n\n  bottle.factory('Callstack.utils.answerWebrtcSession', () => answerWebrtcSession(bottle.container))\n}\n","// Call plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { CALL_STATE_CHANGE, CALL_TRACKS_ADDED } from '../../../../../interface/eventTypes'\nimport { getCallById } from '../../../../../interface/selectors'\nimport { OPERATIONS } from '../../../../../interface/constants'\nimport { CALL_STATES } from '../../../../../constants'\nimport { checkBandwidthControls } from '../../../../utils/call'\nimport { getIncomingRemoteTracks } from '../../../../sdp/media/remoteTracks'\nimport { REPORT_EVENTS } from '../../../../reporter/constants'\n\n// Other plugins\nimport { getSessionById } from '../../../../../../webrtc/interface/selectors'\n\n/**\n * Bottle wrapper for answer call operation.\n * @return {Object}\n */\nexport default function createAnswer(container) {\n  /**\n   * Answers an incoming call.\n   *\n   * This operation defines how a call is answered. It performs the webRTC and\n   *    signaling operations to respond to a call on the server.\n   *\n   * The PeerConnection will exist already (created as part of receiving offer).\n   *    Signaling with an answer SDP will establish the call, so it can be\n   *    considered \"Connected\" afterwards.\n   */\n  return {\n    localChanges: (callId, media, options) => localChanges(container, callId, media, options),\n    signalling: (callId, media, options, params) => signalling(container, callId, media, options, params)\n  }\n}\n\n/**\n * Local changes stage for the 'answer' operation.\n *\n * Performs WebRTC changes (adding local media, setting local answer SDP) on the local call session.\n * @method localChanges\n * @param {Object} container\n * @param {string} callId The ID of the call to answer.\n * @param {Object} media The media options the call should be initialized with.\n * @param {boolean} [media.audio=false] Whether the call should have audio on start. Currently, audio-less calls are not supported.\n * @param {Object} [media.audioOptions] Options for configuring the call's audio.\n * @param {call.MediaConstraint} [media.audioOptions.deviceId] ID of the microphone to receive audio from.\n * @param {boolean} [media.video=false] Whether the call should have video on start.\n * @param {Object} [media.videoOptions] Options for configuring the call's video.\n * @param {call.MediaConstraint} [media.videoOptions.deviceId] ID of the camera to receive video from.\n * @param {call.MediaConstraint} [media.videoOptions.height] The height of the video.\n * @param {call.MediaConstraint} [media.videoOptions.width] The width of the video.\n * @param {call.MediaConstraint} [media.videoOptions.frameRate] The frame rate of the video.\n * @param {boolean} [media.screen=false] Whether the call should have screenshare on start. (Note: Screensharing is not supported on iOS Safari.)\n * @param {Object} [media.screenOptions] Options for configuring the call's screenShare.\n * @param {call.MediaConstraint} [media.screenOptions.height] The height of the screenShare.\n * @param {call.MediaConstraint} [media.screenOptions.width] The width of the screenShare.\n * @param {call.MediaConstraint} [media.screenOptions.frameRate] The frame rate of the screenShare.\n * @param {Object} [options]\n * @param {call.BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n * @param {call.DSCPControls} [options.dscpControls] Options for configuring DSCP markings on the media traffic\n * @param {Array<call.CustomParameter>} [options.customParameters] Custom SIP header parameters for the SIP backend.\n * @param {Array<call.CustomBody>} [options.customBodies] Custom SIP bodies for the SIP backend.\n * @return {Promise<Object>} Data needed for subsequent stages.\n * @throws {BasicError} Throws an error if the WebRTC changes fail.\n */\nasync function localChanges(container, callId, media, options) {\n  const { context, Callstack, logManager } = container\n  const { answerWebrtcSession } = Callstack.utils\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Answering incoming call.')\n\n  const incomingCall = getCallById(context.getState(), callId)\n  const bandwidth = checkBandwidthControls(options.bandwidth)\n\n  // Update the existing webRTC session with an answer.\n  const sessionOptions = {\n    sessionId: incomingCall.webrtcSessionId,\n    bandwidth,\n    dscpControls: options.dscpControls,\n    callId: incomingCall.id\n  }\n\n  let webrtcInfo\n  try {\n    webrtcInfo = await answerWebrtcSession(media, sessionOptions)\n  } catch (error) {\n    log.info('Failed to answer incoming call.')\n    throw error\n  }\n\n  return {\n    webrtcInfo,\n    bandwidth\n  }\n}\n\n/**\n * Signalling stage for the 'answer' operation.\n *\n * Responds to the remote operation with an answer SDP. Updates call state and emits\n *    events to the application afterwards.\n * @method signalling\n * @param {Object} container\n * @param {string} callId\n * @param {Object} media\n * @param {Object} options\n * @param {Object} params\n * @param {Object} params.webrtcInfo\n * @param {Object} params.bandwidth\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nasync function signalling(container, callId, media, options, params) {\n  const { context, Callstack, CallRequests, CallReporter, emitEvent, logManager } = container\n  const { webrtcInfo, bandwidth } = params\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  const callInfo = {\n    id: call.id,\n    answer: webrtcInfo.answerSDP,\n    wrtcsSessionId: call.wrtcsSessionId,\n    customParameters: options.customParameters,\n    customBodies: options.customBodies\n  }\n\n  // Perform the signaling to answer the call.\n  try {\n    await CallRequests.answerSession(callInfo)\n\n    log.info(`Finished answering call. Changing to ${CALL_STATES.CONNECTED}.`)\n\n    // Get the list of all local tracks on the Session.\n    const sessionState = getSessionById(context.getState(), call.webrtcSessionId) || {}\n    const localTracks = sessionState.localTracks\n\n    // Get the list of all remote tracks being offered in this call. This is a\n    //    new call, so this should be the full list of remote tracks available.\n    const remoteTracks = await getIncomingRemoteTracks(webrtcInfo.session)\n\n    context.dispatch(\n      callActions.answerCallFinish(\n        call.id,\n        {\n          state: CALL_STATES.CONNECTED,\n          startTime: Date.now(),\n          // The local Media object associated with this call.\n          mediaIds: webrtcInfo.mediaIds,\n          webrtcSessionId: webrtcInfo.sessionId,\n          // TODO: Properly track the media that the call has.\n          mediaConstraints: media,\n          // The bandwidth of the call\n          bandwidth,\n          // The custom parameters (headers) and custom bodies of the call\n          customParameters: options.customParameters,\n          customBodies: options.customBodies,\n          localTracks,\n          // Add the remote tracks to the call state now that negotiation is done.\n          remoteTracks\n        },\n        {\n          isSlowStart: false\n        }\n      )\n    )\n\n    // Tell the application that tracks are available on the call now.\n    emitEvent(CALL_TRACKS_ADDED, {\n      callId: call.id,\n      trackIds: [...localTracks, ...remoteTracks]\n    })\n\n    emitEvent(CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: call.localHold,\n        remoteHold: call.remoteHold\n      }\n    })\n  } catch (error) {\n    log.info('Failed to answer call.')\n\n    // If the call has been answered already by the same user logged into a different client then\n    // we should let our resync call operation figure it out and put the call in the correct state\n    // (Cancelled)\n    if (error.code === 55) {\n      const callReport = CallReporter.getReport(call.id)\n      // Start the call resync event\n      const operation = call.currentOperations.find(op => {\n        return op.isLocal && op.type === OPERATIONS.ANSWER\n      })\n      const operationEvent = callReport.getEvent(operation.eventId)\n      const resyncEvent = operationEvent.addEvent(REPORT_EVENTS.RESYNC)\n\n      await Callstack.operations.resyncCallState.stages.signalling(call.id)\n\n      resyncEvent.endEvent()\n    }\n\n    throw error\n  }\n}\n","// Call plugin\nimport { getCallById } from '../../../../../interface/selectors'\nimport { CALL_STATES, CALL_DIRECTION } from '../../../../../constants'\n\n// Other plugins\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The current state.\n * @param {string} callId The unique id representing the call instance being operated on.\n * @param {Object} media The media being offered by the current answer operation.\n * @param {Object} options Any additional call-related options.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, media, options) {\n  const call = getCallById(state, callId)\n  /*\n   * `answer` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Initiated` or `Ringing` state.\n   *    3. Call must be `Incoming` direction.\n   *    4. Call must be a regular one.\n   *    5. Media (offered as part of answering call) should not include an offer that incoming call did not specify.\n   *       This validation is needed because backend does not allow media mismatch for 'complex' operations and so\n   *       SDK should abort call right away when it detects this firsthand, instead of allowing call to be established\n   *       only to find that it fails during a complex operation. See `KJS-1631`.\n   */\n  if (!call) {\n    // Call must exist.\n    return new BasicError({\n      message: `Failed to answer call. Call ${callId} not found.`,\n      code: callCodes.INVALID_PARAM\n    })\n  } else if (![CALL_STATES.INITIATED, CALL_STATES.RINGING].includes(call.state)) {\n    // Call must be in Initiated or Ringing state.\n    return new BasicError({\n      message: `Failed to answer call. Call must be in ${CALL_STATES.INITIATED} or ${CALL_STATES.RINGING} state.`,\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.direction !== CALL_DIRECTION.INCOMING) {\n    // Call must be incoming.\n    return new BasicError({\n      message: 'Failed to answer call. Call must be incoming.',\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.isSlowStart) {\n    return new BasicError({\n      message: 'Failed to answer call. Call is slow-start.',\n      code: callCodes.INVALID_STATE\n    })\n  } else {\n    // For regular call, ensure local offer matches what is being offered in incoming call\n    for (const [key, value] of Object.entries(media)) {\n      // Detached media is validated at the API level.\n      if (value && key !== 'medias') {\n        // if callee offered screen share, then this is equivalent to video in webRTC framework,\n        // so allow it to match as 'video' into the incoming offer\n        const equivalentKey = key === 'screen' ? 'video' : key\n\n        // we tried to answer by offering a media that is either not present in incoming call\n        // or the incoming call has that media offering turned off.\n        if (!(equivalentKey in call.mediaOffered) || !call.mediaOffered[equivalentKey]) {\n          return new BasicError({\n            message: `Failed to answer call by offering '${key}': Incoming call did not offer this media.`,\n            code: callCodes.INVALID_PARAM\n          })\n        }\n      }\n    }\n  }\n}\n","// Callstack.\nimport { callActions } from '../../../../../interface/actions'\nimport * as eventTypes from '../../../../../interface/eventTypes'\nimport { OPERATIONS } from '../../../../../interface/constants'\nimport { CALL_STATES } from '../../../../../constants'\nimport { getAllRemoteTracks } from '../../../../sdp/media/remoteTracks'\n\nimport { REPORT_EVENTS, REPORTER_OPERATION_EVENTS_MAP } from '../../../../reporter/constants'\n\n// Other plugins.\nimport { getSessionById } from '../../../../../../webrtc/interface/selectors'\n\nexport default function createSlowAnswerResponse(container) {\n  const { context, logManager, emitEvent, CallstackWebrtc, CallReporter, WebRTC } = container\n\n  /**\n   * Operation for handling the answer SDP of a locally-started slow-start answer operation.\n   *\n   * On succesful handling:\n   *    - updates call state to \"connected\",\n   *    - emits a \"tracks added\" event\n   *    - emits a \"call state change\" event.\n   *\n   * On failure to handle, ends the call as unrecoverable:\n   *    - updates call state to \"ended\",\n   *    - emits a \"call state change\" event.\n   *\n   * @method slowAnswerResponse\n   * @param {Object} call The call being acted on.\n   * @param {Object} params\n   * @param {Object} params.sdp The remote answer SDP.\n   * @return {undefined}\n   */\n  async function slowAnswerResponse(call, params) {\n    const log = logManager.getLogger('CALL', call.id)\n\n    const callReport = CallReporter.getReport(call.id)\n    // Start the process reseponse event\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.ANSWER\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const processResponseEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n    // Add two metadata properties providing more context to this event.\n    processResponseEvent.addData('operation', REPORTER_OPERATION_EVENTS_MAP.ANSWER)\n    processResponseEvent.addData('isSlowStart', call.isSlowStart)\n\n    // Handle the remote answer SDP.\n    try {\n      const sessionInfo = { sessionId: call.webrtcSessionId, answerSdp: params.sdp }\n      await CallstackWebrtc.receivedAnswer(sessionInfo, call)\n    } catch (error) {\n      /*\n       * Failed to set the remote answer SDP. End the call.\n       * TODO: Better error handling. Is the Call fully cleaned-up here?\n       */\n      context.dispatch(\n        callActions.endCallFinish(call.id, {\n          error\n        })\n      )\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId: call.id,\n        previous: {\n          state: call.state,\n          localHold: call.localHold,\n          remoteHold: call.remoteHold\n        },\n        error\n      })\n      processResponseEvent.setError(error)\n      processResponseEvent.endEvent()\n      return\n    }\n\n    log.info(`Finished processing remote response to local ${operation.type}. Changing state based on operation.`)\n\n    // Get the list of all remote tracks being offered in this call. This is a\n    //    new call, so this should be the full list of remote tracks available.\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n    const remoteTracks = await getAllRemoteTracks(session)\n\n    // Get the list of all local tracks on the Session.\n    const sessionState = getSessionById(context.getState(), call.webrtcSessionId)\n    const localTracks = sessionState.localTracks\n\n    /*\n     * Update call state:\n     *    - state change to \"connected\",\n     *    - tracks added to call\n     */\n    context.dispatch(\n      callActions.callAccepted(call.id, {\n        state: CALL_STATES.CONNECTED,\n        startTime: Date.now(),\n        // Remote participant's information.\n        remoteParticipant: {\n          displayNumber: params.remoteNumber,\n          displayName: params.remoteName\n        },\n        // Add the tracks to the call state.\n        remoteTracks,\n        localTracks\n      })\n    )\n\n    // Tell the application that tracks have been added.\n    emitEvent(eventTypes.CALL_TRACKS_ADDED, {\n      callId: call.id,\n      trackIds: [...remoteTracks, ...localTracks]\n    })\n\n    // Tell the application that call state has changed.\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: call.localHold,\n        remoteHold: call.remoteHold\n      }\n    })\n\n    processResponseEvent.endEvent()\n  }\n\n  return slowAnswerResponse\n}\n","// Call plugin\nimport { callActions } from '../../../../../interface/actions'\nimport { getCallById, getOptions, getTurnInfo } from '../../../../../interface/selectors'\nimport { OPERATIONS } from '../../../../../interface/constants'\nimport { CALL_STATES } from '../../../../../constants'\nimport { checkBandwidthControls } from '../../../../utils/call'\nimport { REPORT_EVENTS } from '../../../../reporter/constants'\n\n/**\n * Bottle wrapper for answer call operation.\n * @return {Object}\n */\nexport default function createSlowAnswer(container) {\n  return {\n    localChanges: (callId, media, options) => localChanges(container, callId, media, options),\n    signalling: (callId, params) => signalling(container, callId, params)\n  }\n}\n\n/**\n * Local processing stage for the 'slow answer' operation.\n * @method localChanges\n * @param {Object} container\n * @param {string} callId\n * @param {Object} params\n * @param {Object} params.media\n * @param {Object} params.options\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the WebRTC changes fails.\n */\nexport async function localChanges(container, callId, media, options) {\n  const { context, Callstack, logManager } = container\n  const { setupOutgoingSession } = Callstack.utils\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Answering incoming call.')\n\n  const bandwidth = checkBandwidthControls(options.bandwidth)\n\n  log.debug('Answering call with slow start negotiation.')\n\n  const turnInfo = getTurnInfo(context.getState())\n  const callOptions = getOptions(context.getState())\n\n  /*\n   * If the call was a slow start call, then it doesn't have a webRTC session\n   *    yet. We need to setup the session and provide the signaling server\n   *    with an SDP offer.\n   */\n  let webrtcInfo\n  try {\n    webrtcInfo = await setupOutgoingSession(media, {\n      callId,\n      defaultPeerConfig: callOptions.defaultPeerConfig,\n      turnInfo,\n      bandwidth,\n      dscpControls: options.dscpControls,\n      // ICE related configs.\n      trickleIceMode: callOptions.trickleIceMode,\n      removeBundling: callOptions.removeBundling,\n      serverTurnCredentials: callOptions.serverTurnCredentials\n    })\n  } catch (error) {\n    log.info('Failed to answer incoming call.')\n\n    throw error\n  }\n\n  // Return data that will be needed for further stages.\n  return {\n    webrtcInfo,\n    media,\n    bandwidth,\n    options\n  }\n}\n\n/**\n * Signalling stage for the 'slow answer' operation.\n * @method signalling\n * @param {Object} container\n * @param {string} callId\n * @param {Object} params\n * @param {Object} params.webrtcInfo\n * @param {Object} params.media\n * @param {Object} params.bandwidth\n * @param {Object} params.options\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, callId, params) {\n  const { context, Callstack, CallRequests, CallReporter, logManager } = container\n  const { webrtcInfo, media, bandwidth, options } = params\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  // Perform the signaling to answer the call.\n  try {\n    await CallRequests.answerSession({\n      id: call.id,\n      answer: webrtcInfo.offerSdp,\n      wrtcsSessionId: call.wrtcsSessionId,\n      customParameters: options.customParameters,\n      customBodies: options.customBodies\n    })\n\n    log.info(\n      `Finished answering slow-start call. Changing to ${CALL_STATES.RINGING} and waiting for remote slow-start answer.`\n    )\n\n    context.dispatch(\n      callActions.answerCallFinish(\n        call.id,\n        {\n          state: CALL_STATES.RINGING,\n          // TODO: Proper start time for slow-start calls.\n          startTime: Date.now(),\n          // The local Media object associated with this call.\n          mediaIds: webrtcInfo.mediaIds,\n          // For slow start calls, there isn't a webRTC session yet.\n          webrtcSessionId: webrtcInfo.sessionId,\n          // TODO: Properly track the media that the call has.\n          mediaConstraints: media,\n          // The bandwidth of the call\n          bandwidth,\n          // The custom parameters (headers) and custom bodies of the call\n          customParameters: options.customParameters,\n          customBodies: options.customBodies,\n          localTracks: [],\n          remoteTracks: []\n        },\n        {\n          isSlowStart: call.isSlowStart\n        }\n      )\n    )\n  } catch (error) {\n    log.info('Failed to answer call.')\n\n    // If the call has been answered already by the same user logged into a different client then\n    // we should let our resync call operation figure it out and put the call in the correct state\n    // (Cancelled)\n    if (error.code === 55) {\n      const callReport = CallReporter.getReport(call.id)\n      // Start the call resync event\n      const operation = call.currentOperations.find(op => {\n        return op.isLocal && op.type === OPERATIONS.ANSWER\n      })\n      const operationEvent = callReport.getEvent(operation.eventId)\n      const resyncEvent = operationEvent.addEvent(REPORT_EVENTS.RESYNC)\n\n      await Callstack.operations.resyncCallState.stages.signalling(call.id)\n\n      resyncEvent.endEvent()\n    }\n\n    throw error\n  }\n}\n","// Call plugin\nimport { getCallById } from '../../../../../interface/selectors'\nimport { CALL_STATES, CALL_DIRECTION } from '../../../../../constants'\n\n// Other plugins\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, media, options) {\n  const call = getCallById(state, callId)\n  /*\n   * `answer` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Initiated` or `Ringing` state.\n   *    3. Call must be `Incoming` direction.\n   */\n  if (!call) {\n    // Call must exist.\n    return new BasicError({\n      message: `Failed to answer call. Call ${callId} not found.`,\n      code: callCodes.INVALID_PARAM\n    })\n  } else if (![CALL_STATES.INITIATED, CALL_STATES.RINGING].includes(call.state)) {\n    // Call must be in Initiated or Ringing state.\n    return new BasicError({\n      message: `Failed to answer call. Call must be in ${CALL_STATES.INITIATED} or ${CALL_STATES.RINGING} state.`,\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.direction !== CALL_DIRECTION.INCOMING) {\n    // Call must be incoming.\n    return new BasicError({\n      message: 'Failed to answer call. Call must be incoming.',\n      code: callCodes.INVALID_STATE\n    })\n  } else if (!call.isSlowStart) {\n    return new BasicError({\n      message: 'Failed to answer call. Call is not slow-start.',\n      code: callCodes.INVALID_STATE\n    })\n  }\n}\n","// The factory funnction for the notification handler.\nimport createLocal from './remote/callCancelled'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.callCancelled', () => {\n    return {\n      remote: {\n        remoteOffer: createLocal(bottle.container)\n        // No signalling stage; local-only.\n      }\n    }\n  })\n\n  bottle.factory('Callstack.operations.callCancelled', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    return callId => {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.CALL_CANCEL,\n          isLocal: false,\n          stages: bottle.container.Callstack.stages.callCancelled.remote\n        },\n        {\n          callId\n        }\n      )\n    }\n  })\n}\n","import { CALL_STATE_CHANGE } from '../../../../../interface/eventTypes'\nimport { CALL_STATES } from '../../../../../constants'\nimport { callActions } from '../../../../../interface/actions'\nimport { getCallByWrtcsSessionId } from '../../../../../interface/selectors'\n\n/**\n * Bottle wrapper for \"call cancel\" notification handler.\n * @return {Function}\n */\nexport default function callCancelOperation(container) {\n  const { context, emitEvent, CallstackWebrtc, logManager } = container\n\n  /**\n   * A \"call cancelled\" notification needs to be handled.\n   *\n   * A call can be \"cancelled\" for different reasons. In general, it means that\n   *    the call was not established (locally) but it is no longer available for\n   *    the user to respond. For example, it may have been answered on another\n   *    device, or the caller may have ended it while it was ringing.\n   *\n   * The call is cancelled locally by cleaning up any/all Webrtc resources and\n   *    changing the call state to indicate it was cancelled.\n   *\n   * @method callCancel\n   * @param {string} wrtcsSessionId The server-side session ID of the call.\n   */\n  async function localChanges(wrtcsSessionId) {\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n\n    const log = logManager.getLogger('CALL', (targetCall || {}).id)\n    log.info('Received call cancelled notice; handling.', { wrtcsSessionId })\n\n    if (!targetCall) {\n      log.info('Call cancelled notice for unknown wrtcsSession. Ignoring.', { wrtcsSessionId })\n      return\n    } else if ([CALL_STATES.ENDED, CALL_STATES.CANCELLED].includes(targetCall.state)) {\n      log.info(`Call cancelled notice for already ${targetCall.state} call. Ignoring.`, { wrtcsSessionId })\n      return\n    }\n\n    // Clean up the Webrtc portion of the Call.\n    await CallstackWebrtc.closeCall(targetCall.webrtcSessionId)\n\n    log.info(`Finished handling call cancelled notice. Changing to ${CALL_STATES.CANCELLED}.`)\n    // Dispatch an action to handle the redux portion of the Call.\n    context.dispatch(callActions.callCancelled(targetCall.id))\n\n    // Emit an event for the state change to cancelled\n    emitEvent(CALL_STATE_CHANGE, {\n      callId: targetCall.id,\n      previous: {\n        state: targetCall.state,\n        localHold: targetCall.localHold,\n        remoteHold: targetCall.remoteHold\n      }\n    })\n  }\n\n  return localChanges\n}\n","import createLocalStages from './local/end'\nimport validate from './local/validate'\n\nimport remoteOperation from './remote/callStatusUpdateEnded'\n\nimport { createEnded } from '../../../callManager/flows/RemoteUpdate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.end', () => {\n    const stages = createLocalStages(bottle.container)\n\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: stages.localChanges,\n        signalling: stages.signalling\n      },\n      remote: {\n        remoteOffer: remoteOperation(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.end', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    function end(isLocal) {\n      /**\n       * Factory function for a End operation.\n       * @method End\n       * @param {string} callId ID for the call this operation will affect.\n       * @return {Operation} An instance of a local end operation.\n       */\n      return callId => {\n        const stages = bottle.container.Callstack.stages.end[isLocal ? 'local' : 'remote']\n        // Remote 'ended' operations require a specific flow. For local 'ended', use the default.\n        const createFlow = isLocal ? undefined : createEnded\n        return updateFactory.instance(\n          {\n            // Operation meta-data.\n            type: OPERATIONS.END,\n            isLocal,\n            // Operation methods.\n            stages,\n            createFlow\n          },\n          {\n            callId\n          }\n        )\n      }\n    }\n\n    return {\n      local: end(true),\n      remote: end(false)\n    }\n  })\n}\n","// Call plugin.\nimport { getCallById } from '../../../../../interface/selectors'\nimport * as eventTypes from '../../../../../interface/eventTypes'\n\n// Helpers\nimport { CALL_STATES } from '../../../../../constants'\n\n/**\n * Bottle wrapper for end call operation.\n * @return {Object}\n */\nexport default function createEnd(container) {\n  /**\n   * Callstack operation to end an existing call.\n   */\n  return {\n    localChanges: callId => localChanges(container, callId),\n    signalling: callId => signalling(container, callId)\n  }\n}\n\n/**\n * Local changes stage for the 'end' operation.\n *\n * Performs WebRTC changes (cleaning-up resources) on the local call session.\n * @method localChanges\n * @param {Object} container\n * @param {string} callId The ID that the SDK uses to identify this call.\n * @return {Promise<undefined>}\n */\nexport async function localChanges(container, callId) {\n  const { context, CallstackWebrtc, logManager } = container\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Ending call.')\n\n  const call = getCallById(context.getState(), callId)\n  // Perform webRTC functions, but don't let them block the rest of the operation.\n  CallstackWebrtc.closeCall(call.webrtcSessionId).catch(error => {\n    // Even if there is an error at the webrtc callstack layer,\n    // don't abort, but rather still attempt to send REST request to backend.\n    log.warn(`Could not successfully complete closing webrtc call: ${error}`)\n  })\n}\n\n/**\n * Signalling stage for the 'ends' operation.\n *\n * Sends a REST request to tell the server the call is ended.\n * @method signalling\n * @param {Object} container\n * @param {string} callId\n * @return {Promise<undefined>}\n */\nexport async function signalling(container, callId) {\n  const { context, CallRequests, logManager, emitEvent } = container\n  const call = getCallById(context.getState(), callId)\n  const log = logManager.getLogger('CALL', call.id)\n\n  const { wrtcsSessionId, isAnonymous, account } = call\n\n  try {\n    // Invoke the request\n    await CallRequests.endSession({ callId, wrtcsSessionId, isAnonymous, account })\n  } catch (error) {\n    // Catch and ignore the error.\n    // Design choice: The `end` operation will never fail for a valid call. If\n    //    the application wants to end the call, then make sure it ends. Avoid\n    //    the application getting in an awkward error state where they can't\n    //    end a call.\n  } finally {\n    log.info(`Finished ending call. Changing to ${CALL_STATES.ENDED}.`)\n\n    // Tell the application that no tracks are available any longer.\n    emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n      callId,\n      trackIds: [...call.localTracks, ...call.remoteTracks]\n    })\n  }\n}\n","// Call plugin.\nimport { getCallById } from '../../../../../interface/selectors'\n\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `end` operation validation:\n   *    1. Call must exist.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  }\n}\n","// Call plugin.\nimport { callActions } from '../../../../../interface/actions'\nimport { getCallByWrtcsSessionId } from '../../../../../interface/selectors'\nimport { OPERATIONS, OP_TRANSITIONS } from '../../../../../interface/constants'\nimport { CALL_STATES } from '../../../../../constants'\nimport { CALL_OPERATION, CALL_STATE_CHANGE, CALL_TRACKS_REMOVED } from '../../../../../interface/eventTypes'\n\nimport { generateEndParams } from '../../../../utils/call'\n\n/**\n * Bottle wrapper for \"call status ended\" notification handler.\n * @return {Function}\n */\nexport default function callStatusEndedOperation(container) {\n  const { context, emitEvent, CallstackWebrtc, logManager } = container\n\n  /**\n   * Handle a \"call ended\" notification from the backend.\n   *\n   * This notification means that the session has ended on the other side and we need to end our session as well.\n   * Handling the notification will cleanup the session's media and puts the call in ENDED state.\n   * Responsibilities:\n   *    1. Have the callstack perform the required webRTC cleanup process.\n   *    2. Update call state to ENDED (via redux action).\n   *    3. Emit events to the application about the operation.\n   * @method callStatusUpdateEnded\n   * @param {string}  wrtcsSessionId         ID that the server uses to identify the session.\n   * @param {Object}  params\n   * @param {string}  [params.reasonText]    Human-readable explanation for the call change.\n   * @param {string}  [params.statusCode]    Code representing the reason for the call change.\n   * @param {string}  [params.remoteName]    Name of the remote participant.\n   * @param {string}  [params.remoteNumber]  Number of the remote participant.\n   */\n  async function callStatusUpdateEnded(wrtcsSessionId, { reasonText, statusCode, remoteName, remoteNumber } = {}) {\n    const currentCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n\n    const log = logManager.getLogger('CALL', (currentCall || {}).id)\n    log.info('Received call status ended notice; handling.', { wrtcsSessionId })\n\n    if (!currentCall) {\n      log.info('Call ended notice for unknown wrtcsSession. Ignoring.', { wrtcsSessionId })\n      return\n    }\n\n    if (currentCall.state === CALL_STATES.ENDED) {\n      log.info('Call ended notice for already Ended call. Ignoring.', { wrtcsSessionId })\n      return\n    }\n\n    const prevCall = currentCall\n\n    log.debug(`Call ended notice caused by ${reasonText} (Status Code: ${statusCode}).`)\n\n    try {\n      await CallstackWebrtc.closeCall(currentCall.webrtcSessionId)\n    } catch (error) {\n      // Even if there is an error at the webrtc callstack layer,\n      // we should still end call locally (as a result of receiving a remote end-call notification)\n      // by catching this error and allowing the triggering of action below.\n      log.warn(`Could not succesfully complete closing local webrtc call: ${error.message}`)\n    }\n\n    log.info(`Finished handling call ended notice. Changing to ${CALL_STATES.ENDED}.`)\n\n    context.dispatch(\n      callActions.endCallFinish(\n        currentCall.id,\n        generateEndParams(currentCall.state, false, {\n          reasonText,\n          statusCode,\n          remoteName,\n          remoteNumber\n        })\n      )\n    )\n\n    emitEvent(CALL_OPERATION, {\n      callId: currentCall.id,\n      operation: OPERATIONS.END,\n      transition: OP_TRANSITIONS.FINISH,\n      isLocal: false,\n      previous: {}\n    })\n\n    // Tell the application that no tracks are available any longer.\n    emitEvent(CALL_TRACKS_REMOVED, {\n      callId: currentCall.id,\n      trackIds: [...prevCall.localTracks, ...prevCall.remoteTracks]\n    })\n\n    emitEvent(CALL_STATE_CHANGE, {\n      callId: currentCall.id,\n      transition: { reasonText, statusCode },\n      previous: {\n        state: prevCall.state,\n        localHold: prevCall.localHold,\n        remoteHold: prevCall.remoteHold\n      }\n    })\n  }\n\n  return callStatusUpdateEnded\n}\n","// Call plugin.\nimport { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\n\n/**\n * Bottle wrapper for forward call operation.\n * @return {Function}\n */\nexport default function createForward(container) {\n  /**\n   * Forwards an incoming call.\n   */\n  return async function forward(callId, destination) {\n    // No local changes for this operation.\n    // Signal the intent to forward to the call server.\n    await signalling(container, callId, destination)\n  }\n}\n\n/**\n * Signalling stage for the 'forward' operation.\n * @method signalling\n * @param {Object} container\n * @param {string} callId      ID of the call being acted on.\n * @param {string} destination The destination to forward the call to.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n * @throws {BasicError} Throws if the call cannot be closed.\n */\nexport async function signalling(container, callId, destination) {\n  const { CallRequests, CallstackWebrtc, context, logManager } = container\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Forwarding incoming call.')\n\n  const call = getCallById(context.getState(), callId)\n  // Collect the information needed to make the request.\n  const callInfo = {\n    wrtcsSessionId: call.wrtcsSessionId,\n    address: destination\n  }\n\n  try {\n    await CallRequests.forwardSession(callInfo)\n\n    // Clean-up webrtc resources.\n    await CallstackWebrtc.closeCall(call.webrtcSessionId)\n\n    log.info(`Finished forwarding call. Changing to ${CALL_STATES.ENDED}.`)\n  } catch (err) {\n    log.info('Failed to forward call.')\n    throw err\n  }\n}\n","import createSignalling from './forward'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.forward', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: () => {}, // No-op; no local changes.\n        signalling: createSignalling(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.forward', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalForward operation.\n     * @method LocalForward\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local forward operation.\n     */\n    function LocalForward(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.FORWARD_CALL,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.forward.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalForward\n    }\n  })\n}\n","// Call plugin.\nimport { getCallById } from '../../../../interface/selectors'\nimport { CALL_DIRECTION, CALL_STATES } from '../../../../constants'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, destination) {\n  const call = getCallById(state, callId)\n  /*\n   * `forward` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Initiated` or `Ringing` state.\n   *    3. Call must be `Incoming` direction.\n   */\n  if (!call) {\n    // Call must exist.\n    return new BasicError({\n      message: `Failed to forward call. Call ${callId} not found.`,\n      code: callCodes.INVALID_PARAM\n    })\n  } else if (![CALL_STATES.INITIATED, CALL_STATES.RINGING].includes(call.state)) {\n    // Call must be in Initiated or Ringing state.\n    return new BasicError({\n      message: `Failed to forward call. Call must be in ${CALL_STATES.INITIATED} or ${CALL_STATES.RINGING} state.`,\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.direction !== CALL_DIRECTION.INCOMING) {\n    // Call must be incoming.\n    return new BasicError({\n      message: 'Failed to forward call. Call must be incoming.',\n      code: callCodes.INVALID_STATE\n    })\n  }\n}\n","// Call plugin.\nimport { getCallById } from '../../../../interface/selectors'\n\n// Libraries.\nimport { getBrowserDetails } from 'kandy-webrtc'\n\n// Utils.\nimport { getVersion } from '../../../../../common/version'\nimport sdkId from '../../../../../common/sdkId'\n\n/**\n * Bottle wrapper for getStats call operation.\n * @return {Function}\n */\nexport default function getStatsOperation(container) {\n  const { context, logManager, WebRTC } = container\n\n  /**\n   * Gets low-level statistics about a call (or track).\n   *\n   * This operation defines how/what statistics are retrieved about a call. It performs\n   *    the webRTC operations on the local session. No signaling is involved.\n   * The retrieved call statistics are a RTCStatsReport as provided by the WebRTC\n   *    specification. Stats can be retrieved for either an entire call or\n   *    individual tracks.\n   * Assumptions:\n   *    1. The call is on-going.\n   * Responsibilities:\n   *    1. Ensure the call exists.\n   *    2. Use the webRTC layer to retrieve the stats.\n   *    3. Dispatch an action with the results (which triggers an event).\n   * @method getStats\n   * @param {string} callId The ID of the Call to retrieve the report.\n   * @param {string} trackId Id of a Track being used by the Call. If not\n   *    provided, RTCStatsReport is generated for the Call itself.\n   * @throws {BasicError} Throws an error if the call is not found.\n   * @throws {BasicError} Throws an error if the WebRTC stats can't be retrieved.\n   * @return {Promise} A promise that will resolve with the stats report or an error if it fails.\n   */\n  async function getStats(callId, trackId) {\n    const log = logManager.getLogger('CALL', callId)\n    log.info('Getting call statistics.')\n\n    // Get the call.\n    const targetCall = getCallById(context.getState(), callId)\n    const result = new Map()\n    // Get the local Session for the call.\n    const session = await WebRTC.sessionManager.get(targetCall.webrtcSessionId)\n\n    // Retrieve the RTCStatsReport from the session.\n    const rtcStatsReport = await session.getStats(trackId)\n\n    log.info('Finished getting call statistics.')\n\n    // Extract values for our own custom Statistics\n    const type = 'ribbon_sdk_info'\n    const id = 'ribbon-sdk-info_' + sdkId\n    const version = getVersion()\n    const sdk = '@rbbn/' + (targetCall.isAnonymous ? 'webrtc-anonymous-js-sdk' : 'webrtc-js-sdk')\n\n    // Note that getting browser details is only intended for local browser.\n    // For proxy mode this would return undefined. (see getBrowserDetails() on proxyStack)\n    const details = getBrowserDetails()\n\n    // Define our custom Stats object\n    const sdkMetaData = {\n      id,\n      type,\n      sdk,\n      version,\n      callId: callId\n    }\n\n    if (details) {\n      sdkMetaData.platform = details.browser + '/' + details.version\n    }\n\n    // Set the timestamp value of our custom report to be same value as\n    // the timestamp associated with any stat coming from original webRTC report.\n    const iter = rtcStatsReport.keys()\n    const rtcStatValue = rtcStatsReport.get(iter.next().value)\n    if (rtcStatValue) {\n      sdkMetaData.timestamp = rtcStatValue.timestamp\n    }\n    // Add our custom stats to the ones reported by Web RTC.\n    // Since rtcStatsReport seems to be read-only Map, create a new Map\n    // which includes both our stat & the ones from webrtc.\n    result.set(id, sdkMetaData)\n    rtcStatsReport.forEach(stat => {\n      result.set(stat.id, stat)\n    })\n\n    return result\n  }\n\n  return getStats\n}\n","import createLocal from './getStats'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.getStats', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: createLocal(bottle.container)\n        // No signalling stage.\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.getStats', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalGetStats operation.\n     * @method LocalGetStats\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local get stats operation.\n     */\n    function LocalGetStats(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.GET_STATS,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.getStats.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalGetStats\n    }\n  })\n}\n","// Call plugin.\nimport { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, trackId) {\n  const call = getCallById(state, callId)\n  /*\n   * `getStats` operation validation:\n   *    1. Call must exist.\n   *    2. Call must not be Ended.\n   *    3. If provided, `trackId` must be a local track.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state === CALL_STATES.ENDED) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: 'Failed to get call stats; call must not be ended.'\n    })\n  } else if (trackId && !call.localTracks.includes(trackId)) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Provided trackId is not a local track on the call.'\n    })\n  }\n}\n","// Call plugin\nimport { CALL_STATES } from '../../../../constants'\nimport { getCallById } from '../../../../interface/selectors'\n\n// Other plugins\n\n/**\n * Bottle wrapper for ignore call operation.\n * @return {Function}\n */\nexport default function ignoreOperation(container) {\n  const { context, CallstackWebrtc, logManager } = container\n  /**\n   * Ignores an incoming call.\n   *\n   * This operation defines how a call is ignored. It performs the webRTC\n   *    operations to ignore a \"call\".\n   * Assumptions:\n   *    1. None\n   * Responsibilities:\n   *    1. Cleanup the call locally, using the webRTC helper operation.\n   *    2. Update call state (via redux action).\n   * @method ignoreCall\n   * @param {string}   callId        The id for the call to be ignored.\n   */\n  async function ignore(callId) {\n    const log = logManager.getLogger('CALL', callId)\n    log.info('Ignoring incoming call.')\n\n    const targetCall = getCallById(context.getState(), callId)\n    // Clean-up webRTC objects. Ignore any errors returned, since we want the\n    //    call / session to be ended either way.\n    CallstackWebrtc.closeCall(targetCall.webrtcSessionId)\n\n    log.info(`Finished ignoring call. Changing to ${CALL_STATES.ENDED}.`)\n  }\n\n  return ignore\n}\n","import createLocal from './ignore'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.ignore', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: createLocal(bottle.container)\n        // No signalling stage; local-only.\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.ignore', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalIgnore operation.\n     * @method LocalIgnore\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local ignore operation.\n     */\n    function LocalIgnore(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.IGNORE,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.ignore.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalIgnore\n    }\n  })\n}\n","import { CALL_STATES, CALL_DIRECTION } from '../../../../constants'\nimport { getCallById } from '../../../../interface/selectors'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `ignore` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Initiated` or `Ringing` state.\n   *    3. Call must be `Incoming` direction.\n   */\n  if (!call) {\n    // Call must exist.\n    return new BasicError({\n      message: `Failed to ignore call. Call ${callId} not found.`,\n      code: callCodes.INVALID_PARAM\n    })\n  } else if (![CALL_STATES.INITIATED, CALL_STATES.RINGING].includes(call.state)) {\n    // Call must be in Initiated or Ringing state.\n    return new BasicError({\n      message: `Failed to ignore call. Call must be in ${CALL_STATES.INITIATED} or ${CALL_STATES.RINGING} state.`,\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.direction !== CALL_DIRECTION.INCOMING) {\n    // Call must be incoming.\n    return new BasicError({\n      message: 'Failed to ignore call. Call must be incoming.',\n      code: callCodes.INVALID_STATE\n    })\n  }\n}\n","import createLocal from './playAudio'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.playAudioFile', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: createLocal(bottle.container)\n        // No signalling stage; local-only.\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.playAudioFile', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalPlayAudio operation.\n     * @method LocalPlayAudio\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local play audio operation.\n     */\n    function LocalPlayAudio(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.PLAY_AUDIO,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.playAudioFile.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalPlayAudio\n    }\n  })\n}\n","// Call plugin\nimport { callActions } from '../../../../interface/actions'\nimport { getCallById } from '../../../../interface/selectors'\nimport * as eventTypes from '../../../../interface/eventTypes'\nimport { OPERATIONS, OP_STATUS, OP_TRANSITIONS } from '../../../../interface/constants'\n\n// Other plugins\nimport BasicError, { callCodes } from '../../../../../errors'\nimport { SESSION_AUDIO_ENDED } from '../../../../../webrtc/interface/actionTypes'\n\n/**\n * Bottle wrapper for playAudioFile call operation.\n * @return {Function}\n */\nexport default function createPlayAudio(container) {\n  /**\n   * \"Play audio file\" operation.\n   * Validates that it can perform the operation, then passes it off to the\n   *    Call's Session object. The WebRTC stack performs the actual operation; this\n   *    function manages the responses from the WebRTC stack and forwards feedback\n   *    to the API.\n   */\n  return async function playAudio(callId, filePath, onPlayingCallback) {\n    await localChanges(container, callId, filePath, onPlayingCallback)\n    // No signalling step for this operation.\n  }\n}\n/**\n * @method localChanges\n * @param {Object} container\n * @param {string}   callId            ID of the Call the act on.\n * @param {string}   filePath          Path to the audio file.\n * @param {Function} onPlayingCallback Callback for when audio starts playing.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if call does not exist.\n * @throws {BasicError} Throws if call is not in correct state.\n * @throws {BasicError} Throws if call does not have a WebRTC session.\n * @throws {BasicError} Throws if the session cannot play audio.\n * @throws {BasicError} Throws if audio plays longer than expected duration.\n */\nexport async function localChanges(container, callId, filePath, onPlayingCallback) {\n  const { context, WebRTC, emitEvent, Notifications, logManager } = container\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Replacing call audio with file media.')\n\n  const call = getCallById(context.getState(), callId)\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n\n  if (!session) {\n    throw new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: \"Call's WebRTC session not found.\"\n    })\n  }\n\n  let duration\n  try {\n    duration = await session.insertAudio(filePath)\n    log.info('Audio file has started to play.')\n\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.PLAY_AUDIO\n    })\n    /*\n     * Special-case: Have the playAudio operation manage the \"update\" transition.\n     *    This is because it is not a negotiation operation (hence the CallManager\n     *    wouldn't give it an update transition), but still has a \"pending\" stage\n     *    (hence needs an update transition).\n     */\n    context.dispatch(\n      callActions.operationUpdate(callId, OP_TRANSITIONS.PLAY_AUDIO, true, {\n        transition: OP_TRANSITIONS.UPDATE,\n        eventId: operation.eventId\n      })\n    )\n\n    emitEvent(eventTypes.CALL_OPERATION, {\n      callId,\n      isLocal: true,\n      operation: OPERATIONS.PLAY_AUDIO,\n      transition: OP_TRANSITIONS.UPDATE,\n      previous: {\n        operations: OPERATIONS.PLAY_AUDIO,\n        status: OP_STATUS.ONGOING\n      }\n    })\n  } catch (err) {\n    // Failed to start playing audio file.\n    log.info('Failed to start playing audio file.')\n\n    let code\n    switch (err.message) {\n      case 'Failed to play audio file.':\n        // Likely: the filePath is invalid.\n        code = callCodes.INVALID_PARAM\n        break\n      case 'No valid local audio track found to insert audio file on.':\n        // Error: The Call needs to have a local audio track.\n        code = callCodes.NOT_SUPPORTED\n        break\n      default:\n        // Likely: the native `replaceTrack` function failed.\n        code = callCodes.UNKNOWN_ERROR\n        break\n    }\n\n    throw new BasicError({ code, message: err.message })\n  }\n\n  // Resolve the 'pending' promise to signify the file has started to play.\n  onPlayingCallback({ duration })\n\n  // Wait for the notice saying that the audio file has stopped playing.\n  const timeout = duration * 1000 + 3000\n  let action\n  try {\n    action = await Notifications.takeAction(action => {\n      return action.type === SESSION_AUDIO_ENDED && action.payload.id === session.id\n    }, timeout)\n  } catch (err) {\n    // Audio file hasn't completed when it should have; assume error.\n    log.info('No response from audio file after expected duration; timing-out.')\n    throw new BasicError({\n      code: callCodes.STATE_DESYNC,\n      message: 'Play audio file operation timed-out.'\n    })\n  }\n\n  if (action.error) {\n    // Audio file encountered an error.\n    log.info('Audio file encountered an error while playing.')\n    throw new BasicError({\n      code: callCodes.UNKNOWN_ERROR,\n      message: 'Encountered error while playing audio file.'\n    })\n  } else {\n    // Audio file ended.\n    log.info('Audio file has finished playing.')\n  }\n}\n","import { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The SDK state.\n * @param {Object} callId The ID the SDK uses to identify the call.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, filePath, onPlayingCallback) {\n  const call = getCallById(state, callId)\n  /*\n   * `playAudioFile` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (call.state !== CALL_STATES.CONNECTED) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Invalid call state: ${call.state}. It should be: ${CALL_STATES.CONNECTED}.`\n    })\n  }\n}\n","import createSignalling from './reject'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.reject', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: () => {}, // No-op; no local changes.\n        signalling: createSignalling(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.reject', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalReject operation.\n     * @method LocalReject\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local reject operation.\n     */\n    function LocalReject(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.REJECT,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.reject.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalReject\n    }\n  })\n}\n","// Call plugin\nimport { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\n\n// Other plugins\n\n/**\n * Bottle wrapper for reject call operation.\n * @return {Function}\n */\nexport default function createReject(container) {\n  /**\n   * Rejects an incoming call.\n   *\n   * This operation defines how a call is rejected. It performs the WebRTC and\n   *    signalling operations to reject a \"call\" both locally and on the server.\n   */\n  return async function reject(callId) {\n    // No local changes for this step.\n    await signalling(container, callId)\n  }\n}\n/**\n * @method signalling\n * @param {Object} container\n * @param {Object} callId The ID of the call to reject.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, callId) {\n  const { context, CallRequests, CallstackWebrtc, logManager } = container\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Rejecting incoming call.')\n\n  const incomingCall = getCallById(context.getState(), callId)\n  // Collect the information needed to make the request.\n  const callInfo = {\n    id: callId,\n    wrtcsSessionId: incomingCall.wrtcsSessionId\n  }\n  try {\n    await CallRequests.rejectSession(callInfo)\n  } catch (error) {\n    log.info('Failed to reject call.')\n    throw error\n  }\n\n  // Clean-up WebRTC resources AFTER the REST request to ensure that the\n  //    server-side call is ended. Avoids issues if REST request fails.\n  await CallstackWebrtc.closeCall(incomingCall.webrtcSessionId)\n\n  log.info(`Finished rejecting call. Changing to ${CALL_STATES.ENDED}.`)\n}\n","import { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES, CALL_DIRECTION } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The SDK state.\n * @param {Object} callId The ID used by the SDK to identify the call.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `reject` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Initiated` or `Ringing` state.\n   *    3. Call must be `Incoming` direction.\n   */\n  if (!call) {\n    // Call must exist.\n    return new BasicError({\n      message: `Failed to reject call. Call ${callId} not found.`,\n      code: callCodes.INVALID_PARAM\n    })\n  } else if (![CALL_STATES.INITIATED, CALL_STATES.RINGING].includes(call.state)) {\n    // Call must be in Initiated or Ringing state.\n    return new BasicError({\n      message: `Failed to reject call. Call must be in ${CALL_STATES.INITIATED} or ${CALL_STATES.RINGING} state.`,\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.direction !== CALL_DIRECTION.INCOMING) {\n    // Call must be incoming.\n    return new BasicError({\n      message: 'Failed to reject call. Call must be incoming.',\n      code: callCodes.INVALID_STATE\n    })\n  }\n}\n","import createLocal from './replaceTrack'\nimport validate from './validate'\nimport replaceTrackWebrtcOperation from './webrtcReplaceTrack'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.replaceTrack', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: createLocal(bottle.container)\n        // No signalling stage; local-only.\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.replaceTrack', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalReplaceTrack operation.\n     * @method LocalReplaceTrack\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local replace track operation.\n     */\n    function LocalReplaceTrack(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.REPLACE_TRACK,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.replaceTrack.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalReplaceTrack\n    }\n  })\n\n  bottle.factory('Callstack.utils.webRtcReplaceTrack', () => replaceTrackWebrtcOperation(bottle.container))\n}\n","// Call plugin\nimport { getCallById } from '../../../../interface/selectors'\n\n/**\n * Bottle wrapper for replaceTrack call operation.\n * @return {Function}\n */\nexport default function createReplaceTrack(container) {\n  /**\n   * Replaces an existing track with a new track.\n   *\n   * This function handles the WebRTC portion of replacing a track.\n   */\n  return async function replaceTrack(callId, trackId, mediaConstraints) {\n    return localChanges(container, callId, trackId, mediaConstraints)\n  }\n}\n\n/**\n * @method localChanges\n * @param {Object} container\n * @param {string} callId The ID of the call to replace the track of.\n * @param {string} trackId The ID of the track to replace.\n * @param {Object} [mediaConstraints={}] The media constraints.\n *\n * @param {Object|boolean} [mediaConstraints.audio] Audio-based constraints object or false.\n * @param {string} [mediaConstraints.audio.deviceId] ID of the microphone to receive audio from.\n *\n * @param {Object|boolean} [mediaConstraints.video] Video-based constraints object or false.\n * @param {string} [mediaConstraints.video.deviceId] ID of the camera to receive video from.\n * @param {string} [mediaConstraints.video.width] The width of the video.\n * @param {string} [mediaConstraints.video.height] The height of the video.\n * @param {string} [mediaConstraints.video.frameRate] The frame rate of the video.\n *\n * @param {Object|boolean} [mediaConstraints.screen] Screen Share-based constraints object or false.\n * @param {string} [mediaConstraints.screen.width] The width of the video.\n * @param {string} [mediaConstraints.screen.height] The height of the video.\n * @param {string} [mediaConstraints.screen.frameRate] The frame rate of the video.\n *\n * @param {Array} [mediaConstraints.medias] List of medias containing tracks to be attached to this call.\n *\n * @return {Promise<Object>}\n * @throws {BasicError} Throws if the WebRTC changes fail.\n */\nexport async function localChanges(container, callId, trackId, mediaConstraints) {\n  const { context, Callstack, logManager } = container\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Replacing track on call.')\n\n  const targetCall = getCallById(context.getState(), callId)\n  let result\n  try {\n    result = await Callstack.utils.webRtcReplaceTrack({\n      sessionId: targetCall.webrtcSessionId,\n      trackId,\n      mediaConstraints\n    })\n  } catch (error) {\n    log.info('Failed to replace track on call.')\n    throw error\n  }\n  const { newTrackId, oldTrackState } = result\n  return { newTrackId, oldTrackState }\n}\n","import { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state SDK state.\n * @param {Object} callId The ID the SDK uses to identify the call.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId, trackId, mediaConstraints) {\n  const call = getCallById(state, callId)\n  /*\n   * `replaceTrack` operation validation:\n   *    1. Call must exist.\n   *    2. Call  must not be `Cancelled`, `Ended` or `Initiating` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if ([CALL_STATES.CANCELLED, CALL_STATES.ENDED, CALL_STATES.INITIATING].includes(call.state)) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state: ${call.state}.`\n    })\n  }\n}\n","import { getCallByWebrtcSessionId } from '../../../../interface/selectors'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for \"webrtc ReplaceTrack\" operation.\n * @return {Function}\n */\nexport default function webrtcReplaceTrackOperation(container) {\n  const { context, logManager, WebRTC } = container\n\n  /**\n   * Performs the webRTC responsibilities for replacing a track.\n   *\n   * @param {Object} params\n   * @param {string} params.sessionId The id of the session to replace the track of.\n   * @param {string} params.trackId The id of the track to replace.\n   * @param  {Object} params.mediaConstraints Video or audio media constraints.\n   * @param  {Object|boolean} params.mediaConstraints.audio Audio configs.\n   * @param  {Object|boolean} params.mediaConstraints.video Video configs.\n   * @param  {Object|boolean} params.mediaConstraints.screenShare Screen sharing configs.\n   * @param {Array} [params.mediaConstraints.medias] List of medias containing tracks to be attached to this call.\n   * @returns {Object} replaceTrackResult The result of the track replace operation.\n   * @returns {string} replaceTrackResult.newTrackId The ID of the new track that we used to replace the old one.\n   * @returns {Object} replaceTrackResult.oldTrackState The state of the old track before it was replaced.\n   * @throws {BasicError} [replaceTrackResult.error] Error object if track replacment fails.\n   */\n  async function webrtcReplaceTrack(params) {\n    const { CallstackWebrtc } = container\n    const { sessionId, trackId, mediaConstraints } = params\n    const log = logManager.getLogger('CALLSTACK')\n\n    let noOfTruthyTrackTypes = 0\n    let newTrackKind\n    Object.entries(mediaConstraints).forEach(([key, value]) => {\n      if (value) {\n        noOfTruthyTrackTypes++\n        newTrackKind = key === 'medias' ? mediaConstraints.medias[0].type : key\n      }\n    })\n\n    // Need to handle both cases as valid media constraints, for example:\n    //   mediaConstraints = {video: true, audio: false, screenShare: false}\n    //   mediaConstraints = {video: true}\n    if (noOfTruthyTrackTypes !== 1) {\n      // We require exactly one new track to be provided by API.\n      throw new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message: `Require exactly one new track type to be specified. Found ${noOfTruthyTrackTypes} track types.`\n      })\n    }\n\n    let session\n    try {\n      session = await WebRTC.sessionManager.get(sessionId)\n    } catch (err) {\n      /*\n       * A WebRTC operation should only throw in Proxy mode when the channel times-out\n       *    the operation. Check the first \"get\" in the flow to catch this problem.\n       */\n      log.debug(err.message)\n      throw err\n    }\n    const oldTrack = session.allLocalTracks.find(track => track.id === trackId)\n    if (!oldTrack) {\n      throw new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message: `Old track ${trackId} not found.`\n      })\n    }\n\n    const oldTrackState = await oldTrack.getState()\n    const oldTrackKind = oldTrackState.kind\n    // At the moment, only video & screen share are compatible tracks that can replace each other.\n    // (That's because screen share is sent as a video track to remote peer)\n    // Otherwise, the exact media type is required in order to allow a track replacement.\n    const compatibleTrackKinds =\n      (oldTrackKind === 'audio' && newTrackKind === 'audio') ||\n      (oldTrackKind === 'video' && ['video', 'screen'].includes(newTrackKind))\n\n    if (!compatibleTrackKinds) {\n      throw new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message: `Media constraints incompatible for old track kind: ${oldTrackKind}.`\n      })\n    }\n    let newMedias = []\n    // If detached media is passed in, use that.\n    if (mediaConstraints.medias) {\n      for (const media of mediaConstraints.medias) {\n        newMedias.push({\n          type: media.type,\n          media: await WebRTC.media.get(media.media.id)\n        })\n      }\n    } else {\n      // If no detached media was passed in, create new media.\n      try {\n        // Create Media\n        const call = getCallByWebrtcSessionId(context.getState(), sessionId)\n        newMedias = await CallstackWebrtc.createLocal(mediaConstraints, call.id)\n      } catch (err) {\n        // Error thown from call/callstack/webrtc/media/createLocal\n        log.debug('Failed to create local media.')\n        throw err\n      }\n    }\n\n    let allNewTracks = []\n\n    // Find the new track that matches the old track we want to replace.\n    for (const eachMedia of newMedias) {\n      const newTracks = await eachMedia.media.getTracks()\n      allNewTracks = [...allNewTracks, ...newTracks]\n    }\n\n    let newTrack\n    for (const track of allNewTracks) {\n      // Matching the track is done this way because we need to yield to getState,\n      //    but we can't yield inside of a `.find(func)` or similar. So iterate\n      //    over the new tracks \"manually\".\n      const state = await track.getState()\n      if (state.kind === oldTrackKind) {\n        newTrack = track\n        break\n      }\n    }\n\n    if (!newTrack) {\n      throw new BasicError({\n        code: callCodes.USER_MEDIA_ERROR,\n        message: `${oldTrackKind} track not found`\n      })\n    }\n\n    // Replace the track\n    // According to packages/webrtc/src/models/session it can return a failed Promise\n    const replaceTrackError = await session.replaceTrack(newTrack, { trackId })\n    if (replaceTrackError) {\n      log.debug('Failed to replace track.')\n      // If cannot replace old track, cleanup the newly created track\n      await newTrack.stop()\n\n      throw new BasicError({\n        code: callCodes.GENERIC_ERROR,\n        message: replaceTrackError.message\n      })\n    }\n\n    // stop the old track\n    await oldTrack.stop()\n\n    return {\n      newTrackId: newTrack.id,\n      oldTrackState\n    }\n  }\n  return webrtcReplaceTrack\n}\n","import createSignalling from './resyncCallState'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.resyncCallState', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: () => {}, // No-op; no local changes.\n        signalling: createSignalling(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.resyncCallState', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalResync operation.\n     * @method LocalResync\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local resync operation.\n     */\n    function LocalResync(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.RESYNC,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.resyncCallState.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalResync,\n      // Special-case: The local changes stage can also be called as part of other operations\n      //    (notably answer), so expose that stage directly as well.\n      stages: {\n        signalling: createSignalling(bottle.container)\n      }\n    }\n  })\n}\n","// Call plugin\nimport { callActions } from '../../../../interface/actions'\nimport { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\nimport * as eventTypes from '../../../../interface/eventTypes'\n\n/**\n * Bottle wrapper for resyncCallState call operation.\n * @return {Function}\n */\nexport default function createResync(container) {\n  /**\n   * Sends a GET session request and updates the call if necessary.\n   * The response to the GET session request contains two properties that can be used for determining the call state:\n   *  1. `statusCode` - Code which can be used to provide more info for error responses\n   *  2. `state`\n   *    a. \"RINGING\" - Call exists, and can be either accepted or rejected.\n   *    b. \"ANSWERED\" - Call is active, and can be either Connected or Held.\n   *\n   * This operation performs the signaling operation to get the status of a call session on the server, and any local\n   *    WebRTC operations necessary for closing the call if necessary.\n   */\n  return async function resyncCallState(callId, sessionStatus) {\n    await signalling(container, callId, sessionStatus)\n  }\n}\n\n/**\n * @method resyncCallState\n * @param {Object} container\n * @param {string} callId  The call being acted on.\n * @param {Object} sessionStatus The session status response from the server.\n * @return {Promise<undefined>}\n */\nexport async function signalling(container, callId, sessionStatus) {\n  const { context, CallRequests, CallstackWebrtc, logManager, emitEvent } = container\n  const log = logManager.getLogger('CALL', callId)\n\n  const currentCall = getCallById(context.getState(), callId)\n  try {\n    const sessionStatusResponse =\n      sessionStatus ||\n      (await CallRequests.getSession({\n        wrtcsSessionId: currentCall.wrtcsSessionId,\n        id: callId\n      }))\n\n    if (\n      sessionStatusResponse.state === 'ANSWERED' &&\n      currentCall.state !== CALL_STATES.CONNECTED &&\n      currentCall.state !== CALL_STATES.ON_HOLD\n    ) {\n      log.info('Call re-sync found that call was answered elsewhere. Cancelling call.')\n      // If the call is answered, but not by us, report call as cancelled\n      await CallstackWebrtc.closeCall(currentCall.webrtcSessionId)\n\n      const latestCall = getCallById(context.getState(), callId)\n      if (latestCall.state !== CALL_STATES.ENDED && latestCall.state !== CALL_STATES.CANCELLED) {\n        context.dispatch(callActions.callCancelled(currentCall.id))\n\n        // Notifiy the application that the call has been closed\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId,\n          previous: {\n            state: latestCall.state,\n            localHold: latestCall.localHold,\n            remoteHold: latestCall.remoteHold\n          }\n        })\n      }\n    } else {\n      log.info('Call re-sync found that there are no changes necessary for the call')\n      context.dispatch(callActions.resyncFinish(currentCall.id))\n    }\n  } catch (error) {\n    // Call not found\n    if (error.code === 47) {\n      log.info('Call re-sync found that the call has ended. Ending Call.')\n      // End the call as the session does not exist on the server anymore (statusCode 47 response)\n      await CallstackWebrtc.closeCall(currentCall.webrtcSessionId)\n\n      const latestCall = getCallById(context.getState(), callId)\n      if (latestCall.state !== CALL_STATES.ENDED && latestCall.state !== CALL_STATES.CANCELLED) {\n        context.dispatch(\n          callActions.endCallFinish(currentCall.id, {\n            isLocal: true\n          })\n        )\n\n        // Tell the application that no tracks are available any longer.\n        emitEvent(eventTypes.CALL_TRACKS_REMOVED, {\n          callId,\n          trackIds: [...currentCall.localTracks, ...currentCall.remoteTracks]\n        })\n\n        // 2- 'call state change' event, which updates the state.\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId,\n          previous: {\n            state: currentCall.state,\n            localHold: currentCall.localHold,\n            remoteHold: currentCall.remoteHold\n          },\n          error\n        })\n      }\n    } else {\n      // GET response errors other than session not found\n      log.info(`Call re-sync failure (${error.code}).`, error)\n    }\n  }\n}\n","import { getCallById } from '../../../../interface/selectors'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `resyncCallState` operation validation:\n   *    1. Call must exist.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call not found; invalid call ID.'\n    })\n  }\n}\n","import createSignalling from './sendCustomParameters'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.sendCustomParameters', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: () => {}, // No-op; no local changes.\n        signalling: createSignalling(bottle.container)\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.sendCustomParameters', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalSendParameters operation.\n     * @method LocalSendParameters\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local send custom parameters operation.\n     */\n    function LocalSendParameters(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.SEND_CUSTOM_PARAMETERS,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.sendCustomParameters.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalSendParameters\n      // TODO: Handle received custom parameters should be split into a mini-operation.\n    }\n  })\n}\n","// Call plugin\nimport { getCallById } from '../../../../interface/selectors'\n\n/**\n * Bottle wrapper for sendCustomParameters call operation.\n * @return {Function}\n */\nexport default function createSendParameters(container) {\n  return async function sendCustomParameters(callId) {\n    await signalling(container, callId)\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {string} callId The ID of the call being acted on.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws an error if the REST request fails.\n */\nexport async function signalling(container, callId) {\n  const { context, CallRequests, logManager } = container\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Sending custom parameters for call.')\n\n  // Get the call.\n  const targetCall = getCallById(context.getState(), callId)\n  const { wrtcsSessionId, isAnonymous, account, customParameters } = targetCall\n\n  const callInfo = {\n    wrtcsSessionId,\n    isAnonymous,\n    account,\n    customParameters,\n    id: callId\n  }\n\n  try {\n    await CallRequests.updateCustomParameters(callInfo)\n\n    log.info('Finished sending custom parameters.')\n  } catch (error) {\n    log.info('Failed to send custom parameters.')\n    throw error\n  }\n}\n","import { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The SDK state.\n * @param {string} callId The ID used by the SDK to identify the call.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  /*\n   * `sendCustomParameters` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected` or `On Hold` state.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: `Invalid Call ID. No call found with Call ID: ${callId}`\n    })\n  } else if (call.state !== CALL_STATES.CONNECTED && call.state !== CALL_STATES.ON_HOLD) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call in invalid state for sending custom parameters. Call state: ${call.state}`\n    })\n  } else {\n    const { customParameters } = call\n    if (!customParameters) {\n      return new BasicError({\n        code: callCodes.INVALID_STATE,\n        message: `No custom parameters set on call: ${callId}.`\n      })\n    }\n  }\n}\n","import createLocal from './sendDtmf'\nimport validate from './validate'\n\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Register the individual stages for the operation.\n  bottle.factory('Callstack.stages.sendDtmf', () => {\n    return {\n      local: {\n        validate,\n        // TODO: This operation isn't a negotiation, so we shouldn't be naming\n        //    a stage with WebRTC negotiation terms. But this is the method\n        //    name the `localOperation` flow uses.\n        localOffer: createLocal(bottle.container)\n        // No signalling stage; local-only.\n      }\n    }\n  })\n\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.sendDtmf', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalSendDtmf operation.\n     * @method LocalSendDtmf\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local send DTMF operation.\n     */\n    function LocalSendDtmf(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.SEND_DTMF,\n          isLocal: true,\n          // Operation methods.\n          stages: bottle.container.Callstack.stages.sendDtmf.local\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalSendDtmf\n    }\n  })\n}\n","import { addTones } from './tones'\n\n/**\n * Sends DTMF tones out-of-band over a Session.\n *\n * The Callstack implementation uses the WebRTC stack's implementation for this.\n *    There is no signaling involved.\n *\n * @method playOutBand\n * @param  {Session} session A Webrtc Session object.\n * @param  {Object}  options\n * @param  {string}  options.tone           The tone sequence.\n * @param  {number}  [options.duration]     The length of each DTMF tone.\n * @param  {number}  [options.intertoneGap] The gap between each DTMF tone.\n * @return {boolean} Whether the operation was successful or not.\n */\nexport async function playOutBand(session, options) {\n  return await session.sendDTMF(options)\n}\n\n/**\n * Sends DTMF tones in-band over a Session.\n *\n * DTMF tones are added to the audio track by using AudioContext nodes. A\n *    MediaStream is converted into an audio node, which allows us to add more\n *    audio inputs into the node. The original audio and DTMF tones are mixed\n *    into a single node this way, and the track from this node temporarily\n *    replaces the original track in the Session.\n *\n *                       +-------------------------+\n *    Original           | Additional Audio Source |\n *   MediaStream         +---------+---------------+\n *       |                         |\n *       |                         |\n *       v                         v\n * +-----+-------+         +-------+----------+\n * | Source Node +-------->| Destination Node |\n * +-------------+         +-------+----------+\n *                                 |\n *                                 |\n *                                 v\n *                         MediaStream w/ DTMF\n *\n * @method playInBand\n * @param  {Session} session A Webrtc Session object.\n * @param  {Object}  options\n * @param  {string}  options.tone           The tone sequence.\n * @param  {number}  [options.duration=100]     The length of each DTMF tone.\n * @param  {number}  [options.intertoneGap=70]  The gap between each DTMF tone.\n * @return {boolean} Whether the operation was successful or not.\n */\nexport async function playInBand(session, options) {\n  let { tone, duration, intertoneGap: gap } = options\n\n  // Ensure optional options are numbers (not strings). If not numbers, or\n  //    undefined, use default values.\n  duration = Number(duration) > 0 ? Number(duration) : 100\n  gap = Number(gap) > -1 ? Number(gap) : 70\n\n  // Get the (native) track the tones will be inserted into.\n  const track = session.localTracks.find(track => {\n    const state = track.getState()\n    return state.kind === 'audio'\n  })\n\n  const stream = track.getStream()\n  const context = new AudioContext()\n\n  // Create a source node that has the stream media.\n  const source = context.createMediaStreamSource(stream)\n\n  /**\n   * Create the \"destination node\". All audio sources will be connected to This\n   *    node, and it will be used as the \"final output\".\n   */\n  const dest = context.createMediaStreamDestination()\n  // Connect the source node to it, so that it has the original audio.\n  source.connect(dest)\n\n  // Get the track from the destination node and replace the original track\n  //    on the PeerConnection with it. The remote endpoint will now receive\n  //    any/all audio that is connected to the destination node.\n  const newTrack = dest.stream.getAudioTracks()[0]\n  await session.peer.replaceTrack(newTrack, { trackId: track.id })\n\n  // Add the DTMF tones to the destination node.\n  await addTones(context, dest, tone, { duration, gap })\n\n  // Un-replace track on the PeerConnection. This resets the tracks back to\n  //    \"normal\".\n  await session.peer.replaceTrack(track.track, { trackId: newTrack.id })\n\n  // Clean-up the AudioContext nodes.\n  context.close()\n\n  return true\n}\n","// import { addTone, convertTone, splitTones } from './tones'\nimport { playInBand, playOutBand } from './playMethods'\nimport hasTelephoneEvent from '../../../sdp/utils/hasTelephoneEvent'\n\n// Call plugin.\nimport { getCallById } from '../../../../interface/selectors'\n\n// Other plugins.\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/**\n * Bottle wrapper for sendDtmf call operation.\n * @return {Function}\n */\nexport default function createSendDtmf(container) {\n  /**\n   * Operation for sending DTMF tones on a call.\n   * Determines if the DTMF tones need to be out-of-band (preferred) or in-band.\n   *    Refers to helper functions to send the tones.\n   */\n  return async function sendDtmf(callId, tone, { duration, intertoneGap } = {}) {\n    await localChanges(container, callId, tone, { duration, intertoneGap })\n  }\n}\n\n/**\n * @async\n * @method localChanges\n * @param {Object} container\n * @param {string} callId ID for the Call.\n * @param {string} tone The tone(s) to be sent.\n * @param {Object} options\n * @param {number} options.duration How long each tone should be played for.\n * @param {number} options.intertoneGap How long in between of each tone.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws INVALID_PARAM if call does not exist.\n * @throws {BasicError} Throws INVALID_STATE if call is in the wrong state.\n * @throws {BasicError} Throws INVALID_PARAM if tone is not a valid DTMF tone.\n * @throws {BasicError} Throws GENERIC_ERROR if sending the tone fails.\n */\nexport async function localChanges(container, callId, tone, { duration, intertoneGap }) {\n  const { context, logManager, WebRTC } = container\n  const log = logManager.getLogger('CALL', callId)\n  const call = getCallById(context.getState(), callId)\n\n  // Get the webrtc Session for the call.\n  const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n  // Get the remote description for the Session.\n  const remoteDesc = await session.getRemoteDescription()\n\n  const canSendOutBand = hasTelephoneEvent(remoteDesc.sdp)\n  try {\n    if (canSendOutBand) {\n      log.debug(`Sending DTMF tones out-of-band for call ${call.id}.`)\n      await playOutBand(session, { tone, duration, intertoneGap })\n    } else {\n      log.debug(`Sending DTMF tones in-band for call ${call.id}.`)\n      await playInBand(session, { tone, duration, intertoneGap })\n    }\n\n    log.info(`Successfully sent DTMF tones for call ${call.id}.`)\n  } catch (err) {\n    log.debug(`Failed to send DTMF tones for call ${call.id}.`)\n    throw new BasicError({\n      code: callCodes.GENERIC_ERROR,\n      message: `Unable to send DTMF tones for call ${call.id}.`\n    })\n  }\n}\n","/**\n * Converts a single tone input to its dual-frequencies.\n * @method convertTone\n * @param  {string} tone A DTMF tone input character.\n * @return {Array} The set of frequencies for the DTMF tone.\n */\nexport function convertTone(tone) {\n  if (typeof tone !== 'string' || tone.length > 1 || !/[\\d*#]+/.test(tone)) {\n    throw new Error('Invalid input for DTMF tone.')\n  }\n\n  switch (tone) {\n    case '1':\n      return ['697', '1209']\n    case '2':\n      return ['697', '1336']\n    case '3':\n      return ['697', '1477']\n    case '4':\n      return ['770', '1209']\n    case '5':\n      return ['770', '1336']\n    case '6':\n      return ['770', '1477']\n    case '7':\n      return ['852', '1209']\n    case '8':\n      return ['852', '1336']\n    case '9':\n      return ['852', '1477']\n    case '0':\n      return ['941', '1336']\n    case '*':\n      return ['941', '1209']\n    case '#':\n      return ['941', '1477']\n  }\n}\n\n/**\n * Splits a DTMF tone sequence into individual tones.\n * @method splitTones\n * @param  {string} tone A DTMF tone string.\n * @return {Array} List of single-character tones.\n */\nexport function splitTones(tone) {\n  const matches = tone.match(/[\\d*#]+/)\n  if (!matches || matches[0] !== tone) {\n    throw new Error('Invalid characters in tone.')\n  }\n\n  return tone.split('')\n}\n\n/**\n * Generates DTMF tones based on input, and connects the audio to the provided\n *    target node.\n * @method addTones\n * @param  {AudioContext} context      The AudioContext being used.\n * @param  {AudioNode} targetNode      The AudioNode to add DTMF tones to.\n * @param  {string} tones              The input tones.\n * @param  {Object} [options]\n * @param  {number} [options.duration] The length of each DTMF tone.\n * @param  {number} [options.gap]      The gap between each DTMF tone.\n */\nexport async function addTones(context, targetNode, tones, options) {\n  /**\n   * Node Diagram:\n   * +--------------+\n   * | Oscillator 1 +--+\n   * +--------------+  |    +--------------+\n   *                   +--->|   Osc Node   |\n   * +--------------+  |    +------+-------+\n   * | Oscillator 2 +--+           |\n   * +--------------+              | Connect generated audio\n   *                               v to the provided node.\n   *                        +------+--------+\n   *                        |  Target Node  |\n   *                        +---------------+\n   */\n\n  /**\n   * Step 1: Setup the audio nodes.\n   */\n  // Create the Oscillator nodes that will generate the frequencies.\n  const oscillators = [context.createOscillator(), context.createOscillator()]\n  oscillators[0].type = 'sine'\n  oscillators[1].type = 'sine'\n\n  /**\n   * Create an intermediary Gain node to control the volume of the oscillator\n   *   frequencies before connecting them to anything else.\n   */\n  const oscNode = context.createGain()\n  oscillators[0].connect(oscNode)\n  oscillators[1].connect(oscNode)\n  oscNode.gain.value = 0.1\n\n  // Connect the combined oscillators to the target node. Any tones created\n  //    by the oscillators will be heard in the target node.\n  oscNode.connect(targetNode)\n\n  // Connect the oscillators to the \"destination\" as well, which works magically.\n  // `context.destination` connects to the \"default destination\" (or something\n  //    like that), which will be the machine's speakers. This will play the\n  //    audio locally.\n  oscNode.connect(context.destination)\n\n  /**\n   * Step 2: Use the oscillators to generate DTMF tones.\n   */\n\n  /**\n   * Schedule a frequency to be played for a period of time.\n   * @method scheduleTone\n   * @param  {number} tone  A frequency.\n   * @param  {number} start When the tone should start.\n   * @param  {number} dur   The duration of the tone, in seconds.\n   */\n  function scheduleTone(tone, start, dur) {\n    oscillators[0].frequency.setValueAtTime(tone[0], start)\n    oscillators[0].frequency.setValueAtTime(0, start + dur)\n\n    oscillators[1].frequency.setValueAtTime(tone[1], start)\n    oscillators[1].frequency.setValueAtTime(0, start + dur)\n  }\n\n  const toneSequence = splitTones(tones).map(convertTone)\n\n  // Convert the time units to seconds.\n  const dur = options.duration / 1000\n  const gap = options.gap / 1000\n\n  let toneStart = context.currentTime\n  for (let i = 0; i < toneSequence.length; i++) {\n    scheduleTone(toneSequence[i], toneStart, dur)\n\n    toneStart = toneStart + dur + gap\n  }\n\n  // Start playing the scheduled tones.\n  oscillators[0].start()\n  oscillators[1].start()\n\n  /**\n   * Step 3: Clean-up the audio nodes.\n   */\n\n  // Wait until all tones have finished playing.\n  const numTones = toneSequence.length\n  const delayTime = numTones * (options.duration + options.gap)\n  await new Promise(resolve => {\n    setTimeout(resolve, delayTime)\n  })\n\n  // Disconnect all nodes from each other.\n  oscNode.disconnect()\n  oscillators[0].stop()\n  oscillators[0].disconnect()\n  oscillators[1].stop()\n  oscillators[1].disconnect()\n}\n","import { getCallById } from '../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../constants'\nimport BasicError, { callCodes } from '../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} call The call being operated on.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\n\nexport default function validate(state, callId, tone, { duration, intertoneGap } = {}) {\n  const call = getCallById(state, callId)\n  /*\n   * `sendDtmf` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Connected`, `Ringing`, or `Early Media` state.\n   *    3. A valid tone was provided.\n   */\n  if (!call) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'Call state not found; invalid call ID.'\n    })\n  } else if (![CALL_STATES.CONNECTED, CALL_STATES.RINGING, CALL_STATES.EARLY_MEDIA].includes(call.state)) {\n    return new BasicError({\n      code: callCodes.INVALID_STATE,\n      message: `Call is in an invalid state (${call.state}).`\n    })\n  } else if (!tone || !/^[\\d*#]+/.test(tone)) {\n    return new BasicError({\n      code: callCodes.INVALID_PARAM,\n      message: 'No DTMF tone specified.'\n    })\n  }\n}\n","// Local operation.\nimport createSignalling from './local/sendRingingFeedback'\nimport validate from './local/validate'\n\n// Call plugin.\nimport { OPERATIONS } from '../../../../interface/constants'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.operations.sendRingingFeedback', () => {\n    const updateFactory = bottle.container.Callstack.models.Update\n\n    /**\n     * Factory function for a LocalSendFeedback operation.\n     * @method LocalSendFeedback\n     * @param {string} callId ID for the call this operation will affect.\n     * @return {Operation} An instance of a local send ringing feedback operation.\n     */\n    function LocalSendFeedback(callId) {\n      return updateFactory.instance(\n        {\n          // Operation meta-data.\n          type: OPERATIONS.SEND_RINGING_FEEDBACK,\n          isLocal: true,\n          // Operation methods.\n          stages: {\n            validate,\n            // TODO: This operation isn't a negotiation, so we shouldn't be naming\n            //    a stage with WebRTC negotiation terms. But this is the method\n            //    name the `localOperation` flow uses.\n            localOffer: () => {}, // No-op; no local changes.\n            signalling: createSignalling(bottle.container)\n          }\n        },\n        {\n          callId\n        }\n      )\n    }\n\n    return {\n      local: LocalSendFeedback\n      // remote \"ringing feedback\" is part of the `make` operation.\n    }\n  })\n}\n","// Call plugin\nimport { getCallById } from '../../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../../constants'\n\n/**\n * Bottle wrapper for sendRingingFeedback call operation.\n * @return {Function}\n */\nexport default function createRingingFeedback(container) {\n  /**\n   * Sends ringing feedback to the server for an incoming, Initiated call.\n   *\n   * This operation defines how/when a call can send ringing feedback to the remote user.\n   *    It performs signaling to send this notification to the server, which forwards\n   *    it to the remote side of the call.\n   */\n  return async function sendRingingFeedback(callId) {\n    await signalling(container, callId)\n  }\n}\n\n/**\n * @method signalling\n * @param {Object} container\n * @param {string} callId The id for the call sending ringing feedback.\n * @return {Promise<undefined>}\n * @throws {BasicError} Throws if the REST request fails.\n */\nexport async function signalling(container, callId) {\n  const { context, CallRequests, logManager } = container\n\n  const log = logManager.getLogger('CALL', callId)\n  log.info('Sending ringing feedback for incoming call.')\n\n  const targetCall = getCallById(context.getState(), callId)\n  const callInfo = { wrtcsSessionId: targetCall.wrtcsSessionId, id: targetCall.id }\n  try {\n    await CallRequests.updateCallRinging(callInfo)\n  } catch (error) {\n    log.info(`Failed to send ringing feedback: ${error.code}: ${error.message}`)\n    throw error\n  }\n\n  log.info(`Ringing feedback sent. Changing call to ${CALL_STATES.RINGING} state.`)\n}\n","import { getCallById, getOptions } from '../../../../../interface/selectors'\nimport { CALL_STATES, CALL_DIRECTION } from '../../../../../constants'\nimport BasicError, { callCodes } from '../../../../../../errors'\n\n/*\n * Pre-operation validation method.\n *\n * @param {Object} state The SDK state.\n * @param {string} callId The ID used by the SDK to identify the call.\n * @return {BasicError|undefined} If operation cannot be performed, returns an error.\n */\nexport default function validate(state, callId) {\n  const call = getCallById(state, callId)\n  const options = getOptions(state)\n  /*\n   * `sendRingingFeedback` operation validation:\n   *    1. Call must exist.\n   *    2. Call must be in `Initiated` state.\n   *    3. Call must be `Incoming` direction.\n   */\n  if (!call) {\n    return new BasicError({\n      message: `Failed to send ringing feedback. Call ${callId} not found.`,\n      code: callCodes.INVALID_PARAM\n    })\n  } else if (options.ringingFeedbackMode !== 'manual') {\n    return new BasicError({\n      message: \"Failed to send ringing feedback. Configuration must be set to 'manual' mode.\",\n      code: callCodes.NOT_SUPPORTED\n    })\n  } else if (call.state !== CALL_STATES.INITIATED) {\n    return new BasicError({\n      message: `Failed to send ringing feedback. Call must be in ${CALL_STATES.INITIATED} state.`,\n      code: callCodes.INVALID_STATE\n    })\n  } else if (call.direction !== CALL_DIRECTION.INCOMING) {\n    return new BasicError({\n      message: 'Failed to send ringing feedback. Call must be incoming.',\n      code: callCodes.INVALID_STATE\n    })\n  }\n}\n","// Call plugin.\nimport { callActions } from '../../../../../interface/actions'\nimport { CALL_STATE_CHANGE, CUSTOM_PARAMETERS } from '../../../../../interface/eventTypes'\nimport { getCallByWrtcsSessionId } from '../../../../../interface/selectors'\nimport { CALL_STATES } from '../../../../../constants'\n\n/**\n * Bottle wrapper for \"call status ringing\" notification handler.\n * @return {Function}\n */\nexport default function callStatusRingingOperation(container) {\n  const { context, emitEvent, logManager } = container\n\n  /**\n   * A \"call status update\" has been received and needs to be handled.\n   * The update specifies the server session is in \"ringing\" state.\n   *\n   * This operation handles the \"call ringing\" notification by updating the local\n   *    session state to match the server session state. This only affects the\n   *    local call state.\n   * Responsibilities:\n   *    1. Update call state to RINGING (via redux action).\n   *    2. Emit event to application.\n   * @method callStatusUpdateRinging\n   * @param {string} wrtcsSessionId ID that the server uses to identify the session.\n   * @param {Object} [params={}]\n   * @param {string} params.remoteName   Name of the remote participant.\n   * @param {string} params.remoteNumber Number of the remote participant.\n   * @param {Array}  params.customParameters\n   */\n  function callStatusUpdateRinging(wrtcsSessionId, params = {}) {\n    const call = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n\n    const log = logManager.getLogger('CALL', (call || {}).id)\n    log.info('Received call status ringing notice; handling.', { wrtcsSessionId })\n\n    if (!call) {\n      log.info('Call ringing notice for unknown wrtcsSession. Ignoring.', { wrtcsSessionId })\n      return\n    } else if (call.state !== CALL_STATES.INITIATED) {\n      log.info(`Call ringing notice for Call in an invalid state: ${call.state}. Ignoring.`)\n      return\n    }\n\n    // Dispatch a custom parameters received action/event if any custom parameters were\n    //    received as part of the notification\n    if (params.customParameters) {\n      const customNames = params.customParameters.map(param => param.name)\n      log.debug(`Received custom parameters as part of the Call: ${customNames}.`)\n      context.dispatch(\n        callActions.customParametersReceived(call.id, {\n          customParameters: params.customParameters\n        })\n      )\n\n      emitEvent(CUSTOM_PARAMETERS, {\n        callId: call.id,\n        customParameters: params.customParameters\n      })\n    }\n\n    log.info(`Finished handling call ringing notice. Changing to ${CALL_STATES.RINGING}.`)\n    context.dispatch(\n      callActions.callRinging(call.id, {\n        // Remote participant's information.\n        remoteParticipant: {\n          displayNumber: params.remoteNumber,\n          displayName: params.remoteName\n        }\n      })\n    )\n\n    emitEvent(CALL_STATE_CHANGE, {\n      callId: call.id,\n      previous: {\n        state: call.state,\n        localHold: call.localHold,\n        remoteHold: call.remoteHold\n      }\n    })\n  }\n\n  return callStatusUpdateRinging\n}\n","// Call plugin.\nimport { OPERATIONS } from '../../interface/constants'\n\n/**\n * Events used in the SDK's call reports.\n *\n * As a call progresses, the operation(s)/function(s) being performed throughout\n *    the duration of a call are recorded as events in a call report.\n *    The call report can be retrieved via the {@link call.getReport} API.\n *    An application can use these event names to find the associated event(s)\n *    in the call report for more information on the event.\n *    See _Call Reports_ tutorial for more information on call reports and events.\n *\n * @public\n * @static\n * @name reportEvents\n * @memberof call\n * @requires callMe\n * @requires call\n * @type {Object}\n * @property {string} MAKE Starts when the make operation starts. Ends when the make operation finishes.\n * @property {string} SEND_RINGING_FEEDBACK Starts when the send ringing feedback operation starts. Ends when the ringing feedback operation finishes.\n * @property {string} RECEIVE_CALL Starts when the SDK receives a call and ends when the incoming call is setup.\n * @property {string} REMOTE_RINGING\n * @property {string} ANSWER Starts when the answer operation starts. Ends when the answer operation finishes.\n * @property {string} GET_USER_MEDIA Starts when user media is requested from the browser and ends when the media is created.\n * @property {string} PROCESS_MEDIA_LOCAL Starts when the local media begins processing, and ends when the offer is set and ice collection completes.\n * @property {string} PROCESS_MEDIA_REMOTE Starts when the remote response is received, and ends when the remote media is set.\n * @property {string} ICE_COLLECTION Starts when ice candidate collection starts and ends when collection is complete.\n * @property {string} RELAY_CANDIDATE_COLLECTED Starts and ends when a relay candidate is collected. Event data contains info on the candidate.\n * @property {string} IGNORE Starts when the ignore operation starts. Ends when the ignore operation finishes.\n * @property {string} REJECT Starts when the reject operation starts. Ends when the reject operation finishes.\n * @property {string} FORWARD_CALL Starts when the forward call operation starts. Ends when the forward operation finishes.\n * @property {string} END_LOCAL Starts when the end operation starts. Ends when the end operation finishes.\n * @property {string} END_REMOTE Starts when the call status update ended operation starts. Ends when the call status update ended operation finishes.\n * @property {string} ADD_BASIC_MEDIA Starts when the add basic media operation starts. Ends when the add basic media operation finishes.\n * @property {string} ADD_MEDIA_LOCAL Starts when the add media operation starts. Ends when the add media operation finishes.\n * @property {string} ADD_MEDIA_REMOTE Starts when a remote add media notification is received and ends when the operation is handled.\n * @property {string} REMOVE_BASIC_MEDIA Starts when the remove basic media operation starts. Ends when the remove basic operation finishes.\n * @property {string} REMOVE_MEDIA Starts when the remove media operation starts. Ends when the remove media operation finishes.\n * @property {string} REMOVE_MEDIA_REMOTE Starts when a remote remove media notification is received and ends when the operation is handled.\n * @property {string} MEDIA_RESTART Starts when the media restart operation starts. Ends when the media restart operation finishes.\n * @property {string} REPLACE_TRACK Starts when the replace track operation starts. Ends when the replace track operation finishes.\n * @property {string} HOLD_LOCAL Starts when the hold operation starts. Ends when the hold operation finishes.\n * @property {string} HOLD_REMOTE Starts when a remote hold notification is received and ends when the operation is handled.\n * @property {string} UNHOLD_LOCAL Starts when the unhold operation starts. Ends when the unhold operation finishes.\n * @property {string} UNHOLD_REMOTE Starts when a remote unhold notification is received and ends when the operation is handled.\n * @property {string} REST_REQUEST Starts when a REST request is to be made for an operation and ends when a response is received, or it times out.\n * @property {string} PLAY_AUDIO Starts when the play audio operation starts. Ends when the play audio operation finishes.\n * @property {string} START_MOH Starts when the start music on hold operation starts. Ends when the start music on hold operation finishes.\n * @property {string} STOP_MOH Starts when the stop music on hold operation starts. Ends when the stop music on hold operation finishes.\n * @property {string} SEND_CUSTOM_PARAMETERS Starts when the send custom parameters operation starts. Ends send custom parameters operation finishes.\n * @property {string} GET_STATS Starts when the get stats operation starts. Ends when the get stats operation finishes.\n * @property {string} SEND_DTMF Starts when the send DTMF operation starts. Ends when the DTMF operation finishes.\n * @property {string} RESYNC Starts when the resync operation starts. Ends when the resync operation finishes.\n * @property {string} DIRECT_TRANSFER Starts when the direct transfer operation starts. Ends when the direct transfer operation finishes.\n * @property {string} CONSULTATIVE_TRANSFER Starts when the consultative transfer operation starts. Ends when the consultative transfer operation finishes.\n * @property {string} JOIN Starts when the join operation starts. Ends when the join operation finishes.\n * @property {string} GET_AVAILABLE_CODECS Starts when the get available codecs operation starts. Ends when the get available codecs operation finishes.\n * @property {string} SLOW_START Starts when the slow start operation starts. Ends when the slow stop operation finishes.\n * @example\n * const report = client.call.getReport('callId')\n * const getAvailableCodecsEvent = report.timeline.find(event => event.type === client.call.reportEvents.GET_AVAILABLE_CODECS)\n * log(`Took ${getAvailableCodecsEvent.end - getAvailableCodecsEvent.start}ms to get available codecs.`)\n */\nexport const REPORT_EVENTS = {\n  MAKE: 'MAKE',\n  SEND_RINGING_FEEDBACK: 'SEND_RINGING_FEEDBACK',\n  ANSWER: 'ANSWER',\n  GET_USER_MEDIA: 'GET_USER_MEDIA',\n  PROCESS_MEDIA_LOCAL: 'PROCESS_MEDIA_LOCAL',\n  PROCESS_MEDIA_REMOTE: 'PROCESS_MEDIA_REMOTE',\n  ICE_COLLECTION: 'ICE_COLLECTION',\n  RELAY_CANDIDATE_COLLECTED: 'RELAY_CANDIDATE_COLLECTED',\n  IGNORE: 'IGNORE',\n  REJECT: 'REJECT',\n  FORWARD_CALL: 'FORWARD_CALL',\n  END_LOCAL: 'END_LOCAL',\n  END_REMOTE: 'END_REMOTE',\n  ADD_BASIC_MEDIA: 'ADD_BASIC_MEDIA_LOCAL',\n  ADD_MEDIA: 'ADD_MEDIA_LOCAL',\n  ADD_MEDIA_REMOTE: 'ADD_MEDIA_REMOTE',\n  ADD_TRACKS: 'ADD_TRACKS',\n  REMOVE_BASIC_MEDIA: 'REMOVE_BASIC_MEDIA_LOCAL',\n  REMOVE_MEDIA: 'REMOVE_MEDIA_LOCAL',\n  REMOVE_MEDIA_REMOTE: 'REMOVE_MEDIA_REMOTE',\n  MEDIA_RESTART: 'MEDIA_RESTART',\n  REPLACE_TRACK: 'REPLACE_TRACK',\n  HOLD_LOCAL: 'HOLD_LOCAL',\n  HOLD_REMOTE: 'HOLD_REMOTE',\n  UNHOLD_LOCAL: 'UNHOLD_LOCAL',\n  UNHOLD_REMOTE: 'UNHOLD_REMOTE',\n  PLAY_AUDIO: 'PLAY_AUDIO',\n  START_MOH: 'START_MOH',\n  STOP_MOH: 'START_MOH',\n  SEND_CUSTOM_PARAMETERS: 'SEND_CUSTOM_PARAMETERS',\n  GET_STATS: 'GET_STATS',\n  SEND_DTMF: 'SEND_DTMF',\n  RESYNC: 'RESYNC',\n  DIRECT_TRANSFER: 'DIRECT_TRANSFER',\n  CONSULTATIVE_TRANSFER: 'CONSULTATIVE_TRANSFER',\n  JOIN: 'JOIN',\n  GET_AVAILABLE_CODECS: 'GET_AVAILABLE_CODECS',\n  SLOW_START: 'SLOW_START',\n  RECEIVE_CALL: 'RECEIVE_CALL',\n  REMOTE_RINGING: 'REMOTE_RINGING',\n  REST_REQUEST: 'REST_REQUEST',\n  AUDIT_CALL: 'AUDIT_CALL'\n}\n\n/*\n * Type of request event data for the REST_REQUEST report event.\n */\nexport const REPORTER_REQUESTS = {\n  CREATE_SESSION: 'CREATE_SESSION',\n  ANSWER_SESSION: 'ANSWER_SESSION',\n  REJECT_SESSION: 'REJECT_SESSION',\n  FORWARD_SESSION: 'FORWARD_SESSION',\n  UPDATE_SESSION: 'UPDATE_SESSION',\n  GET_SESSION: 'GET_SESSION',\n  CALL_RINGING_UPDATE_SESSION: 'CALL_RINGING_UPDATE_SESSION',\n  UPDATE_CUSTOM_PARAMETERS_ON_SESSION: 'UPDATE_CUSTOM_PARAMETERS_ON_SESSION',\n  END_SESSION: 'END_SESSION'\n}\n\n/**\n * List of metrics available as part of a Call Report.\n * Metrics are calculated only for the successful scenarios.\n *\n * As a call progresses, timings are calculated for the duration of operations and\n *    other events. They are recorded in a call report that can be retrieved via\n *    the {@link call.getReport} API.\n *\n * @public\n * @static\n * @name metrics\n * @memberof call\n * @requires callMe\n * @requires call\n * @type {Object}\n * @property {string} CALL_DURATION The duration of a completed call starting from the make call API call or incoming call notification until the call ends.\n * @property {string} MAKE_CALL_PRE_LOCAL_SETUP The amount of time it takes from when the `make call` operation starts up until right before we set local description.\n * @property {string} MAKE_CALL_LOCAL_SETUP The amount of time it takes from when a call is made until the call is setup locally. This does not include any remote session creation.\n * @property {string} MAKE_CALL_REMOTE_SETUP The amount of time it takes from when the create session request is sent until the SDK processes the response.\n * @property {string} TIME_TO_MAKE For outgoing calls, the time for the `make` operation to complete.\n * @property {string} ANSWER_CALL_LOCAL_SETUP The amount of time it takes from when the `answer call` operation starts until it is setup locally.\n *   (i.e. from the time an incoming call is answered until media is connected)\n * @property {string} ANSWER_CALL_PRE_LOCAL_SETUP The amount of time it takes from when the `answer call` operation starts up until right before we set local description.\n * @property {string} TIME_TO_ANSWER For incoming calls, the time for the `answer` operation to complete.\n * @property {string} TIME_FROM_RECEIVE_TO_ANSWER For incoming calls, the time from the call first being received until it has been answered. Includes call processing and setup, as well as time for the answer API to have been called.\n * @property {string} TIME_TO_CALL_SETUP_DURATION For incoming calls, the time from the call first being received until media is connected. Similar to `TIME_FROM_RECEIVE_TO_ANSWER`, but without the `answer` REST request.\n * @property {string} TIME_TO_RINGING The amount of time it takes from when a call is made until the SDK recieves the remote ringing notification.\n * @property {string} TIME_TO_IGNORE The amount of time it takes for the ignore call to complete.\n * @property {string} TIME_TO_REJECT The amount of time it takes for the reject call to complete.\n * @property {string} TIME_TO_ADD_MEDIA The amount of time it takes from when the local `add media` operation starts until it has finished.\n * @property {string} TIME_TO_ADD_MEDIA_REMOTE The amount of time it takes from when the SDK receives a remote `add media` notification until it is handled and operation completes.\n * @property {string} TIME_TO_REMOVE_MEDIA The amount of time it takes from when the local `remove media` operation starts until it has finished.\n * @property {string} TIME_TO_REMOVE_MEDIA_REMOTE The amount of time it takes from when the SDK receives a remote `remove media` notification until it is handled and operation completes.\n * @property {string} TIME_TO_RESTART_MEDIA The amount of time it takes from when the `restart media` operation starts until it has finished.\n * @property {string} TIME_TO_HOLD_LOCAL The amount of time it takes from when the local `hold` operation starts until it has finished.\n * @property {string} TIME_TO_HOLD_REMOTE The amount of time it takes from when the SDK receives a remote `hold` notification until it is handled and operation completes.\n * @property {string} TIME_TO_UNHOLD_LOCAL The amount of time it takes from when the local `unhold` operation starts until it has finished.\n * @property {string} TIME_TO_UNHOLD_REMOTE The amount of time it takes from when the SDK receives a remote `unhold` notification until it is handled and operation completes.\n * @property {string} TIME_TO_COLLECT_ICE_CANDIDATES The amount of time it takes from when the local description is set to when all ICE candidates have been collected.\n * @property {string} TIME_TO_RELAY_CANDIDATES The amount of time it takes from when the `ice collection` operation starts until each relay candidate has been recieved.\n * @property {string} TIME_TO_SEND_CUSTOM_PARAMETERS The amount of time it takes from when the `send custom parameters` operation starts until it has finished.\n * @property {string} TIME_TO_FORWARD The amount of time it takes from when the `forward call` operation starts until it has finished.\n * @property {string} TIME_TO_DIRECT_TRANSFER The amount of time it takes from when the `direct transfer` operation starts until it has finished.\n * @property {string} TIME_TO_CONSULTATIVE_TRANSFER The amount of time it takes from when the `consultative transfer` operation starts until it has finished.\n * @property {string} TIME_TO_JOIN The amount of time it takes from when the `join call` operation starts until it has finished.\n * @example\n * const report = client.call.getReport(callId)\n * const callDuration = report.metrics.find(metric => metric.type === client.call.metrics.CALL_DURATION)\n * log(`Call duration was ${callDuration.data}ms.`)\n */\nexport const REPORT_METRICS = {\n  CALL_DURATION: 'CALL_DURATION',\n  MAKE_CALL_PRE_LOCAL_SETUP: 'MAKE_CALL_PRE_LOCAL_SETUP',\n  MAKE_CALL_LOCAL_SETUP: 'MAKE_CALL_LOCAL_SETUP',\n  MAKE_CALL_REMOTE_SETUP: 'MAKE_CALL_REMOTE_SETUP',\n  TIME_TO_MAKE: 'TIME_TO_MAKE',\n  ANSWER_CALL_PRE_LOCAL_SETUP: 'ANSWER_CALL_PRE_LOCAL_SETUP',\n  ANSWER_CALL_LOCAL_SETUP: 'ANSWER_CALL_LOCAL_SETUP',\n  TIME_TO_ANSWER: 'TIME_TO_ANSWER',\n  TIME_FROM_RECEIVE_TO_ANSWER: 'TIME_FROM_RECEIVE_TO_ANSWER',\n  TIME_TO_CALL_SETUP_DURATION: 'TIME_TO_CALL_SETUP_DURATION',\n  TIME_TO_RINGING: 'TIME_TO_RINGING',\n  TIME_TO_IGNORE: 'TIME_TO_IGNORE',\n  TIME_TO_REJECT: 'TIME_TO_REJECT',\n  TIME_TO_ADD_MEDIA: 'TIME_TO_ADD_MEDIA',\n  TIME_TO_ADD_MEDIA_REMOTE: 'TIME_TO_ADD_MEDIA_REMOTE',\n  TIME_TO_REMOVE_MEDIA: 'TIME_TO_REMOVE_MEDIA',\n  TIME_TO_REMOVE_MEDIA_REMOTE: 'TIME_TO_REMOVE_MEDIA_REMOTE',\n  TIME_TO_RESTART_MEDIA: 'TIME_TO_RESTART_MEDIA',\n  TIME_TO_HOLD_LOCAL: 'TIME_TO_HOLD_LOCAL',\n  TIME_TO_HOLD_REMOTE: 'TIME_TO_HOLD_REMOTE',\n  TIME_TO_UNHOLD_LOCAL: 'TIME_TO_UNHOLD_LOCAL',\n  TIME_TO_UNHOLD_REMOTE: 'TIME_TO_UNHOLD_REMOTE',\n  TIME_TO_COLLECT_ICE_CANDIDATES: 'TIME_TO_COLLECT_ICE_CANDIDATES',\n  TIME_TO_RELAY_CANDIDATES: 'TIME_TO_RELAY_CANDIDATES',\n  TIME_TO_SEND_CUSTOM_PARAMETERS: 'TIME_TO_SEND_CUSTOM_PARAMETERS',\n  TIME_TO_FORWARD: 'TIME_TO_FORWARD',\n  TIME_TO_DIRECT_TRANSFER: 'TIME_TO_DIRECT_TRANSFER',\n  TIME_TO_CONSULTATIVE_TRANSFER: 'TIME_TO_CONSULTATIVE_TRANSFER',\n  TIME_TO_JOIN: 'TIME_TO_JOIN'\n}\n\n/**\n * A mapping of call operations / notifications to events recorded by the call reporter.\n */\nexport const REPORTER_OPERATION_EVENTS_MAP = {\n  // Establishment.\n  MAKE: 'MAKE',\n  MAKE_REMOTE: REPORT_EVENTS.RECEIVE_CALL,\n  MAKE_ANONYMOUS: 'MAKE',\n  ANSWER: 'ANSWER',\n  REJECT: 'REJECT',\n  IGNORE: 'IGNORE',\n  SEND_RINGING_FEEDBACK: 'SEND_RINGING_FEEDBACK',\n  FORWARD_CALL: 'FORWARD_CALL',\n  // Midcall.\n  HOLD: 'HOLD_LOCAL',\n  UNHOLD: 'UNHOLD_LOCAL',\n  HOLD_REMOTE: 'HOLD_REMOTE',\n  UNHOLD_REMOTE: 'UNHOLD_REMOTE',\n  SEND_CUSTOM_PARAMETERS: 'SEND_CUSTOM_PARAMETERS',\n  ADD_MEDIA: 'ADD_MEDIA_LOCAL',\n  ADD_MEDIA_REMOTE: 'ADD_MEDIA_REMOTE',\n  ADD_BASIC_MEDIA: 'ADD_BASIC_MEDIA_LOCAL',\n  ADD_BASIC_MEDIA_REMOTE: 'ADD_BASIC_MEDIA_REMOTE',\n  REMOVE_MEDIA: 'REMOVE_MEDIA_LOCAL',\n  REMOVE_MEDIA_REMOTE: 'REMOVE_MEDIA_REMOTE',\n  REMOVE_BASIC_MEDIA: 'REMOVE_BASIC_MEDIA_LOCAL',\n  REMOVE_BASIC_MEDIA_REMOTE: 'REMOVE_BASIC_MEDIA_REMOTE',\n  GET_STATS: 'GET_STATS',\n  SEND_DTMF: 'SEND_DTMF',\n  CONSULTATIVE_TRANSFER: 'CONSULTATIVE_TRANSFER',\n  DIRECT_TRANSFER: 'DIRECT_TRANSFER',\n  JOIN: 'JOIN',\n  REPLACE_TRACK: 'REPLACE_TRACK',\n  MEDIA_RESTART: 'MEDIA_RESTART',\n  RESYNC: 'RESYNC',\n  PLAY_AUDIO: 'PLAY_AUDIO',\n  GET_AVAILABLE_CODECS: 'GET_AVAILABLE_CODECS',\n  END: 'END_LOCAL',\n  END_REMOTE: 'END_REMOTE',\n  // Remote-only.\n  START_MOH_REMOTE: 'START_MOH',\n  STOP_MOH_REMOTE: 'STOP_MOH',\n  SLOW_START_REMOTE: 'SLOW_START',\n  UNKNOWN_REMOTE: 'UNKNOWN',\n  GENERIC_REMOTE: 'UNKNOWN',\n  NO_CHANGE_REMOTE: 'UNKNOWN',\n\n  // TechDebt TODO: Have these consistently named.\n  callStatusUpdateEnded: REPORT_EVENTS.END_REMOTE,\n  receiveEarlyMedia: 'EARLY_MEDIA',\n  callStatusUpdateRinging: REPORT_EVENTS.REMOTE_RINGING,\n  // TechDebt TODO: These constants are mostly hardcoded copy/paste of the call OPERATIONS.\n  [OPERATIONS.CALL_CANCEL]: OPERATIONS.CALL_CANCEL\n}\n\n/*\n * List of operations that trigger an ICE candidate collection.\n */\nexport const ICE_COLLECTION_OPERATIONS = {\n  MAKE: 'MAKE',\n  ANSWER: 'ANSWER',\n  JOIN: 'JOIN',\n  HOLD: 'HOLD_LOCAL',\n  UNHOLD: 'UNHOLD_LOCAL',\n  UNHOLD_REMOTE: 'UNHOLD_REMOTE',\n  ADD_MEDIA: 'ADD_MEDIA_LOCAL',\n  ADD_BASIC_MEDIA: 'ADD_BASIC_MEDIA_LOCAL',\n  ADD_MEDIA_REMOTE: 'ADD_MEDIA_REMOTE',\n  REMOVE_MEDIA: 'REMOVE_MEDIA_LOCAL',\n  REMOVE_BASIC_MEDIA: 'REMOVE_BASIC_MEDIA_LOCAL',\n  MEDIA_RESTART: 'MEDIA_RESTART',\n  START_MOH: 'START_MOH',\n  STOP_MOH: 'STOP_MOH',\n  SLOW_START: 'SLOW_START',\n  UNKNOWN: 'UNKNOWN'\n}\n","// Call Report related.\nimport metricHandlers from '../reporter/metricHandlers'\n\nimport createReporter from 'webrtc-reporter'\n\nexport default function createComponent(bottle) {\n  // Create a new Reporter to collect call report metrics\n  const callReporter = reporter()\n  bottle.value('CallReporter', callReporter)\n}\n\n/**\n * CallReporter component for the SDK, using the reporter tool.\n */\nfunction reporter() {\n  const reporter = createReporter()\n\n  function createReport(...params) {\n    const report = reporter.createReport(...params)\n    metricHandlers.registerAllMetricHandlers(report)\n    return report\n  }\n\n  return {\n    createReport,\n    getReport: reporter.getReport,\n    deleteReport: reporter.deleteReport\n  }\n}\n","import { REPORT_EVENTS, REPORT_METRICS } from './constants'\n\n/**\n * @method durationHandler\n * @param {string} metric The metric type which will be added to report when handler function is executed.\n * @param {Array} startEvents The set of event types whose `start` timestamp will be used to calculate the metric value.\n * @param {boolean} autoUnregister Specifies wether to automatically unregister the event handler function after it executed once.\n *   By default (if not specified), it will unregister the handler once it executed.\n * @returns {undefined}\n */\nfunction durationHandler(metric, startEvents, autoUnregister = true) {\n  /**\n   * Handler function which executes when a certain registered event has ended.\n   * @return {boolean} Returns true if handler was executed AND metric was saved. False otherwise.\n   */\n  return function (callReport, event) {\n    // First search for the event in the timeline of the report (i.e. see if it's a top-level event).\n    // Loop through the timeline backwards to find the last type of the specified start event in the case of\n    // mutiple identical operations (i.e., multiple holds).\n    let startEvent\n    for (let i = callReport.timeline.length - 1; i >= 0; i--) {\n      const timelineEvent = callReport.timeline[i]\n      if (startEvents.includes(timelineEvent.type)) {\n        startEvent = timelineEvent\n        break\n      } else {\n        // Check the sub-events for the start event (e.g., set local description is a common start event)\n        for (let j = 0; j <= timelineEvent.timeline.length - 1; j++) {\n          const timelineSubEvent = timelineEvent.timeline[j]\n          if (startEvents.includes(timelineSubEvent.type)) {\n            startEvent = timelineSubEvent\n            break\n          }\n        }\n        // If we found the start event in the sub-events break out of the loop\n        if (startEvent) {\n          break\n        }\n      }\n    }\n\n    if (startEvent) {\n      // PROCESS_MEDIA_REMOTE event is triggered as part of many SDK operations and on both sides of the call.\n      // But we don't want to add a 'MAKE_CALL_REMOTE_SETUP' metric for the callee side,\n      // because it only makes sense for caller side.\n      if (\n        event.type === REPORT_EVENTS.PROCESS_MEDIA_REMOTE &&\n        metric === 'MAKE_CALL_REMOTE_SETUP' &&\n        event.getData('operation') !== 'MAKE'\n      ) {\n        return false\n      }\n\n      // Special-case: For ice collection time, add the operation that triggered the ice collection\n      if (metric === REPORT_METRICS.TIME_TO_COLLECT_ICE_CANDIDATES) {\n        callReport.addMetric(metric, {\n          operation: startEvent.getData('operation'), // Get the operation from the set local desc event data\n          duration: event.end - startEvent.start\n        })\n      } else {\n        // We found the start event, so save its associated metric containing the measurement.\n        callReport.addMetric(metric, event.end - startEvent.start)\n        if (autoUnregister) {\n          // We automatically unregister the handler once it was executed.\n          callReport.unregisterMetricHandler(metric)\n        }\n      }\n      return true\n    }\n    return false\n  }\n}\n\n/**\n * @method callPreSDPHandler\n * @param {string} metric The metric type which will be added to report when handler function is executed.\n * @param {Array} startEvents The set of event types whose `start` timestamp will be used to calculate the metric value.\n * @returns {undefined}\n */\nfunction callPreSDPHandler(metric, startEvents) {\n  /**\n   * Handler function which executes when a certain registered event has ended.\n   * @return {boolean} Returns true if handler was executed AND metric was saved. False otherwise.\n   */\n  return function (callReport, event) {\n    // Search for the event in the timeline of the report\n    const startEvent = callReport.timeline.find(event => startEvents.includes(event.type))\n\n    if (startEvent) {\n      callReport.addMetric(metric, event.start - startEvent.start)\n      callReport.unregisterMetricHandler(metric)\n      return true\n    }\n    return false\n  }\n}\n\n/**\n * @method joinedCallDurationHandler\n * @param {string} metric The metric type which will be added to report when handler function is executed.\n * @param {Array} startEvents The set of event types whose `start` timestamp will be used to calculate the metric value.\n * @returns {undefined}\n */\nfunction joinedCallDurationHandler(metric, startEvents) {\n  /**\n   * Handler function which executes when a certain registered event has ended.\n   * @return {boolean} Returns true if handler was executed AND metric was saved. False otherwise.\n   */\n  return function (callReport, event) {\n    // Search for the event in the timeline of the report\n    const startEvent = callReport.timeline.find(event => startEvents.includes(event.type))\n\n    // startEvent !== event is for the special case join operation which is used as the end for the initial\n    // two calls, but the starting event for the joined call.\n    if (startEvent && startEvent !== event) {\n      // We found the start event, so save its associated metric containing the measurement.\n      callReport.addMetric(metric, event.end - startEvent.start)\n      // We automatically unregister the handler once it was executed.\n      callReport.unregisterMetricHandler(metric)\n      return true\n    }\n    return false\n  }\n}\n\n/**\n * A function that gathers the relay candidates as they are collected and then returns a handler function that will\n * create the metric for the relay candidates after collection is complete.\n *\n * Each time a relay candidate collected event is received it will create an object with that relay candidates data and\n * store it in an array. When the set local description event ends it will update all the collected candidates in the array\n * with the correct duration, and add a metric to the call report for them.\n * @method relayCandidatesHandler\n * @returns {Function} The metric handler function\n */\nfunction relayCandidatesHandler() {\n  const collectedCandidates = []\n  return (callReport, event) => {\n    if (event.type === REPORT_EVENTS.RELAY_CANDIDATE_COLLECTED) {\n      const eventData = event.getData()\n      const collectedCandidateInformation = {\n        ...eventData,\n        duration: event.start // The candidate was collected by the time this event was added\n      }\n      collectedCandidates.push(collectedCandidateInformation)\n    } else if (event.type === REPORT_EVENTS.PROCESS_MEDIA_LOCAL) {\n      // Update the duration of all the collected candidates\n      collectedCandidates.map(candidateInfo => {\n        candidateInfo.duration = candidateInfo.duration - event.start\n        return collectedCandidates\n      })\n      // Only need to add metric if there will be any data...\n      if (collectedCandidates.length) {\n        callReport.addMetric(REPORT_METRICS.TIME_TO_RELAY_CANDIDATES, {\n          operation: event.getData('operation'),\n          candidates: [...collectedCandidates]\n        })\n      }\n      collectedCandidates.length = 0\n    }\n  }\n}\n\n// Generic function to register all metric handlers to the call reporter\nfunction registerAllMetricHandlers(callReport) {\n  // Register the call duration handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.CALL_DURATION,\n    [\n      REPORT_EVENTS.END_LOCAL,\n      REPORT_EVENTS.END_REMOTE,\n      REPORT_EVENTS.JOIN,\n      REPORT_EVENTS.DIRECT_TRANSFER,\n      REPORT_EVENTS.CONSULTATIVE_TRANSFER\n    ],\n    joinedCallDurationHandler(REPORT_METRICS.CALL_DURATION, [\n      REPORT_EVENTS.MAKE,\n      REPORT_EVENTS.RECEIVE_CALL,\n      REPORT_EVENTS.JOIN\n    ])\n  )\n\n  // Register the local-setup handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.MAKE_CALL_LOCAL_SETUP,\n    [REPORT_EVENTS.PROCESS_MEDIA_LOCAL],\n    durationHandler(REPORT_METRICS.MAKE_CALL_LOCAL_SETUP, [REPORT_EVENTS.MAKE])\n  )\n\n  // Register the handler for collecting ice candidates during the local-setup.\n  // The start event will be PROCESS_MEDIA_LOCAL and the metric will be saved when\n  // its sub-event (i.e. ICE_COLLECTION) has ended.\n  // Since PROCESS_MEDIA_LOCAL event occurs on both caller & callee, its sub-event: ICE_COLLECTION\n  // will also be available for each party.\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_COLLECT_ICE_CANDIDATES,\n    [REPORT_EVENTS.ICE_COLLECTION],\n    durationHandler(REPORT_METRICS.TIME_TO_COLLECT_ICE_CANDIDATES, [REPORT_EVENTS.PROCESS_MEDIA_LOCAL], false)\n  )\n\n  // Register the remote-setup handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.MAKE_CALL_REMOTE_SETUP,\n    [REPORT_EVENTS.PROCESS_MEDIA_REMOTE],\n    durationHandler(REPORT_METRICS.MAKE_CALL_REMOTE_SETUP, [REPORT_EVENTS.REST_REQUEST])\n  )\n\n  // Register the time-to-ringing handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_RINGING,\n    [REPORT_EVENTS.REMOTE_RINGING],\n    durationHandler(REPORT_METRICS.TIME_TO_RINGING, [REPORT_EVENTS.MAKE])\n  )\n\n  /*\n   * TIME_FROM_RECEIVE_TO_ANSWER\n   * Metric from when an incoming call is received until it has been answered.\n   * Duration includes:\n   *    - time for processing call notification,\n   *    - time for application to call the `answer` API, and\n   *    - time for `answer` operation to complete.\n   * This metric is for the special-case of incoming calls being auto-answered.\n   * This is the sum of TIME_TO_CALL_SETUP_DURATION and the answer REST request duration.\n   */\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_FROM_RECEIVE_TO_ANSWER,\n    REPORT_EVENTS.ANSWER,\n    durationHandler(REPORT_METRICS.TIME_FROM_RECEIVE_TO_ANSWER, [REPORT_EVENTS.RECEIVE_CALL])\n  )\n\n  // Time to setup incoming call (incoming call notification until media is connected)\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_CALL_SETUP_DURATION,\n    REPORT_EVENTS.PROCESS_MEDIA_LOCAL,\n    durationHandler(REPORT_METRICS.TIME_TO_CALL_SETUP_DURATION, [REPORT_EVENTS.RECEIVE_CALL])\n  )\n\n  // Time to setup incoming call (answer call operation until media is connected)\n  callReport.registerMetricHandler(\n    REPORT_METRICS.ANSWER_CALL_LOCAL_SETUP,\n    REPORT_EVENTS.PROCESS_MEDIA_LOCAL,\n    durationHandler(REPORT_METRICS.ANSWER_CALL_LOCAL_SETUP, [REPORT_EVENTS.ANSWER])\n  )\n\n  // Register the time-to-relay-candidates handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_RELAY_CANDIDATES,\n    [REPORT_EVENTS.PROCESS_MEDIA_LOCAL, REPORT_EVENTS.RELAY_CANDIDATE_COLLECTED],\n    relayCandidatesHandler()\n  )\n\n  // Register the answer-call-pre-local-setup handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.ANSWER_CALL_PRE_LOCAL_SETUP,\n    REPORT_EVENTS.PROCESS_MEDIA_LOCAL,\n    callPreSDPHandler(REPORT_METRICS.ANSWER_CALL_PRE_LOCAL_SETUP, [REPORT_EVENTS.ANSWER])\n  )\n\n  // Register the make-call-pre-local-setup handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.MAKE_CALL_PRE_LOCAL_SETUP,\n    REPORT_EVENTS.PROCESS_MEDIA_LOCAL,\n    callPreSDPHandler(REPORT_METRICS.MAKE_CALL_PRE_LOCAL_SETUP, [REPORT_EVENTS.MAKE])\n  )\n\n  /*\n   * **************************\n   * TIME-TO-OPERATION metrics.\n   *  ie. metrics that are the duration of a single event.\n   * **************************\n   */\n\n  // Time to reject incoming call\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_REJECT, [REPORT_EVENTS.REJECT], (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_REJECT, event.end - event.start)\n  })\n\n  // Register the time-to-ignore handler\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_IGNORE, [REPORT_EVENTS.IGNORE], (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_IGNORE, event.end - event.start)\n  })\n\n  // Register the time-to-add-media handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_ADD_MEDIA,\n    [REPORT_EVENTS.ADD_MEDIA, REPORT_EVENTS.ADD_BASIC_MEDIA],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_ADD_MEDIA, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-add-media-remote handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_ADD_MEDIA_REMOTE,\n    [REPORT_EVENTS.ADD_MEDIA_REMOTE],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_ADD_MEDIA_REMOTE, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-hold-local handler\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_HOLD_LOCAL, [REPORT_EVENTS.HOLD_LOCAL], (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_HOLD_LOCAL, event.end - event.start)\n  })\n\n  // Register the time-to-hold-remote handler\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_HOLD_REMOTE, [REPORT_EVENTS.HOLD_REMOTE], (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_HOLD_REMOTE, event.end - event.start)\n  })\n\n  // Register the time-to-unhold-local handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_UNHOLD_LOCAL,\n    [REPORT_EVENTS.UNHOLD_LOCAL],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_UNHOLD_LOCAL, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-unhold-remote handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_UNHOLD_REMOTE,\n    [REPORT_EVENTS.UNHOLD_REMOTE],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_UNHOLD_REMOTE, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-remove-media handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_REMOVE_MEDIA,\n    [REPORT_EVENTS.REMOVE_MEDIA, REPORT_EVENTS.REMOVE_BASIC_MEDIA],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_REMOVE_MEDIA, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-remove-media-remote handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_REMOVE_MEDIA_REMOTE,\n    [REPORT_EVENTS.REMOVE_MEDIA_REMOTE],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_REMOVE_MEDIA_REMOTE, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-restart-media handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_RESTART_MEDIA,\n    REPORT_EVENTS.MEDIA_RESTART,\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_RESTART_MEDIA, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-send-custom-paramters handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_SEND_CUSTOM_PARAMETERS,\n    REPORT_EVENTS.SEND_CUSTOM_PARAMETERS,\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_SEND_CUSTOM_PARAMETERS, event.end - event.start)\n    }\n  )\n\n  // Time to forward incoming call\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_FORWARD, [REPORT_EVENTS.FORWARD_CALL], (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_FORWARD, event.end - event.start)\n  })\n\n  // Register the time-to-direct-transfer handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_DIRECT_TRANSFER,\n    [REPORT_EVENTS.DIRECT_TRANSFER],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_DIRECT_TRANSFER, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-consultative-transfer handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_CONSULTATIVE_TRANSFER,\n    [REPORT_EVENTS.CONSULTATIVE_TRANSFER],\n    (report, event) => {\n      callReport.addMetric(REPORT_METRICS.TIME_TO_CONSULTATIVE_TRANSFER, event.end - event.start)\n    }\n  )\n\n  // Register the time-to-join handler\n  callReport.registerMetricHandler(\n    REPORT_METRICS.TIME_TO_JOIN,\n    REPORT_EVENTS.JOIN,\n    joinedCallDurationHandler(REPORT_METRICS.TIME_TO_JOIN, [REPORT_EVENTS.JOIN])\n  )\n\n  // Register the time-to-make-operation handler\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_MAKE, REPORT_EVENTS.MAKE, (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_MAKE, event.end - event.start)\n  })\n\n  // Register the time-to-answer-operation handler\n  callReport.registerMetricHandler(REPORT_METRICS.TIME_TO_ANSWER, REPORT_EVENTS.ANSWER, (report, event) => {\n    callReport.addMetric(REPORT_METRICS.TIME_TO_ANSWER, event.end - event.start)\n  })\n}\n\nexport default {\n  handlers: {\n    durationHandler,\n    joinedCallDurationHandler,\n    relayCandidatesHandler\n  },\n  registerAllMetricHandlers\n}\n","/**\n * Function generator for an SDP handler function that changes the DTLS role of the SDP.\n * @method changeDtlsRoleTo\n * @param  {string} role\n * @param  {Logger} log The Logger for this call.\n * @return {Function} SDP handler.\n */\nexport default function changeDtlsRoleTo(role, log) {\n  return function changeDtlsRole(newSdp, info, originalSdp) {\n    // Grab the original DTLS role for logging purposes.\n    //    Assumed that the DTLS role is the same in every media section.\n    const original = newSdp.media[0].setup\n    log.debug(`Changing SDP DTLS role from ${original} to ${role}.`)\n\n    // Change the DTLS role in every media section.\n    newSdp.media.map(media => {\n      media.setup = role\n      return media\n    })\n\n    return newSdp\n  }\n}\n","/**\n * An SDP handler that adds bandwidth options to the SDP.\n * Supports Chrome & Firefox by generating 2 types of configs:\n *  - 'AS' for Chrome in kilobits per second\n *  - 'TIAS' for Firefox in bits per second\n * @method modifySdpBandwidth\n * @param {BandwidthControls} bandwidthControls\n * @return {Function} SDP handler.\n */\nexport function modifySdpBandwidth(newSdp, info, originalSdp) {\n  /**\n   * Generates bandwidth configs that Chrome & Firefox can recognize.\n   * @param {number} limit The bandwidth limit in kilobits per second.\n   */\n  function generateBandwidthConfigs(limit) {\n    return [\n      {\n        type: 'AS', // Chrome supports this (in kilobits per second)\n        limit\n      },\n      {\n        type: 'TIAS', // Firefox supports this (in bits per second)\n        limit: limit * 1000\n      }\n    ]\n  }\n\n  if (info.bandwidth) {\n    // For more details on bandwidth controls, see here https://webrtchacks.com/limit-webrtc-bandwidth-sdp/.\n\n    if (info.bandwidth.call) {\n      // Set session level bandwidth limit\n      newSdp.bandwidth = generateBandwidthConfigs(info.bandwidth.call)\n    }\n\n    if (info.bandwidth.audio) {\n      // Set audio bandwidth limit\n      newSdp.media\n        .filter(media => media.type === 'audio')\n        .forEach(media => {\n          media.bandwidth = generateBandwidthConfigs(info.bandwidth.audio)\n        })\n    }\n\n    if (info.bandwidth.video) {\n      // Set video bandwidth limit\n      newSdp.media\n        .filter(media => media.type === 'video')\n        .forEach(media => {\n          media.bandwidth = generateBandwidthConfigs(info.bandwidth.video)\n        })\n    }\n  }\n  return newSdp\n}\n","/**\n * SDP handler function that should be passed into session object's `processOffer` and `processAnswer` function.\n * This function disables old media encryption method SDES (Modifies sdp by removing crypto).\n * However, if only SDES is available, don't disable it.\n *\n * @method sanitizeSdesFromSdp\n * @param {Object} newSdp The SDP so far (could have been modified by previous handlers).\n * @param {Object} info Information about the session description.\n * @param {RTCSdpType} info.type The session description's type.\n * @param {string} info.step The step that will occur after the Pipeline is run.\n * @param {string} info.endpoint Which end of the connection created the SDP.\n * @param {Object} originalSdp The SDP in its initial state.\n * @return {Object} The sanitized SDP with crypto removed (if fingerprint exists)\n */\nexport function sanitizeSdesFromSdp(newSdp, info, originalSdp) {\n  for (const mLine of newSdp.media) {\n    if (mLine.crypto && mLine.fingerprint) {\n      delete mLine.crypto\n    }\n  }\n  return newSdp\n}\n","/*\n * SDP Helper Operations available in the Callstack.\n * This file is where the names for the operations are defined.\n */\nimport compareMedia from './media/compareMedia'\nimport runPipeline from './pipeline'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('CallstackSDP.compareMedia', () => compareMedia(bottle.container))\n  bottle.factory('CallstackSDP.runPipeline', () => runPipeline(bottle.container))\n}\n","import summarizeMedia from './summarizeMedia'\nimport { matchMedias, matchMediasNaive } from './matchMedias'\nimport compareSummary from './compareSummary'\nimport { MEDIA_TRANSITIONS } from './constants'\n\n// Libraries.\nimport sdpTransform from 'sdp-transform'\n\n/**\n * Factory function for creating an instance of the compare media sdp function.\n * @method createCompareMedia\n * @param {Object} container\n * @param {Object} container.logManager The SDK's logManager.\n * @return {Function}\n */\nexport default function createCompareMedia(container) {\n  const { logManager } = container\n  /**\n   * Compare two SDPs to determine the differences in their media sections.\n   * The SDPs need to have been created by the same source.\n   * @method compareMedia\n   * @param  {string}  logManager    The log manager.\n   * @param  {string}  prevSdpString A previous SDP.\n   * @param  {string}  sdpString     A new SDP.\n   * @param  {boolean} [isNaive=false] Whether to match media sections naively.\n   * @return {MediaDiff}\n   */\n  function compareMedia(prevSdpString, sdpString, isNaive = false) {\n    // Parse the SDP string into an SDP object for easier handling.\n    const prevSdp = sdpTransform.parse(prevSdpString)\n    const sdp = sdpTransform.parse(sdpString)\n\n    // Take out only the parts of the SDP that we are interested in.\n    //    Each \"media\" relates to a media section of the SDP.\n    const prevMedia = summarizeMedia(logManager, prevSdp)\n    const currMedia = summarizeMedia(logManager, sdp)\n\n    let sortedMedia\n    if (isNaive) {\n      // Match the medias naively, instead of guaranteeing they are\n      //    the same media section.\n      sortedMedia = matchMediasNaive(prevMedia, currMedia)\n    } else {\n      sortedMedia = matchMedias(prevMedia, currMedia)\n    }\n\n    // Media found in the previous SDP but not the latest SDP were removed.\n    const removed = sortedMedia.prevUnmatched\n    // Media found in the latest SDP but not the previous SDP were added.\n    const added = sortedMedia.currUnmatched\n\n    // Media found in both SDPs may have been changed.\n    const changed = []\n    const unchanged = []\n\n    sortedMedia.matched.forEach(({ previous, current }) => {\n      const changes = compareSummary(previous, current)\n\n      if (changes.sending === MEDIA_TRANSITIONS.SAME && changes.receiving === MEDIA_TRANSITIONS.SAME) {\n        // No changes.\n        unchanged.push(previous)\n      } else {\n        // Changes. Include both the media summary and the changes found.\n        /**\n         * Description of how a media line changed, with the latest summary.\n         * @typedef  {Object}       ChangedMedia\n         * @property {MediaSummary} media        The new summary of the media section.\n         * @property {MediaChanges} changes      The changes that occurred to the media.\n         */\n        changed.push({ media: current, changes })\n      }\n    })\n\n    /**\n     * The computed differences of media sections between two SDPs.\n     * @typedef  {Object}              MediaDiff\n     * @property {Array<MediaSummary>} added     Media sections that are new in the latest SDP.\n     * @property {Array<MediaSummary>} removed   Media sections that are missing in the latest SDP.\n     * @property {Array<ChangedMedia>} changed   Media changes between the two SDPs.\n     * @property {Array<MediaSummary>} unchanged Media sections that remained the same.\n     */\n    return {\n      added,\n      removed,\n      changed,\n      unchanged\n    }\n  }\n\n  return compareMedia\n}\n","import { MEDIA_TRANSITIONS } from './constants'\n\n/**\n * Compare two summarized Media section objects to determine how it changed.\n * @method compareSummary\n * @param  {MediaSummary} prevMedia The previous media summary.\n * @param  {MediaSummary} currMedia The current media summary.\n * @return {MediaChanges} How the media directions changed from prevMedia to currMedia.\n */\nexport default function compareSummary(prevMedia, currMedia) {\n  /**\n   * Description of changes to a media line.\n   * @typedef  {Object} MediaChanges\n   * @property {MediaTransition} sending   The change in the media sending data.\n   * @property {MediaTransition} receiving The change in the media receiving data.\n   */\n  const change = {\n    sending: undefined,\n    receiving: undefined\n  }\n\n  if (prevMedia.willSend !== currMedia.willSend) {\n    if (currMedia.willSend) {\n      // Started sending.\n      change.sending = MEDIA_TRANSITIONS.START\n    } else {\n      // Stopped sending.\n      change.sending = MEDIA_TRANSITIONS.STOP\n    }\n  } else {\n    // No change.\n    change.sending = MEDIA_TRANSITIONS.SAME\n  }\n\n  if (prevMedia.willReceive !== currMedia.willReceive) {\n    if (currMedia.willReceive) {\n      // Started receiving.\n      change.receiving = MEDIA_TRANSITIONS.START\n    } else {\n      // Stopped receiving.\n      change.receiving = MEDIA_TRANSITIONS.STOP\n    }\n  } else {\n    // No change.\n    change.receiving = MEDIA_TRANSITIONS.SAME\n  }\n\n  return change\n}\n","export const MEDIA_TRANSITIONS = {\n  START: 'START',\n  STOP: 'STOP',\n  SAME: 'SAME'\n}\n","/**\n * Matches MediaSummary objects between two lists of media.\n *    Finds matches between the lists based on the media's sectionId.\n *    If sectionId is undefined (rare cases), matches based on stream/track Ids.\n * Returns a list of matching medias, and a list of unmatched medias for both\n *    previous and current lists.\n * @method matchMedias\n * @param  {Array<MediaSummary>} prevList List of previous media summaries.\n * @param  {Array<MediaSummary>} currList List of current media summaries.\n * @return {Object} Three lists of matched, prevUnmmatched, and currUnmatched.\n */\nexport function matchMedias(prevList, currList) {\n  // Redeclare these lists so we don't modify the originals.\n  const prev = [...prevList]\n  const curr = [...currList]\n\n  const prevUnmatched = []\n  let currUnmatched = []\n  const matched = []\n\n  // Function for matching a single media object to another object from a list.\n  //    Matches by sectionId.\n  const findMatchingSectionId = function (prevM, mediaList) {\n    return mediaList.findIndex(media => media.sectionId === prevM.sectionId)\n  }\n  // Function for matching a single media object to another object from a list.\n  //    Matches by media/track ID.\n  const findMatchingMediaIds = function (prevM, mediaList) {\n    return mediaList.findIndex(media => {\n      return (\n        // One or both of the sectionIds should be undefined, otherwise we shouldn't\n        //    be matching with the media/track ID.\n        (typeof prevM.sectionId === 'undefined' || typeof media.sectionId === 'undefined') &&\n        prevM.mediaId === media.mediaId &&\n        prevM.trackId === media.trackId\n      )\n    })\n  }\n\n  /*\n   * Step 1:\n   * Iterate over previous medias that have a defined sectionId.\n   *    First try to find a matching current media with a sectionId.\n   *    If none, try to find a matching current media with the same media IDs.\n   *    If still none, then consider the prev media to be unmatched.\n   */\n  prev\n    .filter(m => ['number', 'string'].includes(typeof m.sectionId))\n    .forEach(prevM => {\n      const currIndex = findMatchingSectionId(prevM, curr)\n      if (currIndex >= 0) {\n        // If there's a matching sectionId, add the two medias to the matched list.\n        //    Remove currM from its list to ensure nothing else can match with it.\n        const [currM] = curr.splice(currIndex, 1)\n        matched.push({ previous: prevM, current: currM })\n      } else {\n        const currIndex = findMatchingMediaIds(prevM, curr)\n        if (currIndex >= 0) {\n          // If there's a matching media IDs, add the two medias to the matched list.\n          //    Remove currM from its list to ensure nothing else can match with it.\n          const [currM] = curr.splice(currIndex, 1)\n          matched.push({ previous: prevM, current: currM })\n        } else {\n          // If a match still wasn't found, then consider prevM unmatched.\n          prevUnmatched.push(prevM)\n        }\n      }\n    })\n\n  /*\n   * Step 2:\n   * Iterate over previous medias that do not have a defined sectionId.\n   * Media with sectionIds were given priority since that should be 99% of scenarios.\n   *    Try to find a matching current media with the same media IDs.\n   *    If none, then consider the prev media to be unmatched.\n   */\n  prev\n    .filter(m => typeof m.sectionId === 'undefined')\n    .forEach(prevM => {\n      const currIndex = findMatchingMediaIds(prevM, curr)\n      if (currIndex >= 0) {\n        // If there's a matching media IDs, add the two medias to the matched list.\n        //    Remove currM from its list to ensure nothing else can match with it.\n        const [currM] = curr.splice(currIndex, 1)\n        matched.push({ previous: prevM, current: currM })\n      } else {\n        // If a match wasn't found, then consider prevM unmatched.\n        prevUnmatched.push(prevM)\n      }\n    })\n\n  /*\n   * Step 3:\n   * Consider all remaining medias in the current list to be unmatched.\n   *    All matched currMedia should have been removed from the list when it was matched.\n   */\n  currUnmatched = curr\n\n  return {\n    prevUnmatched,\n    currUnmatched,\n    matched\n  }\n}\n\n/**\n * Matches MediaSummary objects between two lists of media.\n *\n * Matches them based on their index in the lists. That's it.\n * This works under the assumption that the order of the media sections\n *    will never change, which is generally true. This may not be true\n *    in \"non-basic\" media scenarios (ie. more than two media sections)\n *    if a PeerConnection needs to be recreated.\n * This will only work if only comparing SDPs, and not using the\n *    Transceivers that represent the media sections.\n * @method matchMediasNaive\n * @param  {Array<MediaSummary>} prevList List of previous media summaries.\n * @param  {Array<MediaSummary>} currList List of current media summaries.\n * @return {Object} Three lists of matched, prevUnmmatched, and currUnmatched.\n */\nexport function matchMediasNaive(prevList, currList) {\n  // Redeclare these lists so we don't modify the originals.\n  const prev = [...prevList]\n  const curr = [...currList]\n\n  const prevUnmatched = []\n  const currUnmatched = []\n  const matched = []\n\n  const longerLength = prev.length <= curr.length ? curr.length : prev.length\n\n  // Loop enough times to cover which media list is longer.\n  for (let i = 0; i < longerLength; i++) {\n    if (prev[i] === undefined) {\n      // If the prev media at this index is undefined, then the curr\n      //    media at this index is currUnmatched.\n      currUnmatched.push(curr[i])\n    } else if (curr[i] === undefined) {\n      // Same thing other way around.\n      prevUnmatched.push(prev[i])\n    } else {\n      // Else both prev/curr have a media at this index. Match them.\n      matched.push({ previous: prev[i], current: curr[i] })\n    }\n  }\n\n  return {\n    prevUnmatched,\n    currUnmatched,\n    matched\n  }\n}\n","// Constants\nimport { MEDIA_TRANSITIONS } from './constants'\nimport { OPERATIONS } from '../../../interface/constants'\n\n/**\n * Based on a MediaDiff object, determine what the call operation was that\n *    caused the SDP/media change.\n * @method getOperation\n * @param  {MediaDiff} mediaDiff\n * @return {string}\n */\nexport default function getOperation(mediaDiff) {\n  // Naively just check one operation after the other.\n  // TODO: Make this more efficient?\n  // TODO: These MoH checks should take into account current call state.\n  //    Start/Stop MoH should only be possible in specific states.\n  if (wasHold(mediaDiff) || was3xHold(mediaDiff)) {\n    return OPERATIONS.HOLD\n  } else if (wasUnhold(mediaDiff) || was3xUnhold(mediaDiff)) {\n    return OPERATIONS.UNHOLD\n  } else if (wasStartMoh(mediaDiff)) {\n    // Check 'start MoH' before 'add media' because 'start MoH' is a special\n    //    case of 'add media'.\n    return OPERATIONS.START_MOH\n  } else if (wasAddMedia(mediaDiff)) {\n    return OPERATIONS.ADD_MEDIA\n  } else if (wasStopMoh(mediaDiff)) {\n    // Check 'stop MoH' before 'remove media' because 'stop MoH' is a special\n    //    case of 'remove media'.\n    return OPERATIONS.STOP_MOH\n  } else if (wasRemoveMedia(mediaDiff)) {\n    return OPERATIONS.REMOVE_MEDIA\n  } else if (wasNoChange(mediaDiff)) {\n    return 'NO_CHANGE'\n  } else {\n    return 'UNKNOWN'\n  }\n}\n\n/**\n * A \"hold\" operation is when all media lines change to be \"inactive\".\n * Some media may have already been inactive. \"Hold\" is specifically when\n *    all active media becomes inactive, hence there is no longer any media\n *    flowing.\n *\n * This differs from a \"stop MoH\" operation by requiring at least one media to\n *    be \"flowing\" (both sending and receiving) before the operation. For\n *    \"stop MoH\", the media would only be sending (and not receiving) before.\n *\n * In terms of SDP changes, it is defined as:\n *    1) At least one media was 'flowing' before the SDP change.\n *    2) No media is 'flowing' after the SDP change.\n *    3) No active media was added.\n *    4) No media was removed.\n *    5) All media that changed was stopped.\n *        ie. is being \"held\".\n *    6) All media that is unchanged is not sending/receiving.\n *        ie. was already \"held\".\n * @method wasHold\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasHold(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * 1 & 2) Some media was flowing before the change, and no media is flowing\n   *    after the change. This ensures \"hold\" is distinct from \"stop MoH\"\n   *    scenarios.\n   */\n  const stoppedFlowing = hadMediaFlowing(mediaDiff) && !hasMediaFlowing(mediaDiff)\n\n  /*\n   * 3) No active media was added.\n   * For any added media we need to check if it's inactive to determine if this was a hold\n   */\n  const noActiveMediaAdded = !added.some(media => media.willSend || media.willReceive)\n\n  /*\n   * 4) No media was removed\n   */\n  const noMediaRemoved = removed.length === 0\n\n  /*\n   * 5a) Some media did change.\n   */\n  const didChange = changed.length > 0\n\n  /*\n   * 5b) For all media that changed,\n   *    all changes were either `stop` or `remain stopped`.\n   */\n  const allStopped = changed.every(({ media, changes }) => {\n    // This media is not sending.\n    const notSending =\n      changes.sending === MEDIA_TRANSITIONS.STOP || (changes.sending === MEDIA_TRANSITIONS.SAME && !media.willSend)\n    // This media is not receiving.\n    const notReceiving =\n      changes.receiving === MEDIA_TRANSITIONS.STOP ||\n      (changes.receiving === MEDIA_TRANSITIONS.SAME && !media.willReceive)\n\n    return notSending && notReceiving\n  })\n\n  /*\n   * 6) For all media that was not changed,\n   *    no media is being sent/received.\n   */\n  const stillStopped = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return stoppedFlowing && noActiveMediaAdded && noMediaRemoved && didChange && allStopped && stillStopped\n}\n\nexport function wasUnhold(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * 1 & 2) No media was flowing before the change, and some media is flowing\n   *    after the change. This ensures \"unhold\" is distinct from \"start MoH\"\n   *    scenarios.\n   */\n  const startedFlowing = !hadMediaFlowing(mediaDiff) && hasMediaFlowing(mediaDiff)\n\n  /*\n   * 3 & 4) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 6) For all media that was not changed,\n   *    no media is being sent/received.\n   */\n  const noUnchangedSend = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  /*\n   * 5a) Some media did change.\n   */\n  const didChange = changed.length > 0\n\n  /*\n   * 5b) For all media that was changed,\n   *    all changes were either `start` or `remain stopped`.\n   */\n  const onlyStartChanges = changed.every(({ media, changes }) => {\n    const onlyStartSending =\n      changes.sending === MEDIA_TRANSITIONS.START || (changes.sending === MEDIA_TRANSITIONS.SAME && !media.willSend)\n\n    const onlyStartReceiving =\n      changes.receiving === MEDIA_TRANSITIONS.START ||\n      (changes.receiving === MEDIA_TRANSITIONS.SAME && !media.willReceive)\n\n    return onlyStartSending && onlyStartReceiving\n  })\n\n  return startedFlowing && sameMedia && noUnchangedSend && didChange && onlyStartChanges\n}\n\n/**\n * A \"3.X hold\" operation is when a hold operation changes media to `sendonly`\n *    instead of `inactive`. This is what the 3.X SDK and Mobile SDK does. This\n *    is for interop with remote endpoints other than the 4.X SDK.\n *\n * In terms of SDP changes, it is defined as:\n *    1) At least one media was 'flowing' before the SDP change.\n *    2) All changed audio media is now 'sendonly'.\n *        ie. is being \"v3.X held\"\n *       All changed video media is not receiving.\n *    3) No active media was added.\n *    4) No media was removed.\n *    5) All media that is unchanged is not sending/receiving.\n *        ie. was already \"held\".\n *\n * @method was3xUnhold\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function was3xHold(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * 1) Handles when some media was flowing before the change.\n   *  or a special case where media was flowing but assumes media wasn't flowing.\n   * 2) All changed media is now \"sendonly\".\n   *    All changed video media is not receiving.\n   */\n  const wasFlowing = hadMediaFlowing(mediaDiff)\n  const allSendOnly = changed.every(({ media, changes }) => {\n    /**\n     * Possible scenarios:\n     *\n     *  1. Audio-only 3.X Hold:\n     *    - A sendrecv --> A sendonly\n     *\n     *  2. Two way Audio-Video (eg. KAA-2639):\n     *    - A/V sendrecv/sendrecv --> A/V sendonly/inactive\n     *  3. Two way Audio-Video (eg. KAA-2463):\n     *    - A/V sendrecv/sendrecv --> A/V sendonly/sendonly\n     *\n     *  4. Two way Audio, One way receive Video:\n     *    - A/V sendrecv/recvonly --> A/V sendonly/inactive\n     *  5. Two way Audio, One way receive Video:\n     *    - A/V sendrecv/recvonly --> A/V sendonly/sendonly\n     *\n     *  6. Two way Audio, One way send Video:\n     *    - A/V sendrecv/sendonly --> A/V sendonly/inactive\n     *  7. Two way Audio, One way send Video:\n     *    - A/V sendrecv/sendonly --> A/V sendonly/sendonly (video checked by 5) below)\n     *\n     * The summary of these scenarios are:\n     *  - Audio always stops receiving.\n     *  - Audio always continues sending.\n     *  - Video is never receiving afterwards (stop, same).\n     *  - Video sending can be anything (same, start, stop).\n     */\n    if (media.type === 'audio') {\n      // Changed audio always stops being received by the remote endpoint.\n      // Changed audio always continues being sent by the remote endpoint.\n      return changes.receiving === MEDIA_TRANSITIONS.STOP && changes.sending === MEDIA_TRANSITIONS.SAME\n    } else {\n      return (\n        // Changed video is never received afterwards.\n        //     Either stopped or stayed \"not receiving\".\n        changes.receiving === MEDIA_TRANSITIONS.STOP ||\n        (changes.receiving === MEDIA_TRANSITIONS.SAME && media.willReceive === false)\n      )\n    }\n  })\n\n  /*\n   * 3) No active media was added.\n   * For any added media we need to check if it's inactive to determine if this was a hold\n   */\n  const noActiveMediaAdded = !added.some(media => media.willSend || media.willReceive)\n\n  /*\n   * 4) No media was removed\n   */\n  const noMediaRemoved = removed.length === 0\n\n  /*\n   * 5) For all media that was not changed,\n   *      no media is being sent/received,\n   *      or video might still be sendonly.\n   */\n  const noUnchangedSend = unchanged.every(media => {\n    return (\n      (!media.willSend && !media.willReceive) ||\n      // Edge-case: One-way video was being received, and the hold did not\n      //    change the direction but just stopped the video being sent.\n      (media.type === 'video' && media.willSend && !media.willReceive)\n    )\n  })\n\n  return wasFlowing && allSendOnly && noActiveMediaAdded && noMediaRemoved && noUnchangedSend\n}\n\n/**\n * A \"3.X unhold\" operation is when a v3.X SDK performs unhold. This is for\n *    interop.\n *\n * This operation is the same as a \"regular\" unhold, except that media changes\n *    from sendonly instead of inactive.\n *\n * In terms of SDP changes, it is defined as:\n *    1) Some media is flowing afterwards.\n *    2) All media that changed was started receiving.\n *        ie. is being \"3.X unheld\"\n *    3) No media was added.\n *    4) No media was removed.\n *    5) All media that is unchanged is not sending/receiving.\n *        ie. was (and still is) \"held\"\n *\n * @method was3xUnhold\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function was3xUnhold(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * 1) Some media was flowing before the change.\n   * 2) All changed media is now went from \"sendonly\" to \"sendrecv\".\n   */\n  const isFlowing = hasMediaFlowing(mediaDiff)\n  const allSending = changed.every(({ media, changes }) => {\n    return (\n      (changes.sending === MEDIA_TRANSITIONS.SAME && changes.receiving === MEDIA_TRANSITIONS.START) ||\n      /*\n       * Special-case: If the media is video, it's possible to go from \"inactive\" to \"sendrecv\".\n       *    This can happen when the SDK is receiving MoH then is unheld immediately (without\n       *    going through a stop MoH operation).\n       * This behaviour was seen when the remote endpoint was a SIP device. See KAA-2593.\n       */\n      (media.type === 'video' &&\n        changes.sending === MEDIA_TRANSITIONS.START &&\n        changes.receiving === MEDIA_TRANSITIONS.START)\n    )\n  })\n\n  /*\n   * 3) & 4) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 5) For all media that was not changed,\n   *    no media is being sent/received.\n   */\n  const noUnchangedSend = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return isFlowing && allSending && sameMedia && noUnchangedSend\n}\n\n/**\n * An \"add media\" operation is when the latest SDP is sending tracks that the\n *    previous SDP was not sending. This can either be a new, sending media\n *    section or an existing media section that was changed to now send.\n *\n * The \"start MoH\" scenario is a special-case of \"add media\". When one audio\n *    track is added/started, with no media flowing beforehand, then that could\n *    either be a \"start MoH\" or \"add media\" operation. From a webrtc/SDP\n *    viewpoint, they are the same thing in that scenario, so there is no way\n *    to tell them apart using only a MediaDiff object.\n * If both ends of the Call are SDK clients, then \"start MoH\" can only be done\n *    when the Call is on hold (by definition), and \"add media\" can only be\n *    done when the Call is not on hold (requirement set by the API), but we\n *    can't make that assumption.\n *\n * In terms of SDP changes, it is defined as:\n *    1) No media [sections] was removed.\n *    2) Any media added is sending.\n *    3) Any media that changed started sending.\n * @method wasAddMedia\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasAddMedia(mediaDiff) {\n  const { added, removed, changed } = mediaDiff\n\n  /*\n   * 1) No media sections were removed.\n   */\n  const wasntRemoved = removed.length === 0\n\n  /*\n   * 2a & 3a) Something was added or changed.\n   */\n  const somethingStarted = added.length > 0 || changed.length > 0\n\n  /*\n   * 2b) Any media sections added are sending.\n   */\n  const addedSending = added.every(media => media.willSend)\n\n  /*\n   * 3b) Any media that changed was to start sending.\n   */\n  const changedSending = changed.every(({ media, changes }) => {\n    // Should handle:\n    //    reconly  --> sendrecv\n    //    inactive --> sendonly\n    //    inactive --> sendrecv\n    return (\n      changes.sending === MEDIA_TRANSITIONS.START &&\n      (changes.receiving === MEDIA_TRANSITIONS.SAME || changes.receiving === MEDIA_TRANSITIONS.START)\n    )\n  })\n\n  /*\n   * Unchanged media is not checked for.\n   *    By definition, it is the same as before, and could be in any state.\n   */\n\n  return wasntRemoved && somethingStarted && addedSending && changedSending\n}\n\n/**\n * A \"remove media\" operation is when some media sections stop sending (with no\n *    other changes).\n *\n * The \"stop MoH\" scenario is a special-case of \"remove media\". When one audio\n *    track is removed, leaving no media flowing afterwards, then that could\n *    either be a \"stop MoH\" or \"remove media\" operation. From a webrtc/SDP\n *    viewpoint, they are the same thing in that scenario, so there is no way\n *    to tell them apart using only a MediaDiff object.\n * If both ends of the Call are SDK clients, then \"stop MoH\" can only be done\n *    when the Call is on hold (by definition), and \"remove media\" can only be\n *    done when the Call is not on hold (requirement set by the API), but we\n *    can't make that assumption.\n *\n * In terms of SDP changes, it is defined as:\n *    1) No media was added.\n *    2) No media [sections] were removed.\n *    3) Some existing media stopped sending (ie. tracks were removed).\n * @method wasRemoveMedia\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasRemoveMedia(mediaDiff) {\n  const { added, removed, changed } = mediaDiff\n\n  /*\n   * 1 & 2) No media sections were added or removed.\n   */\n  const wasntAdded = added.length === 0\n  const wasntRemoved = removed.length === 0\n\n  /*\n   * 3a) Some media sections changed.\n   */\n  const wasChanged = changed.length > 0\n\n  /*\n   * 3b) For all media sections that changed,\n   *      the only change was to stop sending.\n   */\n  const onlyStopSending = changed.every(({ media, changes }) => {\n    return (\n      changes.sending === MEDIA_TRANSITIONS.STOP &&\n      // Receiving may be SAME or START, depending if the previous media\n      //    direction was sendrecv (SAME) or sendonly (START).\n      // TODO: Update `ChangedMedia` to include the pre-change media summary?\n      changes.receiving !== MEDIA_TRANSITIONS.STOP\n    )\n  })\n\n  /*\n   * Unchanged media is not checked for.\n   *    By definition, it is the same as before, and could in any state.\n   */\n\n  return wasntAdded && wasntRemoved && wasChanged && onlyStopSending\n}\n\n/**\n * A \"start Music on Hold\" operation is when media is currently held, and one\n *    audio media is changed to \"send only\".\n *\n * This checker does not guarantee that it was a \"start MoH\" scenario, and not\n *    a very specific \"add media\" scenario. It is an edge-case, but it is\n *    possible that both sides of the Call removed all media, then one side\n *    adds a single audio track. There is no way to tell the difference with\n *    only a MediaDiff object.\n *\n * In terms of SDP changes, it is defined as:\n *    0) A \"add media\" scenario where:\n *    1) One inactive audio section starts sending.\n *    2) All other media remains unchanged.\n *    3) Any unchanged media is inactive.\n * @method wasStartMoh\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasStartMoh(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  // 0) \"Start MoH\" is a \"add media\" scenario that has extra requirements.\n  if (!wasAddMedia(mediaDiff)) {\n    return false\n  }\n\n  /*\n   * 1) Only one audio line should be changed, to send only.\n   */\n  const onlyAudioChange =\n    // Only one audio line changed.\n    changed.length === 1 &&\n    changed[0].media.type === 'audio' &&\n    // The change was to start sending media.\n    changed[0].changes.sending === MEDIA_TRANSITIONS.START &&\n    // Receiving media remains unchanged; not receiving.\n    changed[0].changes.receiving === MEDIA_TRANSITIONS.SAME &&\n    !changed[0].media.willReceive\n\n  /*\n   * 2) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 3) For all media that is unchanged,\n   *    they are not sending/receiving.\n   */\n  const inactiveUnchanged = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return sameMedia && inactiveUnchanged && onlyAudioChange\n}\n\n/**\n * A \"stop Music on Hold\" operation is when media starts in a MoH state, then\n *    reverts back to an \"on hold\" state.\n *\n * This checker does not guarantee that it was a \"stop MoH\" scenario, and not\n *    a very specific \"remove media\" scenario. It is possible that a Call is\n *    established with one-way audio (and no video), then the audio is removed.\n *    There is no way to tell the difference with only a MediaDiff object.\n *\n * In terms of SDP changes, it is defined as:\n *    0) A \"remove media\" scenario where:\n *    1) One audio section changed stopped sending.\n *    2) All other media remains unchanged.\n *    3) Any unchanged media is inactive.\n * @method wasStopMoh\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasStopMoh(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  // 0) \"Stop MoH\" is a \"remove media\" scenario that has extra requirements.\n  if (!wasRemoveMedia(mediaDiff)) {\n    return false\n  }\n\n  /*\n   * 1) Only one audio line should be changed, from send only to inactive.\n   */\n  const stopSendAudio =\n    // Only one audio line changed.\n    changed.length === 1 &&\n    changed[0].media.type === 'audio' &&\n    // The change was to stop sending media.\n    changed[0].changes.sending === MEDIA_TRANSITIONS.STOP &&\n    // Receiving media remains unchanged; not receiving.\n    changed[0].changes.receiving === MEDIA_TRANSITIONS.SAME &&\n    !changed[0].media.willReceive\n\n  /*\n   * 2) No media was added or removed.\n   */\n  const sameMedia = added.length === 0 && removed.length === 0\n\n  /*\n   * 3) For all media that is unchanged,\n   *    they are not sending/receiving.\n   */\n  const inactiveUnchanged = unchanged.every(media => {\n    return !media.willSend && !media.willReceive\n  })\n\n  return sameMedia && inactiveUnchanged && stopSendAudio\n}\n\n/**\n * A \"no change\" media operation is when all media sections remain the same.\n *    The remote operation was something other than changing media.\n *\n * In terms of SDP comparison, it is defined as:\n *    1) No media sections were added, removed, or changed.\n *    2) Some media remained unchanged.\n * @method wasNoChange\n * @param  {MediaDiff} mediaDiff Media differences described between two SDPs.\n * @return {boolean}\n */\nexport function wasNoChange(mediaDiff) {\n  const { added, removed, changed, unchanged } = mediaDiff\n\n  /*\n   * No media did anything other than `unchanged`.\n   */\n  const noChange = added.length === 0 && removed.length === 0 && changed.length === 0\n\n  /*\n   * ...but there is media in the SDP.\n   */\n  const hasUnchanged = unchanged.length > 0\n\n  return noChange && hasUnchanged\n}\n\n/**\n * Determines whether a MediaDiff object describes the SDP as having had media\n *    flowing (a media both sending and receiving; flowing in both directions)\n *    _before_ the SDP changes.\n * @method hadMediaFlowing\n * @param  {MediaDiff} mediaDiff\n * @return {boolean}   Whether the MediaDiff has media flowing before the change.\n */\nexport function hadMediaFlowing(mediaDiff) {\n  const { removed, changed, unchanged } = mediaDiff\n\n  /*\n   * If any unchanged media is sending and receiving, then media was (and still\n   *    is) flowing before the SDP change.\n   */\n  const unchangedFlowing = unchanged.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * If any changed media was sending and receiving, then media was flowing\n   *    before the SDP change.\n   */\n  const changedFlowing = changed.some(({ media, changes }) => {\n    /*\n     * A changed media was sending before the change if\n     *    1) the change was to stop sending, or\n     *    2) sending didn't change, and is still sending.\n     */\n    const wasSending =\n      changes.sending === MEDIA_TRANSITIONS.STOP || (changes.sending === MEDIA_TRANSITIONS.SAME && media.willSend)\n\n    /*\n     * A changed media was receiving before the change if\n     *    1) the change was to stop receiving, or\n     *    2) receiving didn't change, and is still receiving.\n     */\n    const wasReceiving =\n      changes.receiving === MEDIA_TRANSITIONS.STOP ||\n      (changes.receiving === MEDIA_TRANSITIONS.SAME && media.willReceive)\n\n    return wasSending && wasReceiving\n  })\n\n  /*\n   * If any removed media was sending and receiving, then media was flowing\n   *    before the SDP change.\n   */\n  const removedFlowing = removed.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * Ignore `added` media, since that tells us nothing about media before the\n   *    SDP change.\n   */\n\n  return unchangedFlowing || changedFlowing || removedFlowing\n}\n\n/**\n * Determines whether a MediaDiff object describes the SDP as having media\n *    flowing (a media both sending and receiving; flowing in both directions)\n *    _after_ the SDP changes.\n * @method hasMediaFlowing\n * @param  {MediaDiff} mediaDiff\n * @return {boolean}   Whether the MediaDiff has media flowing after the change.\n */\nexport function hasMediaFlowing(mediaDiff) {\n  const { added, changed, unchanged } = mediaDiff\n\n  /*\n   * If any unchanged media is sending and receiving, then media is (and was)\n   *    flowing after the SDP change.\n   */\n  const unchangedFlowing = unchanged.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * If any changed media is sending and receiving, then media is flowing\n   *    after the SDP change.\n   */\n  const changedFlowing = changed.some(({ media, changes }) => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * If any added media is sending and receiving, then media is flowing\n   *    after the SDP change.\n   */\n  const addedFlowing = added.some(media => {\n    return media.willSend && media.willReceive\n  })\n\n  /*\n   * Ignore `removed` media, since that tells us nothing about media after the\n   *    SDP change.\n   */\n\n  return unchangedFlowing || changedFlowing || addedFlowing\n}\n","// Callstack plugin.\nimport { was3xHold, was3xUnhold } from './operations'\n\n// Call plugin.\nimport { OPERATIONS } from '../../../interface/constants'\n\n/**\n * Get the remote tracks of a Session that are affected by a remote operation.\n * @param {string} operation The remote operation type.\n * @param {MediaDiff} mediaDiff The difference between the SDP's media sections before/after the operation.\n * @param {Sesison} session A WebRTC-stack Session object.\n * @return {Array<string>} List of track IDs.\n */\nexport default async function getAffectedRemoteTracks(operation, mediaDiff, session) {\n  /*\n   * If a media section was removed, then this is not a normal WebRTC negotiation. This\n   *    is likely a complex operation where the PeerConnection was recreated. Calls are\n   *    always on hold when a PeerConnection is recreated, so all remote tracks should\n   *    be considered as \"added\".\n   * The media sections of the SDP may not have IDs, which is another reason to simply\n   *    \"get all\".\n   */\n  if (mediaDiff.removed.length > 0) {\n    const affectedTracks = await getAllRemoteTracks(session)\n    return affectedTracks\n  }\n\n  let sectionIds\n  switch (operation) {\n    case OPERATIONS.ADD_MEDIA:\n    case OPERATIONS.START_MOH:\n      sectionIds = getAddedSectionIds(mediaDiff)\n      break\n    case OPERATIONS.REMOVE_MEDIA:\n    case OPERATIONS.STOP_MOH:\n      sectionIds = getRemovedSectionIds(mediaDiff)\n      break\n    case OPERATIONS.HOLD:\n      sectionIds = was3xHold(mediaDiff) ? get3xHeldSectionIds(mediaDiff) : getHeldSectionIds(mediaDiff)\n      break\n    case OPERATIONS.UNHOLD:\n      sectionIds = was3xUnhold(mediaDiff) ? get3xUnheldSectionIds(mediaDiff) : getUnheldSectionIds(mediaDiff)\n      break\n    default:\n      // What do?\n      sectionIds = []\n  }\n\n  const affectedTracks = await session.getRemoteTrackIdsFromTransceivers(sectionIds)\n\n  return affectedTracks\n}\n\n/**\n * Get the media sections of an SDP where media was remobed by a remote \"hold\"\n *    SDK operation.\n * @param {MediaDiff} mediaDiff\n * @return {Array<string>} List of media section IDs.\n */\nfunction getHeldSectionIds(mediaDiff) {\n  const heldSections = []\n  mediaDiff.changed.forEach(changedMedia => {\n    const { media, changes } = changedMedia\n    // We know this was a hold operation, so we only need to check that the\n    //    media section stopped sending media to know that a track was removed here.\n    if (changes.sending === 'STOP') {\n      const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n      heldSections.push(id)\n    }\n  })\n  return heldSections\n}\n\n/**\n * Get the media sections of an SDP where media was remobed by a remote \"hold\"\n *    SDK operation. This function covers the special cases for interop with 3.x/Mobile.\n *    Refer to `was3xHold` function for more details.\n * @param {MediaDiff} mediaDiff\n * @return {Array<string>} List of media section IDs.\n */\nfunction get3xHeldSectionIds(mediaDiff) {\n  const heldSections = []\n  mediaDiff.changed.forEach(changedMedia => {\n    const { media, changes } = changedMedia\n    if (media.type === 'audio') {\n      // Changed audio always stops being received by the remote endpoint.\n      // Changed audio always continues being sent by the remote endpoint.\n      if (changes.receiving === 'STOP' && changes.sending === 'SAME') {\n        const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n        heldSections.push(id)\n      }\n    } else {\n      // Changed video is never received afterwards.\n      //     Either stopped or stayed \"not receiving\".\n      if (changes.receiving === 'STOP' || (changes.receiving === 'SAME' && media.willReceive === false)) {\n        const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n        heldSections.push(id)\n      }\n    }\n  })\n\n  // Edge-case: One-way video was being received, and the hold did not\n  //    change the direction but just stopped the video being sent.\n  mediaDiff.unchanged.forEach(media => {\n    if (media.type === 'video' && media.willSend && !media.willReceive) {\n      const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n      heldSections.push(id)\n    }\n  })\n\n  return heldSections\n}\n\n/**\n * Get the media sections of an SDP where media was added by a remote \"unhold\"\n *    SDK operation.\n * @param {MediaDiff} mediaDiff\n * @return {Array<string>} List of media section IDs.\n */\nfunction getUnheldSectionIds(mediaDiff) {\n  const unheldSections = []\n  mediaDiff.changed.forEach(changedMedia => {\n    const { media, changes } = changedMedia\n    // We know this was an unhold operation, so we only need to check that the\n    //    media section started sending media to know that a track was added here.\n    if (changes.sending === 'START') {\n      const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n      unheldSections.push(id)\n    }\n  })\n  return unheldSections\n}\n\n/**\n * Get the media sections of an SDP where media was added by a remote \"unhold\"\n *    SDK operation. This function covers the special cases for interop with 3.x/Mobile.\n *    Refer to `was3xUnhold` function for more details.\n * @param {MediaDiff} mediaDiff\n * @return {Array<string>} List of media section IDs.\n */\nfunction get3xUnheldSectionIds(mediaDiff) {\n  const unheldSections = []\n  // Special cases for 3.x/Mobile; refer to `was3xUnhold` function for more details.\n  //    Summary: all changed media went from 'sendonly' to 'sendrecv'\n  mediaDiff.changed.forEach(({ media, changes }) => {\n    if (\n      (changes.sending === 'SAME' && changes.receiving === 'START') ||\n      /*\n       * Special-case: If the media is video, it's possible to go from \"inactive\" to \"sendrecv\".\n       *    This can happen when the SDK is receiving MoH then is unheld immediately (without\n       *    going through a stop MoH operation).\n       * This behaviour was seen when the remote endpoint was a SIP device. See KAA-2593.\n       */\n      (media.type === 'video' && changes.sending === 'START' && changes.receiving === 'START')\n    ) {\n      const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n      unheldSections.push(id)\n    }\n  })\n  return unheldSections\n}\n\n/**\n * Get the media sections of an SDP where media was added by a remote \"add media\"\n *    SDK operation.\n * @param {MediaDiff} mediaDiff\n * @return {Array<string>} List of media section IDs.\n */\nfunction getAddedSectionIds(mediaDiff) {\n  let addedMediaSections = []\n  mediaDiff.changed.forEach(changedMedia => {\n    const { media, changes } = changedMedia\n    // This ChangedMedia object represents a \"track added\".\n    if (changes.sending === 'START' && (changes.receiving === 'SAME' || changes.receiving === 'START')) {\n      const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n      addedMediaSections.push(id)\n    }\n  })\n\n  // For the Transceiver for newly added media sections to exist, the SDK has to\n  //    have handled the remote offer at the WebRTC-layer already.\n  const newSectionsWithTracks = mediaDiff.added\n    .filter(mediaSummary => mediaSummary.willSend)\n    .map(mediaSummary => {\n      // If the sectionId is undefined, return the index instead.\n      // The order of media sections (their index) /should/ never change.\n      return typeof mediaSummary.sectionId === 'undefined' ? mediaSummary.sectionIndex : mediaSummary.sectionId\n    })\n\n  addedMediaSections = addedMediaSections.concat(newSectionsWithTracks)\n\n  return addedMediaSections\n}\n\n/**\n * Get the media sections of an SDP where media was removed by a remote \"remove media\"\n *    SDK operation.\n * @param {MediaDiff} mediaDiff\n * @return {Array<string>} List of media section IDs.\n */\nfunction getRemovedSectionIds(mediaDiff) {\n  // Get the list of media section Ids that media was removed from.\n  const removedMediaSections = []\n  mediaDiff.changed.forEach(changedMedia => {\n    const { media, changes } = changedMedia\n    // This ChangedMedia object represents a \"track removed\".\n    if (changes.sending === 'STOP' && changes.receiving !== 'STOP') {\n      const id = typeof media.sectionId === 'undefined' ? media.sectionIndex : media.sectionId\n      removedMediaSections.push(id)\n    }\n  })\n\n  return removedMediaSections\n}\n\n/**\n * Get the list of all remote tracks currently being received for a Session.\n * @param {Session} session A WebRTC-stack Session object.\n * @return {Array<string>} List of remote track IDs.\n */\nexport async function getAllRemoteTracks(session) {\n  const affectedTracks = await session.getActiveRemoteTrackIds()\n  return affectedTracks\n}\n\n/**\n * Get the list of all incoming remote tracks not yet being received for a Session.\n * @param {Session} session A WebRTC-stack Session object.\n * @return {Array<string>} List of remote track IDs.\n */\nexport async function getIncomingRemoteTracks(session) {\n  const incomingTracks = await session.getIncomingRemoteTrackIds()\n  return incomingTracks\n}\n","/**\n * Reduce the media information in the SDP to only what we will use.\n * The SDP object provided as input is assumed to use standard values.\n *\n * Only supports SDPs where there is only one track per media section.\n *    eg. Unified-Plan (?).\n *\n * @method summarizeMedia\n * @param  {Object} sdp The full SDP object.\n * @param  {Object} logManager The log manager.\n * @return {Array<MediaSummary>} Summarized media sections from the SDP.\n */\nexport default function summarizeMedia(logManager, sdp) {\n  const log = logManager.getLogger('SDP')\n  const sdpMedia = []\n  sdp.media.forEach((media, index) => {\n    /*\n     * Generate/Find a unique ID for this media section. This will be used to\n     *    compare against another SDP's media sections to find matching\n     *    sections.\n     */\n    const sectionId = media.mid\n    // In case the sectionId is undefined, take note of the index of the media section.\n    const sectionIndex = index\n\n    if (media.ssrcGroups && media.ssrcGroups.length > 1) {\n      /*\n       * All of the logic in this file assumes that a media section only has 1\n       *    track. If there are more than one, it means that we are using\n       *    a plan other then Unified-Plan (e.g. A plan with more than 1 track of the same media type), which is not\n       *    something that we want to support.\n       */\n      log.debug(`Media section contains multiple ssrc groups. Summary for ${sectionId} will be wrong.`)\n    }\n\n    // If the media section doesn't have a direction, then use the session-level direction.\n    const mediaDirection = media.direction || sdp.direction\n\n    // Whether this media section is sending and/or receiving.\n    let willSend\n    let willReceive\n\n    if (mediaDirection) {\n      willSend = mediaDirection.includes('send')\n      willReceive = mediaDirection.includes('recv')\n    } else {\n      // If there is no media direction attribute at both the media-level and\n      //    session-level, then it is to be assumed the direction is \"sendrecv\".\n      // Ref: RFC 4566, page 26: https://tools.ietf.org/html/rfc4566\n      willSend = true\n      willReceive = true\n    }\n\n    let mediaId, trackId\n    /*\n     * If the media section is sending, then it has information about the track\n     *    that it is sending.\n     *\n     * Note: The media section will never have information about a track it is\n     *    receiving (ie. willReceive), because the SDP only describes the\n     *    \"local\" PeerConnection's situation.\n     */\n    if (willSend) {\n      /**\n       * The SDP should either have a `msid` property (a=msid line) or `ssrc`\n       *    lines with the same information (`a=ssrc:... label:...` and\n       *    `a=ssrc:... mslabel:...`).\n       * If it has nethier, then the SDP says it wants to send a track, but it\n       *    has no track to send.\n       */\n      if (media.msid) {\n        ;[mediaId, trackId] = media.msid.split(' ')\n      } else if (media.ssrcs) {\n        mediaId = media.ssrcs.find(ssrc => ssrc.attribute === 'mslabel').value\n        trackId = media.ssrcs.find(ssrc => ssrc.attribute === 'label').value\n      }\n    } else {\n      // This media section is not sending a track, so there is no information.\n      mediaId = undefined\n      trackId = undefined\n    }\n\n    /**\n     * Summarized information about a media section from an SDP.\n     * @typedef  {Object}  MediaSummary\n     * @property {string}  sectionId    A unique identifier for the media section.\n     * @property {string}  sectionIndex The index of the media section in the SDP.\n     * @property {string}  type         The type of media line.\n     * @property {boolean} willSend     Whether the media will send data.\n     * @property {boolean} willReceive  Whether the media will receive data.\n     * @property {string}  mediaId      The MediaStream ID of the media.\n     * @property {string}  trackId      The MediaStreamTrack ID of the media.\n     */\n    const summary = {\n      sectionId,\n      sectionIndex,\n      type: media.type,\n      willSend,\n      willReceive,\n      mediaId,\n      trackId\n    }\n\n    sdpMedia.push(summary)\n  })\n  return sdpMedia\n}\n","// Pipeline modes.\nimport runPipelineDefault from './runDefault'\nimport runPipelineYaml from './runYaml'\n\n// Libraries.\nimport { logLevels } from 'kandy-logger'\n\n/**\n * Factory function for creating an instance of the SDP Pipeline.\n * @param {Object} container\n * @param {Object} container.logManager The SDK's logManager.\n * @return {Function}\n */\nexport default function createPipeline(container) {\n  const { logManager } = container\n  const log = logManager.getLogger('SDP')\n\n  /**\n   * Basic SDP pipeline runner. Decides how to log the output based on log level.\n   * @method runPipeline\n   * @param  {Array}      handlers       List of functions that transform the SDP.\n   * @param  {string}     sdp            The session description.\n   * @param  {Object}     info           Information about the session description.\n   * @param  {string}     info.callId    The id corresponding to the call on which this pipeline is being run.\n   * @param  {RTCSdpType} info.type      The session description's type.\n   * @param  {string}     info.step      The step that will occur after the Pipeline is run.\n   *    Will be either 'set' (the SDP will be set locally) or 'send' (the SDP will be sent\n   *    to the remote endpoint).\n   * @param  {string}     info.endpoint  Which end of the connection created the SDP.\n   * @param  {BandwidthControls} [info.bandwidth] Information about bandwidth controls.\n   * @return {string}     The modified session description.\n   */\n  function runPipeline(handlers, sdp, info) {\n    const logLevel = log.getLevel()\n    const isDebug = logLevel === logLevels.DEBUG || logLevel === logLevels.TRACE\n    const pipelineFunc = isDebug ? runPipelineYaml : runPipelineDefault\n\n    return pipelineFunc(handlers, sdp, info, log)\n  }\n\n  return runPipeline\n}\n","// Utils.\nimport { formattedFunctionName } from './utils'\n\n// Libraries.\nimport sdpTransform from 'sdp-transform'\nimport { cloneDeep, isArray, isFunction } from 'lodash/fp'\n\n/**\n * Basic SDP pipeline runner.\n * See parameters for runPipeline in index for full description of them.\n * @method runPipelineYaml\n * @param  {Array}  handlers List of functions that transform the SDP.\n * @param  {string} sdp      The session description.\n * @param  {Object} info     Information about the session description.\n * @param  {Logger} log      The logger to use.\n * @return {string}          The modified session description.\n */\nexport default function runPipelineDefault(handlers, sdp, info, log) {\n  const objectSdp = sdpTransform.parse(sdp)\n\n  const originalSdp = Object.freeze(objectSdp)\n  let newSdp = cloneDeep(originalSdp)\n\n  if (isArray(handlers)) {\n    handlers.forEach(handler => {\n      const name = formattedFunctionName(handler)\n\n      if (isFunction(handler)) {\n        try {\n          newSdp = handler(newSdp, info, originalSdp)\n        } catch (error) {\n          log.info(\n            `Currently running pipeline to ${info.step} ${info.endpoint} ${info.type} for callId: ${info.callId}`\n          )\n          log.error(`Error running SDP handler: ${name}`, error)\n        }\n      } else {\n        log.error('SDP handler not a function; skipping.')\n      }\n    })\n  }\n\n  return sdpTransform.write(newSdp)\n}\n","// Utils.\nimport { formattedFunctionName, sdpToYaml } from './utils'\n\n// Libraries.\nimport sdpTransform from 'sdp-transform'\nimport { cloneDeep, isArray, isFunction } from 'lodash/fp'\nimport diff from 'variable-diff'\n\n/**\n * Basic SDP pipeline runner that logs the functions in Yaml.\n * See parameters for runPipeline in index for full description of them.\n * @method runPipelineYaml\n * @param  {Array}  handlers List of functions that transform the SDP.\n * @param  {string} sdp      The session description.\n * @param  {Object} info     Information about the session description.\n * @param  {Logger} log      The logger to use.\n * @return {string}          The modified session description.\n */\nexport default function runPipelineYaml(handlers, sdp, info, log) {\n  const objectSdp = sdpTransform.parse(sdp)\n\n  if (!isArray(handlers)) {\n    return sdpTransform.write(objectSdp)\n  }\n\n  const originalSdp = Object.freeze(objectSdp)\n  let newSdp = cloneDeep(originalSdp)\n\n  /**\n   * For each sdpHandler function we want to log the changes\n   * it makes to the SDP and present a yaml report of the diffs.\n   * So that each diff doesn't contain all previous changes\n   * we need to diff the sdp at it's current stage of transformation.\n   * Only perform this work if we're in debug logging mode.\n   */\n  let diffed\n  let oldNewSdp\n  const results = []\n\n  handlers.forEach(handler => {\n    const name = formattedFunctionName(handler)\n\n    if (isFunction(handler)) {\n      log.debug(`Running SDP handler ${name}.`)\n\n      try {\n        oldNewSdp = cloneDeep(newSdp)\n        newSdp = handler(newSdp, info, originalSdp)\n        diffed = diff(oldNewSdp, newSdp)\n        results.push({ name, diff: diffed.text })\n      } catch (error) {\n        log.info(`Currently running pipeline to ${info.step} ${info.endpoint} ${info.type} for callId: ${info.callId}`)\n        log.error(`Error running SDP handler: ${name}`, error)\n      }\n    } else {\n      log.error('SDP handler not a function; skipping.')\n      results.push({ name, diff: 'No diff, not a function.' })\n    }\n  })\n\n  diffed = diff(originalSdp, newSdp)\n  const yamlFormat = sdpToYaml(info)(originalSdp)(newSdp)(results)(diffed)\n  log.debug(`SDP Handler changes: ${yamlFormat}`)\n\n  return sdpTransform.write(newSdp)\n}\n","// Library.\nimport sdpTransform from 'sdp-transform'\nimport { compose, join, map, trimCharsStart, trimEnd } from 'lodash/fp'\n\n// Refers to functions in src/callstack/sdp/pipeline.js\nexport const sdpToYaml = info => originalSdp => newSdp => results => finalDiffObject =>\n  `\n---\nsdp-pipeline-run:\n  info:\n    callId: ${info.callId}\n    type: ${info.type}\n    step: ${info.step}\n    endpoint: ${info.endpoint}\n    bandwidth: ${displayBandwidth(info.bandwidth)}\n  sdp: |\n    ${displaySdp(fourSpaces)(originalSdp)}\n  handlers:\n    ${displayHandlers(results)}\n  final:\n    diff: |\n      ${displayDiffs(sixSpaces)(finalDiffObject.text)}\n    sdp: |\n      ${finalDiffObject.changed ? displaySdp(sixSpaces)(newSdp) : 'No changes to the SDP'}\n...\n`\n\n// If the function is anonymous give the function body as the 'name'\nexport const formattedFunctionName = handler => handler.name || handler.toString().slice(0, 120).replace(/\\n/g, '')\n\n// Display helper functions\nconst displayBandwidth = bandwidth =>\n  bandwidth && JSON.stringify(bandwidth, null, ' ').replace(/\\n/g, ' ').replace(/ {2}/g, ' ')\n\nconst displaySdp = indentation => sdp => sdpTransform.write(sdp).replace(/\\n/g, `\\n${indentation}`).trimEnd()\n\nconst handlerToYaml = ({ name, diff }) =>\n  // replacing newlines in case the name is the function.\n  `${fourSpaces}- name: ${name.replace(/\\n/g, '')}\n      diff: |\n        ${displayDiffs(eightSpaces)(diff)}\n`\n\nconst displayHandlers = compose([trimEnd, trimCharsStart(' \\n'), join(''), map(handlerToYaml)])\n\nconst displayDiffs = indentation => diffed => (diffed ? diffed.replace(/\\n/g, `\\n${indentation}`) : 'No changes found')\n\n// Space constants\nconst fourSpaces = '    '\nconst sixSpaces = '      '\nconst eightSpaces = '        '\n","// Libraries\nimport sdpTransform from 'sdp-transform'\n\n/**\n * Helper function that returns a boolean if media is active or not.\n * @method hasMediaFlowing\n * @param  {string} sdp String representation of a calls sdp.\n */\nexport default function hasMediaFlowing(sdp) {\n  const objectSdp = sdpTransform.parse(sdp)\n\n  // Check that video directions (if there are any) indicate a \"hold\" scenario.\n  const isVideoInactive = objectSdp.media\n    .filter(item => item.type === 'video')\n    .every(media => media && media.direction === 'inactive')\n\n  // Check that audio directions (if there are any) indicate a \"hold\" scenario.\n  const isAudioInactive = objectSdp.media\n    .filter(item => item.type === 'audio')\n    // Special case: In music on hold scenarios, audio may be `sendonly`\n    //    so that the held user can still receive the \"hold music\".\n    .every(media => media && ['inactive', 'sendonly'].includes(media.direction))\n\n  return !isVideoInactive || !isAudioInactive\n}\n","// Libraries.\nimport sdpTransform from 'sdp-transform'\n\n/**\n * Checks whether an SDP has at least one telephone-event codec.\n *\n * TODO: If there isn't a telephone-event, then the PeerConnection won't have\n *    a \"dtmf sender\" (RTCRtpSender.dtmf). Should preferably check for that\n *    rather than looking through the SDP.\n * This isn't being done because the Session/Peer models wrap \"send dtmf\" in a\n *    way that makes it inconvenient to use.\n *\n * @method hasTelephoneEvent\n * @param  {string}  stringSdp An SDP.\n * @return {boolean}\n */\nexport default function hasTelephoneEvent(stringSdp) {\n  const sdp = sdpTransform.parse(stringSdp)\n\n  const hasCodec = sdp.media\n    .filter(media => media.type === 'audio')\n    .some(media => {\n      return media.rtp.some(rtp => rtp.codec === 'telephone-event')\n    })\n\n  return hasCodec\n}\n","export default function setMediaInactive(sdp) {\n  const regex = /sendrecv|sendonly|recvonly/gi\n  if (!sdp || typeof sdp !== 'string') {\n    return\n  }\n\n  return sdp.replace(regex, 'inactive')\n}\n","// Call plugin\nimport { getCallById } from '../../interface/selectors'\nimport { callActions } from '../../interface/actions'\nimport * as eventTypes from '../../interface/eventTypes'\nimport { OPERATIONS } from '../../interface/constants'\n\n// Other plugins\nimport { getTrackById } from '../../../webrtc/interface/selectors'\n\n// Libraries\nimport { without } from 'lodash/fp'\n\n/**\n * Helper function to get all local tracks of a certain type\n *\n * @param {Object} context The bottle context object.\n * @param {string} id The id of the call\n * @param {string} [kind] Kind must be of type 'audio' or 'video'\n * @return {Array<Object>} returns an array of tracks of the given type\n */\nexport function getLocalTracks(context, id, kind) {\n  // TODO: Why is `context` passed-in if only state is needed?\n  const call = getCallById(context.getState(), id)\n  const localTracks = call ? call.localTracks : []\n  const tracks = localTracks.map(id => getTrackById(context.getState(), id))\n  return kind ? tracks.filter(track => track.kind === kind) : tracks\n}\n\nfunction getNewRemoteTracks(action, prevState, currentState) {\n  // Get the list of remote tracks previously on the call.\n  const prevCall = getCallById(prevState, action.payload.id)\n  const { remoteTracks: prevRemote } = prevCall\n\n  // Get the list of NEW remote tracks actually added to the Call by the operation.\n  // In early media scenarios, there will be a duplicate remote track.\n  const { localTracks = [], remoteTracks = [] } = action.payload\n  const newRemote = without(prevRemote, remoteTracks)\n\n  const trackIds = [...localTracks, ...newRemote]\n\n  // Don't emit the event if no tracks were actually added.\n  // For example, when entering dual hold.\n  if (!trackIds || trackIds.length === 0) {\n    return undefined\n  }\n\n  return trackIds\n}\n\n/**\n * @typedef {Object} ActionEventMap\n * @property {function} callAction A redux action creator\n * @property {Array} eventFns An array of event creator functions\n */\n/**\n * Helper function that returns a call action function and events based on the\n * remote operation being requested\n * TODO: Move this somewhere better.\n * TODO: Do this differently / better.\n * @method getCallAction\n * @param (string) remoteOp Remote operation being requested\n * @returns {ActionEventMap} Action and event creator functions.\n */\nexport function getCallAction(remoteOp) {\n  // Determine what redux action the operation represents.\n  switch (remoteOp) {\n    case OPERATIONS.SLOW_START:\n      return {\n        callAction: callActions.remoteSlowStart,\n        eventFns: []\n      }\n  }\n\n  return {\n    // The \"generic remote\" operation has been split-out. To be removed.\n    callAction: callActions.updateCall,\n    eventFns: []\n  }\n}\n\nexport function getLocalOpTrackEvents(callId, operation, action, prevState, currState) {\n  switch (operation) {\n    case OPERATIONS.HOLD:\n    case OPERATIONS.REMOVE_MEDIA:\n    case OPERATIONS.REMOVE_BASIC_MEDIA: {\n      const trackIds = []\n      if (action.payload.localTracks) {\n        trackIds.push(...action.payload.localTracks)\n      }\n      if (action.payload.remoteTracks) {\n        trackIds.push(...action.payload.remoteTracks)\n      }\n      if (trackIds.length) {\n        return {\n          type: eventTypes.CALL_TRACKS_REMOVED,\n          args: { callId, trackIds }\n        }\n      }\n      return\n    }\n    case OPERATIONS.UNHOLD:\n    case OPERATIONS.ADD_MEDIA:\n    case OPERATIONS.ADD_BASIC_MEDIA: {\n      const trackIds = getNewRemoteTracks(action, prevState, currState)\n      if (trackIds) {\n        return {\n          type: eventTypes.CALL_TRACKS_ADDED,\n          args: { callId, trackIds }\n        }\n      }\n      return\n    }\n    case OPERATIONS.MEDIA_RESTART: {\n      return {\n        type: eventTypes.MEDIA_RESTART,\n        args: { callId }\n      }\n    }\n  }\n}\n\n/**\n * Generates extra informational parameters for ending a call.\n *\n * @method generateEndParams\n * @param {string}  currentCallState The state of the current call, before it was ended.\n * @param {boolean} isLocal Specifies if end operation was caused by the local side.\n * @param {Object}  params Extra context information related to the call.\n * @param {string}  [params.reasonText]  Human-readable explanation for the call change.\n * @param {string}  [params.statusCode] Code representing the reason for the call change.\n * @param {string}  params.remoteName   Name of the remote participant.\n * @param {string}  params.remoteNumber Number of the remote participant.\n */\nexport function generateEndParams(currentCallState, isLocal, params) {\n  const endParams = {\n    isLocal,\n    remoteParticipant: {\n      displayNumber: params.remoteNumber,\n      displayName: params.remoteName\n    },\n    transition: {\n      prevState: currentCallState\n    }\n  }\n  if (params.statusCode) {\n    endParams.transition.statusCode = params.statusCode\n  }\n  if (params.reasonText) {\n    endParams.transition.reasonText = params.reasonText\n  }\n  return endParams\n}\n\n/**\n * Maps media tracks with the dscpControls provided to ensure the correct senders are set up with the\n * proper networkPriority\n * @param {Object} trackLists\n * @param {Array<Track>} trackLists.audio The list of audio tracks\n * @param {Array<Track>} trackLists.video The list of video tracks\n * @param {Array<Track>} trackLists.screen The list of screen tracks\n * @param {Object} dscpControls The DSCP controls provided\n * @return {Object} An object map of track: dscpSetting for all applicable tracks\n */\nexport function getTrackDscpMapping(trackLists, dscpControls) {\n  const { audio: audioTracks, video: videoTracks, screen: screenTracks } = trackLists\n\n  const dscpTrackMapping = {}\n  if (dscpControls) {\n    if (dscpControls.screenNetworkPriority) {\n      for (const screenTrack of screenTracks) {\n        dscpTrackMapping[screenTrack.id] = dscpControls.screenNetworkPriority\n      }\n    }\n    if (dscpControls.audioNetworkPriority) {\n      for (const audioTrack of audioTracks) {\n        dscpTrackMapping[audioTrack.id] = dscpControls.audioNetworkPriority\n      }\n    }\n    if (dscpControls.videoNetworkPriority) {\n      for (const videoTrack of videoTracks) {\n        dscpTrackMapping[videoTrack.id] = dscpControls.videoNetworkPriority\n      }\n    }\n  }\n\n  return dscpTrackMapping\n}\n\n/**\n * Checks whether the bandwidth controls provided exist and are numbers.\n * @param {BandwidthControls} bandwidthControls The bandwidth controls to check.\n */\nexport function checkBandwidthControls(bandwidthControls) {\n  // TODO: Is this function needed for anything other than ensuring\n  //    the bandwidth object has the \"right\" format? Is that even needed?\n  const finalBandwidthControls = { ...bandwidthControls }\n\n  // If there are no bandwidth limits set or the bandwidth limits provided are not numbers, set them to undefined\n  if (!bandwidthControls || !(bandwidthControls.audio && typeof bandwidthControls.audio === 'number')) {\n    finalBandwidthControls.audio = null\n  }\n  if (!bandwidthControls || !(bandwidthControls.video && typeof bandwidthControls.video === 'number')) {\n    finalBandwidthControls.video = null\n  }\n  return finalBandwidthControls\n}\n","/*\n * Utility helpers available in the Callstack.\n * This file is where the names for the operations are defined.\n */\nimport createGetOperation from './remoteOperation'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('Callstack.utils.getRemoteOperationInfo', () => createGetOperation(bottle.container))\n}\n","/**\n * Organize the return value of `mediaOps.createLocal` into lists of Tracks for\n *    each media kind.\n *\n * TODO: Simplify `mediaOps.createLocal` so we don't need a helper for it...\n * @method organizeTracks\n * @async\n * @param {Array<Object>} mediaObj\n * @param {string} mediaObj[].type The kind of media.\n * @param {Object} mediaObj[].media A Webrtc-Stack Media object.\n * @return {Object} tracks\n * @return {Array<Track>} tracks.audio The list of all audio Track objects.\n * @return {Array<Track>} tracks.video The list of all video Track objects.\n * @return {Array<Track>} tracks.screen The list of all screen Track objects.\n * @return {Array<Track>} tracks.all The list of all Track objects.\n * @example\n * const medias = [{ type: 'audio', media: media1 }, { type: 'video', media: media2 }]\n * const tracks = await organizeTracks(medias)\n * // tracks = {\n * //   audio: [<tracks of media1>],\n * //   video: [<tracks of media2>],\n * //   screen: [],\n * //   all: [<tracks of media1 and media2>]\n * // }\n */\nexport async function organizeTracks(medias = []) {\n  const trackLists = {\n    audio: [],\n    video: [],\n    screen: [],\n    all: []\n  }\n\n  await Promise.all(\n    medias.map(async obj => {\n      if (['audio', 'video', 'screen'].includes(obj.type)) {\n        // This is async when in Proxy mode, so use await (and the Promise.all).\n        const tracks = await obj.media.getTracks()\n        // Add the tracks of the Media object into the appropriate track list.\n        trackLists[obj.type] = trackLists[obj.type].concat(tracks)\n        // Also add the tracks to the \"all\" list.\n        trackLists.all = trackLists.all.concat(tracks)\n      } else {\n        // Invalid media kind was provided; ignore it.\n      }\n    })\n  )\n\n  return trackLists\n}\n","import getOperation from '../../sdp/media/operations'\nimport hasMediaFlowing from '../../sdp/utils/hasMediaFlowing'\n\nimport { getMediaState } from '../../../utils/state'\n\nimport { CALL_MEDIA_STATES } from '../../../constants'\nimport { OPERATIONS } from '../../../interface/constants'\n\nexport default function factory(container) {\n  const { CallstackSDP, logManager, WebRTC } = container\n\n  /**\n   * Utility method to analyze the remote operation.\n   *    Compares the previous remote SDP with the newly received remote SDP to\n   *    determine the operation type.\n   *\n   * @method getRemoteOperationInfo\n   * @param {Object} call The call being acted on.\n   * @param {string} sdp A remote offer SDP.\n   * @return {Object} info\n   * @return {string} info.remoteOp The interpreted remote operation type.\n   * @return {Object} info.mediaDiff The change between last media state versus new state.\n   * @return {Object} info.remoteDesc The previous remote SDP object.\n   */\n  async function getRemoteOperationInfo(call, sdp) {\n    const log = logManager.getLogger('CALL', call.id)\n    const session = await WebRTC.sessionManager.get(call.webrtcSessionId)\n\n    const mediaState = getMediaState(call)\n    log.debug(`Current call info; State: ${call.state}, MediaState: ${mediaState}.`)\n\n    /*\n     * Use the currently set remote SDP and the newly-received remote SDP to\n     *    determine what the remote operation was.\n     */\n    const remoteDesc = await session.getLatestRemoteDesc()\n    let mediaDiff = CallstackSDP.compareMedia(remoteDesc.sdp, sdp)\n    let remoteOp = getOperation(mediaDiff)\n    log.debug(`Interpreted update request as a ${remoteOp} operation.`)\n\n    /**\n     * Check for remoteOp special-cases.\n     *  This is needed for complex operations, where a few renegotiations occur\n     *      as a single remote operation. Some of those renegotiations are\n     *      special-cases (ie. not actual SDK operations).\n     *  If the remoteOp is not \"standard\", then try to fit it to a \"standard\"\n     *    operation that \"fits best\".\n     */\n    const isMediaFlowing = hasMediaFlowing(sdp)\n    if (remoteOp === 'UNKNOWN') {\n      /*\n       * If the media state is remotely held but the latest renegotiation has\n       *    media flowing, then handle it as an unhold.\n       * This occurs:\n       *  - As part of a remote direct transfer operation (when this user is being\n       *      transferred to another user). When the transferee accepts the call,\n       *      a renegotiation occurs that changes from 'MoH' to 'media flowing'\n       *      state. This needs to be handled as an unhold by the SDK so that\n       *      the call state is updated to reflect the media state.\n       *  - As part of a remote consultative transfer operation (when this user was\n       *      the first call specified in the transfer operation, but not for the\n       *      second user). Same 'MoH' to 'media flowing' scenario as direct\n       *      transfer.\n       */\n      if (mediaState === CALL_MEDIA_STATES.REMOTE_HOLD && isMediaFlowing) {\n        remoteOp = OPERATIONS.UNHOLD\n      } else {\n        // Try it again, but this time match medias naively.\n        mediaDiff = CallstackSDP.compareMedia(remoteDesc.sdp, sdp, true)\n        remoteOp = getOperation(mediaDiff)\n        log.debug(`Re-interpreted update request as a ${remoteOp} operation.`)\n      }\n    } else if (remoteOp === 'NO_CHANGE') {\n      /*\n       * Renegotiation did not change anything media related. This renegotiation\n       *    may have been for a different purpose, such as changing the remote\n       *    endpoint during a transfer.\n       *\n       * Let this remoteOp default to the generic \"update call\" operation except when we're on locally hold.\n       */\n\n      /**\n       * Special case: Assume the remote operation was actually a Hold.\n       * The operation was interpreted as \"no change\" because the remote media did\n       *    not change in the remote operation. But all media is inactive and we are\n       *    in a Local Hold state. This means that the previous media was inactive\n       *    because of our local hold. So the new media being inactive is a change\n       *    that was done on the remote side, ie. it was actually a remote hold.\n       */\n      if (!isMediaFlowing && mediaState === CALL_MEDIA_STATES.LOCAL_HOLD) {\n        remoteOp = OPERATIONS.HOLD\n        log.debug(`Interpreting NO_CHANGE operation as ${remoteOp} due to ${mediaState} state.`)\n      }\n    }\n\n    return { remoteOp, mediaDiff, remoteDesc }\n  }\n\n  return getRemoteOperationInfo\n}\n","import BasicError, { callCodes } from '../../../errors'\n\n/**\n * Helper function to validate destination for Local Make Calls.\n *\n * @method validateDestination\n * @param {string} destination\n * @returns {BasicError} An error if destination is not defined.\n * @returns {BasicError} An error if destination is not a string.\n */\nexport function validateDestination(destination) {\n  if (!destination) {\n    return new BasicError({\n      message: `No destination provided.`,\n      code: callCodes.INVALID_PARAM\n    })\n  }\n  if (typeof destination !== 'string') {\n    return new BasicError({\n      message: `Incorrect destination type.`,\n      code: callCodes.INVALID_PARAM\n    })\n  }\n}\n\n/**\n * Helper function to validate mediaConstraints for both:\n *  - Local Make Calls.\n *  - Answer Calls.\n *\n * This function will validate the following scenarios:\n *   1. Duplicate media types are passed as detached media and requested media.\n *   2. Invalid type is passed as `medias`. Should be an array of media objects.\n *   3. Any tracks in the `medias` are not detached.\n *   4. Any tracks in the `medias` are not local.\n *   5. Any track is already in use by a session (including the one in context).\n *\n * @method validateMediaConstraints\n * @param {Object} media The mediaConstraints being validated.\n * @returns {BasicError} An error if mediaConstraints.medias is not an array.\n * @returns {BasicError} An error if mediaConstraints.medias Objects are missing `media` and `type` properties.\n * @returns {BasicError} An error if mediaConstraints contains duplicate media kinds.\n */\nexport function validateMediaConstraints(media) {\n  // If no media objects are passed in, no need to validate.\n  if (!media || !media.medias) {\n    return\n  }\n  // Validate correct media objects\n  if (!Array.isArray(media.medias)) {\n    return new BasicError({\n      message: `Incorrect type for mediaConstraints.medias. Must be an array of media objects.`,\n      code: callCodes.GENERIC_ERROR\n    })\n  }\n\n  for (const aMedia of media.medias) {\n    if (!aMedia.type || !aMedia.media) {\n      return new BasicError({\n        message: `Incorrect media objects.`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n  }\n\n  // Validate duplicate media kinds\n  if (media.medias) {\n    const requestedMedia = []\n    if (media.audio) {\n      requestedMedia.push('audio')\n    }\n    if (media.video) {\n      requestedMedia.push('video')\n    }\n    if (media.screen) {\n      requestedMedia.push('screen')\n    }\n\n    // Get tracks for each media and check if kind equals any of the requested media and throw if it does.\n    const trackKinds = []\n    media.medias.forEach(media => {\n      trackKinds.push(media.type)\n    })\n\n    const duplicateKinds = requestedMedia.filter(mediaKind => trackKinds.includes(mediaKind))\n    // Throw an error if requested media kind has also been passed in as detached media\n    if (duplicateKinds.length > 0) {\n      return new BasicError({\n        message: `Both detached media tracks and media constraints provided for ${duplicateKinds}`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n  }\n}\n\n/**\n * Helper function to validate detached media for both:\n *  - Local Make Calls.\n *  - Answer Calls.\n *\n * @method validateDetachedMedia\n * @param {Object} medias The detached media being validated.\n * @returns {BasicError} An error if any tracks in mediaConstraints.medias are not detached.\n * @returns {BasicError} An error if any tracks in mediaConstraints.medias are not local.\n */\nexport function validateDetachedMedia(medias) {\n  // Validate that all tracks are detached, local and not in use by an existing session.\n  for (const media of medias) {\n    if (!media.media.detached) {\n      return new BasicError({\n        message: `Media: ${media.media.id} is not detached.`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n    if (!media.media.local) {\n      return new BasicError({\n        message: `Media: ${media.media.id} is not local. Only local media may be used when adding media to a call.`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n  }\n}\n","/**\n * Compares whether a new remote SDP for a Session has the same SDP session ID\n *    of the previous remote SDP.\n * @method isSameSdpSessionId\n * @param  {Object}  WebRTC    The webRTC stack.\n * @param  {string}  sessionId ID of the Session under question.\n * @param  {string}  sdp       New remote SDP to compare the current one with.\n * @return {boolean}\n */\nexport async function isSameSdpSessionId(WebRTC, sessionId, sdp) {\n  const session = await WebRTC.sessionManager.get(sessionId)\n  const currentDesc = await session.getRemoteDescription()\n\n  // TODO: How to act when there isn't a remote SDP set?\n  // Currently: Return falsy to cause a recreate. If there isn't a remote SDP\n  //    set, it's possible we're in an error scenario.\n  if (currentDesc && currentDesc.sdp) {\n    const sameId = hasSameSessionId(currentDesc.sdp, sdp)\n    return sameId\n  }\n}\n\n/**\n * Checks whether two SDPs have the same session ID.\n * @method hasSameSessionId\n * @param  {string}  sdp    A valid SDP string.\n * @param  {string}  newSdp A valid SDP string.\n * @return {boolean} Whether the two SDPs have the same session ID.\n */\nexport function hasSameSessionId(sdp, newSdp) {\n  const firstSdpSessionId = getSdpSessionId(sdp)\n  const secondSdpSessionId = getSdpSessionId(newSdp)\n\n  if (firstSdpSessionId && secondSdpSessionId) {\n    return firstSdpSessionId === secondSdpSessionId\n  }\n}\n\n/**\n * Extracts the session ID from the SDP.\n * Session ID is located in the o= line.\n * Ref: https://tools.ietf.org/html/rfc4566#section-5.2\n * @method getSdpSessionId\n * @param  {string} sdp A valid SDP string.\n * @return {string} The SDP's session ID.\n */\nexport function getSdpSessionId(sdp) {\n  const oLine = sdp.match(/o=.*/gm)\n\n  if (oLine && oLine[0]) {\n    return oLine[0].split(' ')[1]\n  }\n}\n","/**\n * Bottle wrapper for \"close call\" operation.\n * @return {Function}\n */\nexport default function closeCallOperation(container) {\n  const { logManager, WebRTC } = container\n\n  /**\n   * Performs the webRTC session functions associated with closing a call.\n   * @method closeCall\n   * @param {string} sessionId the local webRTC session id, used to lookup the session object\n   * @return {undefined}\n   */\n  async function closeCall(sessionId) {\n    const log = logManager.getLogger('CALLSTACK')\n\n    const session = await WebRTC.sessionManager.get(sessionId)\n\n    if (!session) {\n      log.debug(`webRTC session ${sessionId} not found.`)\n      return\n    }\n\n    await Promise.all(\n      session.localTracks.map(async track => {\n        const detached = await track.isDetached()\n        if (!detached) {\n          await track.stop()\n        }\n      })\n    )\n\n    await session.end()\n  }\n\n  return closeCall\n}\n","/*\n * Webrtc Helper Operations available in the Callstack.\n * This file is where the names for the operations are defined.\n */\nimport closeCall from './establish/closeCall'\n\nimport createLocal from './media/createLocal'\n\nimport generateOffer from './negotiation/generateOffer'\nimport handleOffer from './negotiation/handleOffer'\nimport receivedAnswer from './negotiation/receivedAnswer'\n\nexport default function initOperation(bottle) {\n  // Provide the top-level container to the factory functions.\n  //    Otherwise they would get the `operations` sub-container.\n  bottle.factory('CallstackWebrtc.closeCall', () => closeCall(bottle.container))\n  bottle.factory('CallstackWebrtc.createLocal', () => createLocal(bottle.container))\n  bottle.factory('CallstackWebrtc.generateOffer', () => generateOffer(bottle.container))\n  bottle.factory('CallstackWebrtc.handleOffer', () => handleOffer(bottle.container))\n  bottle.factory('CallstackWebrtc.receivedAnswer', () => receivedAnswer(bottle.container))\n}\n","// Call Plugin.\nimport { getCallById } from '../../../interface/selectors'\nimport { OP_STATUS } from '../../../interface/constants'\n\n// Other plugins.\nimport { REPORT_EVENTS } from '../../reporter/constants'\n\n/**\n * Bottle wrapper for \"create local media\" operation.\n * @return {Function}\n */\nexport default function createLocalOperation(container) {\n  const { context, CallReporter, WebRTCMediaOperations } = container\n\n  /**\n   * Use the WebRTC stack to create local Media object(s).\n   * The underlying WebRTC APIs used are getUserMedia and getDisplayMedia.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n   *    for more information.\n   * @method createLocal\n   * @async\n   * @param  {Object} mediaConstraints Collection of constraints for each media type.\n   * @param  {MediaStreamConstraints} mediaConstraints.audio Native media contraints for audio.\n   * @param  {MediaStreamConstraints} mediaConstraints.video Native media constraints for video.\n   * @param  {MediaStreamConstraints} mediaConstraints.screen Native media constraints for display (screen).\n   * @return {Array<Object>} List of objects containing the media type and the media itself.\n   * @throws {BasicError} Throws a USER_MEDIA_ERROR error if provided constraints cannot be fulfilled.\n   * @throws {BasicError} Throws a USER_MEDIA_ERROR error if it fails to get media for other reasons.\n   */\n  async function createLocal(mediaConstraints, callId) {\n    // Add the get user media sub event to the current operation event in the call report\n    const call = getCallById(context.getState(), callId)\n    const callReport = CallReporter.getReport(callId)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.status === OP_STATUS.ONGOING\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const getUserMediaEvent = operationEvent.addEvent(REPORT_EVENTS.GET_USER_MEDIA)\n    getUserMediaEvent.addData('mediaConstraints', mediaConstraints)\n\n    let medias = []\n    try {\n      medias = await WebRTCMediaOperations.createLocal(mediaConstraints)\n    } catch (err) {\n      getUserMediaEvent.setError(err)\n      getUserMediaEvent.endEvent()\n      throw err\n    }\n\n    getUserMediaEvent.endEvent()\n    return medias\n  }\n\n  return createLocal\n}\n","// Call plugin\nimport { getCallByWebrtcSessionId, getOptions } from '../../../interface/selectors'\nimport { OPERATIONS, OP_STATUS } from '../../../interface/constants'\n\n// Other plugins\nimport BasicError, { callCodes } from '../../../../errors'\nimport { REPORT_EVENTS } from '../../reporter/constants'\n\n/**\n * Bottle wrapper for \"generate offer\" operation.\n * @return {Function}\n */\nexport default function generateOfferOperation(container) {\n  const { context, logManager, CallstackSDP, WebRTC, CallReporter } = container\n\n  /**\n   * Performs the webRTC session functions associated with creating an SDP offer\n   *\n   * @method generateOffer\n   * @param {string} sessionId the local webRTC session id, used to lookup the session object\n   * @param {Object} mediaDirections\n   * @param {string} mediaDirections.audio mode of audio add to the sdp offer\n   * @param {string} mediaDirections.video mode of video add to the sdp offer\n   * @param {BandwidthControls} [bandwidth] bandwidth configurations to use\n   * @param {Object} otherOptions Other options to pass to createOffer\n   * @return {Object} offer object containing a Session Description Protocol\n   */\n  async function generateOffer(sessionId, mediaDirections, bandwidth, otherOptions = {}) {\n    const log = logManager.getLogger('CALLSTACK')\n    const session = await WebRTC.sessionManager.get(sessionId)\n\n    if (!session) {\n      const sessionNotFoundMsg = `WebRTC session ${sessionId} not found.`\n      log.debug(sessionNotFoundMsg)\n      throw new BasicError({\n        message: sessionNotFoundMsg,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n\n    const call = getCallByWebrtcSessionId(context.getState(), sessionId)\n    const callReport = CallReporter.getReport(call.id)\n\n    // The operation is either a local negotiation or a remote slow-start.\n    const operation = call.currentOperations.find(op => {\n      return (op.isLocal && op.status === OP_STATUS.ONGOING) || (!op.isLocal && op.type === OPERATIONS.SLOW_START)\n    })\n\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const setLocalDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n    setLocalDescriptionEvent.addData('operation', operationEvent.type)\n    /*\n     * Create the local SDP offer, run it through any provided SDP handlers,\n     *    then set it as the Session's local description.\n     */\n    // TODO: Make sure the session is in the correct signaling state to start a\n    //    renegotiation operation.\n    let offer, callConfigOptions\n\n    try {\n      offer = await session.createOffer({ mediaDirections, ...otherOptions })\n      callConfigOptions = getOptions(context.getState())\n      // This is the \"pre set local\" stage.\n      offer.sdp = CallstackSDP.runPipeline(\n        callConfigOptions.sdpHandlers,\n        offer.sdp,\n        {\n          callId: call.id,\n          type: offer.type,\n          step: 'set',\n          endpoint: 'local',\n          bandwidth\n        },\n        log\n      )\n\n      offer = await session.setLocalDescription(offer)\n    } catch (e) {\n      const error = new BasicError({\n        message: e.message,\n        code: callCodes.GENERIC_ERROR\n      })\n\n      setLocalDescriptionEvent.setError(error)\n      setLocalDescriptionEvent.endEvent()\n      throw error\n    }\n    // This is the \"pre send local\" stage.\n    // Assign it to a new variable because some browsers enforce the read-only\n    //    properties of a RTCSessionDescription object. The object from\n    //    setLocalDescription is enforced read-only, but the `offer` before that\n    //    is not enforced.\n    const newSdp = CallstackSDP.runPipeline(\n      callConfigOptions.sdpHandlers,\n      offer.sdp,\n      {\n        callId: call.id,\n        type: offer.type,\n        step: 'send',\n        endpoint: 'local',\n        bandwidth\n      },\n      log\n    )\n\n    // TODO: May want to save extra data for this event, maybe ICE candidates\n    setLocalDescriptionEvent.endEvent()\n    return { type: offer.type, sdp: newSdp }\n  }\n\n  return generateOffer\n}\n","// Call plugin.\nimport { getOptions, getCallByWebrtcSessionId, getCallById } from '../../../interface/selectors'\nimport { REPORT_EVENTS } from '../../reporter/constants'\n\n// Other Plugins\nimport BasicError, { callCodes } from '../../../../errors'\n\n/**\n * Bottle wrapper for \"handle offer\" operation.\n * @return {Function}\n */\nexport default function handleOfferOperation(container) {\n  const { context, logManager, CallstackSDP, WebRTC, CallReporter } = container\n  /**\n   * Performs webRTC portions of receiving an \"offer\" Session Description Protocol\n   *\n   * @method handleOffer\n   * @param  {string} offer Session Description protocol offer\n   * @param  {string} webrtcSessionId local webrtc session id\n   * @param {BandwidthControls} bandwidth bandwidth configurations to use\n   * @returns {Object}\n   */\n  async function handleOffer(offer, webrtcSessionId, bandwidth) {\n    const log = logManager.getLogger('CALLSTACK')\n    const session = await WebRTC.sessionManager.get(webrtcSessionId)\n\n    if (!session) {\n      log.debug(`webRTC session ${webrtcSessionId} not found.`)\n      return\n    }\n\n    const { id: callId } = getCallByWebrtcSessionId(context.getState(), webrtcSessionId)\n\n    /*\n     * Run the remote SDP offer through any SDP handlers provided, then set it\n     *    as the Session's remote description.\n     * This is the \"pre set remote\" stage.\n     */\n    const callConfigOptions = getOptions(context.getState())\n\n    offer = CallstackSDP.runPipeline(\n      callConfigOptions.sdpHandlers,\n      offer,\n      {\n        callId,\n        type: 'offer',\n        step: 'set',\n        endpoint: 'remote'\n      },\n      log\n    )\n\n    const targetCall = getCallById(context.getState(), callId)\n    const callReport = CallReporter.getReport(targetCall.id)\n\n    const operation = targetCall.currentOperations.find(op => {\n      return !op.isLocal\n    })\n    const operationEvent = callReport.getEvent(operation.eventId)\n    const setRemoteDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_REMOTE)\n\n    let answer\n    let setLocalDescriptionEvent\n    try {\n      // TODO: Make sure the session is in the correct signaling state to process an offer.\n      const error = await session.processOffer({\n        type: 'offer',\n        sdp: offer\n      })\n\n      if (error) {\n        setRemoteDescriptionEvent.endEvent(error)\n        return { error }\n      }\n      setRemoteDescriptionEvent.endEvent()\n\n      setLocalDescriptionEvent = operationEvent.addEvent(REPORT_EVENTS.PROCESS_MEDIA_LOCAL)\n      setLocalDescriptionEvent.addData('operation', operationEvent.type)\n\n      /*\n       * Create the local SDP answer, run it through any provided SDP handlers,\n       *    then set it as the Session's local description.\n       */\n      answer = await session.createAnswer()\n\n      // This is the \"pre set local\" stage.\n      answer.sdp = CallstackSDP.runPipeline(\n        callConfigOptions.sdpHandlers,\n        answer.sdp,\n        {\n          callId,\n          type: answer.type,\n          step: 'set',\n          endpoint: 'local',\n          bandwidth\n        },\n        log\n      )\n\n      answer = await session.setLocalDescription(answer)\n    } catch (e) {\n      const error = new BasicError({\n        message: e.message,\n        code: callCodes.GENERIC_ERROR\n      })\n      if (setLocalDescriptionEvent) {\n        setLocalDescriptionEvent.setError(error)\n        setLocalDescriptionEvent.endEvent()\n      }\n      throw error\n    }\n\n    // Run the SDP through the Pipeline again before we send it to the remote side.\n    //    This is the \"pre send local\" stage.\n    // Assign it to a new variable because some browsers enforce the read-only\n    //    properties of a RTCSessionDescription object. The object from\n    //    setLocalDescription is enforced read-only, but the `offer` before that\n    //    is not enforced.\n    const newSdp = CallstackSDP.runPipeline(\n      callConfigOptions.sdpHandlers,\n      answer.sdp,\n      {\n        callId,\n        type: answer.type,\n        step: 'send',\n        endpoint: 'local',\n        bandwidth\n      },\n      log\n    )\n    if (setLocalDescriptionEvent) {\n      setLocalDescriptionEvent.endEvent()\n    }\n\n    return {\n      answerSDP: newSdp\n    }\n  }\n\n  return handleOffer\n}\n","// Call plugin.\nimport { getOptions } from '../../../interface/selectors'\n\n// Helpers.\nimport changeDtlsRoleTo from '../../sdp/handlers/changeDtlsRoleTo'\nimport BasicError, { callCodes } from '../../../../errors'\n\n/**\n * Bottle wrapper for \"received answer\" operation.\n * @return {Function}\n */\nexport default function receivedAnswerOperation(container) {\n  const { context, logManager, CallstackSDP, WebRTC } = container\n\n  /**\n   * An answer SDP has been received and should be applied to the Session.\n   *\n   * This operation is intended to handle all webRTC scenarios where a remote answer\n   *    SDP has been received and needs to be added to the Session. At this point\n   *    in negotiation, a Session should have been created and a local offer SDP\n   *    set. This can be for initial negotiation or for midcall renegotiation, so\n   *    the Session may or may not have a \"current remote SDP\" already.\n   * This operation will complete the negotiation process, as both ends will have both\n   *    an offer and answer SDP set.\n   * Responsibilities:\n   *    1. Ensure this is a valid operation.\n   *        - Session exists, Session is in correct signaling state.\n   *    2. Check the answer SDP for abnormal scenarios.\n   *        - DTLS role issue.\n   *    3. Process the answer SDP via Session's APIs.\n   * @method receivedAnswer\n   * @param {Object} sessionInfo\n   * @param {string} sessionInfo.sessionId\n   * @param {string} sessionInfo.answerSdp\n   * @param {Object} targetCall\n   * @param {string} targetCall.id\n   * @param {boolean} targetCall.isCaller\n   * @returns {undefined}\n   * @throws {BasicError} Throws INVALID_PARAM if the WebRTC session does not exist.\n   * @throws {BasicError} Throws GENERIC_ERROR if the SDP pipeline encounters an error.\n   * @throws {BasicError} Throws SESSION_MISMATCH if negotiation m-line error occurs.\n   * @throws {BasicError} Throws GENERIC_ERROR if other negotiation error occurs.\n   */\n  async function receivedAnswer(sessionInfo, targetCall) {\n    const log = logManager.getLogger('CALL', targetCall.id)\n    log.debug(`Processing SDP answer for session ${sessionInfo.sessionId}.`)\n\n    const session = await WebRTC.sessionManager.get(sessionInfo.sessionId)\n    if (!session) {\n      log.debug(`webRTC session ${sessionInfo.sessionId} not found.`)\n      throw new BasicError({\n        code: callCodes.INVALID_PARAM,\n        message: `WebRTC session for Call ${targetCall.id} does not exist.`\n      })\n    }\n\n    let sdpHandlers = getOptions(context.getState()).sdpHandlers\n    let answerSdp = sessionInfo.answerSdp\n\n    /*\n     * If the answer we received has DTLS role of 'actpass', then this is not a\n     *    normal webRTC scenario. An answer SDP cannot have 'actpass' as the role.\n     * It is assumed that the reason for this is a slow start call.\n     */\n    if (answerSdp.includes('a=setup:actpass')) {\n      /*\n       * Change the DTLS role depending on which side of the call the user is.\n       * Change the caller to passive and the callee to active roles, because\n       *    this is how it would be set for a regular call.\n       */\n      const newRole = targetCall.isCaller ? 'passive' : 'active'\n      log.debug(`Received answer SDP has role of actpass. Changing to ${newRole}.`)\n      sdpHandlers = [...sdpHandlers, changeDtlsRoleTo(newRole, log)]\n    }\n\n    /*\n     * Provide the answer SDP to the Session for \"processing\".\n     * If successful, the webRTC negotiation process is considered complete.\n     */\n    try {\n      /*\n       * Run the remote SDP answer through any SDP handlers provided, then set it\n       *    as the Session's remote description.\n       * This is the \"pre set remote\" stage.\n       */\n      answerSdp = CallstackSDP.runPipeline(sdpHandlers, answerSdp, {\n        callId: targetCall.id,\n        type: 'answer',\n        step: 'set',\n        endpoint: 'remote'\n      })\n      await session.processAnswer({\n        type: 'answer',\n        sdp: answerSdp\n      })\n    } catch (err) {\n      // TODO: Better error handling.\n      log.debug(`Failed to process answer: ${err.message}`)\n      let errorInfo\n      if (err.message.includes('The order of m-lines')) {\n        errorInfo = {\n          code: callCodes.SESSION_MISMATCH,\n          message: 'Failed to receive answer due to media negotiation mismatch.'\n        }\n      } else {\n        errorInfo = {\n          code: callCodes.GENERIC_ERROR,\n          message: `Failed to receive answer: ${err.message}`\n        }\n      }\n\n      throw new BasicError(errorInfo)\n    }\n  }\n\n  return receivedAnswer\n}\n","// Other plugins.\nimport { logManager } from '../logs'\n\n// Helpers.\nimport mergeValues from '@rbbn/utilities/mergeValues'\nimport { getVersion } from '../common/version'\nimport { iceCollectionCheckFunction } from './utils/defaults'\n\n// Parse and/or Validate\nimport { validation as v8n, parse, enums } from '../common/validation'\n\nconst log = logManager.getLogger('CALL')\n\n/*\n * JsDoc documentation for call configs are found in the Call plugin indexes.\n */\nconst defaultOptions = {\n  // Native Peer configs.\n  defaultPeerConfig: {\n    sdpSemantics: 'unified-plan',\n    iceServers: []\n  },\n\n  // ICE collection configs.\n  iceCollectionIdealTimeout: 1000,\n  iceCollectionMaxTimeout: 3000,\n  serverTurnCredentials: true,\n\n  // SDP manipulation configs.\n  sdpHandlers: [],\n  removeBundling: false,\n\n  // Other.\n  earlyMedia: false,\n  resyncOnConnect: false,\n  mediaBrokerOnly: false,\n  trickleIceMode: 'NONE',\n  skipIceCollection: false,\n  normalizeDestination: true,\n  ringingFeedbackMode: 'auto',\n  callAuditTimer: 25000,\n  mediaConnectionRetryDelay: 3000\n}\n\n// config validation\nconst v8nValidation = v8n.schema({\n  // Native Peer configs.\n  defaultPeerConfig: v8n.schema({\n    sdpSemantics: enums(['unified-plan']),\n    // Validation for currently supported properties of an RTCPeerConfiguration,\n    // as specified at: https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/RTCPeerConnection\n    // If more params are supported in the future, then we need to extend this validation.\n    iceServers: v8n.array(),\n    iceCandidatePoolSize: v8n.optional(v8n.positive()),\n    iceTransportPolicy: v8n.optional(enums(['all', 'public', 'relay'])),\n    bundlePolicy: v8n.optional(enums(['balanced', 'max-compat', 'max-bundle'])),\n    certificates: v8n.optional(\n      v8n.array().every.schema({\n        expires: v8n.string()\n      })\n    ),\n    peerIdentity: v8n.optional(v8n.string()),\n    rtcpMuxPolicy: v8n.optional(enums(['negotiate', 'require']))\n  }),\n\n  // ICE collection configs.\n  iceCollectionIdealTimeout: v8n.positive(),\n  iceCollectionMaxTimeout: v8n.positive(),\n  iceCollectionCheckFunction: v8n.optional(v8n.function()),\n  serverTurnCredentials: v8n.boolean(),\n\n  // SDP manipulation configs.\n  sdpHandlers: v8n.array(),\n  removeBundling: v8n.boolean(),\n\n  // Other\n  earlyMedia: v8n.boolean(),\n  resyncOnConnect: v8n.boolean(),\n  mediaBrokerOnly: v8n.boolean(),\n  trickleIceMode: v8n.string(),\n  skipIceCollection: v8n.boolean(),\n  normalizeDestination: v8n.boolean(),\n  ringingFeedbackMode: enums(['auto', 'manual']),\n  callAuditTimer: v8n.positive(),\n  mediaConnectionRetryDelay: v8n.positive()\n})\nconst parseOptions = parse('call', v8nValidation)\n\n/**\n * A helper function to validate and fix STUN/TURN server urls according to RFC Spec.\n *\n * @method fixIceServerUrls\n * @param {string} url The URL of the ice server\n * @return The updated URL\n */\nexport function fixIceServerUrls(url) {\n  let serverUrl\n  try {\n    serverUrl = new URL(url)\n  } catch (error) {\n    log.warn(`Invalid URL specified for ice server: ${url}`)\n    return url\n  }\n  const protocol = serverUrl.protocol\n  const query = serverUrl.search\n  if (!query) {\n    return url\n  }\n\n  let queryFilterFunc\n  if (protocol && protocol.toLowerCase().startsWith('turn')) {\n    // Remove all query parameters other than \"transport\" for TURN URLs.\n    queryFilterFunc = key => key !== 'transport'\n  } else {\n    // Remove all query parameters for STUN URLs\n    queryFilterFunc = () => true\n  }\n  const serverQueryParams = new URLSearchParams(query)\n  Array.from(serverQueryParams.keys())\n    .filter(queryFilterFunc)\n    .forEach(key => serverQueryParams.delete(key))\n\n  const newQuery = serverQueryParams.toString()\n  serverUrl.search = newQuery\n  if (serverUrl.search.length !== query.length) {\n    log.warn(`Invalid STUN/TURN server URL provided: ${url}`)\n  }\n\n  return serverUrl.toString()\n}\n\n/**\n * Helper function to format the Call configs as the plugins expect it to be.\n * @method parseConfigs\n * @param {Object} options Call configs provided by application.\n * @returns {Object} Call configs re-formatted as needed.\n */\nexport default function parseConfigs(options = {}) {\n  // Only parse the configs for v4+.\n  const majorVersion = getVersion()[0]\n  if (majorVersion < 4) {\n    return options\n  }\n\n  if (options.ringingFeedbackMode && !['auto', 'manual'].includes(options.ringingFeedbackMode)) {\n    log.warn('Call configuration `ringingFeedbackMode` invalid. Switching to `auto`.')\n    options.ringingFeedbackMode = 'auto'\n  }\n\n  // For backwards compatiblilty, if `iceCollectionDelay` and `maxIceTimeout` were provided, and `iceCollectionIdealTimeout`\n  //  and `iceCollectionMaxTimeout` were not, we will use the `iceCollectionDelay` as the ideal timeout, and `maxIceTimeout`\n  //  as the max.\n  if (options.iceCollectionDelay) {\n    if (!options.iceCollectionIdealTimeout) {\n      options.iceCollectionIdealTimeout = options.iceCollectionDelay\n    }\n    delete options.iceCollectionDelay\n  }\n  if (options.maxIceTimeout && !options.iceCollectionMaxTimeout) {\n    if (!options.iceCollectionMaxTimeout) {\n      options.iceCollectionMaxTimeout = options.maxIceTimeout\n    }\n    delete options.maxIceTimeout\n  }\n\n  // TODO: Remove this once trickle ICE is fully supported.\n  if (options.skipIceCollection) {\n    // Prevent conflicting skipIceCollection and trickleIceMode specifications.\n    if (options.trickleIceMode && ['NONE', 'HALF'].includes(options.trickleIceMode)) {\n      log.warn(\n        'Conflicting `skipIceCollection` and `trickleIceMode` options specified. Proceeding with `skipIceCollection: true` only.'\n      )\n      delete options.trickleIceMode\n    }\n    // \"skipIceCollection: true\" is equivalent to \"trickleIceMode: 'FULL'\", i.e., current trickleIceMode \"FULL\" implementation\n    //   proceeds to negotiation without waiting for ICE candidate collection to process/complete.\n    options.trickleIceMode = 'FULL'\n  }\n  return options\n}\n\n/**\n * Helper function to merge the default Call configs into the application-provided\n *   configs and validate them.\n * @param  {Object} options Call configs with expected formatting.\n * @return {Object} Call configs with defaults included.\n */\nexport function mergeDefaults(options = {}) {\n  options = mergeValues(defaultOptions, options)\n  // If no ice collection check function was provided, get the default one.\n  if (!options.iceCollectionCheckFunction) {\n    options.iceCollectionCheckFunction = iceCollectionCheckFunction\n  }\n  parseOptions(options)\n\n  return options\n}\n","/**\n * Call states\n * Call states used in the link call plugin\n * @name CALL_STATES\n */\nexport const CALL_STATES = {\n  INITIATING: 'Initiating',\n  INITIATED: 'Initiated',\n  EARLY_MEDIA: 'Early Media',\n  RINGING: 'Ringing',\n  CANCELLED: 'Cancelled',\n  CONNECTED: 'Connected',\n  ON_HOLD: 'On Hold',\n  ENDED: 'Ended'\n}\n\n/**\n * Possible states a call's media can be in.\n * Describes whether media is flowing or if an endpoint is preventing media flow.\n * @name CALL_MEDIA_STATES\n * @type {Object}\n * @property {string} CONNECTED Both call endpoints allow for media to flow.\n * @property {string} LOCAL_HOLD Local endpoint disallows media from flowing.\n * @property {string} REMOTE_HOLD Remote endpoint disallows media from flowing.\n * @property {string} DUAL_HOLD Both endpoints disallow media from flowing.\n */\nexport const CALL_MEDIA_STATES = {\n  CONNECTED: 'Connected',\n  LOCAL_HOLD: 'Local Hold',\n  REMOTE_HOLD: 'Remote Hold',\n  DUAL_HOLD: 'Dual Hold'\n}\n\n/**\n * Possible states for a Call's media connection.\n * @name CALL_MEDIA_CONNECTION_STATES\n */\nexport const CALL_MEDIA_CONNECTION_STATES = {\n  NEW: 'new',\n  CHECKING: 'checking',\n  CONNECTED: 'connected',\n  COMPLETED: 'completed',\n  FAILED: 'failed',\n  DISCONNECTED: 'disconnected',\n  CLOSED: 'closed'\n}\n\n/**\n * Call operations that require negotiation.\n * @name OPERATIONS\n * @type {Object}\n * @property {string} CHANGE_MEDIA Media flow remains the same, includes non-flow related media changes.\n * @property {string} HOLD_MEDIA   Media flow stops. May include non-flow related media changes.\n * @property {string} UNHOLD_MEDIA Media flow restarts. May include non-flow related media changes.\n * @property {string} MUSIC_ON_HOLD Media flow changes to sendonly.\n */\nexport const OPERATIONS = {\n  CHANGE_MEDIA: 'Change Media',\n  HOLD_MEDIA: 'Hold Media',\n  UNHOLD_MEDIA: 'Unhold Media',\n  MUSIC_ON_HOLD: 'Music on hold'\n}\n\n/**\n * Complex call operations.\n * @name COMPLEX_OPERATIONS\n * @type {Object}\n * @property {string} DIRECT_TRANSFER\n * @property {string} CONSULTATIVE_TRANSFER\n * @property {string} JOIN\n */\nexport const COMPLEX_OPERATIONS = {\n  DIRECT_TRANSFER: 'Direct Transfer',\n  CONSULTATIVE_TRANSFER: 'Consultative Transfer',\n  JOIN: 'Join'\n}\n\n/**\n * Complex call operation messages.\n * @name COMPLEX_OPERATION_MESSAGES\n * @type {Object}\n * @property {string} DIRECT_TRANSFER_SUCCESS Success message for direct transfer.\n * @property {string} CONSULTATIVE_TRANSFER_SUCCESS Success message for consultative transfer (matches reasonText from notification).\n * @property {string} JOIN_SUCCESS Success message for join.\n * @property {string} DIRECT_TRANSFER_FAILURE Failure message for direct transfer.\n * @property {string} CONSULTATIVE_TRANSFER_FAILURE Failure message for consultative transfer.\n * @property {string} JOIN_FAILURE Failure message for join.\n */\nexport const COMPLEX_OPERATION_MESSAGES = {\n  DIRECT_TRANSFER_SUCCESS: 'Direct Transfer Successful',\n  CONSULTATIVE_TRANSFER_SUCCESS: 'Transfer Successful',\n  JOIN_SUCCESS: 'Join Successful',\n  DIRECT_TRANSFER_FAILURE: 'Direct Transfer Failed',\n  CONSULTATIVE_TRANSFER_FAILURE: 'Transfer Failed',\n  JOIN_FAILURE: 'Join Failed'\n}\n\n/**\n * Status codes that match success messages.\n * @name STATUS_CODES\n * @type {Object}\n * @property {number} DIRECT_TRANSFER_SUCCESS Status code for successful direct transfer.\n * @property {number} CONSULTATIVE_TRANSFER_SUCCESS Status code for successful consultative transfer.\n * @property {number} JOIN_SUCCESS Status code for successful join.\n * @property {number} DIRECT_TRANSFER_FAILURE Status code for failed direct transfer.\n * @property {number} CONSULTATIVE_TRANSFER_FAILURE Status code for failed consultative transfer.\n * @property {number} JOIN_FAILURE Status code for failed join.\n */\nexport const STATUS_CODES = {\n  DIRECT_TRANSFER_SUCCESS: 9905,\n  CONSULTATIVE_TRANSFER_SUCCESS: 9905,\n  JOIN_SUCCESS: 9906,\n  DIRECT_TRANSFER_FAILURE: -1,\n  CONSULTATIVE_TRANSFER_FAILURE: -1,\n  JOIN_FAILURE: -2\n}\n\n/**\n * Call direction\n * Indication of which direction the call is going\n * @name CALL_DIRECTION\n */\nexport const CALL_DIRECTION = {\n  INCOMING: 'incoming',\n  OUTGOING: 'outgoing'\n}\n\n/*\n * A conversion from MediaDeviceInfo.kind values to their more common terms.\n * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo/kind\n */\nexport const WEBRTC_DEVICE_KINDS = {\n  audioinput: 'microphone',\n  videoinput: 'camera',\n  audiooutput: 'speaker'\n}\n\n/**\n * Result types for the Ice Collection Check Function.\n * @name ICE_COLLECTION_RESULT_TYPES\n */\nexport const ICE_COLLECTION_RESULT_TYPES = {\n  START_CALL: 'StartCall',\n  WAIT: 'Wait',\n  ERROR: 'Error'\n}\n","const callPrefix = '@@KANDY/CALL/'\n\n/**\n * Basic call operation actions.\n */\nexport const MAKE_CALL = callPrefix + 'MAKE'\nexport const PENDING_MAKE_CALL = callPrefix + 'PENDING_MAKE'\nexport const SESSION_CREATED = callPrefix + 'SESSION_CREATED'\nexport const MAKE_CALL_FINISH = callPrefix + 'MAKE_FINISH'\n\nexport const MAKE_ANONYMOUS_CALL = callPrefix + 'MAKE_ANONYMOUS_CALL'\nexport const MAKE_ANONYMOUS_CALL_FINISH = callPrefix + 'MAKE_ANONYMOUS_CALL_FINISH'\n\nexport const CALL_INCOMING = callPrefix + 'INCOMING'\n\nexport const SEND_RINGING_FEEDBACK = callPrefix + 'SEND_RINGING_FEEDBACK'\nexport const SEND_RINGING_FEEDBACK_FINISH = callPrefix + 'SEND_RINGING_FEEDBACK_FINISH'\n\nexport const CALL_RINGING = callPrefix + 'RINGING'\nexport const SESSION_PROGRESS = callPrefix + 'SESSION_PROGRESS'\nexport const CALL_CANCELLED = callPrefix + 'CANCELLED'\n\nexport const ANSWER_CALL = callPrefix + 'ANSWER'\nexport const ANSWER_CALL_FINISH = callPrefix + 'ANSWER_FINISH'\n\nexport const REJECT_CALL = callPrefix + 'REJECT'\nexport const REJECT_CALL_FINISH = callPrefix + 'REJECT_FINISH'\n\nexport const IGNORE_CALL = callPrefix + 'IGNORE'\nexport const IGNORE_CALL_FINISH = callPrefix + 'IGNORE_FINISH'\n\nexport const CALL_ACCEPTED = callPrefix + 'ACCEPTED'\n\nexport const END_CALL = callPrefix + 'END'\nexport const END_CALL_FINISH = callPrefix + 'END_FINISH'\n\nexport const FORWARD_CALL = callPrefix + 'FORWARD_CALL'\nexport const FORWARD_CALL_FINISH = callPrefix + 'FORWARD_CALL_FINISH'\n\nexport const PENDING_OPERATION = callPrefix + 'PENDING_OPERATION'\n\n/**\n * Mid-call operation actions.\n */\n\nexport const UPDATE_CALL = callPrefix + 'UPDATE_CALL'\n\nexport const CALL_HOLD = callPrefix + 'HOLD'\nexport const CALL_HOLD_FINISH = callPrefix + 'HOLD_FINISH'\n\nexport const CALL_UNHOLD = callPrefix + 'UNHOLD'\nexport const CALL_UNHOLD_FINISH = callPrefix + 'UNHOLD_FINISH'\n\nexport const SET_CUSTOM_PARAMETERS = callPrefix + 'SET_CUSTOM_PARAMETERS'\n\nexport const SEND_CUSTOM_PARAMETERS = callPrefix + 'SEND_CUSTOM_PARAMETERS'\nexport const SEND_CUSTOM_PARAMETERS_FINISH = callPrefix + 'SEND_CUSTOM_PARAMETERS_FINISH'\n\nexport const ADD_MEDIA = callPrefix + 'ADD_MEDIA'\nexport const ADD_MEDIA_FINISH = callPrefix + 'ADD_MEDIA_FINISH'\nexport const ADD_BASIC_MEDIA = callPrefix + 'ADD_BASIC_MEDIA'\n\nexport const REMOVE_MEDIA = callPrefix + 'REMOVE_MEDIA'\nexport const REMOVE_MEDIA_FINISH = callPrefix + 'REMOVE_MEDIA_FINISH'\nexport const REMOVE_BASIC_MEDIA = callPrefix + 'REMOVE_BASIC_MEDIA'\n\nexport const MUSIC_ON_HOLD = callPrefix + 'MUSIC_ON_HOLD'\n\nexport const SEND_DTMF = callPrefix + 'SEND_DTMF'\nexport const SEND_DTMF_FINISH = callPrefix + 'SEND_DTMF_FINISH'\n\nexport const GET_STATS = callPrefix + 'GET_STATS'\nexport const GET_STATS_FINISH = callPrefix + 'GET_STATS_FINISH'\n\nexport const CONSULTATIVE_TRANSFER = callPrefix + 'CONSULTATIVE_TRANSFER'\nexport const PENDING_CONSULTATIVE_TRANSFER = callPrefix + 'PENDING_CONSULTATIVE_TRANSFER'\nexport const CONSULTATIVE_TRANSFER_FINISH = callPrefix + 'CONSULTATIVE_TRANSFER_FINISH'\n\nexport const DIRECT_TRANSFER = callPrefix + 'DIRECT_TRANSFER'\nexport const DIRECT_TRANSFER_FINISH = callPrefix + 'DIRECT_TRANSFER_FINISH'\n\nexport const JOIN = callPrefix + 'JOIN'\nexport const JOIN_START = callPrefix + 'JOIN_START'\nexport const PENDING_JOIN = callPrefix + 'PENDING_JOIN'\nexport const JOIN_FINISH = callPrefix + 'JOIN_FINISH'\n\nexport const REPLACE_TRACK = callPrefix + 'REPLACE_TRACK'\nexport const REPLACE_TRACK_FINISH = callPrefix + 'REPLACE_TRACK_FINISH'\n\nexport const MEDIA_RESTART = callPrefix + 'MEDIA_RESTART'\nexport const MEDIA_RESTART_FINISH = callPrefix + 'MEDIA_RESTART_FINISH'\n\nexport const RESYNC = callPrefix + 'RESYNC'\nexport const RESYNC_FINISH = callPrefix + 'RESYNC_FINISH'\n\nexport const PLAY_AUDIO = callPrefix + 'PLAY_AUDIO'\nexport const PENDING_PLAY_AUDIO = callPrefix + 'PENDING_PLAY_AUDIO'\nexport const PLAY_AUDIO_FINISH = callPrefix + 'PLAY_AUDIO_FINISH'\n\n/**\n * Miscellaneous call actions\n */\nexport const CUSTOM_PARAMETERS_RECEIVED = callPrefix + 'CUSTOM_PARAMETERS_RECEIVED'\nexport const GET_AVAILABLE_CODECS = callPrefix + 'GET_AVAILABLE_CODECS'\nexport const AVAILABLE_CODECS_RETRIEVED = callPrefix + 'AVAILABLE_CODECS_RETRIEVED'\n\nexport const OPERATION_UPDATE = callPrefix + 'OPERATION_UPDATE'\n\n/**\n * Remote operation actions.\n */\nexport const CALL_REMOTE_HOLD_FINISH = callPrefix + 'REMOTE_HOLD_FINISH'\nexport const CALL_REMOTE_UNHOLD_FINISH = callPrefix + 'REMOTE_UNHOLD_FINISH'\nexport const REMOTE_ADD_MEDIA_FINISH = callPrefix + 'REMOTE_ADD_MEDIA_FINISH'\nexport const REMOTE_REMOVE_MEDIA_FINISH = callPrefix + 'REMOTE_REMOVE_MEDIA_FINISH'\nexport const REMOTE_START_MOH_FINISH = callPrefix + 'REMOTE_START_MOH_FINISH'\nexport const REMOTE_STOP_MOH_FINISH = callPrefix + 'REMOTE_STOP_MOH_FINISH'\nexport const REMOTE_SLOW_START = callPrefix + 'REMOTE_SLOW_START'\n\n/**\n * Turn action types.\n */\nconst turnPrefix = callPrefix + 'TURN/'\n\nexport const TURN_CHANGED = turnPrefix + 'CHANGED'\n\n/**\n * Track action types.\n */\nconst trackPrefix = callPrefix + 'TRACK/'\n\nexport const TRACK_ADDED = trackPrefix + 'ADDED'\nexport const TRACK_REMOVED = trackPrefix + 'REMOVED'\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { isEmpty, isPlainObject } from 'lodash/fp'\n\n/**\n * Helper function for formatting call actions.\n * @method callActionHelper\n * @param  {string} type Action type.\n * @param  {string} id Id of the call being acted on.\n * @param  {Object} [payload={}]\n * @param  {BasicError} [payload.error]\n * @param  {Object} [meta={}]\n * @return {Object} An action.\n */\nexport function callActionHelper(type, id, payload = {}, meta = {}) {\n  /**\n   * Call action format.\n   * Call actions are not FSA-compliant because there are cases where we need\n   *    to provide useful info (for the SDK) and an error object (for the app).\n   *    FSA would require the error object to be the entirety of the payload.\n   * @type {Object}\n   * {\n   *   type,\n   *   payload: {\n   *    ...usefulInfo,\n   *    errorObject\n   *   },\n   *   error,\n   *   meta\n   * }\n   */\n  const action = {\n    type,\n    payload: {\n      ...payload,\n      id\n    }\n  }\n  // Only have meta and error properties on the action if they're needed.\n  if (!isEmpty(meta)) {\n    action.meta = meta\n  }\n  if (payload.error) {\n    action.error = true\n  }\n  return action\n}\n\nexport function makeCall(id, options) {\n  return callActionHelper(actionTypes.MAKE_CALL, id, options)\n}\n\nexport function sessionCreated(id, params) {\n  return callActionHelper(actionTypes.SESSION_CREATED, id, params)\n}\n\nexport function pendingMakeCall(id, options) {\n  return callActionHelper(actionTypes.PENDING_MAKE_CALL, id, options)\n}\n\nexport function makeCallFinish(id, params) {\n  return callActionHelper(actionTypes.MAKE_CALL_FINISH, id, params)\n}\n\nexport function makeAnonymousCall(id, params) {\n  return {\n    type: actionTypes.MAKE_ANONYMOUS_CALL,\n    payload: {\n      id,\n      callee: params.callee,\n      credentials: params.credentials,\n      mediaConstraints: params.mediaConstraints,\n      callOptions: params.callOptions\n    }\n  }\n}\n\nexport function makeAnonymousCallFinish(id, params) {\n  return callActionHelper(actionTypes.MAKE_ANONYMOUS_CALL_FINISH, id, params)\n}\n\nexport function callIncoming(id, params) {\n  return callActionHelper(actionTypes.CALL_INCOMING, id, params)\n}\n\nexport function sendRingingFeedback(id) {\n  return callActionHelper(actionTypes.SEND_RINGING_FEEDBACK, id)\n}\n\nexport function sendRingingFeedbackFinish(id, params) {\n  return callActionHelper(actionTypes.SEND_RINGING_FEEDBACK_FINISH, id, params)\n}\n\nexport function callRinging(id, params) {\n  return callActionHelper(actionTypes.CALL_RINGING, id, params)\n}\n\nexport function sessionProgress(id, params) {\n  return callActionHelper(actionTypes.SESSION_PROGRESS, id, params)\n}\n\nexport function callCancelled(id, params) {\n  return callActionHelper(actionTypes.CALL_CANCELLED, id, params)\n}\n\nexport function answerCall(id, options) {\n  return callActionHelper(actionTypes.ANSWER_CALL, id, options)\n}\n\nexport function answerCallFinish(id, params, meta) {\n  return callActionHelper(actionTypes.ANSWER_CALL_FINISH, id, params, meta)\n}\n\nexport function rejectCall(id, options) {\n  return callActionHelper(actionTypes.REJECT_CALL, id, options)\n}\n\nexport function rejectCallFinish(id, params) {\n  return callActionHelper(actionTypes.REJECT_CALL_FINISH, id, params)\n}\n\nexport function callAccepted(id, params) {\n  return callActionHelper(actionTypes.CALL_ACCEPTED, id, params)\n}\n\nexport function ignoreCall(id, params) {\n  return callActionHelper(actionTypes.IGNORE_CALL, id, params)\n}\n\nexport function ignoreCallFinish(id, params) {\n  return callActionHelper(actionTypes.IGNORE_CALL_FINISH, id, params)\n}\n\nexport function endCall(id, params) {\n  return callActionHelper(actionTypes.END_CALL, id, params)\n}\n\nexport function endCallFinish(id, params) {\n  return callActionHelper(actionTypes.END_CALL_FINISH, id, params)\n}\n\nexport function holdCall(id, options) {\n  return callActionHelper(actionTypes.CALL_HOLD, id, options)\n}\n\nexport function holdCallFinish(id, params) {\n  return callActionHelper(actionTypes.CALL_HOLD_FINISH, id, params)\n}\n\nexport function unholdCall(id, options) {\n  return callActionHelper(actionTypes.CALL_UNHOLD, id, options)\n}\n\nexport function unholdCallFinish(id, params) {\n  return callActionHelper(actionTypes.CALL_UNHOLD_FINISH, id, params)\n}\n\nexport function setCustomParameters(id, customOptions) {\n  const action = {\n    type: actionTypes.SET_CUSTOM_PARAMETERS,\n    payload: {\n      id,\n      // customOptions can either be an array (i.e., just the headers) or an object (i.e., headers and body)\n      customParameters: isPlainObject(customOptions) ? customOptions.customParameters : customOptions,\n      customBodies: isPlainObject(customOptions) ? customOptions.customBodies : undefined\n    }\n  }\n  return action\n}\n\nexport function sendCustomParameters(id, options) {\n  return callActionHelper(actionTypes.SEND_CUSTOM_PARAMETERS, id, options)\n}\n\nexport function sendCustomParametersFinish(id, params) {\n  return callActionHelper(actionTypes.SEND_CUSTOM_PARAMETERS_FINISH, id, params)\n}\n\nexport function customParametersReceived(id, params) {\n  return callActionHelper(actionTypes.CUSTOM_PARAMETERS_RECEIVED, id, params)\n}\n\nexport function addMedia(id, params) {\n  return callActionHelper(actionTypes.ADD_MEDIA, id, params)\n}\n\nexport function addMediaFinish(id, params) {\n  return callActionHelper(actionTypes.ADD_MEDIA_FINISH, id, params)\n}\n\nexport function addBasicMedia(id, params) {\n  return callActionHelper(actionTypes.ADD_BASIC_MEDIA, id, params)\n}\n\nexport function removeMedia(id, params) {\n  return callActionHelper(actionTypes.REMOVE_MEDIA, id, params)\n}\n\nexport function removeMediaFinish(id, params) {\n  return callActionHelper(actionTypes.REMOVE_MEDIA_FINISH, id, params)\n}\n\nexport function removeBasicMedia(id, params) {\n  return callActionHelper(actionTypes.REMOVE_BASIC_MEDIA, id, params)\n}\n\nexport function sendDTMF(id, params) {\n  return callActionHelper(actionTypes.SEND_DTMF, id, params)\n}\n\nexport function sendDTMFFinish(id, params) {\n  return callActionHelper(actionTypes.SEND_DTMF_FINISH, id, params)\n}\n\nexport function getStats(id, params, deferred) {\n  const action = {\n    type: actionTypes.GET_STATS,\n    payload: {\n      ...params,\n      id\n    },\n    meta: {\n      deferred\n    }\n  }\n\n  return action\n}\n\nexport function getStatsFinish(id, params) {\n  return callActionHelper(actionTypes.GET_STATS_FINISH, id, params)\n}\n\nexport function forwardCall(id, params) {\n  return callActionHelper(actionTypes.FORWARD_CALL, id, params)\n}\n\nexport function forwardCallFinish(id, params) {\n  return callActionHelper(actionTypes.FORWARD_CALL_FINISH, id, params)\n}\n\nexport function consultativeTransfer(id, params) {\n  return callActionHelper(actionTypes.CONSULTATIVE_TRANSFER, id, params)\n}\n\nexport function pendingConsultativeTransfer(id, params) {\n  return callActionHelper(actionTypes.PENDING_CONSULTATIVE_TRANSFER, id, params)\n}\n\nexport function consultativeTransferFinish(id, params) {\n  return callActionHelper(actionTypes.CONSULTATIVE_TRANSFER_FINISH, id, params)\n}\n\nexport function directTransfer(id, params) {\n  return callActionHelper(actionTypes.DIRECT_TRANSFER, id, params)\n}\n\nexport function directTransferFinish(id, params) {\n  return callActionHelper(actionTypes.DIRECT_TRANSFER_FINISH, id, params)\n}\n\nexport function join(id, params) {\n  return callActionHelper(actionTypes.JOIN, id, params)\n}\n\nexport function joinStart(id, params) {\n  return callActionHelper(actionTypes.JOIN_START, id, params)\n}\n\nexport function pendingJoin(id, params) {\n  return callActionHelper(actionTypes.PENDING_JOIN, id, params)\n}\n\nexport function joinFinish(id, params) {\n  return callActionHelper(actionTypes.JOIN_FINISH, id, params)\n}\n\nexport function replaceTrack(id, params) {\n  return callActionHelper(actionTypes.REPLACE_TRACK, id, params)\n}\n\nexport function replaceTrackFinish(id, params) {\n  return callActionHelper(actionTypes.REPLACE_TRACK_FINISH, id, params)\n}\n\nexport function pendingOperation(id, params) {\n  return callActionHelper(actionTypes.PENDING_OPERATION, id, params)\n}\n\nexport function getAvailableCodecs(params, deferred) {\n  const action = {\n    type: actionTypes.GET_AVAILABLE_CODECS,\n    payload: {\n      ...params\n    },\n    meta: {\n      deferred\n    }\n  }\n  return action\n}\n\nexport function availableCodecsRetrieved(params) {\n  const action = {\n    type: actionTypes.AVAILABLE_CODECS_RETRIEVED,\n    payload: {\n      ...params\n    }\n  }\n\n  if (params.error) {\n    action.error = true\n  }\n  return action\n}\n\n/*\n * Remote operations.\n */\n\nexport function remoteHoldFinish(id, params) {\n  return callActionHelper(actionTypes.CALL_REMOTE_HOLD_FINISH, id, params)\n}\n\nexport function remoteUnholdFinish(id, params) {\n  return callActionHelper(actionTypes.CALL_REMOTE_UNHOLD_FINISH, id, params)\n}\n\nexport function remoteAddMediaFinish(id, params) {\n  return callActionHelper(actionTypes.REMOTE_ADD_MEDIA_FINISH, id, params)\n}\n\nexport function remoteRemoveMediaFinish(id, params) {\n  return callActionHelper(actionTypes.REMOTE_REMOVE_MEDIA_FINISH, id, params)\n}\n\nexport function remoteStartMohFinish(id, params) {\n  return callActionHelper(actionTypes.REMOTE_START_MOH_FINISH, id, params)\n}\n\nexport function remoteStopMohFinish(id, params) {\n  return callActionHelper(actionTypes.REMOTE_STOP_MOH_FINISH, id, params)\n}\n\nexport function remoteSlowStart(id, params) {\n  return callActionHelper(actionTypes.REMOTE_SLOW_START, id, params)\n}\n\nexport function restartMedia(id, params) {\n  return callActionHelper(actionTypes.MEDIA_RESTART, id, params)\n}\n\nexport function restartMediaFinish(id, params) {\n  return callActionHelper(actionTypes.MEDIA_RESTART_FINISH, id, params)\n}\n\nexport function resync(id, params) {\n  return callActionHelper(actionTypes.RESYNC, id, params)\n}\n\nexport function resyncFinish(id, params) {\n  return callActionHelper(actionTypes.RESYNC_FINISH, id, params)\n}\n\n/**\n * API action to trigger the \"play audio\" saga.\n * @method playAudio\n * @param {string} id Call ID.\n * @param {string} filePath\n */\nexport function playAudio(id, filePath) {\n  return {\n    type: actionTypes.PLAY_AUDIO,\n    payload: { id, filePath }\n  }\n}\n\n/**\n * Saga action to signify the \"playAudioFile\" operation is midway through.\n * @method playAudioPending\n * @param {string} id Call ID.\n */\nexport function playAudioPending(id) {\n  return {\n    type: actionTypes.PENDING_PLAY_AUDIO,\n    payload: { id }\n  }\n}\n\n/**\n * Action to signify \"operation complete\".\n * @method playAudioFinish\n * @param {string} id Call ID.\n * @param {BasicError} [error] If the operation failed, the error.\n */\nexport function playAudioFinish(id, error) {\n  return {\n    type: actionTypes.PLAY_AUDIO_FINISH,\n    payload: {\n      id,\n      error\n    },\n    error: error !== undefined\n  }\n}\n\n// Generic action.\nexport function updateCall(id, params) {\n  return callActionHelper(actionTypes.UPDATE_CALL, id, params)\n}\n\n/**\n * Action to signify the state of an operation has changed.\n * @method operationUpdate\n * @param {string} id\n * @param {string} operation Type of operation.\n * @param {boolean} isLocal\n * @param {Object} state\n * @param {string} transition\n * @param {Object} operationData\n * @param {string} [eventId]\n * @param {boolean} isBlocking Whether this operation would blocked, or be blocked by, other blocking operations.\n * @param {string} operationId\n */\nexport function operationUpdate(\n  id,\n  operation,\n  isLocal,\n  { transition, operationData, eventId, isBlocking, operationId }\n) {\n  return {\n    type: actionTypes.OPERATION_UPDATE,\n    payload: {\n      id,\n      operation,\n      operationId,\n      transition,\n      operationData,\n      eventId,\n      isLocal,\n      isBlocking\n    }\n  }\n}\n","import * as callActionsImport from './call'\nimport * as turnActionsImport from './turn'\n\n// Apparently the following doesn't work:\n//      export * as newName from './place';\n// So import everything from each file, then re-export.\nexport const callActions = callActionsImport\nexport const turnActions = turnActionsImport\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n/**\n * Represents that TURN information has changed.\n * @method turnChanged\n * @return {Object}\n */\nexport function turnChanged({ credentials }) {\n  return {\n    type: actionTypes.TURN_CHANGED,\n    payload: {\n      credentials\n    }\n  }\n}\n","// Call Plugin\nimport { callActions as actions } from '../actions'\nimport { getCallById, getOptions } from '../selectors'\nimport * as eventTypes from '../eventTypes'\n\n// Other plugins.\nimport { getDomain, getUserInfo } from '../../../auth/interface/selectors'\n\n// Helpers\nimport { normalizeSipUri } from '../../utils/normalization'\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * Call Complex APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} Complex API.\n */\nexport default function createAPI(container) {\n  const { CallManager, context, logManager, API_LOG_TAG, emitEvent } = container\n  const log = logManager.getLogger('CALL')\n\n  /**\n   * Performs a \"direct\" transfer on a call (also known as an unannounced or\n   *    blind transfer). This allows the current user to transfer the remote\n   *    participant of a call to another user, similar to a \"forward\"\n   *    operation.\n   *\n   * The specified call must be locally held. After the operation, this call\n   *    will be ended, as indicated by a\n   *    {@link call.event:call:stateChange call:stateChange} event.\n   *\n   * The \"destination\" user will receive an incoming call, and when answered,\n   *    they will be connected with the remote participant of the specified\n   *    call.\n   *\n   * The progression of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event. The remote\n   *    participant being transferred will receive it as if it were a \"remote\n   *    unhold\" operation.\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method directTransfer\n   * @param {string} callId ID of the call being acted on.\n   * @param {call.SIP_URI|call.TEL_URI} destination The destination to transfer the call to.\n   */\n  async function directTransfer(callId, destination) {\n    log.debug(API_LOG_TAG + 'call.directTransfer: ', callId, destination)\n    const config = getOptions(context.getState())\n    if (config.normalizeDestination) {\n      // Normalize callee addresses\n      destination = normalizeSipUri(destination, getDomain(context.getState()))\n      log.info('Address normalized to: ', destination)\n    }\n\n    context.dispatch(actions.directTransfer(callId, { destination }))\n\n    try {\n      await CallManager.directTransfer(callId, destination)\n    } catch (error) {\n      context.dispatch(actions.directTransferFinish(callId, { error }))\n\n      const call = getCallById(context.getState(), callId)\n      // Emit error event for operation.\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: call ? call.state : undefined,\n          localHold: call ? call.localHold : undefined,\n          remoteHold: call ? call.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  /**\n   * Performs a \"consultative\" transfer between two ongoing calls (also known\n   *    as an announced or warm transfer). This allows the current user to\n   *    transfer the remote participant of a call to another user, after\n   *    having spoken to both users.\n   *\n   * Both calls used for the transfer must be locally held. After the\n   *    operation, these calls will be ended, as indicated by a\n   *    {@link call.event:call:stateChange call:stateChange} event.\n   *\n   * Both remote participants will see their call be unheld by the operation,\n   *    as indicated by a\n   *    {@link call.event:call:stateChange call:stateChange} event, and will\n   *    be connected to one another afterwards.\n   *\n   * The progression of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event. Both local\n   *    calls will receive this event, since it is an operation on both calls,\n   *    and the remote calls will receive it as if it were a \"remote unhold\"\n   *    operation.\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method consultativeTransfer\n   * @param {string} callId ID of the call being acted on.\n   * @param {string} otherCallId ID of the other call being acted on.\n   */\n  async function consultativeTransfer(callId, otherCallId) {\n    log.debug(API_LOG_TAG + 'call.consultativeTransfer: ', callId, otherCallId)\n\n    context.dispatch(actions.consultativeTransfer(callId, { otherCallId }))\n\n    let error\n    try {\n      const calls = [\n        { id: callId, role: 'primary' },\n        { id: otherCallId, role: 'secondary' }\n      ]\n      await CallManager.consultativeTransfer(calls)\n    } catch (err) {\n      error = err\n      context.dispatch(actions.consultativeTransferFinish(callId, { otherCallId, error }))\n\n      const call = getCallById(context.getState(), callId)\n      // Emit error event for operation.\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: call ? call.state : undefined,\n          localHold: call ? call.localHold : undefined,\n          remoteHold: call ? call.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  /**\n   * Performs a \"join\" on two ongoing calls.\n   * This allows the current user to establish a call with audio with two\n   *    remote users.\n   *\n   * Both specified calls must be locally held. The new, \"joined\" call will be\n   *    audio-only, even if either previous call had video. Video cannot be\n   *    added to the \"joined\" call. Both remote participants will see their\n   *    call taken off hold, and will receive additional audio from other\n   *    participants after the operation. Both previous calls for the current\n   *    user will be ended after the operation, as indicated by a\n   *    {@link call.event:call:stateChange call:stateChange} event.\n   *\n   * If the first call specified has custom parameters set, these parameters will be carried over to the new call.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event. Both remote\n   *    participants will also receive this event as if it were a \"remote\n   *    unhold\" operation.\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method join\n   * @param {string} callId ID of the call being acted on.\n   * @param {string} otherCallId ID of the other call being acted on.\n   */\n  async function join(callId, otherCallId) {\n    log.debug(API_LOG_TAG + 'call.join: ', callId, otherCallId)\n\n    const newCallId = uuidV4()\n    const from = getUserInfo(context.getState()).username\n    context.dispatch(actions.join(callId, { otherCallId, newCallId, from }))\n\n    // Start the operation\n    let error\n    try {\n      const calls = [\n        { id: callId, role: 'primary' },\n        { id: otherCallId, role: 'secondary' },\n        { id: newCallId, role: 'joined' }\n      ]\n      await CallManager.join(calls, from)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.joinFinish(callId, {\n          usedCallIds: [callId, otherCallId],\n          error\n        })\n      )\n\n      const primaryCall = getCallById(context.getState(), callId)\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: primaryCall ? primaryCall.state : undefined,\n          localHold: primaryCall ? primaryCall.localHold : undefined,\n          remoteHold: primaryCall ? primaryCall.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  return {\n    directTransfer,\n    consultativeTransfer,\n    join\n  }\n}\n","// Call plugin.\nimport { REPORT_EVENTS, REPORT_METRICS } from '../../callstack/reporter/constants'\nimport { CALL_STATES, CALL_MEDIA_CONNECTION_STATES } from '../../constants'\n\n/**\n * Call Constant APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @return {Object} Constants API.\n */\nexport default function createAPI() {\n  /**\n   * Possible states that a Call can be in.\n   *\n   * A Call's state describes the current status of the Call. An application\n   *    should use the state to understand how the Call, and any media\n   *    associated with the Call, should be handled. Which state the Call is\n   *    in defines how it can be interacted with, as certain operations can\n   *    only be performed while in specific states, and tells an application\n   *    whether the Call currently has media flowing between users.\n   * Unless stated otherwise, the Call's state pertains to both caller & callee.\n   *\n   * The Call's state is a property of the {@link call.CallObject CallObject},\n   *    which can be retrieved using the {@link call.getById} or\n   *    {@link call.getAll} APIs.\n   *\n   * The SDK emits a {@link call.event:call:stateChange call:stateChange}\n   *    event when a Call's state changes from one state to another.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires callMe\n   * @requires call\n   * @type {Object}\n   * @property {string} INITIATING The (outgoing) call is being started. While in this state, no Call operations can be performed until Call gets into Initiated state.\n   * @property {string} INITIATED A call has been started and both the callee and caller may now perform further operations on the call object.\n   * @property {string} RINGING The call has been received by both parties, and is waiting to be answered.\n   * @property {string} EARLY_MEDIA The call has not been answered, but media\n   *    is already being received. This may be network-ringing media, IVR\n   *    system media, or other pre-answer medias. When early media is\n   *    supported, this state may replace the Ringing state. This is a state valid only for caller's side.\n   * @property {string} CANCELLED The call was disconnected before it could be answered. This is a state valid only for callee's side.\n   * @property {string} CONNECTED Both parties are connected and media is flowing.\n   * @property {string} ON_HOLD Both parties are connected but no media is flowing.\n   * @property {string} ENDED The call has ended.\n   * @example\n   * // Use the call states to know how to handle a change in the call.\n   * client.on('call:stateChange', function (params) {\n   *    const call = client.call.getById(params.callId)\n   *    // Check if the call now has media flowing.\n   *    if (call.state === client.call.states.CONNECTED) {\n   *      // The call is now active, and can perform midcall operations.\n   *    }\n   * })\n   */\n  const states = CALL_STATES\n\n  /**\n   * Possible states that a Call's media connection can be in.\n   *\n   * A Call's media connection state describes the current status of media within the call.\n   *  An application should use this state to understand whether the Call participants are\n   *  able to see/hear each other or may be experiencing connection issues. The media connection\n   *  state can be used alongside the {@link call.states Call state} to determine if media issues\n   *  are occurring while the participants are expecting to be connected.\n   *\n   * An important state to check for is the `FAILED` state. This state signifies that there is no\n   *    media connection between the call participants and an action must be taken to resolve the\n   *    problem. Using the {@link call.restartMedia} API will attempt to reconnect the media. See\n   *    the {@link call.restartMedia} API description for more information.\n   *\n   * These states are direct reflections of the possible\n   *  [RTCPeerConnection.iceConnectionState](https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/iceConnectionState) values.\n   *\n   * The Call's media connection state is a property of the {@link call.CallObject CallObject},\n   *    which can be retrieved using the {@link call.getById} or\n   *    {@link call.getAll} APIs.\n   *\n   * The SDK emits a {@link call.event:call:mediaConnectionChange call:mediaConnectionChange}\n   *    event when a Call's media connection state changes from one state to another.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires callMe\n   * @requires call\n   * @type {Object}\n   * @property {string} NEW The Call is initializing the local side of the connection and waiting on information from the remote side.\n   *  When the information is received, the state will transition into `checking` as the Call automatically begins the connection process.\n   * @property {string} CHECKING The Call has received information from the remote endpoint and is working to establish the media connection.\n   *  When finished, the state will transition to either `connected` or `failed`.\n   * @property {string} CONNECTED A usable connection has been made and the Call will now have media.\n   *  The connection may not be optimal, though, so the Call will continue establishment to improve the connection before going into the `completed` state.\n   * @property {string} COMPLETED The media connection process has fully completed and the optimal connection has been established. While in this state,\n   *  the Call endpoints will receive each other's media.\n   * @property {string} DISCONNECTED Media has become disconnected and the Call endpoints have stopped receiving each other's media.\n   *  The Call will automatically attempt to reconnect, transitioning back to `completed` if successful or to `failed` if not.\n   * @property {string} FAILED The connection has failed and cannot be recovered automatically. A full media connection refresh is required to reestablish a connection. See the {@link call.restartMedia} API.\n   * @property {string} CLOSED The connection has been shut down and is no longer in use.\n   * @example\n   * // Use the media connection states to check the status of the media connection of the Call.\n   * client.on('call:mediaConnectionChange', function (params) {\n   *   // Retrieve the state of the Call this event is for.\n   *   const call = client.call.getById(params.callId)\n   *   const mediaConnectionStates = client.call.mediaConnectionStates\n   *\n   *   // Check the mediaConnectionState to determine which scenario the call is in.\n   *   switch (call.mediaConnectionState) {\n   *     case mediaConnectionStates.CONNECTED:\n   *     case mediaConnectionStates.COMPLETED:\n   *       // Media established: The Call's media is connected. The Call's participants\n   *       //    are able to see/hear each other.\n   *       // These states will occur after Call establishment.\n   *       ...\n   *       break\n   *     case mediaConnectionStates.NEW:\n   *     case mediaConnectionStates.CHECKING:\n   *     case mediaConnectionStates.DISCONNECTED:\n   *       // Media pending: The Call's media is not connected. The Call is working\n   *       //    to connect media automatically.\n   *       // These states will occur during Call establishment and may occur midcall if there are\n   *       //    connection issues (eg. poor network quality) or a Call participant has changed (eg. transfer).\n   *       ...\n   *       break\n   *     case mediaConnectionStates.FAILED:\n   *      // Media has failed. The call requires a media refresh to reestablish.\n   *      // This state will occur after the `DISCONNECTED` state is encountered.\n   *      ...\n   *       break\n   *     case mediaConnectionStates.CLOSED:\n   *       // Media ended due to the Call being ended.\n   *       // This state will occur after Call establishment.\n   *       ...\n   *       break\n   *   }\n   * }\n   */\n  const mediaConnectionStates = CALL_MEDIA_CONNECTION_STATES\n\n  /* Documentation attached to the constant definitions. */\n  const reportEvents = REPORT_EVENTS\n\n  /* Documentation attached to the constant definitions. */\n  const metrics = REPORT_METRICS\n\n  return {\n    states,\n    mediaConnectionStates,\n    reportEvents,\n    metrics\n  }\n}\n","// Call plugin.\nimport { callActions as actions } from '../actions'\nimport { getCallById, getOptions } from '../selectors'\nimport * as eventTypes from '../eventTypes'\nimport { CALL_STATES } from '../../constants'\n\n// Other plugins.\nimport { getUserInfo, getDomain } from '../../../auth/interface/selectors'\n\n// Helpers.\n// KJS-2451 TODO: Call the two validate functions as part of the 'validate' stage of the 'Answer' operation.\n//       Once completed, these two validate functions can be removed from '../utils' as they are already available in\n//       in the new file: src/call/callstack/utils/utils.js\nimport { formatMediaConstraints, validateDetachedMedia, validateMediaConstraints } from '../utils'\nimport { normalizeSipUri } from '../../utils/normalization'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * Call Establish APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} Establish API.\n */\nexport default function createAPI(container) {\n  const { CallManager, context, logManager, API_LOG_TAG, emitEvent } = container\n  const log = logManager.getLogger('CALL')\n\n  /**\n   * Starts an outgoing call to a {@link call.SIP_URI SIP_URI} or a\n   *    {@link call.TEL_URI TEL_URI}.\n   *\n   * The call will be tracked by a unique ID that is returned by the API. The\n   *    application will use this ID to identify and control the call after it\n   *    has been initiated.\n   *\n   * The {@link call.getById} API can be used to retrieve\n   *    the current information about the call.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:start call:start} event\n   *    locally when the operation completes. When the remote participant\n   *    receives the call, a {@link call.event:call:receive call:receive}\n   *    event will be emitted remotely for them.\n   *\n   * The SDK requires access to the machine's media devices (eg. microphone)\n   *    in order to make a call. If it does not already have permissions to\n   *    use the devices, the user may be prompted by the browser to give\n   *    permissions.\n   *\n   * Detached media can be used when starting a call. Detached media is created\n   *    locally outside of a call and must be managed by the application. It can\n   *    be used when making a call by passing an array of detached track ids in\n   *    the media object. You can start a call with a mixture of detached\n   *    and requested media, however, you can only use one of each type (audio, video,\n   *    screen). For example, you could include a detached track id for video, and set\n   *    MediaConstraint.audio: true, but you can't set MediaConstraint.video: true\n   *    if you have passed in a detached track id of kind video.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method make\n   * @param {call.SIP_URI|call.TEL_URI} destination The desired destination.\n   * @param {Object} media The media options the call should be initialized with.\n   * @param {boolean} [media.audio=false] Whether the call should have audio on start. Currently, audio-less calls are not supported.\n   * @param {call.AudioOptions} [media.audioOptions] Options for configuring the call's audio.\n   * @param {boolean} [media.video=false] Whether the call should have video on start.\n   * @param {call.VideoOptions} [media.videoOptions] Options for configuring the call's video.\n   * @param {boolean} [media.screen=false] Whether the call should have screenshare on start. (Note: Screensharing is not supported on iOS Safari.)\n   * @param {call.ScreenOptions} [media.screenOptions] Options for configuring the call's screenShare.\n   * @param {Array} [media.medias] List of medias containing tracks to be attached to this call.\n   * @param {Object} [options]\n   * @param {call.BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n   * @param {string} [options.displayName] Custom display name to be provided to the destination. Not supported in all environments and may use default display name.\n   * @param {Array<call.CustomParameter>} [options.customParameters] Custom SIP header parameters for the SIP backend.\n   * @param {call.DSCPControls} [options.dscpControls] Options for configuring DSCP markings on the media traffic\n   * @throws {BasicError} Throws an error if mediaConstraints.medias is not an array.\n   * @throws {BasicError} Throws an error if mediaConstraints.medias Objects are missing `media` and `type` properties.\n   * @throws {BasicError} Throws an error if mediaConstraints contains duplicate media kinds.\n   * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are not detached.\n   * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are not local.\n   * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are already in use by a session.\n   * @throws {BasicError} Throws an error if mediaConstraints.medias contains any type other than Object containing `media` and `type` properties.\n   * @returns {string} The generated ID of the newly created call.\n   * @example\n   * // Listen for the event emitted after making a call.\n   * client.on('call:start', function (params) {\n   *   const { callId, error } = params\n   *   if (error) {\n   *     // Call failed to initialize.\n   *   } else {\n   *     // Call was initialized, and the recipient user will be notified.\n   *   }\n   * })\n   * // Make an audio-only call.\n   * const newCallId = client.call.make(destination, { audio: true })\n   */\n\n  /**\n   * @private\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @requires callMe\n   * @method make\n   * @param {Object} [options]\n   * @param {Array<call.CustomBody>} [options.customBodies] Custom SIP bodies for the SIP backend.\n   */\n  function make(destination, media, options = {}) {\n    log.debug(API_LOG_TAG + 'call.make: ', destination, media, options)\n    const callId = uuidV4()\n    const participants = {\n      to: destination,\n      from: getUserInfo(context.getState()).username\n    }\n    const mediaConstraints = formatMediaConstraints(media)\n\n    const config = getOptions(context.getState())\n    if (config.normalizeDestination && participants.to && typeof participants.to === 'string') {\n      // Normalize callee addresses\n      participants.to = normalizeSipUri(participants.to, getDomain(context.getState()))\n      log.info(`Address normalized to: ${participants.to}`)\n    }\n\n    // Dispatch the \"make call\" action so the call is in state before the operation\n    //    and/or the application goes to look for it there.\n    context.dispatch(\n      actions.makeCall(callId, {\n        participantAddress: participants.to,\n        from: participants.from,\n        mediaConstraints,\n        ...options\n      })\n    )\n\n    /*\n     * Timeout is needed to be backwards-compatible with saga-style API. The API\n     *    needs to return the callId before the operation occurs and any events\n     *    are emitted by the SDK.\n     */\n    setTimeout(async () => {\n      /*\n       * Events emitted pre-operation are:\n       *    - \"call start\": To indicate the call is in state and is Initiating.\n       */\n      emitEvent(eventTypes.CALL_STARTED, { callId })\n\n      try {\n        await CallManager.make(callId, participants, mediaConstraints, options)\n\n        // Tell the application that the call has finished \"initiating\".\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId,\n          previous: {\n            state: CALL_STATES.INITIATING,\n            localHold: false,\n            remoteHold: false\n          }\n        })\n      } catch (err) {\n        // Update call state.\n        context.dispatch(\n          actions.makeCallFinish(callId, {\n            state: CALL_STATES.ENDED,\n            error: err\n          })\n        )\n\n        // Inform the application with an error event.\n        emitEvent(eventTypes.CALL_STATE_CHANGE, {\n          callId,\n          previous: {\n            state: CALL_STATES.INITIATING,\n            localHold: false,\n            remoteHold: false\n          },\n          error: err\n        })\n      }\n      // Use a minimal timeout value to help make sure the operation does happen\n      //     \"immediately\" after the return.\n    }, 0)\n\n    return callId\n  }\n\n  /**\n   * Answers an incoming call.\n   *\n   * The specified call to answer must be in a ringing state with an incoming\n   *    direction. The call will become connected as a result of the operation.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. This indicates that the\n   *    call has connected with the remote participant. The\n   *    {@link call.getById} API can be used to retrieve the latest call state\n   *    after the change. Further events will be emitted to indicate that the\n   *    call has received media from the remote participant. See the\n   *    {@link call.event:call:newTrack call:newTrack} event for more\n   *    information about this.\n   *\n   * The SDK requires access to the system's media devices (eg. microphone)\n   *    in order to answer a call. If it does not already have permissions to\n   *    use the devices, the user may be prompted by the browser to give\n   *    permissions.\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method answer\n   * @param {string} callId The ID of the call to answer.\n   * @param {Object} media The media options the call should be initialized with.\n   * @param {boolean} [media.audio=false] Whether the call should have audio on start. Currently, audio-less calls are not supported.\n   * @param {call.AudioOptions} [media.audioOptions] Options for configuring the call's audio.\n   * @param {boolean} [media.video=false] Whether the call should have video on start.\n   * @param {call.VideoOptions} [media.videoOptions] Options for configuring the call's video.\n   * @param {boolean} [media.screen=false] Whether the call should have screenshare on start. (Note: Screensharing is not supported on iOS Safari.)\n   * @param {call.ScreenOptions} [media.screenOptions] Options for configuring the call's screenShare.\n   * @param {Array} [media.medias] List of medias containing tracks to be attached to this call.\n   * @param {Object} [options]\n   * @param {call.BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n   * @param {Array<call.CustomParameter>} [options.customParameters] Custom SIP header parameters for the SIP backend.\n   * @param {call.DSCPControls} [options.dscpControls] Options for configuring DSCP markings on the media traffic\n   */\n\n  /**\n   * @private\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @requires callMe\n   * @method answer\n   * @param {Object} [options]\n   * @param {Array<call.CustomBody>} [options.customBodies] Custom SIP bodies for the SIP backend.\n   */\n\n  async function answer(callId, media, options = {}) {\n    log.debug(API_LOG_TAG + 'call.answer: ', callId, media, options)\n\n    try {\n      // Validate mediaConstraints\n      validateMediaConstraints(media)\n\n      const mediaConstraints = formatMediaConstraints(media)\n\n      // Dispatch the \"answer call\" action so the call is updated in state\n      // before the operation and/or the application goes to look for it there.\n      context.dispatch(\n        actions.answerCall(callId, {\n          mediaConstraints,\n          ...options\n        })\n      )\n\n      // Validating detached media before attempting to start a call.\n      // This verifies that the detached media being provided is, detached, local\n      // and not already in use by a session.\n      if (media.medias) {\n        validateDetachedMedia(media.medias)\n      }\n\n      const call = getCallById(context.getState(), callId)\n      if (call && call.isSlowStart) {\n        await CallManager.answerSlow(callId, mediaConstraints, options)\n      } else {\n        await CallManager.answer(callId, mediaConstraints, options)\n      }\n    } catch (error) {\n      context.dispatch(actions.answerCallFinish(callId, { error }))\n\n      const call = getCallById(context.getState(), callId)\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: call ? call.state : undefined,\n          localHold: call ? call.localHold : undefined,\n          remoteHold: call ? call.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  /**\n   * Rejects an incoming call.\n   *\n   * The specified call to reject must be in a ringing or initiated state with an incoming\n   *    direction. The call will be ended as a result of the operation.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. The remote participant\n   *    will be notified, through their own {@link call.event:call:stateChange call:stateChange}\n   *    event, that the call was rejected.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @method reject\n   * @param {string} callId The ID of the call to reject.\n   */\n  async function reject(callId) {\n    log.debug(API_LOG_TAG + 'call.reject: ', callId)\n\n    // Dispatch the \"reject call\" action so the operation is updated in state before\n    //   emitting the call operation event\n    context.dispatch(actions.rejectCall(callId))\n\n    let error\n    try {\n      await CallManager.reject(callId)\n    } catch (err) {\n      error = err\n    }\n\n    // Update call state.\n    context.dispatch(actions.rejectCallFinish(callId, { error }))\n\n    const call = getCallById(context.getState(), callId)\n    // Inform application of operation complete.\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId,\n      previous: {\n        state: call ? call.state : undefined,\n        localHold: call ? call.localHold : undefined,\n        remoteHold: call ? call.remoteHold : undefined\n      },\n      error\n    })\n  }\n\n  /**\n   * Ignores an incoming call.\n   *\n   * The specified call to ignore must be in a ringing state with an incoming\n   *    direction. The call will be ended as a result of the operation.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. The remote participant\n   *    will not be notified that the call was ignored.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @method ignore\n   * @param {string} callId The ID of the call to ignore.\n   */\n  async function ignore(callId) {\n    log.debug(API_LOG_TAG + 'call.ignore: ', callId)\n\n    // Dispatch the \"ignore call\" action so the call is updated in state\n    // before the operation and/or the application goes to look for it there.\n    context.dispatch(actions.ignoreCall(callId))\n\n    let error\n    try {\n      await CallManager.ignore(callId)\n    } catch (err) {\n      error = err\n    }\n    // Update call state.\n    context.dispatch(actions.ignoreCallFinish(callId, { error }))\n\n    const call = getCallById(context.getState(), callId)\n    // Inform application of operation complete.\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId,\n      previous: {\n        state: call ? call.state : undefined,\n        localHold: call ? call.localHold : undefined,\n        remoteHold: call ? call.remoteHold : undefined\n      },\n      error\n    })\n  }\n\n  /**\n   * Forwards an incoming call to another user.\n   *\n   * The specified destination will receive the Call instead of the current\n   *    user.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event after the operation completes.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method forward\n   * @param {string} callId ID of the call being acted on.\n   * @param {call.SIP_URI|call.TEL_URI} destination The destination to forward the call to.\n   */\n  async function forward(callId, destination) {\n    log.debug(API_LOG_TAG + 'call.forward: ', destination)\n\n    const config = getOptions(context.getState())\n    if (config.normalizeDestination) {\n      // Normalize callee addresses\n      destination = normalizeSipUri(destination, getDomain(context.getState()))\n      log.info('Address normalized to: ', destination)\n    }\n\n    // Dispatch the action so the operation is updated in state before\n    //   emitting the call operation event\n    context.dispatch(actions.forwardCall(callId, { destination }))\n\n    let error\n    try {\n      await CallManager.forward(callId, destination)\n    } catch (err) {\n      error = err\n    }\n\n    context.dispatch(actions.forwardCallFinish(callId, { error }))\n\n    const call = getCallById(context.getState(), callId)\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId,\n      previous: {\n        state: call ? call.state : undefined,\n        localHold: call ? call.localHold : undefined,\n        remoteHold: call ? call.remoteHold : undefined\n      },\n      error\n    })\n  }\n\n  /**\n   * Ends an ongoing call.\n   *\n   * The SDK will stop any/all local media associated with the call. Events\n   *    will be emitted to indicate which media tracks were stopped. See the\n   *    {@link call.event:call:trackEnded call:trackEnded} event for more\n   *    information.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. The remote participant\n   *    will be notified, through their own\n   *    {@link call.event:call:stateChange call:stateChange} event, that the\n   *    call was ended.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @method end\n   * @param {string} callId The ID of the call to end.\n   */\n  async function end(callId) {\n    log.debug(API_LOG_TAG + 'call.end: ', callId)\n\n    // trigger an action for backwards compatibility\n    context.dispatch(actions.endCall(callId))\n\n    let error\n    try {\n      await CallManager.end(callId)\n    } catch (err) {\n      error = err\n      log.info(`call.end error: ${error.message}`)\n    } finally {\n      const call = getCallById(context.getState(), callId)\n\n      context.dispatch(\n        actions.endCallFinish(callId, {\n          isLocal: true,\n          error\n        })\n      )\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: call ? call.state : undefined,\n          localHold: call ? call.localHold : undefined,\n          remoteHold: call ? call.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  return {\n    make,\n    answer,\n    reject,\n    ignore,\n    forward,\n    end\n  }\n}\n","import establishApis from './establish'\nimport midcallApis from './midcall'\nimport complexApis from './complex'\nimport miscApis from './misc'\nimport constantsApis from './constants'\n\n/**\n * The 'call' namespace (within the 'api' type) is used to make audio and video calls to and from\n * SIP users and PSTN phones.\n *\n * Call functions are all part of the 'call' namespace.\n *\n * @public\n * @namespace call\n */\n\n/**\n * Information about a Call.\n *\n * Can be retrieved using the {@link call.getAll} or {@link call.getById} APIs.\n *\n * @public\n * @static\n * @module CallObject\n * @typedef {Object} CallObject\n * @memberof call\n * @requires link_call\n * @requires callMe\n * @property {string} id The ID of the call.\n * @property {user.UserID} from A unique identifier (uri) of the person who made the call.\n * @property {user.UserID} to A unique identifier (uri) of the person who receives the call.\n * @property {string} direction The direction in which the call was created. Can be 'outgoing' or 'incoming'.\n * @property {string} state The current state of the call. See {@link call.states} for possible states.\n * @property {string} mediaConnectionState The current status of the call's media connection. See {@link call.mediaConnectionStates} for possible states.\n * @property {boolean} localHold Indicates whether this call is currently being held locally.\n * @property {boolean} remoteHold Indicates whether this call is currently being held remotely.\n * @property {Array<string>} localTracks A list of Track IDs that the call is sending to the remote participant.\n * @property {Array<string>} remoteTracks A list of Track IDs that the call is receiving from the remote participant.\n * @property {call.MediaOffered} [mediaOffered] Information about what media was offered by the person who made the call.\n * @property {Object} remoteParticipant Information about the other call participant.\n * @property {string} [remoteParticipant.displayNumber] The User ID of the remote participant in the form \"username@domain\".\n * @property {string} [remoteParticipant.displayName] The display name of the remote participant.\n * @property {call.BandwidthControls} bandwidth The bandwidth limitations set for the call.\n * @property {Array<call.CustomParameter>} customParameters The locally set Custom Parameters for the call.\n * @property {number} startTime The start time of the call in milliseconds since the epoch.\n * @property {number} [endTime] The end time of the call in milliseconds since the epoch.\n * @property {Array<Object>} currentOperations The list of operations curently on-going for the call.\n */\n\n/**\n * The 'media' namespace provides an interface for interacting with Media that the\n *    SDK has access to. Media is used in conjunction with the {@link call Calls}\n *    feature to manipulate and render the Tracks sent and received from a Call.\n *\n * Media and Track objects are not created directly, but are created as part of\n *    Call operations. Media and Tracks will either be marked as \"local\" or\n *    \"remote\" depending on whether their source is the local user's machine\n *    or a remote user's machine.\n *\n * The Media feature also keeps track of media devices that the user's machine\n *    can access. Any media device (eg. USB headset) connected to the machine\n *    can be used as a source for media. Available devices can be found using\n *    the {@link media.getDevices} API.\n *\n * @public\n * @namespace media\n */\n\n/**\n * The MediaConstraint type defines the format for configuring media options.\n * Either the `exact` or `ideal` property should be provided. If both are present, the\n *    `exact` value will be used.\n *\n * When the `exact` value is provided, it will be the only value considered for the option.\n *    If it cannot be used, the constraint will be considered an error.\n *\n * When the `ideal` value is provided, it will be considered as the optimal value for the option.\n *    If it cannot be used, the closest acceptable value will be used instead.\n *\n * A string value can be provided directly instead of using the MediaConstraint format.\n *    Using a string directly is not recommended, since behaviour may differ depending\n *    on browser and media property. For most properties, a direct string value will be\n *    handled as `ideal` behaviour, but some properties may follow the `exact` behaviour\n *    (eg. `deviceId`).\n *\n * @public\n * @static\n * @typedef {Object} MediaConstraint\n * @memberof call\n * @property {string} [exact] The required value for the constraint. Other values will not be accepted.\n * @property {string} [ideal] The ideal value for the constraint. Other values will be considered if necessary.\n * @example\n * // Specify video resolution when making a call.\n * client.call.make(destination, {\n *    audio: true,\n *    video: true,\n *    videoOptions: {\n *      // Set height and width constraints to ideally be 1280x720.\n *      height: { ideal: 720 },\n *      width: { ideal: 1280 }\n *    }\n * })\n */\n\n/**\n * The AudioOptions type defines the format for specifying audio-related constraints.\n *\n * @public\n * @static\n * @typedef {Object} AudioOptions\n * @memberof call\n * @property {call.MediaConstraint} deviceId ID of the microphone to receive audio from.\n * @example\n * // Specify what specific microphone device to use by providing its device ID.\n * client.call.make(destination, {\n *    audio: true,\n *    audioOptions: { deviceId: 'some unique device ID' }\n * })\n */\n\n/**\n * The VideoOptions type defines the format for specifying video-related constraints.\n *\n * @public\n * @static\n * @typedef {Object} VideoOptions\n * @memberof call\n * @property {call.MediaConstraint} deviceId ID of the camera to receive video from.\n * @property {call.MediaConstraint} [height] The height of the video.\n * @property {call.MediaConstraint} [width] The width of the video.\n * @property {call.MediaConstraint} [frameRate] The frame rate of the video.\n * @example\n * client.call.make(destination, {\n *    video: true,\n *    videoOptions: {\n *      deviceId: 'some unique device ID',\n *      // Set height and width constraints to exactly be 1280x720.\n *      height: { exact: 720 },\n *      width: { exact: 1280 },\n *      frameRate: { exact: 24 }\n *    }\n * })\n */\n\n/**\n * The ScreenOptions type defines the format for specifying screen capturing-related constraints.\n *\n * @public\n * @static\n * @typedef {Object} ScreenOptions\n * @memberof call\n * @property {call.MediaConstraint} [height] The height of the screen capture.\n * @property {call.MediaConstraint} [width] The width of the screen capture.\n * @property {call.MediaConstraint} [frameRate] The frame rate of the live screen share.\n * @example\n * client.call.make(destination, {\n *    screen: true,\n *    screenOptions: {\n *      // Set height and width constraints to exactly be 1280x720.\n *      height: { exact: 720 },\n *      width: { exact: 1280 },\n *      frameRate: { exact: 24 }\n *    }\n * })\n */\n\n/**\n * The MediaOffered type defines what media capabilities are offered by the person making a call.\n * This is an optional property and therefore may be null if it is not known or if it's associated with caller's side of the call.\n *\n * @public\n * @static\n * @typedef {Object} MediaOffered\n * @memberof call\n * @property {boolean} audio Specifies if any audio capability has been offered by the caller. If set to true, then the caller is capable of supporting at least one audio stream in the current call.\n * @property {boolean} video Specifies if any video capability has been offered by the caller. If set to true, then the caller is capable of supporting at least one video stream in the current call.\n */\n\n/**\n * The BandwidthControls type defines the format for configuring media and/or track bandwidth options.\n * BandwidthControls only affect received remote tracks of the specified type.\n *\n * @public\n * @static\n * @typedef {Object} BandwidthControls\n * @memberof call\n * @property {number} [call] The desired combined bandwidth bitrate in kilobits per second for all media in the call.\n * @property {number} [audio] The desired bandwidth bitrate in kilobits per second for received remote audio.\n * @property {number} [video] The desired bandwidth bitrate in kilobits per second for received remote video.\n * @example\n * // Specify received remote video bandwidth limits when making a call.\n * client.call.make(destination, mediaConstraints,\n *  {\n *    bandwidth: {\n *      video: 5\n *    }\n *  }\n * )\n */\n\n/**\n * The DSCPControls type defines the format for configuring network priorities (DSCP marking) for the media traffic.\n *\n * If DSCPControls are not configured for a call the network priority of the traffic for all media kinds will be the default (i.e., \"low\").\n *\n * @public\n * @static\n * @typedef {Object} DSCPControls\n * @memberof call\n * @property {RTCPriorityType} [audioNetworkPriority='low'] The desired network priority for audio traffic (see {@link https://www.w3.org/TR/webrtc-priority/#rtc-priority-type RTCPriorityType Enum} for the list of possible values).\n * @property {RTCPriorityType} [videoNetworkPriority='low'] The desired network priority for video traffic (see {@link https://www.w3.org/TR/webrtc-priority/#rtc-priority-type RTCPriorityType Enum} for the list of possible values).\n * @property {RTCPriorityType} [screenNetworkPriority='low'] The desired network priority for screen share traffic (see {@link https://www.w3.org/TR/webrtc-priority/#rtc-priority-type RTCPriorityType Enum} for the list of possible values).\n */\n\n/**\n * Configuration options for an RTCPeerConnection.\n * It represents an RTCPeerConfiguration dictionary, whose parameters are documented {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/RTCPeerConnection#parameters here}.\n * @public\n * @static\n * @typedef {Object} RTCPeerConnectionConfig\n * @memberof call\n * @param {Array<RTCIceServer>} [iceServers] The list of ICE servers to be used for calls.\n *   The full set of properties defined for an RTCIceServer, are mentioned\n *   {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer#properties here}.\n * @param {string} [sdpSemantics='unified-plan'] The sdpSemantics to use (`'unified-plan'` or `'plan-b'`).\n *   As 'plan-b' has become a deprecated option, it will therefore be removed in the future.\n * @param {number} [iceCandidatePoolSize] An unsigned 16-bit integer value which specifies\n *   the size of the prefetched ICE candidate pool. The default value is 0 (meaning no candidate prefetching will occur).\n * @param {string} [iceTransportPolicy] The current ICE transport policy; if the policy isn't specified,\n *   'all' is assumed by default. Possible values are: 'all', 'public', 'relay'.\n * @param {string} [bundlePolicy] For further description on this and other properties,\n *   see {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/RTCPeerConnection#parameters RTCPeerConnection's configuration parameters}.\n */\n\n/**\n * @public\n * @static\n * @typedef {Object} IceServer\n * @memberof call\n * @property {Array<string>|string} urls Either an array of URLs for reaching out several ICE servers or a single URL for reaching one ICE server. See {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer/urls RTCIceServers.urls documentation} to learn more about the actual url format.\n * Starting with Chromium 110, TURN(S) urls must only contain a transport\n * parameter in the query section and STUN urls must not specify any query section.\n * @property {string} [credential] The credential needed by the ICE server.\n * @property {string} [username] The credential needed by the ICE server.\n */\n\n/**\n * This object is provided to the {@link call.IceCollectionCheckFunction IceCollectionCheckFunction}, and contains the\n *  necessary information about the call (i.e., call ID, current call operation), and information about the ongoing ICE collection,\n *  such as the list of all ICE candidates collected so far and the ICE gathering state.\n *\n * @public\n * @static\n * @typedef {Object} IceCollectionInfo\n * @memberof call\n * @property {string} callId The ID of the call.\n * @property {string} callOperation The current operation of the call.\n * @property {string} reason The reason the check function was called. Three possible values:\n *  'NewCandidate' - A new ICE candidate was collected. Note: there may be multiple new ICE candidates collected.\n *  'IceGatheringStateChanged' - The ICE gathering state changed.\n *  'Scheduled' - A scheduled call (for first invocation, and subsequent invocations based on `wait` value returned by {@link call.IceCollectionCheckFunction IceCollectionCheckFunction}.)\n * @property {Array<RTCIceCandidate>} iceCandidates An array of all ICE candidates collected so far.\n * @property {number} iceCollectionDuration The time elapsed since the start of the ICE collection process.\n * @property {string} iceGatheringState The current ICE gathering state.\n *    See {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/iceGatheringState RTCPeerConnection.iceGatheringState}.\n * @property {Object} rtcPeerConnectionConfig The current configration for the RTCPeerConnection.\n * @property {string} rtcLocalSessionDescription The current local session description set on the peer.\n */\n\n/**\n * The form of the ICE collection check function, the arguments that it receives, and the outputs expected.\n *\n * This function is provided the necessary details of the current WebRTC session and ICE collection\n * ({@link call.IceCollectionInfo IceCollectionInfo}), which it can use to dictate how to proceed with a call.\n *  The function can be invoked for three different reasons:\n *  a new ICE candidate was collected, the ICE gathering state changed, or a scheduled call based on the `wait` time set after\n *  an initial invocation of the function.\n *\n * The function must then return an appropriate result object in the format of {@link call.IceCollectionCheckResult IceCollectionCheckResult}\n *  which will dictate how the call will proceed. An incorrect return object, or result `type`, will cause the call to end with an error.\n *\n * [Default]\n * The default IceCollectionCheckFunction uses the following algorithm to determine if the call can proceed to negotiation:\n * 1. If the `iceGatheringState` is \"complete\" at any stage, then:\n *    - Proceed with the negotiation if any ICE candidates are collected.\n *    - Or, end the call if there are no ICE candidates collected.\n * 2. Otherwise, if before the ideal ICE collection timeout:\n *    - If every media has a relay ICE candidate for every configured TURN server, proceed with negotiation.\n *    - Else, wait until the ideal timeout, or when invoked for another reason.\n * 3. Otherwise, if before the max ICE collection timeout, but after the ideal ICE collection timeout:\n *    - If every media has atleast one relay ICE candidate, proceed with negotiation.\n *    - Else, wait until max timeout, or when invoked for another reason.\n * 4. Otherwise, if we are at, or past, the max ICE collection timeout:\n *    - If there are any ICE candidates collected, proceed with negotiation.\n *    - Else, end the call with an error.\n *\n * The ideal and max timeouts can be configured with the `idealIceCollectionTimeout` and `maxIceCollectionTimeout` properties of\n *  the call config.\n * @public\n * @static\n * @typedef {Function} IceCollectionCheckFunction\n * @memberof call\n * @param {call.IceCollectionInfo} iceCollectionInfo Information about the current status of the ICE candidate collection.\n * @param {Object} iceTimeouts Configurations provided to the SDK for ICE collection timeout boundaries.\n * @param {number} iceTimeouts.iceCollectionIdealTimeout The amount of time to wait for ideal candidates, in\n *      milliseconds.  See {@link config#config.call config.call} for more information.\n * @param {number} iceTimeouts.iceCollectionMaxTimeout The maximum amount of time to wait for ICE collection,\n *      in milliseconds. See {@link config#config.call config.call} for more information.\n * @returns {call.IceCollectionCheckResult} Information on how to proceed with the call and/or ICE collection.\n * @example\n * function isRelayCandidate (candidate) {\n * // NOTE: This would need to be different for Firefox since the `.type` property doesn't exist\n * // and we would need to parse it ourselves in the `.candidate` property.\n *   return candidate.type === 'relay'\n * }\n *\n * function myIceCollectionCheck ({ iceGatheringState, iceCandidates }, iceTimeouts) {\n *   if (iceGatheringState === 'complete') {\n *     if (iceCandidates.some(isRelayCandidate)) {\n *       return { type: 'StartCall' }\n *     } else {\n *       return { type: 'Error', error: new Error('Failed to start call because there is no relay candidates.') }\n *     }\n *   } else {\n *     return { type: 'Wait' }\n *   }\n * }\n */\n\n/**\n * @public\n * @static\n * @typedef {Object} IceCollectionCheckResult\n * @memberof call\n * @property {string} type Indicates how the system should proceed with the call operation / ICE collection. The possible values are:\n *    'StartCall' - instruct the system to start the call with the currently gathered ICE candidates and other information.\n *    'Error' - instruct the system to fail the call with an error. The error to communicate to the user should be specified in the `error` property.\n *    'Wait' - instruct the system to wait for the specified amount of time before triggering a new ICE collection check. The amount\n *        of wait time should be specified in the `wait` property.\n * @property {string} error An error to be sent the user when the `type` of the result is `IceCollectionCheckResultType.Error`\n * @property {number} wait The amount of time (in milliseconds) to wait before triggering a new ICE collection check. This is only\n *    valid if the `type` of result is `IceCollectionCheckResultType.Wait`. If a value is not provided, the ICE collection check function\n *    will only be triggered for new candidates or when the ICE gathering state changes.\n */\n\n/**\n * @public\n * @static\n * @typedef {Object} SdpHandlerInfo\n * @memberof call\n * @property {string} callId The id corresponding to the call for which the handler is being run.\n * @property {RTCSdpType} type The session description's type.\n * @property {string} step The step that will occur after the SDP Handlers are run.\n *    Will be either 'set' (the SDP will be set locally) or 'send' (the SDP will\n *    be sent to the remote endpoint).\n * @property {string} endpoint Which end of the connection created the SDP.\n */\n\n/**\n * The form of an SDP handler function and the expected arguments that it receives.\n * @public\n * @static\n * @typedef {Function} SdpHandlerFunction\n * @memberof call\n * @param {Object} newSdp The SDP so far (could have been modified by previous handlers).\n * @param {call.SdpHandlerInfo} info Additional information that might be useful when making SDP modifications.\n * @param {Object} originalSdp The SDP in its initial state.\n * @returns {Object} The resulting modified SDP based on the changes made by this function.\n */\n\n/**\n * The state representation of a Media object.\n * Media is a collection of Track objects.\n *\n * @public\n * @static\n * @typedef {Object} MediaObject\n * @memberof call\n * @property {string} id The ID of the Media object.\n * @property {boolean} local Indicator on whether this media is local or remote.\n * @property {boolean} detached Indicator on whether this media contains detached tracks.\n * @property {Array<call.TrackObject>} tracks A list of Track objects that are contained in this Media object.\n */\n\n/**\n * A Track is a stream of audio or video media from a single source.\n * Tracks can be retrieved using the Media module's `getTrackById` API and manipulated with other functions of the Media module.\n *\n * @public\n * @static\n * @typedef {Object} TrackObject\n * @memberof call\n * @property {Array<string>} containers The list of CSS selectors that were used to render this Track.\n * @property {boolean} disabled Indicator of whether this Track is disabled or not. If disabled, it cannot be re-enabled.\n * @property {boolean} isLocal Indicator of whether this Track is a locally created one or is a remote one.\n * @property {string} id The ID of the Track.\n * @property {string} kind The kind of Track this is (audio, video).\n * @property {string} label The label of the device this Track uses.\n * @property {boolean} muted Indicator on whether this Track is muted or not.\n * @property {boolean} sourceMuted Indicator on whether this Track is receiving media from its source or not.\n *    When true, the Track can be considered removed. This indicator is affected by actions outside the\n *    control of the SDK, such as the remote endpoint of a Call stopping to send media for a remote Track,\n *    or the browser temporarily disabling the SDK's access to a local Track's source.\n * @property {string} state The state of this Track. Can be 'live' or 'ended'.\n * @property {string} streamId The ID of the Media Stream that includes this Track.\n */\n\n/**\n * A collection of media devices and their information.\n *\n * @public\n * @static\n * @typedef {Object} DevicesObject\n * @memberof call\n * @property {Array<call.DeviceInfo>} camera A list of camera device information.\n * @property {Array<call.DeviceInfo>} microphone A list of microphone device information.\n * @property {Array<call.DeviceInfo>} speaker A list of speaker device information.\n */\n\n/**\n * Contains information about a device.\n *\n * @public\n * @static\n * @typedef {Object} DeviceInfo\n * @memberof call\n * @property {string} deviceId The ID of the device.\n * @property {string} groupId The group ID of the device. Devices that share a `groupId` belong to the same physical device.\n * @property {string} kind The type of the device (audioinput, audiooutput, videoinput).\n * @property {string} label The name of the device.\n */\n\n/**\n * Custom SIP headers can be used to convey additional information to a SIP endpoint.\n *\n * These parameters must be configured on the server prior to making a request, otherwise the request will fail when trying to include the parameters.\n *\n * These parameters can be specified with the {@link call.make} and {@link call.answer} APIs.\n * They can also be set after a Call is established using the {@link call.setCustomParameters} API, and sent using the {@link call.sendCustomParameters} API.\n *\n * Custom headers may be received anytime throughout the duration a call. A remote endpoint may send custom headers when starting a call,\n *  answering a call, or during call updates such as hold/unhold and addition/removal of media in the call.\n *  When these custom headers are received, the SDK will emit a {@link call.event:call:customParameters call:customParameters} event\n *  which will contain the custom parameters that were received.\n *\n * A Call's custom parameters are stored on the Call's {@link call.CallObject CallObject},\n *  which can be retrieved using the {@link call.getById} or\n *  {@link call.getAll} APIs. These are the parameters that will be sent to the remote\n *  endpoint of the Call. Parameters received from a Call are not stored as\n *  part of the CallObject and are only provided via the {@link call.event:call:customParameters call:customParameters} event.\n *\n * @public\n * @static\n * @module CustomParameter\n * @typedef {Object} CustomParameter\n * @memberof call\n * @requires link_call\n * @requires callMe\n * @property {string} name - The name of the custom parameter\n * @property {string} value - The value of the custom parameter\n * @example\n * // Specify custom parameters when making a call.\n * client.call.make(destination, mediaConstraints,\n *  {\n *    customParameters: [\n *      {\n *        name: 'X-GPS',\n *        value: '42.686032,23.344565'\n *      }\n *    ]\n *  }\n * )\n */\n\n/**\n * Custom SIP bodies can be used to convey additional information to a SIP endpoint.\n *\n * The appropriate configuration for sending custom bodies must be enabled on the server prior to making call requests,\n *  otherwise the requests will fail when trying to include the bodies.\n *\n * The `contentType` of the custom body should be compliant with RFC 2045, RFC 3261 (and their updated versions),\n *  and the `contentDisposition` should be compliant with RFC 2183, RFC 3204, and RFC 3261 (and their updated versions).\n *\n * These custom bodies can be specified with the {@link call.make} and {@link call.answer} APIs.\n *  They can also be set after a Call is established using the {@link call.setCustomParameters} API.\n *\n * A Call's custom bodies are stored on the Call's {@link call.CallObject CallObject},\n *  which can be retrieved using the {@link call.getById} or\n *  {@link call.getAll} APIs. These custom bodies will be sent to the remote endpoint of the Call for all subsequent\n *  basic midcall operations, such as hold/unhold and add/remove media.\n *\n * @private\n * @static\n * @module CustomBody\n * @typedef {Object} CustomBody\n * @memberof call\n * @requires link_call\n * @requires callMe\n * @property {string} contentType - The media type of the message body.\n * @property {string} contentDisposition - How the message body is to be interpreted.\n * @property {string} body - The message body.\n * @example\n * // Specify custom bodies when making a call.\n * client.call.make(destination, mediaConstraints,\n *  {\n *    customBodies: [\n *      {\n *        contentType: 'text/plain;charset=UTF-8',\n *        contentDisposition: 'render;HANDLING=OPTIONAL',\n *        body: 'Geo location information is sent.'\n *      }\n *    ]\n *  }\n * )\n */\n\n/**\n * Top-level Call API factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @return {Object} API.\n */\nexport default function createAPI(container) {\n  const api = {\n    ...establishApis(container),\n    ...midcallApis(container),\n    ...complexApis(container),\n    ...miscApis(container),\n    ...constantsApis(container)\n  }\n\n  return { call: api }\n}\n","// Call plugin.\nimport { callActions as actions } from '../actions'\nimport * as eventTypes from '../eventTypes'\nimport { getCallById } from '../selectors'\n\n// Helpers.\nimport { formatMediaConstraints, validateDetachedMedia, validateMediaConstraints } from '../utils'\nimport { getLocalTracks } from '../../callstack/utils/call'\n\n// Libraries.\nimport { isEmpty } from 'lodash/fp'\n\n/**\n * Call Midcall APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} Midcall API.\n */\nexport default function createAPI(container) {\n  const { CallManager, context, logManager, API_LOG_TAG, emitEvent } = container\n  const log = logManager.getLogger('CALL')\n\n  /**\n   * Puts a call on hold.\n   *\n   * The specified call to hold must not already be locally held. Any/all\n   *    media received from the remote participant will stop being received,\n   *    and any/all media being sent to the remote participant will stop\n   *    being sent.\n   *\n   * Some call operations cannot be performed while the call is on hold. The\n   *    call can be taken off hold with the {@link call.unhold} API.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. The remote participant\n   *    will be notified of the operation through a\n   *    {@link call.event:call:stateChange call:stateChange} event as well.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @method hold\n   * @param {string} callId The ID of the call to hold.\n   */\n  async function hold(callId) {\n    log.debug(API_LOG_TAG + 'call.hold: ', callId)\n    context.dispatch(actions.holdCall(callId))\n\n    // Call state before the operation (but after holdCall action).\n    const call = getCallById(context.getState(), callId)\n\n    // Start the operation\n    let error\n    try {\n      await CallManager.hold(callId)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.holdCallFinish(callId, {\n          local: true,\n          error\n        })\n      )\n\n      // call:stateChange error event.\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: call ? call.state : undefined,\n          localHold: call ? call.localHold : undefined,\n          remoteHold: call ? call.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  /**\n   * Takes a call off hold.\n   *\n   * The specified call to unhold must be locally held. If the call is not\n   *    also remotely held, call media will be reconnected as it was before\n   *    the call was held.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. The remote participant\n   *    will be notified of the operation through a\n   *    {@link call.event:call:stateChange call:stateChange} event as well.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @method unhold\n   * @param {string} callId The ID of the call to unhold.\n   */\n  async function unhold(callId) {\n    log.debug(API_LOG_TAG + 'call.unhold: ', callId)\n    context.dispatch(actions.unholdCall(callId))\n\n    // Call state before the operation (but after unholdCall action).\n    const call = getCallById(context.getState(), callId)\n\n    // Start the operation\n    let error\n    try {\n      await CallManager.unhold(callId)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.unholdCallFinish(callId, {\n          local: true,\n          error\n        })\n      )\n\n      emitEvent(eventTypes.CALL_STATE_CHANGE, {\n        callId,\n        previous: {\n          state: call ? call.state : undefined,\n          localHold: call ? call.localHold : undefined,\n          remoteHold: call ? call.remoteHold : undefined\n        },\n        error\n      })\n    }\n  }\n\n  /**\n   * Add new media tracks to an ongoing call.\n   * Will get new media tracks from the specific sources to add to the call.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:newTrack call:newTrack} event\n   *    both for the local and remote users to indicate a track has been\n   *    added to the Call.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string}  callId The ID of the call to add media to.\n   * @param {Object}  [media={}] The media options to add to the call.\n   * @param {boolean} [media.audio=false] Whether to add audio to the call.\n   * @param {boolean} [media.video=false] Whether to add video to the call.\n   * @param {boolean} [media.screen=false] Whether to add the screenshare to the call. (Note: Screensharing is not supported on iOS Safari.)\n   * @param {Array}   [media.medias] List of medias containing tracks to be attached to this call.\n   * @param {call.AudioOptions}  [media.audioOptions] Options for configuring the call's audio.\n   * @param {call.VideoOptions}  [media.videoOptions] Options for configuring the call's video.\n   * @param {call.ScreenOptions} [media.screenOptions] Options for configuring the call's screenShare.\n   * @param {Object} [options]\n   * @param {call.BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n   * @param {call.DSCPControls} [options.dscpControls] Options for configuring DSCP markings on the media traffic\n   * @throws {BasicError} Throws an error if mediaConstraints.medias is not an array.\n   * @throws {BasicError} Throws an error if mediaConstraints.medias Objects are missing `media` and `type` properties.\n   * @throws {BasicError} Throws an error if mediaConstraints contains duplicate media kinds.\n   * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are not detached.\n   * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are not local.\n   * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are already in use by a session.\n   * @throws {BasicError} Throws an error if mediaConstraints.medias contains any type other than Object containing `media` and `type` properties.\n   */\n  async function addMedia(callId, media = {}, options = {}) {\n    log.debug(API_LOG_TAG + 'call.addMedia: ', callId, media, options)\n\n    // Start the operation\n    let error\n    try {\n      // Validate mediaConstraints\n      validateMediaConstraints(media)\n\n      // Validating detached media before attempting to start a call.\n      // This verifies that the detached media being provided is, detached, local\n      // and not already in use by a session.\n      if (media.medias) {\n        validateDetachedMedia(media.medias)\n      }\n\n      const mediaConstraints = formatMediaConstraints(media)\n\n      context.dispatch(actions.addMedia(callId, { mediaConstraints, ...options }))\n\n      await CallManager.addMedia(callId, mediaConstraints, options)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.addMediaFinish(callId, {\n          local: true,\n          error\n        })\n      )\n\n      // call:newMedia error event.\n      emitEvent(eventTypes.CALL_ADDED_MEDIA, {\n        callId,\n        local: true,\n        error\n      })\n    }\n  }\n\n  /**\n   * Remove tracks from an ongoing call.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:trackEnded call:trackEnded}\n   *    event for both the local and remote users to indicate that a track\n   *    has been removed.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string} callId The ID of the call to remove media from.\n   * @param {Array} tracks A list of track IDs to remove.\n   * @param {Object} [options]\n   * @param {call.BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n   */\n  async function removeMedia(callId, tracks, options = {}) {\n    log.debug(API_LOG_TAG + 'call.removeMedia: ', callId, tracks)\n\n    context.dispatch(actions.removeMedia(callId, { tracks, ...options }))\n\n    // Start the operation\n    let error\n    try {\n      await CallManager.removeMedia(callId, tracks, options)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.removeMediaFinish(callId, {\n          local: true,\n          error\n        })\n      )\n\n      // call:removedMedia error event\n      emitEvent(eventTypes.CALL_REMOVED_MEDIA, {\n        callId,\n        local: true,\n        error\n      })\n    }\n  }\n\n  /**\n   * Adds local video to an ongoing Call, to start sending to the remote\n   *    participant.\n   *\n   * Can only be used in a basic media scenario, where the Call does not\n   *    already have video. For more advanced scenarios, the\n   *    {@link call.addMedia} API can be used.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:tracksAdded call:tracksAdded}\n   *    event both for the local and remote users to indicate a track has been\n   *    added to the Call.\n   *\n   * @public\n   * @static\n   * @method startVideo\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string}                 callId              ID of the call being acted on.\n   * @param {call.VideoOptions}      [videoOptions]      Options for configuring the call's video.\n   * @param {Object}                 [options]\n   * @param {call.BandwidthControls} [options.bandwidth] Options for configuring media's bandwidth.\n   * @param {call.DSCPControls}      [options.dscpControls] Options for configuring DSCP markings on the media traffic.\n   */\n  async function startVideo(callId, videoOptions = {}, options = {}) {\n    log.debug(API_LOG_TAG + 'call.startVideo: ', callId, options)\n\n    const mediaConstraints = {\n      audio: false,\n      video: !isEmpty(videoOptions) ? videoOptions : true,\n      screen: false\n    }\n\n    const action = actions.addBasicMedia(callId, { mediaConstraints, kind: 'video', ...options })\n    context.dispatch(action)\n\n    // Start the operation\n    let error\n    try {\n      await CallManager.addBasicMedia(callId, mediaConstraints, options)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.addMediaFinish(callId, {\n          local: true,\n          error\n        })\n      )\n\n      // call:newMedia error event.\n      emitEvent(eventTypes.CALL_ADDED_MEDIA, {\n        callId,\n        local: true,\n        error\n      })\n    }\n  }\n\n  /**\n   * Removes local video from an ongoing Call, stopping it from being sent\n   *    to the remote participant.\n   *\n   * Can only be used in a basic media scenario, where the Call has only one\n   *    video track. For more advanced scenarios, the\n   *    {@link call.removeMedia} API can be used.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a {@link call.event:call:tracksRemoved call:tracksRemoved}\n   *    event for both the local and remote users to indicate that a track\n   *    has been removed.\n   *\n   * @public\n   * @static\n   * @method stopVideo\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string} callId ID of the call being acted on.\n   */\n  async function stopVideo(callId) {\n    log.debug(API_LOG_TAG + 'call.stopVideo: ', callId)\n\n    context.dispatch(actions.removeBasicMedia(callId, { kind: 'video' }))\n    const tracks = getLocalTracks(context, callId, 'video')\n    const trackIds = tracks.map(trackObj => trackObj.trackId)\n\n    // Start the operation\n    let error\n    try {\n      await CallManager.removeBasicMedia(callId, trackIds)\n    } catch (err) {\n      error = err\n\n      context.dispatch(\n        actions.removeMediaFinish(callId, {\n          local: true,\n          error\n        })\n      )\n\n      // call:removedMedia error event\n      emitEvent(eventTypes.CALL_REMOVED_MEDIA, {\n        callId,\n        local: true,\n        error\n      })\n    }\n  }\n\n  /**\n   * Replace a call's track with a new track of the same media type.\n   *\n   * The operation will remove the old track from the call and add a\n   *    new track to the call. This effectively allows for changing the\n   *    track constraints (eg. device used) for an ongoing call.\n   *\n   * Because it completely replaces an old track with a new one,\n   * the old track's state characteristics are not carried over in the new track's state.\n   * (e.g. if an old track's state was 'muted' and replacement of this track has occured,\n   * the new track's state will be 'unmuted', as this is its default state)\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a\n   *    {@link call.event:call:trackReplaced call:trackReplaced} event\n   *    locally when the operation completes. The newly added track will need\n   *    to be handled by the local application. The track will be replaced\n   *    seamlessly for the remote application, which will not receive an event.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string} callId The ID of the call to replace the track of.\n   * @param {string} trackId The ID of the track to replace.\n   * @param {Object} [media={}] The media options.\n   * @param {boolean} [media.audio=false] Whether to create an audio track.\n   * @param {call.AudioOptions} [media.audioOptions] Options for configuring the audio track.\n   * @param {boolean} [media.video=false] Whether to create a video track.\n   * @param {call.VideoOptions} [media.videoOptions] Options for configuring the video track.\n   * @param {boolean} [media.screen=false] Whether to create a screen share track.\n   * @param {call.ScreenOptions} [media.screenOptions] Options for configuring the call's screenShare.\n   * @param {Array} [media.medias] List of medias containing tracks to be attached to this call.\n   * @example\n   * const callId = ...\n   * // Get the video track used by the call.\n   * const videoTrack = ...\n   *\n   * // Replace the specified video track of the call with a new\n   * //    video track.\n   * client.call.replaceTrack(callId, videoTrack.id, {\n   *   // The track should be replaced with a video track using\n   *   //    a specific device. This effectively changes the input\n   *   //    device for an ongoing call.\n   *   video: true,\n   *   videoOptions: {\n   *     deviceId: cameraId\n   *   }\n   * })\n   *\n   * @example\n   * const callId = ...\n   * // Get the video track used by the call.\n   * const videoTrack = ...\n   *\n   * // Can also replace the specified video track of the call with a new\n   * // screen sharing track because screen sharing is delivered as a video stream to remote peer.\n   * // User will then be prompted to pick a specific screen to share and thus the device id will be selected.\n   * client.call.replaceTrack(callId, videoTrack.id, {\n   *   // The track should be replaced with a screen sharing track.\n   *   // Note that 'screenOptions' property is not mandatory, as API will use default values\n   *   // for properties like: width, height, frameRate.\n   *   screen: true\n   * })\n   */\n  async function replaceTrack(callId, trackId, media) {\n    log.debug(API_LOG_TAG + 'call.replaceTrack: ', callId, trackId, media)\n\n    const mediaConstraints = formatMediaConstraints(media)\n    context.dispatch(actions.replaceTrack(callId, { trackId, mediaConstraints }))\n\n    // Start the operation\n    let error\n    let result = {}\n    try {\n      // Validate mediaConstraints\n      validateMediaConstraints(media)\n\n      // Validating detached media before attempting to start a call.\n      // This verifies that the detached media being provided is, detached, local\n      // and not already in use by a session.\n      if (media.medias) {\n        validateDetachedMedia(media.medias)\n      }\n\n      result = await CallManager.replaceTrack(callId, trackId, mediaConstraints)\n    } catch (err) {\n      error = err\n    }\n\n    context.dispatch(\n      actions.replaceTrackFinish(callId, {\n        ...result,\n        error\n      })\n    )\n\n    // Both events are issued for either success of failure path\n    emitEvent(eventTypes.CALL_TRACK_REPLACED, {\n      callId,\n      newTrackId: error ? undefined : result.newTrackId,\n      oldTrack: error ? undefined : result.oldTrackState,\n      error\n    })\n  }\n\n  /**\n   * Attempt to re-establish a media connection for a call.\n   *\n   * This API will perform a \"refresh\" operation on the call with the intention\n   *    of resolving media issues that may have been encountered. This API is only\n   *    necessary after the Call's {@link call.mediaConnectionStates mediaConnectionState}\n   *    has entered the `failed` state, but may be used in other scenarios.\n   *\n   * After the operation completes successfully, the Call will be re-establishing\n   *    its media connection. By this time, or shortly after, the Call's\n   *    {@link call.mediaConnectionStates mediaConnectionState} should have\n   *    transitioned to `checking` (via a\n   *    {@link call.event:call:mediaConnectionChange call:mediaConnectionChange}\n   *    event) to signify the re-establishment. It will then transition to either\n   *    `connected` or `failed` state, similar to during the initial Call establishment.\n   *\n   * If this operation fails, then the Call will not attempt the re-establishment\n   *    and will remain in the `failed` {@link call.mediaConnectionStates mediaConnectionState}.\n   *\n   * Behaviour during the operation may differ slightly based on the browser.\n   *    Notably, Firefox will always transition to the `checking`\n   *    {@link call.mediaConnectionStates mediaConnectionState} no matter what\n   *    the previous state was. Whereas Chrome will skip the `checking` state,\n   *    transitioning directly to either `connected` or `failed`. This has the\n   *    implication for Chrome that if the state does not change (for example,\n   *    the Call is in the `failed` state before the media restart operation,\n   *    and media re-establishment fails), then there will be no\n   *    {@link call.event:call:mediaConnectionChange call:mediaConnectionChange}\n   *    event emitted. For this reason, Chrome-based applications may need a\n   *    short delay after receiving the {@link call.event:call:mediaRestart call:mediaRestart}\n   *    event before checking the Call's updated\n   *    {@link call.mediaConnectionStates mediaConnectionState} to ensure the\n   *    application is acting on the \"latest\" state.\n   *\n   * The SDK will emit a {@link call.event:call:mediaRestart call:mediaRestart}\n   *    event when the operation completes.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   * @public\n   * @static\n   * @memberof call\n   * @method restartMedia\n   * @param {string} callId The ID of the call to act on.\n   */\n  async function restartMedia(callId) {\n    log.debug(`${API_LOG_TAG}call.restartMedia, callId: ${callId}`)\n\n    context.dispatch(actions.restartMedia(callId))\n\n    try {\n      await CallManager.iceRestart(callId)\n    } catch (error) {\n      context.dispatch(\n        actions.restartMediaFinish(callId, {\n          local: true,\n          error: error\n        })\n      )\n\n      emitEvent(eventTypes.MEDIA_RESTART, {\n        callId,\n        error\n      })\n    }\n  }\n\n  /**\n   * Re-sync a Call with the server by fetching the status of the Call on the server.\n   *\n   * This may be useful to get and update a call's state after processing incoming notifications\n   *    some time after they were received (e.g., waiting to process incoming call push notifications\n   *    till a connection is established).\n   *\n   * The progress of the `RESYNC` operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} events.\n   *\n   * The SDK may emit a {@link call.event:call:operation call:operation} event after the `RESYNC` operation is\n   *    complete if the call was ended do to the resync.\n   * @private\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires link_call\n   * @method resync\n   * @param {string} callId The ID of the call to re-sync.\n   */\n  async function resync(callId) {\n    log.debug(`${API_LOG_TAG}call.resync, callId: ${callId}`)\n    context.dispatch(actions.resync(callId))\n\n    let error\n    try {\n      await CallManager.resyncCallState(callId)\n    } catch (err) {\n      error = err\n    }\n\n    context.dispatch(actions.resyncFinish(callId, { error }))\n  }\n\n  /**\n   * Plays an audio file to the remote side of the Call. This API will temporarily\n   *    replace the Call's local audio track with an audio file for the duration\n   *    of the audio file.\n   *\n   * The Call must be in `Connected` state and have a local audio track for this operation.\n   *\n   * This API will not affect media other than the local audio track. Other media on\n   *    the Call, such as local video or remote audio, can be {@link media.muteTracks muted}\n   *    or {@link media.removeTracks unrendered} during this operation if desired.\n   *\n   * This operation will use the browser's\n   *    [Audio constructor](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement/Audio)\n   *    to read in the audio file. The `filePath` parameter will be used directly with `Audio`, so\n   *    can be either a relative file path to your audio file or a URL pointing to a file.\n   *\n   * This API returns a promise that can be used to track the progress of the operation.\n   *    The promise will resolve after the operation completes or reject if an error is\n   *    encountered. Additionally, an extra `onPlaying` callback is provided on the Promise\n   *    to indicate when the audio file actually begins to play. See the code example below\n   *    for a sample.\n   *\n   * The SDK will emit {@link call.event:call:operation call:operation} events locally\n   *    as the operation progresses. The remote endpoint will not receive an event for\n   *    this operation.\n   *\n   * If an error is encountered during the operation and the SDK is unable to replace\n   *    the original local audio track, then that track will be forcibly ended and an\n   *    {@link media.event:media:trackEnded media:trackEnded} event will be emitted\n   *    for it. This will release the microphone and avoid losing access to the track\n   *    while it is active, allowing the application to resolve the scenario by using\n   *    the {@link call.replaceTrack} API to revert the local audio track.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @method playAudioFile\n   * @param {string} callId The ID of the Call to act on.\n   * @param {string} filePath The path to the audio file.\n   * @return {Promise} Promise that resolves when the operation is complete.\n   * @example\n   * // The API returns a promise which will provide feedback about the operation.\n   * client.call.playAudioFile(callId, filePath)\n   *    .then(() => {\n   *      // Audio file has finished playing; call has reverted to previous audio.\n   *    })\n   *    .catch(err => {\n   *      // An error has occurred during the operation.\n   *    })\n   *\n   * // The returned promise can optionally provide feedback midway through the\n   * //   operation. A chainable `onPlaying` method denotes when the audio file has\n   * //   started to play and the Call's audio has been replaced.\n   * client.call.playAudioFile(callId, filePath)\n   *    .onPlaying(({ duration }) => {\n   *      // Audio file has started playing; call audio is now the file.\n   *      // Note: Calling `onPlaying` must be done before `then` and `catch` for it\n   *      //    to be chainable.\n   *    })\n   *    .then(() => { ... })\n   *    .catch(err => { ... })\n   */\n  function playAudioFile(callId, filePath) {\n    log.debug(`${API_LOG_TAG}call.playAudioFile`, filePath)\n\n    let onPlayingCallback\n    const operation = new Promise((resolve, reject) => {\n      // Internal callback for when audio starts playing. Calls the app-callback\n      //    if one was provided.\n      function onPlaying(val) {\n        if (onPlayingCallback && typeof onPlayingCallback === 'function') {\n          onPlayingCallback(val)\n        }\n      }\n\n      // Dispatch action to update call operation state.\n      context.dispatch(actions.playAudio(callId, filePath))\n\n      CallManager.playAudioFile(callId, filePath, onPlaying)\n        .then(() => {\n          // Dispatch action to update call operation state.\n          context.dispatch(actions.playAudioFinish(callId))\n          resolve()\n        })\n        .catch(error => {\n          // Dispatch action to update call operation state.\n          context.dispatch(actions.playAudioFinish(callId, error))\n          reject(error)\n        })\n    })\n\n    /*\n     * Add a function to the Promise so the application can provide a callback\n     *    function for when the audio starts playing.\n     */\n    operation.onPlaying = callback => {\n      onPlayingCallback = callback\n      // Return the `operation` so this can be chained.\n      return operation\n    }\n\n    return operation\n  }\n\n  return {\n    hold,\n    unhold,\n    addMedia,\n    removeMedia,\n    startVideo,\n    stopVideo,\n    replaceTrack,\n    restartMedia,\n    resync,\n    playAudioFile\n  }\n}\n","// Call plugin.\nimport { getCalls, getCallById } from '../selectors'\nimport { callActions as actions } from '../actions'\nimport * as eventTypes from '../eventTypes'\n\n// Other plugins\nimport { setSdpHandlers as setSdpHandlersAction } from '../../../config/interface/actions'\n\n/**\n * Call Misc APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} Misc API.\n */\nexport default function createAPI(container) {\n  const { context, CallManager, Callstack, CallReporter, emitEvent, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('CALL')\n\n  /**\n   * Retrieves the information of all calls made during the current session.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @method getAll\n   * @return {Array<call.CallObject>} Call objects.\n   * @example\n   * let calls = client.call.getAll()\n   * let currentCalls = calls.filter(call => {\n   *     return call.state === client.call.states.CONNECTED\n   * })\n   */\n  function getAll() {\n    log.debug(API_LOG_TAG + 'call.getAll')\n    return getCalls(context.getState())\n  }\n\n  /**\n   * Retrieves the information of a single call with a specific call ID.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @static\n   * @method getById\n   * @param {string} callId The ID of the call to retrieve.\n   * @return {call.CallObject} A call object.\n   */\n  function getById(callId) {\n    log.debug(API_LOG_TAG + 'call.getById: ', callId)\n    return getCallById(context.getState(), callId)\n  }\n\n  /**\n   * Sends the \"ringing feedback\" notification to the remote participant of a call.\n   *\n   * When using the 'manual' `ringingFeedbackMode` configuration, the application\n   *    is responsible for transitioning the call into the `Ringing` state. This\n   *    API will notify both ends of the call to enter `Ringing` state at the same\n   *    time. The application may decide not to send the \"ringing feedback\"\n   *    notification by not using this API. The `ringingFeedbackMode` configuration\n   *    must be set to 'manual' to use this API.\n   *\n   * The specified call must be an incoming call in `Initiated` state. The call\n   *    will enter `Ringing` state as a result of the operation.\n   *\n   * The SDK will emit a {@link call.event:call:stateChange call:stateChange}\n   *    event locally when the operation completes. The remote participant will\n   *    be notified of the operation through a\n   *    {@link call.event:call:stateChange call:stateChange} event as well.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @method sendRingingFeedback\n   * @param {string} callId The ID of the call.\n   */\n  async function sendRingingFeedback(callId) {\n    log.debug(API_LOG_TAG + 'call.sendRingingFeedback: ', callId)\n\n    // Dispatch this action for backwards compatibility\n    context.dispatch(actions.sendRingingFeedback(callId))\n    // Get the call state now for the call state change event previous state\n    const call = getCallById(context.getState(), callId)\n\n    let error\n    try {\n      await CallManager.sendRingingFeedback(callId)\n    } catch (err) {\n      error = err\n    }\n\n    context.dispatch(actions.sendRingingFeedbackFinish(callId, { error }))\n\n    emitEvent(eventTypes.CALL_STATE_CHANGE, {\n      callId,\n      previous: {\n        state: call ? call.state : undefined,\n        localHold: call ? call.localHold : undefined,\n        remoteHold: call ? call.remoteHold : undefined\n      },\n      error\n    })\n  }\n\n  /**\n   * Set the {@link call.CustomParameter Custom Parameters} of a Call, to be provided to the remote endpoint.\n   *\n   * The specified parameters will be saved as part of the call's information throughout the duration of the call.\n   * All subsequent call operations will include these custom parameters.\n   * Therefore, invalid parameters, or parameters not previously configured on the server, will cause subsequent call operations to fail.\n   *\n   * A Call's custom parameters are a property of the Call's {@link call.CallObject CallObject},\n   *    which can be retrieved using the {@link call.getById} or\n   *    {@link call.getAll} APIs.\n   *\n   * The custom parameters set on a call can be sent directly with the {@link call.sendCustomParameters} API.\n   *\n   * Custom parameters can be removed from a call's information by setting them as undefined (e.g., `call.setCustomParameters(callId)`).\n   * Subsequent call operations will no longer send custom parameters.\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @requires callMe\n   * @method setCustomParameters\n   * @param {string} callId The ID of the call.\n   * @param {Array<call.CustomParameter>} customParameters The custom parameters to set.\n   */\n\n  /**\n   * Set custom SIP headers and bodies for a call, to be provided to the remote endpoint.\n   *\n   * This API takes either an array of {@link call.CustomParameter Custom Parameters}, or if custom bodies\n   *  also need to be set, an object consisting of either {@link call.CustomParameter Custom Parameters} or\n   *  {@link call.CustomBody Custom Bodies} or both.\n   *\n   * Note that usage of the `setCustomParameters` API will completely overwrite any previously set headers and bodies.\n   *  Therefore, if either parameters or headers are omitted during subsequent API calls, they will\n   *  be overwritten to undefined.\n   * @private\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @method setCustomParameters\n   * @param {Array<call.CustomParameter> | Object} customParameters The custom parameters to set.\n   * @param {Array<call.CustomParameter>} [customParameters.customParameters] Custom SIP headers for the SIP backend.\n   * @param {Array<call.CustomBody>} [customParameters.customBodies] Custom SIP bodies for the SIP backend.\n   */\n  async function setCustomParameters(callId, customParameters) {\n    log.debug(API_LOG_TAG + 'call.setCustomParameters: ', callId, customParameters)\n    context.dispatch(actions.setCustomParameters(callId, customParameters))\n  }\n\n  /**\n   * Send the custom parameters on an ongoing call to the server. The server may either consume the headers or relay them\n   * to another endpoint, depending on how the server is configured.\n   *\n   * A Call's custom parameters are a property of the Call's {@link call.CallObject CallObject},\n   *    which can be retrieved using the {@link call.getById} or\n   *    {@link call.getAll} APIs.\n   *\n   * Before sending custom parameters, they need to be first set on the existing Call.\n   * To set, change or remove the custom parameters on a call, use the {@link call.setCustomParameters} API.\n   * @public\n   * @static\n   * @memberof call\n   * @requires link_call\n   * @requires callMe\n   * @method sendCustomParameters\n   * @param {string} callId The ID of the call being acted on.\n   */\n  async function sendCustomParameters(callId) {\n    log.debug(API_LOG_TAG + 'call.sendCustomParameters: ', callId)\n    context.dispatch(actions.sendCustomParameters(callId))\n\n    let error\n    try {\n      await CallManager.sendCustomParameters(callId)\n    } catch (err) {\n      error = err\n    }\n\n    context.dispatch(actions.sendCustomParametersFinish(callId, { error }))\n  }\n\n  /**\n   * Send DTMF tones to a call's audio.\n   *\n   * The provided tone can either be a single DTMF tone (eg. '1') or a\n   *    sequence of DTMF tones (eg. '123') which will be played one after the\n   *    other.\n   *\n   * The specified call must be either in Connected, Ringing, or Early Media\n   *    state, otherwise invoking this API will have no effect.\n   *\n   * The tones will be sent as out-of-band tones if supported by the call,\n   *    otherwise they will be added in-band to the call's audio.\n   *\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @method sendDTMF\n   * @param {string} callId ID of the call being acted on.\n   * @param {string} tone DTMF tone(s) to send. Valid characters are ['0','1','2','3','4','5','6','7','8','9','#','*' and ','].\n   * @param {number} [duration=100] The amount of time, in milliseconds, that each DTMF tone should last.\n   * @param {number} [intertoneGap=70] The length of time, in milliseconds, to wait between tones.\n   *\n   */\n  async function sendDTMF(callId, tone, duration = 100, intertoneGap = 70) {\n    log.debug(API_LOG_TAG + 'call.sendDTMF: ', callId, tone, duration, intertoneGap)\n\n    if (typeof tone === 'number') {\n      // Convert the tone into a string if it is a number.\n      tone = tone + ''\n    }\n\n    // Dispatch this action for backwards compatibility.\n    context.dispatch(actions.sendDTMF(callId, { tone, duration, intertoneGap }))\n\n    let error\n    try {\n      await CallManager.sendDtmf(callId, tone, { duration, intertoneGap })\n    } catch (err) {\n      error = err\n    }\n\n    // Dispatch this action for backwards compatibility.\n    context.dispatch(actions.sendDTMFFinish(callId, { error }))\n  }\n\n  /**\n   * Retrieve a snapshot of the low-level information of the Call through statistical\n   *    report.\n   *\n   * The data retrieved is a [RTCStatsReport](https://developer.mozilla.org/en-US/docs/Web/API/RTCStatsReport)\n   *    object, which contains many individual\n   *    [RTCStats](https://developer.mozilla.org/en-US/docs/Web/API/RTCStats).\n   *    These are advanced statistics gathered by the browser providing insights\n   *    into the Call at a certain point in time. Aggregating reports over a\n   *    period of time would allow a low-level analysis of the Call for that\n   *    period. As an example, this could be done to determine the media quality\n   *    during the Call.\n   *\n   * A Track ID can optionally be provided to get a report for a specific local\n   *    Track of the Call.\n   *\n   * This API will return a promise which, when resolved, will contain the report of the particular call.\n   * The progress of the operation will be tracked via the\n   *    {@link call.event:call:operation call:operation} event.\n   *\n   * The SDK will emit a\n   *    {@link call.event:call:statsReceived call:statsReceived} event, after\n   *    the operation completes, that has the report.\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string} callId The ID of the Call to retrieve the report.\n   * @param {string} [trackId] ID of a local Track being used by the Call. If not\n   *    provided, RTCStatsReport is generated for the Call itself.\n   * @return {Promise} A promise that will resolve with the stats report or an error if it fails.\n   * @example\n   * // Get a snapshot of the Call's stats.\n   * //   This may be done on a regular interval to collect data over time.\n   * try {\n   *    // The API will return a promise that resolves with the stats.\n   *    const result = await client.call.getStats(callId)\n   *    result.forEach(stats => {\n   *        // Handle the data on its own or collate with previously gathered stats\n   *        //    for analysis.\n   *        ...\n   *    })\n   * } catch (err) {\n   *    // Handle the error.\n   *    const { code, message } = err\n   *    ...\n   * }\n   */\n  async function getStats(callId, trackId) {\n    log.debug(API_LOG_TAG + 'call.getStats: ', callId, trackId)\n\n    context.dispatch(actions.getStats(callId, { trackId }))\n\n    let result, error\n    try {\n      result = await CallManager.getStats(callId, trackId)\n    } catch (err) {\n      error = err\n      throw error\n    } finally {\n      // Handle the success and failure paths together; with either one of\n      //    result/error being defined and the other not.\n      context.dispatch(\n        actions.getStatsFinish(callId, {\n          error,\n          result,\n          trackId\n        })\n      )\n\n      emitEvent(eventTypes.STATS_RECEIVED, {\n        callId,\n        result,\n        trackId,\n        error\n      })\n    }\n\n    // Resolve the API's promise with the results.\n    return result\n  }\n\n  /**\n   * Retrieve the list of available and supported codecs based on the browser's capabilities for sending media.\n   *\n   * This API will return a promise which, when resolved, it will contain the list of available and supported codecs.\n   * In addition, the SDK emits a {@link call.event:call:availableCodecs call:availableCodecs} event\n   *  upon retrieving that list of codecs.\n   *\n   * This API is a wrapper for the static method {@link https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender-getcapabilities RTCRtpSender.getCapabilities()}.\n   *\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string} kind The kind of media, i.e., 'audio' or 'video', to get the list of available codecs of.\n   * @return {Promise} A promise that will resolve with an object containing the available codecs, along with the `kind` parameter, that was supplied in the first place.\n   *         If there was an error, it will return undefined.\n   * @example\n   * try {\n   *    // The API will return a promise that resolves with the codecs.\n   *    const result = await client.call.getAvailableCodecs('audio')\n   *    result.forEach(codec => {\n   *        // Inspect the codec supported by browser by looking at its properties.\n   *        ...\n   *    })\n   * } catch (err) {\n   *    // Handle the error.\n   *    const { code, message } = err\n   *    ...\n   * }\n   */\n  async function getAvailableCodecs(kind) {\n    log.debug(`${API_LOG_TAG}call.getAvailableCodecs, kind: ${kind}`)\n\n    // Dispatch this action for backwards compatibility\n    context.dispatch(actions.getAvailableCodecs({ kind }, { promise: {} }))\n    let codecs\n    try {\n      codecs = await Callstack.operations.getAvailableCodecs(kind)\n\n      // Final action dispatched, for backwards compatibility\n      context.dispatch(\n        actions.availableCodecsRetrieved({\n          kind,\n          codecs\n        })\n      )\n\n      emitEvent(eventTypes.AVAILABLE_CODECS, {\n        kind,\n        codecs\n      })\n    } catch (err) {\n      log.debug('Failed to retrieve codecs: ', err.message)\n      // Return a rejected Promise instance, in order to keep backwards compatibility\n      // Operation may throw a BasicError but for backwards compatibility, we use Error instance\n      return await Promise.reject(new Error(err.message))\n      // If there is an error, no further actions (or events) dispatched\n    }\n\n    // Return a resolved Promise instance, in order to keep backwards compatibility\n    return await Promise.resolve(codecs)\n  }\n\n  /**\n   * Retrieve the call metrics report for a call.\n   *\n   * The object returned from this API will be in JSON format. The top level object is the report and will include\n   * a timeline of events that were recorded during a call as well as a map object containing computed metrics.\n   *\n   * Any event in a timeline will have it's own timeline that may have recorded events. Events in a timeline are scoped\n   * to that timelines event or report.\n   *\n   * The report and some events may have additional data included in a data property.\n   *\n   * See event documentation {@link call.reportEvents here}.\n   * See metrics documentation {@link call.metrics here}.\n   *\n   * @method getReport\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {string} callId The id of the call to retrieve the report on.\n   * @return {Object} An object containing all metrics and data tracked against this call.\n   */\n  function getReport(callId) {\n    log.debug(API_LOG_TAG + 'call.getReport: ', callId)\n\n    const report = CallReporter.getReport(callId)\n    return report ? report.getSerializable() : report\n  }\n\n  /**\n   * Set {@link call.SdpHandlerFunction SDP Handler Functions} that will be run as part of a pipeline for all future calls.\n   *  This will replace any SDP Handlers that were previously set.\n   *\n   * SDP handlers can be used to make modifications to the SDP (e.g., removing certain codecs)\n   *  before they are processed or sent to the other side.\n   *\n   * This is an advanced feature, changing the SDP handlers mid-call may cause\n   *  unexpected behaviour in future call operations for that call.\n   *\n   * @method setSdpHandlers\n   * @public\n   * @static\n   * @memberof call\n   * @requires call\n   * @requires callMe\n   * @param {Array<call.SdpHandlerFunction>} sdpHandlers The list of SDP handler functions to modify SDP.\n   * @return {undefined}\n   */\n  function setSdpHandlers(sdpHandlers) {\n    log.debug(`${API_LOG_TAG}call.setSdpHandlers, sdpHandlers:`, sdpHandlers)\n\n    context.dispatch(setSdpHandlersAction(sdpHandlers))\n  }\n\n  return {\n    getAll,\n    getById,\n    sendRingingFeedback,\n    setCustomParameters,\n    sendCustomParameters,\n    sendDTMF,\n    getStats,\n    getReport,\n    getAvailableCodecs,\n    setSdpHandlers\n  }\n}\n","/**\n * Blocking operations that can be performed on a call.\n * ie. no two of these operations, either local or remote,\n *    can be performed at the same time.\n * TODO: Should all operations just be listed here? Probably.\n */\nexport const OPERATIONS = {\n  // Establishment.\n  MAKE: 'MAKE',\n  MAKE_ANONYMOUS: 'MAKE_ANONYMOUS',\n  ANSWER: 'ANSWER',\n  SLOW_ANSWER: 'SLOW_ANSWER',\n  REJECT: 'REJECT',\n  IGNORE: 'IGNORE',\n  END: 'END',\n  SEND_RINGING_FEEDBACK: 'SEND_RINGING_FEEDBACK',\n  // TODO: Make sure these constants and actionTypes are in-sync with each\n  //    other. Use one to build the other.\n  FORWARD_CALL: 'FORWARD_CALL',\n  // Midcall.\n  HOLD: 'HOLD',\n  UNHOLD: 'UNHOLD',\n  SEND_CUSTOM_PARAMETERS: 'SEND_CUSTOM_PARAMETERS',\n  ADD_MEDIA: 'ADD_MEDIA',\n  ADD_BASIC_MEDIA: 'ADD_BASIC_MEDIA',\n  REMOVE_MEDIA: 'REMOVE_MEDIA',\n  REMOVE_BASIC_MEDIA: 'REMOVE_BASIC_MEDIA',\n  GET_STATS: 'GET_STATS',\n  SEND_DTMF: 'SEND_DTMF',\n  CONSULTATIVE_TRANSFER: 'CONSULTATIVE_TRANSFER',\n  DIRECT_TRANSFER: 'DIRECT_TRANSFER',\n  JOIN: 'JOIN',\n  REPLACE_TRACK: 'REPLACE_TRACK',\n  MEDIA_RESTART: 'MEDIA_RESTART',\n  RESYNC: 'RESYNC',\n  PLAY_AUDIO: 'PLAY_AUDIO',\n  GET_AVAILABLE_CODECS: 'GET_AVAILABLE_CODECS',\n  // Remote-only.\n  START_MOH: 'START_MOH',\n  STOP_MOH: 'STOP_MOH',\n  SLOW_START: 'SLOW_START',\n  GENERIC_REMOTE: 'GENERIC_REMOTE',\n\n  // Remote updates.\n  CALL_CANCEL: 'CALL_CANCEL'\n}\n\n/*\n * Endpoints that can perform operations.\n */\nexport const ENDPOINTS = {\n  LOCAL: 'LOCAL',\n  REMOTE: 'REMOTE'\n  // SERVER: 'SERVER' ?\n}\n\n/*\n * Statuses of an operation.\n */\nexport const OP_STATUS = {\n  NOT_STARTED: 'NOT_STARTED',\n  ONGOING: 'ONGOING', // The operation is ongoing locally.\n  PENDING: 'PENDING', // The operation is pending remotely (signalling).\n  RESOLVING: 'RESOLVING', // The operation has received remote input, and is resolving negotiation.\n  FINISHED: 'FINISHED'\n}\n\n/*\n * Transitions of an operation.\n */\nexport const OP_TRANSITIONS = {\n  START: 'START', // The operation is starting.\n  UPDATE: 'UPDATE', // The operation is ongoing.\n  RESUME: 'RESUME', // PENDING --> RESOLVING; remote input received, resume the operation.\n  FINISH: 'FINISH' // The operation has finished.\n}\n\n/*\n * Operations that don't have a corresponding finish operation\n */\nexport const NO_FINISH_OPS = [\n  OPERATIONS.ADD_BASIC_MEDIA,\n  OPERATIONS.REMOVE_BASIC_MEDIA,\n  OPERATIONS.GET_AVAILABLE_CODECS,\n  OPERATIONS.MAKE_ANONYMOUS\n]\n","/**\n * A call operation has either started, been updated, or finished.\n *\n * Information about ongoing call operations are stored on the\n *    {@link call.CallObject CallObject}. This event indicates that an operation's\n *    information has changed.\n *\n * The status of an operation indicates whether the local or remote side of the\n *    call is currently processing it, with values being 'ONGOING' or 'PENDING',\n *    respectively. All operations will begin as 'ONGOING' status with an event\n *    indicating the 'START' transition. Operations that require a response from\n *    the remote side will have an 'UPDATE' transition to the 'PENDING' status once\n *    it starts to wait for the response. Once complete, an event will indicate\n *    a 'FINISH' transition and the operation will be removed from the call state.\n * @public\n * @memberof call\n * @event call:operation\n * @param {Object} params\n * @param {string} params.callId The ID for the call being operated on.\n * @param {string} params.operation The type of operation causing this event.\n * @param {string} params.operationId The unique ID of the call operation.\n * @param {string} params.transition The transition reason for the operation change.\n * @param {boolean} params.isLocal Flag indicating whether the operation was local or not.\n * @param {Object} [params.previous] The operation information before this change.\n *    If the transition is to \"start\" the operation, there will be no previous information.\n * @param {string} [params.previous.operation] The operation that was ongoing.\n * @param {string} [params.previous.status] The operation status before this change.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:operation', (params) => {\n *    const { callId, operationId } = params\n *\n *    // Get the operation from the call's state that this event is about.\n *    const call = client.call.getById(callId)\n *    const operation = call.currentOperations.find(op => op.id === operationId)\n *    log(`${operation.type} operation is now ${operation.status} for call ${callId}.`)\n * })\n */\nexport const CALL_OPERATION = 'call:operation'\n\n/**\n * An outgoing call has been started.\n *\n * Information about the Call can be retrieved using the {@link call.getById}\n *    API.\n *\n * @public\n * @memberof call\n * @event call:start\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const CALL_STARTED = 'call:start'\n\n/**\n * A new joined call has been started.\n *\n * Information about the Call can be retrieved using the {@link call.getById}\n *    API.\n *\n * @public\n * @memberof call\n * @requires link_call\n * @event call:join\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const CALL_JOIN = 'call:join'\n\n/**\n * A new incoming call has been received.\n *\n * Information about the Call can be retrieved using the {@link call.getById}\n *    API.\n *\n * NOTE: Upon receiving this notification the call is in \"Initiating\" state. In order\n *    to answer calls, they must be in either \"Ringing\" or \"Initiated\" states. Therefore,\n *    this event should not be used to prompt the user to respond. Instead, the\n *    {@link #calleventcallstatechange call:stateChange} event should be used for this purpose.\n *\n * @public\n * @memberof call\n * @event call:receive\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:receive', function(params) {\n *     // We have received a call\n *     promptUser(client.call.getById(params.callId));\n * });\n */\nexport const CALL_INCOMING = 'call:receive'\n\n/**\n * A Call's state has changed.\n *\n * See {@link call.states} for information about call states.\n * @public\n * @memberof call\n * @event call:stateChange\n * @param {Object} params\n * @param {string} params.callId The ID of the Media object that was operated on.\n * @param {Object} params.previous The call's properties before the operation changed it.\n * @param {string} params.previous.state The previous state of the call.\n * @param {Object} [params.transition] Contains more detailed information about the state change.\n * @param {number} [params.transition.statusCode] The status code associated with the particular state change's reason.\n * @param {string} [params.transition.reasonText] The reason for the state change.\n * @param {boolean} [params.previous.localHold] The previous local hold state. Present when the state change was a hold/unhold operation.\n * @param {boolean} [params.previous.remoteHold] The previous remote hold state. Present when the state change was a hold/unhold operation.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:stateChange', function (params) {\n *     const call = client.call.getById(params.callId)\n *     const prevState = params.previous.state\n *     log(`Call changed from ${prevState} to ${call.state} state.`)\n *\n *     // Handle the event depending on the new call state.\n *     switch (call.state) {\n *         case client.call.states.CONNECTED:\n *             // Handle being on call with media.\n *             break\n *         case client.call.states.ENDED:\n *             // Handle call ending.\n *             break\n *         ...\n *     }\n * })\n */\nexport const CALL_STATE_CHANGE = 'call:stateChange'\n\n/**\n * New media has been added to the call.\n * @public\n * @memberof call\n * @event call:newMedia\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {boolean} params.local Whether the new media is local or not.\n * @param {Array} params.tracks The list of new Tracks.\n * @param {string} params.mediaId The ID of the Media object the Tracks belong to.\n */\nexport const CALL_ADDED_MEDIA = 'call:newMedia'\n\n/**\n * Media has been removed from the call.\n * @public\n * @memberof call\n * @event call:removedMedia\n * @param {Object} params\n * @param {string} params.callId The ID of the call.\n * @param {boolean} params.local Whether the removed Media was local or not.\n * @param {Array} params.tracks The list of removed Tracks.\n */\nexport const CALL_REMOVED_MEDIA = 'call:removedMedia'\n\n/**\n * Tracks have been added to the Call after an SDK operation. Both sides of the Call\n *    are now able to render these tracks.\n *\n * Tracks are added to a Call when either the local or remote user adds new media\n *    to the Call, using the {@link call.addMedia} API for example, or when the\n *    Call is unheld with the {@link call.unhold} API.\n *\n * Remote tracks are similarly added to a Call when new tracks are added by the\n *    remote user or either user unholds the call.\n *\n * This event can indicate that multiple tracks have been removed by the same\n *    operation. For example, if the remote user added video to the call, this\n *    event would indicate a single, remote video track was added. If the local\n *    user unheld the call, this event would indicate that any tracks previously\n *    on the call have been re-added, both local and remote.\n *\n * Information about a Track can be retrieved using the {@link media.getTrackById} API.\n * @public\n * @memberof call\n * @event call:tracksAdded\n * @param {Object} params\n * @param {string} params.callId The ID of the Call the tracks were added to.\n * @param {Array<string>} params.trackIds List of track IDs that have been added to the Call.\n * @example\n * client.on('call:tracksAdded', function (params) {\n *    // Get the information for each track.\n *    const tracks = params.trackIds.map(client.media.getTrackById)\n *    tracks.forEach(track => {\n *      const { id, kind, isLocal } = track\n *      // Handle the track depending whether it is audio vs. video and local vs. remote.\n *      ...\n *    })\n * })\n */\nexport const CALL_TRACKS_ADDED = 'call:tracksAdded'\n\n/**\n * Tracks have been removed from the Call after an SDK operation. The tracks may still\n *    exist, but the media is not available to both sides of the Call any longer.\n *\n * Tracks are removed from a Call when either the local or remote user stops the\n *    tracks, by using the {@link call.removeMedia} API for example, or when the\n *    Call is held with the {@link call.hold} API.\n *\n * This event can indicate that multiple tracks have been removed by the same\n *    operation. For example, if the remote user removed video from the call, this\n *    event would indicate a single, remote video track was removed. If the local\n *    user held the call, this event would indicate that all tracks on the call\n *    have been removed, both local and remote.\n *\n * Information about a Track can be retrieved using the {@link media.getTrackById} API.\n * @public\n * @memberof call\n * @event call:tracksRemoved\n * @param {Object} params\n * @param {string} params.callId The ID of the Call the tracks were removed from.\n * @param {Array<string>} params.trackIds List of track IDs that have been removed from the Call.\n * @example\n * client.on('call:tracksRemoved', function (params) {\n *    // Get the information for each track.\n *    const tracks = params.trackIds.map(client.media.getTrackById)\n *    tracks.forEach(track => {\n *      const { id, kind, isLocal } = track\n *      // Handle the track depending whether it is audio vs. video and local vs. remote.\n *      ...\n *    })\n * })\n */\nexport const CALL_TRACKS_REMOVED = 'call:tracksRemoved'\n\n/**\n * Stats have been retrieved for a Call or specific Track of a Call.\n *\n * See the {@link call.getStats} API for more information.\n *\n * @public\n * @memberof call\n * @event call:statsReceived\n * @param {Object} params\n * @param {string} params.callId The ID of the Call to retrieve stats for.\n * @param {string} [params.trackId] The ID of the Track to retrieve stats for.\n * @param {Map} [params.result] The RTCStatsReport.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:statsReceived', function (params) {\n *    if (params.error) {\n *      // Handle the error from the operation.\n *      const { code, message } = params.error\n *      ...\n *    } else {\n *      // Iterate over each individual statistic inside the RTCPStatsReport Map.\n *      // Handle the data on its own or collate with previously gathered stats\n *      //    for analysis.\n *      params.result.forEach(stat => {\n *        ...\n *      })\n *    }\n * })\n */\nexport const STATS_RECEIVED = 'call:statsReceived'\n\n/**\n * A local Track has been replaced by the {@link call.replaceTrack} API.\n *\n * This event is a combination of a track being removed from the Call and a new\n *    track being added to the Call. The previous Track's media is no longer\n *    available, similar to the {@link call.event:call:tracksRemoved call:tracksRemoved}\n *    event, and the new Track is available in its place, similar to the\n *    {@link call.event:call:tracksAdded call:tracksAdded} event. The event\n *    includes information about the Track that was replaced to help an application\n *    replace it seamlessly.\n * @public\n * @memberof call\n * @event call:trackReplaced\n * @param {Object} params\n * @param {string} params.callId The ID of the call where a track was replaced.\n * @param {string} [params.newTrackId] The ID of the new track that replaced the old track.\n * @param {call.TrackObject} [params.oldTrack] State of the replaced track.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:trackReplaced', function (params) {\n *   const { callId, oldTrack, newTrackId } = params\n *\n *   // Unrender the removed track.\n *   handleTrackGone(oldTrack, callId)\n *\n *   // Render the added track.\n *   const track = client.media.getTrackById(newTrackId)\n *   handleTrackAdded(track, callId)\n * })\n */\nexport const CALL_TRACK_REPLACED = 'call:trackReplaced'\n\n/**\n * Custom Parameters have been received for a Call.\n *\n * These are parameters set by the remote endpoint of the Call. Please refer to\n *    {@link call.CustomParameter CustomParameter} for more information.\n * @public\n * @memberof call\n * @requires link_call\n * @event call:customParameters\n * @param {Object} params\n * @param {string} params.callId The ID of the Call in which custom parameters were received.\n * @param {Array<call.CustomParameter>} params.customParameters The custom parameters received.\n */\nexport const CUSTOM_PARAMETERS = 'call:customParameters'\n\n/**\n * The list of available and supported codecs by the browser have been retrieved.\n *\n * This event is emitted as a result of the {@link call.getAvailableCodecs} API. Please refer to the API for more\n *  information.\n * @public\n * @memberof call\n * @event call:availableCodecs\n * @param {Object} params\n * @param {string} params.kind The kind of media the codecs are for.\n * @param {Array<Object>} params.codecs The list of codecs.\n * @example\n * client.on('call:availableCodecs', function (codecs) {\n *    // Iterate over each codec.\n *    codecs.forEach(codec => {\n *        // Handle the data by analysing its properties.\n *        // Some codec instances may have the same name, but different characteristics.\n *        // (i.e. for a given audio codec, the number of suported channels may differ (e.g. mono versus stereo))\n *        ...\n *    })\n * })\n */\nexport const AVAILABLE_CODECS = 'call:availableCodecs'\n\n/**\n * A Call's media connection state has been changed.\n *\n * This event is emitted as a result of changes to the media connection of the Call.\n * These state changes occur during call establishment, connection loss/re-establishment, call completion, etc.\n *\n * To check the media connection state of a call, retrieve the call's information using the  {@link call.getById} API,\n *  and check the `mediaConnectionState` property of the call.\n * See {@link call.mediaConnectionStates} for the list of possible values and descriptions.\n * @public\n * @memberof call\n * @event call:mediaConnectionChange\n * @param {Object} params\n * @param {string} params.callId The ID of the Call whose media connection state was changed.\n * @param {Object} params.previous The call's media connection properties before the operation changed it.\n * @param {string} params.previous.state The previous state of the media connection.\n */\nexport const MEDIA_CONNECTION_CHANGE = 'call:mediaConnectionChange'\n\n/**\n * A media restart operation for a Call has been attempted.\n *\n * This event is emitted as a result of the {@link call.restartMedia} API being called.\n *    See the description for {@link call.restartMedia} for information about its\n *    usage.\n *\n * The {@link call.event:call:mediaConnectionChange call:mediaConnectionChange} event\n *    will also be emitted alongside this event when the media restart operation is\n *    successful.\n * @public\n * @static\n * @memberof call\n * @event call:mediaRestart\n * @param {Object} params\n * @param {string} params.callId The ID of the Call that was acted on.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n * @example\n * client.on('call:mediaRestart', function (params) {\n *    if (params.error) {\n *      // The operation failed. May want to determine whether to re-attempt the\n *      //    operation (if the failure was simply a connectivity issue) or to\n *      //    consider the call's media irrecoverable.\n *      ...\n *    } else {\n *      // The call should be re-establishing media, with the call's\n *      //    `mediaConnectionState` being updated.\n *      const mediaState = client.call.getById(params.callId).mediaConnectionState\n *      ...\n *    }\n * })\n */\nexport const MEDIA_RESTART = 'call:mediaRestart'\n","// Import the components of the interface.\nimport createAPI from './api/index'\nimport reducer from './reducers'\n\n/**\n * This interface is for a call plugin.\n * @type {string}\n */\nconst name = 'call'\n\n// Export the interface as a single object.\nexport default {\n  name,\n  createAPI,\n  reducer\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\nimport * as webrtcActionTypes from '../../../webrtc/interface/actionTypes'\nimport { CALL_STATES, CALL_DIRECTION } from '../../constants'\nimport { OPERATIONS, OP_STATUS } from '../constants'\n\nimport operationReducer from './operations'\n\n// Libraries.\nimport { combineActions, handleActions } from 'redux-actions'\nimport { concat, union } from 'lodash/fp'\n\n/**\n * A no-op reducer.\n * Some reducers don't need to change state, but need to exist so their actions\n *    can be handled the same way as other actions (eg. wrapped to update local\n *    operation).\n * @method noop\n */\nconst noop = (state, action) => state\n\n/**\n * The reducer logic used for finish operations that end a call.\n * @method callEnder\n */\nconst callEnder = (state, action) => {\n  const now = Date.now()\n  return {\n    ...state,\n    state: CALL_STATES.ENDED,\n    // If there isn't a start time, then the call was never completed.\n    //    Meaning it's duration was 0, so set the start time appropriately.\n    startTime: state.startTime || now,\n    endTime: now,\n    remoteParticipant: {\n      ...state.remoteParticipant,\n      ...action.payload.remoteParticipant\n    },\n    // Closing the peer doesn't trigger an oniceconnectionstatechange event\n    // although it does change the iceConnectionState property to closed\n    mediaConnectionState: 'closed',\n    // TODO: Remove this later.\n    isPending: undefined,\n    localTracks: [],\n    remoteTracks: []\n  }\n}\n\n// Top-tier reducers: Handles the whole call state.\nconst reducers = {}\n// Call-tier reducers: Handles only a specific call's state.\nconst callReducers = {}\n\n/*\n * Top-tier reducers.\n * Receives the entire call substate as state.\n */\n\n// Add the new call to state.\nreducers[actionTypes.MAKE_CALL] = {\n  next(state, action) {\n    // TODO: Call model? (with defaults for call state)\n    const newCall = {\n      id: action.payload.id,\n      remoteParticipant: {\n        displayNumber: action.payload.participantAddress,\n        displayName: action.payload.participantName\n      },\n      // Number of the remote participant when the call was established.\n      to: action.payload.participantAddress,\n      from: action.payload.from,\n      mediaConstraints: action.payload.mediaConstraints,\n      dscpControls: action.payload.dscpControls,\n      // TODO: Proper constants.\n      state: CALL_STATES.INITIATING,\n      direction: CALL_DIRECTION.OUTGOING,\n      // Hold status.\n      localHold: false,\n      remoteHold: false,\n      isCaller: true,\n      // Flag indicating whether the call is anonymous or not\n      isAnonymous: action.payload.isAnonymous,\n      // The account token used to make the anonymous call\n      account: action.payload.account,\n\n      localTracks: [],\n      remoteTracks: [],\n      currentOperations: []\n    }\n\n    return concat(state, newCall)\n  }\n}\n\n// Add the new call to state.\nreducers[actionTypes.CALL_INCOMING] = {\n  next(state, action) {\n    return concat(state, {\n      // Dynamic state from the action.\n      ...action.payload,\n\n      // Constants for a new incoming call.\n      direction: 'incoming',\n      isCaller: false,\n      // Initial call state.\n      state: CALL_STATES.INITIATING,\n      localHold: false,\n      remoteHold: false,\n      // No tracks available to render at first.\n      localTracks: [],\n      remoteTracks: [],\n      currentOperations: []\n    })\n  }\n}\n\n/*\n * Call-tier reducers.\n * Receive a single call's state as state.\n */\n\ncallReducers[actionTypes.SEND_RINGING_FEEDBACK_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.RINGING\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_RINGING] = {\n  next(state, action) {\n    if (action.payload.remoteParticipant) {\n      return {\n        ...state,\n        state: CALL_STATES.RINGING,\n        remoteParticipant: action.payload.remoteParticipant\n      }\n    } else {\n      return {\n        ...state,\n        state: CALL_STATES.RINGING\n      }\n    }\n  }\n}\n\n// Handle Early Media the same as Ringing, just with a different state.\ncallReducers[actionTypes.SESSION_PROGRESS] = {\n  next(state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.EARLY_MEDIA,\n      remoteParticipant: action.payload.remoteParticipant,\n      remoteTracks: action.payload.remoteTracks\n    }\n  }\n}\n\n/*\n * Call-tier reducers.\n * Receive a single call's state as state.\n */\n\n/*\n * Some reducers don't need to change state directly, but need to exist.\n * Call-specific reducers are wrapped to keep information about on-going\n *    operations up-to-date.\n */\ncallReducers[actionTypes.PENDING_OPERATION] = noop\ncallReducers[actionTypes.REMOTE_SLOW_START] = noop\n\n/*\n * When answering, rejecting, or forwarding a call, update state to say that we\n *    are handling it.\n * This is needed for the WebRTC JS SDK because WebRTC Gateway will send a \"call cancel\" notification\n *    to _ALL_ of the user's subscriptions. The intention is to stop the call from\n *    ringing on other subscribed devices, and for the handling device to ignore\n *    the notification. This flag is used to know when to ignore the call cancel.\n */\nconst setHandling = (state, action) => {\n  return {\n    ...state,\n    isHandling: true\n  }\n}\ncallReducers[actionTypes.ANSWER_CALL] = setHandling\ncallReducers[actionTypes.REJECT_CALL] = setHandling\ncallReducers[actionTypes.FORWARD_CALL] = setHandling\n\ncallReducers[actionTypes.CALL_CANCELLED] = {\n  next(state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.CANCELLED\n    }\n  }\n}\n\n// End the call if the ignore operation was successful, otherwise ignore this request.\ncallReducers[actionTypes.IGNORE_CALL_FINISH] = {\n  next: (state, action) => {\n    // The call being ignored means it was not completed. Ensure there are times\n    //    in state, and they reflect that the call was not completed.\n    // TODO: Better call times.\n    const now = Date.now()\n\n    return {\n      ...state,\n      startTime: now,\n      endTime: now,\n      state: CALL_STATES.ENDED\n    }\n  },\n  throw: (state, action) => {\n    return state\n  }\n}\n\n// End the call if the reject operation was successful, otherwise ignore this request.\ncallReducers[actionTypes.REJECT_CALL_FINISH] = {\n  next: (state, action) => {\n    // The call being rejected means it was not completed. Ensure there are\n    //    times in state, and they reflect that the call was not completed.\n    // TODO: Better call times.\n    const now = Date.now()\n\n    const newState = {\n      ...state,\n      startTime: now,\n      endTime: now,\n      state: CALL_STATES.ENDED\n    }\n\n    // After the reject operation finishes, remove the flag that indicates we\n    //    were handling the call.\n    delete newState.isHandling\n\n    return newState\n  },\n  throw: (state, action) => {\n    return state\n  }\n}\n\ncallReducers[actionTypes.SESSION_CREATED] = {\n  next(state, action) {\n    // When we get SESSION_CREATED action, the call object already exists as part of reducers state\n    // so we only add the webrtc session id. This way we can find the call object\n    // by searching for this associated webrtcSessionId.\n    return {\n      ...state,\n      webrtcSessionId: action.payload.webrtcSessionId\n    }\n  }\n}\n\ncallReducers[actionTypes.PENDING_MAKE_CALL] = {\n  next(state, action) {\n    return {\n      ...state,\n      state: CALL_STATES.INITIATED,\n      wrtcsSessionId: action.payload.wrtcsSessionId,\n      webrtcSessionId: action.payload.webrtcSessionId,\n      bandwidth: action.payload.bandwidth,\n      displayName: action.payload.displayName,\n      customParameters: action.payload.customParameters,\n      customBodies: action.payload.customBodies,\n      localTracks: action.payload.localTracks\n    }\n  }\n}\n\n// Update the new call state based on the outcome.\ncallReducers[actionTypes.MAKE_CALL_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  }\n}\n\n// Update the new call state based on the outcome.\ncallReducers[actionTypes.MAKE_ANONYMOUS_CALL_FINISH] = {\n  next(state, action) {\n    // Change nothing.\n    return state\n  },\n  // End the call.\n  throw: callEnder\n}\n\n// Update the call state based on the outcome.\ncallReducers[actionTypes.ANSWER_CALL_FINISH] = {\n  next(state, action) {\n    // If the action has a Session ID, store it as the ID.\n    // In some scenarios (slow start), the we only get an ID\n    //    at the answer step.\n    const webrtcId = action.payload.webrtcSessionId || state.webrtcSessionId\n\n    const newState = {\n      ...state,\n      state: action.payload.state,\n      mediaConstraints: action.payload.mediaConstraints,\n      dscpControls: action.payload.dscpControls,\n      webrtcSessionId: webrtcId,\n      localHold: false,\n      remoteHold: false,\n      bandwidth: action.payload.bandwidth,\n      customParameters: action.payload.customParameters,\n      customBodies: action.payload.customBodies,\n      localTracks: action.payload.localTracks,\n      remoteTracks: action.payload.remoteTracks\n    }\n\n    // Add start time to the call's state here if the call is not a slowstart call\n    if (action.meta && !action.meta.isSlowStart) {\n      newState.startTime = action.payload.startTime\n    }\n\n    // If answering the Call puts us in Connected state (ie. not slow-start),\n    //    then we can remove this flag since we know not to cancel a connected call.\n    if (newState.state === CALL_STATES.CONNECTED) {\n      delete newState.isHandling\n    }\n\n    return newState\n  },\n  throw(state, action) {\n    const newState = {\n      ...state,\n      ...action.payload\n    }\n\n    // If we failed to answer the call, then we're not actually handling the\n    //    call, so remove the flag.\n    delete newState.isHandling\n\n    return newState\n  }\n}\n\ncallReducers[actionTypes.CALL_ACCEPTED] = {\n  next(state, action) {\n    const newState = {\n      ...state,\n      ...action.payload\n    }\n\n    // If we were answering, but it's the remote accept that puts us in the\n    //    Connected state (ie. slow-start), then we can remove this flag since\n    //    we know not to cancel a connected call.\n    if (newState.isHandling && newState.state === CALL_STATES.CONNECTED) {\n      delete newState.isHandling\n    }\n\n    return newState\n  },\n  throw(state, action) {\n    const newState = action.payload.state || state.state\n    return {\n      ...state,\n      state: newState\n    }\n  }\n}\n\n// Handles both success and failure actions the same way.\n// Instead of an object with `next` & `throw` properties, pass in a function.\n// https://redux-actions.js.org/api/handleaction#handleactiontype-reducer-defaultstate\ncallReducers[actionTypes.END_CALL_FINISH] = callEnder\n\ncallReducers[actionTypes.UPDATE_CALL] = {\n  next(state, action) {\n    /*\n     * Separate the action properties that should not be directly added to state.\n     *  - transition: Data for an event; not call state.\n     *  - localTracks: UPDATE_CALL should not affect local tracks.\n     */\n    const { transition, localTracks, remoteTracks, ...stateProperties } = action.payload\n\n    const newState = {\n      ...state,\n      ...stateProperties\n    }\n\n    if (remoteTracks && remoteTracks.length > 0) {\n      newState.remoteTracks = remoteTracks\n    }\n\n    /*\n     * Edge-case workaround.\n     * If the current operation is an on-going remote slow-start, then this remote\n     *   update call action is intended to be the \"finish\" for it. The \"update call\"\n     *   action being used here is an edge-case when the remote operation wasn't\n     *   something we can identify.\n     * This is being done manually because the \"update call\" action does not work\n     *   with the SDK's \"operation tracking\" logic in the reducers.\n     * See function `handleSlowUpdateResponse` in `/call/negotiation.js` for more info.\n     * Reference: KJS-542, KJS-571\n     */\n    if (action.meta && action.meta.isRemote === true) {\n      const remoteSlow = newState.currentOperations.find(op => {\n        return !op.isLocal && op.type === OPERATIONS.SLOW_START && op.status === OP_STATUS.ONGOING\n      })\n      if (remoteSlow) {\n        // Remove the remoteSlow operation from call state.\n        newState.currentOperations = newState.currentOperations.filter(op => op.id !== remoteSlow.id)\n      }\n    }\n\n    return newState\n  }\n}\n\ncallReducers[actionTypes.CALL_HOLD_FINISH] = {\n  next(state, action) {\n    // Filter out the affected tracks from the list of remote tracks.\n    //    `trackLeft` _should_ be an empty array at this point...\n    const removedTracks = action.payload.remoteTracks\n    const tracksLeft = state.remoteTracks.filter(trackId => !removedTracks.includes(trackId))\n\n    // Filter out local tracks. It _should_ be an emptyy array at this point.\n    // But only remove the tracks in the action since those are the tracks that\n    //    will be in the \"tracks removed\" event.\n    const { localTracks } = action.payload\n    const localTracksLeft = state.localTracks.filter(trackId => !localTracks.includes(trackId))\n\n    return {\n      ...state,\n      localHold: true,\n      state: CALL_STATES.ON_HOLD,\n      localTracks: localTracksLeft,\n      remoteTracks: tracksLeft\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_UNHOLD_FINISH] = {\n  next(state, action) {\n    // Add the affected tracks to the list of remote tracks.\n    //    `state.remoteTracks` _should_ have been empty before this...\n    const addedTracks = action.payload.remoteTracks\n    const tracks = union(state.remoteTracks, addedTracks)\n\n    const { localTracks } = action.payload\n    const localAdded = union(state.localTracks, localTracks)\n\n    const callState = state.remoteHold ? CALL_STATES.ON_HOLD : CALL_STATES.CONNECTED\n    return {\n      ...state,\n      localHold: false,\n      state: callState,\n      localTracks: localAdded,\n      remoteTracks: tracks\n    }\n  }\n}\n\ncallReducers[actionTypes.SET_CUSTOM_PARAMETERS] = {\n  next(state, action) {\n    return {\n      ...state,\n      customParameters: action.payload.customParameters,\n      customBodies: action.payload.customBodies\n    }\n  }\n}\n\ncallReducers[actionTypes.SEND_CUSTOM_PARAMETERS_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      ...action.payload\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_REMOTE_HOLD_FINISH] = {\n  next(state, action) {\n    // Filter out the affected tracks from the list of remote tracks.\n    //    `trackLeft` _should_ be an empty array at this point...\n    const removedRemote = action.payload.remoteTracks\n    const tracksLeft = state.remoteTracks.filter(trackId => !removedRemote.includes(trackId))\n\n    const removedLocal = action.payload.localTracks\n    const localLeft = state.localTracks.filter(trackId => !removedLocal.includes(trackId))\n\n    return {\n      ...state,\n      remoteHold: true,\n      state: CALL_STATES.ON_HOLD,\n      remoteParticipant: {\n        ...state.remoteParticipant,\n        ...action.payload.remoteParticipant\n      },\n      localTracks: localLeft,\n      remoteTracks: tracksLeft\n    }\n  }\n}\n\ncallReducers[actionTypes.CALL_REMOTE_UNHOLD_FINISH] = {\n  next(state, action) {\n    // Replace the remoteTracks with the remoteTracks affected by the unhold.\n    const tracks = action.payload.remoteTracks\n\n    const addedLocal = action.payload.localTracks\n    const localTracks = union(state.localTracks, addedLocal)\n\n    const callState = state.localHold ? CALL_STATES.ON_HOLD : CALL_STATES.CONNECTED\n    const newCall = {\n      ...state,\n      remoteHold: false,\n      state: callState,\n      remoteParticipant: {\n        ...state.remoteParticipant,\n        ...action.payload.remoteParticipant\n      },\n      localTracks,\n      remoteTracks: tracks\n    }\n\n    // If `hasMOH` was explicitly set to true, set it to false as part of unhold.\n    // This will happen when there is an explicit \"start MOH\" negotiation but\n    //    \"stop MOH\" is done as part of unhold.\n    if (newCall.hasMOH === true) {\n      newCall.hasMOH = false\n    }\n\n    return newCall\n  }\n}\n\ncallReducers[actionTypes.REMOTE_ADD_MEDIA_FINISH] = {\n  next(state, action) {\n    // Added the affected tracks to the list of remote tracks.\n    const addedTracks = action.payload.remoteTracks\n    const tracks = union(state.remoteTracks, addedTracks)\n\n    return {\n      ...state,\n      remoteTracks: tracks\n    }\n  }\n}\ncallReducers[actionTypes.REMOTE_REMOVE_MEDIA_FINISH] = {\n  next(state, action) {\n    // Filter out the affected tracks from the list of remote tracks.\n    const removedTracks = action.payload.remoteTracks\n    const tracksLeft = state.remoteTracks.filter(trackId => !removedTracks.includes(trackId))\n\n    return {\n      ...state,\n      remoteTracks: tracksLeft\n    }\n  }\n}\n\ncallReducers[actionTypes.REMOTE_START_MOH_FINISH] = {\n  next(state, action) {\n    // Added the affected tracks to the list of remote tracks.\n    const addedTracks = action.payload.remoteTracks\n    const tracks = union(state.remoteTracks, addedTracks)\n\n    return {\n      ...state,\n      hasMOH: true,\n      remoteTracks: tracks\n    }\n  }\n}\n\ncallReducers[actionTypes.REMOTE_STOP_MOH_FINISH] = {\n  next(state, action) {\n    // Filter out the affected tracks from the list of remote tracks.\n    const removedTracks = action.payload.remoteTracks\n    const tracksLeft = state.remoteTracks.filter(trackId => !removedTracks.includes(trackId))\n\n    return {\n      ...state,\n      hasMOH: false,\n      remoteTracks: tracksLeft\n    }\n  }\n}\n\ncallReducers[actionTypes.FORWARD_CALL_FINISH] = {\n  next(state, action) {\n    const newState = {\n      ...state,\n      state: CALL_STATES.ENDED\n    }\n\n    // After the forward operation finishes, remove the flag that indicates we\n    //    were handling the call.\n    delete newState.isHandling\n\n    return newState\n  }\n}\n\ncallReducers[actionTypes.DIRECT_TRANSFER_FINISH] = {\n  next: callEnder\n}\n\nreducers[actionTypes.CONSULTATIVE_TRANSFER_FINISH] = {\n  next: (state, action) => {\n    // On success, end both calls used in the consultative transfer.\n    return state.map(call => {\n      if (call.id === action.payload.id || call.id === action.payload.otherCallId) {\n        return callEnder(call, action)\n      } else {\n        return call\n      }\n    })\n  },\n  throw: (state, action) => {\n    // On failure, don't update state.\n    return state\n  }\n}\n\nreducers[actionTypes.JOIN_START] = {\n  next(state, action) {\n    // Create the new joined\n    const newCall = {\n      id: action.payload.id,\n      remoteParticipant: {\n        displayNumber: action.payload.participantAddress,\n        displayName: action.payload.participantName\n      },\n      // TODO: Have better names for `to` & `from`\n      to: action.payload.participantAddress,\n      from: action.payload.from,\n      mediaConstraints: action.payload.mediaConstraints,\n      state: CALL_STATES.INITIATING,\n      direction: CALL_DIRECTION.OUTGOING,\n      // Hold status.\n      localHold: false,\n      remoteHold: false,\n      isCaller: true,\n      isJoinedCall: true,\n      customParameters: action.payload.customParameters,\n      bandwidth: action.payload.bandwidth,\n      dscpControls: action.payload.dscpControls,\n\n      localTracks: [],\n      remoteTracks: [],\n      currentOperations: [\n        {\n          isLocal: true,\n          id: action.payload.operationId,\n          type: OPERATIONS.JOIN,\n          status: OP_STATUS.ONGOING,\n          eventId: action.payload.eventId\n        }\n      ]\n    }\n\n    return concat(state, newCall)\n  }\n}\n\nreducers[actionTypes.PENDING_JOIN] = {\n  next(state, action) {\n    return state.map(call => {\n      if (call.id === action.payload.id) {\n        // Update the joined call with the new payload\n        return {\n          ...call,\n          wrtcsSessionId: action.payload.wrtcsSessionId,\n          webrtcSessionId: action.payload.webrtcSessionId,\n          localTracks: action.payload.localTracks,\n          state: action.payload.state\n        }\n      } else {\n        return call\n      }\n    })\n  }\n}\n\nreducers[actionTypes.JOIN_FINISH] = {\n  /*\n   * JOIN_FINISH for a success scenario is triggered by receiving \"sessionComplete\" notifications\n   * for the two initial calls that are joining (the action is dispatched with the initial calls' ids).\n   * For this scenario, end these calls since the new joined call is made.\n   */\n  next: (state, action) => {\n    return state.map(call => {\n      if (\n        call.id === action.payload.id ||\n        (action.payload.usedCallIds && action.payload.usedCallIds.includes(call.id))\n      ) {\n        return callEnder(call, action)\n      } else {\n        return call\n      }\n    })\n  },\n  throw: (state, action) => {\n    return state.map(call => {\n      // If this action was dispatched with the new call id, end the call\n      // How to determine if it was dispatched with new call id:\n      //  - The ID in the action is not in the `usedCallIds` of the action's payload\n      // If there is no `usedCallIds`, then likely this action is dispatched with the unjoined call ID's\n      // due to receiving a \"sessionFailed\" notification from the backend\n      if (\n        call.id === action.payload.id &&\n        action.payload.usedCallIds &&\n        !action.payload.usedCallIds.includes(call.id)\n      ) {\n        return callEnder(call, action)\n      } else {\n        return call\n      }\n    })\n  }\n}\n\ncallReducers[actionTypes.ADD_MEDIA_FINISH] = {\n  next(state, action) {\n    const localAdded = action.payload.localTracks\n\n    return {\n      ...state,\n      bandwidth: action.payload.bandwidth,\n      localTracks: state.localTracks.concat(localAdded)\n    }\n  }\n}\n\ncallReducers[actionTypes.REMOVE_MEDIA_FINISH] = {\n  next(state, action) {\n    const localRemoved = action.payload.localTracks\n    const tracksLeft = state.localTracks.filter(trackId => !localRemoved.includes(trackId))\n\n    return {\n      ...state,\n      bandwidth: action.payload.bandwidth,\n      localTracks: tracksLeft\n    }\n  }\n}\n\ncallReducers[actionTypes.REPLACE_TRACK_FINISH] = {\n  next(state, action) {\n    const oldTrackId = action.payload.oldTrackState.id\n    const newTrackId = action.payload.newTrackId\n\n    // Remove the old ID and add the new ID to localTracks state.\n    const tracks = state.localTracks.filter(trackId => trackId !== oldTrackId).concat(newTrackId)\n\n    return {\n      ...state,\n      localTracks: tracks\n    }\n  }\n}\n\ncallReducers[webrtcActionTypes.SESSION_ICE_CONNECTION_STATE_CHANGE] = {\n  next(state, action) {\n    return {\n      ...state,\n      mediaConnectionState: action.payload.iceConnectionState\n    }\n  }\n}\n/*\n * Combine all of the call-tier reducers into a single reducer,\n *      each with a default state of empty object.\n */\nconst callReducer = handleActions(callReducers, {})\n\n// Actions routed to call-tier reducers.\nconst specificCallActions = combineActions(\n  actionTypes.PENDING_OPERATION,\n  actionTypes.PENDING_MAKE_CALL,\n  actionTypes.MAKE_CALL_FINISH,\n  actionTypes.MAKE_ANONYMOUS_CALL_FINISH,\n  actionTypes.ANSWER_CALL,\n  actionTypes.ANSWER_CALL_FINISH,\n  actionTypes.REJECT_CALL,\n  actionTypes.REJECT_CALL_FINISH,\n  actionTypes.CALL_ACCEPTED,\n  actionTypes.SEND_RINGING_FEEDBACK_FINISH,\n  actionTypes.CALL_RINGING,\n  actionTypes.SESSION_PROGRESS,\n  actionTypes.CALL_CANCELLED,\n  actionTypes.IGNORE_CALL_FINISH,\n  actionTypes.END_CALL_FINISH,\n  actionTypes.CALL_HOLD_FINISH,\n  actionTypes.CALL_UNHOLD_FINISH,\n  actionTypes.SET_CUSTOM_PARAMETERS,\n  actionTypes.SEND_CUSTOM_PARAMETERS_FINISH,\n  actionTypes.CALL_REMOTE_HOLD_FINISH,\n  actionTypes.CALL_REMOTE_UNHOLD_FINISH,\n  actionTypes.REMOTE_ADD_MEDIA_FINISH,\n  actionTypes.REMOTE_REMOVE_MEDIA_FINISH,\n  actionTypes.ADD_MEDIA_FINISH,\n  actionTypes.REMOVE_MEDIA_FINISH,\n  actionTypes.UPDATE_CALL,\n  actionTypes.FORWARD_CALL,\n  actionTypes.FORWARD_CALL_FINISH,\n  actionTypes.DIRECT_TRANSFER_FINISH,\n  actionTypes.REPLACE_TRACK_FINISH,\n  actionTypes.MEDIA_RESTART,\n  actionTypes.MEDIA_RESTART_FINISH,\n  actionTypes.REMOTE_SLOW_START,\n  actionTypes.REMOTE_START_MOH_FINISH,\n  actionTypes.REMOTE_STOP_MOH_FINISH,\n  actionTypes.SESSION_CREATED,\n  actionTypes.OPERATION_UPDATE\n)\n\nconst specificWebrtcSessionActions = combineActions(webrtcActionTypes.SESSION_ICE_CONNECTION_STATE_CHANGE)\n\n/*\n * Reducer to handle specific call actions.\n * Routes the actions to the call-tier reducers.\n */\nreducers[specificCallActions] = (state, action) => {\n  return state.map(function (call) {\n    // Only update the call related to the action.\n    if (call.id === action.payload.id) {\n      // Update call state as per the reducer.\n      let updatedCall = callReducer(call, action)\n\n      // Update the operation portion of the call state.\n      updatedCall = operationReducer(updatedCall, action)\n      return updatedCall\n    } else {\n      return call\n    }\n  })\n}\n\n/**\n * Reducer to handle specific webrtc actions.\n * Routes the actions to the call-tier reducers.\n */\nreducers[specificWebrtcSessionActions] = (state, action) => {\n  return state.map(function (call) {\n    if (call.webrtcSessionId === action.payload.id) {\n      return callReducer(call, action)\n    } else {\n      return call\n    }\n  })\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","import calls from './call'\nimport turn from './turn'\n\n/**\n * Combine subreducers into a single call reducer.\n */\nexport default function (state = {}, action) {\n  return {\n    calls: calls(state.calls, action),\n    turn: turn(state.turn, action)\n  }\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\nimport { OPERATIONS, NO_FINISH_OPS, OP_TRANSITIONS, OP_STATUS } from '../constants'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\nimport { contains, isNil } from 'lodash/fp'\n\nconst reducers = {}\n\n/**\n * `call.currentOperations` property reducer.\n * @param {Array<Operation>} state\n * @param {Object} action\n * @return {Array<Operation>} The updated list of on-going operations for this call.\n */\nfunction currentOperations(state = [], action) {\n  const { transition, operationId } = action.payload\n\n  if (transition === OP_TRANSITIONS.START) {\n    const operation = {\n      type: action.payload.operation,\n      id: operationId,\n      status: OP_STATUS.ONGOING,\n      eventId: action.payload.eventId,\n      isLocal: action.payload.isLocal,\n      isBlocking: action.payload.isBlocking\n    }\n    const newState = state.concat(operation)\n    return newState\n  } else if (transition === OP_TRANSITIONS.UPDATE) {\n    return state.map(op => {\n      if (op.id === operationId) {\n        return {\n          ...op,\n          status: OP_STATUS.PENDING,\n          operationData: action.payload.operationData\n        }\n      } else {\n        return op\n      }\n    })\n  } else if (transition === OP_TRANSITIONS.RESUME) {\n    return state.map(op => {\n      if (op.id === operationId) {\n        return {\n          ...op,\n          status: OP_STATUS.RESOLVING\n        }\n      } else {\n        return op\n      }\n    })\n  } else if (transition === OP_TRANSITIONS.FINISH) {\n    // Remove the operation from state.\n    return state.filter(op => op.id !== operationId)\n  } else {\n    return state\n  }\n}\n\n/*\n * TODO: The `call.localOp` and `call.remoteOp` properties should be deprecated\n *    and replaced in any documentation with the `call.currentOperations`\n *    property.\n */\nreducers[actionTypes.OPERATION_UPDATE] = {\n  next(state, action) {\n    // Hook into OPERATION_UPDATE reducer for `call.currentOperations` updates.\n    state.currentOperations = currentOperations(state.currentOperations, action)\n\n    const stateProp = action.payload.isLocal ? 'localOp' : 'remoteOp'\n\n    if (action.payload.transition === OP_TRANSITIONS.START) {\n      // A new operation is starting...\n      if (state[stateProp]) {\n        // ...but there is still an on-going op.\n        // The new operation should be rejected, so state should not change.\n        return state\n      } else {\n        // ...and there is no current operation on-going.\n        // Set the new operation in state.\n        return {\n          ...state,\n          [stateProp]: {\n            operation: action.payload.operation,\n            status: OP_STATUS.ONGOING,\n            eventId: action.payload.eventId\n          }\n        }\n      }\n    } else if (action.payload.transition === OP_TRANSITIONS.UPDATE) {\n      // Existing operation is now waiting on remote side.\n      return {\n        ...state,\n        [stateProp]: {\n          ...state[stateProp],\n          status: OP_STATUS.PENDING,\n          operationData: action.payload.operationData\n        }\n      }\n    } else if (action.payload.transition === OP_TRANSITIONS.FINISH) {\n      // Existing operation is finishing.\n      const isRemote = !action.payload.isLocal\n      const unsetOperation = {\n        ...state,\n        [stateProp]: undefined\n      }\n\n      const currentOp = state[stateProp] && state[stateProp].operation\n      if (isNil(currentOp)) {\n        // Should be considered an error scenario.\n        return state\n      }\n\n      // An on-going operation is finishing...\n      if (currentOp === action.payload.operation) {\n        // The operation matches the current on-going operation.\n        //    Unset it in state.\n        return unsetOperation\n      } else if (isRemote && currentOp === OPERATIONS.SLOW_START) {\n        // Special case: If the current operation was a remote slow start,\n        //    then the 'finish' won't match. Allow any 'finish' to unset it.\n        return unsetOperation\n      } else if (contains(currentOp)(NO_FINISH_OPS)) {\n        // Special case: If the current operation is one that doesn't have a finish\n        //    operation, allow any 'finish' to unset it.\n        return unsetOperation\n      } else if (action.payload.operation === OPERATIONS.END) {\n        // Special-case: If the operation is an \"end call\" (but the on-going operation\n        //    doesn't match), then unset the current operation.\n        return unsetOperation\n      } else {\n        // ...but it wasn't tracked in state?\n        // Should be considered an error scenario.\n        return state\n      }\n    }\n\n    return state\n  }\n}\n\nreducers[actionTypes.UPDATE_CALL] = {\n  next(state, action) {\n    // Special-case for slow-start...\n    // See https://github.com/RibbonCommunications/webrtc.js/pull/3454/files#diff-0aef3ee33c1007fada1c90a5da252ae4046de14d63fbea8d87faa6a69fbd1cd6R380\n    return state\n  }\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of undefined on-going operations.\n */\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\n// Replace any previous information with the new information.\nreducers[actionTypes.TURN_CHANGED] = {\n  next(state, action) {\n    return {\n      ...state,\n      ...action.payload.credentials\n    }\n  }\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer.\n */\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","// Call plugin.\nimport { CALL_STATES } from '../constants'\n\n/**\n * Call selectors.\n * Handles retrieving data from the `state.call.calls` substate.\n */\n\n/**\n * Get the list of all calls this session.\n * @method getCalls\n * @param  {Object} state Redux state.\n * @return {Array} A list of all call objects.\n */\nexport function getCalls(state) {\n  // TODO: cloneDeep?\n  return state.call.calls\n}\n\n/**\n * Retrieves the list of all on-going calls.\n * @method getActiveCalls\n * @param {Object} state Redux state.\n * @return {Array} A list of call objects.\n */\nexport function getActiveCalls(state) {\n  const endedStates = [CALL_STATES.ENDED, CALL_STATES.CANCELLED]\n\n  return getCalls(state).filter(call => !endedStates.includes(call.state))\n}\n\n/**\n * Get the call object of a specific call.\n * @method getCallById\n * @param  {Object} state Redux state.\n * @param  {string} callId The call to retrieve.\n * @return {Object} A call object.\n */\nexport function getCallById(state, callId) {\n  return getCalls(state).find(call => call.id === callId)\n}\n\n/**\n * Get the call object with a specific wrtcsSessionId (backend ID).\n * @method getCallByWrtcsSessionId\n * @param  {Object} state Redux state.\n * @param  {string} wrtcsSessionId The call to retrieve.\n * @return {Object} A call object.\n */\nexport function getCallByWrtcsSessionId(state, wrtcsSessionId) {\n  return getCalls(state).find(call => call.wrtcsSessionId === wrtcsSessionId)\n}\n\n/**\n * Get the call object with a specific webrtcSessionId.\n * @method getCallByWebrtcSessionId\n * @param  {Object} state Redux state.\n * @param  {string} webrtcSessionId The call to retrieve.\n * @return {Object} A call object.\n */\nexport function getCallByWebrtcSessionId(state, webrtcSessionId) {\n  return getCalls(state).find(call => call.webrtcSessionId === webrtcSessionId)\n}\n\n/**\n * Retrieve the call plugin's options.\n * @method getOptions\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getOptions(state) {\n  return state.config.call\n}\n\n/**\n * Retrieve TURN server/credential information.\n */\nexport function getTurnInfo(state) {\n  return state.call.turn\n}\n","// Lodash FP\nimport { isEmpty } from 'lodash/fp'\nimport BasicError, { callCodes } from '../../errors'\n\n/**\n * Helper function for Call APIs.\n * Reduces media constraints provided to an API to a consistent format.\n *\n * Converts the kind properties from \"SDK MediaConstraints\" object to an WebRTC-spec\n *    MediaConstraints properties.\n * @method formatMediaConstraints\n * @param {Object} media\n * @param {booleant} media.audio\n * @param {Object} media.audioOptions\n * @param {boolean} media.video\n * @param {Object} media.videoOptions\n * @param {boolean} media.screen\n * @param {Object} media.screenOptions\n * @param {Array} media.medias\n * @returns {Object}\n */\nexport function formatMediaConstraints(media) {\n  const mediaConstraints = {\n    audio: media.audio && !isEmpty(media.audioOptions) ? media.audioOptions : media.audio,\n    video: media.video && !isEmpty(media.videoOptions) ? media.videoOptions : media.video,\n    screen: media.screen && !isEmpty(media.screenOptions) ? media.screenOptions : media.screen,\n    medias: media.medias\n  }\n\n  return mediaConstraints\n}\n\n/**\n * Helper function to validate mediaConstraints for Call APIs.\n *\n * This function will validate the following scenarios:\n *   1. Duplicate media types are passed as detached media and requested media.\n *   2. Invalid type is passed as `medias`. Should be an array of media objects.\n *   3. Any tracks in the `medias` are not detached.\n *   4. Any tracks in the `medias` are not local.\n *   5. Any track is already in use by a session (including the one in context).\n *\n * @method validateMediaConstraints\n * @param {Object} media The mediaConstraints being validated.\n * @throws {BasicError} Throws an error if mediaConstraints.medias is not an array.\n * @throws {BasicError} Throws an error if mediaConstraints.medias Objects are missing `media` and `type` properties.\n * @throws {BasicError} Throws an error if mediaConstraints contains duplicate media kinds.\n */\nexport function validateMediaConstraints(media) {\n  // If no media objects are passed in, no need to validate.\n  if (!media.medias) {\n    return\n  }\n  // Validate correct media objects\n  if (!Array.isArray(media.medias)) {\n    throw new BasicError({\n      message: `Incorrect type for mediaConstraints.medias. Must be an array of media objects.`,\n      code: callCodes.GENERIC_ERROR\n    })\n  }\n\n  media.medias.forEach(media => {\n    if (!media.type || !media.media) {\n      throw new BasicError({\n        message: `Incorrect media objects.`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n  })\n\n  // Validate duplicate media kinds\n  if (media.medias) {\n    const requestedMedia = []\n    if (media.audio) {\n      requestedMedia.push('audio')\n    }\n    if (media.video) {\n      requestedMedia.push('video')\n    }\n    if (media.screen) {\n      requestedMedia.push('screen')\n    }\n\n    // Get tracks for each media and check if kind equals any of the requested media and throw if it does.\n    const trackKinds = []\n    media.medias.forEach(media => {\n      trackKinds.push(media.type)\n    })\n\n    const duplicateKinds = requestedMedia.filter(mediaKind => trackKinds.includes(mediaKind))\n    // Throw an error if requested media kind has also been passed in as detached media\n    if (duplicateKinds.length > 0) {\n      throw new BasicError({\n        message: `Both detached media tracks and media constraints provided for ${duplicateKinds}`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n  }\n}\n\n/**\n * Helper function to validate detached media for Call APIs.\n * @method validateDetachedMedia\n * @param {Object} medias The detached media being validated.\n * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are not detached.\n * @throws {BasicError} Throws an error if any tracks in mediaConstraints.medias are not local.\n */\nexport function validateDetachedMedia(medias) {\n  // Validate that all tracks are detached, local and not in use by an existing session.\n  for (const media of medias) {\n    if (!media.media.detached) {\n      throw new BasicError({\n        message: `Media: ${media.media.id} is not detached.`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n    if (!media.media.local) {\n      throw new BasicError({\n        message: `Media: ${media.media.id} is not local. Only local media may be used when adding media to a call.`,\n        code: callCodes.GENERIC_ERROR\n      })\n    }\n  }\n}\n","// Call plugin.\nimport pluginInterface from '../interface'\nimport createMiddleware from './middleware'\nimport createRequests from './requests'\nimport parseConfigs, { fixIceServerUrls, mergeDefaults } from '../configs'\n\nimport * as operationFactories from './operations'\n\nimport setupCallstack from '../callstack'\n\n// Other plugins.\nimport { update as updateConfig, setSdpHandlers } from '../../config/interface/actions'\n\n// Libraries.\nimport { getBrowserDetails, getWebRTCSupportCapabilities } from 'kandy-webrtc'\n\n/**\n * Configuration options for the call feature.\n * @public\n * @name config.call\n * @memberof config\n * @instance\n * @param {Object} call The call configuration object.\n * @param {call.RTCPeerConnectionConfig} [call.defaultPeerConfig] A key-value dictionary that corresponds\n *    to the available RTCPeerConfiguration which is normally passed when creating an RTCPeerConnection.\n *    See {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/RTCPeerConnection#parameters RTCPeerConnection's configuration parameters} for more information.\n *    This is the recommended way of setting ICE servers and other RTCPeerConnection-related configuration.\n * @param {number} [call.iceCollectionIdealTimeout=1000] The amount of time to wait for an ideal candidate in milliseconds.\n *    The default is 1000ms. An ideal list of candidates is a complete list of candidates considering the RTCPeerConnection configuration.\n *    Note that this values will not be considered if a custom function is passed through the `iceCollectionCheckFunction`, and\n *    any timeouts must be handled by the custom function.\n * @param {number} [call.iceCollectionMaxTimeout=3000] The maximum amount of time to wait for ICE collection in milliseconds.\n *    The default is 3000ms. After this time has been reached, the call will proceed with the currently gathered candidates.\n *    Note that this values will not be considered if a custom function is passed through the `iceCollectionCheckFunction`, and\n *    any timeouts must be handled by the custom function.\n * @param {Function} [call.iceCollectionCheckFunction] Override the default IceCollectionCheckFunction to manually decide when\n *    to proceed with operations, error out, or wait for the appropriate states and candidates. The function will receive an object containing\n *    the ice collection info. See {@link call.IceCollectionInfo IceCollectionInfo} for more details. The function must return\n *    a results object with details on how to proceed with the ICE collection check or operatiaon. See {@link call.IceCollectionCheckResult IceCollectionResult}\n *    object for details on the format of the return object. See {@link call.IceCollectionCheckFunction IceCollectionCheckFunction} for\n *    more information on the form of the function, as well as information about the default IceCollectionCheckFunction that is used if nothing is provided.\n * @param {boolean} [call.serverTurnCredentials=true] Whether server-provided TURN credentials should be used.\n * @param {Array<call.SdpHandlerFunction>} [call.sdpHandlers] List of SDP handler functions to modify SDP. Advanced usage.\n * @param {boolean} [call.earlyMedia=false] Whether early media should be supported for calls. Not supported on Firefox.\n * @param {boolean} [call.resyncOnConnect=false] Whether the SDK should re-sync all call states after connecting (requires WebRTC Gateway 4.7.1+).\n * @param {boolean} [call.mediaBrokerOnly=false] Whether all Calls will be anchored on the MediaBroker instead of being peer-to-peer. Set to true if the backend is configured for broker only mode.\n * @param {boolean} [call.removeBundling=false] Whether to remove a=group attributes to stop media bundling from incoming and outgoing SDP messages.\n * @param {string} [call.ringingFeedbackMode='auto'] The mode for sending ringing feedback to the Caller ('auto', 'manual').\n *    By default, feedback will be automatically sent when a call has been received. In 'manual' mode, the application\n *    must initiate the feedback being sent. See the `call.sendRingingFeedback` API for more info.\n * @param {number} [call.callAuditTimer=25000] Time interval, in milliseconds between call audits.\n * @param {number} [call.mediaConnectionRetryDelay=3000] Delay, in milliseconds for the passive side of a call to wait before trying a media reconnection.\n * @param {boolean} [call.normalizeDestination=true] Specifies whether or not SIP address normalization will be applied.\n */\n\n/**\n * @private\n * @name config.call\n * @memberof config\n * @instance\n * @param {string} [trickleIceMode='NONE'] The Trickle ICE method to use for calls. Currently, no mode is supported.\n * @param {boolean} [skipIceCollection=true] Whether to skip the ICE collection process and proceed with negotiation, or not.\n */\n\n/**\n * Call plugin factory for Link platform.\n * @method linkCallFactory\n */\nexport default function linkCallFactory(bottle, options = {}) {\n  /*\n   * Init function to setup the Call plugin after the all plugins have been\n   *    created and redux set-up.\n   * Handles configuration provided by the application and puts it into state.\n   */\n  function initPlugin(container) {\n    const { context, logManager } = container\n    const log = logManager.getLogger('CALL')\n\n    const { mediaDevices, peerConnection } = getWebRTCSupportCapabilities()\n    if (!mediaDevices || !peerConnection) {\n      log.warn(\n        'Calls are not supported on this platform due to lack of WebRTC support. Call APIs will not be available.'\n      )\n    }\n\n    // Parse the options provided by the application and make any adjustments needed\n    //    (for backwards-compatibility reasons).\n    options = parseConfigs(options)\n    // Then merge the defaults into them and validate the values.\n    options = mergeDefaults(options)\n\n    const browserDetails = getBrowserDetails()\n\n    // Change sdpSemantics to always be for Unified-Plan\n    if (options.defaultPeerConfig.sdpSemantics !== 'unified-plan') {\n      log.warn('Only `unified-plan` is supported as sdpSemantics. Switching to `unified-plan`.')\n      options.defaultPeerConfig.sdpSemantics = 'unified-plan'\n    }\n\n    /*\n     * Firefox does not support pranswer, so it can't receive early media.\n     * Ref: https://bugzilla.mozilla.org/show_bug.cgi?id=1004510\n     */\n    if (browserDetails.browser === 'firefox' && options.earlyMedia === true) {\n      log.warn('Firefox does not support pranswer for Early Media. Disabling early media configuration.')\n      options.earlyMedia = false\n    }\n\n    /*\n     * Chrome 110+ will enforce STUN/TURN URL according to RFC Spec.\n     * Ref: https://groups.google.com/g/discuss-webrtc/c/L0qDWipd7VE?pli=1\n     */\n    if (browserDetails.browser === 'chrome' && browserDetails.version >= 110 && options.defaultPeerConfig.iceServers) {\n      options.defaultPeerConfig.iceServers.forEach(iceServer => {\n        if (Array.isArray(iceServer.urls)) {\n          iceServer.urls = iceServer.urls.map(fixIceServerUrls)\n        } else if (iceServer.urls) {\n          iceServer.urls = fixIceServerUrls(iceServer.urls)\n        }\n      })\n    }\n\n    context.dispatch(updateConfig(options, pluginInterface.name))\n\n    // `call.removeH264Codecs` was removed in v6.0, in faviour of createCodecRemover.\n    if (typeof options.removeH264Codecs !== 'undefined') {\n      log.warn(\n        'The `call.removeH264Codecs` configuration has been removed. Please see the documentation for the `sdpHandlers` configuration for how to implement similar behaviour.'\n      )\n    }\n\n    // Update the SDP handlers in the config (user provided + some of our own)\n    context.dispatch(setSdpHandlers(options.sdpHandlers))\n  }\n\n  // Initialize the Callstack in the bottle's scope.\n  setupCallstack(bottle)\n  // Initialize the Link-specific operations in the bottle's scope.\n  for (const name in operationFactories) {\n    operationFactories[name](bottle)\n  }\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('CallAPI', pluginInterface.createAPI)\n  bottle.factory('CallRequests', createRequests)\n\n  bottle.defer(initPlugin)\n\n  return {\n    name: pluginInterface.name,\n    reducer: pluginInterface.reducer,\n    middleware: createMiddleware,\n    capabilities: ['call', 'link_call', 'link_user_id', 'link_pstn']\n  }\n}\n","import { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { CALL_STATES } from '../../constants'\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n\n  async function callCancelledNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    const log = logManager.getLogger('CALL', targetCall ? targetCall.id : undefined)\n    if (!targetCall) {\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    /*\n     * The backend sends a \"callCancel\" notification immediately after answering\n     *    (and rejecting, forwarding) a call. The backend's intention for this\n     *    is to notify other user subscriptions (eg. same user on another\n     *    device) that the call has been handled, so the call is \"cancelled\" for\n     *    this subscription. But they send it as a broadcast notification to all\n     *    subscriptions, even the one that handled the call.\n     *\n     * We need to ignore this notification for the subscription that handled the\n     *    call, but process it for any other subscriptions. We do this in two\n     *    ways:\n     *      1) If the Call state indicates we are obviously the device that\n     *        answered it (eg. the Call is connected), ignore it.\n     *      2) If a flag is set on the Call that indicates we are in-progress\n     *        to handle it, ignore it.\n     *    This handles receiving the callCancel before and after the in-progress\n     *        operation has finished for both regular and slow-start calls.\n     */\n    if (\n      targetCall &&\n      targetCall.state !== CALL_STATES.RINGING &&\n      targetCall.state !== CALL_STATES.EARLY_MEDIA &&\n      targetCall.state !== CALL_STATES.INITIATED\n    ) {\n      // Don't process the notification if the call isn't \"ringing\".\n      log.info(`Received call cancel notification when state is ${targetCall.state}. Ignoring.`)\n      return\n    }\n\n    if (targetCall && targetCall.isHandling) {\n      // Don't process the notification if we are currently handling the call.\n      log.info('Received call cancel notification while handling is in-progress. Ignoring.')\n      return\n    }\n\n    // Handle it.\n    await CallManager.callCancelled(wrtcsSessionId)\n  }\n\n  return callCancelledNotification\n}\n\n// The `incomingCallPattern` function.\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'callCancel'\n}\n","// Call plugin\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\nimport { getRemoteParticipant } from '../utils'\n\n// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { getDomain } from '../../../auth/interface/selectors'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n\n  async function callStatusUpdateEndedNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId, reasonText, statusCode } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      const log = logManager.getLogger('CALL')\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    const domain = getDomain(context.getState())\n    const remoteInfo = getRemoteParticipant(targetCall, message, domain)\n\n    const params = {\n      eventType: message.eventType,\n      reasonText,\n      statusCode,\n      // Remote participant's information.\n      ...remoteInfo\n    }\n\n    await CallManager.callStatusUpdateEnded(wrtcsSessionId, params)\n  }\n\n  return callStatusUpdateEndedNotification\n}\n\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'callEnd'\n}\n","// Call plugin\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\nimport { getRemoteParticipant } from '../utils'\n\n// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { getDomain } from '../../../auth/interface/selectors'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n\n  async function callStatusUpdateFailedNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId, reasonText, statusCode } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      const log = logManager.getLogger('CALL')\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    const domain = getDomain(context.getState())\n    const remoteInfo = getRemoteParticipant(targetCall, message, domain)\n\n    const params = {\n      eventType: message.eventType,\n      reasonText,\n      statusCode,\n      // Remote participant's information.\n      ...remoteInfo\n    }\n\n    await CallManager.callStatusUpdateFailed(wrtcsSessionId, params)\n  }\n\n  return callStatusUpdateFailedNotification\n}\n\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'sessionFail'\n}\n","// Call plugin\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\nimport { getRemoteParticipant } from '../utils'\n\n// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { getDomain } from '../../../auth/interface/selectors'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n\n  async function callStatusUpdateRingingNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      const log = logManager.getLogger('CALL')\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    const domain = getDomain(context.getState())\n    const remoteInfo = getRemoteParticipant(targetCall, message, domain)\n\n    const params = {\n      eventType: message.eventType,\n      // Remote participant's information.\n      ...remoteInfo,\n      customParameters: message.customParameters\n    }\n\n    CallManager.callStatusUpdateRinging(wrtcsSessionId, params)\n  }\n\n  return callStatusUpdateRingingNotification\n}\n\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'ringing'\n}\n","// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\n\nexport default function createMiddleware(context) {\n  const CallManager = context.container.CallManager\n\n  async function incomingCallNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    const message = action.payload.notificationMessage\n\n    const notificationParams = message.callNotificationParams || {}\n    // ID that the server uses to identify the session.\n    const wrtcsSessionId = message.sessionParams.sessionData\n\n    // Massage data into a generic format, instead of Link-specific.\n    const params = {\n      eventType: message.eventType,\n      // The remote SDP offer included with the notification (if any).\n      sdp: message.sessionParams.sdp,\n      // Remote participant information.\n      remoteName: notificationParams.callerName,\n      remoteNumber: notificationParams.callerDisplayNumber,\n      // Where the call was sent\n      calleeNumber: notificationParams.calleeDisplayNumber,\n      // Custom Parameters\n      customParameters: message.customParameters\n    }\n\n    // Pass the incoming call parameters to the Callstack for handling.\n    await CallManager.establishOffer(wrtcsSessionId, params, action.meta.channel)\n  }\n\n  return incomingCallNotification\n}\n\n// The `incomingCallPattern` function.\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'call'\n}\n","// Link-specific middlewares.\nimport callCancelledNotification from './callCancelledNotification'\nimport callStatusUpdateEndedNotification from './callStatusUpdateEndedNotification'\nimport callStatusUpdateFailedNotification from './callStatusUpdateFailedNotification'\nimport callStatusUpdateRingingNotification from './callStatusUpdateRingingNotification'\nimport sessionStatusUpdateEndedNotification from './sessionStatusUpdateEndedNotification'\nimport incomingCallNotification from './incomingCallNotification'\nimport remoteAnswerNotification from './remoteAnswerNotification'\nimport remoteOfferNotification from './remoteOfferNotification'\nimport resyncSessionStatuses from './resyncSessionStatuses'\nimport sessionProgressNotification from './sessionProgressNotification'\nimport setTurnCredentials from './setTurnCredentials'\n\n// Callstack middlewares.\nimport callStackMiddlewares from '../../callstack/middleware'\n\nconst factories = [\n  callCancelledNotification,\n  callStatusUpdateEndedNotification,\n  callStatusUpdateFailedNotification,\n  callStatusUpdateRingingNotification,\n  sessionStatusUpdateEndedNotification,\n  incomingCallNotification,\n  remoteAnswerNotification,\n  remoteOfferNotification,\n  resyncSessionStatuses,\n  sessionProgressNotification,\n  setTurnCredentials,\n  ...callStackMiddlewares\n]\n\n/**\n * Link Call middleware factory function.\n * @method createMiddleware\n * @param  {Object} context The factory context.\n * @return {Function} A redux middleware.\n */\nexport default function createMiddleware(context) {\n  // Create the middlewares scoped with the `context` object.\n  const middlewares = factories.map(factory => factory(context))\n\n  /*\n   * Redux middleware: Watch for specific actions and trigger operations\n   *    when we see them.\n   */\n  return next => action => {\n    // TODO: Do we care about return values? ...no?\n    middlewares.forEach(middleware => middleware(action))\n    return next(action)\n  }\n}\n","// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\nimport { getRemoteParticipant } from '../utils'\nimport { getDomain } from '../../../auth/interface/selectors'\n\nexport default function createMiddleware(context) {\n  const CallManager = context.container.CallManager\n  const logManager = context.container.logManager\n  const log = logManager.getLogger('CALL')\n\n  /**\n   * Handle receiving remote answer notifications in a Link format.\n   * Uses properties in the notification to create a standardized data object to\n   *    be used by the Callstack.\n   * @method remoteAnswerNotification\n   * @param {Object} action  An incoming action which must follow a certain pattern to be accepted by this middleware.\n   */\n  async function remoteAnswerNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    // Handle it.\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    const domain = getDomain(context.getState())\n    const remoteInfo = getRemoteParticipant(targetCall, message, domain)\n\n    // Pull-out the parameters into a standard format for the Callstack.\n    const params = {\n      eventType: message.eventType,\n      wrtcsSessionId: message.sessionParams.sessionData,\n      sdp: message.sessionParams.sdp,\n\n      retryAfter: message.sessionParams.retryAfter,\n      message: message.sessionParams.reasonText,\n      code: message.statusCode,\n\n      // Remote participant information.\n      ...remoteInfo,\n\n      customParameters: message.customParameters\n    }\n    // Pass the call parameters to the Callstack for handling.\n    await CallManager.negotiationAnswer(wrtcsSessionId, params)\n  }\n\n  return remoteAnswerNotification\n}\n\n// The `receiveAnswerPattern` function.\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'respondCallUpdate'\n}\n","import { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\nimport { CALL_STATES } from '../../constants'\nimport { getRemoteParticipant } from '../utils'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n  const log = logManager.getLogger('CALL')\n\n  /**\n   * Handle receiving remote offer notifications in a Link format.\n   * Uses properties in the notification to create a standardized data object to\n   *    be used by the Callstack.\n   * @method receiveRemoteOffer\n   * @param {Object} action A flux standard action\n   */\n  async function remoteOfferNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    // If the call isn't in the correct state to handle this remote operation, ignore it.\n    if (![CALL_STATES.CONNECTED, CALL_STATES.ON_HOLD].includes(targetCall.state)) {\n      log.debug(`Call not in correct state to perform a midcall operation: ${targetCall.state}.`)\n      return\n    }\n\n    const remoteInfo = getRemoteParticipant(targetCall, message)\n\n    // Pull-out the parameters into a standard format for the Callstack.\n    const params = {\n      eventType: message.eventType,\n      wrtcsSessionId: message.sessionParams.sessionData,\n      sdp: message.sessionParams.sdp,\n      ...remoteInfo,\n      customParameters: message.customParameters\n    }\n\n    try {\n      await CallManager.negotiationOffer(wrtcsSessionId, params)\n    } catch (error) {\n      log.warn(`Cannot handle remote operation. Error: ${error.message}`)\n    }\n  }\n\n  return remoteOfferNotification\n}\n\n// The `incomingCallPattern` function.\nexport function shouldHandlePattern(action) {\n  return (\n    action.type === NOTIFICATION_RECEIVED && Boolean(action.payload.notificationMessage.eventType === 'startCallUpdate')\n  )\n}\n","// Call plugin\nimport { RESYNC } from '../../interface/actionTypes'\n\nexport default function createMiddleware(context) {\n  const { CallManager } = context.container\n\n  async function resyncSessionStatuses(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    // Handle it.\n    const callId = action.payload.id\n    await CallManager.resyncCallState(callId)\n  }\n\n  return resyncSessionStatuses\n}\n\n// The `incomingCallPattern` function.\nexport function shouldHandlePattern(action) {\n  return action.type === RESYNC\n}\n","// Call plugin.\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\n\n// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n\n  /**\n   * Handle a Link \"session progress\" notification.\n   * @method sessionProgressNotification\n   */\n  async function sessionProgressNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      const log = logManager.getLogger('CALL')\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    const notificationParams = message.callNotificationParams || {}\n    // Massage data into a generic format, instead of Link-specific.\n    const params = {\n      eventType: message.eventType,\n      sdp: message.sessionParams.sdp,\n      remoteName: notificationParams.remoteName,\n      remoteNumber: notificationParams.remoteDisplayNumber,\n      customParameters: message.customParameters\n    }\n\n    await CallManager.receiveEarlyMedia(wrtcsSessionId, params)\n  }\n\n  return sessionProgressNotification\n}\n\n// The `incomingCallPattern` function.\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'sessionProgress'\n}\n","// Call plugin\nimport { getCallByWrtcsSessionId } from '../../interface/selectors'\nimport { getRemoteParticipant } from '../utils'\n\n// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../../notifications/interface/actionTypes'\nimport { getDomain } from '../../../auth/interface/selectors'\n\nexport default function createMiddleware(context) {\n  const { CallManager, logManager } = context.container\n\n  async function sessionStatusUpdateEndedNotification(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    const message = action.payload.notificationMessage\n    const { sessionData: wrtcsSessionId, reasonText, statusCode } = message.sessionParams\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), wrtcsSessionId)\n    if (!targetCall) {\n      const log = logManager.getLogger('CALL')\n      log.info(`Received ${message.eventType} notification for unknown call; ignoring.`)\n      return\n    }\n\n    const domain = getDomain(context.getState())\n    const remoteInfo = getRemoteParticipant(targetCall, message, domain)\n\n    const params = {\n      eventType: message.eventType,\n      reasonText,\n      statusCode,\n      // Remote participant's information.\n      ...remoteInfo\n    }\n\n    await CallManager.sessionStatusUpdateEnded(wrtcsSessionId, params)\n  }\n\n  return sessionStatusUpdateEndedNotification\n}\n\nexport function shouldHandlePattern(action) {\n  return action.type === NOTIFICATION_RECEIVED && action.payload.notificationMessage.eventType === 'sessionComplete'\n}\n","// Other plugins\nimport { SUBSCRIBE_FINISHED } from '../../../subscription/interface/actionTypes'\n\n// src/call/sagaLink/sagas/index.js\nexport default function createMiddleware(context) {\n  const operations = context.container.CallOperations\n\n  function setTurnCredentials(action) {\n    if (!shouldHandlePattern(action)) {\n      // Don't handle it.\n      return\n    }\n\n    // Call the set turn credentials operation and forward the action to the operation\n    operations.setTurnCredentials(action)\n  }\n\n  return setTurnCredentials\n}\n\n// The `incomingCallPattern` function.\nexport function shouldHandlePattern(action) {\n  return !!(\n    !action.error &&\n    action.type === SUBSCRIBE_FINISHED &&\n    action.payload.subscriptions &&\n    action.payload.subscriptions.length &&\n    action.payload.subscriptions[0].turnCredentials\n  )\n}\n","// Re-export all of the operations.\nexport { default as setTurnCredentials } from './setTurnCredentials'\n","import setTurnCredentials from './setTurnCredentials'\n\n/*\n * Register the operation with the bottle. This will make it available on the\n *    top-level container under its namespace.\n */\nexport default function registerOperation(bottle) {\n  bottle.factory('CallOperations.setTurnCredentials', () => {\n    // Provide the top-level bottle container to the factory function.\n    //    This ensures everything is accessible, instead of only items in the\n    //    nested `CallOperations` container.\n    return setTurnCredentials(bottle.container)\n  })\n}\n","// Call plugin.\nimport { turnActions } from '../../../interface/actions'\nimport { getOptions } from '../../../interface/selectors'\n\n/**\n * Link-specific \"set turn credentials\" operation factory.\n * @method createOperation\n * @param  {Object} container The bottle container.\n */\nexport default function createOperation(container) {\n  const { context, logManager } = container\n  const log = logManager.getLogger('CALL')\n  /**\n   * Handles setting turn/stun information that has been\n   *    received from the server.\n   * @method setTurnCredentials\n   * @param {Object} action A \"connect finished\" action.\n   */\n  function setTurnCredentials(action) {\n    const { serverTurnCredentials, defaultPeerConfig } = getOptions(context.getState())\n\n    // Must have ICE servers configured. Check the new way of configuring them...\n    if (defaultPeerConfig.iceServers.length === 0) {\n      log.debug('No ICE servers provided during setup; not using TURN/STUN for calls.')\n      return\n    }\n\n    if (!serverTurnCredentials) {\n      log.debug('Using application provided TURN credentials.')\n      return\n    }\n\n    // TURN credentials received from the server.\n    const turnCredentials = action.payload.subscriptions[0].turnCredentials\n\n    context.dispatch(\n      turnActions.turnChanged({\n        credentials: turnCredentials\n      })\n    )\n  }\n\n  return setTurnCredentials\n}\n","// Call plugin\nimport { getCallById } from '../../interface/selectors'\nimport { OPERATIONS } from '../../interface/constants'\nimport { REPORT_EVENTS } from '../../callstack/reporter/constants'\n\n// Other plugins.\nimport { getRequestInfo } from '../../../auth/interface/selectors'\n\n// Helpers.\nimport * as requestUtils from './utils'\n\n/**\n * Bottle wrapper for Link \"complex\" call requests.\n * @return {Object}\n */\nexport default function complexRequests(container) {\n  const { context, sendRequest, CallReporter } = container\n\n  /**\n   * Direct Transfers an incoming session to another destination address.\n   * Link-specific signaling function.\n   *\n   * This function \"direct transfers\" the server session to a specified destination address.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method directTransferSession\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.id The ID of the call.\n   * @param  {string} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {string} callInfo.address The address to forward the session to.\n   * @return {undefined}\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function directTransferSession(callInfo) {\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'PUT'\n    }\n\n    options.body = JSON.stringify({\n      callControlRequest: {\n        type: 'transfer',\n        address: callInfo.address\n      }\n    })\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), callInfo.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.DIRECT_TRANSFER\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Create main event representing the request we're about to make\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    }\n    // No need to add any extra metadata since `response` only contains status code\n    // Just end sub-event.\n    requestEvent.endEvent()\n  }\n\n  /**\n   * Transfers ongoing sessions into one another.\n   * Link-specific signaling function.\n   *\n   * This function \"transfers\" the server sessions.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method consultativeTransferSessions\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.id The ID of the call.\n   * @param  {string} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {string} callInfo.otherWrtcsSessionId The ID the backend uses to track the other session.\n   * @param  {string} callInfo.destination The address of the other session to transfer to.\n   * @return {undefined} response object from the server.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function consultativeTransferSessions(callInfo) {\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'PUT'\n    }\n\n    options.body = JSON.stringify({\n      callControlRequest: {\n        type: 'transfer',\n        sessionData: callInfo.otherWrtcsSessionId,\n        address: callInfo.destination\n      }\n    })\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), callInfo.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.CONSULTATIVE_TRANSFER\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Create main event representing the request we're about to make\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    }\n    requestEvent.endEvent()\n  }\n\n  /**\n   * Joins ongoing sessions into a new session.\n   * Link-specific signaling function.\n   *\n   * This request \"joins\" the server sessions.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method joinSessions\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.id The ID of the call.\n   * @param  {string} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {string} callInfo.otherWrtcsSessionId\n   * @param  {string} callInfo.sdp The new sdp to use.\n   * @param  {Array<CustomParameter>} callInfo.customParameters The custom parameters of the current call.\n   * @param  {Array<CustomBody>} callInfo.customBodies The custom bodies of the call.\n   * @return {string} newWrtcsSessionId The back-end session id, if signalling succeeded.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function joinSessions(callInfo) {\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'POST'\n    }\n\n    options.body = JSON.stringify({\n      callControlRequest: {\n        type: 'join',\n        firstSessionData: callInfo.wrtcsSessionId,\n        secondSessionData: callInfo.otherWrtcsSessionId,\n        sdp: callInfo.sdp,\n        customParameters: callInfo.customParameters\n        // TODO: Pass the Custom Bodies as well if supported\n      }\n    })\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), callInfo.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.JOIN\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Create main event representing the request we're about to make\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, options)\n\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    }\n\n    requestEvent.endEvent()\n\n    return response.callControlResponse.sessionData\n  }\n\n  return {\n    directTransferSession,\n    consultativeTransferSessions,\n    joinSessions\n  }\n}\n","// Call plugin.\nimport { getOptions, getCallByWrtcsSessionId, getCallById } from '../../interface/selectors'\nimport { OPERATIONS } from '../../interface/constants'\n\nimport { REPORT_EVENTS, REPORTER_REQUESTS } from '../../callstack/reporter/constants'\n\n// Other plugins.\nimport { getDomain, getRequestInfo } from '../../../auth/interface/selectors'\nimport { getWebsocketId } from '../../../subscription/interface/selectors'\n\n// Helpers.\nimport { normalizeSipUri } from '../../utils/normalization'\nimport * as requestUtils from './utils'\nimport BasicError, { callCodes } from '../../../errors'\n\n/**\n * Bottle wrapper for Link \"establish\" call requests.\n * @return {Object}\n */\nexport default function establishRequests(container) {\n  const { context, logManager, sendRequest, CallReporter } = container\n\n  /**\n   * Creates a Call session on the KandyLink server.\n   *\n   * @method createSession\n   * @param {Object} info Information the backend needs to create the call.\n   * @param {string} info.id The ID the SDK uses to identify this call.\n   * @param {string} info.to The user to receive the call.\n   * @param {string} info.offer The local SDP offer to begin negotiation.\n   * @param {boolean} info.isAnonymous Whether the local user is anonymous or not.\n   * @param {string} info.account If anonymous, the user account used to authenticate the request.\n   * @param {string} info.from If anonymous, the username for the call to be \"from\".\n   * @param {Object} [options={}] Additional details for the call / request.\n   * @param {string} [options.displayName] A custom display name to use. Not supported in\n   *    all environments and may use default display name.\n   * @param {Array} [options.customParameters] Custom SIP header parameters for the SIP backend.\n   * @param {Array} [options.customBodies] Custom SIP bodies for the SIP backend.\n   * @return {string} The ID that the server uses to identify this call.\n   * @throws {BasicError} Throws a GENERIC_ERROR if an anonymous user has no call subscription.\n   * @throws {BasicError} Throws an if the REST request fails.\n   */\n  async function createSession(info, options) {\n    const log = logManager.getLogger('CALL', info.id)\n    log.info('Creating call session on server-side.')\n\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n    const callOptions = getOptions(context.getState())\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(info.id)\n\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), info.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && (op.type === OPERATIONS.MAKE || op.type === OPERATIONS.MAKE_ANONYMOUS)\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    /*\n     * For an anonymous call, the \"from\" user is provided by the application.\n     * For a regular call, the \"from\" user is always the local user.\n     */\n    let originator\n    if (info.isAnonymous) {\n      originator = info.from\n    } else {\n      originator = normalizeSipUri(requestInfo.username, getDomain(context.getState()))\n      log.debug('Caller address normalized to: ' + originator)\n    }\n\n    // If a custom display name was provided, update the \"from\" address to include it.\n    if (options.displayName) {\n      originator = `${options.displayName}<${originator}>`\n    }\n\n    const requestBody = {\n      type: 'callStart',\n      to: info.to,\n      from: originator,\n      sdp: info.offer\n    }\n\n    /*\n     * For optional parameters, only add them to the request body if they are defined.\n     */\n    if (callOptions.earlyMedia) {\n      /*\n       * Also, if there are no supported items, `supported` should not be left as\n       *    an empty array because SPiDR will reject the body when it is left empty\n       *    (for anonymous calls).\n       */\n      requestBody.supported = ['earlymedia']\n    }\n    if (options.customParameters) {\n      requestBody.customParameters = options.customParameters\n    }\n    if (options.customBodies) {\n      requestBody.customBodies = options.customBodies\n    }\n\n    // The information to be passed to `fetch`.\n    const fetchInfo = {\n      ...info,\n      method: 'POST'\n    }\n    let responseType\n    if (info.isAnonymous) {\n      responseType = 'callMeResponse'\n\n      // Get the ID of the notification channel (ie. websocket) being used for\n      //    the call subscription.\n      const websocketId = getWebsocketId(context.getState(), 'callMe')\n      if (!websocketId) {\n        throw new BasicError({\n          code: callCodes.GENERIC_ERROR,\n          message: 'Cannot start call without call service subscription.'\n        })\n      }\n\n      fetchInfo.body = JSON.stringify({\n        callMeRequest: {\n          ...requestBody,\n          notifyChannelId: websocketId\n        }\n      })\n    } else {\n      responseType = 'callControlResponse'\n\n      fetchInfo.body = JSON.stringify({\n        callControlRequest: requestBody\n      })\n    }\n\n    // Before sending the REST request, mark it's start by creating a sub-event\n    // within the timeline of its parent operational event\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.CREATE_SESSION)\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, fetchInfo)\n\n    if (response.error) {\n      log.debug('Failed to create Call session server-side.', response.error)\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    } else {\n      const wrtcsSessionId = response[responseType].sessionData\n      log.debug('Call session created server-side.', { wrtcsSessionId })\n\n      requestEvent.addData('wrtcsSessionId', wrtcsSessionId)\n      requestEvent.endEvent()\n      return wrtcsSessionId\n    }\n  }\n\n  async function answerSession(info) {\n    const log = logManager.getLogger('CALL', info.id)\n    log.info('Answering call session on server-side.')\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(info.id)\n\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), info.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.ANSWER\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'PUT'\n    }\n\n    options.body = JSON.stringify({\n      callControlRequest: {\n        type: 'callAnswer',\n        sdp: info.answer,\n        customParameters: info.customParameters,\n        customBodies: info.customBodies\n      }\n    })\n\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.ANSWER_SESSION)\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...info })\n\n    if (response.error) {\n      log.debug('Failed to answer Call session server-side.', response.error)\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    } else {\n      log.debug('Call session answered server-side.', { wrtcsSessionId: info.wrtcsSessionId })\n      requestEvent.endEvent()\n    }\n  }\n\n  /**\n   * Rejects an incoming session.\n   * Link-specific signaling function.\n   *\n   * This request \"rejects\" the server session.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   *    2. There is an incoming session.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * REST request to reject a webRTC session.\n   * @method rejectSession\n   * @param  {Object} callInfo\n   * @param  {Object} callInfo.id The ID of the Call.\n   * @param  {string} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @return {Object} response object from the server.\n   * @return {Object} [response.error] An error object, if signalling failed.\n   */\n  async function rejectSession(info) {\n    const log = logManager.getLogger('CALL', info.id)\n    log.info('Rejecting call session on server-side.')\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(info.id)\n\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), info.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.REJECT\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'POST'\n    }\n\n    options.endUrl = 'calldisposition'\n\n    options.body = JSON.stringify({\n      callDispositionRequest: {\n        action: 'reject',\n        sessionData: info.wrtcsSessionId\n      }\n    })\n\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.REJECT_SESSION)\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, options)\n\n    if (response.error) {\n      log.debug('Failed to reject Call session server-side.', { wrtcsSessionId: info.wrtcsSessionId }, response.error)\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    } else {\n      log.debug('Call session rejected server-side.', { wrtcsSessionId: info.wrtcsSessionId })\n      requestEvent.endEvent()\n    }\n  }\n\n  /**\n   * Forwards an incoming session to another destination address.\n   * Link-specific signaling function.\n   *\n   * This function \"forwards\" the server session to a specified destination address.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   *    2. There is an incoming session.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method forwardSession\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {string} callInfo.address The address to forward the session to.\n   * @return {undefined}\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function forwardSession(callInfo) {\n    const call = getCallByWrtcsSessionId(context.getState(), callInfo.wrtcsSessionId)\n\n    const log = logManager.getLogger('CALL', call.id)\n    log.info('Forwarding call session on server-side.')\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(call.id)\n\n    // Get the main operational event that is ongoing\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.FORWARD_CALL\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'POST'\n    }\n\n    options.endUrl = 'calldisposition'\n\n    options.body = JSON.stringify({\n      callDispositionRequest: {\n        action: 'forward',\n        sessionData: callInfo.wrtcsSessionId,\n        address: callInfo.address\n      }\n    })\n\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.FORWARD_SESSION)\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, options)\n\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    }\n    requestEvent.endEvent()\n  }\n\n  /**\n   * A REST DELETE request to send webRTC session call end requests.\n   * @method endSession\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.callId The ID that the SDK uses to identify this call.\n   * @param  {string} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n   * @param  {boolean} callInfo.isAnonymous Whether the call is anonymous or not.\n   * @param  {string} [callInfo.account] An account token used by the request if it is an anonymous call.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function endSession(callInfo) {\n    const log = logManager.getLogger('CALL', callInfo.callId)\n    log.info('Ending call session on server-side.')\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.callId)\n\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), callInfo.callId)\n    const operation = call.currentOperations.find(op => {\n      // The END and complex operations use this request.\n      return (\n        op.isLocal &&\n        [OPERATIONS.END, OPERATIONS.JOIN, OPERATIONS.DIRECT_TRANSFER, OPERATIONS.CONSULTATIVE_TRANSFER].includes(\n          op.type\n        )\n      )\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'DELETE',\n      responseType: 'none'\n    }\n\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.END_SESSION)\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n    if (response.error) {\n      log.info('Failed to end Call session server-side.', response.error)\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    }\n    log.info('Call session ended server-side.', { wrtcsSessionId: callInfo.wrtcsSessionId })\n    requestEvent.endEvent()\n  }\n\n  return {\n    createSession,\n    answerSession,\n    rejectSession,\n    forwardSession,\n    endSession\n  }\n}\n","import complexRequests from './complex'\nimport establishRequests from './establish'\nimport miscRequests from './misc'\nimport negotiationRequests from './negotiation'\n\n/**\n * Link-specific Call Requests factory function.\n * Creates a closure where dependencies can be set and used\n *    by requests.\n */\nexport default function createRequests(container) {\n  return {\n    ...complexRequests(container),\n    ...establishRequests(container),\n    ...miscRequests(container),\n    ...negotiationRequests(container)\n  }\n}\n","// Call plugin\nimport { getCallById } from '../../interface/selectors'\nimport { OP_STATUS, OPERATIONS } from '../../interface/constants'\nimport { REPORT_EVENTS, REPORTER_REQUESTS } from '../../callstack/reporter/constants'\n\n// Other plugins\nimport { getRequestInfo } from '../../../auth/interface/selectors'\n\n// Helpers\nimport * as requestUtils from './utils'\nimport BasicError from '../../../errors'\n\n/**\n * Bottle wrapper for Link \"misc\" call requests.\n * @return {Object}\n */\nexport default function miscRequests(container) {\n  const { context, sendRequest, logManager, CallReporter } = container\n\n  // eslint-disable-next-line no-warning-comments\n  /**\n   * Gets the status of a session from the server.\n   * Link-specific signaling function.\n   *\n   * Assumptions:\n   *    1. The current user is authenticated.\n   *    2. Signalling server has Kandy Link 4.7.1+\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method getSession\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.id The ID of the call.\n   * @param  {Object} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {boolean} [callInfo.isAnonymous] Flag indicating whether the call is anonymous or not.\n   * @param  {string} [callInfo.account] An account token used by the request if it is an anonymous call.\n   * @return {Object} response Signalling response.\n   * @throws {Object} response.error An error object, if signalling failed.\n   */\n  async function getSession(callInfo) {\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = { method: 'GET' }\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), callInfo.id)\n\n    let requestEvent\n    const ongoingLocalOp = call.currentOperations.find(op => {\n      return op.isLocal && op.status === OP_STATUS.ONGOING\n    })\n    if (ongoingLocalOp) {\n      const operationEvent = report.getEvent(ongoingLocalOp.eventId)\n\n      // Create main event representing the request we're about to make\n      requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n      // Add some metadata to it\n      requestEvent.addData('requestType', REPORTER_REQUESTS.GET_SESSION)\n    } else {\n      // If there is no ongoing local operation, then we look for last 'receive call' main event,\n      // which should always be present in case of calling this function.\n      const lastEvent = report.findLastOngoingEvent(REPORT_EVENTS.RECEIVE_CALL)\n      requestEvent = lastEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n      // Add some metadata to it\n      requestEvent.addData('requestType', REPORTER_REQUESTS.GET_SESSION)\n    }\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      throw response.error\n    } else {\n      requestEvent.addData('state', response.callControlResponse.state)\n      requestEvent.endEvent()\n      return {\n        error: false,\n        state: response.callControlResponse.state\n      }\n    }\n  }\n\n  /**\n   * Updates a webRTC session on the server with a new state.\n   * Link-specific signaling function.\n   *\n   * The request updates the server's session to be in \"ringing\" state.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method updateCallRinging\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.id The ID of the call.\n   * @param  {string} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n   * @param  {string} callInfo.isAnonymous    Whether the call is an anonymous call.\n   * @return {Object} response Signalling response.\n   * @throws {Object} [response.error] An error object, if signalling failed.\n   */\n  async function updateCallRinging(callInfo) {\n    const log = logManager.getLogger('CALL', callInfo.id)\n    log.info('Updating call session as ringing on server-side.')\n\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'PUT'\n    }\n\n    options.body = JSON.stringify({\n      callControlRequest: {\n        type: 'ringing'\n      }\n    })\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Get the RECEIVE_CALL event from the report\n    const receiveCallEvent = report.findLastOngoingEvent([\n      REPORT_EVENTS.RECEIVE_CALL,\n      REPORT_EVENTS.SEND_RINGING_FEEDBACK\n    ])\n\n    // Create main event representing the request we're about to make\n    const requestEvent = receiveCallEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.CALL_RINGING_UPDATE_SESSION)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      log.debug('Failed to update call session as ringing server-side.', response.error)\n      // Need a linter exception here because we need to throw more data than what we can include in an instance of BasicError\n      // eslint-disable-next-line no-throw-literal\n      throw {\n        error: response.error\n      }\n    } else {\n      log.debug('Call session updated as ringing server-side.', {\n        wrtcsSessionId: callInfo.wrtcsSessionId\n      })\n      requestEvent.addData('wrtcsSessionId', callInfo.wrtcsSessionId)\n      requestEvent.endEvent()\n      return {\n        error: false\n      }\n    }\n  }\n  /**\n   * Sends the (new?) custom parameters of the call to the webRTC session on the server.\n   * @method updateCustomParameters\n   * @param {Object} callInfo\n   * @param {string} callInfo.id The ID of the call.\n   * @param {string} callInfo.wrtcsSessionId    ID that the server uses to identify the session.\n   * @param {string} callInfo.isAnonymous       Whether the call is an anonymous call\n   * @param {Array<CustomParameter>} callInfo.customParameters  The custom parameters\n   * @return {Object} response Signaling response.\n   */\n  async function updateCustomParameters(callInfo) {\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'PUT'\n    }\n\n    const bodyType = callInfo.isAnonymous ? 'callMeRequest' : 'callControlRequest'\n\n    options.body = JSON.stringify({\n      [bodyType]: {\n        type: 'sendCustomHeaders',\n        customParameters: callInfo.customParameters\n      }\n    })\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Get the main operational event that is ongoing\n    const call = getCallById(context.getState(), callInfo.id)\n    const operation = call.currentOperations.find(op => {\n      return op.isLocal && op.type === OPERATIONS.SEND_CUSTOM_PARAMETERS\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Create main event representing the request we're about to make\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.UPDATE_CUSTOM_PARAMETERS_ON_SESSION)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n\n    if (response.error) {\n      requestEvent.setError(response.error)\n      requestEvent.endEvent()\n      // Need a linter exception here because we need to throw more data than what we can include in an instance of BasicError\n      // eslint-disable-next-line no-throw-literal\n      throw {\n        error: response.error\n      }\n    } else {\n      requestEvent.endEvent()\n      return {\n        error: false\n      }\n    }\n  }\n\n  /**\n   * Updates a webRTC session on the server to ensure it's state.\n   * Link-specific signaling function.\n   *\n   * This function \"audits\" the server session to:\n   *    1. notify the server that the call is still on-going locally, and\n   *    2. ensure that the server is still handling the server session.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method auditCall\n   * @param  {Object} callInfo\n   * @param  {string} callInfo.id The ID of the call.\n   * @param  {string} callInfo.wrtcsSessionId ID that the server uses to identify the session.\n   * @param  {boolean} [callInfo.isAnonymous] Flag indicating whether the call is anonymous or not.\n   * @param  {string} [callInfo.account] An account token used by the request if it is an anonymous call.\n   * @return {Object} response Signalling response.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function auditCall(callInfo) {\n    const requestInfo = getRequestInfo(context.getState())\n    const options = { method: 'PUT' }\n    const bodyType = callInfo.isAnonymous ? 'callMeRequest' : 'callControlRequest'\n\n    options.body = JSON.stringify({\n      [bodyType]: {\n        type: 'audit'\n      }\n    })\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(callInfo.id)\n    // Add an AUDIT_CALL main event from the report\n    const auditCallEvent = report.addEvent(REPORT_EVENTS.AUDIT_CALL)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n\n    if (response.error) {\n      auditCallEvent.setError(response.error)\n      auditCallEvent.endEvent()\n      // Wrap the info in a BasicError because that is what sendCallAudit operation expects to receive.\n      throw new BasicError({ code: response.error.code, message: response.error.message })\n    } else {\n      auditCallEvent.endEvent()\n      return { status: 'Connected', error: false }\n    }\n  }\n\n  return {\n    getSession,\n    updateCallRinging,\n    updateCustomParameters,\n    auditCall\n  }\n}\n","import { getRequestInfo } from '../../../auth/interface/selectors'\nimport { getCallByWrtcsSessionId, getCallById } from '../../interface/selectors'\nimport { OP_STATUS } from '../../interface/constants'\n\nimport { REPORT_EVENTS, REPORTER_REQUESTS } from '../../callstack/reporter/constants'\n\n// Helpers\nimport * as requestUtils from './utils'\n\n/**\n * Bottle wrapper for Link \"negotiation\" call requests.\n * @return {Object}\n */\nexport default function negotiationRequests(container) {\n  const { context, sendRequest, CallReporter } = container\n  /**\n   * Updates an existing webRTC session on the server.\n   * Link-specific signalling function.\n   *\n   * This function \"updates a session\" between the current user and another, specified\n   *    user.\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Format parameters as needed for signalling.\n   *    2. Perform the REST request.\n   *    3. Return the response, formatted.\n   * @method updateSession\n   * @param  {Object} info\n   * @param  {string} info.id The ID of the call.\n   * @param  {string} info.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {string} info.offer The local SDP offer to begin negotiation.\n   * @param  {boolean} [info.isAnonymous] Flag indicating whether the call is anonymous or not.\n   * @param  {string}  [info.account] An account token used by the request if it is an anonymous call.\n   * @param  {Array}   [info.customParameters] The custom parameters of the call.\n   * @param  {Array}   [info.customBodies] The custom bodies of the call.\n   * @return {Object} response Signalling response.\n   * @return {Object} response.error An error object, if signalling failed.\n   */\n  async function updateSession(info) {\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = { method: 'PUT' }\n    const bodyType = info.isAnonymous ? 'callMeRequest' : 'callControlRequest'\n\n    options.body = JSON.stringify({\n      [bodyType]: {\n        type: 'startCallUpdate',\n        sdp: info.offer,\n        customParameters: info.customParameters,\n        customBodies: info.customBodies\n      }\n    })\n\n    const targetCall = getCallById(context.getState(), info.id)\n\n    // Get the report for this call id\n    const report = CallReporter.getReport(targetCall.id)\n\n    // Get the main operational event that is ongoing\n    const operation = targetCall.currentOperations.find(op => {\n      return op.isLocal && op.status === OP_STATUS.PENDING\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    requestEvent.addData('requestType', REPORTER_REQUESTS.UPDATE_SESSION)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...info })\n\n    if (response.error) {\n      requestEvent.endEvent(response.error)\n      throw response.error\n    }\n    requestEvent.endEvent()\n  }\n\n  /**\n   * Responds to a received remote offer to update the webRTC session.\n   * Link-specific signaling function.\n   *\n   * This request responds to a \"call update\" request as part of renegotiation.\n   * This request handles both success and failure scenarios.\n   *\n   * In the case of a success scenario, this request\n   *    updates the server session with an answer SDP, which in turn should notify\n   *    the remote end of the session with the response.\n   * In the case of a failure scenario, this request responds with a status code.\n   *\n   * Assumptions:\n   *    1. The current user is authenticated.\n   * Responsibilities:\n   *    1. Perform the REST request.\n   *    2. Return the response, formatted.\n   * @method updateSessionResponse\n   * @param  {Object} callInfo\n   * @param  {Object} callInfo.wrtcsSessionId The ID the backend uses to track the session.\n   * @param  {string} callInfo.answer The local SDP to complete renegotiation. This may be an offer if performing slow start.\n   * @param  {boolean} [callInfo.isAnonymous] Flag indicating whether the call is anonymous or not.\n   * @param  {string} [callInfo.account] An account token used by the request if it is an anonymous call.\n   * @throws {BasicError} An error object, if signalling failed.\n   */\n\n  async function updateSessionResponse(callInfo) {\n    // Collect the information needed to make the request.\n    const requestInfo = getRequestInfo(context.getState())\n\n    const options = {\n      method: 'PUT'\n    }\n    const bodyType = callInfo.isAnonymous && callInfo.account ? 'callMeRequest' : 'callControlRequest'\n\n    const body = {\n      [bodyType]: {\n        type: 'respondCallUpdate'\n      }\n    }\n\n    if (callInfo.statusCode) {\n      body[bodyType].statusCode = `${callInfo.statusCode}`\n    } else {\n      body[bodyType].sdp = callInfo.answer\n      body[bodyType].customParameters = callInfo.customParameters\n      body[bodyType].customBodies = callInfo.customBodies\n    }\n\n    options.body = JSON.stringify(body)\n\n    const targetCall = getCallByWrtcsSessionId(context.getState(), callInfo.wrtcsSessionId)\n    // Get the report for this call id\n    const report = CallReporter.getReport(targetCall.id)\n\n    // Get the main operational event that is ongoing\n    const operation = targetCall.currentOperations.find(op => {\n      return !op.isLocal\n    })\n    const operationEvent = report.getEvent(operation.eventId)\n\n    // Before sending the REST request, mark it's start by creating a sub-event\n    // within the timeline of its parent operational event\n    const requestEvent = operationEvent.addEvent(REPORT_EVENTS.REST_REQUEST)\n    // Add some metadata to it\n    requestEvent.addData('requestType', REPORTER_REQUESTS.UPDATE_SESSION)\n\n    const response = await requestUtils.linkCallRequest(sendRequest, requestInfo, { ...options, ...callInfo })\n\n    if (response.error) {\n      requestEvent.endEvent(response.error)\n      throw response.error\n    }\n\n    // No data returned from this server response, so we're not adding any data to this sub-event either\n    requestEvent.endEvent()\n  }\n\n  return {\n    updateSession,\n    updateSessionResponse\n  }\n}\n","// Helpers\nimport BasicError from '../../../errors'\n\n/**\n * Helper function which sends LINK related requests.\n * @param {function} sendRequest Utility function which sends the actual REST request to server side.\n * @param {Object} requestInfo Object containing request information.\n * @param {Object} options Any additional options associated with the REST request.\n * @return {Object} The server's response body (if request was successful), otherwise a BasicError.\n */\nexport async function linkCallRequest(sendRequest, requestInfo, options) {\n  options.url = generateCallUrl(requestInfo, options)\n\n  const response = await sendRequest(options)\n  if (response.error) {\n    return {\n      error: handleLinkCallRequestError(response)\n    }\n  } else {\n    return response.body\n  }\n}\n\n/**\n * Analizes a failed server response in order to generate a specific BasicError.\n * @param {Object} response The server response which indicates a failure.\n * @return {BasicError} The error object containing a specific error code & message.\n */\nexport function handleLinkCallRequestError(response) {\n  function getMessage(code) {\n    switch (code) {\n      case 5:\n        return 'Request failed: Invalid or missing request body'\n      case 26:\n        return 'Request failed: Internal Server Error'\n      case 27:\n        return 'Request failed: Authorization failure'\n      case 35:\n        return 'Request failed: Service is not authorized due to Call Control resources on the server being not enabled'\n      case 37:\n        return 'Request failed: Detected invalid parameter value. Check Request content'\n      case 42:\n        return 'Request failed: Resource does not exist'\n      case 61:\n        return 'Request failed: Authentication failure due to credentials not provided or incorrect'\n      case 62:\n        return 'Request failed: Authentication failure due to account being disabled'\n      case 63:\n        return 'Request failed: Authentication failure due to account being locked'\n      case 1004:\n        return 'Request failed: Bad request'\n      default:\n        return 'Request failed: Unknown error'\n    }\n  }\n\n  let message, code\n\n  if (response) {\n    if (response.body) {\n      if ('callControlResponse' in response.body) {\n        // The response includes a body with an error message.\n        const { callControlResponse } = response.body\n        message = getMessage(callControlResponse.statusCode)\n        // TODO: Do we want to wrap the backend's error codes?\n        code = callControlResponse.statusCode\n      } else {\n        // As serviceException details not available, we will capture general error information\n        message = response.body.message\n        code = response.result.code\n      }\n    } else if (response.result) {\n      message = `Request failed: ${response.result.message}`\n      code = response.result.code\n    } else {\n      message = 'Request failed: Unknown error.'\n    }\n  } else {\n    message = 'Request failed: Unknown error.'\n  }\n\n  return new BasicError({ message, code })\n}\n\n/**\n * Generates the call url for the rest request based on the options provided.\n * @param {Object} requestInfo Object containing request information\n * @param {Object} options\n * @param {boolean} [options.isAnonymous] Flag indicating whether the call is anonymous or not.\n * @param {string} [options.account] An account token used by the request if it is an anonymous call.\n * @param {string} [options.wrtcsSessionId] The ID the backend uses to track the session.\n * @param {string} [options.endUrl] The end url to append to the main url.\n */\nexport function generateCallUrl(requestInfo, options) {\n  // Generic user information.\n  const { baseURL, version, username } = requestInfo\n  // Call specific information.\n  const { isAnonymous, account, wrtcsSessionId, endUrl } = options\n\n  const userType = isAnonymous ? 'anonymous' : 'user'\n  const userId = isAnonymous ? account : username\n  const requestType = isAnonymous ? 'callMe' : 'callControl'\n\n  // The common path for all call REST requests.\n  let url = `${baseURL}/rest/version/${version}/${userType}/${userId}`\n\n  if (endUrl) {\n    url += `/${endUrl}`\n  } else {\n    url += `/${requestType}`\n  }\n\n  // If the REST request is for an existing call, the path includes its ID.\n  if (wrtcsSessionId) {\n    url += `/callSessions/${wrtcsSessionId}`\n  }\n\n  return url\n}\n","/**\n * Gets the remote participant data from a notification object's `callNotificationParams` property if it exists.\n * @param {Object} targetCall The current call object from state.\n * @param {Object} notification The notification object to extract remote participant data from.\n * @param {Object} domain The domain associated with the authenticated user.\n * @returns {Object|undefined} Object containing `remoteName` & `remoteNumber` properties.\n *                   Or undefined if `callNotificationParams` property does not exist.\n */\nexport function getRemoteParticipant(targetCall, notification, domain) {\n  if (!notification.callNotificationParams || !targetCall) {\n    // `sessionComplete` notification doesn't have `callNotificationParams`.\n    return {}\n  }\n\n  let remoteInfo = {}\n\n  // A \"conference\" call is a joined call. Joined calls are _always_ incoming\n  //    calls, even if the original call was outgoing.\n  const isConference =\n    notification.callNotificationParams.callerDisplayNumber &&\n    notification.callNotificationParams.callerDisplayNumber.startsWith('conference@')\n\n  const isIncoming = targetCall.direction === 'incoming' || isConference\n\n  /**\n   * SPiDR notifications seem to have different \"remote participant\" properties\n   *    in different scenarios. Determine which scenario the call is in to know\n   *    how to parse the notification.\n   */\n  if (isIncoming) {\n    remoteInfo = {\n      remoteName: notification.callNotificationParams.callerName,\n      remoteNumber: notification.callNotificationParams.callerDisplayNumber\n    }\n  } else {\n    remoteInfo = {\n      remoteName: notification.callNotificationParams.remoteName,\n      remoteNumber: notification.callNotificationParams.remoteDisplayNumber\n    }\n  }\n  /*\n   * Sometimes the \"display number\" doesn't include a domain. Make sure it has\n   *    a domain so that it is always consistent.\n   * TODO: Figure out in which cases this was needed. Transfer?\n   *    Ref: KAA-746\n   */\n  if (remoteInfo.remoteNumber && !remoteInfo.remoteNumber.includes('@')) {\n    remoteInfo.remoteNumber += domain\n  }\n\n  // If the data from the notification is undefined, use whatever the existing\n  //    value on the call was.\n  return {\n    remoteName: remoteInfo.remoteName || targetCall.remoteParticipant.displayName,\n    remoteNumber: remoteInfo.remoteNumber || targetCall.remoteParticipant.displayNumber\n  }\n}\n","/**\n * Creates and returns an SDP Handler function that will remove the desired codecs\n *  from the SDP when passed to the pipeline.\n *\n * @method createCodecRemover\n * @param  {string[]|Object[]} codecs An array of strings or objects representing the desired codecs to be removed.\n * @example\n * // `codecs` paramters can be an array of strings (i.e., ['VP8', 'VP9']) or as objects with the following signature:\n * const codecsToBeRemoved = [{\n *   name: 'codecname',\n *   fmtpParams: 'specific ftmp parameter target'\n * }]\n * const codecRemover = createCodecRemover(codecsToBeRemoved)\n * @return {Function} returns an SDP handler function\n */\nexport function createCodecRemover(codecs = []) {\n  // We allow the user to pass in a codecs of objects or strings, so here we format the strings into objects for uniformity.\n  codecs = codecs.map(item => (typeof item === 'string' ? { name: item } : item))\n\n  return function (newSdp, info, originalSdp) {\n    // This is an array of strings representing codec names we want to remove.\n    const codecStringsToRemove = codecs.map(codec => codec.name)\n\n    newSdp.media.forEach(media => {\n      // This is an array of just the codes (codec payloads) that we FOR SURE want to remove.\n      const finalRemoveList = []\n      // This is an array of RTP objects who have codecs that are the same as strings passed in via codecs.\n      let filteredRtp = []\n\n      // If the current rtp.codec is in the codecStringsToRemove list, add the rtp to filteredRtp\n      filteredRtp = media.rtp.filter(rtp => codecStringsToRemove.includes(rtp.codec))\n\n      filteredRtp.forEach(rtp => {\n        // We grab the relevantCodec codecs object from the passed in codecs, based on the name string.\n        const relevantCodecs = codecs.filter(codec => codec.name === rtp.codec)\n\n        // We check the relevantCodec. If it is not present, then we have no codecs info for this specific rtp.\n        relevantCodecs.forEach(relevantCodec => {\n          // If fmtpParams doesnt exist or is of length 0 then we assume we can remove all instances of this codec\n          if (!relevantCodec.fmtpParams || (relevantCodec.fmtpParams && relevantCodec.fmtpParams.length === 0)) {\n            // We want to delete this codec no matter what, since no fmtp params were included.\n            finalRemoveList.push(rtp.payload)\n          } else {\n            // There are fmtp values for this codec. Therefore we have to check each media.fmtp object to see if it is the right one.\n            // Then when we find the right fmtp object, we check its config to see if it has the parameters specified in the input.\n            media.fmtp.forEach(fmtp => {\n              // We check each iteration to see if we found the right fmtp object.\n              if (fmtp.payload === rtp.payload) {\n                // If we found the right fmtp object, we have to make sure each config param is in the fmtp.config.\n                if (relevantCodec.fmtpParams.every(c => fmtp.config.includes(c))) {\n                  finalRemoveList.push(rtp.payload)\n                }\n              }\n            })\n          }\n        })\n      })\n\n      // At this point we should have an array (finalRemoveList) that contains all ORIGINAL codec payloads that we need to remove.\n      // We now need to check fmtp for all rtx payloads ASSOCIATED with the original codec payload.\n      media.fmtp.forEach(fmtp => {\n        // Check if the config contains apt=, which indicates this fmtp is associated with another.\n        if (fmtp.config.includes('apt=')) {\n          // If so, lets grab the whole string WITHOUT the apt= part, and convet it into an integer. This should be a payload number.\n          var payload = parseInt(fmtp.config.replace('apt=', ''))\n\n          // Check if the finalRemoveList contains the payload that this fmtp is associated with.\n          if (finalRemoveList.includes(payload)) {\n            // If so, then we need to add this fmtp.payload to the finalRemoveList\n            finalRemoveList.push(fmtp.payload)\n          }\n        }\n      })\n\n      // We assume past this point that the finalRemoveList is all powerful.\n      // For each codec in the media.payloads string, if it is in our finalRemoveList list, we remove it.\n      let isNumber = false\n      if (typeof media.payloads === 'number') {\n        media.payloads = media.payloads.toString()\n        isNumber = true\n      }\n      if (media.payloads) {\n        // If our final list of codecs to remove is greater than or equal to\n        // the actual number of codecs in the SDP, remove codecs from the final list\n        // such that it is exactly one fewer codecs than in the SDP. This way we\n        // will never remove all codecs and always leave at least one.\n        const payloadCount = media.payloads.split(' ').length\n        if (finalRemoveList.length >= payloadCount) {\n          finalRemoveList.splice(payloadCount - 1, finalRemoveList.length - payloadCount + 1)\n        }\n\n        media.payloads = media.payloads\n          .split(' ')\n          .filter(payload => !finalRemoveList.includes(parseInt(payload)))\n          .join(' ')\n      }\n      if (media.payloads && isNumber) {\n        media.payloads = parseInt(media.payloads)\n      }\n\n      // For each codec object, if the payload is in our filteredCodes list, we remove the object.\n      media.rtp = media.rtp.filter(rtp => !finalRemoveList.includes(rtp.payload))\n      media.fmtp = media.fmtp.filter(fmtp => !finalRemoveList.includes(fmtp.payload))\n\n      if (media.rtcpFb) {\n        media.rtcpFb = media.rtcpFb.filter(rtcpFb => !finalRemoveList.includes(rtcpFb.payload))\n      }\n    })\n\n    return newSdp\n  }\n}\n","import { ICE_COLLECTION_RESULT_TYPES } from '../constants'\nimport sdpTransform from 'sdp-transform'\n\n/**\n * Default function used for the SDK's ICE collection process. Will determine when enough\n *     candidates have been collected, or enough time has passed, until negotiation can\n *     continue or if the call should be considered failed.\n *\n * If ICE collection completes normally (at any point),\n *   - start the call if we have some ICE candidates.\n *   - error the call if there are no ICE candidates.\n *\n * If a candidate is collected, follow logic based on below timings.\n *\n * If before the ideal timeout,\n *   - start the call if every media section has a relay candidate for every TURN server.\n *   - otherwise wait until max timeout.\n *\n * If before the max timeout (but after ideal),\n *   - start the call if every media section has at least one relay candidate.\n *   - otherwise wait until max timeout.\n *\n * If we reach max timeout,\n *   - start the call if we have some ICE candidates.\n *   - error the call if there are no ICE candidates.\n * @param {Object} iceCollectionInfo\n * @param {string} iceCollectionInfo.callId The ID of the call.\n * @param {string} iceCollectionInfo.callOperation The current operation of the call.\n * @param {string} iceCollectionInfo.reason The reason the check function was called.\n * @param {Array<Object>} iceCollectionInfo.iceCandidates The array of ICE candidates collected so far.\n * @param {number} iceCollectionInfo.iceCollectionDuration The time elapsed since the start of the ICE collection process.\n * @param {string} iceCollectionInfo.iceGatheringState The current ICE gathering state.\n * @param {Object} iceCollectionInfo.rtcPeerConnectionConfig The config of the RTC peer connection.\n * @param {string} iceCollectionInfo.rtcLocalSessionDescription The local description set on the peer.\n * @param {Object} timeoutConfigs Timeout configuration values provided by the application.\n * @param {number} timeoutConfigs.iceCollectionIdealTimeout The desired ideal ice collection check timeout.\n * @param {number} timeoutConfigs.iceCollectionMaxTimeout The desired max ice collection check timeout.\n * @return {call.iceCollectionCheckResult} Information on how to proceed with the ice collection check.\n */\nexport function iceCollectionCheckFunction(iceCollectionInfo = {}, timeoutConfigs) {\n  const {\n    iceCollectionDuration,\n    iceCandidates,\n    iceGatheringState,\n    rtcPeerConnectionConfig,\n    rtcLocalSessionDescription\n  } = iceCollectionInfo\n\n  const { iceCollectionIdealTimeout, iceCollectionMaxTimeout } = timeoutConfigs\n\n  if (iceGatheringState === 'complete') {\n    // If the ice gathering state is 'complete', but no candidates are available, end the call\n    if (iceCandidates.length === 0) {\n      return { type: ICE_COLLECTION_RESULT_TYPES.ERROR, error: 'No ICE candidates available for call to proceed.' }\n    }\n    return { type: ICE_COLLECTION_RESULT_TYPES.START_CALL }\n  }\n\n  // If we are under the ideal timeout time and iceGathering state is not complete, we will check that the amount\n  //  relay candidates for each transport is equal to the number of configured TURN servers.\n  if (iceCollectionDuration < iceCollectionIdealTimeout) {\n    // Number of TURN servers\n    let totalTurnServers = 0\n    const configuredIceServers = rtcPeerConnectionConfig.rtcConfig.iceServers || []\n    configuredIceServers.forEach(iceServer => {\n      if (Array.isArray(iceServer.urls)) {\n        totalTurnServers += iceServer.urls.filter(url => url.startsWith('turn')).length\n      } else if (typeof iceServer.urls === 'string' && iceServer.urls.startsWith('turn')) {\n        totalTurnServers += 1\n      }\n    })\n\n    // RTP Relay candidates collected so far\n    const relayCandidates = iceCandidates.filter(\n      candidate => candidate.component === 'rtp' && candidate.type === 'relay'\n    )\n\n    // Check whether there is atleast candidates for each media transport equal to the number of configured\n    //  turn servers before starting the call.\n    const parsedSdp = sdpTransform.parse(rtcLocalSessionDescription.sdp)\n    const readyToStart = parsedSdp.media.every(media => {\n      const sectionRelays = relayCandidates.filter(\n        candidate => parseInt(candidate.sdpMid) === media.mid || candidate.sdpMid === media.mid\n      )\n      return sectionRelays.length >= totalTurnServers\n    })\n\n    // If no TURN servers we're provided we will wait till the ideal collection timeout.\n    if (!readyToStart || !totalTurnServers) {\n      return { type: ICE_COLLECTION_RESULT_TYPES.WAIT, wait: iceCollectionIdealTimeout - iceCollectionDuration }\n    } else {\n      return { type: ICE_COLLECTION_RESULT_TYPES.START_CALL }\n    }\n  } else if (iceCollectionDuration < iceCollectionMaxTimeout) {\n    // If we are passed the ideal timeout time, we will check that the amount relay candidates for each transport is\n    //  1 or more.\n\n    // RTP Relay candidates collected so far\n    const relayCandidates = iceCandidates.filter(\n      candidate => candidate.component === 'rtp' && candidate.type === 'relay'\n    )\n\n    // Check whether there is atleast 1 candidate for each media transport before starting the call.\n    const parsedSdp = sdpTransform.parse(rtcLocalSessionDescription.sdp)\n    const readyToStart = parsedSdp.media.every(media => {\n      const sectionRelays = relayCandidates.filter(\n        candidate => parseInt(candidate.sdpMid) === media.mid || candidate.sdpMid === media.mid\n      )\n      return sectionRelays.length >= 1\n    })\n\n    if (readyToStart) {\n      return { type: ICE_COLLECTION_RESULT_TYPES.START_CALL }\n    } else {\n      return { type: ICE_COLLECTION_RESULT_TYPES.WAIT, wait: iceCollectionMaxTimeout - iceCollectionDuration }\n    }\n  } else {\n    // If we are passed the max timeout and no candidates are available, end the call\n    if (iceCandidates.length === 0) {\n      return { type: ICE_COLLECTION_RESULT_TYPES.ERROR, error: 'No ICE candidates available for call to proceed.' }\n    }\n    // Otherwise, if there are some candidates, we can attempt to start the call.\n    return { type: ICE_COLLECTION_RESULT_TYPES.START_CALL }\n  }\n}\n","/**\n * Extracts the domain from an address if an @ symbol exists and isn't at the start or end of the address.\n * @param {string} addressString The address string to extract the domain from (if it exists).\n * @returns {string} The extracted domain. Empty string of none found.\n */\nfunction extractDomainFromAddress(addressString) {\n  const indexOfAtSymbol = addressString.lastIndexOf('@')\n  if (indexOfAtSymbol !== 0 && indexOfAtSymbol !== addressString.length - 1) {\n    // If '@' symbol found in middle of addressString, split it.\n    if (indexOfAtSymbol !== -1) {\n      return addressString.substr(indexOfAtSymbol + 1)\n    }\n  }\n  return ''\n}\n\n/**\n * Determines which address and domain to use depending on whether the address string contains a domain or not.\n * @param {string} addressString The address string to examine and extract a domain from (if any).\n * @param {string} defaultDomainString The domain to use if the address string does not contain a domain in it.\n * @returns {Object} An object containing the correct address and domain to use.\n */\nfunction separateAddressAndDomain(addressString, defaultDomainString) {\n  const extractedDomain = extractDomainFromAddress(addressString)\n  // If a domain was extracted from the address, use that as the domain and strip it from the address.\n  if (extractedDomain) {\n    return {\n      address: addressString.substr(0, addressString.length - extractedDomain.length - 1),\n      domain: extractedDomain\n    }\n  } else {\n    return {\n      address: addressString,\n      domain: defaultDomainString\n    }\n  }\n}\n\n/**\n * Extracts any pre-pended data before a \":\" (if it exists) from the beginning of a string.\n * @param {string} inputString The string to remove pre-pended data from.\n * @returns {string} The pre-pended data string.\n */\nfunction extractPrependedData(inputString) {\n  const prependedDataMatches = inputString.match(/^.*:/g)\n  if (prependedDataMatches && prependedDataMatches[0]) {\n    return prependedDataMatches[0]\n  } else {\n    return ''\n  }\n}\n\n/**\n * Finds the leading special characters (\"#\", \"+\", \"*\") of an address if it is a phone number.\n * If the address contains letters or any non-visual-separator characters,\n *  it is not a phone number and no leading special characters will be found.\n * @param {string} addressString The address string to find the leading characters of (if any).\n *  The addressString must not contain any pre-pended data such as \"sip:\".\n *  The addressString must not contain a domain.\n * @returns {string} The leading special characters as one string. Empty string if none found.\n */\nfunction extractLeadingSpecialCharacters(addressString) {\n  // A single or group of contiguous characters are considered leading character/s if it is  the following:\n  // - starts at the beginning of the string - ^\n  // - is any of the following characters - [#+*]+\n  // - is followed by a digit or \"(\" - [\\d|(]\n  // - is followed by any number of only digits and visual separators - [\\d \\-.()+]*$\n  const potentialLeadingChars = addressString.match(/^[#+*]+[\\d|(][\\d \\-.()+]*$/g)\n  if (potentialLeadingChars && potentialLeadingChars[0]) {\n    // Guaranteed to have a match for regex [#+*]+ since we have potentialLeadingChars\n    // which was a match for a similar regex and we are simply extracting the leading characters part.\n    const actualLeadingChars = potentialLeadingChars[0].match(/[#+*]+/g)\n    return actualLeadingChars[0]\n  }\n  return ''\n}\n\n/**\n * Outputs a new string without its phone number visual separators (\"-\", \".\", \"(\", \")\", \"+\").\n * @param {string} inputString The string to remove visual separators from.\n * @returns {string} A new string without visual separators.\n */\nfunction withoutVisualSeparators(inputString) {\n  return inputString.replace(/[ \\-.()+]/g, '')\n}\n\n/**\n * Determines whether a string should be considered a phone number or not.\n * @param {string} addressString The address string to check.\n *  The addressString must not contain any pre-pended data such as \"sip:\"\n *  The addressString must not contain any leading special characters.\n *  The addressString must not contain a domain.\n * @returns {boolean} True if the input string is a phone number. False if it is not.\n */\nfunction isPhoneNumber(addressString) {\n  const cleanNumber = withoutVisualSeparators(addressString)\n  const phoneNumberMatch = cleanNumber.match(/^\\d+$/g)\n  return phoneNumberMatch && phoneNumberMatch.length === 1\n}\n\n/**\n * Processes the address string and returns the correct output.\n * If the address is a phone number, visual separators are removed.\n * Otherwise, it will just return the address as-is.\n * @param {string} addressString The address string to process.\n *  The addressString must not contain any pre-pended data such as \"sip:\".\n *  The addressString must not contain any leading special characters (if it is a phone number).\n *  The addressString must not contain a domain.\n * @returns {string} A phone number without visual-separators or the addressString as-is.\n */\nfunction processAddress(addressString) {\n  return isPhoneNumber(addressString) ? withoutVisualSeparators(addressString) : addressString\n}\n\n/**\n * Processes the domain string and returns the correct output.\n * Adds an \"@\" symbol if it isn't present at the beginning of the domain.\n * @param {string} domainString The domain string to process.\n * @returns {string} The domain with \"@\" symbol at the beginning if it doesn't exist.\n */\nfunction processDomain(domainString) {\n  if (domainString === '' || domainString === undefined) {\n    return ''\n  } else if (domainString.indexOf('@') === 0) {\n    return domainString\n  } else {\n    return '@' + domainString\n  }\n}\n\n/**\n *The function takes in the input dial string and domain address of the user, performs a normalization process based on the phone number handling normalization rules\n * @function normalizeSipUri\n * @param {string} address   It contains the input dial string the user dials in or the callee address\n * @param {string} domain    It contains the user's domain address\n * @returns {string} output  The output which is the normalized callee address/phone number\n */\nexport function normalizeSipUri(address, domain) {\n  // Remove leading and trailing white spaces.\n  address = address.trim()\n\n  // Extract domain.\n  const resultingAddressAndDomain = separateAddressAndDomain(address, domain)\n  domain = resultingAddressAndDomain.domain\n  address = resultingAddressAndDomain.address\n\n  // Extract pre-pended \"sip:\".\n  const prepend = extractPrependedData(address)\n  address = address.substr(prepend.length)\n\n  // Extract leading characters.\n  const leadingChars = extractLeadingSpecialCharacters(address)\n  address = address.substr(leadingChars.length)\n\n  // Process and build parts into final output in the form of `<prepend>:<leadingChars><address>@<domain>`.\n  return 'sip:' + leadingChars + processAddress(address) + processDomain(domain)\n}\n","// Helpers.\nimport { CALL_STATES, CALL_MEDIA_STATES } from '../constants'\n\n/**\n * Retrieves the current state of media flow based on a call's state.\n * @method getMediaState\n * @param  {Object} callState A call's state.\n * @return {string} A CALL_MEDIA_STATES enum value.\n */\nexport function getMediaState(callState) {\n  if (hasMedia(callState)) {\n    return CALL_MEDIA_STATES.CONNECTED\n  } else if (isLocalHold(callState)) {\n    return CALL_MEDIA_STATES.LOCAL_HOLD\n  } else if (isRemoteHold(callState)) {\n    return CALL_MEDIA_STATES.REMOTE_HOLD\n  } else if (isDualHold(callState)) {\n    return CALL_MEDIA_STATES.DUAL_HOLD\n  }\n}\n\n/**\n * Checks whether the call state indicates that the call has media.\n * @method hasMedia\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function hasMedia(callState) {\n  return callState.state === CALL_STATES.CONNECTED && !callState.localHold && !callState.remoteHold\n}\n\n/**\n * Checks whether the call state indicates that the call is locally held (only).\n * @method isLocalHold\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function isLocalHold(callState) {\n  return callState.state === CALL_STATES.ON_HOLD && callState.localHold && !callState.remoteHold\n}\n\n/**\n * Checks whether the call state indicates that the call is remotely held (only).\n * @method isRemoteHold\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function isRemoteHold(callState) {\n  return callState.state === CALL_STATES.ON_HOLD && !callState.localHold && callState.remoteHold\n}\n\n/**\n * Checks whether the call state indicates that the call is both locally and\n *    remote held.\n * @method isDualHold\n * @param  {Object}  callState Redux call state.\n * @return {boolean}\n */\nexport function isDualHold(callState) {\n  return callState.state === CALL_STATES.ON_HOLD && callState.localHold && callState.remoteHold\n}\n","const prefix = '@@KANDY/'\n\nexport const FETCH_CALL_HISTORY = prefix + 'FETCH_CALL_HISTORY'\nexport const FETCH_CALL_HISTORY_FINISH = prefix + 'FETCH_CALL_HISTORY_FINISH'\n\nexport const DELETE_CALL_HISTORY = prefix + 'DELETE_CALL_HISTORY'\nexport const DELETE_CALL_HISTORY_FINISH = prefix + 'DELETE_CALL_HISTORY_FINISH'\n\nexport const ADD_CALL_HISTORY_ENTRY = prefix + 'ADD_CALL_HISTORY_ENTRY'\n\nexport const SET_CACHE = prefix + 'SET_CACHE'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Represents a request to fetch call logs.\n * @method retrieveCallLogs\n * @param  {number} amount The number of records to retrieve.\n * @param  {number} offset Starting offset for records to retrieve.\n * @return {Object} A flux standard action.\n */\nexport function retrieveCallLogs(amount, offset) {\n  return {\n    type: actionTypes.FETCH_CALL_HISTORY,\n    payload: {\n      amount,\n      offset\n    }\n  }\n}\n\n/**\n * Represents a received response from fetching call logs.\n * @method retrieveCallLogsFinish\n * @param  {Object} $0\n * @param  {Object} $0.logs Retrieved call logs.\n * @param  {BasicError} $0.error  Error object, in the case of an error.\n * @return {Object} A flux standard action.\n */\nexport function retrieveCallLogsFinish({ logs, error }) {\n  return {\n    type: actionTypes.FETCH_CALL_HISTORY_FINISH,\n    error: !!error,\n    payload: error || logs\n  }\n}\n\n/**\n * Represents a request to delete call logs.\n * @method removeCallLogs\n * @param  {number} recordId Which logs to delete.\n * @return {Object} A flux standard action.\n */\nexport function removeCallLogs(recordId) {\n  return {\n    type: actionTypes.DELETE_CALL_HISTORY,\n    payload: recordId\n  }\n}\n\n/**\n * Represents a received response from deleting call logs.\n * @method removeCallLogsFinish\n * @param  {Object} $0\n * @param  {number|string} $0.recordId The ID of the removed record. Can also be 'all'.\n * @param  {BasicError} $0.error  Error object, in the case of an error.\n * @return {Object} A flux standard action.\n */\nexport function removeCallLogsFinish({ recordId, error }) {\n  return {\n    type: actionTypes.DELETE_CALL_HISTORY_FINISH,\n    error: !!error,\n    payload: error || recordId\n  }\n}\n\n/**\n * Represents a request to add a new entry to the call logs.\n * @method addCallLogEntry\n * @param  {Object} $0 The call log entry to add\n * @return {Object} A flux standard action.\n */\nexport function addCallLogEntry(logEntry) {\n  return {\n    type: actionTypes.ADD_CALL_HISTORY_ENTRY,\n    payload: logEntry\n  }\n}\n\n/**\n * Represents a call to set the cache in the call history\n * @method setCache\n * @param  {Object} $0 call log state to hydrate into app state\n * @return {Object} A flux standard action.\n */\nexport function setCache(data) {\n  return {\n    type: actionTypes.SET_CACHE,\n    payload: data\n  }\n}\n","// Call History plugin.\nimport * as actions from './actions'\nimport { getCallHistory, getCachedHistory } from './selectors'\nimport * as eventTypes from './eventTypes'\n\n// Other plugins\nimport BasicError, { callHistoryCodes } from '../../errors'\n\n// Libraries\nimport { isNumber } from 'lodash/fp'\n\n/**\n * The 'call.history' namespace is used to retrieve and inspect the authenticated\n * users call logs.\n *\n * Functions below are all part of this namespace.\n *\n * @public\n * @namespace callHistory\n */\n\n/**\n * Call History API factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} API.\n */\nexport default function createAPI(container) {\n  const { context, CallHistoryOperations: operations, logManager, API_LOG_TAG, emitEvent } = container\n  const log = logManager.getLogger('CALLHISTORY')\n\n  const callHistoryApi = {\n    /**\n     * Gets the list of call logs cached locally. The event\n     * `callHistory:changed` is used to indicate the local state of logs\n     * has been updated.\n     * @public\n     * @memberof callHistory\n     * @requires callHistory\n     * @method get\n     * @example\n     * client.on('callHistory:change', function() {\n     *     // Get all call logs when they've been updated.\n     *     let callLogs = client.call.history.get();\n     * });\n     * @returns {Array} A list of call log records, ordered by latest first.\n     */\n    get() {\n      log.debug(`${API_LOG_TAG}call.history.get`)\n      return getCallHistory(context.getState())\n    },\n\n    /**\n     * Fetches the list of call logs and stores them locally. The API\n     * {@link #callhistoryget CallHistory.get} can then be used to get\n     * the logs from local state after it has been updated.\n     * @public\n     * @memberof callHistory\n     * @requires callHistory\n     * @method fetch\n     * @param  {number} [amount=50] The number of records to retrieve.\n     * @param  {number} [offset=0] Starting offset for records to retrieve.\n     */\n    async fetch(amount = 50, offset = 0) {\n      log.debug(`${API_LOG_TAG}call.history.fetch, amount: ${amount}, offset: ${offset}`)\n\n      // Backwards compatibility: Dispatch this action at the start of the operation\n      //    because that's what the old API does. But because we're not using actions\n      //    to trigger sagas here, this doesn't actually do anything. Literally nothing.\n      context.dispatch(actions.retrieveCallLogs(amount, offset))\n\n      // Catch invalid input (which breaks SPiDR) before making the request.\n      if (!isNumber(amount) || amount < 0 || !isNumber(offset)) {\n        log.info('Unable to retrieve log(s); invalid input.')\n        const validationError = new BasicError({\n          code: callHistoryCodes.BAD_REQUEST,\n          message: 'Unable to retrieve log(s); invalid input.'\n        })\n\n        // Dispatch the failure action. This is for action logs backwards compatibility.\n        context.dispatch(actions.retrieveCallLogsFinish({ error: validationError }))\n\n        // Emit the event for operation failure.\n        emitEvent(eventTypes.CALL_HISTORY_ERROR, { validationError })\n\n        return\n      }\n\n      try {\n        await operations.fetch(amount, offset)\n      } catch (error) {\n        log.info(`call.history.fetch error: ${error.message}`)\n\n        // Emit the event for operation failure.\n        emitEvent(eventTypes.CALL_HISTORY_ERROR, { error })\n        return\n      }\n\n      // Emit the events for \"logs changed\".\n      emitEvent(eventTypes.CALL_HISTORY_CHANGE, {})\n      emitEvent(eventTypes.CALL_HISTORY_CACHE_CHANGE, {})\n    },\n\n    /**\n     * Deletes the specified call log.\n     * @public\n     * @memberof callHistory\n     * @requires callHistory\n     * @method remove\n     * @param  {number} recordId The ID of the call log to be removed.\n     */\n    async remove(recordId) {\n      log.debug(`${API_LOG_TAG}call.history.remove, recordId: ${recordId}`)\n\n      // Backwards compatibility: Dispatch this action at the start of the operation\n      //    because that's what the old API does. But because we're not using actions\n      //    to trigger sagas, this doesn't actually do anything. Literally nothing.\n      context.dispatch(actions.removeCallLogs(recordId))\n\n      if (!recordId) {\n        log.info('Could not remove call logs from history; invalid input.')\n        const error = new BasicError({\n          code: callHistoryCodes.BAD_REQUEST,\n          message: 'Could not remove call logs; invalid input.'\n        })\n\n        // Dispatch the failure action. This is for logging backwards compatibility.\n        context.dispatch(actions.removeCallLogsFinish({ error }))\n\n        return\n      }\n\n      try {\n        await operations.removeCallLogs(recordId)\n      } catch (error) {\n        log.info(`call.history.remove error: ${error.message}`)\n\n        // Emit the event for operation failure.\n        emitEvent(eventTypes.CALL_HISTORY_ERROR, { error })\n        return\n      }\n\n      // Emit the events for \"logs changed\".\n      emitEvent(eventTypes.CALL_HISTORY_CHANGE, {})\n      emitEvent(eventTypes.CALL_HISTORY_CACHE_CHANGE, {})\n    },\n\n    /**\n     * Deletes all call logs.\n     * @public\n     * @memberof callHistory\n     * @requires callHistory\n     * @method clear\n     */\n    async clear() {\n      log.debug(`${API_LOG_TAG}call.history.clear`)\n\n      // Backwards compatibility: Dispatch this action at the start of the operation\n      //    because that's what the old API does. But because we're not using actions\n      //    to trigger sagas, this doesn't actually do anything. Literally nothing.\n      context.dispatch(actions.removeCallLogs('all'))\n\n      try {\n        await operations.removeCallLogs('all')\n      } catch (error) {\n        log.info(`call.history.clear error: ${error.message}`)\n\n        // Emit the event for operation failure.\n        emitEvent(eventTypes.CALL_HISTORY_ERROR, { error })\n        return\n      }\n\n      // Emit the events for \"logs changed\".\n      emitEvent(eventTypes.CALL_HISTORY_CHANGE, {})\n      emitEvent(eventTypes.CALL_HISTORY_CACHE_CHANGE, {})\n    },\n\n    /**\n     * Gets the cached call history data and returns stringified data.\n     *\n     * The data is provided in a format that can be used directly with the\n     *    {@link callHistory.setCache call.history.setCache} API. This allows an\n     *    application to persist the information across SDK instances when the\n     *    backend environment does not support the CallHistory feature.\n     * @public\n     * @memberof callHistory\n     * @requires callHistory\n     * @method getCache\n     * @returns {string} A stringified list of call log records from the cache, ordered by latest first.\n     */\n    getCache() {\n      log.debug(`${API_LOG_TAG}call.history.getCache`)\n      return JSON.stringify(getCachedHistory(context.getState()))\n    },\n\n    /**\n     * Sets the cached call history data, expects stringified data as it will be parsed.\n     *\n     * The data can be retrieved from the {@link callHistory.getCache\n     *    call.history.getCache} API. This allows an\n     *    application to persist the information across SDK instances when the\n     *    backend environment does not support the CallHistory feature.\n     * @public\n     * @memberof callHistory\n     * @requires callHistory\n     * @method setCache\n     * @param {string} data The stringified call history data to store in the cache.\n     */\n    setCache(data) {\n      log.debug(`${API_LOG_TAG}call.history.setCache, data: ${data}`)\n\n      let dataObj\n      // Verify that data is a JSON parsable string\n      try {\n        if (typeof data !== 'string') {\n          throw new Error('data is not a valid string')\n        }\n        dataObj = JSON.parse(data)\n      } catch (error) {\n        log.info(`Invalid data provided: ${error}`)\n        throw error\n      }\n\n      operations.setCache(dataObj)\n\n      // Emit the events for \"logs changed\".\n      emitEvent(eventTypes.CALL_HISTORY_CHANGE, {})\n      emitEvent(eventTypes.CALL_HISTORY_CACHE_CHANGE, {})\n    }\n  }\n\n  return {\n    call: { history: callHistoryApi }\n  }\n}\n","/**\n * Call history state has been updated. See {@link #callhistoryget CallHistory.get} to retrieve new state.\n * @public\n * @memberof callHistory\n * @event callHistory:change\n */\nexport const CALL_HISTORY_CHANGE = 'callHistory:change'\n\n/**\n * An error occurred while performing a call history operation.\n * @public\n * @memberof callHistory\n * @event callHistory:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n */\nexport const CALL_HISTORY_ERROR = 'callHistory:error'\n\n/**\n * Call history cached state has been updated\n * @public\n * @memberof callHistory\n * @event callHistoryCache:change\n */\nexport const CALL_HISTORY_CACHE_CHANGE = 'callHistoryCache:change'\n","import createAPI from './api'\nimport reducer from './reducers'\n\nconst name = 'callHistory'\n\nexport { name, createAPI, reducer }\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport { reverse, sortBy, unionBy, concat } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.FETCH_CALL_HISTORY_FINISH] = {\n  next(state, action) {\n    // Note: If a conflict occurs in the below unionBy, the newer log is\n    //      preferred over the older log. This is because SPiDR only keeps\n    //      50 records at a time, and it re-uses old recordIds when it\n    //      creates new record logs. It's stupid.\n\n    // Get local Logs. Local logs are identified by having a recordID of 16 characters\n    const localLogs = state.filter(function (log) {\n      return log.recordId.length === 36 && log.duration !== '0'\n    })\n\n    // Remove the local logs\n    const localLogsRemoved = state.filter(function (log) {\n      return log.resourceLocation !== ''\n    })\n\n    // Generate a list of unique logs (ie; not found in server logs)\n    const uniqueLogs = localLogs.filter(function (log) {\n      var result = action.payload.some(isSimilar, log)\n      return !result\n    })\n\n    // Combine server logs and new logs.\n    const newLogs = concat(unionBy('recordId', action.payload, localLogsRemoved), uniqueLogs)\n\n    // Sort start time, in descending order.\n    return reverse(sortBy('startTime', newLogs))\n  }\n}\n\nreducers[actionTypes.DELETE_CALL_HISTORY_FINISH] = {\n  next(state, action) {\n    if (action.payload === 'all') {\n      return []\n    } else {\n      return state.filter(function (log) {\n        return log.recordId !== action.payload\n      })\n    }\n  }\n}\n\nreducers[actionTypes.ADD_CALL_HISTORY_ENTRY] = {\n  next(state, action) {\n    return concat(action.payload, state)\n  }\n}\n\n// rehydrate cache with previously stored data\nreducers[actionTypes.SET_CACHE] = {\n  next(state, action) {\n    return action.payload\n  }\n}\n\n// Call History default state is an empty array.\nconst reducer = handleActions(reducers, [])\nexport default reducer\n\n/*\n * A helper function to determine if 2 log entries are similar.\n * A log is considered similar under the following conditions:\n *   - the startTime is within 10 seconds\n *   - the duration is within 5 seconds\n *   - the direction is the same\n */\nconst isSimilar = function (serverLogEntry) {\n  const startTimePadding = 10000\n  const durationPadding = 5000\n\n  if (Math.abs(serverLogEntry.startTime - this.startTime) > startTimePadding) {\n    return false\n  }\n  if (Math.abs(serverLogEntry.duration - this.duration) > durationPadding) {\n    return false\n  }\n  if (serverLogEntry.direction !== this.direction) {\n    return false\n  }\n  return true\n}\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves call history stored in state.\n * Call History is a collection of data records detalining past calls that were made or received.\n * @method getCallHistory\n * @param  {Object} state Redux state.\n * @param  {Object} [options] Options that can be used to apply extra filtering.\n * @param  {number} [options.amout] The number of records to retrieve.\n * @param  {number} [options.offset] Starting offset for records to retrieve.\n * @return {Array} The records, as an array of objects.\n */\nexport function getCallHistory(state, options) {\n  if (!options) {\n    return cloneDeep(state.callHistory)\n  }\n\n  // Othewise the amount & offset are guaranteed to be provided,\n  // as enforced at the `callhistory.fetch` API level\n  const amount = options.amount\n  const offset = options.offset\n\n  if (offset + amount >= state.callHistory.length) {\n    return cloneDeep(state.callHistory.slice(offset))\n  }\n\n  return cloneDeep(state.callHistory.slice(offset, offset + amount))\n}\n\n/**\n * Retrieves call history stored in state\n * @method getCachedHistory\n * @param  {Object} state Redux state.\n * @return {Array}\n */\nexport function getCachedHistory(state) {\n  return cloneDeep(state.callHistory)\n}\n","import fetchRequest from './request'\nimport fetchOperation from './operation'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('CallHistoryRequests.fetchCallLogs', container => {\n    return fetchRequest(bottle.container)\n  })\n\n  bottle.factory('CallHistoryOperations.fetch', container => {\n    return fetchOperation(bottle.container)\n  })\n}\n","// Call History plugin.\nimport * as actions from '../../../interface/actions'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `fetch` operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, CallHistoryRequests: requests } = container\n  const log = logManager.getLogger('CALLHISTORY')\n\n  /**\n   * Operation for fetching call logs from the backend.\n   * @method fetch\n   * @param {number} amount\n   * @param {number} offset\n   * @returns {Array<Object>} List of retrieved call logs.\n   * @throws {BasicError} Throws an error if parameters are invalid.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function fetch(amount, offset) {\n    const { dispatch } = context\n\n    log.info(`Attempting to retrieve ${amount} call history log(s), with an offset of ${offset}.`)\n\n    try {\n      const logs = await requests.fetchCallLogs({ amount, offset })\n\n      log.info(`Successfully retrieved ${logs.length} call history log(s).`)\n\n      // Dispatch the finish action to update redux state.\n      dispatch(actions.retrieveCallLogsFinish({ logs }))\n\n      return logs\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(actions.retrieveCallLogsFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  return fetch\n}\n","// Other plugins.\nimport { getRequestInfo } from '../../../../auth/interface/selectors'\nimport { isEmpty } from 'lodash/fp'\nimport BasicError, { callHistoryCodes } from '../../../../errors'\n\n/**\n * Request factory function.\n * @method createRequest\n * @param  {Object} container The bottle container.\n * @return {Function} The `fetchCallLogs` REST operation.\n */\nexport default function createRequest(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('CALLHISTORY')\n\n  /**\n   * KL REST Request to retrieve call history logs.\n   * @method fetchCallLogs\n   * @param {number} amount The number of logs to retrieve.\n   * @param {number} offset\n   * @returns {Array<Object>} List of retrieved call logs.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   * @throws {BasicError} Throws an error if the server responds with auth issue.\n   * @throws {BasicError} Throws an error if the server responds with bad request.\n   * @throws {BasicError} Throws an error if the server responds with forbidden service.\n   */\n  async function fetchCallLogs(params) {\n    const requestInfo = getRequestInfo(context.getState())\n    const version = requestInfo.version\n\n    const url = `${requestInfo.baseURL}/rest/version/${version}/user/${requestInfo.username}/logHistory`\n\n    const queryParams = {\n      startIndex: params.offset,\n      count: params.amount\n    }\n\n    const options = {\n      method: 'GET',\n      url,\n      queryParams,\n      responseType: 'json',\n      body: undefined\n    }\n\n    const bodyStatusCodeMap = {\n      4: callHistoryCodes.NOT_AUTHENTICATED,\n      27: callHistoryCodes.FORBIDDEN,\n      35: callHistoryCodes.FORBIDDEN\n    }\n\n    const HTTPStatusCodes = {\n      FORBIDDEN: 403\n    }\n\n    // Credentials not set. Therefore, request is not sent (unauthorized issue).\n    if (!requestInfo.username) {\n      const message = 'Failed to retrieve call logs; user not authenticated (credentials not set).'\n      log.info(message)\n      throw new BasicError({\n        code: callHistoryCodes.NOT_AUTHENTICATED,\n        message\n      })\n    }\n\n    // username is defined, proceed with the request.\n    const response = await sendRequest(options)\n    const { body, error, result } = response\n\n    // no errors, request is successful.\n    if (!error) {\n      log.info(`Call log(s) fetched; Status code: ${body.logHistory.statusCode}`)\n\n      let logs = body.logHistory.logItems\n\n      // Massage the call logs into a more concise format.\n      logs = logs.map(function (log) {\n        if (log.type === 'CallLog') {\n          return log.params\n        }\n      })\n\n      // Massage the call logs to include the remoteParticipant property.\n      logs = logs.map(function (log) {\n        /**\n         * There is a bug in SPiDR where it always uses the keys `callerName` and\n         * `callerDisplayNumber` for ALL logs, instead of only incoming logs.\n         * Because of this, callerDisplayNumber is always the remote participant,\n         * even when the local user is the caller.\n         * This if statement is a workaround for this problem.\n         * // TODO: Remove this if when the SPiDR issue is resolved.\n         */\n        if (log.direction === 'outgoing' && !log.calleeDisplayNumber && !log.calleeName) {\n          log.calleeDisplayNumber = log.callerDisplayNumber\n          log.calleeName = log.callerName\n          // Keep callerDisplayNumber and callerName properties unchanged for\n          //    backwards compatibility.\n        }\n\n        if (log.direction === 'outgoing') {\n          log.remoteParticipant = {\n            displayName: log.calleeName,\n            displayNumber: log.calleeDisplayNumber\n          }\n        } else {\n          log.remoteParticipant = {\n            displayName: log.callerName,\n            displayNumber: log.callerDisplayNumber\n          }\n        }\n        return log\n      })\n\n      return logs\n    }\n\n    let errorCode = ''\n    let errorMessage = ''\n\n    if (!isEmpty(body)) {\n      // Handle responses with a body status code.\n      const { statusCode } = body.logHistory\n      errorMessage = `Failed to fetch call log(s); Status code: ${statusCode}`\n      errorCode = bodyStatusCodeMap[statusCode] || callHistoryCodes.UNKNOWN_ERROR\n    } else {\n      // Handle responses without a body status code. HTTP status code is checked to determine the error.\n      // Either REST request issues or unknown server issues.\n      const { code, message } = result\n\n      errorMessage = `Failed to fetch call log(s); ${message}.`\n      errorCode = code === HTTPStatusCodes.FORBIDDEN ? callHistoryCodes.FORBIDDEN : callHistoryCodes.UNKNOWN_ERROR\n    }\n\n    log.info(errorMessage)\n    throw new BasicError({\n      code: errorCode,\n      message: errorMessage\n    })\n  }\n\n  return fetchCallLogs\n}\n","export { default as fetch } from './fetch'\nexport { default as removeCallLogs } from './remove'\nexport { default as setCache } from './setCache'\nexport { default as storeCallLog } from './storeLog'\n","import removeRequest from './request'\nimport removeOperation from './operation'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('CallHistoryRequests.removeCallLogs', container => {\n    return removeRequest(bottle.container)\n  })\n\n  bottle.factory('CallHistoryOperations.removeCallLogs', container => {\n    return removeOperation(bottle.container)\n  })\n}\n","// Call History plugin.\nimport * as actions from '../../../interface/actions'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `removeCallLogs` operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, CallHistoryRequests: requests } = container\n  const log = logManager.getLogger('CALLHISTORY')\n\n  /**\n   * Operation for deleting call logs.\n   * @method removeCallLogs\n   * @param  {number} recordId The ID of the call log to be removed.\n   * @throws {BasicError} If the parameters are invalid.\n   * @throws {BasicError} If the REST request fails.\n   *\n   */\n  async function removeCallLogs(recordId) {\n    log.info('Attempting to remove call log(s):', recordId)\n\n    try {\n      await requests.removeCallLogs(recordId)\n\n      log.info('Successfully removed log(s) from call history.')\n      // Dispatch the finish action to update redux state.\n      context.dispatch(actions.removeCallLogsFinish({ recordId }))\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      context.dispatch(actions.removeCallLogsFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  return removeCallLogs\n}\n","// Other plugins.\nimport { getRequestInfo } from '../../../../auth/interface/selectors'\nimport { isEmpty } from 'lodash/fp'\nimport BasicError, { callHistoryCodes } from '../../../../errors'\n\n/**\n * Request factory function.\n * @method createRequest\n * @param  {Object} container The bottle container.\n * @return {Function} The `removeCallLogs` REST operation.\n */\nexport default function createRequest(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('CALLHISTORY')\n\n  /**\n   * KL REST request to delete a call log.\n   * @method removeCallLogs\n   * @param  {number|string} recordId\n   * @throws {BasicError} If the server responds with an error.\n   */\n  async function removeCallLogs(recordId) {\n    const requestInfo = getRequestInfo(context.getState())\n    const version = requestInfo.version\n\n    let url = `${requestInfo.baseURL}/rest/version/${version}/user/${requestInfo.username}/`\n\n    if (recordId === 'all') {\n      url += 'logHistory'\n    } else {\n      url += `logRecord/${recordId}`\n    }\n\n    const options = {\n      method: 'DELETE',\n      url,\n      responseType: 'none'\n    }\n\n    const bodyStatusCodeMap = {\n      4: callHistoryCodes.NOT_AUTHENTICATED,\n      27: callHistoryCodes.FORBIDDEN,\n      35: callHistoryCodes.FORBIDDEN,\n      42: callHistoryCodes.NOT_FOUND\n    }\n\n    const HTTPStatusCodes = {\n      FORBIDDEN: 403\n    }\n\n    // Credentials not set. Therefore, request is not sent (unauthorized issue).\n    if (!requestInfo.username) {\n      const message = 'Failed to remove call log(s) from call history; user not authenticated (credentials not set).'\n      log.info(message)\n      throw new BasicError({\n        code: callHistoryCodes.NOT_AUTHENTICATED,\n        message\n      })\n    }\n\n    // username is defined, proceed with the request.\n    const response = await sendRequest(options)\n    const { body, error, result } = response\n\n    // no errors, request is successful.\n    if (!error) {\n      log.info('Call log(s) removed successfully.')\n      return\n    }\n\n    let errorCode = ''\n    let errorMessage = ''\n\n    if (!isEmpty(body)) {\n      // Handle responses with a body status code (errors from the server).\n      const { statusCode } = body.logRecord\n      errorMessage = `Failed to remove log(s) from call history. Status Code ${statusCode}`\n      errorCode = bodyStatusCodeMap[statusCode] || callHistoryCodes.UNKNOWN_ERROR\n    } else {\n      // Handle responses without a body status code. Errors from the request helper.\n      const { code, message } = result\n\n      errorMessage = `Failed to remove log(s) from call history. ${message}`\n      errorCode = code === HTTPStatusCodes.FORBIDDEN ? callHistoryCodes.FORBIDDEN : callHistoryCodes.UNKNOWN_ERROR\n    }\n\n    log.info(errorMessage)\n    throw new BasicError({\n      code: errorCode,\n      message: errorMessage\n    })\n  }\n\n  return removeCallLogs\n}\n","import setCacheOperation from './operation'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('CallHistoryOperations.setCache', container => {\n    return setCacheOperation(bottle.container)\n  })\n}\n","// Call History plugin.\nimport * as actions from '../../../interface/actions'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `setCache` operation.\n */\nexport default function createOperation(container) {\n  const { context } = container\n\n  /**\n   * Operation for adding call history cache data to state.\n   * @param {Object} data Call history cache.\n   */\n  function setCache(data) {\n    // Dispatch the action to update state.\n    context.dispatch(actions.setCache(data))\n  }\n\n  return setCache\n}\n","import storeOperation from './operation'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('CallHistoryOperations.storeCallLog', container => {\n    return storeOperation(bottle.container)\n  })\n}\n","// Call History plugin.\nimport * as actions from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\n\n// Other plugins.\nimport { getUserInfo } from '../../../../auth/interface/selectors'\nimport { CALL_STATES } from '../../../../call/constants'\nimport { getCallById } from '../../../../call/interface/selectors'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `storeCallLog` operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, emitEvent } = container\n  const log = logManager.getLogger('CALLHISTORY')\n\n  /**\n   * Constructs a local call log from a \"call ended\" action.\n   * New callstack specific.\n   *\n   * This operation defines how a \"local call log\" is created after a call has ended.\n   *    The format of the log mimics the format of server-side call logs.\n   * Assumptions:\n   *    1. The provided action is a \"call ended\" action for the new callstack.\n   * Responsibilities:\n   *    1. Gather all information needed for a call log.\n   *    2. Create / format the call log.\n   *    3. Update redux state (via actions).\n   * @method storeCallLogs\n   * @param {string} callId Id of a call that has ended.\n   * @param {Object} transition An object representing the previous state of the call.\n   */\n  function storeCallLog(callId, transition) {\n    const call = getCallById(context.getState(), callId)\n\n    if (!call) {\n      log.debug(`Call (${callId}) not in state to create local log.`)\n      return\n    }\n\n    if (call.state !== CALL_STATES.ENDED) {\n      return\n    }\n\n    const userInfo = getUserInfo(context.getState())\n\n    const logEntry = {\n      recordId: callId,\n      startTime: '' + call.startTime,\n      duration: '' + (call.endTime - call.startTime),\n      callerDisplayNumber: call.isCaller ? userInfo.username : call.remoteParticipant.displayNumber,\n      calleeDisplayNumber: call.isCaller ? call.remoteParticipant.displayNumber : userInfo.username,\n      calleeName: call.isCaller\n        ? call.remoteParticipant.displayName || call.remoteParticipant.displayNumber\n        : userInfo.username,\n      callerName: call.isCaller\n        ? call.displayName\n          ? call.displayName\n          : userInfo.username\n        : call.remoteParticipant.displayName || call.remoteParticipant.displayNumber,\n      remoteParticipant: call.remoteParticipant,\n      originalRemoteParticipant: null,\n      resourceLocation: ''\n    }\n\n    if (call.direction === 'incoming') {\n      // If the previous state was ringing, and the change was not because the call was\n      //      answered by another device (ie. code 9904), then it is a missed call.\n      // TODO: 9904 is old FCS behaviour that doesn't actually exist in 4.X anymore.\n      if (transition && transition.prevState === CALL_STATES.RINGING && transition.code !== '9904') {\n        logEntry.direction = 'missed'\n      } else {\n        logEntry.direction = 'incoming'\n      }\n    } else {\n      logEntry.direction = 'outgoing'\n    }\n\n    log.debug(`Adding ${logEntry.direction} call to the local call history:`, logEntry)\n    context.dispatch(actions.addCallLogEntry(logEntry))\n\n    // Emit the events for \"logs changed\".\n    emitEvent(eventTypes.CALL_HISTORY_CHANGE, {})\n    emitEvent(eventTypes.CALL_HISTORY_CACHE_CHANGE, {})\n  }\n\n  return storeCallLog\n}\n","import { name, reducer, createAPI } from '../interface'\nimport createMiddleware from './middleware'\nimport * as features from './features'\n\n/**\n * Call History plugin factory.\n * @method callHistoryFactory\n */\nexport default function callHistoryFactory(bottle) {\n  // Register the component factory functions to the bottle.\n  bottle.factory('CallHistoryAPI', createAPI)\n  // Initialize the plugin features with the bottle scope.\n  for (const name in features) {\n    features[name](bottle)\n  }\n\n  return {\n    name,\n    capabilities: ['callHistory'],\n    reducer,\n    middleware: createMiddleware\n  }\n}\n","import { END_CALL_FINISH, REJECT_CALL_FINISH } from '../../call/interface/actionTypes'\n\n/**\n * Call History middleware factory function.\n * @method createMiddleware\n * @param  {Object} context The factory context.\n * @return {Function} A redux middleware.\n */\nexport default function createMiddleware(context) {\n  const operations = context.container.CallHistoryOperations\n  /*\n   * Redux middleware: Watch for specific actions and trigger operations\n   *    when we see them.\n   */\n  return next => action => {\n    /*\n     * Let the action pass through all middlewares and reducers before acting\n     *    on it. This ensures the operation that triggered the action, and any\n     *    state changes involved, has finished completely.\n     *\n     * The Call History's middleware operations are side-effects: they do not\n     *    affect/interact with the original operation and so wait for them to\n     *    finish before being triggered.\n     */\n    const returnVal = next(action)\n\n    switch (action.type) {\n      // When a call ends from the Call plugin, Call History should create\n      //    a local call log for it.\n      case END_CALL_FINISH:\n      case REJECT_CALL_FINISH:\n        if (action.payload.id) {\n          operations.storeCallLog(action.payload.id, action.payload.transition)\n        }\n        break\n      // Call History doesn't act on any other actions.\n      default:\n        break\n    }\n\n    return returnVal\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const CLICK_TO_CALL = PREFIX + 'CLICK_TO_CALL'\nexport const CLICK_TO_CALL_FINISH = PREFIX + 'CLICK_TO_CALL_FINISH'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Represents a request to POST clickToCall data.\n * @method clickToCall\n * @param  {string} callId\n * @param  {string} caller\n * @param  {string} callee\n * @return {Action} A redux action.\n */\nexport function clickToCall(callId, caller, callee) {\n  return {\n    type: actionTypes.CLICK_TO_CALL,\n    payload: {\n      callId,\n      caller,\n      callee\n    }\n  }\n}\n\n/**\n * Represents that a response was received for a clickToCall request.\n * @method clickToCallFinish\n * @param  {string} callId\n * @param  {string} caller\n * @param  {string} callee\n * @param  {number} requestTime time that the request was made at\n * @param  {Boolean}  [error] A parameter to indicate if there was an issue.\n * @return {Action} A redux action.\n */\nexport function clickToCallFinish({ callId, caller, callee, requestTime, error }) {\n  if (error) {\n    return {\n      type: actionTypes.CLICK_TO_CALL_FINISH,\n      error: true,\n      payload: {\n        error\n      }\n    }\n  } else {\n    return {\n      type: actionTypes.CLICK_TO_CALL_FINISH,\n      error: false,\n      payload: {\n        callId,\n        caller,\n        callee,\n        requestTime\n      }\n    }\n  }\n}\n","/**\n * The clickToCall namespace is used to bridge a call between two specified devices\n *\n * @public\n * @namespace clickToCall\n * @requires clickToCall\n */\nimport { CLICK_TO_CALL_STARTED, CLICK_TO_CALL_ERROR } from './eventTypes'\nimport { getAll } from './selectors'\n\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * ClickToCall API factory function.\n * Defines the interface between the application and the SDK's ClickToCall APIs.\n * @method createAPI\n * @param {Object} container The bottle container.\n * @returns {Object} Available public APIs for ClickToCall.\n */\nexport default function createAPI(container) {\n  const { context, emitEvent, ClickToCallOperations: operations, logManager, API_LOG_TAG } = container\n\n  const log = logManager.getLogger('CLICKTOCALL')\n  const clickToCallApi = {\n    /**\n     * Attempts to establish a call between two specified devices.\n     *\n     * @public\n     * @memberof clickToCall\n     * @method make\n     * @param  {string} caller A string representing the person making the call\n     * @param  {string} callee A string representing the person receiving the call\n     * @returns {string} callId A unique id representing the call or undefined if there is an error.\n     */\n    make: function (caller, callee) {\n      log.debug(API_LOG_TAG + 'clickToCall.make: ', caller, callee)\n      const callId = uuidV4()\n      try {\n        operations.clickToCall(callId, caller, callee)\n      } catch (error) {\n        emitEvent(CLICK_TO_CALL_ERROR, { callId, error })\n        return callId\n      }\n\n      // Emit the event for \"click to call started\".\n      // Only include callId in payload, for backward compatibility\n      emitEvent(CLICK_TO_CALL_STARTED, { callId })\n\n      // Return the end result from calling this API.\n      // For backwards compatibility we only return the callId,\n      // not the entire object returned by 'clickToCall' operation.\n      return callId\n    },\n    /**\n     * Gets all local clickToCall calls\n     *\n     * @public\n     * @memberof clickToCall\n     * @requires clickToCall\n     * @method get\n     * @returns {Array} A list of clickToCall records, ordered by earliest requestTime\n     */\n    get: function () {\n      log.debug(API_LOG_TAG + 'clickToCall.get')\n      return getAll(context.getState())\n    }\n  }\n\n  return {\n    clickToCall: clickToCallApi\n  }\n}\n","/**\n * ClickToCall has successfully started.\n *\n * @public\n * @memberof clickToCall\n * @requires clickToCall\n * @event clickToCall:start\n * @param {Object} params\n * @param {string} params.callId A unique id representing the call made\n */\nexport const CLICK_TO_CALL_STARTED = 'clickToCall:start'\n\n/**\n * ClickToCall had an error.\n *\n * @public\n * @memberof clickToCall\n * @requires clickToCall\n * @event clickToCall:error\n * @param {Object} params\n * @param {string} params.callId A unique id representing the call made\n * @param {api.BasicError} params.error The Basic error object.\n *\n */\nexport const CLICK_TO_CALL_ERROR = 'clickToCall:error'\n","import api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a clickToCall plugin.\n * @type {string}\n */\nconst name = 'clickToCall'\n\nexport { reducer, name, api }\n","/**\n * clicktoCall Plugin.\n *\n * Handles the clicktoCall plugin substate. Defines how to communicate back to\n * the Interface (ie. which actions to use).\n * @param  {Object} [state={}] Default state for the reducer is an empty object.\n * @param  {Action} action A dispatched action.\n * @return {Object} state The new example sub-state.\n */\n\nimport { handleActions } from 'redux-actions'\nimport * as actionTypes from './actionTypes'\n\nconst reducers = {}\n\nreducers[actionTypes.CLICK_TO_CALL_FINISH] = {\n  next(state, action) {\n    if (action.error) {\n      return state\n    } else {\n      return state.concat({\n        callId: action.payload.callId,\n        caller: action.payload.caller,\n        callee: action.payload.callee,\n        requestTime: action.payload.requestTime\n      })\n    }\n  }\n}\n\n// clickToCall default state is empty array\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","// Other Libraries\nimport { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves clickToCall calls stored in state\n *\n * @method getAll\n * @param  {Object} state Redux state.\n * @return {Array}\n */\nexport function getAll(state) {\n  return cloneDeep(state.clickToCall)\n}\n","import { name, reducer } from '../interface'\nimport createAPI from '../interface/api'\nimport createOperations from './operations'\nimport createRequests from './requests'\n\n/**\n * ClickToCall service plugin factory.\n * Provides the SDK with the 'Click to Call' feature.\n * @method clickToCallFactory\n */\nexport default function clickToCallFactory(bottle) {\n  // Register the component factory functions to the bottle.\n  bottle.factory('ClickToCallAPI', createAPI)\n  bottle.factory('ClickToCallOperations', createOperations)\n  bottle.factory('ClickToCallRequests', createRequests)\n\n  const capabilities = ['clickToCall']\n  return {\n    capabilities,\n    name,\n    reducer\n  }\n}\n","// ClickToCall Actions\nimport * as actions from '../interface/actions'\n\nimport BasicError, { clickToCallCodes } from '../../errors'\n\n/**\n * ClickToCall Operations factory function.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for ClickToCall.\n */\nexport default function createOperations(container) {\n  const { context, logManager, ClickToCallRequests: requests } = container\n  const log = logManager.getLogger('CLICKTOCALL')\n\n  /**\n   * Operation to setup a call between a caller and a callee.\n   * @method clickToCall\n   * @param {string} callId A unique id representing the call.\n   * @param {string} caller A string representing the person from whom the call originates.\n   * @param {string} callee A string representing the person receiving the call.\n   */\n  async function clickToCall(callId, caller, callee) {\n    const { dispatch } = context\n\n    // Backwards compatibility: Dispatch this action at the start of the operation\n    // because that's what the old API does. Will not affect state or trigger an event.\n    dispatch(actions.clickToCall(callId, caller, callee))\n\n    // ensure both caller and callee are provided in payload.\n    if (!caller || !callee) {\n      log.info('Missing call participant information')\n      const validationError = new BasicError({\n        message: 'callee and/or caller were not provided in CLICK_TO_CALL action payload',\n        code: clickToCallCodes.MISSING_ARGS\n      })\n\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(actions.clickToCallFinish({ payload: { error: validationError, callId } }))\n\n      // Throw the error so it makes it back to the API.\n      throw validationError\n    }\n\n    try {\n      const clickToCallData = await requests.clickToCall(callId, caller, callee)\n\n      log.info('Successfully initiated a click to call.')\n\n      // Update state by dispatching an action.\n      dispatch(actions.clickToCallFinish({ ...clickToCallData }))\n\n      return clickToCallData\n    } catch (error) {\n      // Backwards compatibility: Dispatch this action to signal an error.\n      dispatch(actions.clickToCallFinish({ error, callId }))\n\n      // Throw the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  return {\n    // API operations:\n    clickToCall\n  }\n}\n","// Other plugins.\nimport { getConnectionInfo } from '../../auth/interface/selectors'\nimport BasicError, { clickToCallCodes } from '../../errors'\n\n/**\n * ClickToCall Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's ClickToCall REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for ClickToCall.\n */\nexport default function createRequests(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('CLICKTOCALL')\n\n  /**\n   * KL REST request to trigger the call setup between a caller and a callee.\n   * @param {string} callId A unique id representing the call.\n   * @param {string} caller A string representing the person from whom the call originates.\n   * @param {string} callee A string representing the person receiving the call.\n   */\n  async function clickToCall(callId, caller, callee) {\n    const conn = getConnectionInfo(context.getState())\n\n    const { server, username } = conn\n\n    const version = server.version\n\n    const url = `${server.protocol}://${server.server}:${server.port}/rest/version/${version}/user/${username}/clicktocall`\n\n    const data = {\n      clickToCallRequest: {\n        callingParty: caller,\n        calledParty: callee\n      }\n    }\n\n    const options = {\n      url,\n      method: 'POST',\n      body: JSON.stringify(data)\n    }\n\n    const requestTime = Date.now()\n\n    const response = await sendRequest(options)\n    const { error, result } = response\n\n    if (error) {\n      // Handle errors from the request helper.\n      const { message } = result\n      const errMsg = `ClickToCall request failed. ${message}`\n      log.info(errMsg)\n\n      throw new BasicError({\n        code: clickToCallCodes.RESPONSE_ERROR,\n        message: errMsg\n      })\n    } else {\n      return {\n        callId,\n        caller,\n        callee,\n        requestTime\n      }\n    }\n  }\n\n  return {\n    // Operation requests.\n    clickToCall\n  }\n}\n","/**\n * Interval creation factory function.\n * @method createInterval\n * @param {function} callback Function to run when the interval timer expires.\n * @param {number} interval Duration of interval.\n * @return {Object} Interval operations.\n */\nexport default function createInterval(func, interval) {\n  let intervalId = null\n\n  /**\n   * Get the id for the currently running interval.\n   * @returns The id for the interval that is currently running\n   */\n  function getId() {\n    return intervalId\n  }\n\n  /**\n   * Start the interval\n   * @method start\n   */\n  function start() {\n    intervalId = setInterval(async () => {\n      await func()\n    }, interval)\n  }\n\n  /**\n   * Stop the interval\n   * @method stop\n   */\n  function stop() {\n    if (intervalId) {\n      clearInterval(intervalId)\n      intervalId = null\n    } else {\n      throw new Error('This operation interval has not been started yet.')\n    }\n  }\n\n  if (!func || typeof func !== 'function') {\n    throw new Error('No valid callback function provided for interval operation.')\n  }\n\n  if (!interval || typeof interval !== 'number' || interval < 0) {\n    throw new Error('No valid interval period provided for interval operation.')\n  }\n\n  return {\n    getId,\n    start,\n    stop\n  }\n}\n","import { v4 as uuidV4 } from 'uuid'\n\n// Generate a unique SDK GUID for the running SDK instance.\nconst sdkId = uuidV4()\n\nexport default sdkId\n","// Libraries.\nimport { isPlainObject, isElement } from 'lodash/fp'\n\n/**\n * Ensures that services are in the same format understood by the server regardless,\n * of whether the client provides services as strings or objects.\n * @param {Array} services The list of services requested by the client.\n * @return {Array} A normalized list of services requested by the client.\n */\nexport function normalizeServices(services = []) {\n  return services.map(service => {\n    if (isPlainObject(service) && service.hasOwnProperty('service')) {\n      return service\n    }\n    return { service: service }\n  })\n}\n\n/**\n * Delay execution.\n * @param {number} duration in milleseconds.\n */\nexport function delay(duration) {\n  return new Promise(resolve => setTimeout(resolve, duration))\n}\n\n/**\n * Returns a log-safe CSS selector string.\n * This is needed because applications that may try to stringify logs that output an HTML element may run\n *   into a circular structure exceptions.\n * @param {*} selector CSS Selector.\n * @returns A log-safe string.\n */\nexport function logCssSelector(selector) {\n  return isElement(selector) ? selector.id : selector\n}\n","/**\n * This wrapper generates error messages from v8n Validation Errors. https://imbrn.github.io/v8n/api/#validationerror\n * They are logged using LogManager as a warning to our customers when they mess up arguments.\n * To use: `import { enums, validation as v8n, parse } from '<relativePath>/common/validation'`.\n * Build up your validation using v8n.string, v8n.number, v8n.schema, enums, etc.\n * Enums is not part of the v8n library, but provided here for ease of use\n * const v8nValidation = v8n.schema({\n      sdpSemantics: enums(['unified-plan']),\n      iceServers: v8n.array(),\n      iceCollectionIdealTimeout: v8n.positive(),\n      serverTurnCredentials: v8n.boolean(),\n      iceCollectionCheckFunction: v8n.optional(v8n.function())\n    })\n * Create a validator like this: `const parseOptions = parse('nameOfArg', v8nValidation)`\n * Run that validator against the actual values: `parseOptions(options)`\n * Returns the input either way and logs errors, in the future will throw errors on invalid data.\n */\nimport { __, concat, flatMap, isArray, isEmpty, join, map, partial } from 'lodash/fp'\nimport { logManager } from '../../logs'\nimport v8n from 'v8n'\n\n// Custom v8n Rules - https://imbrn.github.io/v8n/api/#extend\nv8n.extend({\n  function: () => value => typeof value === 'function'\n})\n\n// EXPORTS / IO\nexport const validation = v8n()\n\n// TODO: Add an enums function to the v8n library\n// Use as such: `prop: enums( [ 'red', 'blue', 'green' ] )\nexport const enums = values => {\n  // Map iteratee isn't just `v8n().exact` due to v8n() returning a new ProxyContext each time\n  const v8nExact = value => v8n().exact(value)\n  const exactValues = map(v8nExact)(values)\n  return v8n().passesAnyOf(...exactValues)\n}\n\n// Name -> v8nRule -> Input -> [String]\nexport const errorMessages = name => v8nRule => input =>\n  flatMap(validationErrorMessages(name))(validationResults(v8nRule)(input))\n\nexport const validationResults = v8nRule => input => v8nRule.testAll(input)\n\n// (Name, v8nRule) -> Input -> IO Input\nexport const parse = (name, v8nRule) => input => {\n  const errors = errorMessages(name)(v8nRule)(input)\n\n  if (isEmpty(errors)) {\n    return input\n  } else {\n    const log = logManager.getLogger('VALIDATION')\n    log.info(prettyPrint(errors)) // This is an IO side-effect\n    return input\n  }\n}\n\n// DEFINITIONS\n\n// Name -> ValidationError -> [String]\n// https://imbrn.github.io/v8n/api/#validationerror\nconst validationErrorMessages = name => validationError => {\n  const startingPath = []\n  return validationErrorMessageHelper(startingPath)(name)(validationError)\n}\n\n// [String] -> Name -> ValidationError -> [String]\nconst validationErrorMessageHelper =\n  acc =>\n  name =>\n  ({ cause, rule, target, value }) => {\n    const path = concat(acc)(target || name)\n    if (isArray(cause)) {\n      const newVEM = validationErrorMessageHelper(path)(target)\n      return flatMap(newVEM)(cause)\n    } else {\n      return `${join('.')(path)} has value of '${value}', but it should be ${ruleMessage(rule)}`\n    }\n  }\n\n// Rule -> String\n// https://imbrn.github.io/v8n/api/#rule\nconst ruleMessage = ({ name, args }) => {\n  switch (name) {\n    case 'schema':\n      return 'Schema'\n\n    case 'passesAnyOf':\n      return `any of '${join(\"', '\")(map(enumName)(args))}'`\n\n    case 'between':\n      return `between ${args.join(', ')}`\n\n    default:\n      return `${aOrAn(name)} ${name}`\n  }\n}\n\n// HELPERS\nconst enumName = arg => arg.chain[0].args // v8n internals\nconst prettyPrint = partial(JSON.stringify)([__, null, 4])\n// https://dictionary.cambridge.org/grammar/british-grammar/a-an-and-the\nconst aOrAn = string => (/[aeiou]/i.test(string[0]) ? 'an' : 'a')\n","/**\n * Returns the version of the currently running SDK.\n *\n * It must be used by any plugins (including the factory) as the unique source of truth when it comes to determine the current SDK version.\n * The actual version value is provided by the build process scripts (aka webpack.config.***.js) which simply do a string substitution\n * for the @@ tag below with actual version value.\n */\nexport function getVersion() {\n  return '7.2.0-beta.1547'\n}\n","/**\n * This file is a plugin for the \"Config\" plugin\n * Reference info: https://confluence.genband.com/display/KSDK/Plugins\n */\nimport pluginInterface from './interface'\nimport createAPI from './interface/api'\n\n/**\n * Config Plugin\n *\n * @method configImplementation\n * @return {Object} An instance of the \"Config\" plugin.\n */\n\n// yarn lint:docs complains if this isn't defined in a plugin.\n/**\n * Config service plugin factory.\n * Provides the SDK with the 'Config' feature.\n * @module config\n */\nexport default function configFactory(bottle) {\n  // Register the component factory functions to the bottle.\n  bottle.factory('ConfigAPI', createAPI)\n\n  const capabilities = ['config']\n  return {\n    // Interface Components:\n    name: pluginInterface.name,\n    capabilities,\n    api: pluginInterface.createAPI,\n    reducer: pluginInterface.reducer\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const CONFIG_UPDATE = PREFIX + 'CONFIG_UPDATE'\n\nexport const SET_SDP_HANDLERS = PREFIX + 'SET_SDP_HANDLERS'\n","import * as actionTypes from './actionTypes'\nimport { sanitizeSdesFromSdp } from '../../call/callstack/sdp/handlers/sanitizeSdesFromSdp'\nimport { modifySdpBandwidth } from '../../call/callstack/sdp/handlers/modifySdpBandwidth'\n\n/**\n * Add or update a specific key within the store.config.\n *\n * @param {Object} values The values that will be placed in the store.\n * @param {string} [pluginName] The plugin name of the config being set.\n * @return {Action} action A redux action.\n */\nexport function update(values, pluginName = '') {\n  var payload\n  // Use the plugin name as a substate key, if present.\n  if (pluginName) {\n    payload = {\n      [pluginName]: values\n    }\n  } else {\n    payload = values\n  }\n\n  return {\n    type: actionTypes.CONFIG_UPDATE,\n    payload: payload\n  }\n}\n\n/**\n * Updates the SDP Handlers in the call plugin configs\n *\n * @method setSdpHandlers\n * @param {Array<call.SdpHandlerFunction>} sdpHandlers The list of SDP handler to set in the config.\n * @returns {Object} A flux standard action.\n */\nexport function setSdpHandlers(sdpHandlers) {\n  /*\n   * Set SDP handlers to be used for every operation:\n   *\n   * 1. Application provided SDP handlers.\n   *\n   * 2. Disable DTLS-SDES crypto method (ie. delete the line) if there's a better\n   *    crypto method enabled. WebRTC only allows one method to be enabled.\n   *    This is needed for interoperability with non-browser endpoints that include\n   *    SDES as a fallback method.\n   *\n   *\n   * 3. Modify sdp and add bandwidth limits on it if bandwidth controls are provided.\n   */\n  sdpHandlers.push(sanitizeSdesFromSdp)\n  sdpHandlers.push(modifySdpBandwidth)\n\n  return {\n    type: actionTypes.SET_SDP_HANDLERS,\n    payload: {\n      sdpHandlers\n    }\n  }\n}\n","// Config plugin.\nimport * as actions from './actions'\nimport { getConfiguration } from './selectors'\n\n// Other plugins.\nimport parseCallConfigs from '../../call/configs'\n\nimport { cloneDeep } from 'lodash/fp'\n\n/**\n * Config API factory function.\n * Defines the interface between the application and the SDK's Config APIs.\n * @method createAPI\n * @param {Object} container The bottle container.\n * @returns {Object} Available public APIs for Config.\n */\nexport default function createAPI(container) {\n  const { context, logManager, API_LOG_TAG } = container\n\n  const log = logManager.getLogger('CONFIG')\n  const configApi = {\n    /**\n     * Gets the current configuration Object. This is the object that is initially set as part of SDK creation using 'create' function.\n     *\n     * @public\n     * @static\n     * @memberof api\n     * @requires config\n     * @method getConfig\n     * @returns {Object} A configuration Object.\n     */\n    getConfig: function () {\n      log.debug(API_LOG_TAG + 'getConfig')\n      return getConfiguration(context.getState())\n    },\n\n    /**\n     * Update the configuration values for the SDK to use.\n     *\n     * This API will only modify the configurations provided, leaving other configurations\n     *   as they were originally set, by performing a merge of the new values into the\n     *   previous values.\n     *\n     * Please note that the object provided to the `updateConfig` API may be different\n     *   than the object retrieved from the {@link api.getConfig getConfig} API. This may happen when a format\n     *   change has happened and the SDK modifies the provided format to alleviate\n     *   backwards-compatibility issues. We recommend ensuring the configurations you\n     *   provide are as described by the {@link config} section.\n     *\n     * @public\n     * @static\n     * @memberof api\n     * @requires config\n     * @method updateConfig\n     * @param {Object} newConfigValues Key-value pairs that will be placed into the store. See {@link config} for details on what key-value pairs are available for use.\n     * @example\n     * // Instantiate the SDK with certain configs.\n     * const client = create({\n     *   authentication: { ... },\n     *   logs: { ... },\n     *   ...\n     * })\n     *\n     * // Modify a subsection of the configs at a later time.\n     * // This will only update the specified configurations.\n     * client.updateConfig({\n     *     logs: {\n     *       loglevel: 'DEBUG'\n     *     }\n     * })\n     */\n    updateConfig: function (newConfigValues) {\n      log.debug(API_LOG_TAG + 'updateConfig: ', newConfigValues)\n\n      // Clone the configs so we don't mutate the application's object.\n      const configs = cloneDeep(newConfigValues)\n\n      // Validate the new config provided by the application.\n      if (configs.call) {\n        // TODO: Should add validation for all configs, not just the call-related ones\n        //      (by parsing using the specific 'v8nValidation' constant,\n        //       available in each plugin).\n        configs.call = parseCallConfigs(configs.call)\n      }\n\n      context.dispatch(actions.update(configs))\n    }\n  }\n\n  return configApi\n}\n","import api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a Config plugin.\n * @type {string}\n */\nconst name = 'config'\n\nexport default {\n  reducer,\n  name,\n  api: api.configApi\n}\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\nconst reducers = {}\n\nreducers[actionTypes.CONFIG_UPDATE] = {\n  next(state, action) {\n    return mergeValues(state, action.payload)\n  }\n}\n\nreducers[actionTypes.SET_SDP_HANDLERS] = {\n  next(state, action) {\n    return {\n      ...state,\n      call: {\n        ...state.call,\n        sdpHandlers: action.payload.sdpHandlers\n      }\n    }\n  }\n}\n\n// Config default state is an empty Object\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves configuration Object stored in state\n *\n * @method getConfiguration\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getConfiguration(state) {\n  return cloneDeep(state.config)\n}\n","import toQueryString from '@rbbn/utilities/toQueryString'\n\n// Other plugins.\nimport { logManager } from '../../logs'\n\nconst log = logManager.getLogger('CONNECTIVITY')\n\n/**\n * Create a new websocket.\n * @method openWebsocket\n * @param  {Object} options Websocket configuration options.\n * @param {string} options.protocol Websocket protocol to use.\n * @param {string} options.server Websocket hostname.\n * @param {string} options.port Websocket port to use.\n * @param {string} options.url Websocket notification channel.\n * @param {Object} [options.params] A list of URL params to attach to the websocket.\n * @return {Promise<WebSocket>} ws Newly connected websocket.\n */\nexport function openWebsocket(options) {\n  // Create the websocket.\n  const wsUrl = `${options.protocol}://${options.server}:${options.port}${options.url}` + toQueryString(options.params)\n  log.debug(`Opening socket at: ${wsUrl}`)\n  const ws = new WebSocket(wsUrl)\n\n  // Use a promise to wait for the first message from the websocket.\n  // This indicates whether the WS opened successfully or not.\n  const validateWS = new Promise((resolve, reject) => {\n    const onOpen = function () {\n      ws.onopen = null\n      ws.onerror = null\n      resolve(ws)\n    }\n    const onError = function () {\n      ws.onopen = null\n      ws.onerror = null\n\n      // TODO: Fix this?\n      /* eslint-disable-next-line prefer-promise-reject-errors */\n      reject({\n        // Websocket doesn't return error codes for security reasons and as such all websocket\n        // errors have to be handled the same.\n        error: true,\n        message: 'Could not connect to websocket. Received error on open.'\n      })\n    }\n    ws.onopen = onOpen\n    ws.onerror = onError\n  })\n  return validateWS\n}\n\n/**\n * Clean-up a provided websocket.\n * @method cleanupWebSocket\n * @param  {Websocket} ws Websocket to be cleaned-up.\n * @return {Websocket} ws The websocket after being cleaned.\n */\nexport function cleanupWebSocket(ws) {\n  if (ws.close) {\n    ws.close()\n  }\n  ws.onclose = null\n  ws.onmessage = null\n  ws.onopen = null\n  ws.onerror = null\n}\n","const prefix = '@@KANDY/CONN/'\n\n// Actions to tell connectivity plugin what to do\nexport const WS_ATTEMPT_CONNECT = prefix + 'WS_ATTEMPT_CONNECT'\nexport const WS_CONNECT_FINISHED = prefix + 'WS_CONNECT_FINISHED'\nexport const WS_DISCONNECT = prefix + 'WS_DISCONNECT'\nexport const WS_DISCONNECT_FINISHED = prefix + 'WS_DISCONNECT_FINISHED'\nexport const WS_RECONNECT_FAILED = prefix + 'WS_RECONNECT_FAILED'\n\n// actions for hooking into connectivity plugin behaviour\nexport const WS_CLOSED = prefix + 'WS_CLOSED'\nexport const WS_ERROR = prefix + 'WS_ERROR'\n\nexport const LOST_CONNECTION = prefix + 'LOST_CONNECTION'\n\nexport const CHANGE_CONNECTIVITY_CHECKING = prefix + 'CHANGE_CONNECTIVITY_CHECKING'\n","import * as actionTypes from './actionTypes'\n\nimport BasicError from '../../errors'\n\n/**\n * @param {string} type\n */\nfunction createWsAction(type) {\n  /**\n   * @param {any=} payload\n   * @param {boolean=} [isReconnect] flag to signify if we are reconnecting or not.\n   */\n  function action(payload, isReconnect = false) {\n    return {\n      type,\n      // TODO: This must check for basic error eventually instead.\n      error: payload instanceof Error || payload instanceof BasicError,\n      payload,\n      meta: { isReconnect }\n    }\n  }\n  return action\n}\n\nexport const wsAttemptConnect = createWsAction(actionTypes.WS_ATTEMPT_CONNECT)\nexport const wsDisconnect = createWsAction(actionTypes.WS_DISCONNECT)\nexport const wsConnectFinished = createWsAction(actionTypes.WS_CONNECT_FINISHED)\nexport const wsDisconnectFinished = createWsAction(actionTypes.WS_DISCONNECT_FINISHED)\nexport const wsReconnectFailed = createWsAction(actionTypes.WS_RECONNECT_FAILED)\n\nexport const wsClosed = createWsAction(actionTypes.WS_CLOSED)\nexport const wsError = createWsAction(actionTypes.WS_ERROR)\n\nexport const lostConnection = createWsAction(actionTypes.LOST_CONNECTION)\n\nexport const changeConnectivityChecking = createWsAction(actionTypes.CHANGE_CONNECTIVITY_CHECKING)\n","// Connectivity plugin.\nimport { changeConnectivityChecking, wsReconnectFailed } from './actions'\nimport { getConnectionState, getConnectivityConfig } from './selectors'\n\n/**\n * The 'connection' namespace is used to connect and maintain connections between\n * the SDK and one or more backend servers.\n *\n * @public\n * @namespace connection\n */\n\n/**\n * Information about a websocket connection.\n *\n * Can be retrieved using the {@link connection.getSocketState} API.\n *\n * @public\n * @static\n * @typedef {Object} WSConnectionObject\n * @memberof connection\n * @property {boolean} connected The state of the websocket connection.\n * @property {boolean} pinging True if the client has sent a ping to the server and is still waiting for a pong response.\n * @property {number} pingInterval How often the client will ping the server to test for websocket connectivity.\n * @property {number} reconnectLimit How many times the SDK will try to reconnect a disconnected websocket.\n * @property {number} reconnectDelay How long the SDK will wait before retrying websocket reconnection.\n * @property {number} reconnectTimeMultiplier Reconnect delay multiplier for subsequent attempts. The reconnect delay time will be multiplied by this after each failed reconnect attempt to increase the delay between attempts. eg. 5000ms then 10000ms then 20000ms delay if value is 2.\n * @property {number} reconnectTimeLimit Maximum time delay between reconnect attempts (milliseconds). Used in conjunction with `reconnectTimeMultiplier` to prevent overly long delays between reconnection attempts.\n * @property {boolean} autoReconnect Indicates if the SDK should automatically try reconnecting a disconnected websocket.\n * @property {string} webSocketOAuthMode The mode used for authenticating with the server.\n * @property {Object} wsInfo Information required to connect a websocket to the server.\n * @property {string} [wsInfo.protocol] The protocol to use to connect a websocket.\n * @property {string} [wsInfo.server] The domain name or IP address of the server to connect to.\n * @property {number} [wsInfo.port] The port of the server to connect to.\n * @property {string} [wsInfo.url] The URL path to use to request a websocket connection.\n * @property {string} [wsInfo.params] Any additional params that might be required by the server to establish the websocket connection.\n */\n\nexport default function createApi(container) {\n  const { context, Connectivity, SubscriptionOperations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('CONNECTIVITY')\n\n  const connectivityApi = {\n    /**\n     * Get the state of the websocket.\n     * @public\n     * @static\n     * @memberof connection\n     * @method getSocketState\n     * @return {connection.WSConnectionObject} Details about the current websocket connection, including state and configuration.\n     */\n    getSocketState() {\n      log.debug(API_LOG_TAG + 'connection.getSocketState')\n      return getConnectionState(context.getState())\n    },\n\n    /**\n     * Enables or disables connectivity checking.\n     *\n     * This API will change the `connectivity.checkConnectivity` configuration set during SDK initialization. If there\n     *    was a connected websocket while it is changed, the change will take affect immediately.\n     * @public\n     * @memberof connection\n     * @method enableConnectivityChecking\n     * @param {boolean} enable Whether the websocket should be pinging to check for connectivity issues or not.\n     */\n    enableConnectivityChecking(enable) {\n      log.debug(API_LOG_TAG + 'connection.enableConnectivityChecking: ', enable)\n      context.dispatch(changeConnectivityChecking(enable))\n\n      Connectivity.setPinging(enable)\n    },\n\n    /**\n     * Resets the connected websocket by manually disconnecting then reconnecting.\n     *\n     * This API will simulate the SDK receiving a websocket disconnect from the browser,\n     *     which will trigger its recovery functionality. This API can be used if the application\n     *    is aware of a network issue before the SDK is notified by the browser.\n     *\n     * If there is no websocket connected, this API has no effect. If the SDK is not configured\n     *    to autoreconnect (see `connectivity.autoReconnect` configuration property), then this\n     *    API will not attempt to reconnect the websocket automatically.\n     *\n     * The normal websocket and lifecycle events will be emitted during this operation,\n     *    notably the {@link connection.event:ws:change ws:change} event.\n     * @public\n     * @memberof connection\n     * @method resetConnection\n     */\n    resetConnection() {\n      log.debug(API_LOG_TAG + 'connection.resetConnection')\n\n      const wsState = getConnectionState(context.getState())\n      if (!wsState.connected) {\n        log.debug(API_LOG_TAG + 'connection.resetConnection: No active websocket connection. Ignoring request.')\n        return\n      }\n\n      Connectivity.disconnect()\n      const autoReconnect = getConnectivityConfig(context.getState()).autoReconnect\n      log.info(`Websocket disconnected. (autoReconnect?: ${autoReconnect})`)\n      if (autoReconnect) {\n        Connectivity.connect(wsState.wsInfo, true).catch(() => {\n          context.dispatch(wsReconnectFailed())\n          SubscriptionOperations.onConnectionLost()\n        })\n      } else {\n        context.dispatch(wsReconnectFailed())\n        SubscriptionOperations.onConnectionLost()\n      }\n    }\n  }\n  return { connection: connectivityApi }\n}\n","/**\n * The WebSocket to the server has changed state.\n *\n * This event is only emitted when the WebSocket is connected, or has lost connection.\n *\n * @public\n * @memberof connection\n * @event ws:change\n */\nexport const WS_CHANGE = 'ws:change'\n","import name from './name'\nimport api from './api'\nimport reducer from './reducers'\n\nexport default { name, api, reducer }\n","const name = 'connectivity'\nexport default name\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport { omit } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.WS_ATTEMPT_CONNECT] = {\n  next(state, action) {\n    return {\n      ...state,\n      connected: false,\n      pinging: false\n    }\n  }\n}\n\nreducers[actionTypes.WS_RECONNECT_FAILED] = {\n  next(state, action) {\n    return {\n      ...state,\n      connected: false,\n      pinging: false\n    }\n  }\n}\n\nreducers[actionTypes.WS_CONNECT_FINISHED] = {\n  next(state, action) {\n    return {\n      ...state,\n      connected: true,\n      pinging: action.payload.pinging,\n      ...omit('checkConnectivity', action.payload.kandy)\n    }\n  },\n  throw(state, action) {\n    return {\n      connected: false,\n      pinging: false\n    }\n  }\n}\n\nreducers[actionTypes.LOST_CONNECTION] = {\n  next(state, action) {\n    return {\n      ...state,\n      connected: false,\n      pinging: false\n    }\n  }\n}\n\nreducers[actionTypes.WS_DISCONNECT_FINISHED] = {\n  next(state, action) {\n    return {\n      connected: false,\n      pinging: false\n    }\n  },\n  throw(state, action) {\n    return {\n      connected: false,\n      pinging: false\n    }\n  }\n}\n\nreducers[actionTypes.WS_ERROR] = {\n  next(state, action) {\n    return {\n      connected: false,\n      pinging: false\n    }\n  },\n  throw(state, action) {\n    return {\n      connected: false,\n      pinging: false\n    }\n  }\n}\n\n/*\n  Accepts a boolean payload for checkConnectivity\n */\nreducers[actionTypes.CHANGE_CONNECTIVITY_CHECKING] = {\n  next(state, action) {\n    return {\n      ...state,\n      checkConnectivity: action.payload\n    }\n  }\n}\n\n/**\n * Connectivity Interface reducer\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n */\nconst reducer = handleActions(reducers, { connected: false, pinging: false })\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\nimport name from './name'\n\nexport function getConnectionState(state) {\n  return cloneDeep(state[name])\n}\n\n/**\n * Retrieves the config options provided by the connectivity plugin.\n * @method getConnectivityConfig\n * @return {Object}\n */\nexport function getConnectivityConfig(state) {\n  return state.config[name]\n}\n\n/**\n * Retrieves the checkConnectivity property from state\n * @method getCheckConnectivity\n * @param {Object} state Redux state.\n * @return {Object}\n */\nexport function getCheckConnectivity(state) {\n  // TODO: Double-check this state property. It's not nested under [platform] like the rest?\n  return state[name].checkConnectivity\n}\n","// Connectivity plugin\nimport { getConnectionState } from './selectors'\nimport { WS_CONNECT_FINISHED } from './actionTypes'\n\n// Other plugins\nimport { delay } from '../../common/utils'\nimport { UNSUBSCRIBE_FINISHED } from '../../subscription/interface/actionTypes'\n\n/**\n * Util for waiting for the websocket / subscription to reconnect.\n * Assumption is that the websocket is in the middle of reconnect attempts. This\n *    is why the timeout is so long; one of the two scenarios should be guaranteed\n *    to happen before then.\n * @param {Object} container The bottle container.\n * @param {number} timeout The time, in milliseconds, to wait before timing out.\n * @return {boolean} Whether the websocket has reconnected or not.\n */\nexport async function waitForReconnect(container, timeout = 60000) {\n  const { context, Notifications } = container\n  const { connected: isConnected } = getConnectionState(context.getState())\n\n  if (isConnected) {\n    return true\n  }\n\n  const result = await Promise.race([\n    Notifications.takeAction(WS_CONNECT_FINISHED),\n    Notifications.takeAction(UNSUBSCRIBE_FINISHED),\n    delay(timeout)\n  ])\n\n  if (result && result.type && result.type === WS_CONNECT_FINISHED) {\n    return true\n  }\n\n  return false\n}\n","// Connectivity plugin.\nimport { connCheckMethods } from '../../constants'\n\n// Helpers.\nimport { validation as v8n, parse, enums } from '../../../src/common/validation'\n\n// Libraries.\nimport { defaults } from 'lodash/fp'\n\n/**\n * Configuration options for the Connectivity feature.\n * The SDK can only use keepalive as the connectivity check.\n *\n * Keep Alive: The client sends \"keepalive\" messages (to the server) on the websocket at regular intervals. This lets the server know that the client is still connected, and that it should \"keep the connection alive\".\n *\n * For more information on keepalive see here: https://en.wikipedia.org/wiki/Keepalive\n * @public\n * @name config.connectivity\n * @memberof config\n * @instance\n * @param {Object} connectivity Connectivity configs.\n * @param {Number} [connectivity.pingInterval=30000] Time in between websocket ping attempts (milliseconds).\n * @param {Number} [connectivity.reconnectLimit=5] Number of failed reconnect attempts before reporting an error. Can be set to 0 to not limit reconnection attempts.\n * @param {Number} [connectivity.reconnectDelay=5000] Base time between websocket reconnect attempts (milliseconds).\n * @param {Number} [connectivity.reconnectTimeMultiplier=1] Reconnect delay multiplier for subsequent attempts. The reconnect delay time will be multiplied by this after each failed reconnect attempt to increase the delay between attempts. eg. 5000ms then 10000ms then 20000ms delay if value is 2.\n * @param {Number} [connectivity.reconnectTimeLimit=640000] Maximum time delay between reconnect attempts (milliseconds). Used in conjunction with the reconnect time multiplier to prevent overly long delays between reconnection attempts.\n * @param {Boolean} [connectivity.autoReconnect=true] Flag to determine whether the SDK will attempt to automatically reconnect after connectivity disruptions.\n * @param {Boolean} [connectivity.checkConnectivity=true] Flag to determine whether the SDK should check connectivity.\n * @param {string} [connectivity.webSocketOAuthMode=none] When set to 'query', the OAuth bearer access token will be appended as a query string parameter to the websocket address.\n */\nexport const defaultValues = {\n  method: connCheckMethods.KEEP_ALIVE,\n  pingInterval: 30000,\n  reconnectLimit: 5,\n  reconnectDelay: 5000,\n  reconnectTimeMultiplier: 1,\n  reconnectTimeLimit: 640000,\n  autoReconnect: true,\n  checkConnectivity: true,\n  webSocketOAuthMode: 'none'\n}\n\n// config validation\nconst v8nValidation = v8n.schema({\n  method: enums([connCheckMethods.KEEP_ALIVE]),\n  pingInterval: v8n.positive(),\n  reconnectLimit: v8n.positive(),\n  reconnectDelay: v8n.positive(),\n  reconnectTimeMultiplier: v8n.positive(),\n  reconnectTimeLimit: v8n.positive(),\n  autoReconnect: v8n.boolean(),\n  checkConnectivity: v8n.boolean(),\n  webSocketOAuthMode: enums(['none', 'query'])\n})\n\n/**\n * Helper: Verifies that the provided options are what is expected by\n *    the plugin. If not, logs info-level warnings.\n * @method checkOptions\n * @param {Object} options An options object, maybe,\n * @returns {undefined}\n */\nexport const checkOptions = parse('connectivity', v8nValidation)\n\n/**\n * Helper: Applies default configs to the provided configs.\n * @method applyDefaults\n * @param {Object} [options] An object of any format.\n * @return {Object} Connectivity Plugin configuration object.\n */\nexport const applyDefaults = (options = {}) => defaults(defaultValues, options)\n","// Connectivity plugin.\nimport pluginInterface from '../interface'\nimport { applyDefaults, checkOptions } from './configs'\nimport createOperations from './operations'\n\n// Connectivity service.\nimport createWebsocketManager from '../wsManager'\nimport { WS_STATUS } from '../wsManager/constants'\n\n// Other plugins.\nimport { update as updateConfig } from '../../config/interface/actions'\n\nimport { connCheckResponsibility } from '../../constants'\n\n/**\n * Connectivity Plugin factory.\n * @param {Object} options Configurations for the plugin.\n * @param {Object} bottle\n * @returns {Object} An instance of the Connectivity plugin.\n */\nexport default function connectivityPlugin(bottle, options = {}) {\n  options = applyDefaults(options)\n  // Parse configs to log any issues with them.\n  checkOptions(options)\n\n  // For backwards compatibility, convert the old style to the new style.\n  // TODO: This should be done inside `applyDefault` or similar.\n  if (typeof options.method === 'string') {\n    const method = options.method\n    options.method = {\n      type: method,\n      // In both old scenarios, the client is responsible.\n      responsibleParty: connCheckResponsibility.CLIENT\n    }\n  }\n\n  /*\n   * Add the plugin's components to the bottle. These are components that other\n   *    components (eg. other plugins, APIs) need access to.\n   */\n  bottle.value('Connectivity', {\n    ...createOperations(bottle.container, createWebsocketManager()),\n    constants: {\n      WS_STATUS\n    }\n  })\n\n  // Add the public API to be bottle.\n  bottle.factory('ConnectivityAPI', pluginInterface.api)\n\n  /*\n   * Set a \"post initialize\" method to be run after the SDK is setup but before\n   *    the application gets access to it.\n   */\n  bottle.defer(container => {\n    // Add the plugin's options to state.\n    container.context.dispatch(updateConfig(options, pluginInterface.name))\n  })\n\n  return {\n    name: pluginInterface.name,\n    reducer: pluginInterface.reducer\n  }\n}\n","// Connectivity plugin.\nimport * as actions from '../interface/actions'\nimport * as eventTypes from '../interface/eventTypes'\nimport { getCheckConnectivity, getConnectivityConfig, getConnectionState } from '../interface/selectors'\nimport { startTebAttempts } from './utils'\n\n// WS Manager.\nimport { WS_STATUS } from '../wsManager/constants'\n\n// Other plugins.\nimport { getConnectionInfo } from '../../auth/interface/selectors'\nimport BasicError, { subscriptionCodes } from '../../errors'\n\n/**\n * Factory for the Connectivity plugin's operations.\n * @method createOperations\n * @param {Object} container All of the components that plugins have added to the bottle.\n * @param {Object} wsManager The websocket manager.\n * @returns {Object}\n */\nexport default function createOperations(container, wsManager) {\n  const { context, emitEvent, logManager, SubscriptionOperations, NotificationsOperations } = container\n  const log = logManager.getLogger('CONNECTIVITY')\n\n  // Register listeners on the WS manager.\n  wsManager.on('message', message => {\n    log.debug('Received message on websocket.', message)\n    onMessage(message)\n  })\n  wsManager.on('close', event => {\n    log.debug(`Websocket closed (wasClean?: ${event.wasClean}; code ${event.code}).`)\n    onClose(event)\n  })\n  wsManager.on('disconnected', err => {\n    log.debug(`Websocket disconnected due to ping error: ${err.message}`)\n    onDisconnect()\n  })\n  wsManager.on('error', () => {\n    log.debug('Websocket disconnected due to error.')\n    onDisconnect()\n  })\n\n  /**\n   * @method connect\n   * @async\n   * @param {Object} wsInfo\n   * @param {boolean} [isReconnect=false]\n   * @returns {Promise<undefined>}\n   * @throws {BasicError}\n   */\n  async function connect(wsInfo, isReconnect = false) {\n    log.info(`${isReconnect ? 'Re-' : ''}Connecting to websocket.`)\n    // Update state for \"connection in-progress\".\n    context.dispatch(actions.wsAttemptConnect(wsInfo))\n    emitEvent(eventTypes.WS_CHANGE, {})\n\n    const connConfig = getConnectivityConfig(context.getState())\n    let shouldCheck = getCheckConnectivity(context.getState())\n    if (typeof shouldCheck === 'undefined') {\n      // If the flag was not explicitly set in state, revert to the config.\n      shouldCheck = connConfig.checkConnectivity\n    }\n\n    try {\n      // The delay between attempts should not be shorter than 2 seconds.\n      const delayTime = connConfig.reconnectDelay > 2000 ? connConfig.reconnectDelay : 2000\n      log.debug(\n        `Attempting ${connConfig.reconnectLimit} connections (delay: ${delayTime}ms, mult.: ${connConfig.reconnectTimeMultiplier}).`\n      )\n\n      // Start attempting to connect the websocket. Will make multiple attempts, with a delay\n      //    between each attempt, until the websocket connects or we reach `maxAttempts`.\n      await startTebAttempts(\n        {\n          taskTimeout: delayTime,\n          attemptDelay: delayTime,\n          delayMultiplier: connConfig.reconnectTimeMultiplier,\n          maxDelay: connConfig.reconnectTimeLimit,\n          maxAttempts: connConfig.reconnectLimit\n        },\n        wsManager.connect,\n        wsInfo\n      )\n\n      if (shouldCheck) {\n        log.info(`Sending websocket pings every ${connConfig.pingInterval}ms.`)\n        // Start sending pings if configured to do so.\n        wsManager.setPinging({\n          message: JSON.stringify({ message_type: 'ping' }),\n          interval: connConfig.pingInterval\n        })\n      }\n    } catch (err) {\n      log.info(`Failed to ${isReconnect ? 're-' : ''}connect websocket after ${connConfig.reconnectLimit} attempts.`)\n      if (!isReconnect) {\n        const error = new BasicError({\n          message: err.message,\n          code: subscriptionCodes.WS_CONNECTION_ERROR\n        })\n        context.dispatch(actions.wsConnectFinished(error))\n        emitEvent(eventTypes.WS_CHANGE, {})\n        throw error\n      } else {\n        // Throw the original error for the reconnect method to handle.\n        throw err\n      }\n    }\n\n    // TechDebt TODO: Proper payload object.\n    context.dispatch(\n      actions.wsConnectFinished({\n        kandy: {\n          ...connConfig,\n          wsInfo\n        },\n        pinging: shouldCheck\n      })\n    )\n    emitEvent(eventTypes.WS_CHANGE, {})\n  }\n\n  /**\n   * @method disconnect\n   * @return {undefined}\n   */\n  function disconnect() {\n    log.info('Disconnecting websocket connection.')\n    try {\n      wsManager.disconnect()\n    } catch (err) {\n      // Even on error, handle it as a succesful disconnect.\n    }\n\n    context.dispatch(actions.wsDisconnectFinished())\n    emitEvent(eventTypes.WS_CHANGE, {})\n  }\n\n  /**\n   * Updates whether the websocket should be sending pings or not.\n   * If there is a connected websocket, update it now. In either case, state should\n   *    be updated for the next time a websocket is connected.\n   * @method setPinging\n   * @param {boolean} shouldPing Whether the websocket should send ping messages or not.\n   * @return {undefined}\n   */\n  function setPinging(shouldPing) {\n    if (wsManager.status === WS_STATUS.CONNECTED) {\n      // Change pinging of the connected websocket.\n      if (wsManager.isPinging && !shouldPing) {\n        log.info('Stopping to send websocket pings.')\n        // Stop pinging.\n        wsManager.setPinging(undefined)\n      } else if (!wsManager.isPinging && shouldPing) {\n        const pingInterval = getConnectivityConfig(context.getState()).pingInterval\n        log.info(`Starting to send websocket pings every ${pingInterval}ms.`)\n        // Start pinging.\n        wsManager.setPinging({\n          message: JSON.stringify({ message_type: 'ping' }),\n          interval: pingInterval\n        })\n      } else {\n        // No change.\n      }\n    }\n  }\n\n  /**\n   * Behaviour for handling a received websocket notification.\n   * @method onMessage\n   * @param {Object} message The parsed websocket mesage.\n   */\n  function onMessage(message) {\n    // Pass the notification to the Notification plugin.\n    NotificationsOperations.processNotification(message, 'WEBSOCKET')\n  }\n\n  /**\n   * Behaviour for handling the websocket closing.\n   * If unexpectedly, try to reconnect.\n   * @method onClose\n   * @param {CloseEvent} data\n   * @return {undefined}\n   */\n  function onClose(data) {\n    if (data.code === 1000) {\n      log.info('Websocket closed normally.')\n      // 1000 signifies a normal closure\n      // Normal websocket close, don't try to reconnect\n      context.dispatch(actions.wsReconnectFailed(undefined, 'link'))\n      SubscriptionOperations.onConnectionLost()\n    } else {\n      onDisconnect()\n    }\n  }\n\n  /**\n   * Behaviour for handling the websocket disconnecting unexpectedly.\n   * For both failing to send a message over the websocket and for the websocket\n   *    closing.\n   * @method onDisconnect\n   * @return {Promise<undefined>}\n   */\n  async function onDisconnect() {\n    const { wsInfo, autoReconnect } = getConnectionState(context.getState())\n    log.info(`Websocket disconnected. (autoReconnect?: ${autoReconnect})`)\n\n    context.dispatch(actions.lostConnection())\n    emitEvent(eventTypes.WS_CHANGE, {})\n\n    if (autoReconnect) {\n      // If using tokens, ensure the URL is using the latest token from state.\n      const { bearerAccessToken } = getConnectionInfo(context.getState())\n      const connConfig = getConnectivityConfig(context.getState())\n      if (bearerAccessToken && connConfig.webSocketOAuthMode === 'query') {\n        wsInfo.params = {\n          access_token: bearerAccessToken\n        }\n      }\n\n      try {\n        await connect(wsInfo, true)\n      } catch (err) {\n        context.dispatch(actions.wsReconnectFailed())\n        SubscriptionOperations.onConnectionLost()\n      }\n    } else {\n      context.dispatch(actions.wsReconnectFailed())\n      SubscriptionOperations.onConnectionLost()\n    }\n  }\n\n  return {\n    connect,\n    disconnect,\n    setPinging\n  }\n}\n","/**\n * Promise-wrapper to time it out after a delay without resolving.\n * @method timedPromise\n * @param {Promise} promise The promise to time.\n * @param {number} [timeout=1000] The delay to wait before timing-out the promise.\n * @returns {Promise}\n */\nexport async function timedPromise(promise, timeout = 1000) {\n  let timeoutId\n  return Promise.race([\n    promise,\n    new Promise((resolve, reject) => {\n      timeoutId = setTimeout(() => {\n        reject(new Error(`Timed-out promise after ${timeout} milliseconds.`))\n      }, timeout)\n    })\n  ]).finally(() => clearTimeout(timeoutId))\n}\n\n/**\n * Generator for a \"Truncated exponential backoff\" sequence.\n * Ref: wikipedia.org/wiki/Exponential_backoff#Truncated_exponential_backoff\n * @method makeTebSequence\n * @param {number} delay\n * @param {Object} [options]\n * @param {Object} [options.multiplier=2] The multiplier for how much to increase subsequent delays.\n * @param {Object} [options.delayLimit=delay*8] The maximum delay value.\n * @param {number} [options.limit] The maximum numbers to generate in the sequence.\n * @return {Generator}\n * @example\n * // Constant sequence with a call limit.\n * const sequenceOne = makeTebSequence(5, { multiplier: 1, limit: 4 })\n * sequenceOne.next() // { value: 5, done: false }\n * sequenceOne.next() // { value: 5, done: false }\n * sequenceOne.next() // { value: 5, done: false }\n * sequenceOne.next() // { value: 5, done: true }\n * sequenceOne.next() // { value: undefined, done: true }\n *\n * // Exponential sequence with a value limit.\n * const sequenceTwo = makeTebSequence(2, { multiplier: 2, delayLimit: 100 })\n * sequenceTwo.next() // { value: 2, done: false }\n * sequenceTwo.next() // { value: 4, done: false }\n * sequenceTwo.next() // { value: 8, done: false }\n * sequenceTwo.next() // { value: 16, done: false }\n * sequenceTwo.next() // { value: 32, done: false }\n * sequenceTwo.next() // { value: 64, done: false }\n * sequenceTwo.next() // { value: 100, done: false }\n * sequenceTwo.next() // { value: 100, done: false }\n */\nexport function* makeTebSequence(delay, options = {}) {\n  const { delayLimit = delay * 8, multiplier = 2, limit } = options\n\n  let iterations = 1\n  let nextDelay = delay\n  while (true) {\n    if (limit && limit <= iterations) {\n      return nextDelay\n    } else {\n      yield nextDelay\n    }\n\n    if (nextDelay < delayLimit) {\n      nextDelay = delay * Math.pow(multiplier, iterations)\n      nextDelay = nextDelay > delayLimit ? delayLimit : nextDelay\n    }\n    iterations++\n  }\n}\n\n/**\n * Utility to wrap an asynchronous task to repeat until it either succeeds or times-out. Repeated attempts\n *    can have a delay between the start of each attempt that follows a configurable \"truncated exponential\n *    backoff\" algorithm.\n * @method startTebAttempts\n * @param {Object} options Configurations for this wrapper.\n * @param {number} [options.maxAttempts=5]\n * @param {number} [options.attemptDelay=1000] The initial delay in milliseconds between attempts.\n * @param {number} [options.delayMultiplier=1] The multiplier to increase the delay between each attempt.\n * @param {number} [options.maxDelay=5000] The maximm delay in milliseconds between attempts.\n * @param {number} [options.taskTimeout=1000] Time in milliseconds to wait for each task attempt.\n * @param {Function} task The task being wrapped.\n * @param {any} [taskParams] Parameters to be provided to the `task` parameter.\n * @return {Promise} Resolves if the task resolves. Rejects if the task never resolves after configured attempts.\n * @example\n * // Task that will succeed.\n * const taskSuccess = (message, more) => console.log(mesage, more)\n * await startTebAttempts(options, taskSuccess, 'A message', '...and more')\n * // logs to console immediately: 'A message ...and more'\n *\n *\n * // Task that will fail.\n * const taskFailure = () => throw new Error('Dummy error.')\n * try {\n *    const options = { maxRepeats: 3, attemptDelay: 100, delayMultiplier: 1 }\n *    await startTebAttempts(options, taskFailure)\n * } catch (err) {\n *    // `taskFailure` will be called 3 times: immediately, after 100ms, then after another 100ms\n *    // err === new Error('Dummy error.)\n * }\n *\n *\n * // Task that will timeout.\n * const taskTimeout = () => new Promise(resolve => {})\n * try {\n *    const options = { taskTimeout: 5, maxRepeats: 4, attemptDelay: 10, delayMultiplier: 2 }\n *    await startTebAttempts(options, taskTimeout)\n * } catch (err) {\n *    // `taskTimeout` will be called 4 times: immediately, after 10ms, then after 20ms, then\n *    //    after 80ms.\n *    // err === new Error('Timed-out after 5 milliseconds.')\n * }\n */\nexport function startTebAttempts(\n  { taskTimeout = 1000, attemptDelay = 1000, delayMultiplier = 1, maxDelay = 5000, maxAttempts = 5 },\n  task,\n  ...taskParams\n) {\n  let nextTimeout\n  // Create the sequence of delays between attempts. Also sets the\n  //    limit for max attempts.\n  const delays = makeTebSequence(attemptDelay, {\n    delayLimit: maxDelay,\n    multiplier: delayMultiplier,\n    limit: maxAttempts\n  })\n\n  return new Promise((resolve, reject) => {\n    attemptTask({ resolve, reject })\n  })\n\n  /**\n   * Somewhat-recursive function to attempt performing the task.\n   * Base-case depends on the scoped `delays` instead of parameters.\n   * @method attemptTask\n   * @param {Object} promise The top-level promise functions.\n   * @param {Function} promise.resolve\n   * @param {Function} promise.reject\n   */\n  async function attemptTask(promise) {\n    const next = delays.next()\n    const lastTask = next.done\n\n    if (!lastTask) {\n      // Start the timer for the next task already. Avoids needing to\n      //    time how long the current attempt takes before starting\n      //    to wait for the next one.\n      nextTimeout = setTimeout(attemptTask, next.value, promise)\n    }\n\n    try {\n      // Ensure `task` is timed-out before the next attempt starts.\n      const lesserDelay = next.value < taskTimeout ? next.value : taskTimeout\n      const result = await timedPromise(task(...taskParams), lesserDelay)\n      clearTimeout(nextTimeout)\n      promise.resolve(result)\n    } catch (err) {\n      if (lastTask) {\n        promise.reject(err)\n      } else {\n        // Else wait for the next setTimeout to trigger.\n      }\n    }\n  }\n}\n","/*\n * Possible states for a websocket.\n */\nexport const WS_STATUS = {\n  CONNECTED: 'CONNECTED',\n  CONNECTING: 'CONNECTING',\n  RECONNECTING: 'RECONNECTING',\n  NO_SOCKET: 'NO_SOCKET'\n}\n","import { openWebsocket, cleanupWebSocket } from '../common/websocket'\nimport { WS_STATUS } from './constants'\n\nimport eventEmitter from 'rbbn-emitter'\n\n/**\n * Component for managing a websocket resource.\n * @returns {Object} The websocket manager.\n */\nexport default function createWebsocketManager() {\n  // The current status of the websocket.\n  let socketStatus = WS_STATUS.NO_SOCKET\n  // The websocket object, when it is connected.\n  let websocket\n  let connectInterrupt = false\n  const emitter = eventEmitter()\n  let pingInterval\n\n  /**\n   * Getter method for websocket status.\n   * @method getStatus\n   * @returns {string} The current status of the websocket.\n   */\n  function getStatus() {\n    return socketStatus\n  }\n\n  /**\n   * Connects a websocket using the provided address parameters.\n   * @method connect\n   * @param {Object} wsInfo Websocket configuration options.\n   * @param {string} wsInfo.protocol Websocket protocol to use.\n   * @param {string} wsInfo.server Websocket hostname.\n   * @param {string} wsInfo.port Websocket port to use.\n   * @param {string} wsInfo.url Websocket notification channel.\n   * @param {Object} [wsInfo.params] A map of key/value pairs of URL params to attach to the websocket.\n   * @returns {Promise} A promise that resolves when the websocket is connected.\n   */\n  function connect(wsInfo) {\n    return new Promise((resolve, reject) => {\n      if (getStatus() !== WS_STATUS.NO_SOCKET) {\n        reject(new Error('Websocket already exists.'))\n        return\n      }\n      socketStatus = WS_STATUS.CONNECTING\n\n      const wsProm = openWebsocket(wsInfo)\n\n      wsProm\n        .then(ws => {\n          socketStatus = WS_STATUS.CONNECTED\n          websocket = ws\n\n          // If the interrupt flag is true, disconnect the websocket immediately.\n          if (connectInterrupt) {\n            connectInterrupt = false\n            disconnect()\n            throw new Error('Websocket connection interrupted by request.')\n          }\n\n          ws.onmessage = message => {\n            let data\n            // Handle messages that are either strings or stringified objects.\n            try {\n              data = JSON.parse(message.data)\n            } catch (err) {\n              data = message.data\n            }\n\n            emitter.emit('message', data)\n          }\n\n          ws.onclose = data => {\n            // Clean-up internally, then report externally.\n            disconnect()\n            emitter.emit('close', data)\n          }\n\n          ws.onerror = err => {\n            // Clean-up internally, then report externally.\n            disconnect()\n            emitter.emit('error', err)\n          }\n\n          resolve()\n        })\n        .catch(err => {\n          socketStatus = WS_STATUS.NO_SOCKET\n          reject(err)\n        })\n    })\n  }\n\n  /**\n   * Disconnects the websocket.\n   * @method disconnect\n   * @return {undefined}\n   * @throws {Error} If no websocket is connected.\n   */\n  function disconnect() {\n    const status = getStatus()\n    if (status === WS_STATUS.CONNECTED) {\n      // Stop pinging.\n      if (pingInterval) {\n        setPinging(undefined)\n      }\n\n      // Clean-up websocket.\n      if (websocket) {\n        cleanupWebSocket(websocket)\n        websocket = undefined\n      }\n      socketStatus = WS_STATUS.NO_SOCKET\n    } else if (status === WS_STATUS.CONNECTING) {\n      // Set the interrupt flag to true.\n      connectInterrupt = true\n    } else {\n      throw new Error('Websocket is not connected.')\n    }\n  }\n\n  /**\n   * Method to start/stop the websocket pinging behaviour.\n   * @method setPinging\n   * @param {Object} [options]\n   * @param {string} [options.message] The message to be sent as a ping.\n   * @param {number} [options.interval] The interval, in milliseconds, to send pings on.\n   * @example\n   * // Start pinging:\n   * wsManager.setPinging({ message: 'ping!', interval: 30000 })\n   *\n   * // Stop pinging:\n   * wsManager.setPinging(undefined)\n   */\n  function setPinging(options) {\n    if (getStatus() !== WS_STATUS.CONNECTED) {\n      // A websocket is required when trying to change pinging.\n      throw new Error('Websocket is not connected.')\n    } else if (pingInterval) {\n      // Pinging is on-going.\n\n      if (options) {\n        // Can't change pinging options once it has started.\n        throw new Error('Websocket is already pinging.')\n      } else {\n        // Clean-up the interval when stopping the pings.\n        stopPinging()\n        return\n      }\n    } else if (!options.message || !options.interval) {\n      throw new Error('All options must be provided to start pinging.')\n    }\n\n    /**\n     * Method for sending a ping and handling possible errors.\n     */\n    function sendPing() {\n      // If WS has disconnected since the last interval, stop pinging quietly.\n      if (getStatus() !== WS_STATUS.CONNECTED) {\n        stopPinging()\n      }\n\n      try {\n        if (websocket && websocket.readyState === 1) {\n          websocket.send(options.message)\n        } else {\n          // Throw an error so all failure scenarios are handled in `catch`.\n          throw new Error('websocket was not in readyState')\n        }\n      } catch (err) {\n        // Websocket is disconnected; stop pinging loudly.\n        stopPinging()\n        disconnect()\n        emitter.emit('disconnected', err)\n      }\n    }\n\n    /*\n     * Method for cleaning-up the ping interval.\n     */\n    function stopPinging() {\n      clearInterval(pingInterval)\n      pingInterval = undefined\n    }\n\n    pingInterval = setInterval(sendPing, options.interval)\n  }\n\n  return {\n    // API methods.\n    connect,\n    disconnect,\n    setPinging,\n\n    // Emitter methods.\n    on: emitter.on,\n    off: emitter.off,\n\n    // API properties.\n    get status() {\n      return getStatus()\n    },\n    get isPinging() {\n      return Boolean(pingInterval)\n    }\n  }\n}\n","export const platforms = {\n  LINK: 'link'\n}\n\nexport const notificationTypes = {\n  WEBSOCKET: 'websocket',\n  PUSH: 'push'\n}\n\nexport const connCheckResponsibility = {\n  CLIENT: 'client',\n  SERVER: 'server'\n}\n\nexport const connCheckMethods = {\n  KEEP_ALIVE: 'keepAlive',\n  PING_PONG: 'pingPong'\n}\n","/**\n * Error codes for the Auth plugin.\n * @name authCodes\n */\nexport const authCodes = {\n  INVALID_CREDENTIALS: 'authentication:1',\n  CONNECT_FAIL_WS_ERROR: 'authentication:2',\n  LINK_UNSUBSCRIBE_FAIL: 'authentication:3',\n  LINK_SUBSCRIBE_FAIL: 'authentication:4',\n  LINK_EXTEND_SUBSCRIPTION_FAIL: 'authentication:5',\n  LINK_UPDATE_SUBSCRIPTION_FAIL: 'authentication:6',\n  INVALID_STATE: 'authentication:7',\n  MISSING_SERVICE: 'authentication:12',\n  LINK_SUBSCRIBE_UNAVAILABLE: 'authentication:13'\n}\n\n/**\n * Error codes for the Call plugin.\n * @name callCodes\n */\nexport const callCodes = {\n  UNKNOWN_ERROR: 'call:1',\n  GENERIC_ERROR: 'call:2',\n  INIT_MEDIA_FAILED: 'call:3',\n  USER_MEDIA_ERROR: 'call:4',\n  NOT_SUPPORTED: 'call:5',\n  // The call is in the wrong state.\n  INVALID_STATE: 'call:6',\n  // A provided parameter is not valid.\n  INVALID_PARAM: 'call:7',\n  // There is a desync between components' state.\n  STATE_DESYNC: 'call:8',\n  // Offer could not be generated\n  INVALID_OFFER: 'call:9',\n  // No ICE candidates found\n  NO_ICE_CANDIDATES: 'call:10',\n  // Failed to recieve answer due to media mismatch\n  SESSION_MISMATCH: 'call:11',\n  GLARE: 'call:12'\n}\n\n/**\n * Error codes for the Call History plugin.\n * @name callHistoryCodes\n */\nexport const callHistoryCodes = {\n  UNKNOWN_ERROR: 'callHistory:1',\n  BAD_REQUEST: 'callHistory:2',\n  NOT_FOUND: 'callHistory:3',\n  NOT_AUTHENTICATED: 'callHistory:4',\n  FORBIDDEN: 'callHistory:5'\n}\n/**\n * @name clickToCallCodes\n */\nexport const clickToCallCodes = {\n  MISSING_ARGS: 'clickToCall:1',\n  RESPONSE_ERROR: 'clickToCall:2'\n}\n/**\n * Error codes for the Groups plugin.\n * @name groupsCodes\n */\nexport const groupsCodes = {\n  UNKNOWN_ERROR: 'groups:1',\n  GENERIC_ERROR: 'groups:2',\n  MISSING_PARAMETERS: 'groups:3'\n}\n\n/**\n * Error codes for the Message plugin.\n * @name messagingCodes\n */\nexport const messagingCodes = {\n  SEND_MESSAGE_FAIL: 'messaging:5'\n}\n\n/**\n * Error codes for the Message Waiting Indicator plugin.\n * @name mwiCodes\n */\nexport const mwiCodes = {\n  FETCH_MWI_FAIL: 'mwi:1'\n}\n\n/**\n * Error codes from the Sip Events plugin.\n * @name sipEventCodes\n */\nexport const sipEventCodes = {\n  UNKNOWN_ERROR: 'sipEvents:1',\n  // The user did not subscribe/connect for the specified sip event service.\n  NOT_PROVISIONED: 'sipEvents:2',\n  // The user is not subscribed for the specified sip event.\n  NOT_SUBSCRIBED: 'sipEvents:3'\n}\n\n/**\n * Error codes for the audio bridge portion of the call plugin.\n * @name bridgeCodes\n */\nexport const bridgeCodes = {\n  UNKNOWN_ERROR: 'audioBridge:1',\n  // TODO: Make \"invalid input\" (and others) a generic code.\n  INVALID_INPUT: 'audioBridge:2',\n  ALREADY_EXISTS: 'audioBridge:3',\n  NOT_FOUND: 'audioBridge:4',\n  NOT_SUPPORTED: 'audioBridge:5',\n  MEDIA_NOT_FOUND: 'audioBridge:6',\n  INVALID_STATE: 'audioBridge:7'\n}\n\n/**\n * Error codes for the subscription plugin.\n * @name subscriptionCodes\n */\nexport const subscriptionCodes = {\n  WS_CONNECTION_ERROR: 'subscription:1',\n  NO_SERVICE_PROVIDED: 'subscription:2',\n  GENERIC_ERROR: 'subscription:3',\n  INVALID_STATE: 'subscription:4'\n}\n\n/**\n * Error codes for the connectivity plugin\n * @name connectivityCodes\n */\nexport const connectivityCodes = {\n  WS_MESSAGE_ERROR: 'connectivity:1'\n}\n\n/**\n * Error codes for the Presence plugin.\n * @name presenceCodes\n */\nexport const presenceCodes = {\n  INVALID_STATUS: 'presence:1',\n  INVALID_ACTIVITY: 'presence:2',\n  INVALID_REQUEST: 'presence:3',\n  INVALID_PARAM: 'presence:4'\n}\n\n/**\n * Error codes for the Users plugin\n * @name usersCodes\n */\nexport const usersCodes = {\n  UNKNOWN: 'users:1',\n  REFRESH_CONTACTS_FAIL: 'users:2',\n  DIRECTORY_REQUEST_FAIL: 'users:3',\n  INVALID_PARAM: 'users:4'\n}\n\n/**\n * Error codes for the Webrtc plugin\n * @name webrtcCodes\n */\nexport const webrtcCodes = {\n  INVALID_PARAM: 'webrtc:1',\n  INVALID_TRACK_ID: 'webrtc:2',\n  TRACK_IN_USE: 'webrtc:3',\n  TRACK_NOT_LOCAL: 'webrtc:4'\n}\n\n/**\n * Error codes for the Proxy plugin\n * @name proxyCodes\n */\nexport const proxyCodes = {\n  INVALID_PARAM: 'proxy:1',\n  SET_PROXY_CHANNEL_FAIL: 'proxy:2',\n  IN_ACTIVE_CALL: 'proxy:3',\n  VERSION_MISMATCH: 'proxy:4',\n  INVALID_STATE: 'proxy:5',\n  TIMEOUT: 'proxy:6',\n  UNKNOWN: 'proxy:7'\n}\n","export const NO_CODE = 'NO_CODE'\n\n/**\n * The Basic Error object. Provides information about an error that occurred in the SDK.\n * @public\n * @static\n * @typedef {Object} BasicError\n * @memberof api\n * @property {string} code The code of the error. If no code is known, this will be 'NO_CODE'.\n * @property {string} message A human-readable message to describe the error. If no message is known, this will be 'An error occurred'.\n */\n\nexport {\n  authCodes,\n  callCodes,\n  callHistoryCodes,\n  groupsCodes,\n  messagingCodes,\n  mwiCodes,\n  sipEventCodes,\n  clickToCallCodes,\n  bridgeCodes,\n  subscriptionCodes,\n  presenceCodes,\n  usersCodes,\n  webrtcCodes,\n  proxyCodes\n} from './codes'\n\nexport default class BasicError {\n  constructor({ message, code }) {\n    this.name = 'BasicError'\n    this.code = code || NO_CODE\n    this.message = message ? `${message}` : 'An error occurred.'\n  }\n}\n","// Events plugin.\nimport pluginInterface from './interface'\n\nimport eventEmitter from 'rbbn-emitter'\n\n/**\n * Event Emitter Implementation.\n * Factory function to create the Event Emitter Implementation.\n * Defines the functionality exposed by an Event Emitter Interface.\n */\nexport default function eventsImplementation(bottle) {\n  // Create the emitter and provide it to the middleware.\n  //    It is created here so that it can also be provided to the bottle.\n  const emitter = eventEmitter()\n\n  // Provide the emit function to the bottle container.\n  //    This function will be provided to other plugins for emitting events.\n  bottle.factory('emitEvent', () => {\n    const log = bottle.container.logManager.getLogger('EVENTS')\n    return function emitEvent(type, args) {\n      log.info(`Emitting event: ${type}`, args)\n      emitter.emit(type, args)\n    }\n  })\n\n  const Events = {\n    on: (eventType, listener) => {\n      emitter.on(eventType, listener)\n    },\n    off: (eventType, listener) => {\n      emitter.off(eventType, listener)\n    },\n    subscribe: listener => {\n      emitter.subscribe(listener)\n    },\n    unsubscribe: listener => {\n      emitter.unsubscribe(listener)\n    }\n  }\n\n  // Provide the Events functions bottle container.\n  bottle.value('Events', Events)\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('EventsAPI', pluginInterface.createAPI)\n\n  return {\n    name: pluginInterface.name,\n    reducer: pluginInterface.reducer\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const EVENTS_ON = PREFIX + 'EVENTS_ON'\nexport const EVENTS_OFF = PREFIX + 'EVENTS_OFF'\nexport const EVENTS_SUBSCRIBE = PREFIX + 'EVENTS_SUBSCRIBE'\nexport const EVENTS_UNSUBSCRIBE = PREFIX + 'EVENTS_UNSUBSCRIBE'\n","import * as actionTypes from './actionTypes'\n\n/* Interface actions */\n\n/**\n * Add a listener for a specified event type.\n *\n * @param {string} type The event type to add the listener on.\n * @param {Function} listener The event listener to be added.\n * @return {Action} action A redux action.\n */\nexport function on(type, listener) {\n  return {\n    type: actionTypes.EVENTS_ON,\n    payload: {\n      eventType: type,\n      listener: listener\n    }\n  }\n}\n\n/**\n * Remove a listener from a specified event type.\n *\n * @param {string} type The event type to remove the listener from.\n * @param {Function} listener The event listener to be removed.\n * @return {Action} action A redux action.\n */\nexport function off(type, listener) {\n  return {\n    type: actionTypes.EVENTS_OFF,\n    payload: {\n      eventType: type,\n      listener: listener\n    }\n  }\n}\n\n/**\n * Add a global event listener.\n *\n * @param {Function} listener The event listener to be added.\n * @return {Action} action A redux action.\n */\nexport function subscribe(listener) {\n  return {\n    type: actionTypes.EVENTS_SUBSCRIBE,\n    payload: listener\n  }\n}\n\n/**\n * Remove a global event listener.\n *\n * @param {Function} listener The event listener to be removed.\n * @return {Action} action A redux action.\n */\nexport function unsubscribe(listener) {\n  return {\n    type: actionTypes.EVENTS_UNSUBSCRIBE,\n    payload: listener\n  }\n}\n","// Actions the interface uses.\nimport { on, off, subscribe, unsubscribe } from './actions'\n\n/**\n * Events APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} Events API.\n */\nexport default function createAPI(container) {\n  const { logManager, context, Events, API_LOG_TAG } = container\n  const log = logManager.getLogger('EVENTS')\n\n  const eventsApi = {\n    /**\n     * Add an event listener for the specified event type. The event is emitted by the SDK instance.\n     *\n     * @public\n     * @memberof api\n     * @method on\n     * @param {string} type The event type for which to add the listener.\n     * @param {Function} listener The listener for the event type. The parameters of the listener depend on the event type.\n     * @example\n     * // Listen for events of a specific type emitted by the SDK.\n     * client.on('dummy:event', function (params) {\n     *    // Handle the event.\n     * })\n     */\n    on: function (type, listener) {\n      log.debug(API_LOG_TAG + 'on: ', type)\n      context.dispatch(on(type, listener))\n      Events.on(type, listener)\n    },\n\n    /**\n     * Removes an event listener for the specified event type. The event is emitted by the SDK instance.\n     *\n     * @public\n     * @memberof api\n     * @method off\n     * @param {string} type The event type for which to remote the listener.\n     * @param {Function} listener The listener to remove.\n     */\n    off: function (type, listener) {\n      log.debug(API_LOG_TAG + 'off: ', type)\n      context.dispatch(off(type, listener))\n      Events.off(type, listener)\n    },\n\n    /**\n     * Adds a global event listener to SDK instance.\n     *\n     * @public\n     * @memberof api\n     * @method subscribe\n     * @param {Function} listener The event listener to add. The parameters are (type, ...args), where args depend on the event type.\n     */\n    subscribe: function (listener) {\n      log.debug(API_LOG_TAG + 'subscribe')\n      context.dispatch(subscribe(listener))\n      Events.subscribe(listener)\n    },\n\n    /**\n     * Removes a global event listener from SDK instance.\n     *\n     * @public\n     * @memberof api\n     * @method unsubscribe\n     * @param {Function} listener The event listener to remove.\n     */\n    unsubscribe: function (listener) {\n      log.debug(API_LOG_TAG + 'unsubscribe')\n      context.dispatch(unsubscribe(listener))\n      Events.unsubscribe(listener)\n    }\n  }\n\n  return eventsApi\n}\n","// Import the components of the interface.\nimport createAPI from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for an events plugin.\n * @type {string}\n */\nconst name = 'events'\n\nexport default {\n  name,\n  createAPI,\n  reducer\n}\n","// Events plugin.\nimport * as actionTypes from './actionTypes'\n\n// Libraries.\nimport { update, add, contains } from 'lodash/fp'\n\nfunction eventReducer(state = { aliases: [], count: 0 }, action) {\n  switch (action.type) {\n    case actionTypes.EVENTS_ON:\n      return update('count', add(1), state)\n    case actionTypes.EVENTS_OFF:\n      return update('count', add(-1), state)\n    default:\n      return state\n  }\n}\n\n/**\n * Reducer for Event Emitter plugin.\n * Defines the events an Event plugin should dispatch to modify state.\n * @param  {Object} [state={}] The events substate.\n * @param  {Object} action     A Flux Standard action.\n * @returns {Object} state      The new event substate.\n */\nexport default function reducer(state = {}, action) {\n  // Only handle event types.\n  if (!contains(action.type, actionTypes)) {\n    return state\n  }\n\n  return {\n    ...state,\n    [action.payload.eventType]: eventReducer(state[action.payload.eventType], action)\n  }\n}\n","// Libraries.\nimport { combineReducers, createStore, applyMiddleware, compose as composeWithoutDevTools } from 'redux'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport { cloneDeep, map, merge } from 'lodash/fp'\nimport Bottle from 'bottlejs'\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\n// Helpers.\nimport { getVersion } from './common/version'\nimport createInterval from './common/helpers/intervalFactory'\n\n// Parse and/or Validate\nimport { validation as v8n, parse } from './common/validation'\n\nconst factoryDefaults = {\n  enableReduxDevTools: false,\n  reduxDevToolsName: 'WebRTC SDK',\n  disableProxy: false\n}\n\n// config validation\nconst v8nValidation = v8n.schema({\n  enableReduxDevTools: v8n.boolean(),\n  reduxDevToolsName: v8n.string(),\n  disableProxy: v8n.boolean()\n})\nconst parseOptions = parse('common', v8nValidation)\n\n/**\n * Creates an instance of the SDK with the specified plugins and configuration.\n *\n * @param {Function[]} pluginFactories - The list of factories to create plugins for this instance of the SDK.\n * @param {Object} [sdkOptions] - Factory and plugin options\n * @param {Object} [sdkOptions.common] - Factory specific options\n * @param {boolean} [sdkOptions.common.enableReduxDevTools] - A flag to indicate whether or not to include Redux Dev Tools\n * @param {string}  [sdkOptions.common.reduxDevToolsName=\"WebRTC SDK\"] - The name of the store that will show up in the\n *                                          Redux Dev tools. This helps differentiate the SDK from other redux instances.\n */\nexport function factory(pluginFactories, sdkOptions = {}) {\n  const version = getVersion()\n\n  // Clone the options so we don't mutate the application's object.\n  const clonedOptions = cloneDeep(sdkOptions)\n  // Separate factory and plugin options.\n  let { common: options, ...pluginOptions } = clonedOptions\n\n  options = mergeValues(factoryDefaults, options)\n  parseOptions(options)\n\n  // Create a bottle which will act as a container for plugin components.\n  const bottle = new Bottle()\n\n  bottle.defer(container => {\n    // Log the SDK's version after the plugins have been initialized.\n    if (container.logManager && container.logManager.getLogger) {\n      const log = container.logManager.getLogger('FACTORY')\n      if (log && log.info) {\n        log.info(`SDK version: ${version}`)\n      }\n    }\n  })\n\n  var store\n  var middlewares = []\n  var reducers = {}\n  var context = {\n    container: bottle.container,\n    capabilities: [],\n    api: {},\n    getState() {\n      if (!store) {\n        throw Error('Store is not available during factory creation')\n      }\n      if (destroyedSDK) {\n        throw Error('State is not available if the SDK has been destroyed')\n      }\n      return store.getState()\n    },\n    dispatch(...args) {\n      if (!store) {\n        throw Error('Store is not available during factory creation')\n      }\n      return store.dispatch(...args)\n    },\n    subscribe(fn) {\n      if (!store) {\n        throw Error('Store is not available during factory creation')\n      }\n      return store.subscribe(fn)\n    }\n  }\n\n  // Add the context to the container so plugins can access it.\n  bottle.value('context', context)\n\n  // Add the interval helper, used to create intervals.\n  bottle.value('createInterval', createInterval)\n\n  // Special case middleware for logging.\n  var loggerMiddleware\n\n  var destroyedSDK = false\n  var destroyedSDKMiddleware = store => next => action => {\n    if (destroyedSDK) {\n      return null\n    } else {\n      return next(action)\n    }\n  }\n\n  // Instantiate the plugins.\n  let plugins = map(function (plugin) {\n    // Make sure the plugin factory is actually a function.\n    if (!plugin || !plugin.fn || typeof plugin.fn !== 'function') {\n      return false\n    }\n\n    // Ignore the Proxy Plugin if not configured to allow it.\n    if (plugin.name === 'proxy' && options.disableProxy) {\n      return false\n    }\n\n    // Provide the bottle to plugin factory functions so they can add their\n    //    components.\n    return plugin.fn(bottle, pluginOptions[plugin.name])\n  }, pluginFactories)\n\n  // Remove undefined plugins. Those are plugins that failed to load for some reason.\n  plugins = plugins.filter(plugin => Boolean(plugin))\n\n  // Run all the plugins to build the context.\n  // Set up each plugin component individually.\n  plugins.forEach(function (plugin) {\n    if (plugin.capabilities) {\n      context.capabilities = context.capabilities.concat(plugin.capabilities)\n    }\n    if (plugin.reducer) {\n      reducers[plugin.name] = plugin.reducer\n    }\n    if (plugin.middleware) {\n      if (plugin.name === 'logs') {\n        loggerMiddleware = plugin.middleware\n      } else {\n        middlewares.push(() => plugin.middleware(context)) // pass context to middleware instead of store\n      }\n    }\n  })\n\n  if (loggerMiddleware) {\n    // The redux logger middleware should be the last middleware.\n    middlewares.push(() => loggerMiddleware(context))\n  }\n\n  // Alias our composeMiddleware to conditionally include devTools as per the provided configuration flag\n  const composeMiddleware = options.enableReduxDevTools\n    ? composeWithDevTools({ name: options.reduxDevToolsName })\n    : composeWithoutDevTools\n\n  // Create the store with the plugins and with the configuration as the initial state.\n  store = createStore(\n    combineReducers(reducers),\n    composeMiddleware(applyMiddleware(destroyedSDKMiddleware, ...middlewares))\n  )\n\n  // Use the plugins' API factories to build the public API.\n  //    Do this after the store has been created.\n  // Plugins have provided their API factory by registering it to the bottle.\n  bottle.list().forEach(name => {\n    // Find API components on the bottle and add them to the SDK API.\n    if (name.toLowerCase().endsWith('api')) {\n      const api = bottle.container[name]\n      context.api = merge(context.api, api)\n    }\n  })\n\n  // Resolve all deferred functions. Provide them the container so they have the\n  //    same parameters as registered components.\n  bottle.resolve(bottle.container)\n\n  // setup the API\n  const publicAPI = {\n    ...context.api,\n    state: {\n      get: function () {\n        return store.getState()\n      },\n      subscribe: function (...args) {\n        return store.subscribe(...args)\n      }\n    },\n    /**\n     * Return all the capabilities currently available to the plugin system.\n     *\n     * @memberof api\n     * @method getCapabilities\n     */\n    getCapabilities() {\n      return context.capabilities\n    },\n    /**\n     * Returns the current version of the API.\n     *\n     * @public\n     * @memberof api\n     * @method getVersion\n     */\n    getVersion() {\n      return version\n    },\n    // Disabling eslint for the next comment as we want to be able to use a disallowed word\n    // eslint-disable-next-line no-warning-comments\n    /**\n     * Destroys the SDK, and removes its state, rendering the SDK unusable.\n     * Useful when a user logs out and their call data needs to be destroyed.\n     * The SDK must be recreated to be usable again.\n     * The destroy command is async, and will happen on the next tick\n     *   so as not to interfere with any ongoing events.\n     *\n     * @public\n     * @memberof api\n     * @method destroy\n     * @example\n     * // Instantiate the SDK.\n     * import { create } from '@rbbn/webrtc-js-sdk'\n     * const config = {\n     *     authentication: { ... },\n     *     logs: { ... },\n     *     ...\n     * }\n     * let client = create(config);\n     * client.on( ... )\n     * // Use the SDK\n     * ...\n     * // Destroy the SDK, then recreate on the next step\n     * client.destroy()\n     * client = create(config)\n     * client.on( ... )\n     */\n    destroy() {\n      // TODO: Is it possible for the store to auto-unsubscribe any listeners\n      //    (from client.state.subscribe API)? If not, may be easier to simply\n      //    protect from issues.\n\n      const _destroy = () => {\n        if (destroyedSDK) return\n\n        // Clear the state\n        function destroyStateReducer(state, action) {\n          return {}\n        }\n        store.replaceReducer(destroyStateReducer)\n\n        // Neuter all actions\n        destroyedSDK = true\n      }\n\n      // setTimeout is necessary so that the destroy\n      //   happens at the start of the next tick for\n      //   when destroy is called inside an event handler\n      const immediately = 0\n      setTimeout(_destroy, immediately)\n    }\n  }\n\n  // Return the public API.\n  return publicAPI\n}\n","/* Helper function for styling logs based on the log type.\n * This function will inspect the log entry and format the log\n * accordingly.\n */\nfunction styleLog(entry) {\n  const { timestamp, level } = entry\n  const logInfo = `${timestamp} - ACTION - ${level}`\n\n  let [logType, payload] = entry.messages\n\n  let prefix\n  let style = ''\n  if (logType.includes('state')) {\n    // If the log is for prev state / next state, display that in the prefix.\n    prefix = `${logInfo} - ${logType.toUpperCase()}`\n  } else if (logType.includes('ADDED') || logType.includes('DELETED') || logType.includes('ARRAY')) {\n    // If the log has added or removed keys from state, log the operation, keys affected and new values.\n    prefix = `${entry.messages[0]}: ${entry.messages[2]}`\n    style = entry.messages[1]\n    payload = entry.messages[3]\n  } else if (logType.includes('CHANGED')) {\n    // If the log has changed keys in state, log the operation, keys, old and new values.\n    prefix = `${entry.messages[0]}: ${entry.messages[2]}`\n    style = entry.messages[1]\n    payload = `${entry.messages[3]} ${entry.messages[4]} ${entry.messages[5]}`\n  } else if (logType.includes('no diff')) {\n    // If action results in no change in state, just log no diff.\n    prefix = `${logInfo} - NO DIFF`\n    payload = ''\n  } else {\n    // Else the log is the action itself, so use the action type.\n    prefix = `${logInfo} - ${payload.type} - ${logType}`\n  }\n\n  return { prefix, style, payload }\n}\n\n/**\n * Default function for the SDK to use for logging actions.\n * Action entries come in 4 different types:\n *    1. start: Log the message directly and \"open the group\".\n *    2. state: Log a prefix, state type, and state itself.\n *      (prev state and next state)\n *    3. payload: Log a prefix, action type, and payload.\n *    4. end: Close the group.\n * @method defaultActionHandler\n * @param  {LogEntry} entry\n */\nexport default function defaultActionHandler(entry) {\n  // Handle the \"start\" and \"stop\" action log entries specifically.\n  if (['group', 'groupCollapsed'].includes(entry.method)) {\n    // eslint-disable-next-line no-console\n    console[entry.method](...entry.messages)\n    return\n  } else if (entry.method === 'groupEnd') {\n    // eslint-disable-next-line no-console\n    console.groupEnd()\n    return\n  }\n\n  const { prefix, style, payload } = styleLog(entry)\n  // eslint-disable-next-line no-console\n  console[entry.method](prefix, style, payload)\n}\n","// Logs plugin.\nimport { logManager } from '../index'\nimport { logLevels } from 'kandy-logger/src/constants'\n// Action specific.\nimport setupTransformers from './transformers'\nimport { titleFormatter } from './utils'\n\n// Libraries.\nimport { createLogger } from 'redux-logger'\n\n/**\n * Creates a redux middleware for logging actions.\n * @method createActionLogger\n * @param  {Object}     options\n * @return {Middleware}\n */\nexport default function createActionLogger(options) {\n  // Create a Logger for handling the action logs.\n  const logger = logManager.getLogger('ACTION')\n  logger.setHandler(options.logActions.handler)\n  logger.setLevel(options.logActions.level)\n\n  const setLevel = logLevels[options.logLevel]\n\n  let actionOptions = {}\n  // Use different options for redux-logger depending on log level.\n  if (setLevel === logLevels.INFO) {\n    // At the INFO level, hide everything except the action name.\n    actionOptions.level = false\n    actionOptions.diff = false\n  } else {\n    // At the DEBUG+ levels, use the configs.\n    actionOptions = {\n      ...options.logActions\n    }\n  }\n\n  if (options.logActions.actionOnly) {\n    // Hide prevState and nextState.\n    // Log action and error at info level, so the browser won't hide it by default.\n    actionOptions.level = {\n      prevState: false,\n      action: 'info',\n      error: 'info',\n      nextState: false\n    }\n  }\n\n  if (options.logActions.excludeActions) {\n    actionOptions.predicate = excludeActions(options.logActions.excludeActions)\n  }\n\n  // ALWAYS use our own logger\n  actionOptions.logger = logger\n  // ALWAYS remove theming/styling from the action log messages\n  actionOptions.titleFormatter = titleFormatter\n  actionOptions.colors = false\n\n  // Setup the transformers based on the options.\n  const transformers = setupTransformers(options.logActions)\n  // Create the logger middleware.\n\n  return createLogger({\n    ...actionOptions,\n    ...transformers\n  })\n}\n\n/**\n * Logger predicate function that will take an array of action types\n * and exclude them from logs\n * @param {Array} actions An array of action types to exclude from logs\n * @returns {function} A predicate function\n */\nfunction excludeActions(actions) {\n  return (getState, action) => !actions.includes(action.type)\n}\n","// Libraries\nimport { omit } from 'lodash/fp'\n\n/**\n * Determines which redux-logger transformers we need based on options.\n * @method setupTransformers\n * @param  {Object} options\n * @return {Object} An object of transformers to be provided to redux-logger.\n */\nexport default function setupTransformers(options) {\n  // A \"pipeline\" of all redux-logger action transformers.\n  function actionPipeline(transformers) {\n    return function (action) {\n      transformers.forEach(function (transformer) {\n        action = transformer(action)\n      })\n      return action\n    }\n  }\n\n  const transformers = {}\n  const actionTransformers = []\n  if (!options.exposePayloads) {\n    // If exposePayloads is disabled, include the removePayloads transformer\n    actionTransformers.push(removePayloads)\n  } else {\n    // Otherwise, we should still hide passwords\n    actionTransformers.push(passwordHider)\n  }\n  // Create the actionTransformer pipeline with the included transformers.\n  transformers.actionTransformer = actionPipeline(actionTransformers)\n\n  return transformers\n}\n\n// Redux-logger actionTransformer to prevent passwords from being logged.\nfunction passwordHider(action) {\n  if (action.meta && action.meta.isSensitive) {\n    // Only log the action name for actions that have sensitive data in them.\n    return omit('payload', action)\n  }\n  return action\n}\n\n/**\n * Helper function removes secure data if secure mode is enabled\n * @param {Object} action\n */\nfunction removePayloads(action) {\n  if (!(action.meta && action.meta.isSafe)) {\n    return omit('payload', action)\n  }\n  return action\n}\n","/**\n * Standard title formatter function is almost identical to the defaultTitleFormatter found in redux-logger\n * but removes placeholder characters previously used for styling, which is not being used in the logging\n * configuration\n *\n * @param action\n * @param time\n * @param took\n * @returns {string}\n */\nexport function titleFormatter(action, time, took) {\n  var parts = ['action']\n  parts.push(action.type)\n  parts.push('@ ' + time)\n  parts.push('(in ' + took.toFixed(2) + ' ms)')\n\n  return parts.join(' ')\n}\n","import defaultActionHandler from './actions/actionHandler'\n\n/**\n * Configuration options for the Logs feature.\n *\n * The SDK will log information about the operations it is performing. The\n *    amount of information will depend on how the Logs feature is configured.\n *\n * The format of logs can also be customized by providing a\n *    {@link logger.LogHandler LogHandler}. This function will receive a\n *    {@link logger.LogEntry LogEntry} which it can handle as it sees fit. By\n *    default, the SDK will log information to the console. For more\n *    information, see the {@link logger Logs feature} description.\n *\n * @public\n * @static\n * @name config.logs\n * @memberof config\n * @requires logs\n * @instance\n * @param {Object} logs Logs configs.\n * @param {string} [logs.logLevel='debug'] Log level to be set. See {@link logger.levels}.\n * @param {logger.LogHandler} [logs.handler] The function to receive log entries from the\n *    SDK. If not provided, a default handler will be used that logs entries\n *    to the console.\n * @param {Object|boolean} [logs.logActions=false] Options specifically for action logs when\n *    logLevel is at DEBUG+ levels. Set this to false to not output action logs.\n * @param {logger.LogHandler} [logs.logActions.handler] The function to receive action\n *    log entries from the SDK. If not provided, a default handler will be used\n *    that logs actions to the console.\n * @param {boolean} [logs.logActions.actionOnly=false] Only output information\n *    about the action itself. Omits the SDK context for when it occurred.\n * @param {boolean} [logs.logActions.collapsed=false] Whether logs should be\n *    minimized when initially output. The full log is still output and can be\n *    inspected on the console.\n * @param {boolean} [logs.logActions.diff=false] Include a diff of what SDK\n *    context was changed by the action.\n * @param {string}  [logs.logActions.level='debug'] Log level to be set\n *    on the action logs\n * @param {boolean} [logs.logActions.exposePayloads=true] Allow action payloads\n *    to be exposed in the logs, potentially displaying sensitive information.\n */\nexport const defaultOptions = {\n  logLevel: 'debug',\n  handler: undefined,\n  logActions: false\n}\n\nexport const partialDefaultLogActions = {\n  handler: defaultActionHandler,\n  actionOnly: false,\n  collapsed: false,\n  diff: false,\n  level: 'debug',\n  exposePayloads: true\n}\n/*\n * TODO: Figure out a way to work around this.\n * Can't use validation in logging because validation uses logging to output errors.\n * Circular dependency, have to refactor.\n * Code:\n ```javascript\n// Parse and/or Validate\n// import { enums, validation as v8n, parse } from '../common/validation'\nconst defaultValidation = v8n.schema({\n  logLevel: enums(['silent', 'error', 'warn', 'info', 'debug']),\n  handler: v8n.optional(v8n.function()),\n  logActions: v8n.optional(\n    v8n.passesAnyOf(\n      v8n.schema({\n        handler: v8n.optional(v8n.function()),\n        actionOnly: v8n.boolean(),\n        collapsed: v8n.boolean(),\n        diff: v8n.boolean(),\n        exposePayloads: v8n.boolean()\n      }),\n      // OR\n      v8n.boolean()\n    )\n  )\n})\n\nexport const parseLogConfig = parse('logger', defaultValidation)\n```\n*/\n","import createManager from 'kandy-logger'\nimport { defaultOptions } from './config'\n\n// Logs generated as a result of invoking the public API will contain this tag\nexport const API_LOG_TAG = 'API invoked: '\n\n/**\n * Create the LogManager right away so that it is available. The SDK has not\n *    been instantiated yet, so we have to use the default options until we get\n *    the application's configs.\n */\n/**\n * TODO: There is a technical debt associated with having a loggerManager along with it's\n * loggers created at the global scope. Multiple instances of the SDK would end up sharing\n * the log manager and therefore loggers.\n */\nconst manager = createManager(defaultOptions)\nexport const logManager = manager\n","const prefix = '@@KANDY/LOGS/'\n\nexport const SET_LEVEL = prefix + 'SET_LEVEL'\nexport const LEVELS_CHANGE = prefix + 'LEVELS_CHANGE'\n\nexport const SET_HANDLER = prefix + 'SET_HANDLER'\nexport const HANDLERS_CHANGE = prefix + 'HANDLERS_CHANGE'\n","// Logs plugin.\nimport * as actionTypes from './actionTypes'\n\n/**\n * Action for setting a Logger's level.\n * @method setLevel\n * @param  {string} level  The level to be set.\n * @param  {string} [type] The type of Logger to set it for.\n */\nexport function setLevel(level, type) {\n  return {\n    type: actionTypes.SET_LEVEL,\n    payload: { level, type }\n  }\n}\n\n/**\n * Action for setting all of the Loggers' log level.\n * @method levelsChanged\n * @param  {Object} levelMap Mapping of logger type to level.\n * @return {Object}\n */\nexport function levelsChanged(levelMap) {\n  return {\n    type: actionTypes.LEVELS_CHANGE,\n    payload: levelMap\n  }\n}\n\n/**\n * Action for setting a Logger's handler.\n * @method setHandler\n * @param  {Function} handler A LogHandler function.\n * @param  {string}   [type]  The type of Logger to set it for.\n */\nexport function setHandler(handler, type) {\n  return {\n    type: actionTypes.SET_HANDLER,\n    payload: { handler, type }\n  }\n}\n\n/**\n * Action for setting all of the Loggers' log handler.\n * @method handlersChanged\n * @param  {Object} handlerMap Mapping of logger type to handler.\n * @return {Object}\n */\nexport function handlersChanged(handlerMap) {\n  return {\n    type: actionTypes.HANDLERS_CHANGE,\n    payload: handlerMap\n  }\n}\n","import * as actions from './actions'\nimport { getLevel, getTypes } from './selectors'\n\n/**\n * The SDK has an internal logging system for providing information about its\n *    behaviour. The SDK will generate logs, at different levels for different\n *    types of information, which are routed to a\n *    \"{@link logger.LogHandler Log Handler}\" for consumption. An application\n *    can provide their own Log Handler (see\n *    {@link #configconfiglogs config.logs}) to customize how the logs are\n *    handled, or allow the default Log Handler to print the logs to the\n *    console.\n *\n * The SDK's default Log Handler is merely a thin wrapper around the browser's\n *    console API (ie. `window.console`). It receives the log generated by the\n *    SDK, called a \"{@link logger.LogEntry Log Entry}\", formats a\n *    human-readable message with it, then uses the console to log it at the\n *    appropriate level. This is important to be aware of, since your browser's\n *    console may affect how you see the SDK's default log messages. Since the\n *    default Log Handler uses the console's levels, the browser may filter\n *    which messages are shown depending on which levels it has configured. For\n *    a user that understands console log levels, this can be helpful for\n *    filtering the logs to only the relevant information. But it can equally\n *    be a hindrance by hiding the more detailed log messages (at the 'debug'\n *    level), since browser can have this level hidden by default. For this\n *    reason, we recommend providing a custom Log Handler to the SDK that is\n *    better suited for your application and its users.\n *\n * @public\n * @namespace logger\n * @requires logs\n */\n/**\n * Call Logs API factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} API.\n */\nexport default function createAPI(container) {\n  const { context, LogsOperations: operations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('LOGS')\n\n  const logsApi = {\n    /**\n     * Possible levels for the SDK logger.\n     *\n     * The SDK will provide {@link logger.LogEntry Log Entries} to the\n     *    {@link logger.LogHandler Log Handler} for all logs at or above the set\n     *    log level. 'debug' is considered the lowest level and 'silent' the\n     *    highest level. For example, if the current level is 'info', then the\n     *    {@link logger.LogHandler Log Handler} will receive\n     *    {@link logger.LogEntry Log Entries} for logs at 'info', 'warn', and\n     *    'error', but not for the 'debug' level.\n     * @public\n     * @static\n     * @memberof logger\n     * @method levels\n     * @property {string} SILENT Nothing will be logged.\n     * @property {string} ERROR Unhandled error information will be logged. If\n     *    the SDK encounters an issue it cannot resolve, the error will be included\n     *    in the logs. This likely points to an issue with the SDK itself or an\n     *    issue with how the SDK is being used.\n     * @property {string} WARN Warning messages for the application developer will\n     *    be logged. If the SDK encounters an issue that it can recover and continue,\n     *    a warning about the issue will be included in the logs. These logs point\n     *    to issues that need to be handled by the application. For example, providing\n     *    an invalid configuration to the SDK will cause a warning log that explains\n     *    the issue.\n     * @property {string} INFO General information about the SDK's operations will\n     *    be logged, outlining how the SDK is handling the operations. Reading through\n     *    these logs should provide a high-level view of what the SDK is doing,\n     *    and why it is doing it.\n     * @property {string} DEBUG Detailed information about the SDK's operations,\n     *    meant for debugging issues, will be logged. Specific information and relevant\n     *    operation data are provided for understanding the scenario that the SDK\n     *    was in during the operation.\n     */\n    levels: {\n      SILENT: 'silent',\n      ERROR: 'error',\n      WARN: 'warn',\n      INFO: 'info',\n      DEBUG: 'debug'\n    },\n\n    /**\n     * Update the log level used by the SDK's loggers.\n     *\n     * Changing the log level will affect the amount of logs that the SDK will\n     *    output for debugging purposes.\n     *\n     * See {@link logger.levels} for valid log levels. Other values will not be\n     *    accepted. See the {@link logger.getTypes} API for valid logger types.\n     *    Other values will have no affect.\n     * @private\n     * @static\n     * @memberof logger\n     * @method setLevel\n     * @param  {string} level The log level to set.\n     * @param  {string} [type] An optional subset of loggers to update.\n     * @example\n     * // Set logs to be at the warn level.\n     * client.logger.setLevel(client.logger.levels.WARN)\n     */\n    async setLevel(level, type) {\n      log.debug(API_LOG_TAG + 'logger.setLevel: ', level, type)\n\n      // Backwards compatibility: Dispatch this action at the start of the operation\n      //    because that's what the old API does. But because we're not using actions\n      //    to trigger sagas here, this doesn't actually do anything.\n      context.dispatch(actions.setLevel(level, type))\n\n      try {\n        await operations.setLogLevel(level, type)\n      } catch (error) {\n        log.error(error.message)\n      }\n    },\n\n    /**\n     * Get the currently set log level used by the SDK's loggers.\n     *\n     * @private\n     * @static\n     * @memberof logger\n     * @method getLevel\n     * @param  {string} [type] An optional subset of loggers.\n     * @return {logger.levels} A log level.\n     */\n    getLevel(type) {\n      log.debug(API_LOG_TAG + 'logger.getLevel: ', type)\n      return getLevel(context.getState(), type)\n    },\n\n    /**\n     * Updates the {@link logger.LogHandler LogHandler} used by the SDK's\n     *    loggers.\n     *\n     * Changing the log handler will change how the SDK's logs are handled by\n     *    the application.\n     *\n     * See {@link logger.LogHandler} and {@link logger.LogEntry} for information\n     *    about the handler. See the {@link logger.getTypes} API for valid\n     *    logger types. Other values will have no affect.\n     * @private\n     * @static\n     * @memberof logger\n     * @method setHandler\n     * @param  {logger.LogEntry} handler A {@link logger.LogHandler} function.\n     * @param  {string}   [type] An optional subset of loggers to update.\n     * @example\n     * // Change the SDK's Log Handler to a custom function.\n     * client.logger.setHandler((logEntry) => {\n     *    // Handle the SDK's logs in a custom way.\n     *    ...\n     * })\n     *\n     */\n    async setHandler(handler, type) {\n      log.debug(API_LOG_TAG + 'logger.setHandler: ', handler, type)\n\n      // Backwards compatibility: Dispatch this action at the start of the operation\n      //    because that's what the old API does. But because we're not using actions\n      //    to trigger sagas here, this doesn't actually do anything.\n      context.dispatch(actions.setHandler(handler, type))\n\n      try {\n        await operations.setLogHandler(handler, type)\n      } catch (error) {\n        log.error(error.message)\n      }\n    },\n\n    /**\n     * Get the list of logger types used by the SDK.\n     *\n     * Logs for different SDK features can be managed separately from one\n     *    another by specifying the type when using the {@link logger.setLevel}\n     *    and {@link logger.setHandler} APIs.\n     * @private\n     * @static\n     * @memberof logger\n     * @method getTypes\n     * @return {Array<string>} Logger types.\n     * @example\n     * const types = client.logger.getTypes()\n     * // types: ['DEFAULT', 'AUTH', 'CALL', ...]\n     *\n     * // Set the Call logs to be at the debug level.\n     * client.logger.setLevel('DEBUG', 'CALL')\n     */\n    getTypes() {\n      log.debug(API_LOG_TAG + 'logger.getTypes')\n      return getTypes(context.getState())\n    }\n  }\n\n  return {\n    logger: logsApi\n  }\n}\n","import createAPI from './api'\nimport reducer from './reducers'\n\nconst name = 'logs'\n\nexport { name, createAPI, reducer }\n","import * as actionTypes from './actionTypes'\n\n// Libraries\nimport { handleActions } from 'redux-actions'\n\n/**\n * Logs state is a mapping between every Logger type (and the default type)\n *    and its set log level.\n * eg. {\n *    DEFAULT: 'DEBUG',\n *    AUTH: 'DEBUG',\n *    CALL: 'INFO',\n *    ...\n * }\n */\n\nconst reducers = {}\n\nreducers[actionTypes.LEVELS_CHANGE] = {\n  next(state, action) {\n    // Replace all levels that have been changed.\n    return {\n      ...state,\n      ...action.payload\n    }\n  }\n}\n\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","// Libraries.\nimport { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves the log level for a specified logger type, or the default level.\n * @method getLevel\n * @param  {Object} state            SDK redux state.\n * @param  {String} [type='DEFAULT'] A type of Logger.\n * @return {string} A log level.\n */\nexport function getLevel(state, type = 'DEFAULT') {\n  const clonedState = cloneDeep(state)\n  return clonedState.logs[type]\n}\n\n/**\n * Retrieves a list of all of the SDK's Logger types.\n * @method getTypes\n * @param  {Object} state  SDK redux state.\n * @return {Array<string>}\n */\nexport function getTypes(state) {\n  const clonedState = cloneDeep(state)\n  return Object.keys(clonedState.logs)\n}\n","// The SDK's name for the default/global log level.\nconst defaultType = 'DEFAULT'\n\n/**\n * Helper function.\n * Gets the log levels for every Logger type (and default).\n * @method getLevelMap\n * @return {Object} Mapping of Logger type to its log level.\n */\nexport function getLevelMap(logManager) {\n  // Get unique types from all Loggers.\n  const loggers = logManager.getLoggers()\n  const types = [...new Set(loggers.map(logger => logger.type))]\n\n  const levels = {}\n  // Add the default level to the beginning.\n  levels[defaultType] = logManager.getLevel()\n\n  // Get the level for each Logger type.\n  types.forEach(type => {\n    levels[type] = logManager.getLevel(type)\n  })\n\n  return levels\n}\n\n/**\n * Helper function.\n * Gets the log handler for every Logger type (and default).\n * @method getHandlerMap\n * @return {Object} Mapping of Logger type to its log handler.\n */\nexport function getHandlerMap(logManager) {\n  // Get unique types from all Loggers.\n  const loggers = logManager.getLoggers()\n  const types = [...new Set(loggers.map(logger => logger.type))]\n\n  const handlers = {}\n  // Add the default level to the beginning.\n  handlers[defaultType] = logManager.getHandler()\n\n  // Get the handler for each Logger type.\n  types.forEach(type => {\n    handlers[type] = logManager.getHandler(type)\n  })\n\n  return handlers\n}\n","import * as actions from './interface/actions'\nimport { getLevelMap, getHandlerMap } from './interface/utils'\n\n/**\n * Logs Operations factory function.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for Logs.\n */\nexport default function createOperations(container) {\n  const { context, logManager } = container\n\n  // The SDK's name for the default/global log level.\n  const defaultType = 'DEFAULT'\n\n  /**\n   * Operation to setup log level (either for a specific logger type or implicitly for the DEFAULT type).\n   * @method setLogLevel\n   * @param  {string} level The log level to be set.\n   * @param  {string} [type] The type of logger which will use that log level.\n   *   If not specified, the DEFAULT logger will use it.\n   */\n  async function setLogLevel(level, type) {\n    if (!type || type === defaultType) {\n      // Update the Manager's default level.\n      logManager.setLevel(level)\n      // Update all Loggers' levels.\n      logManager.getLoggers().forEach(logger => {\n        logger.setLevel(level)\n      })\n\n      // Update all Logger levels in state, because changing the default level\n      //    will affect all Loggers without their own explicit level set.\n      context.dispatch(actions.levelsChanged(getLevelMap(logManager)))\n    } else {\n      // Update the Manager's default level for this type.\n      logManager.setLevel(type, level)\n      // Update all Loggers of this type.\n      logManager.getLoggers(type).forEach(logger => {\n        logger.setLevel(level)\n      })\n\n      // Update the one type's level in state.\n      context.dispatch(actions.levelsChanged({ [type]: level }))\n    }\n  }\n\n  /**\n   * Operation to setup a custom log handler (either for a specific logger type or implicitly for the DEFAULT type).\n   * @method setLogLevel\n   * @param  {string} handler The log handler function to be set.\n   *   This will be the function invoked when SDK logs something (for that logger type or for DEFAULT type)\n   * @param  {string} [type] The type of logger whose loggin activity which will trigger that handler function.\n   *   If not specified, the DEFAULT logger will trigger that handler.\n   */\n  async function setLogHandler(handler, type) {\n    if (!type || type === defaultType) {\n      // Update the Manager's default level.\n      logManager.setHandler(handler)\n      // Update all Loggers' handlers.\n      logManager.getLoggers().forEach(logger => {\n        logger.setHandler(handler)\n      })\n\n      // Notify that all Logger handlers [may] have changed (because changing\n      //    the default handler will affect all Loggers without their own\n      //    handler explicitly set).\n      context.dispatch(actions.handlersChanged(getHandlerMap(logManager)))\n    } else {\n      // Update the Manager's default handler for this type.\n      logManager.setHandler(type, handler)\n      // Update all Loggers of this type.\n      logManager.getLoggers(type).forEach(logger => {\n        logger.setHandler(handler)\n      })\n\n      // Notify that the one type's handler has changed.\n      context.dispatch(actions.handlersChanged({ [type]: handler }))\n    }\n  }\n\n  return {\n    setLogLevel,\n    setLogHandler\n  }\n}\n","/**\nNote regarding this file's name:\n\nUsually plugins factories are in the index.js file of their corresponding folder.\nThis used to be the case. However this file was also being used to host the logManager\nthat is being used with the SDK.\n\nSince the logManager is being included in almost every file it was preferable to rename this\nfile rather than point 100s of files to a new place for the logManager.\n**/\n\n// Logs plugin.\nimport { name, reducer, createAPI } from './interface'\nimport * as actions from './interface/actions'\nimport { getLevelMap } from './interface/utils'\nimport createOperations from './operations'\n\nimport { defaultOptions, partialDefaultLogActions } from './config'\nimport createActionLogger from './actions'\n\n// Other plugins.\nimport { update as updateConfig } from '../config/interface/actions'\n\n// Libraries.\nimport mergeValues from '@rbbn/utilities/mergeValues'\nimport { logLevels } from 'kandy-logger'\n\nimport { logManager, API_LOG_TAG } from './index'\n\n// Include the extra JSDoc items.\nimport './docs'\n\n/**\n * Logs plugin factory.\n * @method logsFactory\n */\nexport default function logsFactory(bottle, options = {}) {\n  // Register the logManager with the bottle so that other plugins have access to it.\n  // Log Manager needs to be registered before registering LogsAPI (below) because the API will\n  // try to get a logger, as part of its own initialization.\n  bottle.value('logManager', logManager)\n  bottle.constant('API_LOG_TAG', API_LOG_TAG)\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('LogsAPI', createAPI)\n  bottle.factory('LogsOperations', createOperations)\n\n  const logger = logManager.getLogger('LOGS')\n\n  // Make sure the configured log handler was a function.\n  if (options.handler && typeof options.handler !== 'function') {\n    delete options.handler\n    logger.warn('Invalid log handler configuration provided; using default instead.')\n  }\n\n  // Make sure configured log level is supported.\n  if (options.logLevel && !Object.keys(logLevels).includes(options.logLevel.toUpperCase())) {\n    delete options.logLevel\n    logger.warn('Invalid log level configuration provided; using default instead.')\n  }\n\n  options = mergeValues(defaultOptions, options)\n\n  // Check if `logActions` is true and apply defaults for action logging\n  if (options.logActions !== false) {\n    if (options.logActions instanceof Object) {\n      options.logActions = mergeValues(partialDefaultLogActions, options.logActions)\n    } else {\n      options.logActions = partialDefaultLogActions\n    }\n  }\n\n  // Now that we have the application's log configs, update everything to\n  //    use those values instead of default values.\n  logManager.setLevel(options.logLevel)\n  if (options.handler) {\n    logManager.setHandler(options.handler)\n  }\n\n  Object.values(logManager.getLoggers()).forEach(logger => {\n    logger.setLevel(options.logLevel)\n    if (options.handler) {\n      logger.setHandler(options.handler)\n    }\n  })\n\n  /*\n   * Init function to setup the Logs plugin.\n   * It should be the first plugin to be initialized.\n   */\n  function initPlugin(container) {\n    const { context, WebRTC } = container\n\n    // Send the provided options to the store.\n    // This will be `state.config[name]`.\n    context.dispatch(updateConfig(options, name))\n\n    // Update state with the initial Logger levels.\n    context.dispatch(actions.levelsChanged(getLevelMap(logManager)))\n\n    // Ensure the webRTC object exists.\n    if (WebRTC) {\n      // Update everything to\n      //    use those values from the application configs instead of default values in the webrtc Stack.\n      const webRTCLogManager = WebRTC.logs\n      if (options.handler) {\n        webRTCLogManager.setHandler(options.handler)\n      }\n      Object.values(webRTCLogManager.getLoggers()).forEach(logger => {\n        logger.setLevel(options.logLevel)\n        if (options.handler) {\n          logger.setHandler(options.handler)\n        }\n      })\n    }\n  }\n\n  const components = {\n    name,\n    capabilities: ['logs'],\n    reducer\n  }\n\n  options.logLevel = options.logLevel.toUpperCase()\n  const setLevel = logLevels[options.logLevel]\n  // Consider actions to be at the INFO log level.\n  // Only export a middleware (for actions) at the appropriate levels.\n  if (setLevel <= logLevels.INFO && options.logActions !== false) {\n    components.middleware = createActionLogger(options)\n  }\n  bottle.defer(initPlugin)\n\n  return components\n}\n","const PREFIX = '@@KANDY/'\n\nexport const CREATE_CONVERSATION = PREFIX + 'CREATE_CONVERSATION'\nexport const SEND_MESSAGE = PREFIX + 'SEND_MESSAGE'\nexport const SEND_MESSAGE_FINISH = PREFIX + 'SEND_MESSAGE_FINISH'\nexport const MESSAGE_RECEIVED = PREFIX + 'MESSAGE_RECEIVED'\nexport const INCOMING_MESSAGE_READ = PREFIX + 'INCOMING_MESSAGE_READ'\nexport const SEND_MESSAGE_READ = PREFIX + 'SEND_MESSAGE_READ'\nexport const SEND_MESSAGE_READ_FINISH = PREFIX + 'SEND_MESSAGE_READ_FINISH'\n\nexport const CLEAR_MESSAGES = PREFIX + 'CLEAR_MESSAGES'\nexport const CLEAR_MESSAGES_FINISH = PREFIX + 'CLEAR_MESSAGES_FINISH'\n\nexport const DELETE_CONVERSATION = PREFIX + 'DELETE_CONVERSATION'\nexport const DELETE_CONVERSATION_FINISH = PREFIX + 'DELETE_CONVERSATION_FINISH'\n\nexport const DELETE_MESSAGE = PREFIX + 'DELETE_MESSAGES'\nexport const DELETE_MESSAGE_FINISH = PREFIX + 'DELETE_MESSAGES_FINISH'\n\nexport const FETCH_CONVERSATIONS = PREFIX + 'FETCH_CONVERSATIONS'\nexport const FETCH_CONVERSATIONS_FINISHED = PREFIX + 'FETCH_CONVERSATIONS_FINISHED'\n\nexport const UPDATE_CONVERSATION = PREFIX + 'UPDATE_CONVERSATION'\n\nexport const FETCH_MESSAGES = PREFIX + 'FETCH_MESSAGES'\nexport const FETCH_MESSAGES_FINISHED = PREFIX + 'FETCH_MESSAGES_FINISHED'\n\nexport const FILE_UPLOAD_FAIL = PREFIX + 'FILE_UPLOAD_FAIL'\n","import * as actionTypes from '../actionTypes'\n\n/**\n * Conversation actions.\n * Actions relating to the creation/management of conversation objects.\n */\n\n/**\n * Creates a create conversation action. Triggered when the user creates a new conversation object.\n *\n * @method createConversation\n * @param {Array<string>} destination An array of destinations for messages created in this conversation.\n * Currently, only one destination is supported.\n * @param {Object} options The options object can contain any keys an app may want passed along into the conversation object in the store.\n * @returns {Object} A flux standard action representing the create conversation action.\n */\nexport function createConversation(destination, options) {\n  return {\n    type: actionTypes.CREATE_CONVERSATION,\n    payload: {\n      destination: destination,\n      messages: [],\n      isTypingList: [],\n      ...options\n    }\n  }\n}\n\n/**\n * Creates a fetch conversations action. This is dispatched by the API directly.\n * @param {Object} [options] An optional configuration object to query for more specific results. If no object is passed, all threads will be retrieved\n * @method fetchConversations\n * @returns {Object} A flux standard action representing the fetch conversations action.\n */\nexport function fetchConversations(options) {\n  return {\n    type: actionTypes.FETCH_CONVERSATIONS,\n    payload: {\n      ...options\n    }\n  }\n}\n\n/**\n * Creates a fetch conversations finished action.\n * @method fetchConversationsFinished\n * @param {Object} $0\n * @param {Array<Object>} [$0.conversations] An array of conversation objects, if fetch was successful\n * @param {Object} [$0.error] An error object, only included if fetchConversations implementation had an error.\n * @returns {Object} A flux standard action representing the fetch conversations finished action.\n */\nexport function fetchConversationsFinished({ conversations, error }) {\n  return {\n    type: actionTypes.FETCH_CONVERSATIONS_FINISHED,\n    payload: error || { conversations },\n    error: Boolean(error)\n  }\n}\n\n/**\n * Creates an update conversation action.\n *\n * @method updateConversation\n * @param {Object} conversation The conversation object\n * @param {Array<string>} conversation.destination An array of strings representing the destinations for messages that are sent from this conversation object.\n * Currently, only one destination is supported.\n * This property is always required, as it is the primary property by which conversations are organized in messaging plugin\n * @param {number} [conversation.id] The conversation object's corresponding thread ID\n * @param {string} [conversation.type] The conversation type, which is expected to be one of: \"im\", \"sms\".\n * @returns {Object} A flux standard action representing the create conversation action.\n */\nexport function updateConversation(conversation) {\n  return {\n    type: actionTypes.UPDATE_CONVERSATION,\n    payload: conversation\n  }\n}\n\n/**\n * Request to delete all the messages from a conversation.\n * @method deleteConversation\n * @param  {string} destination The destination for messages created in this conversation.\n * @param {string} type The type of conversation: can be one of \"im\", \"sms\".\n * @returns {Object} A flux standard action.\n */\nexport function deleteConversation(destination, type) {\n  return {\n    type: actionTypes.DELETE_CONVERSATION,\n    payload: {\n      destination: destination,\n      type: type\n    }\n  }\n}\n\n/**\n * Creates a fetch messages finished action.\n * @method deleteConversationFinish\n * @param {Object} $0\n * @param {Array<string>} $0.destination An array of destinations for messages created in this conversation.\n * @param {string} $0.type The type of conversation: can be one of \"im\", \"sms\".\n * @param {Object} [$0.error] An error object, only present if an error occurred.\n * @returns {Object} A flux standard action representing the fetch messages finished action.\n */\nexport function deleteConversationFinish({ destination, type, error }) {\n  return {\n    type: actionTypes.DELETE_CONVERSATION_FINISH,\n    payload: error || { destination, type },\n    error: !!error\n  }\n}\n","import * as messageActionsImport from './messages'\nimport * as convoActionsImport from './conversations'\n// Apparently the following doesn't work:\n//      export * as newName from './place';\n// So import everything from each file, then re-export.\n\n/**\n * The messaging plugin's actions are organized into three types:\n *  - message actions: those which act on message object,\n *  - convo actions: those which act on conversation objects,\n */\nexport const messageActions = messageActionsImport\nexport const convoActions = convoActionsImport\n","import * as actionTypes from '../actionTypes'\n\n/**\n * Action helper functions.\n */\n\nfunction sendMessageHelper(actionType, destination, parts, timestamp, type, id) {\n  return {\n    type: actionType,\n    payload: {\n      destination,\n      id: id,\n      message: {\n        timestamp,\n        isPending: true,\n        read: false,\n        parts,\n        type\n      }\n    }\n  }\n}\n\nfunction messageReadHelper(actionType, messageId, participant) {\n  return {\n    type: actionType,\n    payload: { messageId, participant }\n  }\n}\n\n/**\n * Message actions.\n * Actions about the CRUD of message objects.\n */\n\n/**\n * Creates a send message action. Triggered when the user initiates the send message process.\n *\n * @method sendMessage\n * @param {Array<string>} destination An array of destinations for messages created in this conversation. Currently, only one destination is supported.\n * @param {Array} parts The message parts, as a formatted object.\n * @param {number} timestamp A timestamp for the sent message in seconds.\n * @param {number} id The ID of the conversation as it exists in the back end.\n * @param {string} type Type of message. 'im' or 'sms'.\n * @returns {Object} A flux standard action representing the send message action.\n */\nexport const sendMessage = (destination, parts, timestamp, type, id) =>\n  sendMessageHelper(actionTypes.SEND_MESSAGE, destination, parts, timestamp, type, id)\n\n/**\n * Creates a send message finished action. Trigged when a message send function has received a success response.\n *\n * @method sendMessageFinish\n * @param {Object} $0\n * @param {Array<string>} $0.destination An array of destinations for messages created in this conversation. Currently, only one destination is supported.\n * @param {string} $0.sender The sender of the outgoing message.\n * @param {string} $0.type The type of conversation: can be one 'im' or 'sms'.\n * @param {Array} $0.parts The message parts.\n * @param {number} $0.timestamp A timestamp for the sent message in seconds.\n * @param {string} [$0.messageId] The returned messageId of the message if sent successfully.\n * @param {string} [$0.deliveryStatus] The status of sent message\n * @param {Object} [$0.error] A basic error object\n * @returns {Object} A flux standard action representing the send message finished action.\n */\nexport const sendMessageFinish = ({\n  destination,\n  sender,\n  type,\n  parts,\n  timestamp,\n  messageId,\n  deliveryStatus,\n  error\n}) => {\n  return {\n    type: actionTypes.SEND_MESSAGE_FINISH,\n    payload: { destination, sender, type, parts, timestamp, messageId, deliveryStatus, error },\n    error: Boolean(error)\n  }\n}\n\n/**\n * Creates a message received action. Triggered when the websocket receives a chat message.\n *\n * @method messageReceived\n * @param {Array<string>} destination An array of destinations for messages created in this conversation. Currently, only one destination is supported.\n * @param {Array} parts The message parts.\n * @param {string} messageId The messageId of the message that has been received.\n * @param {string} sender The user who sent the message. This is the user who the conversation is with.\n * @param {number} timestamp A timestamp for the sent message.\n * @param {Object} meta - A meta object.\n * @param {string} meta.type The type of conversation: can be \"im\" or \"sms\".\n * @param {boolean} meta.newConversation - A boolean value indicating whether the message corresponds to a conversation not yet in the store.\n * @returns {Object} A flux standard action representing the message received action.\n */\nexport function messageReceived(\n  destination,\n  parts,\n  messageId,\n  sender,\n  timestamp,\n  meta = { type: 'im', newConversation: false }\n) {\n  return {\n    type: actionTypes.MESSAGE_RECEIVED,\n    meta: meta,\n    payload: {\n      destination: destination,\n      message: {\n        timestamp: timestamp,\n        isPending: false,\n        read: false,\n        parts: parts,\n        sender: sender,\n        messageId: messageId\n      }\n    }\n  }\n}\n\n/**\n * Creates an incoming message read action. This triggers when we receive a \"Message Read\" notification over the websocket.\n *\n * @method incomingMessageRead\n * @param {string} messageId The unique id of the message being marked as read.\n * @param {string} participant The other participant of the conversation.\n * @returns {Object} A flux standard action representing the incoming message read action.\n */\nexport const incomingMessageRead = (messageId, participant) =>\n  messageReadHelper(actionTypes.INCOMING_MESSAGE_READ, messageId, participant)\n\n/**\n * Creates a send message read action. This should send a \"mark message as read\" request to the server.\n *\n * @method sendMessageRead\n * @param {string} messageId The unique id of the message being marked as read.\n * @param {string} participant The other participant of the conversation.\n * @returns {Object} A flux standard action representing the send message read action.\n */\nexport const sendMessageRead = (messageId, participant) =>\n  messageReadHelper(actionTypes.SEND_MESSAGE_READ, messageId, participant)\n\n/**\n * Creates a send message read finish action. This triggers on server response when attempting to mark a message read.\n *\n * @method sendMessageReadFinish\n * @param {Object} $0\n * @param {string} $0.messageId The unique id of the message being marked as read.\n * @param {string} $0.participant The other participant of the conversation.\n * @param {Object} $0.error A Basic error object.\n * @returns {Object} A flux standard action representing the send message read finish action.\n */\nexport function sendMessageReadFinish({ messageId, participant, error }) {\n  return {\n    type: actionTypes.SEND_MESSAGE_READ_FINISH,\n    payload: error || { messageId, participant },\n    error: Boolean(error)\n  }\n}\n\n/**\n * Creates a fetch messages action. This is dispatched by the API directly.\n * @method fetchMessages\n * @param {Array} destination An array of destinations for messages created in this conversation.\n * @param {number} amount A number representing the amount of messages to fetch.\n * @returns {Object} A flux standard action representing the fetch messages action.\n */\nexport function fetchMessages(destination, amount, type) {\n  return {\n    type: actionTypes.FETCH_MESSAGES,\n    payload: { destination, amount, type }\n  }\n}\n\n/**\n * Creates a fetch messages finished action.\n * @method fetchMessagesFinished\n * @param {Array<string>} destination An array of destinations for messages created in this conversation. Currently, only one destination is supported.\n * @param {string} type The type of conversation: can be \"im\" or \"sms\".\n * @param {Array} messages An array of formatted messages to put into the store.\n * @param {Object} [error] An error object, only present if an error occurred.\n * @returns {Object} A flux standard action representing the fetch messages finished action.\n */\nexport function fetchMessagesFinished(destination, type, messages, error) {\n  return {\n    type: actionTypes.FETCH_MESSAGES_FINISHED,\n    payload: error || { destination, type, messages },\n    error: !!error\n  }\n}\n\n/**\n * Request to clear messages from a conversation's state.\n * @method clearMessages\n * @param  {string} destination The destination for messages created in this conversation.\n * @param {string} type The type of conversation: can be \"im\" or \"sms\".\n * @returns {Object} A flux standard action.\n */\nexport function clearMessages(destination, type) {\n  return {\n    type: actionTypes.CLEAR_MESSAGES,\n    payload: {\n      destination: destination,\n      type: type\n    }\n  }\n}\n\n/**\n * Request to delete all the messages from a conversation.\n * @method deleteMessage\n * @param  {string} destination The destination for messages created in this conversation.\n * @param {string} type The type of conversation: can be \"im\" or \"sms\".\n * @param {string} messageId The ID of the message targeted for deletion\n * @returns {Object} A flux standard action.\n */\nexport function deleteMessage(destination, type, messageId) {\n  return {\n    type: actionTypes.DELETE_MESSAGE,\n    payload: {\n      destination: destination,\n      type: type,\n      messageId: messageId\n    }\n  }\n}\n\n/**\n * Creates a fetch messages finished action.\n * @method deleteMessagesFinish\n * @param {Object} $0\n * @param {Array<string>} $0.destination An array of destinations for messages created in this conversation. Currently, only one destination is supported.\n * @param {string} $0.type The type of conversation: can be \"im\" or \"sms\".\n * @param {string} $0.messageId The ID of the message that was targeted for deletion\n * @param {Object} [$0.error] An error object, only present if an error occurred.\n * @returns {Object} A flux standard action representing the fetch messages finished action.\n */\nexport function deleteMessageFinish({ destination, type, messageId, error }) {\n  return {\n    type: actionTypes.DELETE_MESSAGE_FINISH,\n    payload: error || { destination, type, messageId },\n    error: !!error\n  }\n}\n","/**\n * The messaging feature revolves around a 'conversation' namespace. It is responsible to store the conversations\n * and its messages, and return conversation objects when requested.\n *\n * See the \"Conversation\" and \"Message\" sections of the documentation for more details.\n *\n *\n * Messaging functions are all part of the 'conversation' namespace. Ex: client.conversation.get('id').\n *\n * @public\n * @namespace conversation\n */\n\nimport { convoActions } from './actions'\nimport { getConversations as selectConversations, findConversation } from './selectors'\n\n/**\n * Messaging API factory function.\n * Defines the interface between the application and the SDK's Messaging APIs.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @return {Object} Available public APIs for Messaging.\n */\nexport default function createAPI(container) {\n  const { logManager, API_LOG_TAG, context, MixinsMessaging } = container\n  const log = logManager.getLogger('MESSAGING')\n\n  const messagingApi = {\n    // TODO: Revise this API's argument, since it is using names that are defined by CIM  they are not very descriptive.\n    /**\n     * Get a conversation object matching the user ID provided in the 'destination' parameter.\n     * If successful, the event 'conversations:change' will be emitted.\n     *\n     * This API will retrieve a conversation already existing in the store.\n     *\n     * @public\n     * @memberof conversation\n     * @requires onlyInternalMessaging\n     * @method get\n     * @param {string} destination The destination for messages created in this conversation. This will\n     * be a user's sip address.\n     * @param {Object} [options] An optional configuration object to query for more specific results.\n     * If this object is not passed, the function will query for \"im\" conversation with that recipient.\n     * @param {string} [options.type] The type of conversation to retrieve. Can be one of \"im\", \"sms\" or \"other\".\n     * @returns {conversation.Conversation} A Conversation object matching the passed destination, otherwise undefined is returned.\n     */\n    /**\n     * Get a conversation object matching the user ID provided in the 'recipient' parameter.\n     *\n     * This API will retrieve a conversation already existing in the store.\n     *\n     * @public\n     * @memberof conversation\n     * @requires internalAndSmsMessaging\n     * @method get\n     * @param {string} recipient The destination for messages created in this conversation. This\n     * will be a user's sip address.\n     * @param {Object} [options] An optional configuration object to query for more specific results.\n     * If this object is not passed, the function will query for \"im\" conversation with that recipient.\n     * @param {string} [options.type] The type of conversation to retrieve. Can be one of \"im\", \"sms\" or \"other\".\n     * @returns {Object} A Conversation object matching the passed recipient, otherwise undefined is returned.\n     */\n    get: function (recipient, options = { type: 'im' }) {\n      log.debug(API_LOG_TAG + 'conversation.get: ', recipient, options)\n      const destination = Array.isArray(recipient) ? [...recipient] : [recipient]\n      let description = 'Conversation'\n      let messages\n      let id\n\n      const conversation = findConversation(context.getState(), destination, options.type)\n      if (conversation) {\n        if (options.type === conversation.type) {\n          description = conversation.description\n          messages = conversation.messages\n          id = conversation.id\n\n          return MixinsMessaging.Conversation({\n            destination,\n            type: options.type,\n            id: id,\n            description,\n            messages: messages,\n            lastMessage: conversation.lastMessage,\n            isTypingList: conversation.isTypingList,\n            lastReceived: conversation ? conversation.lastReceived : undefined,\n            lastPull: conversation ? conversation.lastPull : undefined\n          })\n        } else {\n          log.info(\n            'Conversation found with matching destination, but conversation type does not match the type requested. Please specify the appropriate type, or call client.conversation.create() for a new type of conversation'\n          )\n        }\n      } else {\n        log.info(\n          'Requested conversation not in state. Please use the create function if you would like a new conversation object.'\n        )\n      }\n      return undefined\n    },\n    /**\n     * Create and return a new conversation object. Any messages being sent through this conversation\n     * object will be sent to the destination provided.\n     *\n     * @public\n     * @memberof conversation\n     * @requires internalAndSmsMessaging\n     * @method create\n     * @param {string} recipient\n     * @param options\n     * @returns {Object} a Conversation object\n     */\n    create: function (recipient, options = { type: 'im' }) {\n      log.debug(API_LOG_TAG + 'conversation.create: ', recipient, options)\n      const destination = Array.isArray(recipient) ? recipient : [recipient]\n      const prevConv = findConversation(context.getState(), destination, options.type)\n\n      if (!prevConv) {\n        // No operation/request is triggered. This action simply creates a conversation\n        // in redux store (i.e. locally)\n        context.dispatch(convoActions.createConversation(destination, options))\n      }\n\n      return MixinsMessaging.Conversation({\n        destination,\n        type: options.type\n      })\n    },\n    /**\n     * Returns all conversations currently tracked by the SDK\n     *\n     * @public\n     * @memberof conversation\n     * @requires internalAndSmsMessaging\n     * @requires onlyInternalMessaging\n     * @method getAll\n     * @returns {Array<conversation.Conversation>} An array of conversation objects.\n     */\n    getAll: function () {\n      log.debug(API_LOG_TAG + 'conversation.getAll')\n      const conversations = selectConversations(context.getState())\n\n      // Map conversation Objects to Conversation-Mixin Objects\n      return conversations.map(conversation => MixinsMessaging.Conversation(conversation))\n    }\n  }\n  return { conversation: messagingApi }\n}\n","/**\n * A new conversation has been created and added to the state.\n *\n * @public\n * @memberof conversation\n * @event conversations:new\n */\nexport const CONVERSATIONS_NEW = 'conversations:new'\n\n/**\n * A change has occurred in the conversation list.\n *\n * @public\n * @memberof conversation\n * @event conversations:change\n * @param {Array} params An array of objects containing information about the conversations that have changed\n * @param {Array} params.destination The destination for messages created in this conversation.\n * @param {string} params.type The type of conversation to create. Can be one of \"chat\", \"im\", \"sms\".\n */\nexport const CONVERSATIONS_CHANGE = 'conversations:change'\n\n/**\n * A change has occurred in a specific conversations message list.\n * If a single message was affected/created, `messageId` will be present\n * as part of the event argument.\n *\n * @public\n * @memberof conversation\n * @event messages:change\n * @param {Object} params\n * @param {string} params.destination The destination for messages created in this conversation.\n * @param {string} params.type The type of conversation to create. Can be one of \"chat\", \"im\", \"sms\".\n * @param {string} [params.messageId] The ID of the message affected.\n * @param {string} [params.sender] The username of the sender of the message which caused the `messages:change` event to be triggered.\n */\nexport const MESSAGES_CHANGE = 'messages:change'\n\n/**\n * An error occurred with messaging.\n *\n * @public\n * @memberof conversation\n * @event messages:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n */\nexport const MESSAGES_ERROR = 'messages:error'\n","// Import the components of the interface.\nimport createAPI from './api'\nimport createMixins from './mixins'\nimport reducer from './reducers'\n\n/**\n * This interface is for a messaging plugin.\n * @type {string}\n */\nconst name = 'messaging'\n\nexport { createAPI, createMixins, name, reducer }\n","// `features` and `lastPull` are not documented because they're intended to be internal\n// `type` is not documented because as of now there are no types other than 'im'\n\n/**\n * A Conversation object represents a conversation between two users.\n * A Conversation can create messages via the conversation's\n * {@link conversation.Conversation.createMessage createMessage()} function.\n * @public\n * @static\n * @typedef {Object} Conversation\n * @memberof conversation\n * @requires simpleMessagingOnly\n * @property {string} destination The id of the remote user with which the current user is having a conversation.\n */\n\n/**\n * A Message object is a means by which a sender can deliver information to a recipient.\n *\n * Creating and sending a message:\n *\n * A message object can be obtained through the {@link conversation.Conversation.createMessage Conversation.createMessage} API on an existing conversation.\n *\n * Messages have Parts which represent pieces of a message. Currently, only a 'text' part is suported.\n * Once all the desired parts have been added to the message using the {@link conversation.Message.addPart Message.addPart} function,\n * the message can then be sent using the {@link conversation.Message.send Message.send} function.\n *\n * Once the sender sends a message, this message is saved in sender's state as an object.\n * Similarly, once the recipient gets a message, this message is saved in recipient's state.\n *\n * Retrieving a delivered message:\n *\n * Once a message is delivered successfully, it can be\n * obtained through the {@link conversation.Conversation.getMessages Conversation.getMessages} or {@link conversation.Conversation.getMessage Conversation.getMessage} API on an existing conversation.\n *\n * Below are the properties pertaining to the message object, returned by Conversation.getMessage(s) APIs, for either sender or recipient.\n *\n * @property {number} timestamp A Unix timestamp in seconds marking the time when the message was created by sender.\n * @property {Array<conversation.Part>} parts An array of Part Objects.\n * @property {string} sender The primary contact address of the sender.\n * @property {Array<string>} destination An array of primary contact addresses associated with various destinations to which the message is meant to be delivered. Currently, only one destination is supported.\n * @property {string} messageId The unique id of the message. The message object (stored in sender's state) has a different id\n * than the one associated with the message object stored in recipient's state.\n * @property {string} type The type of message that was sent. See {@link conversation.chatTypes} for valid types.\n * This property applies only to message objects stored in sender's state.\n *\n * @public\n * @static\n * @typedef {Object} Message\n * @memberof conversation\n */\n\nimport { find, isEqual } from 'lodash/fp'\nimport { messageActions } from './actions'\n\nimport { getMessagingConfig, findConversation } from './selectors'\nimport { getUserInfo } from '../../auth/interface/selectors'\n\n// Events\nimport * as eventTypes from './eventTypes'\n\nexport default function createMixins(container) {\n  const { logManager, API_LOG_TAG, context, emitEvent, MessagingOperations: operations } = container\n  const log = logManager.getLogger('MESSAGING')\n\n  /**\n   * Conversation instance.\n   *\n   * @param {Object} info The information object used for creating a conversation instance.\n   * @param {Array<string>} info.destination The Destination for messages being sent through\n   * this conversation in this instance of the SDK. Currently, only one destination is supported.\n   * @param {string} [info.type='im'] The type of the message. Currently, only instant messages are supported.\n   * @param {string} [info.id=undefined] The unique identifier for base conversation.\n   * @param {string} [info.description=''] The description associated with base conversation.\n   * @param {Array} [info.messages=[]] An array containing the conversation's messages.\n   * @param {number} [info.lastReceived] The timestamp associated with the last received message.\n   * @param {string} [info.lastMessage] This is the last received message in a given conversation, as delivered by server.\n   */\n  const Conversation = function ({\n    destination,\n    type = 'im',\n    id = undefined,\n    description = '',\n    messages = [],\n    isTypingList = [],\n    lastReceived,\n    lastPull,\n    lastMessage = ''\n  }) {\n    const convo = {\n      destination: destination,\n      type: type,\n      description: description,\n      messages: messages,\n      lastMessage: lastMessage,\n      isTypingList: isTypingList,\n      id: id,\n      features: getMessagingConfig(context.getState()).features,\n      lastReceived: lastReceived,\n      lastPull: lastPull,\n      isPending: false,\n\n      /**\n       * Create and return a message object. You must provide a `text` part as demonstrated in the example.\n       *\n       * @public\n       * @static\n       * @memberof conversation.Conversation\n       * @requires simpleMessagingOnly\n       * @param {Object} part The part to add to the message.\n       * @param {string} part.type The type of part. Must be \"text\".\n       * @param {string} part.text The text of the part. Must be a part of type \"text\".\n       * @returns {conversation.Message} The newly created Message object.\n       *\n       * @example\n       * conversation.createMessage({type: 'text', text: 'This is the message'});\n       */\n      createMessage: function (part) {\n        log.debug(`${API_LOG_TAG}conversation.Conversation.getMessages`)\n        const messageContext = {\n          features: this.features,\n          id: this.id,\n          type: this.type\n        }\n        return Message({\n          destination: this.destination,\n          part,\n          messageContext: messageContext,\n          type: this.type\n        })\n      },\n\n      /**\n       * Clears all messages in this conversation from local state.\n       * @public\n       * @static\n       * @memberof conversation.Conversation\n       * @method clearMessages\n       */\n      clearMessages: function () {\n        log.debug(`${API_LOG_TAG}conversation.Conversation.clearMessages`)\n        context.dispatch(messageActions.clearMessages(this.destination, this.type))\n\n        // Trigger the same event that CLEAR_MESSAGES action would do.\n        emitEvent(eventTypes.MESSAGES_CHANGE, { destination: this.destination, type: this.type })\n      },\n\n      /**\n       * Get the messages associated with this conversation.\n       *\n       * @public\n       * @static\n       * @memberof conversation.Conversation\n       * @returns {Object[]} messages An array containing the conversation's messages.\n       * @returns {Function} messages.markRead Marks the message as read.\n       * @returns {Function} messages.forward Forward the message to another user.\n       * @returns {string} messages.messageId The Id of the message.\n       * @returns {string} messages.sender The user Id of the user who sent the message.\n       * @returns {number} messages.timestamp The time at which the message was sent.\n       * @returns {boolean} messages.read Whether the message has been marked as read.\n       * @returns {boolean} messages.isPending Whether the message has finished being sent to the server.\n       * @returns {Array} messages.parts The parts of the message.\n       */\n      getMessages: function () {\n        log.debug(`${API_LOG_TAG}conversation.Conversation.getMessages`)\n        const convo = findConversation(context.getState(), this.destination, this.type)\n\n        return convo.messages.map(message => {\n          message.forward = async participant => {\n            const timestamp = Date.now()\n            context.dispatch(messageActions.sendMessage(participant, message.parts, timestamp, this.type, this.id))\n            // When forward() is called on a mesage instance, we'll trigger the sendMessage operation\n            try {\n              await operations.sendMessage(participant, timestamp, message.parts)\n            } catch (error) {\n              // Just log the error\n              log.debug(`${API_LOG_TAG}conversation.Message.forward: Encountered an error: ${error}`)\n              emitEvent(eventTypes.MESSAGES_CHANGE, { error })\n            }\n          }\n\n          const userInfo = getUserInfo(context.getState())\n          // Only allow the end user to markRead on message that were incoming.\n          if (message.sender !== userInfo.username) {\n            message.markRead = () => {\n              context.dispatch(messageActions.sendMessageRead(message.messageId, this.destination))\n            }\n          }\n          return message\n        })\n      },\n\n      /**\n       * Get a specific message from this conversation.\n       * @public\n       * @static\n       * @method getMessage\n       * @memberof conversation.Conversation\n       * @param {string} messageId ID of the message to retrieve.\n       * @return {Object} A message object.\n       */\n      getMessage: function (messageId) {\n        log.debug(`${API_LOG_TAG}conversation.Conversation.getMessage`)\n        const convo = findConversation(context.getState(), this.destination, this.type)\n        const message = find(message => message.messageId === messageId)(convo.messages)\n\n        if (!message) {\n          log.debug(`Message (${messageId}) not found in conversation (${this.destination}).`)\n          return\n        }\n\n        message.forward = async participant => {\n          const timestamp = Date.now()\n          context.dispatch(messageActions.sendMessage(participant, message.parts, timestamp, this.type, this.id))\n          try {\n            await operations.sendMessage(participant, timestamp, message.parts)\n          } catch (error) {\n            // Just log the error\n            log.debug(`${API_LOG_TAG}conversation.Message.forward: Encountered an error: ${error}`)\n            emitEvent(eventTypes.MESSAGES_CHANGE, { error })\n          }\n        }\n        // Only allow the end user to markRead on message that were incoming.\n        const userInfo = getUserInfo(context.getState())\n        if (message.sender !== userInfo.username) {\n          message.markRead = () => {\n            context.dispatch(messageActions.sendMessageRead(message.messageId, this.destination))\n          }\n        }\n        return message\n      },\n\n      /**\n       * Subscribe to this conversations messages array.\n       *\n       * @public\n       * @static\n       * @memberof conversation.Conversation\n       * @param {Function} subscriber A subscriber function to be triggered when the messages array of this conversation is updated.\n       * @param {string} subscriber.destination The conversation participants.\n       * @param {string} subscriber.messageId The ID of the message that caused the event.\n       * @return {Function} The unsubscribe function.\n       */\n      subscribe: function (subscriber) {\n        log.debug(`${API_LOG_TAG}conversation.Conversation.subscribe`)\n        if (subscriber) {\n          // Create a subscriber wrapper to properly determine if this messages:change event is relevant to this convo\n          const subscriberWrapper = ({ destination, messageId }) => {\n            if (isEqual(destination, this.destination)) {\n              subscriber({ destination, messageId })\n            }\n          }\n          // Subscribe to the messages:change event with the wrapped subscriber\n          context.api.on('messages:change', subscriberWrapper)\n\n          // Return the unsubscribe function\n          return () => {\n            context.api.off('messages:change', subscriberWrapper)\n          }\n        }\n      }\n    }\n\n    return convo\n  }\n\n  /**\n   * Message instance.\n   *\n   * @param {Object} info The information object used for creating a message instance.\n   * @param {string} info.destination The Destination for messages being sent through\n   * this conversation in this instance of the SDK. Currently, only one destination is supported.\n   * @param  {Object|string} info.part - Indentifies the payload to the message.\n   * @param  {string} info.part.type - Type of payload. Currently, only 'text' is supported.\n   * @param  {string} info.part.text - The actual message content.\n   * @param  {Object} [info.messageContext] - Information and capabilities for how the message will act with regard to the conversation.\n   * @param  {Array}  [info.messageContext.features] - List of features the conversation supports.\n   * @param  {string} [info.type='im'] - The type of the message. Currently, only instant messaging is supported.\n   */\n  const Message = function ({ destination, part, messageContext, type = 'im' }) {\n    let payload\n    // We only support typeof part as being a 'string' or an object whose type is plain text\n    if (typeof part === 'string' || part.type === 'text') {\n      payload = { type: 'text', text: part.text }\n    } // otherwise message will have no payload\n\n    const message = {\n      destination: Array.isArray(destination) ? destination : [destination],\n      messageContext: messageContext,\n      type: type,\n      parts: [payload],\n\n      /**\n       * Sends the message.\n       *\n       * @public\n       * @static\n       * @method send\n       * @memberof conversation.Message\n       */\n      send: async function () {\n        log.debug(`${API_LOG_TAG}conversation.Message.send`, this)\n        const timestamp = Date.now()\n        context.dispatch(\n          messageActions.sendMessage(this.destination, this.parts, timestamp, this.type, this.messageContext.id)\n        )\n        // Call the operatin to do actual sending of the message\n        try {\n          // For Link, we don't support sending a message from a user to multiple users, but rather\n          // user to another user.\n          await operations.sendMessage(this.destination[0], timestamp, this.parts)\n        } catch (error) {\n          // Just log the error\n          log.debug(`${API_LOG_TAG}conversation.Message.send: Encountered an error: ${error}`)\n          emitEvent(eventTypes.MESSAGES_CHANGE, { error })\n        }\n      }\n    }\n    return message\n  }\n\n  return {\n    Conversation,\n    Message\n  }\n}\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\nimport { unionBy, unionWith, sortBy, isEqual } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.CREATE_CONVERSATION] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: [...state.conversations, { ...action.payload }]\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_CONVERSATIONS_FINISHED] = {\n  next(state, action) {\n    // TODO: does not persist conversations unique to local state\n    return {\n      ...state,\n      conversations: unionWith(\n        (a, b) => isEqual(a.destination, b.destination) && a.type === b.type, // Comparator\n        action.payload.conversations,\n        state.conversations // Conversation arrays\n      )\n    }\n  }\n}\n\nreducers[actionTypes.UPDATE_CONVERSATION] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return { ...conversation, ...action.payload }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_MESSAGES] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            isPending: true\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_MESSAGES_FINISHED] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: sortBy('timestamp', unionBy('messageId', action.payload.messages, conversation.messages)),\n            isTypingList: [],\n            isPending: false\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.SEND_MESSAGE] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.message.type\n        ) {\n          return {\n            ...conversation,\n            messages: [...conversation.messages, action.payload.message]\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.INCOMING_MESSAGE_READ] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              if (message.messageId === action.payload.messageId) {\n                return { ...message, read: true }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.SEND_MESSAGE_READ_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => {\n              if (message.messageId === action.payload.messageId) {\n                return { ...message, read: true }\n              }\n              return message\n            })\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.MESSAGE_RECEIVED] = {\n  next(state, action) {\n    if (action.meta.newConversation) {\n      return {\n        ...state,\n        conversations: [\n          ...state.conversations,\n          {\n            destination: action.payload.destination,\n            messages: [action.payload.message],\n            type: action.meta.type,\n            lastReceived: action.payload.message.timestamp\n          }\n        ]\n      }\n    } else {\n      return {\n        ...state,\n        conversations: state.conversations.map(conversation => {\n          if (isEqual(conversation.destination, action.payload.destination) && conversation.type === action.meta.type) {\n            return {\n              ...conversation,\n              messages: [...conversation.messages, action.payload.message],\n              lastReceived: action.payload.message.timestamp\n            }\n          }\n          return conversation\n        })\n      }\n    }\n  }\n}\n\nreducers[actionTypes.SEND_MESSAGE_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.map(message => sendMessageFinishHelper(message, action))\n          }\n        }\n        return conversation\n      })\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.filter(\n              message => message.timestamp !== action.payload.timestamp && !message.isPending\n            )\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\n// Remove all messages from the specified conversation.\nreducers[actionTypes.CLEAR_MESSAGES] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: []\n          }\n        }\n        return conversation\n      })\n    }\n  }\n}\n\nreducers[actionTypes.DELETE_MESSAGE_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.map(conversation => {\n        if (\n          isEqual(conversation.destination, action.payload.destination) &&\n          conversation.type === action.payload.type\n        ) {\n          return {\n            ...conversation,\n            messages: conversation.messages.filter(message => message.messageId !== action.payload.messageId)\n          }\n        }\n        return conversation\n      })\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.DELETE_CONVERSATION_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      conversations: state.conversations.filter(\n        conversation =>\n          !(isEqual(conversation.destination, action.payload.destination) && conversation.type === action.payload.type)\n      )\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\n/*\n * Combine all of reducers into a single reducer, with\n *      a default state of an empty array.\n */\nconst reducer = handleActions(reducers, { conversations: [], errors: [] })\nexport default reducer\n\n/**\n * sendMessageFinishHelper\n *\n * A helper function to make dealing with the messages array in SEND_MESSAGE_FINISH\n * a little bit easier.\n *\n * @param {Object} message\n * @param {Object} action\n */\nfunction sendMessageFinishHelper(message, action) {\n  if (message.timestamp === action.payload.timestamp) {\n    if (action.payload.error) {\n      message = {\n        ...message,\n        sender: action.payload.sender,\n        isPending: false,\n        messageId: null,\n        error: action.payload.error\n      }\n    } else {\n      message = {\n        ...message,\n        sender: action.payload.sender,\n        isPending: false,\n        messageId: action.payload.messageId,\n        parts: action.payload.parts\n      }\n    }\n    if (action.payload.deliveryStatus) {\n      message.deliveryStatus = action.payload.deliveryStatus\n    }\n  } else {\n    message = { ...message }\n  }\n  return message\n}\n","import { cloneDeep, isEqual } from 'lodash/fp'\n\n/*\n * Selector functions for messaging.\n * Used to retrieve specific portions of the state.\n */\n\n/**\n * Retrieves the config options provided by the messaging plugin.\n * @method getMessagingConfig\n * @return {Object}\n */\nexport function getMessagingConfig(state) {\n  return cloneDeep(state.config.messaging)\n}\n\n/**\n * Retrieves conversations from the store pertaining to messaging.\n * @method getConversations\n * @return {Object}\n */\nexport function getConversations(state) {\n  return cloneDeep(state.messaging.conversations)\n}\n\n/**\n * Retrieves the messages from the store pertaining to a specific messaging\n * conversation.\n * @method getMessages\n * @return {Object}\n */\nexport function getMessages(state, conversationId) {\n  return cloneDeep(state.messaging.conversations[conversationId].messages)\n}\n\n/**\n * Searches for a conversation by its destination, which represents the destination\n * for all messages being sent to this conversation from this instance of the SDK\n *\n * @param state\n * @param {Array<string>} destination Curently, only one destination is supported.\n * @param {string} type The type of conversation: can be one of 'im', 'sms'.\n * @returns {Object}\n */\nexport function findConversation(state, destination, type = 'im') {\n  return cloneDeep(\n    state.messaging.conversations.find(conversation => {\n      return isEqual(conversation.destination, destination) && conversation.type === type\n    })\n  )\n}\n\n/**\n * Searches for a member in a conversation and returns their name.\n *\n * @param state\n * @param {string} destination The destination for the conversation instance.\n * @param id {number} User ID for the specific conversation member for whom we are searching\n * @returns {*}\n */\nexport function findMember(state, destination, id) {\n  const conv = state.messaging.conversations.find(conversation => conversation.destination === destination)\n  if (conv) {\n    return cloneDeep(conv.members.find(member => member.id === id))\n  }\n}\n","import { createAPI, createMixins, name, reducer } from '../interface'\n\nimport createOperations from './operations'\nimport createMiddleware from './middleware'\nimport createRequests from './requests'\n\nimport { defaults } from 'lodash/fp'\n\n// Parse and/or Validate\nimport { validation as v8n, parse } from '../../../src/common/validation'\n\n// Other plugins.\nimport { update as updateConfig } from '../../config/interface/actions'\n\n/**\n * Link Messaging plugin factory.\n * Provides the SDK with the 'Messaging' feature.\n * @method messagingFactory\n * @param  {Object} [options={}]\n * @param  {Array}  [options.features=['base']] - A list of the supported features of messaging\n * @return {Object} A plugin object.\n */\nexport default function messagingFactory(bottle, options = {}) {\n  const defaultOptions = {\n    features: ['base']\n  }\n\n  const { logManager } = bottle.container\n  // Get the logger\n  const log = logManager.getLogger('MESSAGING')\n\n  const v8nValidation = v8n.schema({\n    features: v8n.array().every.string()\n  })\n  const parseOptions = parse('messaging', v8nValidation)\n\n  options = defaults(defaultOptions, options)\n  parseOptions(options)\n\n  if (options.features.length > 1 || options.features[0] !== defaultOptions.features[0]) {\n    log.warn('Link messaging is not compatible with add-on ' + 'features. Reverting to base messaging.')\n    options.features = defaultOptions.features\n  }\n  log.info('Messaging features in use: ' + options.features)\n\n  function initPlugin(container) {\n    const { context } = container\n    // Update the redux state so that it contains the state.config.messaging sub-state\n    context.dispatch(updateConfig(options, name))\n  }\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('MessagingAPI', createAPI)\n  bottle.factory('MixinsMessaging', createMixins)\n\n  bottle.defer(initPlugin)\n\n  bottle.factory('MessagingOperations', createOperations)\n  bottle.factory('MessagingRequests', createRequests)\n\n  const capabilities = ['simpleMessagingOnly', 'onlyInternalMessaging']\n\n  return {\n    name,\n    capabilities,\n    reducer,\n    middleware: createMiddleware\n  }\n}\n","import { NOTIFICATION_RECEIVED } from '../../notifications/interface/actionTypes'\n\n/**\n * Messaging middleware factory function.\n * @method createMiddleware\n * @param  {Object} context The factory context.\n * @return {Function} A redux middleware.\n */\nexport default function createMiddleware(context) {\n  const operations = context.container.MessagingOperations\n  /*\n   * Redux middleware: Watch for specific actions and trigger operations\n   *    when we see them.\n   */\n  return next => action => {\n    // Messaging doesn't act on any other actions.\n    if (\n      action.type === NOTIFICATION_RECEIVED &&\n      action.payload.notificationMessage &&\n      action.payload.notificationMessage.eventType === 'IM'\n    ) {\n      // When a notification of type IM is received, Messaging plugin should deal with it\n      operations.messageReceived(action)\n    }\n\n    return next(action)\n  }\n}\n","// Messaging\nimport { messageActions } from '../interface/actions'\nimport { getConversations } from '../interface/selectors'\nimport * as eventTypes from '../interface/eventTypes'\n\n// Error\nimport BasicError, { messagingCodes } from '../../errors'\n\n// Other plugins.\nimport { getConnectionInfo } from '../../auth/interface/selectors'\nimport { NOTIFICATION_RECEIVED } from '../../notifications/interface/actionTypes'\n\n/**\n * Messaging Operations factory function.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for Messaging.\n */\nexport default function createOperations(container) {\n  const { context, emitEvent, logManager, MessagingRequests: requests } = container\n  const log = logManager.getLogger('MESSAGING')\n\n  /**\n   * Operation to receive Message info from a notification.\n   * @method messageReceived\n   * @param {Object} action The action for receiving an incoming message notification.\n   */\n  function messageReceived(action) {\n    const { dispatch, getState } = context\n\n    if (![NOTIFICATION_RECEIVED].includes(action.type)) {\n      return\n    }\n\n    if (!(action.payload.notificationMessage && action.payload.notificationMessage.eventType === 'IM')) {\n      return\n    }\n\n    const message = action.payload.notificationMessage.imnotificationParams.msgText\n    const sender = action.payload.notificationMessage.imnotificationParams.primaryContact.split('sip:')[1]\n    const messageId = action.payload.notificationMessage.eventId\n    const conversations = getConversations(getState())\n    // Search for an existing conversation that matches this message's sender.\n    const convo = conversations.find(conv => {\n      return conv.destination[0] === sender\n    })\n\n    const metaType = 'im'\n    if (convo) {\n      dispatch(\n        messageActions.messageReceived(\n          [sender],\n          [{ mimeType: 'text/plain', type: 'text', text: message }],\n          messageId,\n          sender,\n          Date.now(),\n          {\n            newConversation: false,\n            type: metaType\n          }\n        )\n      )\n      const data = {\n        destination: [sender],\n        messageId,\n        type: metaType\n      }\n      // Tell the application that state has changed.\n      emitEvent(eventTypes.MESSAGES_CHANGE, data)\n    } else {\n      // Add the new message to the convo in the store\n      dispatch(\n        messageActions.messageReceived(\n          [sender],\n          [{ mimeType: 'text/plain', type: 'text', text: message }],\n          messageId,\n          sender,\n          Date.now(),\n          {\n            newConversation: true,\n            type: 'im'\n          }\n        )\n      )\n      const data = [\n        {\n          destination: [sender],\n          type: metaType\n        }\n      ]\n      // Tell the application that state has changed.\n      emitEvent(eventTypes.CONVERSATIONS_CHANGE, data)\n    }\n  }\n\n  /**\n   * Operation to send a message to a given destination.\n   * @method send\n   * @param {string} destination The Id of the remote user with which the current user is having a conversation.\n   * @param {number} timestamp A Unix timestamp in seconds marking the time when the message was created by sender.\n   * @param {Array<conversation.Part>} parts An array of Part Objects. This is the actual payload, containing the message type & the message itself.\n   */\n  async function sendMessage(destination, timestamp, parts) {\n    const connectionInfo = getConnectionInfo(context.getState())\n\n    const type = 'im'\n    let error\n    if (!connectionInfo) {\n      log.debug('Sending mesage was aborted due to: no connection info available. Ensure user is authenticated.')\n      error = new BasicError({\n        code: messagingCodes.SEND_MESSAGE_FAIL,\n        message: 'Failed to send message; no user connection info available.'\n      })\n      context.dispatch(\n        messageActions.sendMessageFinish({\n          sender: undefined,\n          destination: [destination],\n          type,\n          parts,\n          timestamp,\n          error\n        })\n      )\n\n      emitEvent(eventTypes.MESSAGES_ERROR, { error })\n      // Also throw it to internal API (i.e. mixins)\n      throw error\n    }\n\n    const { username } = connectionInfo\n    try {\n      const messageData = await requests.sendMessage(destination, parts, connectionInfo)\n      context.dispatch(\n        messageActions.sendMessageFinish({\n          sender: username,\n          destination: [destination],\n          type,\n          parts: parts,\n          timestamp: timestamp,\n          messageId: messageData.messageId // message was sent to server & server generated an id\n        })\n      )\n      emitEvent(eventTypes.MESSAGES_CHANGE, {\n        destination: [destination],\n        type,\n        messageId: messageData.messageId,\n        sender: username\n      })\n    } catch (error) {\n      context.dispatch(\n        messageActions.sendMessageFinish({\n          sender: username,\n          destination: [destination],\n          type,\n          parts: parts,\n          timestamp: timestamp,\n          error\n        })\n      )\n      emitEvent(eventTypes.MESSAGES_ERROR, { error })\n      throw error\n    }\n  }\n\n  return {\n    // API operations:\n    messageReceived,\n    sendMessage\n  }\n}\n","// Error\nimport BasicError, { messagingCodes } from '../../errors'\n\n/**\n * Messaging Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's Messaging REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for Messaging.\n */\nexport default function createRequests(container) {\n  const { logManager, sendRequest } = container\n  const log = logManager.getLogger('MESSAGING')\n\n  /**\n   * @method sendMessage\n   * @param {string} destination The Id of the remote user with which the current user is having a conversation.\n   * @param {Array<conversation.Part>} parts An array of Part Objects. This is the actual payload, containing the message type & the message itself.\n   * @param {Object} connectionInfo Contains connection related values such as authenticated username & server info.\n   * @returns {Object} An object containing the messageId, or BasicError if request fails.\n   */\n  async function sendMessage(destination, parts, connectionInfo) {\n    const { server, username } = connectionInfo\n    const url = `${server.protocol}://${server.server}:${server.port}/rest/version/${server.version}/user/${username}/instantmessage`\n    const data = {\n      imRequest: {\n        charset: 'UTF-8',\n        toUrl: destination,\n        message: parts[0].text,\n        type: 'A2'\n      }\n    }\n    const options = {\n      url,\n      method: 'POST',\n      body: JSON.stringify(data)\n    }\n    const response = await sendRequest(options)\n    const { error, result, body } = response\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.imResponse\n        log.debug(`Failed to send message with status code ${statusCode}.`)\n\n        throw new BasicError({\n          code: messagingCodes.SEND_MESSAGE_FAIL,\n          message: `Failed to send message. Code: ${statusCode}.`\n        })\n      } else {\n        // Handler errors from the request helper.\n        const { message } = result\n        log.debug('Send message request failed', message)\n\n        throw new BasicError({\n          code: messagingCodes.SEND_MESSAGE_FAIL,\n          message: `Send message request failed: ${message}.`\n        })\n      }\n    } else if (body.imResponse && body.imResponse.messageId) {\n      // Request was successful, so at this point we know backend generated a unique messageId for\n      // the message that our SDK tried to sent. Return this to the operation.\n      return { messageId: body.imResponse.messageId }\n    } else {\n      // Unknown error scenario.\n      throw new BasicError({\n        code: messagingCodes.SEND_MESSAGE_FAIL,\n        message: 'Failed to send message: Unexpected error'\n      })\n    }\n  }\n\n  return {\n    // Operation requests.\n    sendMessage\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const MWI_UPDATE = PREFIX + 'MWI_UPDATE'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Creates a message waiting indicator update action.\n *\n * @method mwiUpdate\n * @param {Object} $0\n * @param {string} $0.mwiEvent An mwiEvent object from spidr.\n * @param {Object} $0.error A Basic error object.\n * @returns {Object} A flux standard action.\n */\nexport function mwiUpdate({ mwiData, error }) {\n  if (error) {\n    return {\n      type: actionTypes.MWI_UPDATE,\n      payload: error,\n      error: true\n    }\n  } else {\n    return {\n      type: actionTypes.MWI_UPDATE,\n      payload: {\n        ...mwiData\n      }\n    }\n  }\n}\n","/**\n * The 'voicemail' namespace is used to retrieve and view\n * voicemail indicators.\n *\n * Voicemail functions are all part of this namespace.\n *\n * @public\n * @requires voicemail\n * @namespace voicemail\n */\nimport { getMwi } from './selectors'\nimport { MWI_CHANGE, MWI_ERROR } from './eventTypes'\n\n/**\n * MWI API factory function.\n * Defines the interface between the application and the SDK's MWI APIs.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @return {Object} Available public APIs for MWI.\n */\nexport default function createAPI(container) {\n  const { context, emitEvent, MWIOperations: operations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('MWI')\n\n  const mwiApi = {\n    /**\n     * Attempts to retrieve voicemail information from the server.\n     *\n     * A {@link voicemail.event:voicemail:change voicemail:change} event is\n     *    emitted upon completion.\n     *\n     * @public\n     * @requires voicemail\n     * @memberof voicemail\n     * @method fetch\n     */\n    async fetch() {\n      log.debug(API_LOG_TAG + 'voicemail.fetch')\n      let mwiData\n      try {\n        mwiData = await operations.fetchMwi()\n      } catch (error) {\n        emitEvent(MWI_ERROR, { error })\n        return\n      }\n\n      // fetchMwi operation succeeded\n      emitEvent(MWI_CHANGE, mwiData)\n    },\n\n    /**\n     * Returns voicemail data from the store.\n     *\n     * @public\n     * @requires voicemail\n     * @memberof voicemail\n     * @method get\n     */\n    get() {\n      log.debug(API_LOG_TAG + 'voicemail.get')\n      return getMwi(context.getState())\n    }\n  }\n\n  return { voicemail: mwiApi }\n}\n","// TODO: Fix params in this file, move to voicemail over MWI on all public wording.\n/**\n * A voicemail event has been received.\n *\n * @requires voicemail\n * @public\n * @static\n * @memberof voicemail\n * @event voicemail:change\n * @param {Object} params An object containing voicemail info.\n * @param {number} params.lastUpdated Timestamp of the last time voicemail data was checked.\n * @param {boolean} params.newMessagesWaiting Whether there are new messages.\n * @param {number} params.totalVoice The total number of voicemail messages.\n * @param {number} params.unheardVoice Number of unheard voicemail messages.\n * @param {Object} params.voice Object containing individual counts of new, old, urgent voicemails.\n * @param {Object} params.fax Object containing individual counts of new, old, urgent faxes.\n * @param {Object} params.multimedia Object containing individual counts of new, old, urgent multimedia messages.\n */\nexport const MWI_CHANGE = 'voicemail:change'\n\n/**\n * An error has occurred while attempting to retrieve voicemail data.\n *\n * @requires voicemail\n * @public\n * @memberof voicemail\n * @event voicemail:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n */\nexport const MWI_ERROR = 'voicemail:error'\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a mwi plugin.\n * @type {string}\n */\nconst name = 'mwi'\n\nexport { name, api, reducer }\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\nreducers[actionTypes.MWI_UPDATE] = {\n  // The next function will only handle non-error actions.\n  next(state, action) {\n    return {\n      ...action.payload\n    }\n  }\n}\n\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/*\n * Redux state selector functions.\n */\n\n/**\n * Retrieves the message waiting indicator data from the state.\n * @method getMwi\n * @return {Object}\n */\nexport function getMwi(state) {\n  return cloneDeep(state.mwi)\n}\n","import { name, reducer } from '../interface'\nimport createAPI from '../interface/api'\nimport createMiddleware from './middleware'\nimport createOperations from './operations'\nimport createRequests from './requests'\n\n/**\n * Voicemail service plugin factory.\n * Provides the SDK with the Voicemail feature.\n * @method mwiFactory\n */\nexport default function mwiFactory(bottle) {\n  // Register the component factory functions to the bottle.\n  bottle.factory('MWIAPI', createAPI)\n  bottle.factory('MWIOperations', createOperations)\n  bottle.factory('MWIRequests', createRequests)\n\n  const capabilities = ['voicemail']\n\n  return {\n    capabilities,\n    name,\n    reducer,\n    middleware: createMiddleware\n  }\n}\n","import { NOTIFICATION_RECEIVED } from '../../notifications/interface/actionTypes'\n\n/**\n * Message Waiting Indicator middleware factory function.\n * @method createMiddleware\n * @param  {Object} context The factory context.\n * @return {Function} A redux middleware.\n */\nexport default function createMiddleware(context) {\n  const { mwiReceived } = context.container.MWIOperations\n  /*\n   * Redux middleware: Watch for specific actions and trigger operations\n   *    when we see them.\n   */\n  return next => action => {\n    /*\n     * Let the action happen as it is received.\n     *\n     * The MWI's middleware operations are not side-effects, they are\n     *     relevant to the operation being performed. As such they can\n     *     happen when necessary without waiting for other operations.\n     *\n     * MWI doesn't act on any other actions.\n     */\n\n    const { type, payload = {} } = action\n\n    if (\n      type === NOTIFICATION_RECEIVED &&\n      payload.notificationMessage &&\n      payload.notificationMessage.eventType === 'mwi'\n    ) {\n      mwiReceived(payload.notificationMessage)\n    }\n\n    return next(action)\n  }\n}\n","// MWI Actions\nimport * as actions from '../interface/actions'\nimport * as eventTypes from '../interface/eventTypes'\nimport { processMwi } from './utils'\n\n/**\n * MWI Operations factory function.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for MWI.\n */\nexport default function createOperations(container) {\n  const { context, emitEvent, logManager, MWIRequests: requests } = container\n  const { dispatch } = context\n  const log = logManager.getLogger('MWI')\n\n  /**\n   * Operation to receive MWI info from a notification.\n   * @method mwiReceived\n   * @param {Object} notificationMessage from action.payload, containing the mwi notification data\n   */\n  function mwiReceived(notificationMessage) {\n    const mwiData = processMwi({\n      ...notificationMessage,\n      data: notificationMessage.mwiNotificationParam\n    })\n    dispatch(actions.mwiUpdate({ mwiData }))\n    emitEvent(eventTypes.MWI_CHANGE, mwiData)\n    log.info('Successfully processed mwi notification')\n  }\n\n  /**\n   * Operation to fetch MWI info from the backend.\n   * @method fetchMwi\n   * @returns {Object} Object\n   * @returns {Date} Object.lastUpdated The last time the voicemail indicator was updated\n   * @returns {boolean} Object.newMessagesWaiting Whether there is a new message waiting\n   * @returns {string} Object.totalVoice The number of total voicemails that haven't been heard, in string form\n   * @returns {string} Object.unheardVoice The number of unheard voicemails, in string form\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function fetchMwi() {\n    const mwiData = await requests.fetchVoicemails()\n    dispatch(actions.mwiUpdate({ mwiData }))\n    log.info('Successfully retrieved voicemail data from server')\n    return mwiData\n  }\n\n  return {\n    // API operations:\n    fetchMwi,\n    mwiReceived\n  }\n}\n","// Other plugins.\nimport { getRequestInfo } from '../../auth/interface/selectors'\nimport BasicError, { mwiCodes } from '../../errors'\nimport { processMwi } from './utils'\n\n/**\n * MWI Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's MWI REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for MWI.\n */\nexport default function createRequests(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('MWI')\n\n  /**\n   * KL REST request to retrieve MWI info.\n   * @method fetchVoicemails\n   * @returns {Object} Object\n   * @returns {Date} Object.lastUpdated The last time the voicemail indicator was updated\n   * @returns {boolean} Object.newMessagesWaiting Whether there is a new message waiting\n   * @returns {string} Object.totalVoice The number of total voicemails that haven't been heard, in string form\n   * @returns {string} Object.unheardVoice The number of unheard voicemails, in string form\n   * @throws {BasicError} Throws an error if the REST request fails.\n   * @throws {BasicError} Throws an error if the server responds with an issue.\n   */\n  async function fetchVoicemails() {\n    const { baseURL, username, version } = getRequestInfo(context.getState())\n\n    const {\n      body,\n      error,\n      result = {}\n    } = await sendRequest({\n      method: 'GET',\n      url: `${baseURL}/rest/version/${version}/user/${username}/voicemail`,\n      responseType: 'json',\n      body: undefined\n    })\n\n    const { mwiresponse } = body || {} // body may be 'null'\n\n    if (error) {\n      let statusCode\n\n      if (mwiresponse) {\n        ;({ statusCode } = mwiresponse)\n      }\n\n      const errMsg =\n        typeof statusCode === 'number' // need type check because statusCode may be 0\n          ? `Failed to fetch voicemail(s). Status Code: ${statusCode}`\n          : `Voicemail fetch request failed. ${result.message}`\n\n      log.info(errMsg)\n\n      throw new BasicError({\n        code: mwiCodes.FETCH_MWI_FAIL,\n        message: errMsg\n      })\n    }\n\n    return processMwi({ data: mwiresponse })\n  }\n\n  return {\n    // Operation requests.\n    fetchVoicemails\n  }\n}\n","/**\n * Process an MWI info object\n * @method processMwi\n * @param {Object} mwiData Object containg mwi information\n * @returns {Object} Object\n * @returns {Date} Object.lastUpdated The last time the voicemail indicator was updated\n * @returns {boolean} Object.newMessagesWaiting Whether there are one or more new messages waiting\n * @returns {string} Object.totalVoice The number of total voicemails that haven't been heard\n * @returns {string} Object.unheardVoice The number of unheard voicemails\n */\nexport function processMwi({ time = Date.now(), data = {} }) {\n  const { mwi, totalVoice = '0', unheardVoice = '0' } = data\n\n  delete data.mwi\n  delete data.statusCode\n\n  return {\n    ...data,\n    newMessagesWaiting: mwi === 'yes',\n    lastUpdated: time,\n    totalVoice,\n    unheardVoice\n  }\n}\n","const prefix = '@@KANDY/'\n\nexport const PROCESS_NOTIFICATION = prefix + 'PROCESS_NOTIFICATION'\nexport const PROCESS_NOTIFICATION_FINISH = prefix + 'PROCESS_NOTIFICATION_FINISH'\nexport const NOTIFICATION_RECEIVED = prefix + 'NOTIFICATION_RECEIVED'\n\nexport const ENABLE_NOTIFICATION_CHANNEL = prefix + 'ENABLE_NOTIFICATION_CHANNEL'\nexport const ENABLE_NOTIFICATION_CHANNEL_FINISH = prefix + 'ENABLE_NOTIFICATION_CHANNEL_FINISH'\n\nexport const REGISTER_APPLE_PUSH_NOTIFICATION = prefix + 'REGISTER_APPLE_PUSH_NOTIFICATION'\nexport const REGISTER_ANDROID_PUSH_NOTIFICATION = prefix + 'REGISTER_ANDROID_PUSH_NOTIFICATION'\n\nexport const UNREGISTER_APPLE_PUSH_NOTIFICATION = prefix + 'UNREGISTER_APPLE_PUSH_NOTIFICATION'\nexport const UNREGISTER_ANDROID_PUSH_NOTIFICATION = prefix + 'UNREGISTER_ANDROID_PUSH_NOTIFICATION'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Helper function for funneling all notification types into a single action.\n * @method notificationHelper\n * @param  {string} channel - The channel that the notification came from.\n * @param  {Object} notification\n * @return {Object} A flux standard action.\n */\nfunction notificationHelper(channel, notification) {\n  return {\n    type: actionTypes.PROCESS_NOTIFICATION,\n    payload: notification,\n    meta: {\n      channel\n    }\n  }\n}\n\n/**\n * Represents an application request to process a websocket notification.\n * @method websocketNotification\n * @param  {Object} notification\n * @return {Object} A flux standard action.\n */\n// TODO: Delete this action when the new Connectivity plugin replaces the old one.\nexport function websocketNotification(notification) {\n  return notificationHelper('WEBSOCKET', notification)\n}\n\n/**\n * Represents an application request to process an external notification.\n * @method externalNotification\n * @param  {Object} notification\n * @param  {string} [channel='PUSH'] - The channel that the notification came from.\n * @return {Object} A flux standard action.\n */\nexport function externalNotification(notification, channel = 'PUSH') {\n  return notificationHelper(channel.toUpperCase(), notification)\n}\n\n/**\n * Represents a received notification.\n * @method notificationReceived\n * @param  {Object} notification\n * @return {Object} A flux standard action.\n */\nexport function notificationReceived(notification, channel) {\n  return {\n    type: actionTypes.NOTIFICATION_RECEIVED,\n    payload: notification,\n    error: notification instanceof Error,\n    meta: {\n      channel\n    }\n  }\n}\n\n/**\n * Represents a received notification.\n * @method processNotificationFinish\n * @param  {Object} notification\n * @return {Object} A flux standard action.\n */\nexport function processNotificationFinish(notification) {\n  return {\n    type: actionTypes.PROCESS_NOTIFICATION_FINISH,\n    payload: notification,\n    error: notification instanceof Error,\n    meta: {}\n  }\n}\n\n/**\n * Represents a request to change a notification channel status.\n * @method enableNotificationChannel\n * @param  {string} channel - The notification channel being affected.\n * @param  {Object} params\n * @param  {boolean} params.channelEnabled - Whether to enable the channel or not.\n * @return {Object} A flux standard action.\n */\nexport function enableNotificationChannel(channel, params = {}) {\n  return {\n    type: actionTypes.ENABLE_NOTIFICATION_CHANNEL,\n    payload: {\n      ...params\n    },\n    meta: {\n      channel\n    }\n  }\n}\n\n/**\n * Represents a request to change a notification channel status.\n * @method registerApplePushNotification\n * @param  {Object} params\n * @return {Object} A flux standard action.\n */\nexport function registerApplePushNotification(params, deferred) {\n  return {\n    type: actionTypes.REGISTER_APPLE_PUSH_NOTIFICATION,\n    payload: {\n      ...params,\n      pushProvider: 'apple'\n    },\n    meta: {\n      deferred\n    }\n  }\n}\n\n/**\n * Represents a request to change a notification channel status.\n * @method registerAndroidPushNotification\n * @param  {Object} params\n * @return {Object} A flux standard action.\n */\nexport function registerAndroidPushNotification(params, deferred) {\n  return {\n    type: actionTypes.REGISTER_ANDROID_PUSH_NOTIFICATION,\n    payload: {\n      ...params,\n      pushProvider: 'google'\n    },\n    meta: {\n      deferred\n    }\n  }\n}\n\n/**\n * Represents a request to change a notification channel status.\n * @method unregisterApplePushNotification\n * @param  {string} registration\n * @return {Object} A flux standard action.\n */\nexport function unregisterApplePushNotification(registration, deferred) {\n  return {\n    type: actionTypes.UNREGISTER_APPLE_PUSH_NOTIFICATION,\n    payload: {\n      registration\n    },\n    meta: {\n      deferred\n    }\n  }\n}\n\n/**\n * Represents a request to change a notification channel status.\n * @method unregisterAndroidPushNotification\n * @param  {string} registration\n * @return {Object} A flux standard action.\n */\nexport function unregisterAndroidPushNotification(registration, deferred) {\n  return {\n    type: actionTypes.UNREGISTER_ANDROID_PUSH_NOTIFICATION,\n    payload: {\n      registration\n    },\n    meta: {\n      deferred\n    }\n  }\n}\n\n/**\n * Represents the response of a change in a notification channel status.\n * @method enableNotificationChannelFinish\n * @param  {string} channel - The notification channel being affected.\n * @param  {Object} $1\n * @param  {Object} $1.params - Information about the channel change.\n * @param  {Object} $1.params.channelEnabled - Whether the channel was enabled or not.\n * @param  {Object} $1.error - Error object, in the case of an error.\n * @return {Object} A flux standard action.\n */\nexport function enableNotificationChannelFinish(channel, { params, error } = {}) {\n  var action = {\n    type: actionTypes.ENABLE_NOTIFICATION_CHANNEL_FINISH,\n    meta: {\n      channel\n    }\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = new Error(error)\n    action.payload.channelEnabled = params.channelEnabled\n  } else {\n    action.payload = {\n      ...params\n    }\n  }\n\n  return action\n}\n","/**\n * The 'notification' namespace allows user to register/deregister for/from push notifications as well as\n * enabling/disabling the processing of websocket notifications.\n *\n * @public\n * @requires externalNotifications\n * @namespace notification\n */\n\nimport * as actions from './actions'\nimport * as eventTypes from './eventTypes'\n\n/**\n * Notification APIs factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} Establish API.\n */\nexport default function createAPI(container) {\n  const { logManager, context, NotificationsOperations: operations, emitEvent, API_LOG_TAG } = container\n  const log = logManager.getLogger('NOTIFICATIONS')\n\n  const notificationApi = {\n    /**\n     * Provides an external notification to the system for processing.\n     *\n     * @public\n     * @requires externalNotifications\n     * @memberof notification\n     * @method process\n     * @param {Object} notification The notification object from which to extract relevant data.\n     * @param {string} [channel='PUSH'] The channel that the notification came from.\n     *    If no channel provided, then by default it will be a PUSH notification.\n     */\n    process: function (notification, channel = 'PUSH') {\n      log.debug(API_LOG_TAG + 'notification.process: ', notification, channel)\n\n      context.dispatch(actions.externalNotification(notification, channel))\n\n      operations.processNotification(notification, channel)\n    },\n\n    /**\n     * Registers with Apple push notification service. Once registration is successful, the application will be able to receive\n     * standard and/or voip push notifications. It can then send these notifications to the SDK with {@link api.notifications.process}\n     * in order for the SDK to process them.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method registerApplePush\n     * @param {Object} params\n     * @param {string[]} params.services - Array of services for which we wish to receive notifications.\n     * @param {string} params.voipDeviceToken - The voip device token used for voip push on iOS.\n     *                                          This token is required if registering for call service notifications on iOS.\n     * @param {string} params.standardDeviceToken - The standardDevice token used for standard push on iOS .\n     *                                              This token is required when registering for non-call service notifications.\n     * @param {string} params.bundleId - The bundleId to identify the application receiving the push notification.\n     * @param {string} params.clientCorrelator - Unique identifier for a client device.\n     * @param {string} params.realm - The realm used by the push registration service to identify and\n     *                                establish a connection with the service gateway.\n     * @param {boolean} params.isProduction - If true, push notification will be sent to production.\n     *                                        If false, push notification will be sent to sandbox.\n     * @return {Promise} When successful,  the information of the registration.\n     *                   Promise will reject with error object otherwise.\n     */\n    registerApplePush: function ({\n      services,\n      voipDeviceToken,\n      standardDeviceToken,\n      bundleId,\n      clientCorrelator,\n      realm,\n      isProduction\n    }) {\n      log.debug(API_LOG_TAG + 'notification.registerApplePush', arguments)\n\n      context.dispatch(\n        actions.registerApplePushNotification({\n          services,\n          voipDeviceToken,\n          standardDeviceToken,\n          bundleId,\n          clientCorrelator,\n          realm,\n          isProduction\n        })\n      )\n\n      return operations.registerPushDeviceToken({\n        services,\n        voipDeviceToken,\n        standardDeviceToken,\n        bundleId,\n        clientCorrelator,\n        realm,\n        isProduction,\n        pushProvider: 'apple'\n      })\n    },\n\n    /**\n     * Registers with Google push notification service. Once registration is successful, the application will be able to receive\n     * standard and/or voip push notifications. It can then send these notifications to the SDK with {@link api.notifications.process}\n     * in order for the SDK to process them.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method registerAndroidPush\n     * @param {Object} params\n     * @param {string[]} params.services - Array of services to register for.\n     * @param {string} params.deviceToken - The device token used for standard push on Android. This token is required\n     *                                      when registering for all related services notifications.\n     * @param {string} params.bundleId - The bundleId to identify the application receiving the push notification.\n     * @param {string} params.clientCorrelator - Unique identifier for a client device.\n     * @param {string} params.realm - The realm used by the push registration service to identify\n     *                                and establish a connection with the service gateway.\n     * @return {Promise} When successful,  the information of the registration.\n     *                   Promise will reject with error object otherwise.\n     */\n    registerAndroidPush: function ({ services, deviceToken, bundleId, clientCorrelator, realm }) {\n      log.debug(API_LOG_TAG + 'notification.registerAndroidPush', arguments)\n\n      context.dispatch(\n        actions.registerAndroidPushNotification({\n          services,\n          deviceToken,\n          bundleId,\n          clientCorrelator,\n          realm\n        })\n      )\n\n      return operations.registerPushDeviceToken({\n        services,\n        deviceToken,\n        bundleId,\n        clientCorrelator,\n        realm,\n        pushProvider: 'google'\n      })\n    },\n\n    /**\n     * Unregister Apple push notifications.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method unregisterApplePush\n     * @param {string} registrationInfo - The data returned from the push registration\n     * @return {Promise} When successful, the promise will resolve with undefined.\n     *                   Promise will reject with error object otherwise.\n     */\n    unregisterApplePush: function (registrationInfo) {\n      log.debug(API_LOG_TAG + 'notification.unregisterPush')\n\n      context.dispatch(actions.unregisterApplePushNotification(registrationInfo))\n\n      return operations.unregisterPushDeviceToken(registrationInfo)\n    },\n\n    /**\n     * Unregister Android push notifications.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method unregisterAndroidPush\n     * @param {string} registrationInfo - The data returned from the push registration\n     * @return {Promise} When successful, the promise will resolve with undefined.\n     *                   Promise will reject with error object otherwise.\n     */\n    unregisterAndroidPush: function (registrationInfo) {\n      log.debug(API_LOG_TAG + 'notification.unregisterPush')\n\n      context.dispatch(actions.unregisterAndroidPushNotification(registrationInfo))\n\n      return operations.unregisterPushDeviceToken(registrationInfo)\n    },\n\n    /**\n     * Enables, or disables, the processing of websocket notifications.\n     *\n     * @public\n     * @requires push\n     * @memberof notification\n     * @method enableWebsocket\n     * @param {boolean} enable - Whether the websocket channel should be enabled.\n     */\n    enableWebsocket: async function (enable) {\n      log.debug(API_LOG_TAG + 'notification.enableWebsocket: ', enable)\n\n      context.dispatch(\n        actions.enableNotificationChannel('WEBSOCKET', {\n          channelEnabled: enable\n        })\n      )\n\n      try {\n        await operations.enableWebsocketChannel(enable, 'WEBSOCKET')\n        emitEvent(eventTypes.NOTI_CHANGE, {\n          channel: 'WEBSOCKET'\n        })\n      } catch (error) {\n        emitEvent(eventTypes.NOTI_ERROR, {\n          channel: 'WEBSOCKET',\n          error\n        })\n      }\n    }\n  }\n\n  return { notification: notificationApi }\n}\n","/**\n * Push notifications registration state has changed.\n *\n * @public\n * @requires push\n * @memberof notification\n * @event notifications:change\n * @param {Object} params\n * @param {string} params.channel The channel for the notification.\n */\nexport const NOTI_CHANGE = 'notifications:change'\n\n/**\n * An error occurred with push notifications.\n *\n * @public\n * @requires push\n * @memberof notification\n * @event notifications:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n * @param {string} params.channel The channel for the notification.\n */\nexport const NOTI_ERROR = 'notifications:error'\n\n/**\n * A notification was received by the SDK.\n *\n * @private This is an undocumented feature.\n *\n * @event notification:received\n * @param {Object} params Object that has information about the notification.\n * @param {Object} params.payload The payload of the notification.\n */\nexport const NOTI_RECEIVED = 'notification:received'\n","import reducer from './reducers'\nimport createAPI from './api'\n\nconst name = 'notifications'\n\nexport { name, createAPI, reducer }\n","import * as actionTypes from './actionTypes'\nimport { WS_CONNECT_FINISHED, WS_DISCONNECT_FINISHED } from '../../connectivity/interface/actionTypes'\nimport { handleActions } from 'redux-actions'\n\nconst reducers = {}\n\nreducers[actionTypes.ENABLE_NOTIFICATION_CHANNEL_FINISH] = {\n  next(state, action) {\n    const channel = action.meta.channel\n    const enabled = action.payload.channelEnabled\n\n    let newChannelState\n    if (enabled) {\n      newChannelState = {\n        ...state[channel],\n        ...action.payload\n      }\n    } else {\n      // If the channel is being disabled, clear old state.\n      newChannelState = {\n        ...action.payload\n      }\n    }\n\n    return {\n      ...state,\n      [channel]: newChannelState\n    }\n  }\n}\n\n/*\n * The websocket channel is assumed to be enabled when the\n *      websocket is opened.\n */\nreducers[WS_CONNECT_FINISHED] = {\n  next(state) {\n    // TODO: Link WS only?\n    return {\n      ...state,\n      WEBSOCKET: {\n        ...state.WEBSOCKET,\n        channelEnabled: true\n      }\n    }\n  }\n}\n\n/*\n * The websocket channel is assumed to be disabled when the\n *      websocket is closed.\n */\nreducers[WS_DISCONNECT_FINISHED] = {\n  next(state) {\n    // TODO: Link WS only?\n    return {\n      ...state,\n      WEBSOCKET: {\n        ...state.WEBSOCKET,\n        channelEnabled: false\n      }\n    }\n  }\n}\n\n// Default notifications sub-state.\nconst defaultState = {\n  WEBSOCKET: {\n    channelEnabled: false\n  },\n  PUSH: {\n    channelEnabled: true\n  }\n}\n\n/**\n * Notifications reducer.\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n */\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves the notifications state.\n * @method getNotificationsInfo\n * @param  {String} [channel] - Specific notification channel information to retrieve.\n * @return {Object}\n */\nexport function getNotificationsInfo(state, channel = undefined) {\n  if (channel) {\n    return state.notifications[channel]\n  } else {\n    return state.notifications\n  }\n}\n\n/**\n * Retrieves notification config.\n * @method getNotificationConfig\n * @return {Object}\n */\nexport function getNotificationConfig(state) {\n  return cloneDeep(state.config.notifications)\n}\n","// Notifications plugin\nimport { createAPI, name, reducer } from '../interface'\nimport createMiddleware from '../middleware'\n\nimport * as initOperations from './operations'\nimport createRequests from './requests'\n\n// Other plugins.\nimport { update as updateConfig } from '../../config/interface/actions'\n\n// Libraries\nimport { defaultsDeep } from 'lodash/fp'\n\n// Parse and/or Validate\nimport { validation as v8n, parse, enums } from '../../../src/common/validation'\n\n/**\n * Link Notifications plugin factory.\n * Provides the SDK with the 'Notifications' feature.\n * @method notificationsFactory\n * @param  {Object} [options={}]\n * @return {Object} A plugin object.\n */\nexport default function notificationsFactory(bottle, options = {}) {\n  /**\n   * Configuration options for the notification feature.\n   * @public\n   * @name config.notifications\n   * @memberof config\n   * @instance\n   * @param {Object} notifications - The notifications configuration object.\n   * @param {number} [notifications.idCacheLength=100] - Default amount of event ids to remember for de-duplication purposes.\n   * @param {string} [notifications.incomingCallNotificationMode='any-channel'] - Communication channel mode used for incoming call notifications. Supported values are 'any-channel' or 'push-channel-only'.\n   * @param {Object} [notifications.pushRegistration] - Object describing the server to use for push services.\n   * @param {string} [notifications.pushRegistration.server] - Hostname for the push registration server.\n   * @param {string} [notifications.pushRegistration.port] - Port for the push registration server.\n   * @param {string} [notifications.pushRegistration.protocol] - Protocol for the push registration server.\n   * @param {string} [notifications.pushRegistration.version] - Version for the push registration server.\n   */\n\n  const defaultOptions = {\n    idCacheLength: 100,\n    incomingCallNotificationMode: 'any-channel'\n  }\n\n  // config validation\n  const v8nValidation = v8n.schema({\n    idCacheLength: v8n.positive(),\n    incomingCallNotificationMode: enums(['any-channel', 'push-channel-only']),\n    pushRegistration: v8n.optional(\n      v8n.schema({\n        server: v8n.string(),\n        port: v8n.string(),\n        protocol: v8n.string(),\n        version: v8n.string()\n      })\n    )\n  })\n  const parseOptions = parse('notifications', v8nValidation)\n\n  const pluginOptions = defaultsDeep(defaultOptions, options)\n  parseOptions(pluginOptions)\n\n  function initPlugin(container) {\n    const { context } = container\n    // Update the redux state so that it contains the state.config.messaging sub-state\n    context.dispatch(updateConfig(pluginOptions, name))\n  }\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('NotificationsAPI', createAPI)\n\n  bottle.defer(initPlugin)\n\n  for (const name in initOperations) {\n    initOperations[name](bottle)\n  }\n\n  bottle.factory('NotificationRequests', createRequests)\n\n  const capabilities = ['push', 'registerPushNotifications', 'externalNotifications']\n\n  return {\n    name,\n    capabilities,\n    reducer,\n    middleware: createMiddleware(bottle)\n  }\n}\n","// Re-export all of the operations.\nexport { default as notification } from './notification'\nexport { default as pushRegistration } from './pushRegistration'\n","import * as actions from '../../../interface/actions'\n\n/**\n * Link-specific notification factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The enableWebsocketChannel operation.\n */\nexport default function createOperation(container) {\n  const { context } = container\n\n  async function enableWebsocketChannel(channel, enable) {\n    if (enable) {\n      // TODO: If websockets are not connected, connect them here.\n    }\n\n    // TODO: Handle possible error case when connecting websockets.\n    //      Otherwise, plain dispatch to update state.\n    context.dispatch(\n      actions.enableNotificationChannelFinish(channel, {\n        params: {\n          channelEnabled: enable\n        }\n      })\n    )\n  }\n\n  return enableWebsocketChannel\n}\n","import processNotification from './processNotification'\nimport enableWebsocketChannel from './enableWebsocketChannel'\n\n/*\n * Register the operation with the bottle. This will make it available on the\n *    top-level container under its namespace.\n */\nexport default function registerOperations(bottle) {\n  bottle.factory('NotificationsOperations.enableWebsocketChannel', () => {\n    return enableWebsocketChannel(bottle.container)\n  })\n  bottle.factory('NotificationsOperations.processNotification', () => {\n    return processNotification(bottle.container)\n  })\n}\n","// Notifications plugin\nimport { getNotificationConfig, getNotificationsInfo } from '../../../interface/selectors'\nimport * as actions from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\n\n// Other plugins\nimport { getConnectionInfo } from '../../../../auth/interface/selectors'\n\n// Libraries\nimport { defaults, has } from 'lodash/fp'\n\n/**\n * Link-specific notification factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The processNotification operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, NotificationRequests, emitEvent } = container\n  const log = logManager.getLogger('NOTIFICATIONS')\n\n  /**\n   * This function accepts a notification. If the notification is a spidr notification\n   * and contains an sdpFormat that needs manipulating, it is done here.\n   * @method normalizeSDP\n   * @param notification A processNotification notification\n   * @returns payload A processNotification notification\n   */\n  async function normalizeSDP(notification) {\n    // Copy the notification.\n    notification = { ...notification }\n\n    if (notification.notificationMessage.sessionParams.sdpFormat === 'url') {\n      const connection = getConnectionInfo(context.getState())\n      const { pushRegistration } = getNotificationConfig(context.getState())\n      log.debug(`Found SDP format: url. pushRegistration: ${pushRegistration}`)\n      // If a push registration endpoint was configured, use that instead of default.\n      if (pushRegistration) {\n        connection.server = defaults(connection.server, pushRegistration)\n        connection.protocol = defaults(connection.protocol, pushRegistration)\n        connection.port = defaults(connection.port, pushRegistration)\n        connection.version = defaults(connection.version, pushRegistration)\n      }\n      log.info('Fetching SDP...')\n      try {\n        const response = await NotificationRequests.fetchSDP(\n          connection,\n          notification.notificationMessage.sessionParams.sdp\n        )\n        notification.notificationMessage.sessionParams.sdp = response.eventDataResponse.sdp\n        return notification\n      } catch (error) {\n        // REST request failed.\n        // TODO: Handle the error here rather than throwing an error\n      }\n    } else {\n      log.debug(`Unknown sdpFormat received: ${notification.notificationMessage.sessionParams.sdpFormat}.`)\n      return notification\n    }\n  }\n\n  var queue = []\n\n  async function processNotification(notification, notificationChannel) {\n    const config = getNotificationConfig(context.getState())\n    log.info(`Received notification on channel ${notificationChannel}. Handling...`)\n\n    // Only process notifications from enabled channels, ie. \"silence\" the channel.\n    const channel = getNotificationsInfo(context.getState(), notificationChannel)\n    if (!channel.channelEnabled) {\n      log.debug(`Notification received on disabled channel: ${notificationChannel}. Ignoring it ...`)\n      return\n    }\n\n    const notificationMessage = notification.notificationMessage\n    const notificationId = notificationMessage.eventId\n    log.debug(`The received notification is of type ${notificationMessage.eventType}.`)\n\n    let formattedNotification = notification\n    if (has('notificationMessage.sessionParams.sdpFormat', notification)) {\n      log.debug('Notification contains SDP. Normalizing.')\n      formattedNotification = await normalizeSDP(notification)\n    }\n\n    // If we're in the PUSH-only notification mode and\n    // this incoming notification is coming through a channel other than PUSH channel (e.g. WEBSOCKET) and\n    // this notification is for an incoming call\n    if (\n      formattedNotification.notificationMessage.eventType === 'call' &&\n      config.incomingCallNotificationMode === 'push-channel-only' &&\n      channel !== 'PUSH'\n    ) {\n      // Ignore this call-related notification, but at a minimum generate a log so that user is aware.\n      log.warn(\n        'Dropped incoming call notification with id: ' +\n          notificationId +\n          ' received through channel: ' +\n          channel +\n          ' because current mode for handling notifications is set to: push-channel-only.'\n      )\n    } else {\n      // Don't check for duplicate notifications if idCacheLength is set to 0\n      // Get the list of \"relevant\" IDs in the queue (\"relevant\" being the latest X elements).\n      // This covers edge-cases where the cache length config is changed (to a smaller number)\n      //    after the queue has begun to be populated.\n      const ids = config.idCacheLength === 0 ? [] : queue.slice(config.idCacheLength * -1)\n      // If the notification ID is part of the list, then it's a duplicate.\n      const duplicate = ids.includes(notificationId)\n      if (duplicate) {\n        log.info('Notification was a duplicate; ignoring.')\n        const error = new Error(`Notification id ${notificationId} is duplicate.`)\n        // TODO: Tech-debt; this action should be a notificationReceived error action.\n        //      But that requires all sagas listening for notifications to filter out\n        //      error actions ..which requires their take() patterns changed, which\n        //      is another tech-debt item.\n        context.dispatch(actions.processNotificationFinish(error))\n      } else {\n        queue.push(notificationId)\n        // Because the client can update the value of idCacheLength at any time\n        // we have to adjust the size of our queue accordingly\n        while (queue.length > config.idCacheLength) {\n          queue.shift()\n        }\n\n        // Inform all other plugins by sending a NOTIFICATION_RECEIVED action\n        context.dispatch(actions.notificationReceived(formattedNotification, notificationChannel))\n\n        // For backwards compatibility, also emit the event that 'notificationReceived' action normally emits.\n        emitEvent(eventTypes.NOTI_RECEIVED, { payload: { ...formattedNotification } })\n      }\n    }\n  }\n\n  return processNotification\n}\n","import registerPushDeviceToken from './registerPushDeviceToken'\nimport unregisterPushDeviceToken from './unregisterPushDeviceToken'\n\n/*\n * Register the operation with the bottle. This will make it available on the\n *    top-level container under its namespace.\n */\nexport default function registerOperations(bottle) {\n  bottle.factory('NotificationsOperations.registerPushDeviceToken', () => {\n    return registerPushDeviceToken(bottle.container)\n  })\n  bottle.factory('NotificationsOperations.unregisterPushDeviceToken', () => {\n    return unregisterPushDeviceToken(bottle.container)\n  })\n}\n","// Libraries.\nimport { defaults } from 'lodash/fp'\n\nimport { getNotificationConfig } from '../../../interface/selectors'\n// Other plugins.\nimport { getConnectionInfo } from '../../../../auth/interface/selectors'\n\n/**\n * Link-specific push notification factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The registerPushDeviceToken operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, NotificationRequests } = container\n  const log = logManager.getLogger('NOTIFICATIONS')\n\n  /**\n   * Operation for registering a device token for push notifications.\n   * @method registerPushDeviceToken\n   */\n  async function registerPushDeviceToken(params) {\n    const connection = getConnectionInfo(context.getState())\n    const { pushRegistration } = getNotificationConfig(context.getState())\n\n    // If a push registration endpoint was configured, use that instead of default.\n    if (pushRegistration) {\n      connection.server = defaults(connection.server, pushRegistration)\n    }\n\n    log.info('Registering device token for PUSH notifications...')\n    return await NotificationRequests.pushNotificationsRegistration(connection, {\n      ...params\n    })\n  }\n\n  return registerPushDeviceToken\n}\n","// Libraries.\nimport { defaults } from 'lodash/fp'\n\nimport { getNotificationConfig } from '../../../interface/selectors'\n// Other plugins.\nimport { getConnectionInfo } from '../../../../auth/interface/selectors'\n\n/**\n * Link-specific push notification factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The unregisterPushDeviceToken operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, NotificationRequests } = container\n  const log = logManager.getLogger('NOTIFICATIONS')\n\n  /**\n   * Operation for deregistering a device token for push notifications.\n   * @method deregisterPushDeviceToken\n   */\n  async function unregisterPushDeviceToken(registration) {\n    const connection = getConnectionInfo(context.getState())\n    const { pushRegistration } = getNotificationConfig(context.getState())\n\n    // If a push registration endpoint was configured, use that instead of default.\n    if (pushRegistration) {\n      connection.server = defaults(connection.server, pushRegistration)\n    }\n\n    log.info('Un-registering device token for PUSH notifications...')\n    return await NotificationRequests.pushNotificationsDeRegistration(connection, {\n      registration\n    })\n  }\n\n  return unregisterPushDeviceToken\n}\n","// Error plugin\nimport BasicError from '../../errors'\n\n/**\n * Messaging Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's Messaging REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for Messaging.\n */\nexport default function createRequests(container) {\n  const { logManager, sendRequest } = container\n  const log = logManager.getLogger('NOTIFICATIONS')\n\n  /**\n   * Registers a device token with On-Prem services.\n   * @method pushNotificationsRegistration\n   * @param  {Object} connection - Information for formatting the request.\n   * @param  {Object} options\n   * @param  {string[]} options.services - Push service to register to; either 'google' or 'apple'.\n   * @param {string} options.pushProvider - The push provider, can be either 'apple' or 'google'.\n   * @param  {string} options.bundleId - The bundle id to use for registration.\n   * @param  {string} options.deviceToken\n   * @param {string} options.voipDeviceToken - Token for call related service.\n   * @param {string} options.standardDeviceToken - Token for non-call related service.\n   * @param  {string} options.clientCorrelator - Unique identifier for a client device.\n   * @param {string} options.realm - The realm used by the push registration service to identify\n   *                                and establish a connection with the service gateway.\n   * @param {boolean} options.isProduction - If true, push notification will be sent to production. If false, push notification will be sent to sandbox.\n   * @return {Object} response\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function pushNotificationsRegistration(\n    connection,\n    {\n      services,\n      pushProvider,\n      bundleId,\n      deviceToken,\n      voipDeviceToken,\n      standardDeviceToken,\n      clientCorrelator,\n      realm,\n      isProduction\n    }\n  ) {\n    const { server } = connection\n    pushProvider = pushProvider.toLowerCase()\n    const url =\n      `${server.protocol}://${server.server}:${server.port}/` +\n      `rest/version/${server.version}/` +\n      `user/${connection.username}/` +\n      'push/' +\n      pushProvider +\n      '/devices/'\n    const method = 'POST'\n    let body = {\n      bundleID: bundleId,\n      service: services,\n      clientCorrelator: clientCorrelator,\n      realm: realm,\n      isProduction: isProduction\n    }\n\n    if (pushProvider === 'apple') {\n      body.voipDeviceToken = voipDeviceToken\n      body.standardDeviceToken = standardDeviceToken\n    } else {\n      body.deviceToken = deviceToken\n    }\n\n    body = JSON.stringify(body)\n    log.debug(`Sending PUSH register request: ${method} ${url}`)\n\n    const response = await sendRequest({ url, method, body })\n\n    const { body: responseBody, error, result } = response\n\n    let registrationResponse\n    const responseName = pushProvider + 'DeviceRegistrationResponse'\n    if (responseBody && responseBody[responseName]) {\n      registrationResponse = responseBody[responseName]\n    }\n\n    if (error) {\n      log.info('Failed to register device token for PUSH notifications.')\n      if (registrationResponse) {\n        // Handle errors from the server.\n        const statusCode = registrationResponse.statusCode\n        log.debug(`Device registration request for PUSH notifications failed with status code: ${statusCode}`)\n\n        throw new BasicError({\n          code: statusCode,\n          message: `Failed to register device token for PUSH notifications. Code: ${statusCode}`\n        })\n      } else {\n        // Handle errors from the request helper.\n        const { message } = result\n        log.debug(`Device registration request for PUSH notifications failed with message: ${message}.`)\n\n        throw new BasicError({\n          code: result.code,\n          message: `Failed to register device token for PUSH notifications. Error: ${result.message}`\n        })\n      }\n    } else if (registrationResponse && registrationResponse.statusCode !== 0) {\n      log.info(`Failed to register device token for PUSH notifications. Code: ${registrationResponse.statuscode}`)\n      // TODO: Is this else-if needed?\n      throw new BasicError({\n        code: registrationResponse.statusCode,\n        message: `Failed to register device token for PUSH notifications. Error: ${registrationResponse.statusCode}`\n      })\n    } else {\n      log.info('Successfully registered device token for PUSH notifications.')\n      return {\n        error: false,\n        ...registrationResponse\n      }\n    }\n  }\n\n  /**\n   * De-Registers a device token with On-Prem services.\n   * @method pushNotificationsDeRegistration\n   * @param  {Object} connection - Information for formatting the request.\n   * @param  {Object} options\n   * @param  {string} options.registration\n   * @return {Object} response\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function pushNotificationsDeRegistration(connection, { registration }) {\n    const { server } = connection\n    const url = `${server.protocol}://${server.server}:${server.port}${registration}`\n    const method = 'DELETE'\n    const responseType = 'none'\n\n    log.debug(`Sending PUSH unregister request: ${method} ${url}`)\n    const response = await sendRequest({ url, method, responseType })\n\n    if (response.error) {\n      log.info('Failed to unregister device token for PUSH notifications.')\n      if (response.payload.body) {\n        // Handle errors from the server.\n        const { statusCode } = response.payload.body\n        log.debug(`Failed to unregister device token for PUSH notifications. Status code: ${statusCode}.`)\n        throw new BasicError({\n          code: statusCode,\n          message: `Failed to unregister device token for PUSH notifications. Code: ${statusCode}.`\n        })\n      } else {\n        // Handle errors from the request helper.\n        const { message } = response.payload.result\n        log.debug(`Device token unregistration request failed for PUSH notifications: ${message}`)\n        throw new BasicError({\n          code: response.payload.result.code,\n          message: `Device token unregistration request failed for PUSH notifications: ${message}`\n        })\n      }\n    } else {\n      log.info('Successfully unregistered device token for PUSH notifications.')\n      // Successful de-register has no response.\n      return {\n        error: false\n      }\n    }\n  }\n\n  /**\n   * Fetches SDP data from a given partial URL.\n   * @method fetchSDP\n   * @param  {Object} partialUrl - A partial URL. Contains everything after the protocol://server:port\n   * @return {Object} response A response payload\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function fetchSDP(connection, partialUrl) {\n    const { server } = connection\n    const method = 'GET'\n    const url = `${server.protocol}://${server.server}:${server.port}${partialUrl}`\n    log.debug(`Sending request to fetch SDP: ${method} ${url}`)\n\n    const response = await sendRequest({\n      url,\n      method\n    })\n\n    if (!response.error) {\n      log.info('SDP fetched successfully.')\n      // TODO: test and see what this format actually is.\n      return response.body\n    } else {\n      log.debug(`Failed to fetch SDP. Error is: ${JSON.stringify(response.error)}`)\n      throw new BasicError({\n        code: response.payload.result.code,\n        message: response.payload.result.message\n      })\n    }\n  }\n\n  return {\n    pushNotificationsRegistration,\n    pushNotificationsDeRegistration,\n    fetchSDP\n  }\n}\n","/**\n * Middleware factory for the Notifications plugin.\n */\nexport default function createMiddleware(bottle) {\n  // List of all listeners that are waiting for actions.\n  const actionListeners = []\n\n  /*\n   * The middleware that will be given to the Factory.\n   *\n   * TODO: This middleware is used by different plugins to wait until a specific action\n   *    is dispatched. Need a new pub/sub framework to provide equivalent functionality\n   *    without it needing to be actions.\n   */\n  const middleware = context => next => action => {\n    // Act after the action has gone through the reducers.\n    const returnVal = next(action)\n\n    let i = actionListeners.length\n    // Start from the end of the list so we can remove items from the list\n    //    without making it complicated to iterate over everything.\n    while (i--) {\n      const listener = actionListeners[i]\n      /*\n       * If the action matches a listener, then process the action with the listener\n       *    and eventually call the listener's callback function.\n       */\n      if (listener.pattern(action)) {\n        /*\n         * If this `take` was only intended for a single action, remove the listener\n         *    from the list and clear its timeout.\n         */\n        if (listener.singleTake) {\n          actionListeners.splice(i, 1)\n          if (listener.timeoutId) {\n            clearTimeout(listener.timeoutId)\n          }\n        }\n\n        listener.callback(action)\n      }\n    }\n    return returnVal\n  }\n\n  /**\n   * Utility function for operations to pause until an action is dispatched.\n   *\n   * Using this function should be avoided if possible. This was created as a stop-gap\n   *    so pre-redesign sagas and post-redesign operations could still work together.\n   *    ie. so a saga that is triggered by an action, then responds by dispatching\n   *    another action, can be used by an operation.\n   *\n   * TODO: This should eventually be removed when actions are no longer being used to communicate\n   *    between functions.\n   *\n   * @method waitForAction\n   * @param {Function} pattern Function that decides whether the action should trigger the listener.\n   * @param {number} [timeout] Delay, in milleseconds, to wait for the action before rejecting the promise.\n   * @return {Promise} Promise that resolves when the action has been dispatched.\n   * @example\n   * const takeAction = container.Notifications.takeAction\n   * const action = await takeAction((action) => ...)\n   */\n  function takeAction(pattern, timeout) {\n    if (typeof pattern === 'string') {\n      // If a single action type was passed in, convert it to a function for consistency.\n      const actionType = pattern\n      pattern = action => action.type === actionType\n    }\n\n    return new Promise((resolve, reject) => {\n      let timeoutId\n      // If a timeout was provided, reject the promise after that long.\n      if (typeof timeout === 'number') {\n        timeoutId = setTimeout(reject, timeout)\n      }\n\n      actionListeners.push({\n        singleTake: true,\n        pattern,\n        callback: resolve,\n        timeoutId\n      })\n    })\n  }\n\n  /**\n   * Utility function to act on dispatched actions.\n   * Will call the provided callback function every time a matching action is\n   *    dispatched.\n   *\n   * This was created as a stop-gap between pre-redesign sagas and post-redesign\n   *    operations. It simulates the behaviour of a redux middleware without\n   *    other Plugins needing to actually create/use a redux middleware themselves.\n   *\n   * TODO: This should eventually be removed when actions are no longer being used to communicate\n   *    between functions.\n   *\n   * @method takeEveryAction\n   * @param {Function} pattern Function that decides whether the action should trigger the listener.\n   * @param {Function} callback Function to be called with a matched action.\n   * @return {undefined}\n   * @throws {Error} When either parameter provided is invalid.\n   * @example\n   * const takeEveryAction = container.Notifications.takeEveryAction\n   * takeAction((action) => { ... }, aCallback)\n   *\n   * function aCallback (action) { ... }\n   */\n  function takeEveryAction(pattern, callback) {\n    if (typeof pattern === 'string') {\n      // If a single action type was passed in, convert it to a function for consistency.\n      const actionType = pattern\n      pattern = action => action.type === actionType\n    }\n\n    if (typeof pattern !== 'function' || typeof callback !== 'function') {\n      throw new Error('takeEveryAction parametesr must be functions.')\n    }\n\n    actionListeners.push({\n      singleTake: false,\n      pattern,\n      callback\n    })\n  }\n\n  // Add the utilities to the bottle container.\n  bottle.value('Notifications.takeAction', takeAction)\n  bottle.value('Notifications.takeEveryAction', takeEveryAction)\n\n  return middleware\n}\n","const prefix = '@@KANDY/PRESENCE/'\n\nexport const UPDATE = prefix + 'UPDATE'\nexport const UPDATE_FINISH = prefix + 'UPDATE_FINISH'\nexport const GET = prefix + 'GET'\nexport const GET_FINISH = prefix + 'GET_FINISH'\nexport const SUBSCRIBE = prefix + 'SUBSCRIBE'\nexport const SUBSCRIBE_FINISH = prefix + 'SUBSCRIBE_FINISH'\nexport const UNSUBSCRIBE = prefix + 'UNSUBSCRIBE'\nexport const UNSUBSCRIBE_FINISH = prefix + 'UNSUBSCRIBE_FINISH'\nexport const RECEIVED = prefix + 'RECEIVED'\nexport const CREATE_PRESENCE_LIST = prefix + 'CREATE_PRESENCE_LIST'\nexport const CREATE_PRESENCE_LIST_FINISH = prefix + 'CREATE_PRESENCE_LIST_FINISH'\nexport const DELETE_PRESENCE_LIST = prefix + 'DELETE_PRESENCE_LIST'\nexport const GET_PRESENCE_LIST = prefix + 'GET_PRESENCE_LIST'\n","// Presence plugin.\nimport * as actionTypes from './actionTypes'\n\n// Other plugins.\nimport BasicError from '../../errors'\n\n/**\n * Update the presence for the current user\n * @param  {string} status   The status of the presence state\n * @param  {string} activity The activity to be shown as presence state\n * @param  {string} note     The note to be shown as alternative presence state\n *                           which is determined by the user. The note entry is\n *                           effective on the remote sip client when the\n *                           activity is “other”.\n * @return {Object}          A Flux Standard Action for UPDATE_PRESENCE\n */\nexport function updatePresence(status, activity, note) {\n  return {\n    type: actionTypes.UPDATE,\n    payload: {\n      status,\n      activity,\n      note\n    }\n  }\n}\n\nexport function updatePresenceFinish(payload) {\n  return {\n    type: actionTypes.UPDATE_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\n/**\n * Get the presence for the given user(s)\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for GET_PRESENCE\n */\nexport function getPresence(users) {\n  return {\n    type: actionTypes.GET,\n    payload: users\n  }\n}\n\nexport function getPresenceFinish(payload) {\n  return {\n    type: actionTypes.GET_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\n/**\n * Subscribe to the presence for the given user(s)\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for SUBSCRIBE_PRESENCE\n */\nexport function subscribePresence(users) {\n  return {\n    type: actionTypes.SUBSCRIBE,\n    payload: users\n  }\n}\n\nexport function subscribePresenceFinish(result) {\n  if (!Array.isArray(result.presentityUserId)) {\n    result.presentityUserId = [result.presentityUserId]\n  }\n  return {\n    type: actionTypes.SUBSCRIBE_FINISH,\n    error: result instanceof Error || result instanceof BasicError,\n    payload: result\n  }\n}\n\n/**\n * Unsubscribe from the presence for the given user(s)\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function unsubscribePresence(users) {\n  return {\n    type: actionTypes.UNSUBSCRIBE,\n    payload: users\n  }\n}\n\nexport function unsubscribePresenceFinish(result) {\n  if (result.presentityUserId && !Array.isArray(result.presentityUserId)) {\n    result.presentityUserId = [result.presentityUserId]\n  }\n  return {\n    type: actionTypes.UNSUBSCRIBE_FINISH,\n    error: result instanceof Error || result instanceof BasicError,\n    payload: result\n  }\n}\n\n/**\n * Create a new presence list\n * @param  {string} users  A user id or an array of user ids.\n * @return {Object}        A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function createPresenceList(users) {\n  return {\n    type: actionTypes.CREATE_PRESENCE_LIST,\n    payload: users\n  }\n}\n\n/**\n * Delete a presence list\n * @param  {string} presenceListId  The ID of the presence list to delete.\n * @return {Object}                 A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function deletePresenceList(presenceListId) {\n  return {\n    type: actionTypes.DELETE_PRESENCE_LIST,\n    payload: presenceListId\n  }\n}\n\n/**\n * Retrieve a presence list\n * @param  {string} presenceListId  The ID of the presence list to delete.\n * @return {Object}                 A Flux Standard Action for UNSUBSCRIBE_PRESENCE\n */\nexport function getPresenceList(presenceListId) {\n  return {\n    type: actionTypes.GET_PRESENCE_LIST,\n    payload: presenceListId\n  }\n}\n\nexport function createListFinish(payload) {\n  return {\n    type: actionTypes.CREATE_PRESENCE_LIST_FINISH,\n    error: payload instanceof Error || payload instanceof BasicError,\n    payload\n  }\n}\n\nexport function presenceReceived(presence) {\n  return {\n    type: actionTypes.RECEIVED,\n    payload: presence\n  }\n}\n","/**\n * The 'presence' namespace provides an interface for an application to set the\n *    User's presence information and to track other Users' presence\n *    information.\n *\n * Presence information is persisted by the server. When the SDK is initialized,\n *    there will be no information available. Presence information will become\n *    available either by using {@link presence.fetch} or by subscribing for\n *    updates about other Users, using {@link presence.subscribe}.\n *\n * Available presence information can be retrieved using {@link presence.get} or\n *    {@link presence.getAll}.\n *\n * @public\n * @requires presence\n * @namespace presence\n */\n\n/**\n * The PresenceStatus type defines the user's current status in terms of the user's availability to\n * communicate/respond to other users in the network.\n * An instance of this type can be obtained by invoking the {@link presence.get} function.\n *\n * Reporting when a user is on the phone is enabled (by default), which means that presence update notifications\n * will be sent whenever a user is in a call, as well as when the call has ended.\n * This is a user preference enabled or disabled on server side, and it can only be changed on the server side.\n *\n * The status is set to {@link presence.statuses open} as soon as a user subscribes for the presence service.\n *\n * @public\n * @static\n * @typedef {Object} PresenceStatus\n * @memberof presence\n * @property {string} userId The unique identifier for the user associated with this presence status.\n * @property {string} status The current status the user has set for themselves. For supported values see {@link presence.statuses}.\n * @property {string} activity The current activity of the user.\n *      For supported values see {@link presence.activities}.\n * @property {string} note Additional message accompanying the status & activity.\n * @property {boolean} loading Whether the presence information has been loaded or is in the process of loading.\n */\n\nimport { SELF_CHANGE, ERROR } from './eventTypes'\nimport * as selectors from './selectors'\n\n/**\n * Presence API factory function.\n * Defines the interface between the application and the SDK's Presence APIs.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @return {Object} Available public APIs for Presence.\n */\nexport default function createAPI(container) {\n  const { emitEvent, PresenceOperations: operations, logManager, API_LOG_TAG, context } = container\n  const log = logManager.getLogger('PRESENCE')\n\n  const presenceApi = {\n    /**\n     * Updates the presence information for the current user.\n     *\n     * See {@link presence.statuses} and {@link presence.activities} for valid\n     *    values.\n     *\n     * The SDK will emit a\n     *    {@link presence.event:presence:selfChange presence:selfChange} event\n     *    when the operation completes. The updated presence information is\n     *    available and can be retrieved with {@link presence.getSelf}.\n     *\n     * Other users subscribed for this user's presence will receive a\n     *    {@link presence.event:presence:change presence:change} event.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method update\n     * @param  {string} status The status of the presence state.\n     * @param  {string} activity The activity to be shown as presence state\n     * @param  {string} [note] An additional note to be provided when the activity is `presence.activities.ACTIVITIES_OTHER`.\n     */\n    async update(status, activity, note) {\n      log.debug(API_LOG_TAG + 'presence.update: ', status, activity, note)\n      try {\n        await operations.update(status, activity, note)\n        emitEvent(SELF_CHANGE, {})\n      } catch (error) {\n        emitEvent(ERROR, { error })\n      }\n    },\n\n    /**\n     * Fetches presence information for the given users. This will refresh the\n     *    available information with any new information from the server.\n     *\n     * Available presence information an be retrieved using the\n     *    {@link presence.get} or {@link presence.getAll} APIs.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method fetch\n     * @param {Array<string>|string} user A User ID or an array of User IDs.\n     */\n    async fetch(user) {\n      log.debug(API_LOG_TAG + 'presence.fetch: ', user)\n      const users = Array.isArray(user) ? user : [user]\n      try {\n        await operations.fetch(users)\n      } catch (error) {\n        emitEvent(ERROR, { error })\n      }\n    },\n\n    /**\n     * Subscribe to another User's presence updates.\n     *\n     * When the User updates their presence information, the SDK will emit a\n     *    {@link presence.event:presence:change presence:change} event.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method subscribe\n     * @param {Array<string>|string} users A User ID or an array of User IDs.\n     */\n    async subscribe(users) {\n      log.debug(API_LOG_TAG + 'presence.subscribe: ', users)\n      users = Array.isArray(users) ? users : [users]\n      try {\n        await operations.subscribe(users)\n      } catch (error) {\n        emitEvent(ERROR, { error })\n      }\n    },\n\n    /**\n     * Unsubscribe from another User's presence updates.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method unsubscribe\n     * @param {Array<string>|string} users A User ID or an array of User IDs.\n     */\n    async unsubscribe(users) {\n      log.debug(API_LOG_TAG + 'presence.unsubscribe: ', users)\n      users = Array.isArray(users) ? users : [users]\n      try {\n        await operations.unsubscribe(users)\n      } catch (error) {\n        emitEvent(ERROR, { error })\n      }\n    },\n\n    /**\n     * Retrieves the presence information for specified users, if available.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method get\n     * @param  {Array<string>|string} user A User ID or an array of User IDs.\n     * @return {Array<Object>|Object} List of user presence information.\n     */\n    get(user) {\n      log.debug(API_LOG_TAG + 'presence.get: ', user)\n      const users = Array.isArray(user) ? user : [user]\n      const storedUsers = selectors.getPresence(context.getState(), users)\n      // return something sensible based on the input\n      if (!Array.isArray(users)) {\n        if (storedUsers.length) {\n          return storedUsers[0]\n        }\n        return undefined\n      }\n      return storedUsers\n    },\n\n    /**\n     * Retrieves the presence information for all available users.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method getAll\n     * @return {Array<Object>} List of user presence information.\n     */\n    getAll() {\n      log.debug(API_LOG_TAG + 'presence.getAll: ')\n      return selectors.getAllPresence(context.getState())\n    },\n\n    /**\n     * Retrieves the presence information for the current user.\n     *\n     * This information is set using the {@link presence.update} API.\n     *\n     * @public\n     * @static\n     * @memberof presence\n     * @requires presence\n     * @method getSelf\n     * @return {Object} Presence information for the current user.\n     */\n    getSelf() {\n      log.debug(API_LOG_TAG + 'presence.getSelf: ')\n      return selectors.getSelfPresence(context.getState())\n    }\n  }\n\n  return { presence: presenceApi }\n}\n","/**\n * A presence update about a subscribed user has been received.\n *\n * This event is generated as a result of {@link presence.fetch} or {@link presence.update} operations.\n *\n * For the latter operation, the current user receives a presence update of another user that the current user is subscribed to.\n *\n * The changed information can be retrieved using the {@link presence.get}\n *    API.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:change\n * @param {Object} params A presence object containing data.\n * @param {string} params.userId The ID of the user.\n * @param {string} params.status The presence status of the user.\n * @param {string} params.activity The activity of the user.\n * @param {string} params.note A custom note provided by the user.\n */\nexport const RECEIVED = 'presence:change'\n\n/**\n * The current user's presence information has changed.\n *\n * The changed information can be retrieved using the {@link presence.getSelf}\n *    API.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:selfChange\n */\nexport const SELF_CHANGE = 'presence:selfChange'\n\n/**\n * An update (as a result of subscribing to a specific user's presence) has been received.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:subscribe\n * @param {Object} params A subscription object containing data.\n * @param {Array<string>} params.userIds The ID(s) of the user(s) whose presence needs to be watched.\n */\nexport const SUBSCRIBE = 'presence:subscribe'\n\n/**\n * An update (as a result of unsubscribing to a specific user's presence) has been received.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:unsubscribe\n * @param {Object} params A subscription object containing data.\n * @param {Array<string>} params.userIds The ID(s) of the user(s) whose presence no longer requires to be watched.\n */\nexport const UNSUBSCRIBE = 'presence:unsubscribe'\n\n/**\n * An error occurred with presence.\n *\n * @public\n * @memberof presence\n * @requires presence\n * @event presence:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n */\nexport const ERROR = 'presence:error'\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducers'\n\n/**\n * This interface is for a presence plugin.\n * @type {string}\n */\nconst name = 'presence'\n\nexport { name, api, reducer }\n","import * as actionTypes from './actionTypes'\n\n// Libraries\nimport { handleActions } from 'redux-actions'\nimport { omit } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.UPDATE] = {\n  next(state) {\n    return {\n      ...state,\n      self: {\n        ...state.self,\n        loading: true,\n        error: false\n      }\n    }\n  }\n}\n\nreducers[actionTypes.UPDATE_FINISH] = {\n  next(state, action) {\n    const result = {\n      ...state,\n      self: {\n        loading: false,\n        error: false,\n        status: action.payload.status,\n        activity: action.payload.activity\n      }\n    }\n    if (action.payload.note) {\n      result.self.note = action.payload.note\n    }\n    return result\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      self: {\n        ...state.self,\n        loading: false,\n        error: action.payload\n      }\n    }\n  }\n}\n\nreducers[actionTypes.GET] = {\n  next(state, { payload: userIds }) {\n    const users = { ...state.users }\n    for (const userId of userIds) {\n      users[userId] = {\n        userId,\n        loading: true\n      }\n    }\n    return { ...state, users }\n  }\n}\n\nreducers[actionTypes.GET_FINISH] = {\n  next(state, { payload }) {\n    const users = {}\n\n    for (const presence of payload) {\n      if (presence.userId) {\n        // userId is a mandatory property\n        presence.loading = false\n        users[presence.userId] = presence\n      }\n    }\n\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        ...users\n      }\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state\n    }\n  }\n}\n\nreducers[actionTypes.RECEIVED] = {\n  next(state, { payload }) {\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        [payload.userId]: {\n          userId: payload.userId, // optimize for filtering by userId\n          status: payload.status,\n          activity: payload.activity,\n          note: payload.note,\n          loading: false\n        }\n      }\n    }\n  }\n}\n\nreducers[actionTypes.SUBSCRIBE] = {\n  next(state, { payload }) {\n    // Payload could be a string (single userId) or array (multiple userIds)\n    if (!Array.isArray(payload)) {\n      payload = [payload]\n    }\n    const updatedUsers = Object.assign({}, state.users)\n    payload.forEach(userId => {\n      updatedUsers[userId] = {\n        userId,\n        loading: false,\n        isPending: true\n      }\n    })\n\n    return {\n      ...state,\n      users: updatedUsers\n    }\n  }\n}\n\nreducers[actionTypes.SUBSCRIBE_FINISH] = {\n  next(state, { payload }) {\n    const updatedUsers = Object.assign({}, state.users)\n    payload.presentityUserId.forEach(userId => {\n      updatedUsers[userId] = {\n        userId,\n        loading: false,\n        isPending: false\n      }\n    })\n\n    return {\n      ...state,\n      users: updatedUsers\n    }\n  },\n  throw(state, { payload }) {\n    const updatedUsers = Object.assign({}, state.users)\n    payload.presentityUserId.forEach(userId => {\n      delete updatedUsers[userId]\n    })\n\n    return {\n      ...state,\n      users: updatedUsers\n    }\n  }\n}\n\nreducers[actionTypes.UNSUBSCRIBE] = {\n  next(state, { payload }) {\n    // Payload could be a string (single userId) or array (multiple userIds)\n    if (!Array.isArray(payload)) {\n      payload = [payload]\n    }\n    const updatedUsers = Object.assign({}, state.users)\n    payload.forEach(userId => {\n      updatedUsers[userId] = {\n        userId,\n        loading: false,\n        isPending: true\n      }\n    })\n\n    return {\n      ...state,\n      users: updatedUsers\n    }\n  }\n}\n\nreducers[actionTypes.UNSUBSCRIBE_FINISH] = {\n  next(state, { payload }) {\n    return {\n      ...state,\n      users: omit(payload.presentityUserId, state.users)\n    }\n  },\n  throw(state, { payload }) {\n    const updatedUsers = Object.assign({}, state.users)\n    // Update the userId in state\n    if (payload.presentityUserId && payload.presentityUserId.length > 0) {\n      payload.presentityUserId.forEach(userId => {\n        updatedUsers[userId] = {\n          userId,\n          loading: false,\n          isPending: false\n        }\n      })\n    }\n\n    return {\n      ...state,\n      users: updatedUsers\n    }\n  }\n}\n\nconst reducer = handleActions(reducers, { self: {}, users: {} })\nexport default reducer\n","export function getPresence(state, users) {\n  // If no users specified, return them all\n  if (!users) {\n    return state.presence.users\n  }\n\n  // Grab all users that match the passed in IDs, return\n  return Object.values(state.presence.users).filter(user => users.indexOf(user.userId) !== -1)\n}\n\n/**\n * Retrieves presence information for all users.\n * @method getAllPresence\n * @param  {Object} state Redux state.\n * @return {Array}  List of presence information for users.\n */\nexport function getAllPresence(state) {\n  return Object.values(state.presence.users)\n}\n\n/**\n * Retrieves the current user's self presence.\n * @method getSelfPresence\n * @param  {Object} state Redux state.\n * @return {Object} Self-presence information.\n */\nexport function getSelfPresence(state) {\n  return state.presence.self\n}\n","/**\n * The status of the presence state\n * @name STATUS\n */\nexport const STATUS = {\n  OPEN: 'open',\n  CLOSED: 'closed'\n}\n\n/**\n * The presence activity\n * @name ACTIVITY\n */\nexport const ACTIVITY = {\n  ACTIVE: 'active',\n  IDLE: 'idle',\n  AWAY: 'away',\n  LUNCH: 'lunch',\n  OTHER: 'other',\n  BUSY: 'busy',\n  VACATION: 'vacation',\n  ON_THE_PHONE: 'on-the-phone',\n  UNKNOWN: 'unknown'\n}\n","import { name, reducer } from '../interface'\nimport createAPI from '../interface/api'\nimport createMiddleware from './middleware'\nimport createOperations from './operations'\nimport createRequests from './requests'\nimport { STATUS, ACTIVITY } from './constants'\n\n/**\n * Link Presence plugin factory.\n * @method presenceFactory\n * @return {Object} A plugin.\n */\nexport default function presenceFactory(bottle) {\n  // Add plugin-specific things to the API.\n  function augmentedApi(container) {\n    const newApi = createAPI(container)\n\n    /**\n     * Possible status values.\n     * @public\n     * @static\n     * @memberof presence\n     * @type {Object}\n     * @property {string} OPEN\n     * @property {string} CLOSED\n     * @example\n     * const { statuses, activities } = client.presence\n     * // Use the values when updating presence.\n     * client.presence.update(statuses.OPEN, activities.AVAILABLE)\n     */\n    newApi.presence.statuses = STATUS\n\n    /**\n     * Possible activity values.\n     * @public\n     * @static\n     * @memberof presence\n     * @type {Object}\n     * @property {string} AVAILABLE\n     * @property {string} IDLE\n     * @property {string} AWAY\n     * @property {string} LUNCH\n     * @property {string} BUSY\n     * @property {string} VACATION\n     * @property {string} ON_THE_PHONE\n     * @property {string} UNKNOWN\n     */\n    newApi.presence.activities = ACTIVITY\n    return newApi\n  }\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('PresenceAPI', augmentedApi)\n  bottle.factory('PresenceOperations', createOperations)\n  bottle.factory('PresenceRequests', createRequests)\n\n  const capabilities = ['presence']\n\n  return {\n    capabilities,\n    name,\n    reducer,\n    middleware: createMiddleware\n  }\n}\n","import { NOTIFICATION_RECEIVED } from '../../notifications/interface/actionTypes'\n\n/**\n * Presence middleware factory function.\n * @method createMiddleware\n * @param  {Object} context The factory context.\n * @return {Function} A redux middleware.\n */\nexport default function createMiddleware(context) {\n  const operations = context.container.PresenceOperations\n  /*\n   * Redux middleware: Watch for specific actions and trigger operations\n   *    when we see them.\n   */\n  return next => action => {\n    /*\n     * Let the action happen as it is received.\n     *\n     * The Presence middleware operations are not side-effects, they are\n     *     relevant to the operation being performed. As such they can\n     *     happen when necessary without waiting for other operations.\n     */\n\n    // Presence doesn't act on any other actions.\n    if (\n      action.type === NOTIFICATION_RECEIVED &&\n      action.payload.notificationMessage &&\n      action.payload.notificationMessage.eventType === 'presenceWatcher'\n    ) {\n      // When a notification of type presenceWatcher is received, Presence plugin should deal with it\n      operations.presenceReceived(action)\n    }\n\n    return next(action)\n  }\n}\n","// Presence plugin.\nimport * as actions from '../interface/actions'\nimport * as eventTypes from '../interface/eventTypes'\nimport { getAllPresence } from '../interface/selectors'\n\n// Other plugins\nimport { NOTIFICATION_RECEIVED } from '../../notifications/interface/actionTypes'\n\n// Helpers\nimport BasicError, { presenceCodes } from '../../errors'\n\n// Constants\nimport { ACTIVITY, STATUS } from './constants'\n\n/**\n * Presence Operations factory function.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for Presence.\n */\nexport default function createOperations(container) {\n  const { context, emitEvent, logManager, PresenceRequests: requests } = container\n  const log = logManager.getLogger('PRESENCE')\n\n  /**\n   * Operation to receive Presence info from a notification.\n   * @method presenceReceived\n   * @param {Object} action The action for receiving a user presence notification.\n   */\n  function presenceReceived(action) {\n    const { dispatch, getState } = context\n\n    if (![NOTIFICATION_RECEIVED].includes(action.type)) {\n      return\n    }\n\n    if (!(action.payload.notificationMessage && action.payload.notificationMessage.eventType === 'presenceWatcher')) {\n      return\n    }\n\n    // Find the user in our list of users\n    // If found and not pending then notify the client\n    const params = action.payload.notificationMessage.presenceWatcherNotificationParams\n    const users = getAllPresence(getState())\n    const user = users.find(item => item.userId === params.name)\n    if (user && !user.isPending) {\n      log.info(`Received notification of the user(s): ${params.name} present presence.`)\n      const presence = {\n        userId: params.name,\n        activity: params.activity,\n        status: params.status,\n        note: params.note\n      }\n\n      // Dispatch an action to update state.\n      dispatch(actions.presenceReceived(presence))\n      // Tell the application that state has changed.\n      emitEvent(eventTypes.RECEIVED, presence)\n    }\n  }\n\n  /**\n   * Link operation for updating user(s) Presence .\n   * @method update\n   * @param  {string} status The status of the presence state.\n   * @param  {string} activity The activity to be shown as presence state\n   * @param  {string} [note] An additional note to be provided when the activity is `presence.activities.ACTIVITIES_OTHER`.\n   */\n  async function update(status, activity, note) {\n    const { dispatch } = context\n\n    // Dispatch an updatePresence action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.updatePresence(status, activity, note))\n\n    // Verify that the status value is a valid\n    if (Object.values(STATUS).indexOf(status) === -1) {\n      log.debug('Invalid presence status present.')\n\n      const error = new BasicError({\n        code: presenceCodes.INVALID_STATUS,\n        message: 'Invalid status in presence update request.'\n      })\n\n      dispatch(actions.updatePresenceFinish(error))\n\n      throw error\n    }\n\n    // Verify that the activity value is a valid\n    if (Object.values(ACTIVITY).indexOf(activity) === -1) {\n      log.debug('Invalid presence activity present.')\n\n      const error = new BasicError({\n        code: presenceCodes.INVALID_ACTIVITY,\n        message: 'Invalid activity in presence update request.'\n      })\n\n      dispatch(actions.updatePresenceFinish(error))\n\n      throw error\n    }\n\n    try {\n      await requests.updatePresence(status, activity, note)\n\n      log.debug('Successfully updated presence.')\n\n      // Update state by dispatching an action.\n      dispatch(actions.updatePresenceFinish({ status, activity, note }))\n    } catch (error) {\n      log.debug(`Failed to update presence. Error is: ${error}`)\n      // Dispatch an error action for backwards-compatible of action logs.\n      //     This does not affect state or emit an event.\n      dispatch(actions.updatePresenceFinish(error))\n\n      throw error\n    }\n  }\n\n  /**\n   * Link operation for getting the presence updates one time only for the user(s).\n   * @method fetch\n   * @param  {Array<string>} users An array of User IDs.\n   */\n  async function fetch(users) {\n    const { dispatch } = context\n\n    // Dispatch an updatePresence action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.getPresence(users))\n\n    try {\n      const result = await requests.watchPresence(users, 'get')\n\n      dispatch(actions.getPresenceFinish(result))\n    } catch (error) {\n      dispatch(actions.getPresenceFinish(error))\n\n      throw error\n    }\n  }\n\n  /**\n   * Link operation for Handling subscribing to another users(s) presence.\n   * @method subscribe\n   */\n  async function subscribe(users) {\n    const { dispatch } = context\n\n    // Dispatch an updatePresence action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.subscribePresence(users))\n\n    // Check if no users were passed in\n    if (!users || (users.length === 1 && !users[0])) {\n      // No users passed in\n      throw new BasicError({\n        message: 'No users provided to subscribe to.'\n      })\n    }\n\n    try {\n      log.info(`Subscribing to the user(s) ${users} presence.`)\n\n      const result = await requests.watchPresence(users, 'watch')\n\n      log.info(\n        `Finished subscribing to user(s): ${users} with status code: ${result.presenceWatcherResponse.statusCode}`\n      )\n\n      result.presentityUserId = users\n\n      dispatch(actions.subscribePresenceFinish(result))\n    } catch (error) {\n      log.info(`Failed to subscribe to users(s): ${users}. ${error.message}`)\n\n      error.presentityUserId = users\n\n      dispatch(actions.subscribePresenceFinish(error))\n\n      throw error\n    }\n  }\n\n  /**\n   * Link operation for Handling unsubscribing the user(s) presence.\n   * User will not be able to receive presence updates of the unsubscribed user.\n   * @method unsubscribePresence\n   */\n  async function unsubscribe(users) {\n    const { dispatch } = context\n\n    // Dispatch an updatePresence action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.unsubscribePresence(users))\n\n    // Check if no users were passed in\n    if (!users || (users.length === 1 && !users[0])) {\n      // No users passed in\n      throw new BasicError({\n        message: 'No users provided to unsubscribe to.'\n      })\n    }\n\n    try {\n      log.info(`UnSubscribing to the user(s) ${users} presence.`)\n\n      const result = await requests.watchPresence(users, 'stopwatch')\n\n      log.info(\n        `Finished unSubscribing to user(s): ${users} with status code: ${result.presenceWatcherResponse.statusCode}`\n      )\n\n      result.presentityUserId = users\n\n      dispatch(actions.unsubscribePresenceFinish(result))\n    } catch (error) {\n      log.info(`Failed to unsubscribe to users(s): ${users}. ${error.message}`)\n\n      error.presentityUserId = users\n\n      dispatch(actions.unsubscribePresenceFinish(error))\n\n      throw error\n    }\n  }\n  return {\n    // API operations:\n    presenceReceived,\n    update,\n    fetch,\n    subscribe,\n    unsubscribe\n  }\n}\n","// Other plugins.\nimport { getRequestInfo } from '../../auth/interface/selectors'\nimport BasicError from '../../errors'\n\n/**\n * Presence Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's Presence REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for Presence.\n */\nexport default function createRequests(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('PRESENCE')\n\n  async function updatePresence(status, activity, note) {\n    const requestInfo = getRequestInfo(context.getState())\n    const version = requestInfo.version\n    const url = `${requestInfo.baseURL}/rest/version/${version}/user/${requestInfo.username}/presence`\n\n    const data = { status, activity }\n    if (note) {\n      data.note = note\n    }\n    const bodyData = JSON.stringify({ presenceRequest: data })\n\n    const options = {\n      method: 'POST',\n      url,\n      responseType: 'json',\n      body: bodyData\n    }\n\n    const response = await sendRequest(options)\n    const { body, error, result } = response\n\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.presenceResponse\n        const message = `Failed to update presence with status code ${statusCode}.`\n        log.debug(message)\n\n        throw new BasicError({ message })\n      } else {\n        // Handle errors from the request helper.\n        const { message } = result\n        const errMsg = `Update presence request failed: ${message}`\n        log.info(errMsg)\n\n        throw new BasicError({\n          message: errMsg\n        })\n      }\n    } else {\n      if (body.presenceResponse.statusCode !== 0) {\n        const message = `Failed to update presence. Code: ${body.presenceResponse.statusCode}.`\n        throw new BasicError({ message })\n      }\n    }\n\n    return response\n  }\n\n  /**\n   * Make a request to the presenceWatcher resource\n   * @method watchPresence\n   * @param  {Array<User>}  users  a lits of users for the watch request\n   * @param  {string}       action watch     Starts watching the presence updates\n   *                                         for the users in the users array.\n   *                               stopwatch Stops watching the presence updates\n   *                                         for the users in the users array.\n   *                               get       Gets the presence updates one time\n   *                                         only for the users in the users array.\n   */\n  async function watchPresence(users, action) {\n    const requestInfo = getRequestInfo(context.getState())\n    const version = requestInfo.version\n    const url = `${requestInfo.baseURL}/rest/version/${version}/user/${requestInfo.username}/presenceWatcher`\n\n    const bodyData = JSON.stringify({\n      presenceWatcherRequest: {\n        userList: users,\n        action\n      }\n    })\n\n    const options = {\n      method: 'POST',\n      url,\n      responseType: 'json',\n      body: bodyData\n    }\n\n    const response = await sendRequest(options)\n    const { body, error, result } = response\n\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.presenceWatcherResponse\n        const message = `Failed to watch presence with status code ${statusCode}.`\n        log.debug(message)\n\n        throw new BasicError({ message })\n      } else {\n        // Handle errors from the request helper.\n        const { message } = result\n        const errMsg = `Watch presence request failed: ${message}`\n        log.info(errMsg)\n\n        throw new BasicError({\n          message: errMsg\n        })\n      }\n    } else {\n      if (body.presenceWatcherResponse.statusCode !== 0) {\n        const message = `Failed to execute presence operation (${action}). Code: ${body.presenceWatcherResponse.statusCode}.`\n        throw new BasicError({ message })\n      }\n    }\n    return response.body\n  }\n\n  return {\n    // Operation requests.\n    updatePresence,\n    watchPresence\n  }\n}\n","/**\n * \"Authorization\" issues are REST errors caused by invalid user credentials.\n *    These are issues that should be solvable by an end-user updating/fixing\n *    the credentials that they have provided.\n */\nimport BasicError, { authCodes } from '../errors'\n\n/**\n * Function that checks a REST response action for Link authorization issues.\n * @param  {Object} response A REST response object.\n * @return {BasicError|undefined}\n */\nexport function linkAuthorization(response) {\n  if (!response.error) {\n    return\n  }\n\n  /*\n   * A SPiDR REST request will return\n   *  - '403 Forbidden', with body 'statusCode: 4' for bad password,\n   *  - '403 Forbidden', with html body (which is thrown away) for bad username.\n   *\n   * The SPiDR REST API document (v4.7, May 2019) says it will return '403 Forbidden'\n   *    with other statusCodes for numerous untestable scenarios. Some of these are\n   *    for credential/auth issues, others are for unrelated issues.\n   * Authorization related:\n   *    - 27 (generic auth failure), 61 (credentials issue), 65 (token expired)\n   * Unrelated:\n   *    - 29 (device not authorized), 35 (service not enabled), 37 (invalid value),\n   *      45 (invalid app_name), 46 (invalid CallMe token), 62 (account is disabled),\n   *      63 (account is locked), 64 (invalid CallMe realm)\n   */\n  // Status codes considered to be \"auth issues\".\n  const authIssues = [4, 27, 61, 65]\n\n  const statusCode = getStatusCode(response)\n\n  /*\n   * A case where Link REST request will return '401 Unauthorized'\n   */\n  if (response.result.code === 401) {\n    return new BasicError({\n      code: authCodes.INVALID_CREDENTIALS,\n      message: 'Authorization failed with server. Please check credentials.'\n    })\n  }\n\n  /*\n   * Define a Link authorization issue to be:\n   *  - a '403 Forbidden', with no body or with a specific statusCode.\n   */\n  if (response.result.code === 403 && (response.body === undefined || authIssues.includes(statusCode))) {\n    let message = 'Authorization failed with server. Please check credentials.'\n    if (statusCode) {\n      message += ` Status code: ${statusCode}`\n    }\n    return new BasicError({\n      code: authCodes.INVALID_CREDENTIALS,\n      message: message\n    })\n  }\n}\n\n/**\n * Helper function for parsing a statusCode from a SPiDR REST response body.\n * @param  {Object} response\n * @return {number|undefined}\n */\nfunction getStatusCode(response) {\n  let statusCode\n  /*\n   * Parse the statusCode out from the body.\n   */\n  if (response.body) {\n    if (response.body.statusCode) {\n      // In some cases (eg. KAA-1937), the statusCode is at the top-level of the body.\n      statusCode = response.body.statusCode\n    } else {\n      // In most cases, the statusCode is inside another object. The name of this\n      //    parameter is different depending which service the request was for,\n      //    so search for it.\n      Object.values(response.body).forEach(value => {\n        if (value.statusCode) {\n          statusCode = value.statusCode\n        }\n      })\n    }\n  }\n  return statusCode\n}\n","// Parse and/or Validate\nimport { validation as v8n, parse } from '../../src/common/validation'\n\n/**\n * Configurable properties 'published' by this \"Request\" plugin.\n * NOTE: Do NOT expose the config properties (related to this plugin) to the public API documentation.\n *\n * @property {boolean} [injectAgentVersionHeader=true] Option to automatically inject an agent version header to every REST request.\n *            This header is used to help with diagnostics and analytics in a completely anonymous fashion.\n *\n * @property {string} [customAgentVersionHeaderSuffix=''] Additional custom information that can be appended to the agent version header's value.\n *           This additional suffix value is only used when injectAgentVersionHeader property is enabled.\n */\nexport const defaultOptions = {\n  injectAgentVersionHeader: true,\n  customAgentVersionHeaderSuffix: ''\n}\n\nconst v8nValidation = v8n.schema({\n  injectAgentVersionHeader: v8n.boolean()\n})\nexport const parseOptions = parse('request', v8nValidation)\n","// Request plugin.\nimport { defaultOptions, parseOptions } from './configs'\nimport createRequestHelper from './requestModule'\nimport pluginInterface from './interface'\n\n// Other plugins.\nimport { update as updateConfig } from '../config/interface/actions'\n\n// Utils.\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\n/*\n * HTTP request plugin.\n *\n */\nexport default pluginFactory()\n\n/*\n * Platform-specific request plugins.\n *    Same base REST behaviour as the generic request plugin, with some extra\n *    handling of a response.\n */\nexport const linkRequest = pluginFactory('link')\n\n/**\n * Factory function for creating a Request Plugin.\n *    Allows for specifying which platform the requests will be made to. This\n *    adds special handling of responses to check for special-case issues.\n * @param  {string} [platform] The platform this plugin is for.\n * @return {Function} The actual Plugin creator function.\n */\nfunction pluginFactory(platform) {\n  return function request(bottle, options = {}) {\n    options = mergeValues(defaultOptions, options)\n    parseOptions(options)\n\n    /*\n     * Init function to setup the Request plugin.\n     * @param {Object} container The bottle container.\n     */\n    function initPlugin(container) {\n      const { context } = container\n\n      // Send the provided options to the store.\n      // This will be `state.config[name]`.\n      context.dispatch(updateConfig(options, pluginInterface.name))\n    }\n\n    // Register the component factory functions to the bottle.\n    bottle.factory('RequestAPI', pluginInterface.createAPI)\n\n    bottle.factory('sendRequest', createRequestHelper)\n\n    bottle.defer(initPlugin)\n\n    return {\n      capabilities: platform ? ['restAuthorization'] : [],\n      name: pluginInterface.name\n    }\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const REQUEST = PREFIX + 'REQUEST'\nexport const RESPONSE = PREFIX + 'RESPONSE'\n\nexport const AUTHORIZATION_ERROR = PREFIX + 'AUTHORIZATION_ERROR'\n","import * as actionTypes from './actionTypes'\n\nvar nextRequestId = 0\nfunction generateRequestId() {\n  return nextRequestId++\n}\n\n/**\n * Creates a request action.\n * @param {Object} options\n * @param {string} options.url The url for the request\n * @param {Object} [options.queryParams] Query parameters to be added to the url string\n * @param {string} [options.responseType] The data type assumed to be received in the response body\n * @param {Blob|BufferSource|FormData|UrlSearchParams|string} [options.body] The request body\n */\nexport function request(options) {\n  return {\n    type: actionTypes.REQUEST,\n    payload: options,\n    meta: {\n      requestId: generateRequestId()\n    }\n  }\n}\n\n/**\n * Creates a response action.\n */\nexport function response(requestId, result, error = false) {\n  return {\n    type: actionTypes.RESPONSE,\n    payload: result,\n    error,\n    meta: {\n      requestId: requestId\n    }\n  }\n}\n\n/**\n * Action to signify a REST request has encountered an authorization error.\n * @param  {BasicError} error\n * @return {Action}\n */\nexport function authorizationError(error) {\n  return {\n    error: true,\n    type: actionTypes.AUTHORIZATION_ERROR,\n    payload: error\n  }\n}\n","import { fetchResource } from '../utils'\n// Other plugins.\nimport { getRequestInfo } from '../../auth/interface/selectors'\nimport { merge } from 'lodash/fp'\n\n/**\n * Request API factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context - The factory context.\n * @return {Object} Request API.\n */\nexport default function createAPI(container) {\n  const { logManager, context, API_LOG_TAG } = container\n  const log = logManager.getLogger('REQUEST')\n\n  const requestApi = {\n    /**\n     * The 'request' namespace (within the 'api' type) is used to make network requests to the server.\n     *\n     * @public\n     * @namespace request\n     */\n\n    /**\n     * Send a request to the underlying REST service with the appropriate configuration and authentication.\n     * This is a wrapper on top of the browser's [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/fetch)\n     * and behaves very similarly but using SDK configuration for the base URL and authentication as well\n     * as SDK logging.\n     *\n     * @public\n     * @memberof request\n     * @method fetch\n     * @param {string} resource The full path of the resource to fetch from the underlying service. This should include any REST version\n     *                          or user information. This path will be appended to the base URL according to SDK configuration.\n     * @param {RequestInit} init An object containing any custom settings that you want to apply to the request. See [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/fetch)\n     *                           for a full description and defaults.\n     * @return {Promise<Response>} A promise for a [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response) object.\n     * @example\n     * // Send a REST request to the server\n     * // Create a request options object following [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/fetch)\n     * const requestOptions = {\n     *   method: 'POST',\n     *   body: JSON.stringify({\n     *     test: 123\n     *   })\n     * }\n     *\n     * // Note that you will need to subscribe for the `custom` service in order to\n     * // receive notifications from the `externalnotification` service.\n     * const response = await client.request.fetch('/rest/version/1/user/xyz@test.com/externalnotification', requestOptions)\n     */\n    fetch: async function (resource, init = {}) {\n      log.debug(API_LOG_TAG + 'fetch: ', resource)\n      const state = context.getState()\n      const requestInfo = getRequestInfo(state)\n      const options = requestInfo.requestOptions\n      requestInfo.requestOptions = merge(init, options)\n      // Do request\n      return await fetchResource(resource, requestInfo)\n    }\n  }\n\n  return { request: requestApi }\n}\n","/**\n * An error occurred with server authorization.\n *\n * This event will be emitted anytime a REST request to the server is rejected\n *    due to an authorization issue. This may occur for invalid credentials or\n *    expired tokens, depending on which form of authentication the application\n *    has chosen to use.\n * @public\n * @memberof api\n * @requires restAuthorization\n * @event request:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n */\nexport const REQUEST_ERROR = 'request:error'\n","import name from './name'\nimport createAPI from './api'\n\nexport default { name, createAPI }\n","/**\n * This interface is for an request plugin.\n * @type {string}\n */\nconst name = 'requests'\nexport default name\n","// Other plugins.\nimport { logManager } from '../logs'\n\n// Utils.\nimport toQueryString from '@rbbn/utilities/toQueryString'\n\n/**\n * The possible response data types that can be handled.\n */\nconst responseTypes = Object.freeze({\n  json: 'json',\n  blob: 'blob',\n  text: 'text',\n  none: 'none'\n})\n\n/**\n * Make a request with the specified options. The options is very similar to the options passed to the GlobalFetch\n * method except that is also accepts the url as part of the options.\n * Reference: https://developer.mozilla.org/en-US/docs/Web/API/Request\n *\n * Currently this processes the request and assumes nothing about the response.\n * - If the response has a body, it will always be parsed and forwarded on.\n *      - If no body, then use an empty object in its place.\n * - If the fetch succeeded, the response \"results\" will always be forwarded on,\n *      even if the response is outside of the 200-299 range.\n *      - Because some backends provide more detailed error info as part of the body,\n *        rather than just the response status.\n * - If the fetch fails, return with the fetch failure information.\n *\n * @param {Object} options Options to make the request with.\n * @param {string} options.url The URL to make the request to.\n * @param {Object} [options.queryParams] The parameters to be added to the query string\n * @param {string} [options.responseType='json] The expected data type of the response body.\n * @param {Blob|BufferSource|FormData|UrlSearchParams|string} [options.body] The request body\n * @return {Promise} A promise that resolves with a custom response object.\n */\nexport default async function makeRequest(options, requestId) {\n  const log = logManager.getLogger('REQUEST', requestId)\n\n  /*\n   * Check the provided options to ensure they are valid before making the request.\n   */\n  const error = validateOptions(options)\n  if (error) {\n    log.info(error.result.message)\n    return error\n  }\n\n  // Extract and remove the non-fetch API properties.\n  const { url, queryParams, responseType = 'json', ...fetchOptions } = options\n\n  // Grab that last part of the URL (after the last /) to be logged.\n  let endUrl = url.match(/([^/]*)$/)[0]\n  // Cut it short if it's too long, since this should be human-readable.\n  endUrl = endUrl.length > 15 ? endUrl.substring(0, 15) + '...' : endUrl\n  log.info(`Making ${fetchOptions.method} ${endUrl} request.`)\n\n  let response\n  /*\n   * Make the request. Scenarios to check for:\n   *  1. Fetch failed.\n   *  2. Fetch succeeded and is ok, with no response body.\n   *  3. Fetch succeeded and is ok, with expected response type.\n   *  4. Fetch succeeded and is ok, with unexpected response type.\n   *  5. Fetch succeeded but is not ok.\n   */\n  try {\n    response = await fetch(url + toQueryString(queryParams), fetchOptions)\n  } catch (err) {\n    // Scenario 1: Fetch failed.\n    log.info(`Failed to make request, caused by ${err.message}`)\n    return makeResponse({ error: 'FETCH' }, { code: err.name, message: err.message })\n  }\n\n  // Basic information for the request result.\n  const result = {\n    ok: response.ok,\n    code: response.status,\n    message: response.statusText\n  }\n\n  if (response.ok) {\n    if (response.status === 204) {\n      /*\n       * A `204 (No Content)` response indicates a success, but with no content to return.\n       * Avoid parsing the response because there isn't one.\n       */\n      // Scenario 2: Response is ok, with no response body.\n      log.info(`Finished request with successful response (status ${response.status}).`)\n      return makeResponse(undefined, { body: {}, ...result })\n    }\n\n    const data = await parseBody(response, responseType)\n    if (data instanceof Error) {\n      // Scenario 4: Response is ok, with an unexpected type.\n      log.error(`Failed to parse with response type: ${responseType}. Error: ${data}`)\n      return makeResponse({ error: 'REQUEST' }, { code: data.name, message: data.message })\n    } else {\n      // Scenario 3: Response is ok, with an expected type.\n      log.info(`Finished request with successful response (status ${response.status}).`)\n      return makeResponse(undefined, { body: data, ...result })\n    }\n  } else {\n    // Scenario 5: Response is not ok.\n    let contentType\n    // Check the Content-Type of the response.\n    try {\n      contentType = await response.headers.get('content-type')\n    } catch (err) {\n      log.debug(`Failed to get content-type:${err.message}.`)\n    }\n    /*\n     * Handle a SPiDR special-case error where the response body is a HTML page...\n     * Throw away the body and simply report it as 'Forbidden'.\n     */\n    if (response.status === 403 && contentType.includes('html')) {\n      return makeResponse({ error: 'REQUEST' }, result)\n    }\n\n    /*\n     * Try to parse the response as JSON, and if successful, include\n     * it in the returned error. otherwise, provide an empty object instead.\n     */\n    let responseBody\n    try {\n      responseBody = await response.json()\n      if (response.status === 503) {\n        let retryValue\n        if (responseBody && responseBody.subscribeResponse) {\n          // Try to get the retry value from the body of the response.\n          // If it is in the body, then its value is a number\n          retryValue = responseBody.subscribeResponse.retryAfter\n        } else if (responseBody && responseBody.authorizationResponse) {\n          // This is the case where request has been initiated as part of an anonymous call.\n          retryValue = responseBody.authorizationResponse.retryAfter\n        }\n\n        let retryAfter // the final value to be used\n        if (retryValue) {\n          retryAfter = retryValue // should already be in milli seconds\n        } else {\n          // Try to get the retry value from `Retry-After` Header of the response.\n          // This is the case when 503 response comes from an HTTP reverse proxy/load balancer node.\n          try {\n            // If provided as part of 'Retry-After' Header, its value will always be provided as a string\n            retryValue = await response.headers.get('retry-after')\n          } catch (err) {\n            log.debug(`Failed to get retry-after:${err.message}.`)\n          }\n\n          if (retryValue) {\n            // We have a value (either from body or from header of that reply).\n            if (retryValue.endsWith(' GMT')) {\n              // It is provided as `HTTP-date` format,\n              // according to Standards spec: https://www.rfc-editor.org/rfc/rfc9110.html#section-10.2.3\n              // If so, convert it to `number` format.\n              const futureDate = new Date(retryValue)\n              retryAfter = futureDate.getTime() - Date.now() // milliseconds\n            } else {\n              // it is provided in header as seconds\n              retryAfter = retryValue * 1000 // automatic convertion from string to number, in milliseconds\n            }\n          }\n        }\n\n        // Ensure that no matter where it comes from, we always have the final value(s) saved in the parsed body,\n        // as this is always used for later decision making.\n        // NOTE: No guarantees on the existence of retryAfter,\n        //       as HTTP reverse proxy/load balancer does not guarantee to provide one\n        //       (see `SPiDR REST Overload Controls - Functional Description` spec).\n        if (retryAfter && retryAfter > 0) {\n          // retry value is available & valid.\n          // return the same body for both link & anonymous rquest.\n          responseBody = { subscribeResponse: { statusCode: 503, retryAfter } }\n        } else {\n          // The spec says that if we got a 503 but with no retryAfter available, then treat the reply as 500 error.\n          responseBody = { subscribeResponse: { statusCode: 500 } }\n        }\n      }\n    } catch (err) {\n      responseBody = {}\n      log.debug('Failed to parse response:', err.message)\n    }\n    return makeResponse({ error: 'REQUEST' }, { body: responseBody, ...result })\n  }\n}\n\n/**\n * Checks for the provided options to be considered valid before making the\n *    request. If an option is invalid, an error response will be returned.\n * @param  {Object} options\n * @return {Response|undefined}\n */\nfunction validateOptions(options) {\n  const { url, responseType } = options\n\n  if (!url || typeof url !== 'string') {\n    const invalidUrlMessage = `Invalid request url; expected url of type string but received ${url} instead`\n    return makeResponse({ error: 'REQUEST_URL', message: invalidUrlMessage })\n  }\n\n  /*\n   * If an expected responseType was provided, it should be one of the types\n   *    that we know how to handle.\n   */\n  if (responseType && !responseTypes.hasOwnProperty(responseType)) {\n    const invalidResponseType = 'Cannot make request; responseType value was invalid.'\n    return makeResponse({ error: 'RESPONSE_TYPE', message: invalidResponseType })\n  }\n}\n\n/**\n * Get the body from the response depending on our expected content-type.\n * @return {Body|Error}\n */\nasync function parseBody(response, expectedType) {\n  /**\n   * The SDK should only be parsing the responses as is expected without checking the content type of the response.\n   * This is deterministic depending on the `responseType` passed in to the request through the request options.\n   */\n  let responseBody = {}\n  try {\n    switch (expectedType) {\n      case responseTypes.json:\n        responseBody = await response.json()\n        break\n      case responseTypes.blob:\n        responseBody = await response.blob()\n        break\n      case responseTypes.text:\n        responseBody = await response.text()\n        break\n      case responseTypes.none:\n        // Do not parse the response\n        break\n      default:\n        // This should be unreachable code.\n        throw Error('Assertion failed')\n    }\n  } catch (e) {\n    // Note: We get here if we have a successful request but the server sent us unexpected data.\n    // We need to treat this as an error case because we can no longer enforce a contract with the\n    // code making the request.\n    //\n    // If the code gets here the issue is either with the server not sending us expected data, or with\n    // the calling code that told us to expect the wrong data.\n\n    return e\n  }\n\n  return responseBody\n}\n\n/**\n * Make a response object that will  have the same structure every time\n * regardless of the server response.\n *\n * @param {Object} apiResponse API related response data\n * @param {string} apiResponse.error This should be a string indicating an error if the request fails due to an invalid request.\n * @param {string} apiResponse.message This should be a string with more details about the api error.\n * @param {Object} httpResponse This will contain the response data from the server.\n * @param {Object} httpResponse.body The response body data from the server.\n * @param {boolean} httpResponse.ok Indicates if the request was considered a success by the server.\n * @param {Object} httpResponse.code The HTTP status code for the request.\n * @param {Object} httpResponse.message A message describing the server response.\n * @return {Object} An object containing API and/or server response details.\n */\nfunction makeResponse(apiResponse = {}, httpResponse = {}) {\n  return {\n    body: httpResponse.body,\n    error: apiResponse.error,\n    result: {\n      ok: Boolean(httpResponse.ok),\n      code: httpResponse.code,\n      message: apiResponse.message || httpResponse.message\n    }\n  }\n}\n","// Request plugin.\nimport * as actions from './interface/actions'\nimport * as eventTypes from './interface/eventTypes'\nimport * as authorizations from './authorization'\nimport makeRequest from './makeRequest'\nimport { sanitizeRequest } from './utils'\n\n// Other plugins.\nimport { getRequestInfo } from '../auth/interface/selectors'\n\n// Helpers.\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\n// Libraries.\nimport { omit } from 'lodash/fp'\n\n/**\n * Request helper factory function.\n * @method createRequestHelper\n * @param  {Object} container The bottle container.\n * @return {Function} The request function.\n */\nexport default function createRequestHelper(container) {\n  const { emitEvent, context, logManager } = container\n\n  return async function doRequest(options) {\n    const requestInfo = getRequestInfo(context.getState())\n\n    // Merge the default request options from state into the provided options.\n    //    The provided options take priority.\n    const defaultOptions = requestInfo.requestOptions\n    options = mergeValues(defaultOptions, options)\n\n    const action = actions.request(options)\n    // Dispatch a request action for backwards compatability\n    context.dispatch(action)\n\n    const log = logManager.getLogger('REQUEST', action.meta.requestId)\n\n    const logOptions = sanitizeRequest(action.payload)\n    log.debug(`Making REST request ${action.meta.requestId}.`, logOptions)\n\n    // Make the request based on the action\n    const result = await makeRequest(action.payload, action.meta.requestId)\n\n    log.debug(`Received REST response ${action.meta.requestId}.`, result)\n\n    // Perform the authorization check side-effect by calling the 'authorization' function for Link platform.\n    const error = authorizations['linkAuthorization'](result)\n\n    if (error) {\n      emitEvent(eventTypes.REQUEST_ERROR, { error })\n    }\n\n    // Dispatch a response action for backwards compatability\n    context.dispatch(actions.response(action.meta.requestId, result, !!result.error))\n\n    return result\n  }\n}\n\n/**\n * Workaround for logging an action without dispatching it.\n *\n * The Log plugin will automatically log any action that is dispatched, but in\n *    some cases we don't want to dispatch an action anymore. For backwards-\n *    compatibility, the action still needs to be logged. This function logs an\n *    action as if it were dispatched.\n *\n * Caveat: The action shouldn't update state (since then it _should_ be dispatched),\n *    since the prev/next state logs would then be incorrect.\n */\nexport function logFakeAction({ getState, container }, action) {\n  const log = container.logManager.getLogger('ACTION')\n  const logState = getState().config.logs\n  const { logActions, logLevel } = logState\n\n  // If logActions are falsy, don't log the action.\n  if (!logActions) {\n    return\n  }\n\n  /*\n   * Action log options:\n   *  - collapsed: Whether to use group or groupCollapsed.\n   *  - actionOnly: Whether to log the 'prev state' and 'next state'.\n   *  - exposePayloads: Whether to log the payloads or not.\n   *  - logLevel: Whether to log any action/state details.\n   */\n  const { collapsed, actionOnly, exposePayloads } = logActions\n\n  const groupMethod = collapsed ? 'groupCollapsed' : 'group'\n  const hidePayload = exposePayloads === false || (action.meta && action.meta.isSensitive)\n  const actionToLog = hidePayload ? omit('payload', action) : action\n\n  log[groupMethod](`action ${action.type} @ ${getTime()} (in 0.00 ms)`)\n  if (logLevel === 'DEBUG') {\n    if (actionOnly) {\n      log.debug('action    ', actionToLog)\n    } else {\n      log.debug('prev state', getState())\n      log.debug('action    ', actionToLog)\n      // Assume the action does not update state, so use the same state value.\n      log.debug('next state', getState())\n    }\n  }\n  log.groupEnd()\n}\n\n/*\n * Helper function.\n * Get a timestamp formatted in the specific way that redux-logger uses for actions.\n * Code copy/pasted from redux-logger: https://github.com/LogRocket/redux-logger/blob/master/src/helpers.js\n */\nfunction getTime() {\n  const time = new Date()\n  const repeat = (str, times) => new Array(times + 1).join(str)\n  const pad = (num, maxLength) => repeat('0', maxLength - num.toString().length) + num\n  return `${pad(time.getHours(), 2)}:${pad(time.getMinutes(), 2)}:${pad(time.getSeconds(), 2)}.${pad(\n    time.getMilliseconds(),\n    3\n  )}`\n}\n","// Other plugins.\nimport { logManager } from '../../logs'\n\n// Utils.\nimport { getVersion } from '../../common/version'\nimport toQueryString from '@rbbn/utilities/toQueryString'\n\n// Libraries.\nimport { cloneDeep } from 'lodash/fp'\n\nconst log = logManager.getLogger('REQUEST')\n\n/**\n * Determine and return the current SDK platform and version string to be used\n * with the x-Cpaas-Agent network request header field.\n * @method getCpaasAgentHeaderValue\n * @param  {string}  url The url for the request being made.\n * @return {string}  A string representation of the platform and version the SDK is using.\n */\nexport function getCpaasAgentHeaderValue(url) {\n  // Assume request is for Link platform, by default.\n  let headerValue = `link-js-sdk/${getVersion()}`\n\n  // Check if request is for callMe service.\n  // (callMe service uses Link platform for call requests)\n  if (url && url.includes('/anonymous/')) {\n    headerValue = `callme-js-sdk/${getVersion()}`\n  }\n\n  return headerValue\n}\n\n/**\n * Prepares a REST request options object for logging by removing passwords\n * and parses the body string into an object that can be interacted with in console.\n * @method sanitizeRequest\n * @param {Object} options An object containing any custom settings that you want to\n *                         apply to the request. See [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/fetch)\n *                         or a full description and defaults.\n * @return {Object} A sanitized REST request options object that can be safely logged.\n */\nexport function sanitizeRequest(options) {\n  const logOptions = cloneDeep(options)\n  // When logging the Auth header, cut it off so that we can see the type of\n  //    token but not the token itself. Depending on the type, it can contain\n  //    a password.\n  const authHeader = logOptions.headers && logOptions.headers.Authorization\n  if (authHeader) {\n    logOptions.headers.Authorization = authHeader.substring(0, 6) + '...'\n  }\n\n  // If the rest request body is a string, try to parse it as JSON and store\n  // it as an object so it can be interacted with in the console\n  const body = logOptions.body\n  if (body) {\n    try {\n      logOptions.body = JSON.parse(body)\n    } catch (e) {\n      // Noop, leave the body in whatever format it was in.\n    }\n  }\n\n  return logOptions\n}\n\n/**\n * Send a REST request to Link with the appropriate configuration.\n * @method fetchResource\n * @param {string} resource The path of the resource to fetch from the underlying service. This path will be appended\n *                          to the base URL according to SDK configuration.\n * @param {Object} requestInfo An object containing any custom settings that you want to apply to the request. See [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/fetch)\n *                             for a full description and defaults.\n * @return {Promise<Response>} A promise for a [Response](https://developer.mozilla.org/en-US/docs/Web/API/Response) object.\n */\nexport async function fetchResource(resource, requestInfo, module) {\n  const { requestOptions } = requestInfo\n\n  // If the app doesn't prepend the '/' we should add it.\n  if (resource.charAt() !== '/') {\n    resource = `/${resource}`\n  }\n\n  const url = `${requestInfo.baseURL}${resource}`\n  const logOptions = sanitizeRequest(requestOptions)\n  log.debug('Making REST request', logOptions)\n\n  const queryParams = requestInfo.requestOptions.queryParams || {}\n  let queryString = toQueryString(queryParams)\n  // Check resource passed in for any existing query params\n  if (resource.includes('?')) {\n    queryString = queryString.replace('?', '&')\n  }\n  const response = await fetch(url + queryString, requestOptions)\n\n  log.debug('Received REST response', response)\n\n  return response\n}\n","// Sip Events plugin.\nimport { name, reducer } from './interface'\nimport createAPI from './interface/api'\nimport createOperations from './operations'\nimport createRequests from './requests'\nimport createIntervals from './intervals'\n\n// Other plugins.\nimport { NOTIFICATION_RECEIVED } from '../notifications/interface/actionTypes'\n\n/**\n * Sip Events Plugin Factory.\n * @method sipEvents\n * @return {Object} Sip Events plugin.\n */\nexport default function sipEvents(bottle) {\n  // Register the component factory functions to the bottle.\n  bottle.factory('SipEventsAPI', createAPI)\n  bottle.factory('SipEventsOperations', createOperations)\n  bottle.factory('SipEventsRequests', createRequests)\n  bottle.factory('SipEventsIntervals', createIntervals)\n\n  /*\n   * After the SDK has been initialized, start listening for SIP Event\n   *    notifications. Route them to the `receiveEvent` operation to be handled.\n   */\n  bottle.defer(container => {\n    // Take notification actions that MAY be for sip events.\n    function receiveEventNotifyPattern(action) {\n      return (\n        action.type === NOTIFICATION_RECEIVED &&\n        action.payload.notificationMessage.hasOwnProperty('genericNotificationParams')\n      )\n    }\n\n    container.Notifications.takeEveryAction(receiveEventNotifyPattern, action => {\n      container.SipEventsOperations.receiveEvent(action.payload.notificationMessage)\n    })\n  })\n\n  const capabilities = ['sipEvents']\n\n  return {\n    capabilities,\n    name,\n    reducer\n  }\n}\n","const PREFIX = '@@KANDY/'\n\nexport const SIP_EVENT_SUBSCRIBE = PREFIX + 'SIP_EVENT_SUBSCRIBE'\nexport const SIP_EVENT_SUBSCRIBE_FINISH = PREFIX + 'SIP_EVENT_SUBSCRIBE_FINISH'\n\nexport const SIP_EVENT_UPDATE = PREFIX + 'SIP_EVENT_UPDATE'\nexport const SIP_EVENT_UPDATE_FINISH = PREFIX + 'SIP_EVENT_UPDATE_FINISH'\n\nexport const SIP_EVENT_UNSUBSCRIBE = PREFIX + 'SIP_EVENT_UNSUBSCRIBE'\nexport const SIP_EVENT_UNSUBSCRIBE_FINISH = PREFIX + 'SIP_EVENT_UNSUBSCRIBE_FINISH'\n\nexport const SIP_EVENT_RECEIVED = PREFIX + 'SIP_EVENT_RECEIVED'\n","import * as actionTypes from './actionTypes'\n\n// Helper function for formatting _FINISH actions.\nfunction finishActionHelper(actionType, { response, error, eventType }) {\n  return {\n    type: actionType,\n    error: !!error,\n    payload: error ? { error, eventType } : response\n  }\n}\n\n/**\n * Represents a request to subscribe to a specific sip event.\n * @method sipEventSubscribe\n * @param  {string} eventType\n * @param  {Array}  subscribeUserList\n * @param  {string} clientCorrelator\n * @param  {Object} customParameters\n * @returns {Object} A flux standard action.\n */\nexport function sipEventSubscribe(eventType, subscribeUserList, clientCorrelator, customParameters) {\n  return {\n    type: actionTypes.SIP_EVENT_SUBSCRIBE,\n    payload: {\n      eventType,\n      subscribeUserList,\n      clientCorrelator,\n      customParameters\n    }\n  }\n}\n\n/**\n * Represents the response/error of a sip event subscription request.\n * @method sipEventSubscribeFinish\n * @param  {Object} $0\n * @param  {Object} $0.response Information about the subscription response.\n * @param  {BasicError} $0.error An error object, in the case of an issue.\n * @param  {string} $0.eventType Type type of sip event.\n * @returns {Object} A flux standard action.\n */\nexport function sipEventSubscribeFinish({ response, error, eventType }) {\n  return finishActionHelper(actionTypes.SIP_EVENT_SUBSCRIBE_FINISH, {\n    response,\n    error,\n    eventType\n  })\n}\n\n/**\n * Represents a request to update a sip event subscription or resubscribe for it.\n * @method sipEventUpdate\n * @param  {string} eventType\n * @param  {Object} userLists\n * @param  {Object} customParameters\n * @returns {Object} A flux standard action.\n */\nexport function sipEventUpdate(eventType, userLists = {}, customParameters, isResub) {\n  return {\n    type: actionTypes.SIP_EVENT_UPDATE,\n    payload: {\n      eventType,\n      subscribeUserList: userLists.subscribeUserList || [],\n      unsubscribeUserList: userLists.unsubscribeUserList || [],\n      customParameters\n    },\n    meta: { isResub }\n  }\n}\n\n/**\n * Represents the response/error of a sip event update/resub request.\n * @method sipEventUpdateFinish\n * @param  {Object} $0\n * @param  {Object} $0.response Information about the update/resub response.\n * @param  {BasicError} $0.error An error object, in the case of an issue.\n * @param  {string} $0.eventType Type type of sip event.\n * @returns {Object} A flux standard action.\n */\nexport function sipEventUpdateFinish({ response, error, eventType }) {\n  return finishActionHelper(actionTypes.SIP_EVENT_UPDATE_FINISH, {\n    response,\n    error,\n    eventType\n  })\n}\n\n/**\n * Represents a request to unsubscribe from sip event subscriptions.\n * @method sipEventUnsubscribe\n * @param  {string} eventType The sip event subscription to unsubscribe from.\n * @returns {Object} A flux standard action.\n */\nexport function sipEventUnsubscribe(eventType) {\n  return {\n    type: actionTypes.SIP_EVENT_UNSUBSCRIBE,\n    payload: eventType\n  }\n}\n\n/**\n * Represents the response/error of a sip event unsubscribe request.\n * @method sipEventUnsubscribeFinish\n * @param  {Object} $0\n * @param  {Object} $0.response Information about the unsubscribe response.\n * @param  {BasicError} $0.error An error object, in the case of an issue.\n * @param  {string} $0.eventType Type type of sip event.\n * @returns {Object} A flux standard action.\n */\nexport function sipEventUnsubscribeFinish({ response, error, eventType }) {\n  return finishActionHelper(actionTypes.SIP_EVENT_UNSUBSCRIBE_FINISH, {\n    response,\n    error,\n    eventType\n  })\n}\n\n/**\n * Represents that a sip event notification has been received.\n * @method sipEventReceived\n * @param  {Object} sipEvent\n * @param {string} callId\n * @returns {Object} A flux standard action.\n */\nexport function sipEventReceived(sipEvent, callId) {\n  return {\n    type: actionTypes.SIP_EVENT_RECEIVED,\n    payload: {\n      event: sipEvent,\n      eventType: sipEvent.eventType,\n      callId\n    }\n  }\n}\n","/* eslint-disable no-warning-comments */\n/**\n *  The SIP Events feature allows an application to communicate with a SIP network integrated\n *      with their WebRTC Gateway instance. The SIP network may generate custom events intended\n *      for an application, which can be handled with the SDK's `sip` namespace.\n *\n * Usage of SIP Events is dependent on your WebRTC Gateway instance. The types of SIP Events can\n *    be different based on configurations and components, often being part of a custom\n *    solution. As such, the SIP Events feature is presented in a generic manner to be\n *    flexible for any possible events.\n *\n * An example of a common SIP event is \"SIP presence\". When a user is connected to a SIP phone,\n *    the network may generate \"phone presence\" events when the user starts and ends a call\n *    (eg. 'On Call', 'Available'). Applications can subscribe to receive these events for\n *    specific users.\n *\n * A SIP event may either be solicited or unsolicited. Solicited events, such as the \"presence\"\n *    example above, requires the application to subscribe for the event. See the\n *    {@link sip.subscribe sip.subscribe API} for more information about solicited events.\n *    Unsolicited events have no prerequisites for being received.\n *\n * @public\n * @requires sipEvents\n * @namespace sip\n */\n/* eslint-enable no-warning-comments */\n\nimport { getSipEventInfo } from './selectors'\nimport { EVENT_ERROR, EVENT_SUBSCRIPTION_CHANGED } from './eventTypes'\n\n/**\n * Sip Events API factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @return {Object} Available public APIs for sipEvents.\n */\nexport default function createAPI(container) {\n  const { context, emitEvent, SipEventsOperations: operations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('SIPEVENTS')\n\n  const sipEventsApi = {\n    /**\n     * Creates a subscription for a SIP event.\n     *\n     * A subscription is required to receive SIP notifications for solicited events. Before\n     *    creating a SIP subscription, the service for the event type must have been\n     *    provisioned as part of the user subscription using the {@link services.subscribe}\n     *    API.\n     *\n     * Only one SIP subscription per event type can exist at a time. A subscription can\n     *    watch for events from multiple users at once. Users can be added to or removed\n     *    from a subscription using the {@link sip.update sip.update} API at any time.\n     *\n     * The SDK will emit a {@link sip.event:sip:subscriptionChange sip:subscriptionChange}\n     *    event when the operations completes. The {@link sip.getDetails} API can be used\n     *    to retrieve the current information about a subscription.\n     *\n     * The SDK will emit a {@link sip.event:sip:eventsChange sip:eventsChange} event when\n     *    a SIP event is received.\n     * @public\n     * @static\n     * @method subscribe\n     * @requires sipEvents\n     * @memberof sip\n     * @param  {string} eventType The name of the SIP event.\n     * @param  {Array<string>} subscribeUserList The list of users to receive events about.\n     * @param  {string} clientCorrelator Unique identifier for a client device.\n     * @param  {Array<call.CustomParameter>} [customParameters] Custom SIP header parameters for the SIP backend.\n     * @example\n     * // Provision the service for the specific SIP event during user subscription.\n     * //   This is required before a SIP subscription for the event can be created.\n     * const services = ['call', 'event:presence', ...]\n     * client.services.subscribe(services)\n     *\n     * // Subscribe to receive SIP presence events from two users.\n     * client.sip.subscribe('event:presence', ['userOne@example.com', 'userTwo@example.com'], 'clientId123')\n     *\n     * // Subscribe for SIP events with a custom parameter.\n     * const customParameters = [{\n     *    name: 'X-nt-GUID',\n     *    value: 'GUID123abc'\n     * }]\n     * client.sip.subscribe('event:presence', subscribeUserList, 'clientId123', customParameters)\n     */\n    async subscribe(eventType, subscribeUserList, clientCorrelator, customParameters = []) {\n      log.debug(API_LOG_TAG + 'sip.subscribe: ', eventType, subscribeUserList, clientCorrelator, customParameters)\n      try {\n        await operations.subscribe(eventType, subscribeUserList, clientCorrelator, customParameters)\n      } catch (error) {\n        emitEvent(EVENT_ERROR, { error })\n        return\n      }\n\n      emitEvent(EVENT_SUBSCRIPTION_CHANGED, {\n        eventType,\n        change: 'newSubscription',\n        subscribedUsers: subscribeUserList\n      })\n    },\n\n    /**\n     * Updates an existing SIP event subscription.\n     *\n     * Allows for adding or removing users from the subscription, and for changing the\n     *    custom parameters of the subscription.\n     *\n     * The SDK will emit a {@link sip.event:sip:subscriptionChange sip:subscriptionChange}\n     *    event when the operations completes. The {@link sip.getDetails} API can be used\n     *    to retrieve the current information about a subscription.\n     * @public\n     * @static\n     * @method update\n     * @requires sipEvents\n     * @memberof sip\n     * @param  {string} eventType The name of the SIP event.\n     * @param  {Object} userLists\n     * @param  {Array<string>}  userLists.subscribeUserList List of users to add to the subscription.\n     * @param  {Array<string>}  userLists.unsubscribeUserList List of users to remove from the subscription. If all users are removed, the event subscription will be deleted.\n     * @param  {Array<call.CustomParameter>} [customParameters] Custom SIP header parameters for the SIP backend.\n     * @example\n     * // Add a user to an existing subscription.\n     * const userLists = {\n     *    subscribedUserList: ['userThree@example.com']\n     * }\n     * client.sip.update('event:presence', userLists)\n     *\n     * // Simultaneously add and remove users from the subscription.\n     * const userLists = {\n     *    subscribedUserList: ['userThree@example.com'],\n     *    unsubscribeUserList: ['userOne@example.com']\n     * }\n     * client.sip.update('event:presence', userLists)\n     */\n    async update(eventType, userLists, customParameters = []) {\n      log.debug(API_LOG_TAG + 'sip.update: ', eventType, userLists, customParameters)\n\n      try {\n        await operations.update(eventType, userLists, customParameters)\n      } catch (error) {\n        emitEvent(EVENT_ERROR, { error })\n        return\n      }\n      emitEvent(EVENT_SUBSCRIPTION_CHANGED, {\n        eventType,\n        change: 'updateSubscription',\n        subscribeUserList: userLists.subscribeUserList || [],\n        unsubscribeUserList: userLists.unsubscribeUserList || []\n      })\n    },\n\n    /**\n     * Deletes an existing SIP event subscription.\n     *\n     * The SDK will emit a {@link sip.event:sip:subscriptionChange sip:subscriptionChange}\n     *    event when the operations completes.\n     *\n     * Subscription details will no longer be available using the {@link sip.getDetails}\n     *    API after it has been unsubscribed from.\n     * @public\n     * @static\n     * @method unsubscribe\n     * @requires sipEvents\n     * @memberof sip\n     * @param  {string} eventType The name of the SIP event.\n     * @example\n     * // Delete a SIP subscription.\n     * client.sip.unsubscribe('event:presence')\n     */\n    async unsubscribe(eventType) {\n      log.debug(API_LOG_TAG + 'sip.unsubscribe: ', eventType)\n      try {\n        await operations.unsubscribe(eventType)\n      } catch (error) {\n        emitEvent(EVENT_ERROR, { error })\n        return\n      }\n\n      emitEvent(EVENT_SUBSCRIPTION_CHANGED, {\n        eventType,\n        change: 'unsubscribe'\n      })\n    },\n\n    /**\n     * Retrieve information about a SIP event subscription.\n     *\n     * The SDK will track which users are included as part of the subscription and\n     *    previous notifications received. Each subscription will include a unique ID.\n     * @public\n     * @static\n     * @method getDetails\n     * @requires sipEvents\n     * @memberof sip\n     * @param  {string} [eventType] The name of a SIP event. If not provided, will retrieve\n     *    information for all SIP subscriptions.\n     * @return {Object} SIP subscription information. If `eventType` was not provided, will\n     *    return an object namespaced by event types.\n     * @example\n     * // Retrieve information about a single SIP subscription.\n     * const { subscribedUsers, notifications } = client.sip.getDetails('event:presence')\n     *\n     * // Retrieve information about all current SIP subscriptions.\n     * const subscriptions = client.sip.getDetails()\n     * const { subscribedUsers, notifications } = subscriptions['event:presence']\n     */\n    getDetails(eventType) {\n      const { getState } = context\n      log.debug(API_LOG_TAG + 'sip.getDetails: ', eventType)\n      return getSipEventInfo(getState(), eventType)\n    }\n  }\n\n  // Namespace the API.\n  return { sip: sipEventsApi }\n}\n","/**\n * A change has occurred to a SIP subscription.\n *\n * This event can be emitted when a new SIP subscription is created ({@link sip.subscribe}\n *    API), an existing subscription is updated ({@link sip.update} API), or has been\n *    deleted ({@link sip.unsubscribe} API). The `change` parameter on the event indicates\n *    which scenario caused the event.\n *\n * When users are added or removed from a subscription through a new subscription or an update,\n *    the `subscribedUsers` and `unsubscribedUsers` parameters will indicate the users added\n *    and removed, respectively.\n *\n * The {@link sip.getDetails} API can be used to retrieve the current information about\n *    a subscription.\n *\n * @public\n * @requires sipEvents\n * @memberof sip\n * @event sip:subscriptionChange\n * @param {Object} params\n * @param {string} params.eventType The name of the SIP event.\n * @param {string} params.change The change operation that triggered the event.\n * @param {Array<string>} [params.subscribedUsers] List of users added to the subscription\n *    as part of the change.\n * @param {Array<string>} [params.unsubscribedUsers] List of users removed from the\n *    subscription as part of the change.\n */\nexport const EVENT_SUBSCRIPTION_CHANGED = 'sip:subscriptionChange'\n\n/**\n * An error has occurred during a SIP event operation.\n *\n * @public\n * @requires sipEvents\n * @memberof sip\n * @event sip:error\n * @param {Object} params\n * @param {api.BasicError} params.error The Basic error object.\n * @param {string} params.eventType The name of the SIP event.\n * @example\n * // Listen for the event being emitted.\n * client.on('sip:error', (params) => {\n *    // Handle the error based on the information.\n *    const { code, message } = params.error\n *    ...\n * })\n */\nexport const EVENT_ERROR = 'sip:error'\n\n/**\n * A SIP event notification has been received.\n *\n * The `event` parameter is the full notification received from the network. The format\n *    of the notification is dependant on its event type. The SDK does not do any\n *    pre-processing of this data.\n * @public\n * @requires sipEvents\n * @memberof sip\n * @event sip:eventsChange\n * @param {Object} params Information about the notification.\n * @param {string} params.eventType The name of the SIP event.\n * @param {string} params.eventId A unique ID for the event notification.\n * @param {Object} params.event The full event object.\n * @param {Object} params.links\n * @param {string} [params.links.callId] The ID of the call this SIP event links to.\n * @example\n * // Listen for the event being emitted.\n * client.on('sip:eventsChange', (params) => {\n *    // Gather the SIP info specific to the event.\n *    const sipInfo = params.event.genericNotificationParams\n *\n *    // Handle the data based on the event type.\n *    if (params.eventType === 'event:presence') {\n *        const { data, from } = sipInfo\n *        ...\n *    }\n * })\n */\nexport const EVENT_RECEIVED = 'sip:eventsChange'\n","// Import the components of the interface.\nimport api from './api'\nimport reducer from './reducer'\n\nconst name = 'sipEvents'\n\nexport { name, api, reducer }\n","import * as actionTypes from './actionTypes'\nimport { handleActions } from 'redux-actions'\n\n// Libraries.\nimport { concat, omit, union, without } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.SIP_EVENT_SUBSCRIBE_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      // Add a new sip event section to state.\n      [action.payload.eventType]: {\n        sessionData: action.payload.sessionData,\n        subscribedUsers: action.payload.subscribedUsers\n      }\n    }\n  }\n}\n\nreducers[actionTypes.SIP_EVENT_UPDATE_FINISH] = {\n  next(state, action) {\n    let subscribedUsers = state[action.payload.eventType].subscribedUsers\n    // Add the new subscribed users.\n    subscribedUsers = union(action.payload.subscribeUserList, subscribedUsers)\n    // Remove the unsubscribed users.\n    subscribedUsers = without(action.payload.unsubscribeUserList, subscribedUsers)\n\n    // Update the subscribed users for the sip event section.\n    if (subscribedUsers.length === 0) {\n      // If there are no subscribed users for this session, the session is deleted.\n      const newState = { ...state }\n      delete newState[action.payload.eventType]\n      return newState\n    } else {\n      return {\n        ...state,\n        [action.payload.eventType]: {\n          ...state[action.payload.eventType],\n          subscribedUsers\n        }\n      }\n    }\n  }\n}\n\nreducers[actionTypes.SIP_EVENT_UNSUBSCRIBE_FINISH] = {\n  next(state, action) {\n    // Remove the specified sip event section.\n    return omit(action.payload.eventType, state)\n  }\n}\n\nreducers[actionTypes.SIP_EVENT_RECEIVED] = function (state, action) {\n  // Ensure everything is defined.\n  const eventInfo = state[action.payload.eventType] || {}\n  const notifications = eventInfo.notifications || []\n  // Concat the notification to the specified sip event section.\n  return {\n    ...state,\n    [action.payload.eventType]: {\n      ...state[action.payload.eventType],\n      notifications: concat(notifications, action.payload)\n    }\n  }\n}\n\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n/**\n * Retrieves information about a sip event.\n * @method getSipEventInfo\n * @param  {string} eventType\n * @return {Object}\n */\nexport function getSipEventInfo(state, eventType) {\n  if (eventType) {\n    return cloneDeep(state.sipEvents[eventType])\n  } else {\n    return cloneDeep(state.sipEvents)\n  }\n}\n","// sipEvents plugin\nimport { getSipEventInfo } from './interface/selectors'\n\n// Other plugins\nimport { sipEventCodes } from '../errors'\n\n/**\n * sipEvents intervals factory function.\n * @method createIntervals\n * @param {Object} container The bottle container.\n * @return {Object} Available intervals for sipEvents\n */\nexport default function createIntervals(container) {\n  const { context, logManager, createInterval } = container\n  const log = logManager.getLogger('SIPEVENTS')\n\n  // Interval operations for sip event subscriptions\n  const sipIntervals = {}\n\n  /**\n   * Check if a specific interval is currently running.\n   * @method isRunning\n   * @param {string} eventType The sip event type to check.\n   * @return {boolean} The interval for this specific sip event type is running or not.\n   */\n  function isRunning(eventType) {\n    if (!eventType || typeof eventType !== 'string') {\n      throw new Error('Invalid eventType argument, eventType must be a string.')\n    }\n    return !!sipIntervals[eventType]\n  }\n\n  /**\n   * Stop a specific interval.\n   * @method stop\n   * @param {string} eventType The sip event type to have it's interval stopped.\n   */\n  function stop(eventType) {\n    if (sipIntervals[eventType]) {\n      sipIntervals[eventType].stop()\n      delete sipIntervals[eventType]\n    }\n  }\n\n  /**\n   * Start a new interval timer for resubscribing to sip events\n   * @method startResubInterval\n   * @param {string} eventType The sip event type to start an interval resubscription timer for.\n   * @param {number} expires The time until this subscription will expire.\n   */\n  function startResubInterval(eventType, expires) {\n    const { SipEventsOperations: operations } = container\n    const { getState } = context\n\n    if (isRunning(eventType)) {\n      throw new Error(`There's already an interval running for ${eventType}.`)\n    }\n\n    if (typeof expires !== 'number') {\n      throw new Error('The value passed for the expires argument must be a number.')\n    }\n\n    const resubDelay = (expires * 1000) / 2\n\n    const update = () => {\n      const eventInfo = getSipEventInfo(getState(), eventType)\n\n      if (eventInfo) {\n        log.info(`Re-subscribing for sip ${eventType}.`)\n        try {\n          // Resub for eventType with empty user list, no custom params and isResub=true\n          operations.update(eventType, {}, null, true)\n        } catch (e) {\n          if (e.code === sipEventCodes.NOT_SUBSCRIBED) {\n            // No subscription for this eventType was found. We should stop trying to resubscribe. NOTE: the error has already\n            // been dispatched by the sipEvents update operation.\n            stop(eventType)\n          }\n        }\n      }\n    }\n\n    sipIntervals[eventType] = createInterval(update, resubDelay)\n\n    sipIntervals[eventType].start()\n  }\n\n  return {\n    // Interval operations\n    isRunning,\n    stop,\n    startResubInterval\n  }\n}\n","// sipEvents plugin\nimport * as actions from './interface/actions'\nimport * as eventTypes from './interface/eventTypes'\nimport { getSipEventInfo } from './interface/selectors'\n\n// Other plugins\nimport { getSubscriptionInfo, getSubscribedServices } from '../subscription/interface/selectors'\nimport { getCallByWrtcsSessionId } from '../call/interface/selectors'\nimport BasicError, { sipEventCodes } from '../errors'\n\nimport { includes } from 'lodash/fp'\n\n/**\n * sipEvents Operations factory function.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for sipEvents.\n */\nexport default function createOperations(container) {\n  const { context, emitEvent, logManager, SipEventsRequests: requests, SipEventsIntervals: intervals } = container\n  const log = logManager.getLogger('SIPEVENTS')\n\n  /**\n   * Operation for subscribing to specified Sip Events.\n   * @method sipEventSubscribe\n   * @return {Object} Result of sipEvent subscription operation.\n   */\n  async function subscribe(eventType, subscribeUserList, clientCorrelator, customParameters) {\n    const { dispatch, getState } = context\n\n    // Dispatch an sipEventSubscribe action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.sipEventSubscribe(eventType, subscribeUserList, clientCorrelator, customParameters))\n\n    // TODO: Have the client correlator be provided as a config, not through the API.\n    log.debug(`Subscribing for sip ${eventType}.`, clientCorrelator)\n\n    // Determine if the user is subscribed to the specified sip event.\n    const subscribedServices = getSubscribedServices(getState())\n\n    const sipEvents = subscribedServices.filter(service => service.startsWith('event:'))\n\n    if (!includes(eventType, sipEvents)) {\n      log.info(`Cannot subscribe to sip ${eventType}; service was not provisioned during user subscription.`)\n\n      const error = new BasicError({\n        code: sipEventCodes.NOT_PROVISIONED,\n        message: 'Cannot subscribe to sip event; service was not provisioned during user subscription.'\n      })\n\n      dispatch(actions.sipEventSubscribeFinish({ error, eventType }))\n\n      throw error\n    }\n\n    // Use the same subscription duration as the user subscription.\n    const { expires } = getSubscriptionInfo(getState())\n\n    try {\n      const result = await requests.subscribe(eventType, subscribeUserList, clientCorrelator, customParameters, expires)\n\n      log.info(`Successfully subscribed to sip event ${eventType}.`)\n\n      const finishAction = actions.sipEventSubscribeFinish({\n        response: {\n          // Response payload includes: statusCode, expires, sessionData.\n          ...result.body.eventSubscriptionResponse,\n          eventType: eventType,\n          subscribedUsers: subscribeUserList\n        }\n      })\n\n      // Start operation to handle resubscriptions.\n      startSipEventResub(eventType, finishAction.payload.expires)\n      dispatch(finishAction)\n    } catch (error) {\n      dispatch(actions.sipEventSubscribeFinish({ error, eventType }))\n\n      throw error\n    }\n  }\n\n  /**\n   * Operation to start a sip event resubscription interval.\n   * @method startSipEventResub\n   * @param {string} eventType The event to start a resubscription interval for.\n   * @param {number} expires How long before this subscription ends.\n   */\n  function startSipEventResub(eventType, expires) {\n    intervals.startResubInterval(eventType, expires)\n  }\n\n  /**\n   * Operation to stop a sip event resubscription interval.\n   * @method stopSipEventResub\n   * @param {string} eventType The event to stop a resubscription interval for.\n   */\n  function stopSipEventResub(eventType) {\n    if (intervals.isRunning(eventType)) {\n      intervals.stop(eventType)\n    }\n  }\n\n  /**\n   * Saga to unsubscribe from [all currently subscribed] sip events.\n   * @method sipEventUnsubscribe\n   */\n  async function unsubscribe(eventType) {\n    const { dispatch, getState } = context\n\n    // Dispatch an sipEventUnsubscribe action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.sipEventUnsubscribe(eventType))\n\n    log.debug(`Unsubscribing from sip event subscriptions: ${eventType}.`)\n    const eventInfo = getSipEventInfo(getState(), eventType)\n\n    if (!eventInfo) {\n      log.info(`Cannot unsubscribe from sip event ${eventType}; no subscription exists.`)\n      const error = new BasicError({\n        code: sipEventCodes.NOT_SUBSCRIBED,\n        message: `Cannot unsubscribe from ${eventType}; no subscription found.`\n      })\n\n      dispatch(actions.sipEventUnsubscribeFinish({ error, eventType }))\n\n      throw error\n    }\n\n    try {\n      await requests.unsubscribe(eventType, eventInfo)\n\n      log.info(`Successfully unsubscribed from sip ${eventType}.`)\n\n      const finishAction = actions.sipEventUnsubscribeFinish({\n        response: {\n          eventType\n        }\n      })\n\n      // Stop the resubscription interval for this eventType\n      stopSipEventResub(eventType)\n      dispatch(finishAction)\n    } catch (error) {\n      dispatch(actions.sipEventUnsubscribeFinish({ error, eventType }))\n\n      throw error\n    }\n  }\n\n  /**\n   * Operation to update/resubscribe to a subscribed sip event.\n   * @method sipEventUpdate\n   * @param  {string} eventType The name of the SIP event.\n   * @param  {Object} userLists\n   * @param  {Array<string>}  userLists.subscribeUserList List of users to add to the subscription.\n   * @param  {Array<string>}  userLists.unsubscribeUserList List of users to remove from the subscription. If all users are removed, the event subscription will be deleted.\n   * @param  {Array<call.CustomParameter>} [customParameters] Custom SIP header parameters for the SIP backend.\n   * @param {boolean} [isResub=false] Boolean to indicate if the update is due to subscription.\n   * @return {Object} Result of sipEvent update operation.\n   */\n  async function update(eventType, userLists, customParameters = [], isResub = false) {\n    const { dispatch, getState } = context\n\n    const action = actions.sipEventUpdate(eventType, userLists, customParameters)\n    // Dispatch a sipEventUpdate action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(action)\n\n    log.debug(`Updating sip event subscription: ${eventType}.`)\n    const eventInfo = getSipEventInfo(getState(), eventType)\n\n    if (!eventInfo) {\n      let error\n      if (isResub) {\n        // Don't need to resub, since we're not subscribed anymore.\n        // TODO: Tech-Debt: BasicError isn't very useful for these scenarios. The emitted event provides\n        //      the BasicError, except there's no (easy to use) info indicating _which_ event was being\n        //      acted on. BasicError needs the ability to provide extra information.\n        error = new BasicError({\n          code: sipEventCodes.NOT_SUBSCRIBED,\n          message: `Cannot resubscribe for ${eventType} subscription; user not subscribed.`\n        })\n      } else {\n        // Error: Not subscribed to this sip event. Cannot update.\n        error = new BasicError({\n          code: sipEventCodes.NOT_SUBSCRIBED,\n          message: `Cannot update subscription for ${eventType}; user not subscribed.`\n        })\n      }\n      dispatch(actions.sipEventUpdateFinish({ error, eventType }))\n      throw error\n    }\n\n    try {\n      const { subscribeUserList, unsubscribeUserList } = userLists\n\n      // Only include user lists in the request body if there are entries.\n      const validUserLists = {}\n\n      if (subscribeUserList && subscribeUserList.length > 0) {\n        validUserLists.subscribeUserList = subscribeUserList\n      }\n      if (unsubscribeUserList && unsubscribeUserList.length > 0) {\n        validUserLists.unsubscribeUserList = unsubscribeUserList\n      }\n      if (!customParameters) customParameters = []\n\n      const eventSubscriptionResponse = await requests.update(eventType, eventInfo, validUserLists, customParameters)\n\n      if (eventSubscriptionResponse) {\n        log.info(`Updated sip event subscription: ${eventType}.`)\n\n        // Dispatch sipEventUpdateFinish action for backwards-compatible of action logs.\n        //     This does not affect state or emit an event.\n        dispatch(\n          actions.sipEventUpdateFinish({\n            response: {\n              // Result includes statusCode, expires, sessionData.\n              ...eventSubscriptionResponse,\n              eventType,\n              subscribeUserList: subscribeUserList || [],\n              unsubscribeUserList: unsubscribeUserList || []\n            }\n          })\n        )\n      }\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(actions.sipEventUpdateFinish({ error, eventType }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  /**\n   * Operation to handle a received SIP event.\n   *\n   * @method receiveEvent\n   * @param {Object} notification\n   * @param {string} notification.eventId\n   * @param {string} notification.eventType\n   * @param {Object} notification.genericNotificationParams\n   * @return {undefined}\n   */\n  function receiveEvent(notification) {\n    // Determine which sip events the user is subscribed/connected for.\n    const subscribedServices = getSubscribedServices(context.getState())\n\n    const sipEvents = subscribedServices.filter(service => service.startsWith('event:'))\n\n    const genericNotification = notification.genericNotificationParams\n    let callId = ''\n    /*\n     * Check if the notification's sessiondataType (if it exists) is of type call.\n     * If it is, then the sessionData field of the notification is a WebRTC Gateway's Call ID.\n     * We can then map that KL Call ID to an SDK Call ID (if it exists) and attach that to the\n     * sip event we emit to the application.\n     */\n    if (genericNotification.sessionDataType && genericNotification.sessionDataType === 'call') {\n      // Look at our existing calls to find the SDK Call ID (if any) that corresponds to the sessiondata\n      const targetcall = getCallByWrtcsSessionId(context.getState(), genericNotification.sessionData)\n      if (!targetcall) {\n        log.warn('Call associated with received SIP notification cannot be found.')\n      } else {\n        callId = targetcall.id\n      }\n    }\n\n    /*\n     * Determine which scenario we received this notification in:\n     *  - Provisioned and subscribed: Application subscribed for the event during user subscription,\n     *      and created a SIP subscription for it.\n     *  - Provisioned, not subscribed: Application subscribed for the event during user subscription,\n     *      but the SDK does not have a SIP subscription for it.\n     *  - Unsolicited: Application has no user or SIP subscription for the event.\n     *\n     * We want to emit the notification in all scenarios, so this check is mainly for logging purposes.\n     */\n    if (sipEvents.includes(notification.eventType)) {\n      const eventInfo = getSipEventInfo(context.getState(), notification.eventType)\n\n      // Determine if there is a SIP subscription for this sip event in state.\n      if (eventInfo) {\n        // User subscribed to sip event, with a SIP subscription found in state.\n        log.info(`Received solicited SIP event notification of type ${notification.eventType}.`, notification)\n      } else {\n        // User subscribed to sip event, but no SIP subscription found.\n        //    This is assumed to be an edge-case where the SDK lost the SIP subscription info.\n        log.info(\n          `Received solicited SIP event notification for untracked event of type ${notification.eventType}.`,\n          notification\n        )\n      }\n    } else {\n      // User not subscribed to sip event.\n      log.info(`Received unsolicited SIP event notification of type ${notification.eventType}.`, notification)\n    }\n\n    // Dispatch an action to update state.\n    context.dispatch(actions.sipEventReceived(notification, callId))\n\n    // Always emit the notification to the application.\n    emitEvent(eventTypes.EVENT_RECEIVED, {\n      eventType: notification.eventType,\n      eventId: notification.eventId,\n      links: {\n        callId: callId\n      },\n      event: notification\n    })\n  }\n\n  return {\n    // API operations:\n    subscribe,\n    unsubscribe,\n    update,\n\n    startSipEventResub,\n    stopSipEventResub,\n\n    // Notification handlers.\n    receiveEvent\n  }\n}\n","// Other plugins\nimport { getConnectionInfo } from '../auth/interface/selectors'\nimport BasicError, { sipEventCodes } from '../errors'\n\n/**\n * sipEvents REST Requests factory function.\n * Defines the REST interface between the SDK and KL's sip REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for sipEvents.\n\n /**\n * SIP Events Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's SIP Event REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for SIP Events.\n */\nexport default function createRequests(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('SIPEVENTS')\n\n  async function subscribe(eventType, subscribeUserList, clientCorrelator, customParameters, expires) {\n    const { getState } = context\n    const { server, username } = getConnectionInfo(getState())\n\n    const requestOptions = {}\n    requestOptions.method = 'POST'\n\n    requestOptions.url =\n      `${server.protocol}://${server.server}:${server.port}/` +\n      `rest/version/${server.version}/` +\n      `user/${username}/` +\n      'eventSubscription'\n\n    requestOptions.body = {\n      eventSubscriptionRequest: {\n        subscribeUserList,\n        clientCorrelator,\n        eventType,\n        expires\n      }\n    }\n    if (customParameters.length) {\n      requestOptions.body.eventSubscriptionRequest.customParameters = customParameters\n    }\n    requestOptions.body = JSON.stringify(requestOptions.body)\n\n    const response = await sendRequest(requestOptions)\n    const { body, error, result } = response\n\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.eventSubscriptionResponse\n        const message = `Failed to subscribe to sip event ${eventType}, ` + `status code ${statusCode}`\n        log.info(message)\n\n        throw new BasicError({\n          code: sipEventCodes.UNKNOWN_ERROR,\n          message\n        })\n      } else {\n        // Handler errors from the request helper.\n        const { message } = result\n        const errMsg = `SIP event subscription request failed: ${message}.`\n        log.info(errMsg)\n\n        throw new BasicError({\n          code: sipEventCodes.UNKNOWN_ERROR,\n          message: errMsg\n        })\n      }\n    }\n    return response\n  }\n\n  async function unsubscribe(eventType, eventInfo) {\n    const { getState } = context\n\n    const { server, username } = getConnectionInfo(getState())\n\n    const requestOptions = {}\n    requestOptions.method = 'DELETE'\n    requestOptions.responseType = 'none'\n\n    requestOptions.url =\n      `${server.protocol}://${server.server}:${server.port}/` +\n      `rest/version/${server.version}/` +\n      `user/${username}/` +\n      `eventSubscription/${eventInfo.sessionData}`\n\n    const response = await sendRequest(requestOptions)\n    const { body, error, result } = response\n\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.eventSubscriptionResponse\n        const message = `Failed to unsubscribe from sip event ${eventType}, ` + `status code ${statusCode}`\n        log.info(message)\n\n        throw new BasicError({\n          code: sipEventCodes.UNKNOWN_ERROR,\n          message\n        })\n      } else {\n        // Handler errors from the request helper.\n        const { message } = result\n        const errMsg = `SIP event unsubscription request failed: ${message}.`\n        log.info(errMsg)\n\n        throw new BasicError({\n          code: sipEventCodes.UNKNOWN_ERROR,\n          message: errMsg\n        })\n      }\n    }\n    return response\n  }\n\n  /**\n   * KL REST Request to update a SIP event subscription.\n   * @method update\n   * @param  {string} eventType The name of the SIP event.\n   * @param  {string} eventInfo The name of the SIP event.\n   * @param  {Object} userLists\n   * @param  {Array<string>}  userLists.subscribeUserList List of users to add to the subscription.\n   * @param  {Array<string>}  userLists.unsubscribeUserList List of users to remove from the subscription. If all users are removed, the event subscription will be deleted.\n   * @param  {Array<call.CustomParameter>} [customParameters] Custom SIP header parameters for the SIP backend.\n   * @return {Object} Result of sipEvent update request.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   * @throws {BasicError} Throws an error if the server responds with auth issue.\n   * @throws {BasicError} Throws an error if the server responds with bad request.\n   * @throws {BasicError} Throws an error if the server responds with forbidden service.\n   */\n  async function update(eventType, eventInfo, userLists, customParameters) {\n    const { getState } = context\n\n    const { server, username } = getConnectionInfo(getState())\n\n    const requestOptions = {}\n    requestOptions.method = 'PUT'\n\n    requestOptions.url =\n      `${server.protocol}://${server.server}:${server.port}/` +\n      `rest/version/${server.version}/` +\n      `user/${username}/` +\n      `eventSubscription/${eventInfo.sessionData}`\n\n    requestOptions.body = JSON.stringify({\n      eventSubscriptionRequest: {\n        ...userLists,\n        eventType,\n        customParameters,\n        expires: eventInfo.expires\n      }\n    })\n\n    const response = await sendRequest(requestOptions)\n    const { body, error, result } = response\n\n    if (error) {\n      let error\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.eventSubscriptionResponse\n        log.info(`Failed to update sip event subscription; ${eventType}, ` + `status code ${statusCode}`)\n\n        error = new BasicError({\n          code: sipEventCodes.UNKNOWN_ERROR,\n          message: `Failed to update to sip event subscription; ${eventType}, ` + `status code ${statusCode}`\n        })\n      } else {\n        // Handler errors from the request helper.\n        const { message } = result\n        log.info(`SIP event update subscription request failed: ${message}.`)\n\n        error = new BasicError({\n          code: sipEventCodes.UNKNOWN_ERROR,\n          message: `SIP event update subscription request failed: ${message}.`\n        })\n      }\n      throw error\n    } else {\n      // Request was successful.\n      return body.eventSubscriptionResponse\n    }\n  }\n\n  return {\n    // Operation requests.\n    subscribe,\n    unsubscribe,\n    update\n  }\n}\n","/**\n * Possible subscription states.\n * @name SUBSCRIPTION_STATE\n * @type {Object}\n */\nexport const SUBSCRIPTION_STATE = {\n  FULL: 'FULL',\n  PARTIAL: 'PARTIAL',\n  NONE: 'NONE'\n}\n\n/**\n * Possible disconnect reasons.\n * @name DISCONNECT_REASONS\n * @type {Object}\n */\nexport const DISCONNECT_REASONS = {\n  GONE: 'GONE',\n  LOST_CONNECTION: 'LOST_CONNECTION',\n  WS_OVERRIDDEN: 'WS_OVERRIDDEN'\n}\n\n/**\n * Possible operations.\n * @name OPERATIONS\n * @type {Object}\n */\nexport const OPERATIONS = {\n  SUBSCRIBE: 'SUBSCRIBE',\n  UNSUBSCRIBE: 'UNSUBSCRIBE'\n}\n\n/**\n * This is the minimum allowed value based on which, any outstanding services subscription can be refreshed.\n * Any user provided `subscription.expires` interval is always compared against this value,\n * to ensure it does not go below this minimum.\n */\nexport const MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL = 60000 // in milliseconds\n","const prefix = '@@KANDY/SUBSCRIPTION/'\n\nexport const SUBSCRIBE = prefix + 'SUBSCRIBE'\nexport const SUBSCRIBE_FINISHED = prefix + 'SUBSCRIBE_FINISHED'\n\nexport const UNSUBSCRIBE = prefix + 'UNSUBSCRIBE'\nexport const UNSUBSCRIBE_FINISHED = prefix + 'UNSUBSCRIBE_FINISHED'\n\nexport const RESUBSCRIPTION_FINISHED = prefix + 'RESUBSCRIPTION_FINISHED'\n\nexport const PLUGIN_SUBSCRIPTION = prefix + 'PLUGIN_SUBSCRIPTION'\nexport const PLUGIN_SUBSCRIPTION_FINISHED = prefix + 'PLUGIN_SUBSCRIPTION_FINISHED'\nexport const PLUGIN_UNSUBSCRIPTION = prefix + 'PLUGIN_UNSUBSCRIPTION'\nexport const PLUGIN_UNSUBSCRIPTION_FINISHED = prefix + 'PLUGIN_UNSUBSCRIPTION_FINISHED'\n\nexport const CHANNEL_OPENED = prefix + 'CHANNEL_OPENED'\nexport const CHANNEL_CLOSED = prefix + 'CHANNEL_CLOSED'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Helper function for formatting actions.\n * Ensures that actions follow an expectable format.\n * @method actionFormatter\n * @param  {string}  actionType   [description]\n * @param  {Object} [payload={}] The action payload.\n * @param  {BasicError} [payload.error] For an error action, the error should be provided.\n * @param  {Object} [meta={}] The action meta data.\n * @return {Object}\n */\nfunction actionFormatter(actionType, payload = {}, meta = {}) {\n  return {\n    type: actionType,\n    payload: {\n      ...payload\n    },\n    error: !!payload.error,\n    meta: {\n      ...meta\n    }\n  }\n}\n\n/**\n * Represents a request to subscribe to services and connect to a notification\n * channel.\n * @method subscribe\n * @param  {Array}   services  An array containing the request services.\n * @param {Object} [options] Any parameters that aren't credentials.\n * @return {Object}            A flux standard action.\n */\nexport function subscribe(services = [], options) {\n  return actionFormatter(actionTypes.SUBSCRIBE, { services, ...options })\n}\n\n/**\n * Indicates that the subscription process has finished.\n * @method subscribeFinished\n * @param  {Object}  subscriptions  An object representing the subscriptions.\n * @param  {string}  type                 The type of notificationChannel for this subscription.\n * @param  {Object}  error                An error object.\n * @return {Object}                       A flux standard action.\n */\nexport function subscribeFinished({ subscriptions, type, error }) {\n  return actionFormatter(actionTypes.SUBSCRIBE_FINISHED, { subscriptions, type, error })\n}\n\n/**\n * A request to unsubscribe from services.\n * @method unsubscribe\n * @param  {Array} services A list of services.\n * @param  {string} type The type of notificationChannel.\n * @return {Object} A flux standard action.\n */\nexport function unsubscribe(services = [], type) {\n  return actionFormatter(actionTypes.UNSUBSCRIBE, { services, type })\n}\n\n/**\n * A notice that unsubscription has finished.\n * @method unsubscribeFinished\n * @param  {string} type The type of notificationChannel.\n * @param  {Object} [error] An error object.\n * @param  {string} [reason] The reason for the unsubscribe, if abnormal.\n * @return {Object} A flux standard action.\n */\nexport function unsubscribeFinished({ type, error, reason, retryAfter }) {\n  const payload = retryAfter ? { type, error, reason, retryAfter } : { type, error, reason }\n  return actionFormatter(actionTypes.UNSUBSCRIBE_FINISHED, payload)\n}\n\n/**\n * Action creator representing the finish of a resubscription request.\n * Payload mirrors a resubscription finished action.\n *\n * @method resubscribeFinished\n * @param {Object} $0\n * @param {string} [$0.error] An error message. Only present if an error occurred.\n * @param {string} [$0.attemptNum] The attempt number of this resubscription.\n * @return {Object} A flux standard action.\n */\nexport function resubscribeFinished({ error, attemptNum }) {\n  var action = {\n    type: actionTypes.RESUBSCRIPTION_FINISHED,\n    meta: {}\n  }\n\n  if (error) {\n    action.error = true\n    action.payload = error\n    action.payload.attemptNum = attemptNum\n  } else {\n    action.payload = {\n      attemptNum\n    }\n  }\n\n  return action\n}\n\n/**\n * Indicates that the subscription plugin expects plugins to subscribe\n * for the specified services.\n * @method doPluginSubscriptions\n * @param  {Array<Object>}  services The list of services that should be subscribed to.\n * @param  {string} type The type of notification channel for these subscriptions.\n * @return {Object} A flux standard action.\n */\nexport function doPluginSubscriptions(services, type) {\n  return actionFormatter(actionTypes.PLUGIN_SUBSCRIPTION, { services, type })\n}\n\n/**\n * Indicates that a plugin has finished a subscription for the specified service.\n * @method reportSubscriptionFinished\n * @param  {Object} params\n * @param  {string} params.service The service that the subscription was for.\n * @param  {string} params.type The type of notification channel for this subscription.\n * @param  {Object} params.subscription The subscription response from the backend.\n * @param  {BasicError} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function reportSubscriptionFinished({ service, type, subscription, error }) {\n  const subscriptionId = subscription ? subscription.resourceURL.split('/subscriptions/')[1] : null\n  return actionFormatter(actionTypes.PLUGIN_SUBSCRIPTION_FINISHED, {\n    ...subscription,\n    subscriptionId: subscriptionId,\n    service,\n    channelType: type,\n    error\n  })\n}\n\n/**\n * Indicates that the subscription plugin expects plugins to unsubscribe\n * for the specified services.\n * @method doPluginUnsubscriptions\n * @param  {Array}  services The list of services that should be unsubscribed.\n * @param  {string} type The type of notification channel for these unsubscriptions.\n * @return {Object} A flux standard action.\n */\nexport function doPluginUnsubscriptions(services, type) {\n  return actionFormatter(actionTypes.PLUGIN_UNSUBSCRIPTION, { services, type })\n}\n\n/**\n * Indicates that a plugin has finished an unsubscription for the specified service.\n * @method reportUnsubscriptionFinished\n * @param  {Object} params\n * @param  {string} params.service The service that the unsubscription was for.\n * @param  {string} params.type The type of notification channel for this unsubscription.\n * @param  {BasicError} [params.error] An error object.\n * @return {Object} A flux standard action.\n */\nexport function reportUnsubscriptionFinished({ service, type, error }) {\n  return actionFormatter(actionTypes.PLUGIN_UNSUBSCRIPTION_FINISHED, {\n    service,\n    channelType: type,\n    error\n  })\n}\n\n/**\n * Indicates that a notification channel has been opened / created.\n * @method channelOpened\n * @param {Object} channelInfo Data about the notification channel.\n * @param {string} type The type of notification channel.\n * @return {Object} A flux standard action.\n */\nexport function channelOpened(channelInfo, type) {\n  return actionFormatter(actionTypes.CHANNEL_OPENED, { ...channelInfo }, { type })\n}\n\n/**\n * Indicates that a notification channel has been closed / deleted.\n * @method channelClosed\n * @param {string} type The type of notification channel.\n * @return {Object} A flux standard action.\n */\nexport function channelClosed(type) {\n  return actionFormatter(actionTypes.CHANNEL_CLOSED, {}, { type })\n}\n","/**\n * The 'services' namespace allows an application to manage how they wish the SDK to\n *    receive communications from the platform. An application can subscribe to\n *    services in order to receive updates about that service for the current\n *    user. A feature generally requires a subscription for its service to be\n *    fully functional.\n *\n * The services an application can subscribe to are based on the features\n *    included in the SDK. The list of available services can be retrieved\n *    using the {@link services.getSubscriptions} API. These values can be used\n *    with the {@link services.subscribe} API.\n *\n * The channel used for subscriptions is the method for receiving the service\n *    updates. The recommended channel is `websocket`, where the SDK is able to\n *    handle receiving the updates internally. Alternate channel methods, if a\n *    websocket cannot be used, will be available in the future.\n *\n * @public\n * @namespace services\n */\n\n/**\n * The ServiceDescriptor type defines the format for specifying how to subscribe for a certain service.\n * This is the service configuration object that needs to be passed (as part of an array of configuration objects) when calling\n * the {@link services.subscribe} function.\n * Only some plugins (`call`, `messaging` and `presence`) support such configuration object that needs to be passed\n * to the subscribe function.\n *\n * @public\n * @static\n * @typedef {Object} ServiceDescriptor\n * @property {string} service The name of the available service user wants to subscribe to.\n * The available service names are `chat`, `presence`, `call` and `smsinbound`.\n *\n * @property {Object} [params] An object containing any additional parameters required for subscribing to that service.\n * This is an optional property as not all service subscriptions require it.\n * @memberof services\n * @example\n * // Subscribe to chat, presence & call services on a WebSocket channel.\n * client.services.subscribe([\n *    {service: 'chat'},\n *    {service: 'presence'},\n *    {service: 'call'},\n * ], 'websocket')\n */\n\n/**\n * The SmsInboundServiceParams type defines the additional information when subscribing to SMS inbound service.\n * This is the configuration object that needs to be passed as the value for the {@link services.ServiceDescriptor ServiceDescriptor.params} property.\n *\n * @public\n * @static\n * @typedef {Object} SmsInboundServiceParams\n * @memberof services\n * @property {string} destinationAddress An E164 formatted DID number.\n *     The subscription created will provide notifications for inbound SMS messages destined for this address.\n * @example\n * // Subscribe to smsinbound service on a WebSocket channel.\n * client.services.subscribe([\n *    {service: 'smsinbound', params: {destinationAddress: '+18001234567'}}\n * ], 'websocket')\n */\n\n// Subscription plugin.\nimport * as eventTypes from './eventTypes'\nimport { getSubscribedServices, getRegisteredServices } from './selectors'\n\n// Auth plugin.\nimport { getUserInfo as selectUserInfo } from '../../auth/interface/selectors'\n\n// Constants\nimport { notificationTypes } from '../../constants'\n\n// Libraries\nimport { normalizeServices } from '../../common/utils'\n\n// Errors\nimport BasicError, { subscriptionCodes } from '../../errors'\n\n/**\n * Service API. All functions in this plugin are part of the 'services' namespace.\n * @method api\n * @param  {Function} params\n * @param  {Function} params.dispatch - The redux store's dispatch function.\n * @param  {Function} params.getState - The redux store's getState function.\n * @return {Object} api - The subscription API object.\n */\nexport default function createAPI(container) {\n  const { context, SubscriptionOperations: operations, logManager, API_LOG_TAG, emitEvent } = container\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  const subscriptionApi = {\n    /**\n     * Subscribes to platform notifications for an SDK service.\n     *\n     * For push notifications on link, please see {@link notifications.registerPush}\n     *\n     * The SDK currently only supports the `websocket` channel as a subscription\n     *    type.\n     *\n     * When calling this API, SDK emits a {@link services.event:subscription:change subscription:change} event, each time there is a change in subscriptions.\n     *\n     * Upon getting such event, existing subscriptions can be retrieved using the\n     *    {@link services.getSubscriptions} API.\n     *\n     * @public\n     * @static\n     * @memberof services\n     * @requires subscription\n     * @method subscribe\n     * @param {Array<string | services.ServiceDescriptor>} services A list of service configurations.\n     * @param {Object} [options] The options object for non-credential options.\n     * @param {string} [options.type='websocket'] The method of how to receive service updates.\n     * @param {string} [options.clientCorrelator] Unique ID for the client. This is used by the platform to identify an instance of the application used by the specific device.\n     * @return {undefined}\n     *  @example\n     * // Subscribe for chat and SMS services.\n     * client.services.subscribe(['call', 'IM'], {clientCorrelator: 'abc123'})\n     */\n    async subscribe(services, options = {}) {\n      log.debug(API_LOG_TAG + 'services.subscribe: ', services, options.type)\n      // For backwards compatibility, we need to check if the 2nd parameter\n      // is a string and if it's a valid notification type, then convert\n      // it to the new api format\n      if (\n        typeof options === 'string' &&\n        (options === notificationTypes.WEBSOCKET || options === notificationTypes.PUSH)\n      ) {\n        options = {\n          type: options\n        }\n      }\n\n      if (!options.type) {\n        options.type = notificationTypes.WEBSOCKET\n      }\n\n      const userInfo = selectUserInfo(context.getState())\n\n      try {\n        if (userInfo && userInfo.username) {\n          // Normalize services array\n          services = normalizeServices(services)\n\n          // This will call one of the two operations: subscribe OR updateSubscription\n          await operations.subscribeFlow({ services, options })\n        } else {\n          emitEvent(eventTypes.SUB_ERROR, {\n            error: new BasicError({\n              message: 'Failed to subscribe user. Please ensure credentials are set.',\n              code: subscriptionCodes.INVALID_STATE\n            })\n          })\n        }\n      } catch (error) {\n        // No further handling needed as the subscribeFlow operation emitted the subscription error.\n      }\n    },\n\n    /**\n     * Cancels existing subscriptions for platform notifications.\n     *\n     * When calling this API, SDK emits a {@link services.event:subscription:change subscription:change} event, each time there is a change in subscriptions.\n     *\n     * Upon getting such event, existing subscriptions can be retrieved using the\n     *    {@link services.getSubscriptions} API. The `subscribed` values are the\n     *    services that can be unsubscribed from.\n     *\n     * @public\n     * @static\n     * @memberof services\n     * @method unsubscribe\n     * @param {Array<string>} services A list of subscribed service names.\n     * @param {string} [type='websocket'] The method of how the service updates\n     *    are being received.\n     * @example\n     * // Unsubscribe from chat and SMS services.\n     * const services = [ 'chat', 'smsinbound' ]\n     *\n     * client.services.unsubscribe(services)\n     */\n    async unsubscribe(services, type = notificationTypes.WEBSOCKET) {\n      log.debug(API_LOG_TAG + 'services.unsubscribe: ', services, type)\n\n      const userInfo = selectUserInfo(context.getState())\n      if (userInfo && userInfo.username) {\n        try {\n          // The flow will call one of the two operations: unsubscribe OR updateSubscription\n          // There is no extected result returned to API\n          await operations.unsubscribeFlow(services, type)\n\n          log.info('Successfully unsubscribed from all services.')\n        } catch (error) {\n          // No op, unsubscribeFlow operation will dispatch/emit errors.\n        }\n      } else {\n        emitEvent(eventTypes.SUB_ERROR, {\n          error: new BasicError({\n            message:\n              'Failed to unsubscribe user: Found no existing subscription with a valid username or a valid access token.',\n            code: subscriptionCodes.INVALID_STATE\n          })\n        })\n      }\n    },\n\n    /**\n     * Retrieves information about currently subscribed services and available services.\n     * The data returned by this API is a snapshot of the SDK's current local subscription state.\n     * The data does indicate whether there was an ongoing subscription at the time this API was called.\n     * If a subscription is in fact in progress, the user should not take decisions based on this snapshot, as the subscription is not yet complete.\n     *\n     * To be notified when any subscription(s) did change/complete, listen for {@link services.event:subscription:change subscription:change} events.\n     *\n     * The `available` values are the SDK's services that an application can\n     *    subscribe to receive notifications about. A feature generally\n     *    requires a subscription to its service in order to be fully functional.\n     *\n     * The `subscribed` values are the SDK's services that the application has\n     *    an active subscription for. Services are subscribed to using the\n     *    {@link services.subscribe} API.\n     *\n     * @public\n     * @static\n     * @memberof services\n     * @method getSubscriptions\n     * @return {Object} Lists of subscribed and available services.\n     * @example\n     * // Get the lists of services.\n     * const services = client.services.getSubscriptions()\n     *\n     * // Ensure that there were no pending subscriptions at the time\n     * // we called getSubscriptions API.\n     * if (!services.isPending) {\n     *   // Figure out which available services don't have a subscription.\n     *   const notSubscribed = services.available.filter(service => {\n     *     return !services.subscribed.includes(service)\n     *   })\n     *\n     *   // Subscribe for all not-yet-subscribed services.\n     *   client.services.subscribe(notSubscribed)\n     * }\n     *\n     */\n    getSubscriptions() {\n      log.debug(API_LOG_TAG + 'services.getSubscriptions')\n      return {\n        subscribed: getSubscribedServices(context.getState()),\n        available: getRegisteredServices(context.getState()),\n        isPending: context.getState().subscription.isPending\n      }\n    }\n  }\n\n  return { services: subscriptionApi }\n}\n","/**\n * Subscription information has changed.\n *\n * The updated subscription information can be retrieved using the\n *    {@link services.getSubscriptions} API.\n * @public\n * @memberof services\n * @event subscription:change\n * @param {Object} params\n * @param {string} [params.reason] When unsolicited, the reason for the change is provided.\n *   Reason can be one of the following values:\n *   'GONE' - When Connection was terminated by the server.\n *   'LOST_CONNECTION' - When internet connection was lost.\n *   'WS_OVERRIDDEN' - When websocket was overridden by the server.\n *\n * If the `reason` parameter is provided, this means the subscription has been lost unexpectedly\n * and the application will need to handle the next steps.\n * The `reason` will explain why the subscription has been lost so that the scenario can be handled appropriately.\n */\nexport const SUB_CHANGE = 'subscription:change'\n\n/**\n * An error occurred during a subscription operation.\n *\n * The subscription information can be retrieved using the\n *    {@link services.getSubscriptions} API.\n *\n * Below are some common errors related to service subscriptions.\n *\n *  * `authentication:1`  - \"Authorization failed with server. Please check credentials. Status code: 4`\" - Invalid credentials.\n *  * `authentication:3`  - \"No subscription found for \"X\", can't unsubscribe\" - The requested service is not currently subscribed.\n *  * `authentication:3`  - \"No subscription found, can't unsubscribe.\" - There are no active subscriptions.\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 19\" - Too many active sessions with the requested user.\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 37\" - Invalid service string.\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 38\" - Invalid characters in client correlator.\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 39\" - Session does not exist anymore.\n *  * `authentication:12` - \"No services found in configuration.\" - No services found in SDK configuration.\n *\n * The following errors indicate an issue with the user account or temporary backend issue. They may require help from support or a delay before being retried.\n *\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 9\"\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 17\"\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 26\"\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 27\"\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 54\"\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 62\"\n *  * `authentication:4`  - \"Failed to subscribe user. Status Code 63\"\n *  * `authentication:13` - \"Failed to subscribe user. Status Code 53\"\n *\n *  For a more detailed look into subscription errors and handling recommendations,\n *   please refer to the \"Handling Subscription Errors\" tutorial.\n * @public\n * @memberof services\n * @requires subscription\n * @event subscription:error\n * @param {Object} params\n * @param {Object} params.error A Basic error object, representing the error that occurred.\n */\nexport const SUB_ERROR = 'subscription:error'\n\n/**\n * An attempt to extend the current user's subscription was made.\n *\n * In a failure scenario, the current user is still connected, and further\n * resubscription attempts will be made, but may become disconnected if the\n * session expires.\n * @public\n * @memberof services\n * @event subscription:resub\n * @param {Object} params\n * @param {number} params.attemptNum The attempt number of this resubscription.\n * @param {boolean} params.isFailure Whether the resubscription failed or not.\n * @param {api.BasicError} [params.error] The Basic error object.\n */\nexport const SUB_RESUB = 'subscription:resub'\n","import reducer from './reducers'\nimport createAPI from './api'\n\nconst name = 'subscription'\nexport { reducer, name, createAPI }\n","import * as actionTypes from './actionTypes'\n\n// Constants\nimport { OPERATIONS } from '../constants'\n\n// Other plugins.\nimport { DISCONNECT_REASONS } from '../../auth/constants'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\nimport { remove } from 'lodash/fp'\n\n/* State Structure\n    subscription: {\n        notificationChannels: { // An object with key values pairs for channelType -> channelInfo\n            [Websocket] : { ... }, // Channel Info taken directly from UC response.\n            [Push]      : { ... }\n        }\n    }\n */\n\nconst defaultState = {\n  // Information about the open notification channels.\n  notificationChannels: {},\n  // The list of active subscriptions.\n  subscriptions: [],\n  // The list of services that plugins can subscribe to.\n  registeredServices: ['call', 'Presence', 'IM'],\n  // Whether a subscription change is currently in progress.\n  isPending: false,\n  // The operation that is currently pending.\n  pendingOperation: null\n}\n\nconst reducers = {}\n\n// Helper function for changing the pending value.\nfunction pendingChange(value, operation) {\n  return (state, action) => {\n    return { ...state, isPending: value, pendingOperation: operation }\n  }\n}\n// Change isPending depending on the start/finish of subscriptions.\nreducers[actionTypes.SUBSCRIBE] = pendingChange(true, {\n  operation: OPERATIONS.SUBSCRIBE,\n  startTime: Date.now()\n})\nreducers[actionTypes.UNSUBSCRIBE] = pendingChange(true, {\n  operation: OPERATIONS.UNSUBSCRIBE,\n  startTime: Date.now()\n})\n\nreducers[actionTypes.SUBSCRIBE_FINISHED] = {\n  next(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      pendingOperation: null,\n      error: undefined,\n      subscriptions: action.payload.subscriptions || state.subscriptions\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      pendingOperation: null,\n      error: action.payload\n    }\n  }\n}\n\n/*\n * Remove subscriptions that are in the unsubscriptions list\n */\nreducers[actionTypes.UNSUBSCRIBE_FINISHED] = {\n  next(state, action) {\n    const newState = {\n      ...state,\n      isPending: false,\n      pendingOperation: null\n    }\n\n    newState.subscriptions = []\n\n    /*\n     * If connectivity was lost, remove all subscriptions to reflect that we\n     *    aren't receiving anything from them.\n     * In \"normal\" scenarios, other reducers handle the subscriptions state.\n     */\n    if (action.payload.reason === DISCONNECT_REASONS.LOST_CONNECTION) {\n      newState.subscriptions = []\n    }\n\n    return newState\n  },\n  throw(state) {\n    return {\n      ...state,\n      isPending: false,\n      pendingOperation: null\n    }\n  }\n}\n\n/*\n * When a plugin reports a successful subscription, store it in state.\n */\nreducers[actionTypes.PLUGIN_SUBSCRIPTION_FINISHED] = {\n  next(state, action) {\n    return {\n      ...state,\n      subscriptions: state.subscriptions.concat(action.payload)\n    }\n  }\n}\n\n/*\n * When a plugin reports a successful unsubscription, remove it from state.\n */\nreducers[actionTypes.PLUGIN_UNSUBSCRIPTION_FINISHED] = {\n  next(state, action) {\n    function removeSubscription(subscription) {\n      return subscription.channelType === action.payload.channelType && subscription.service === action.payload.service\n    }\n\n    return {\n      ...state,\n      subscriptions: remove(removeSubscription)(state.subscriptions)\n    }\n  }\n}\n\n/*\n * Store the new notification channel into state.\n * Assumption: A channel of the same type should NOT already exist.\n */\nreducers[actionTypes.CHANNEL_OPENED] = {\n  next(state, action) {\n    return {\n      ...state,\n      notificationChannels: {\n        ...state.notificationChannels,\n        [action.meta.type]: action.payload\n      }\n    }\n  }\n}\n\n/*\n * Remove the notification channel info when it has been closed.\n */\nreducers[actionTypes.CHANNEL_CLOSED] = {\n  next(state, action) {\n    return {\n      ...state,\n      notificationChannels: {\n        ...state.notificationChannels,\n        [action.meta.type]: undefined\n      }\n    }\n  }\n}\n\n/**\n * Subscription Interface reducer\n * @method reducer\n * @param  {Object}  state - The current redux state.\n * @param  {Object}  action - A flux standard action.\n * @return {Object}  - The new redux state.\n * @example\n * Subscription state structure example; connected.\n * subscriptionState = {\n *\n * }\n */\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","import { cloneDeep } from 'lodash/fp'\n\n// Utilities.\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\n/**\n * Retrieves the config options provided by the subscription plugin.\n * NOTE: This won't work with the old auth/subscription config on link.\n * It will work with the new auth/subscription config on link.\n * @method getSubscriptionConfig\n * @return {Object}\n */\nexport function getSubscriptionConfig(state) {\n  return cloneDeep(state.config.subscription)\n}\n\n/**\n * Retrieves the maximum number of times this client will attempt to subscribe, while getting a\n * 'Service Unavailable' response from backend.\n * @method getServiceUnavailableMaxRetries\n * @param {Object} state Current state object.\n * @return {number}\n */\nexport function getServiceUnavailableMaxRetries(state) {\n  return state.config.subscription.serviceUnavailableMaxRetries\n}\n\n/**\n * Retrieves the list of services that plugins have registered for.\n * @method getRegisteredServices\n * @return {Array}\n */\nexport function getRegisteredServices(state) {\n  return cloneDeep(state.subscription.registeredServices)\n}\n\n/**\n * Retrieve the list of services with current subscriptions.\n * @method getSubscribedServices\n * @param {string} type the type of subscription we want to get specifically\n * @return {Array}\n */\nexport function getSubscribedServices(state, type) {\n  const info = getSubscriptionInfo(state)\n  // For backwards compatibility, make sure that this is an array. It isn't when\n  //    the old Auth plugin is being used (eg. Link v3.X).\n  let subscriptions = Array.isArray(info) ? info : [info]\n\n  // If a type was specified, filter out subscriptions of other types.\n  if (type) {\n    subscriptions = subscriptions.filter(subscription => subscription.channelType === type)\n  }\n\n  // Massage the subscriptions to be a list of service names.\n\n  // For Link, subscription.service is an array of strings (all services).\n  // Process the subscriptions in a way that will provide an array of strings in\n  //    both cases.\n  return subscriptions.reduce((acc, currentSub) => {\n    return acc.concat(currentSub.service)\n  }, [])\n}\n\n/**\n * Retrieves the subscription information.\n * @method getSubscriptionInfo\n * @return {Array}\n */\nexport function getSubscriptionInfo(state) {\n  return cloneDeep(state.subscription.subscriptions)\n}\n\n/**\n * Retrieve the list of subscriptions matching a given channel type and service name.\n * @method getSubscriptions\n * @param {string} service the name of the service we want to get specifically (e.g. smsinbound)\n * @param {string} type the type of communication channel we want to get specifically (e.g. websocket)\n * @return {Array}\n */\nexport function getSubscriptions(state, service, type) {\n  let subscriptions = state.subscription.subscriptions\n  subscriptions = subscriptions.filter(\n    subscription => subscription.service === service && subscription.channelType === type\n  )\n  return cloneDeep(subscriptions)\n}\n\n/**\n * Retrieve the subscription expiry time from config.\n * @method getSubscriptionExpiry\n * @return {number}\n */\nexport function getSubscriptionExpiry(state) {\n  const subConfig = state.config.subscription\n  const authConfig = state.config.authentication\n\n  // In order to maintain backwards compatibility with the auth plugin config\n  // we need to first check if this setting is provided in the authentication plugin\n  // config, and if not use the one from subscription plugin.  We need to check\n  // authentication config first because if no value is provided in the subscription\n  // plugin, a default value will be used and we don't want that if one is provided in\n  // the authentication plugin.\n  const expires =\n    authConfig.subscription && authConfig.subscription.expires ? authConfig.subscription.expires : subConfig.expires\n\n  return expires\n}\n\n/**\n * Retrieve the websocket info from config. We merge the websocket config\n * from auth plugin with the one from subscription plugin giving precedence to\n * the websocket config in auth plugin since we need to maintain backwards compatibility\n * with the old format config.\n * @method getSubscriptionExpiry\n * @return {number}\n */\nexport function getWebsocketConfig(state) {\n  const subConfig = state.config.subscription\n  const authConfig = state.config.authentication\n\n  // In order to support legacy configurations, we need to do the following:\n  // Take the values (including defaults) from subscription config.  Merge into\n  // that any client provided values from the authentication config.  All keys existing\n  // in authentication config will overwrite those from subscription config.  However,\n  // since defaults are not set for websocket in the authentication plugin, only client\n  // provided values for websocket will be used from authentication config and defaults\n  // will come from the subscription plugin.\n  return mergeValues(subConfig.websocket, authConfig.websocket)\n}\n\n/**\n * Gets the websocket id being used by a current subscription.\n * @method getWebsocketId\n * @param {Object} state   Redux state.\n * @param {string} service The service name to get the websocket ID from.\n * @returns {string|undefiend} The websocket ID if it exists.\n */\nexport function getWebsocketId(state, service) {\n  let subscriptions = getSubscriptionInfo(state)\n  // For backwards compatibility, make sure that this is an array. It isn't for\n  //    CallMe since it uses the old Auth pluginb style.\n  subscriptions = Array.isArray(subscriptions) ? subscriptions : [subscriptions]\n\n  let sub\n  if (service) {\n    // Find the subscription for this service.\n    sub = subscriptions.find(sub => sub.service === 'service' || sub.service.includes(service))\n  } else {\n    // Just get the first subscription.\n    sub = subscriptions[0]\n  }\n\n  if (sub && typeof sub.notificationChannel === 'string') {\n    // Get anything after /websocket/ in the string. The ID should be after it.\n    const websocketId = sub.notificationChannel.split('/websocket/')[1]\n    return websocketId\n  } else {\n    // There is no subscription/websocket for this service.\n  }\n}\n\n/*\n * Return the pending operation if one is pending.\n * @method getPendingOperation\n * @return {string}\n */\nexport function getPendingOperation(state) {\n  return state.subscription.pendingOperation\n}\n","// API operations.\nexport { default as subscribe } from './subscribe'\nexport { default as unsubscribe } from './unsubscribe'\nexport { default as updateSubscription } from './update'\n\n// Internal operations.\nexport { default as connectionLost } from './onConnectionLost'\nexport { default as subscriptionGone } from './onSubscriptionGone'\nexport { default as websocketOverridden } from './onWebsocketOverridden'\n","import createOperation from './onConnectionLost'\n\n/**\n * Handler for when the websocket connection is lost unexpectedly.\n */\nexport default function registerFeature(bottle) {\n  // Register the operation that handles a 'loss of connection' notification\n  bottle.factory('SubscriptionOperations.onConnectionLost', container => {\n    return createOperation(bottle.container)\n  })\n}\n","// Subscription plugin.\nimport * as actions from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\nimport { DISCONNECT_REASONS } from '../../../constants'\n\n/**\n * Operation factory function responsible for handling the 'connection lost' notification.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The 'handling of loss of connection' operation.\n */\nexport default function createOperation(container) {\n  const { context, emitEvent, SubscriptionIntervals } = container\n\n  async function handleLossOfConnection() {\n    // Stop the automatic re-subscription interval.\n    SubscriptionIntervals.resubInterval.stopResubInterval()\n\n    context.dispatch(\n      actions.unsubscribeFinished({\n        reason: DISCONNECT_REASONS.LOST_CONNECTION\n      })\n    )\n\n    // Dispatch an event with same payload, for backwards compatibility.\n    emitEvent(eventTypes.SUB_CHANGE, {\n      reason: DISCONNECT_REASONS.LOST_CONNECTION\n    })\n  }\n\n  return handleLossOfConnection\n}\n","import createOperation from './onSubscriptionGone'\n\n// Notifications Plugin\nimport { NOTIFICATION_RECEIVED } from '../../../../notifications/interface/actionTypes'\n\n/**\n * Handler for when the subscription is \"gone\" unexpectedly.\n * This can happen in two scenarios:\n *    1. Receive a websocket notification saying the subscription is gone.\n *    2. Attempt to resubscribe the subscription, but get an error saying it does not exist.\n */\nexport default function registerFeature(bottle) {\n  // Register the operation that handles a 'loss of connection' notification\n  bottle.factory('SubscriptionOperations.onSubscriptionGone', container => {\n    return createOperation(bottle.container)\n  })\n\n  // Register the listener for triggering the operation after the SDK is initialized.\n  //    This ensures that the Notification plugin is setup.\n  bottle.defer(container => {\n    // Take notifications about the subscription being 'gone'.\n    function receiveSubscriptionGoneNotificationPattern(action) {\n      return (\n        action.type === NOTIFICATION_RECEIVED &&\n        action.payload.notificationMessage &&\n        action.payload.notificationMessage.eventType === 'gone'\n      )\n    }\n\n    container.Notifications.takeEveryAction(receiveSubscriptionGoneNotificationPattern, action => {\n      container.SubscriptionOperations.onSubscriptionGone(action.payload.notificationMessage)\n    })\n  })\n}\n","// Subscription plugin.\nimport * as actions from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\nimport { getPendingOperation } from '../../../interface/selectors'\nimport { DISCONNECT_REASONS, OPERATIONS } from '../../../constants'\n\n// Connectivity Plugin\nimport { getConnectionState } from '../../../../connectivity/interface/selectors'\n\n/**\n * Operation factory function responsible for handling the 'subscription gone'\n * or the 'resubscription failed' notifications.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The handling of a 'subscription gone or failed resubscription' operation.\n */\nexport default function createOperation(container) {\n  const { context, emitEvent, Connectivity, SubscriptionIntervals } = container\n\n  async function receiveNotificationMessage(notificationMessage) {\n    // Dispatch an action to disconnect the websocket (and let the connectivity\n    //      plugin know we expect it to be disconnected).\n    const wsState = getConnectionState(context.getState())\n    if (wsState.connected) {\n      Connectivity.disconnect()\n    }\n\n    // Dispatch a disconnect finished action to trigger \"user disconnected\" logic.\n    // Ignore the GONE notification if an unsubscribe operation is pending as the unsubscribe saga will trigger the subscribe:change event already.\n    const pendingOperation = getPendingOperation(context.getState())\n    if (pendingOperation && pendingOperation.operation === OPERATIONS.UNSUBSCRIBE) {\n      return\n    }\n    // Stop the automatic re-subscription interval, since any further attempts will fail,\n    //  as server side no longer keeps the old subscription reference.\n    // User will have to manually re-subscribe at this time.\n    SubscriptionIntervals.resubInterval.stopResubInterval()\n\n    const content =\n      notificationMessage && notificationMessage.retryAfter\n        ? { reason: DISCONNECT_REASONS.GONE, retryAfter: notificationMessage.retryAfter }\n        : { reason: DISCONNECT_REASONS.GONE }\n    context.dispatch(actions.unsubscribeFinished(content))\n\n    // Dispatch an event with same payload, for backwards compatibility.\n    emitEvent(eventTypes.SUB_CHANGE, {\n      reason: DISCONNECT_REASONS.GONE\n    })\n  }\n\n  return receiveNotificationMessage\n}\n","import createOperation from './onWebsocketOverridden'\n\n// Notifications Plugin\nimport { NOTIFICATION_RECEIVED } from '../../../../notifications/interface/actionTypes'\n\n/**\n * Handler for when the websocket gets overridden by another client.\n */\nexport default function registerFeature(bottle) {\n  // Register the operation to the bottle immediately.\n  bottle.factory('SubscriptionOperations.onWebsocketOverridden', container => {\n    return createOperation(bottle.container)\n  })\n\n  // Register the listener for triggering the operation after the SDK is initialized.\n  //    This ensures that the Notification plugin is setup.\n  bottle.defer(container => {\n    // Take notifications about the websocket being 'overridden'.\n    function receiveOverriddenNotificationPattern(action) {\n      return (\n        action.type === NOTIFICATION_RECEIVED &&\n        action.payload.notificationMessage &&\n        action.payload.notificationMessage.eventType === 'websocketOverridden'\n      )\n    }\n\n    container.Notifications.takeEveryAction(receiveOverriddenNotificationPattern, action => {\n      container.SubscriptionOperations.onWebsocketOverridden()\n    })\n  })\n}\n","// Subscription plugin.\nimport * as actions from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\n\nimport { DISCONNECT_REASONS } from '../../../constants'\n\n// Connectivity Plugin\nimport { getConnectionState } from '../../../../connectivity/interface/selectors'\n\n/**\n * Operation factory function responsible for handling the 'web socket overwridden' notification.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The 'handling of web socket overridden' operation.\n */\nexport default function createOperation(container) {\n  const { context, emitEvent, Connectivity, SubscriptionIntervals } = container\n\n  async function handleWebSocketOverridden() {\n    // Dispatch an action to disconnect the websocket (and let the connectivity\n    //      plugin know we expect it to be disconnected).\n    const wsState = getConnectionState(context.getState())\n    if (wsState.connected) {\n      Connectivity.disconnect()\n    }\n\n    // Stop the automatic re-subscription interval.\n    SubscriptionIntervals.resubInterval.stopResubInterval()\n\n    // Dispatch a disconnect finished action to trigger \"user disconnected\" logic.\n    context.dispatch(actions.unsubscribeFinished({ reason: DISCONNECT_REASONS.WS_OVERRIDDEN }))\n\n    // Dispatch an event with same payload, for backwards compatibility.\n    emitEvent(eventTypes.SUB_CHANGE, { reason: DISCONNECT_REASONS.WS_OVERRIDDEN })\n  }\n\n  return handleWebSocketOverridden\n}\n","import { SUBSCRIPTION_STATE } from '../../constants'\n\n/**\n * Uses the requested and received WebRTC Gateway [subscription] services to determine\n *      the SDK subscription status for each service.\n * @method parseSpidrServices\n * @param  {Array}  requested The list of requested WebRTC Gateway services.\n * @param  {Array}  received The list of received WebRTC Gateway services.\n * @return {Object} Information about the SDK's subscriptions.\n */\nexport function parseSpidrServices(requested, received) {\n  // UC platform is not case-sensitive (Link is), so filter without caring about case.\n  const upperReceived = received.map(service => service.toUpperCase())\n\n  // Find the missing services.\n  const missing = requested.filter(function (reqService) {\n    // If the requested service was received (not caring about case),\n    //      it is not missing.\n    return upperReceived.indexOf(reqService.toUpperCase()) === -1\n  })\n\n  const subscriptions = {\n    requested,\n    received,\n    missing,\n    status: 'UNKNOWN',\n    services: {}\n  }\n\n  // Determine the overall subscription status.\n  if (received.length === 0) {\n    subscriptions.status = SUBSCRIPTION_STATE.NONE\n  } else if (received.length > 0 && missing.length > 0) {\n    subscriptions.status = SUBSCRIPTION_STATE.PARTIAL\n  } else if (received.length > 0 && requested.length === received.length) {\n    subscriptions.status = SUBSCRIPTION_STATE.FULL\n  } else {\n    // Should never reach this case.\n  }\n\n  // List the individual service statuses.\n  received.forEach(function (service) {\n    subscriptions.services[service] = true\n  })\n  missing.forEach(function (service) {\n    subscriptions.services[service] = false\n  })\n\n  return subscriptions\n}\n","import subscribeRequest from './request'\nimport subscribeOperation from './operation'\nimport subscribeFlow from './subscribeFlow'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('SubscriptionRequests.subscribe', container => {\n    return subscribeRequest(bottle.container)\n  })\n\n  bottle.factory('SubscriptionOperations.subscribe', container => {\n    return subscribeOperation(bottle.container)\n  })\n\n  bottle.factory('SubscriptionOperations.subscribeFlow', container => {\n    return subscribeFlow(bottle.container)\n  })\n}\n","// Subscription plugin.\nimport * as actionTypes from '../../../interface/actionTypes'\n\n// Auth plugin\nimport { getAuthConfig, getConnectionInfo } from '../../../../auth/interface/selectors'\nimport { updateHmacToken } from '../../../../auth/interface/actions'\n\n// Connectivity Plugin\nimport { getConnectivityConfig } from '../../../../connectivity/interface/selectors'\n\n// Utilities\nimport { delay } from '../../../../common/utils'\n\n// Errors\nimport BasicError, { authCodes, subscriptionCodes } from '../../../../errors'\n\nimport {\n  // getSubscriptionInfo,\n  getSubscriptionExpiry,\n  getWebsocketConfig,\n  // getPendingOperation,\n  getServiceUnavailableMaxRetries\n} from '../../../interface/selectors'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `subscribe` operation.\n */\nexport default function createOperation(container) {\n  const {\n    context,\n    logManager,\n    SubscriptionOperations: operations,\n    SubscriptionRequests: requests,\n    Notifications,\n    Connectivity\n    //, emitEvent\n  } = container\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * Operation for subscribing to a given set of services on the Link backend.\n   * Performs the workflow of connecting/subscribing to WebRTC Gateway services.\n   *\n   * @method subscribe\n   * @param {Array<string | services.ServiceDescriptor>} services A list of service configurations.\n   * @param {Object} [options] The options object for non-credential options.\n   * @return {Object} If success, this is the response from backend containing the names of subscribed services.\n   * @throws {BasicError} Throws an error if parameters are invalid or REST request fails.\n   */\n  async function subscribe(services, options) {\n    log.info(`Initiating subscription for services: ${services}`)\n\n    if (!services || services.length === 0) {\n      // Error scenario: No services specified.\n      throw new BasicError({ code: subscriptionCodes.NO_SERVICE_PROVIDED, message: 'No service provided' })\n    }\n\n    try {\n      // Retrieve the connection info\n      const authConfig = getAuthConfig(context.getState())\n\n      // Retrieve the connection info.\n      const linkConnection = getConnectionInfo(context.getState())\n\n      // Get the configured expiry value for subscriptions\n      const expires = getSubscriptionExpiry(context.getState())\n\n      services = services.map(subscription => subscription.service)\n\n      let response\n      let attemptNum = 1 // keeps count of how many subscription requests we sent so far\n      const maxReAttempts = getServiceUnavailableMaxRetries(context.getState())\n\n      // 1 + : there will be one initial attempt followed by up to a maximum number of re-attempts.\n      while (attemptNum <= 1 + maxReAttempts) {\n        // Don't `resubscribe` (which is a PUT request) on any subsequent requests.\n        // Rather use `subscribe` which uses the same REST request (i.e. POST)\n        response = await requests.subscribe(authConfig, expires, linkConnection, services, options)\n\n        if (response.error) {\n          //  we check if subsequent errors are also 503s (after so many tries)\n          if (response.error.code === authCodes.LINK_SUBSCRIBE_UNAVAILABLE && response.retryAfter) {\n            if (attemptNum === 1 + maxReAttempts) {\n              // Trigger the usual action in case of failure & abort right away.\n              // NOTE: This action won't mention the fact that we tried so many times,\n              // as it should be transparent to the application level.\n\n              // Just the log would include this info, to help in debugging.\n              log.debug(`Subscription failed: ${response.error} after ${attemptNum - 1} re-attempts.`)\n              throw response.error // we will catch it below\n            }\n\n            // Wait for either the subscribe delay or a disconnect action, whichever comes first.\n            const result = await Promise.race([\n              delay(response.retryAfter),\n              Notifications.takeAction(actionTypes.UNSUBSCRIBE_FINISHED)\n            ])\n\n            if (result && result.actionType && result.actionType === actionTypes.UNSUBSCRIBE_FINISHED) {\n              // User decided to unsubscribe before we attempted to make another `subscribe` request.\n              // Abort any subscriptions & don't trigger any failure because it is really a user cancellation.\n              return\n            } else {\n              // If the delay expired first, attempt another `subscribe` request by\n              // incrementing our attempts count.\n              // We got a 503 error, but we're still allowed to retry our `subscribe` request.\n              // We also won't log any of these intermediary 503 errors, since we'll make yet another attempt.\n              attemptNum++\n            }\n          } else {\n            // We got an error other than 503 (or the 503 did not have a retryAfter value).\n            // Either way, we treat it as a final error as it should mark the end of our attempts.\n            if (attemptNum > 1) {\n              log.debug(`Subscription subsequently failed: ${response.error} (after getting an initial 503 response).`)\n            } else {\n              // We got an error the first time we tried to subscribe.\n              log.debug(`Subscription failed: ${response.error}`)\n            }\n            throw response.error // we will catch it below\n          }\n        } else {\n          // We got a succesul response to our latest `subscribe` request,\n          // so cancel any further `subscribe` attempts.\n          break\n        }\n      } // end of while loop\n\n      const hmacToken = linkConnection.requestOptions.headers['x-token']\n\n      // If used HMAC token for authentication\n      if (hmacToken) {\n        // Subsequent requests must not have the x-token header and must have the x-session header.\n        // Need to delete the x-token header for subsequent requests to work.\n        if (response.subscriptionParams) {\n          context.dispatch(updateHmacToken(response.subscriptionParams.sessionId))\n\n          // Above action distaches no event\n        } else {\n          const error = new BasicError({\n            message: 'Failed user subscription.',\n            code: authCodes.LINK_SUBSCRIBE_FAIL\n          })\n          throw error // we will catch it below\n        }\n      }\n\n      // Keep track of service subscription information.\n      const subscription = {\n        ...response.subscriptionParams,\n        servicesInfo: response.servicesInfo,\n        url: response.subscription\n      }\n\n      const { webSocketOAuthMode } = getConnectivityConfig(context.getState())\n\n      const params = {}\n      const bearerAccessToken = linkConnection.bearerAccessToken\n\n      if (bearerAccessToken && webSocketOAuthMode === 'query') {\n        // If using bearerAccessToken, set the param token property to its value\n        params.access_token = bearerAccessToken\n      }\n\n      // Need to create a new object, rather than adding `url` to\n      // connectionInfo in order to prevent state mutation.\n      // Format the response to pass off to the connectivity plugin.\n      const websocketConfig = getWebsocketConfig(context.getState())\n      const websocketInfo = {\n        protocol: 'wss',\n        server: websocketConfig.server,\n        port: websocketConfig.port,\n        url: subscription.notificationChannel,\n        params: params\n      }\n\n      try {\n        // Request the websocket connection.\n        await Connectivity.connect(websocketInfo)\n      } catch (err) {\n        // Clean up our subscription on the backend\n        await operations.unsubscribe([subscription])\n        throw err // will be caught below\n      }\n\n      log.info(`Subscribed to the following services: ${subscription.service}`)\n\n      // SUBSCRIBE_FINISHED action (with no error) will be invoked once this operation returns,\n      // so return the subscription object\n      return { subscriptions: [subscription] }\n    } catch (error) {\n      // Any errors enountered by the subscribe operation will be caught here\n      log.debug(`Subscription failed: ${error.message}`)\n      // Delegate to API: the API will trigger a subscribeFinished action containing this error.\n      throw error\n    }\n  }\n\n  return subscribe\n}\n","// Auth plugin.\nimport { getUserInfo as selectUserInfo } from '../../../../auth/interface/selectors'\nimport { parseSpidrServices } from '../services'\n\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\nimport BasicError, { authCodes } from '../../../../errors'\n\n/**\n * Request factory function.\n * @method createRequest\n * @param  {Object} container The bottle container.\n * @return {Function} The `subscribe` REST operation.\n */\nexport default function createRequest(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * KL REST Request to subscribe for various backend services.\n   * @method subscribe\n   * @param {Object} authConfig Configuration from the auth plugin.\n   * @param {number} expires Length in time to keep subscription.\n   * @param  {Object} connection Server information.\n   * @param {Array<string | services.ServiceDescriptor>} services A list of service configurations.\n   * @param {Object} [options] The options object for non-credential options.\n   * @return {Object} Subscription response containing the list of subscribed service names.\n   * @throws {BasicError} Throws an error if the REST request fails.\n   */\n  async function subscribe(authConfig, expires, connection, services, extras = {}) {\n    const userInfo = selectUserInfo(context.getState())\n    const subscribeType = userInfo.isAnonymous ? 'anonymous' : 'user'\n    let requestOptions = {}\n    requestOptions.method = 'POST'\n\n    requestOptions.url =\n      `${connection.server.protocol}://${connection.server.server}:${connection.server.port}` +\n      `/rest/version/${connection.server.version}` +\n      `/${subscribeType}/${connection.username}/subscription`\n\n    requestOptions.body = JSON.stringify({\n      subscribeRequest: {\n        expires: expires,\n        service: services,\n        localization: authConfig.localization || 'English_US',\n        useTurn: authConfig.useTurn || true,\n        notificationType: authConfig.notificationType || 'WebSocket',\n        supported: ['RingingFeedback'],\n        clientCorrelator: extras.clientCorrelator\n      }\n    })\n\n    // If there were any extra request options, merge them into the\n    //      options for this request. Priority is for the options defined here.\n    requestOptions = mergeValues(extras, requestOptions)\n    const response = await sendRequest(requestOptions)\n    const { body, error, result } = response\n\n    if (error) {\n      let errorCode = authCodes.LINK_SUBSCRIBE_FAIL\n      if (body) {\n        let statusCode\n        let retryAfter\n        /*\n         * In some cases, the response is not wrapped in a `subscribeResponse`\n         *    property. This seems to be when using a pre-provisioned user (stored\n         *    as part of KL?) rather than a dynamically created user (retrieved\n         *    from AS?).\n         * Reference: ABE-23981 (and KAA-1937)\n         */\n        if (body.statusCode && body.reason) {\n          statusCode = body.statusCode\n          if (statusCode === 503) {\n            retryAfter = body.retryAfter\n            errorCode = authCodes.LINK_SUBSCRIBE_UNAVAILABLE\n          }\n        } else if (body.subscribeResponse) {\n          statusCode = body.subscribeResponse.statusCode\n          if (statusCode === 503) {\n            retryAfter = body.subscribeResponse.retryAfter\n            errorCode = authCodes.LINK_SUBSCRIBE_UNAVAILABLE\n          }\n        }\n        log.debug(`Failed user subscription with status code ${statusCode}.`)\n\n        // Handle errors from the server.\n        const errorInfo = {\n          message: `Failed to subscribe user. Status Code: ${statusCode}.`,\n          code: errorCode\n        }\n        const returnValue = {\n          // TODO: Better error; more info.\n          error: new BasicError(errorInfo)\n        }\n        if (retryAfter && retryAfter > 0) {\n          returnValue.retryAfter = retryAfter\n        }\n\n        return returnValue\n      } else {\n        log.debug('Failed user subscription.', result.message)\n        // Handle errors from the request plugin.\n        return {\n          // TODO: Better error; more info.\n          error: new BasicError({\n            message: `Subscribe request failed: ${result.message}.`,\n            // TODO: Shared error codes.\n            code: errorCode\n          })\n        }\n      }\n    } else {\n      // Request was successful.\n      const subscribeResponse = body.subscribeResponse\n\n      const subscribedServices = subscribeResponse.subscriptionParams.service\n      const servicesInfo = parseSpidrServices(services, subscribedServices)\n      log.debug(`Subscribed user. Service subscription status: ${servicesInfo.status}`)\n\n      return {\n        error: false,\n        servicesInfo,\n        ...subscribeResponse\n      }\n    }\n  }\n\n  return subscribe\n}\n","// Subscription plugin.\nimport * as actions from '../../../interface/actions'\nimport * as actionTypes from '../../../interface/actionTypes'\nimport * as eventTypes from '../../../interface/eventTypes'\nimport { getSubscriptionInfo } from '../../../interface/selectors'\n\n// Errors\nimport BasicError, { subscriptionCodes } from '../../../../errors'\n\n/**\n * Operation factory function responsible for controlling the subscribe flow.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `subscribe flow` operation.\n */\nexport default function createOperation(container) {\n  const { context, emitEvent, SubscriptionOperations: operations, Notifications, SubscriptionIntervals } = container\n\n  /**\n   * Entry point for subscribe and update subscription change actions.\n   * It watches over the progress by checking whether operation suceeded or there was an error.\n   * It triggers the appropriate action and event for either success or failure scenario.\n   * @method subscribeFlow\n   * @param {Object} info The info needed for a subscribe or update subscription operation.\n   */\n  async function subscribeFlow(info) {\n    const { services, options } = info\n\n    context.dispatch(actions.subscribe(services, options))\n\n    emitEvent(eventTypes.SUB_CHANGE, { reason: undefined })\n\n    try {\n      // Check if we have an existing subscription\n      const subscription = getSubscriptionInfo(context.getState())\n\n      let finishOrCancel\n\n      // Check what we have in Redux state at the time we got the SUBSCRIBE action\n      if (!subscription || !subscription[0]) {\n        if (!services || services.length === 0) {\n          // Error scenario: No services specified.\n          throw new BasicError({ code: subscriptionCodes.NO_SERVICE_PROVIDED, message: 'No service provided' })\n        }\n\n        // No existing subscription, make a new subscription request\n        // Fork off and try to connect/subscribe by calling 'subscribe' operation.\n        // Call the operation just like the API calls it, except we don't await.\n        // The 'services' param is already normalized and\n        // 'options' param contains the type & clientCorrelator.\n        finishOrCancel = await Promise.race([\n          operations.subscribe(services, options),\n          Notifications.takeAction(actionTypes.UNSUBSCRIBE)\n        ])\n      } else {\n        // Existing subscription found, update our subscription.\n        // Fork off and try to update subscription by calling 'updateSubscription' operation\n        // by not waiting for it. 'services' param is already normalized.\n        finishOrCancel = await Promise.race([\n          operations.updateSubscription(services, true),\n          Notifications.takeAction(actionTypes.UNSUBSCRIBE)\n        ])\n      }\n\n      /**\n       * This if block covers 2 of the 3 flows of subscribe / unsubscribe.\n       * 1. The first block covers what happens when we receive an UNSUBSCRIBE action before we finish connecting.\n       *        IE UNSUBSCRIBE comes before a SUBSCRIBE_FINISHED.\n       * 2. The second scenario covers what happens when we get a successful SUBSCRIBE_FINISHED event before any UNSUBSCRIBE events.\n       * 3. The third scenario is not explicitly covered here. That scenario is when we received a SUBSCRIBE_FINISHED event with an error before any unsubscribe events.\n       *      In this case, there is nothing that we explicitly have to do, since a SUBSCRIBE_FINISHED event with an error doesn't place anything into the state.\n       *      Therefore there is no real cleanup for us to do in this scenario. We then want to wait for the next SUBSCRIBE (which we do via the next iteration).\n       **/\n      // In the case when updateSubscription operation finishes first, there will be no finishOrCancel returned.\n      if (finishOrCancel && finishOrCancel.type === actionTypes.UNSUBSCRIBE) {\n        // We got unsubscribe request before 'subscribe' operation (or 'updateSubscription' operation)\n        // had a chance to finish. Therefore cancel the operation by forking the 'unsubscribe' operation.\n        operations.unsubscribe()\n      } else {\n        if (finishOrCancel) {\n          // result returned by a new subcription or an updated subscription\n          context.dispatch(actions.subscribeFinished({ subscriptions: finishOrCancel.subscriptions }))\n          const payload = finishOrCancel.retryAfter\n            ? { reason: finishOrCancel.reason, retryAfter: finishOrCancel.retryAfter }\n            : { reason: finishOrCancel.reason }\n          emitEvent(eventTypes.SUB_CHANGE, payload)\n\n          // We have a sucessful subscription, so start the resubscription interval\n          // so that we automatically update our subscription, when it expires.\n          SubscriptionIntervals.resubInterval.startResubInterval()\n        } else {\n          const error = new BasicError({\n            message: 'Failed user subscription.',\n            code: subscriptionCodes.GENERIC_ERROR\n          })\n\n          throw error\n        }\n\n        // In the case of subscribe or updateSubscription operations finishing first, we need to return the result to API.\n        // The API will then dispatch SUBSCRIBE_FINISHED action.\n        return finishOrCancel\n      }\n    } catch (error) {\n      context.dispatch(actions.subscribeFinished({ error }))\n\n      emitEvent(eventTypes.SUB_ERROR, { error })\n\n      throw error\n    }\n  }\n  return subscribeFlow\n}\n","import unsubscribeRequest from './request'\nimport unsubscribeOperation from './operation'\nimport unsubscribeFlow from './unsubscribeFlow'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('SubscriptionRequests.unsubscribe', container => {\n    return unsubscribeRequest(bottle.container)\n  })\n\n  bottle.factory('SubscriptionOperations.unsubscribe', container => {\n    return unsubscribeOperation(bottle.container)\n  })\n\n  bottle.factory('SubscriptionOperations.unsubscribeFlow', container => {\n    return unsubscribeFlow(bottle.container)\n  })\n}\n","import { getSubscriptionInfo } from '../../../interface/selectors'\n\n// Auth Plugin\nimport { getConnectionInfo } from '../../../../auth/interface/selectors'\n\n// Connectivity Plugin\nimport { getConnectionState } from '../../../../connectivity/interface/selectors'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `subscribe` operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, SubscriptionRequests: requests, Connectivity } = container\n\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * Operation for unsubscribing from given set of services on the Link backend.\n   * Performs the workflow of disconnecting/unsubscribing from the WebRTC Gateway services.\n   *\n   * @method unsubscribe\n   * @param {Object} The current subscription information (which contains a list of subscribed services).\n   * @return {undefined}\n   * @throws {BasicError} Throws an error if REST request fails.\n   */\n  async function unsubscribe(subscription) {\n    log.info('Unsubscribing from existing subscription:', subscription)\n    if (!subscription) {\n      // Retrieve needed info from the store.\n      subscription = getSubscriptionInfo(context.getState())\n    }\n    // Since link will only ever have 1 subscription object in\n    // this array, we can take the first element and use it directly\n    subscription = subscription[0]\n\n    const connection = getConnectionInfo(context.getState())\n\n    // If the above info is not present, we probably got a disconnect mid-connection attempt.\n    if (subscription && connection) {\n      // If the info is in the store we can go ahead and unsubscribe.\n      // We don't care about the return value, because we are going to clean-up\n      //    the subscription in state either way.\n      try {\n        await requests.unsubscribe(connection, subscription.url)\n\n        const wsState = getConnectionState(context.getState())\n        if (wsState.connected) {\n          Connectivity.disconnect()\n        }\n      } catch (error) {\n        log.debug(`Unsubscription failed: ${error.message}`)\n        throw error\n      }\n    }\n  }\n  return unsubscribe\n}\n","// Errors\nimport BasicError from '../../../../errors'\n\n/**\n * Request factory function.\n * @method createRequest\n * @param  {Object} container The bottle container.\n * @return {Function} The `unsubscribe` REST operation.\n */\nexport default function createRequest(container) {\n  const { logManager, sendRequest } = container\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * KL REST Request to unsubscribe from various backend services\n   * using the supplied subscription info.\n   * @method unsubscribe\n   * @param  {Object}    connection Server information for the service in use.\n   * @param  {string}    connection.server Server information for generating the URL.\n   * @param  {string}    connection.requestOptions Common request options to be added.\n   * @param  {string}    subscriptionURL URL of the user's subscription instance.\n   */\n  async function unsubscribe(connection, subscriptionURL) {\n    const requestOptions = {}\n    requestOptions.method = 'DELETE'\n\n    requestOptions.url =\n      `${connection.server.protocol}://${connection.server.server}:${connection.server.port}` + subscriptionURL\n\n    // Send the unsubscribe request.\n    const response = await sendRequest(requestOptions)\n    const { body, error, result } = response\n\n    /*\n     * No matter what the response was, we still want to handle the user as\n     *    unsubscribed afterwards. If the request fails, there isn't a point to\n     *    keep the user subscribed since they want to unsubscribe anyway.\n     * For debug purposes, log what the response was but handle it as a success.\n     */\n    if (error) {\n      if (body && body.subscribeResponse) {\n        // Handle errors from the server.\n        const { statusCode } = body.subscribeResponse\n        log.debug(`Encountered error unsubscribing user with status code ${statusCode}.`)\n        throw new BasicError({ message: `Failed to unsubscribe. Status Code: ${statusCode}`, code: statusCode })\n      } else {\n        // Handle errors from the request helper.\n        const { message, code } = result\n        log.debug('Encountered error unsubscribing user.', message)\n        throw new BasicError({ message, code })\n      }\n    } else {\n      // Request was successful.\n      log.debug('User unsubscribed successfully.')\n    }\n  }\n\n  return unsubscribe\n}\n","// Subscription plugin.\nimport * as actions from '../../../interface/actions'\nimport * as eventTypes from '../../../interface/eventTypes'\nimport { getSubscriptionInfo } from '../../../interface/selectors'\n\nimport { isEmpty, difference } from 'lodash/fp'\n\n// Constants\nimport { notificationTypes } from '../../../../constants'\n\n// Errors\nimport BasicError, { authCodes, subscriptionCodes } from '../../../../errors'\n\n/**\n * Operation factory function responsible for controlling the unsubscribe flow.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `unsubscribe flow` operation.\n */\nexport default function createOperation(container) {\n  const { context, emitEvent, SubscriptionOperations: operations, SubscriptionIntervals, logManager } = container\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * Entry point for unsubscribe subscription change actions.\n   * It triggers the appropriate action and event for either success or failure scenario.\n   * @method unsubscribeFlow\n   * @param {Array} services The services to unsubscribe to.\n   * @param {string} type The notification type.\n   */\n  async function unsubscribeFlow(services, type = notificationTypes.WEBSOCKET) {\n    context.dispatch(actions.unsubscribe(services, type))\n    emitEvent(eventTypes.SUB_CHANGE, { reason: undefined })\n\n    if (!services || services.length === 0) {\n      // Error scenario: No services specified.\n      const error = new BasicError({ code: subscriptionCodes.NO_SERVICE_PROVIDED, message: 'No service provided' })\n      context.dispatch(actions.unsubscribeFinished({ error }))\n      emitEvent(eventTypes.SUB_ERROR, { error })\n\n      throw error\n    }\n\n    // Check if we have an existing subscription\n    const subscription = getSubscriptionInfo(context.getState())\n    if (subscription && subscription[0]) {\n      try {\n        // Remove all services from our subscribed services if they are present\n        const updatedServices = subscription[0].service.filter(service => !services.includes(service))\n        if (updatedServices.length === 0) {\n          // All services are being unsubscribed, so call 'unsubscribe' operation.\n          // Wait for 'unsubscribe' operation to finish so that when it returns,\n          // the API will dispatch the UNSUBSCRIBE_FINISHED action\n          await operations.unsubscribe()\n\n          //We successfuly unsubscribed from all services, so stop the resubscription interval.\n          SubscriptionIntervals.resubInterval.stopResubInterval()\n          context.dispatch(actions.unsubscribeFinished({}))\n          emitEvent(eventTypes.SUB_CHANGE, {})\n        } else if (isEmpty(difference(subscription[0].service, updatedServices))) {\n          // We don't have a subscription for any of the services requesting unsubscribing\n          // No subscription found\n          const error = new BasicError({\n            message: `No subscription found for ${JSON.stringify(services)}, can't unsubscribe.`,\n            code: authCodes.LINK_UNSUBSCRIBE_FAIL\n          })\n\n          context.dispatch(actions.unsubscribeFinished({ error }))\n\n          log.debug(`Unsubscribe failed: ${error.message}`)\n          throw error\n        } else {\n          // Some services are being unsubscribed, update our subscription\n          services = updatedServices.map(service => {\n            return {\n              service: service\n            }\n          })\n\n          // Fork off the 'updateSubscription' operation\n          const result = await operations.updateSubscription(services, false)\n          if (result) {\n            // TODO: Have the `unsubscribeFinished` action be able to handle both partial&full scenarios.\n            context.dispatch(actions.subscribeFinished({ subscriptions: result.subscriptions }))\n            emitEvent(eventTypes.SUB_CHANGE, {})\n          }\n        }\n      } catch (error) {\n        context.dispatch(actions.unsubscribeFinished({ error }))\n        emitEvent(eventTypes.SUB_ERROR, { error })\n        throw error\n      }\n    } else {\n      // No subscription found\n      const error = new BasicError({\n        message: \"No subscription found, can't unsubscribe.\",\n        code: authCodes.LINK_UNSUBSCRIBE_FAIL\n      })\n\n      log.debug(`Unsubscribe failed: ${error.message}`)\n\n      emitEvent(eventTypes.SUB_ERROR, { error })\n    }\n  }\n  return unsubscribeFlow\n}\n","import resubscribeRequest from './request'\nimport updateSubscriptionOperation from './operation'\n\nexport default function registerFeature(bottle) {\n  bottle.factory('SubscriptionRequests.resubscribe', container => {\n    return resubscribeRequest(bottle.container)\n  })\n\n  bottle.factory('SubscriptionOperations.updateSubscription', container => {\n    return updateSubscriptionOperation(bottle.container)\n  })\n}\n","// Subscription plugin\nimport { getSubscriptionInfo } from '../../../interface/selectors'\n\n// Auth plugin\nimport { getConnectionInfo } from '../../../../auth/interface/selectors'\n\n// Utils\nimport { union } from 'lodash/fp'\n\n/**\n * Operation factory function.\n * @method createOperation\n * @param  {Object} container The bottle container.\n * @return {Function} The `update subscription` operation.\n */\nexport default function createOperation(container) {\n  const { context, logManager, SubscriptionRequests: requests } = container\n\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * Operation for updating services belonging to an existing subscription on the Link backend.\n   * In both failure and success scenarios, this operation will trigger a \"subscribe finish\" action\n   * whose payload contains the end result.\n   *\n   * @method updateSubscription\n   * @param {Array} newServices The new set of services that require a subscription update.\n   * @param {boolean} addService If true, then a union between existing services and these new services will be performed and the resulting set\n   *   will be used in requesting a service update on the backend.\n   *   If false, then the subscription update request will be made only for these new services.\n   *   Therefore, if there were existinging subscribed services that are not part of new set, then subscription for those services will be discarded.\n   * @return {Object}\n   */\n  async function updateSubscription(newServices, addService = true) {\n    log.info('Updating subscription using new services: ', newServices)\n    const connection = getConnectionInfo(context.getState())\n    const subscription = getSubscriptionInfo(context.getState())\n\n    const services = newServices.map(subscription => subscription.service)\n\n    if (addService) {\n      subscription[0].service = union(services, subscription[0].service)\n    } else {\n      subscription[0].service = subscription[0].service.filter(service => services.includes(service))\n    }\n\n    try {\n      //  Use the resubscribe request to update the subscription. The endpoint is for both.\n      const response = await requests.resubscribe(connection, subscription)\n      // Keep track of service subscription information.\n      const updatedSubscription = {\n        ...response.subscriptionParams,\n        servicesInfo: response.servicesInfo,\n        url: response.subscription\n      }\n\n      log.info(`Subscribed to the following services: ${subscription[0].service}`)\n\n      // Upon returning this to subscribeFlow (which returns it to API),\n      // the API will then trigger the associated action & event\n      return { subscriptions: [updatedSubscription] }\n    } catch (error) {\n      log.debug(`Subscription failed: ${error.message}`)\n      // Throw the error. The API will catch it and dispatch appropriate action & event\n      throw error\n    }\n  }\n\n  return updateSubscription\n}\n","import { parseSpidrServices } from '../services'\n\n// Other plugins.\nimport BasicError, { authCodes } from '../../../../errors'\n\n/**\n * Request factory function.\n * @method createRequest\n * @param  {Object} container The bottle container.\n * @return {Function} The `unsubscribe` REST operation.\n */\nexport default function createRequest(container) {\n  const { logManager, sendRequest } = container\n  const log = logManager.getLogger('SUBSCRIPTION')\n\n  /**\n   * REST Request to resubscribe for existing backend services\n   * using the supplied subscription info.\n   * @method resubscribe\n   * @param  {Object}    connection Server information for the service in use.\n   * @param  {string}    connection.server Server information for generating the URL.\n   * @param  {string}    connection.requestOptions Common request options to be added.\n   * @param  {Object}    subscription Information about the subscription instance.\n   * @param  {number}    subscription.expires - The time (in seconds) until subscription expiry.\n   * @param  {Array}     subscription.service - The SPiDR services to resubscribe to.\n   * @param  {Array}     subscription.url - The URL of the user's subscription instance.\n   * @return {Object}    Resubscription response.\n   */\n  async function resubscribe(connection, [subscription]) {\n    const requestOptions = {}\n    requestOptions.method = 'PUT'\n\n    if (subscription.clientCorrelator) {\n      requestOptions.url =\n        `${connection.server.protocol}://${connection.server.server}:${connection.server.port}` +\n        `/rest/version/${connection.server.version}` +\n        `/user/${connection.username}/subscription/clientCorrelator/${subscription.clientCorrelator}`\n    } else {\n      requestOptions.url =\n        `${connection.server.protocol}://${connection.server.server}:${connection.server.port}` + subscription.url\n    }\n    // TODO: Don't hardcode the defaults here. Should be shared with\n    //      the subscribe request as well.\n    requestOptions.body = JSON.stringify({\n      subscribeRequest: {\n        expires: subscription.expires,\n        service: subscription.service,\n        localization: subscription.localization || 'English_US',\n        useTurn: subscription.useTurn || true,\n        notificationType: subscription.notificationType || 'WebSocket',\n        supported: ['RingingFeedback']\n      }\n    })\n\n    // Send the subscription update request.\n    const response = await sendRequest(requestOptions)\n    const { body, error, result } = response\n\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.subscribeResponse\n        log.debug(`Failed to update user subscription with status code ${statusCode}.`)\n\n        let message, errorCode\n        if (result.code === 404 && statusCode === 39) {\n          /*\n           * Special case: Status code 39 means the subscription does not exist (ie.\n           *    the request 404'd). We want to treat this error differently because\n           *    it is a \"subscription gone\" scenario and we need to clear the\n           *    SDK's subscription info.\n           */\n          message = `Subscription no longer exists. Code ${statusCode}.`\n          // TODO: We shouldn't be assigning arbitrary codes to BasicError (ie. only\n          //    use the codes pre-defined) because the application also gets access\n          //    to this, but we don't have a good way to pass specific error info\n          //    around for side-effects (ie. subscription gone).\n          errorCode = statusCode\n        } else {\n          message = `Failed to update user subscription with status code ${statusCode}.`\n          errorCode = authCodes.LINK_UPDATE_SUBSCRIPTION_FAIL\n        }\n\n        // TODO: Better error; more info.\n        throw new BasicError({ message, code: errorCode })\n      } else {\n        // Handle errors from the request helper.\n        const { message } = result\n        log.debug('User subscription update request failed.', message)\n\n        // TODO: Better error; more info.\n        throw new BasicError({\n          message: `Update subscription request failed.: ${message}.`,\n          // TODO: Shared error codes.\n          code: authCodes.LINK_UPDATE_SUBSCRIPTION_FAIL\n        })\n      }\n    } else {\n      // Request was successful.\n      const resubResponse = body.subscribeResponse\n\n      if (resubResponse.statusCode === 0 || resubResponse.statusCode === 2) {\n        const subscribedServices = resubResponse.subscriptionParams.service\n        const servicesInfo = parseSpidrServices(subscription.service, subscribedServices)\n        log.debug(`Resubscribed user. Service resubscription status: ${servicesInfo.status}`)\n\n        // Success.\n        return {\n          error: false,\n          servicesInfo,\n          ...resubResponse\n        }\n      } else {\n        // Unknown statusCode, consider as failure.\n        throw new BasicError({\n          message: `Unknown error; statusCode: ${resubResponse.statusCode}.`,\n          code: authCodes.LINK_UPDATE_SUBSCRIPTION_FAIL\n        })\n      }\n    }\n  }\n  return resubscribe\n}\n","// The interface to follow.\nimport { name, reducer, createAPI } from '../interface'\nimport { MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL } from '../constants'\n\n// Features (which includes Operations + Requests)\nimport * as features from './features'\n\n// Intervals\nimport * as initIntervals from './intervals'\n\n// State setters.\nimport { update as updateConfig } from '../../config/interface/actions'\n\n// Utilities.\nimport mergeValues from '@rbbn/utilities/mergeValues'\n\n// Parse and/or Validate\nimport { validation as v8n, parse } from '../../../src/common/validation'\n\n/**\n * Subscription plugin factory.\n * @method subscriptionFactory\n * @param {Object} options - Configuration options for subscription. See above.\n * @return {Object} bottle - The bottle container.\n */\nexport default function subscriptionFactory(bottle, options = {}) {\n  const minExpiryInSec = MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL / 1000\n\n  /**\n   * Configuration options for the Subscription feature.\n   * @public\n   * @name config.subscription\n   * @memberof config\n   * @instance\n   * @param {Object} subscription Subscription config.\n   * @param {number} [subscription.expires=3600] The amount of time (in seconds) for which to keep subscription up and alive. Cannot be less than minimum threshold of 60 seconds.\n   * @param {number} [subscription.serviceUnavailableMaxRetries=3] The maximum number of times this client will retry in order to subscribe for a\n   * given service, while getting 'Service Unavailable' from backend.\n   * @param {Object} subscription.websocket\n   * @param {string} subscription.websocket.server Hostname of the server to be used for websocket notifications.\n   * @param {string} [subscription.websocket.protocol=wss] Protocol to be used for websocket notifications.\n   * @param {Number} [subscription.websocket.port=443] Port to be used for websocket notifications.\n   */\n  const defaultOptions = {\n    expires: 3600, // seconds\n    serviceUnavailableMaxRetries: 3,\n    websocket: {\n      protocol: 'wss',\n      port: 443\n    }\n  }\n\n  // config validation\n  const v8nValidation = v8n.schema({\n    expires: v8n.positive().greaterThanOrEqual(minExpiryInSec),\n    serviceUnavailableMaxRetries: v8n.positive(),\n    websocket: v8n.schema({\n      server: v8n.string(),\n      protocol: v8n.string(),\n      port: v8n.positive()\n    })\n  })\n\n  const parseOptions = parse('subscription', v8nValidation)\n\n  options = mergeValues(defaultOptions, options)\n  parseOptions(options)\n\n  /*\n   * Init function to setup the Subscription plugin.\n   * @param {Object} container The bottle container.\n   */\n  function initPlugin(container) {\n    const { context } = container\n\n    if (options.expires < minExpiryInSec) {\n      // Update the config to use correct value\n      options.expires = minExpiryInSec\n    }\n\n    // Send the provided options to the store.\n    // This will be `state.config[name]`.\n    context.dispatch(updateConfig(options, name))\n  }\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('SubscriptionAPI', createAPI)\n\n  // Initialize the plugin features with the bottle scope.\n  for (const name in features) {\n    features[name](bottle)\n  }\n\n  // Initialize intervals\n  for (const name in initIntervals) {\n    initIntervals[name](bottle)\n  }\n\n  bottle.defer(initPlugin)\n\n  return {\n    capabilities: ['subscription'],\n    reducer,\n    name\n  }\n}\n","import resubInterval from './resubscribe'\n\n/**\n * Register intervals with the bottle. This will make it available on the\n *    top-level container under its namespace.\n */\nexport default function registerIntervals(bottle) {\n  bottle.factory('SubscriptionIntervals.resubInterval', () => {\n    return resubInterval(bottle.container)\n  })\n}\n","// Subscription plugin.\nimport { getSubscriptionInfo } from '../../interface/selectors'\nimport * as actions from '../../interface/actions'\nimport { MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL } from '../../constants'\n\n// Auth Plugin\nimport { getConnectionInfo } from '../../../auth/interface/selectors'\nimport { SUB_RESUB } from '../../interface/eventTypes'\n\n/**\n * Subscription plugin's resubscription interval factory function.\n * @method createInterval\n * @param {Object} container The bottle container.\n * @return {Object} Available interval for Subscription's resubscription.\n */\nexport default function createInterval(container) {\n  const { context, createInterval, SubscriptionRequests, SubscriptionOperations, emitEvent } = container\n\n  // Interval function for resubscription\n  let resubInterval\n\n  // Number of retry attemps\n  let attemptNum = 1\n\n  /**\n   * Check if the interval is running.\n   * @method isRunning\n   * @return {boolean} The interval is running or not.\n   */\n  function isRunning() {\n    return !!resubInterval\n  }\n\n  /**\n   * Start the interval.\n   * @param { function } update The update function to be called at regular interval of time.\n   * @param { number }   expires The subscription expiry value (in seconds), as provided from SDK configuration.\n   * @method start\n   */\n  function start(update, expires) {\n    // Set the delay to 50% of the interval between now and when the subscription expires for the first attempt,\n    // 25% for the second attempt, etc\n    let resubDelay = (expires * 1000) / Math.pow(2, attemptNum)\n\n    const halfwayInterval = MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL / 2\n    // Don't try to resub more often than every halfwayInterval seconds.\n    resubDelay = resubDelay > halfwayInterval ? resubDelay : halfwayInterval\n\n    // Create a randomized version for 'resubDelay' value (each time we resubscribe) and\n    // use that random value instead.\n    // In this case, if the provided 'resubDelay' value is x,\n    // the final chosen value will be a random value between (0.8 * x) and (1.2 * x)\n    const lowerLimit = resubDelay * 0.8\n    const upperLimit = resubDelay * 1.2\n    // Random between 1 and (upper - lower)\n    const randomVal = Math.floor(Math.random() * (upperLimit - lowerLimit) + 1)\n\n    resubInterval = createInterval(update, lowerLimit + randomVal)\n\n    resubInterval.start()\n  }\n\n  /**\n   * Stop the interval.\n   * @method stop\n   */\n  function stop() {\n    if (resubInterval) {\n      resubInterval.stop()\n      resubInterval = undefined\n    }\n  }\n\n  /**\n   * Start a new interval timer for resubscribing to services.\n   * It extends the lifetime of a subscription, therefore,\n   * it should be called either when SUBSCRIBE_FINISH action (with no error) is triggered\n   * or when the RESUBSCRIPTION_FINISHED action is triggered.\n   * - 'subscribeFinished' action is called from either 'subscribe' or 'updateSubscription' operations,\n   *   therefore those two operations will start this function.\n   * - 'resubscribeFinished' action is called from within this function, therefore its internal update\n   *   function will be called from within.\n   *\n   * @method startResubInterval\n   * @throws {Error} If the interval is already running.\n   */\n  async function startResubInterval() {\n    if (isRunning()) {\n      stop()\n    }\n\n    const conn = getConnectionInfo(context.getState())\n    const subscription = getSubscriptionInfo(context.getState())\n    // Check if we actually have a subscription and if not, just stop interval and return\n    if (!subscription || !subscription[0]) {\n      stop()\n      return\n    }\n\n    // Update our subscription\n    async function update() {\n      try {\n        // calls the request that was registered with the bottle in\n        // \"features/update/request.js\"\n        await SubscriptionRequests.resubscribe(conn, subscription)\n        context.dispatch(actions.resubscribeFinished({ attemptNum }))\n\n        emitEvent(SUB_RESUB, {\n          attemptNum,\n          isFailure: false\n        })\n\n        // Reset attempt number\n        attemptNum = 1\n\n        // Restart interval\n        stop()\n        start(update, subscription[0].expires)\n      } catch (error) {\n        // Magic number: 39 is KL's statusCode for \"resource does not exist\".\n        if (error.code === 39) {\n          // Server subscription is gone, so stop the resub interval then clean-up the subscription.\n          stop()\n          await SubscriptionOperations.onSubscriptionGone()\n          return\n        }\n\n        // It is just a temporary error during re-subscription,\n        // so we'll try again to resubscribe when interval expires.\n        context.dispatch(\n          actions.resubscribeFinished({\n            error,\n            attemptNum\n          })\n        )\n        emitEvent(SUB_RESUB, {\n          attemptNum,\n          isFailure: true\n        })\n\n        // Increment our attempts\n        attemptNum++\n\n        // Stop the interval\n        stop()\n\n        // Start the interval (this will take our attempNum into account when calculating the expiry time)\n        start(update, subscription[0].expires)\n      }\n    }\n\n    // Start the interval as long as we have an existing subscription\n    if (subscription.length > 0) {\n      start(update, subscription[0].expires)\n    }\n  }\n\n  /**\n   * Stop the resubscription interval.\n   * @method stopResubInterval\n   */\n  function stopResubInterval() {\n    if (resubInterval) {\n      resubInterval.stop()\n      resubInterval = undefined\n    }\n  }\n\n  return {\n    startResubInterval,\n    stopResubInterval\n  }\n}\n","const prefix = '@@KANDY/'\n\n/**\n * Contact Actions\n *\n * Action types associated with the operations of methods on the contacts namespace\n */\nexport const ADD_CONTACT = prefix + 'ADD_CONTACT'\nexport const ADD_CONTACT_FINISH = prefix + 'ADD_CONTACT_FINISH'\n\nexport const REFRESH_CONTACTS = prefix + 'REFRESH_CONTACTS'\nexport const REFRESH_CONTACTS_FINISH = prefix + 'REFRESH_CONTACTS_FINISH'\n\nexport const REMOVE_CONTACT = prefix + 'REMOVE_CONTACT'\nexport const REMOVE_CONTACT_FINISH = prefix + 'REMOVE_CONTACT_FINISH'\n\nexport const UPDATE_CONTACT = prefix + 'UPDATE_CONTACT'\nexport const UPDATE_CONTACT_FINISH = prefix + 'UPDATE_CONTACT_FINISH'\n\nexport const FETCH_CONTACT = prefix + 'FETCH_CONTACT'\nexport const FETCH_CONTACT_FINISH = prefix + 'FETCH_CONTACT_FINISH'\n\n/**\n * User Actions\n *\n * Action types associated with the operations of methods on the users namespace\n */\nexport const FETCH_USER = prefix + 'FETCH_USER'\nexport const FETCH_USER_FINISH = prefix + 'FETCH_USER_FINISH'\n\nexport const SEARCH_DIRECTORY = prefix + 'SEARCH_DIRECTORY'\nexport const SEARCH_DIRECTORY_FINISH = prefix + 'SEARCH_DIRECTORY_FINISH'\n","import * as actionTypes from './actionTypes'\n\n/**\n * Refresh the contact list.\n * @returns {Object} A flux standard action representing the REFRESH_CONTACTS action.\n */\nexport function refreshContacts() {\n  return {\n    type: actionTypes.REFRESH_CONTACTS,\n    payload: null\n  }\n}\n\n/**\n * The finishing action which follows the REFRESH_CONTACTS action\n * @param {Object} $0\n * @param  {Array} [$0.contacts] An array of contact objects.\n * @param  {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the REFRESH_CONTACTS_FINISH action.\n */\nexport function refreshContactsFinish({ contacts, error }) {\n  return {\n    type: actionTypes.REFRESH_CONTACTS_FINISH,\n    payload: error || contacts,\n    error: Boolean(error)\n  }\n}\n\n/**\n * Adds a contact to the Address Book\n * @param {Object} contact The contact object.\n * @returns {Object} A flux standard action representing the ADD_CONTACT action.\n */\nexport function addContact(contact) {\n  return {\n    type: actionTypes.ADD_CONTACT,\n    payload: contact\n  }\n}\n\n/**\n * The finishing action which follows the ADD_CONTACT action\n * @param {Object} $0\n * @param {Object} [$0.contact] The contact object.\n * @param {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the ADD_CONTACT_FINISH action.\n */\nexport function addContactFinish({ contact, error }) {\n  return {\n    payload: error || contact,\n    error: Boolean(error),\n    type: actionTypes.ADD_CONTACT_FINISH\n  }\n}\n\n/**\n * Fetch a contact from the user's personal address book\n * @param {string} contactId The ID of the contact to be fetched\n * @returns {Object} A flux standard action representing the FETCH_CONTACT action.\n */\nexport function fetchContact(contactId) {\n  return {\n    type: actionTypes.FETCH_CONTACT,\n    payload: contactId\n  }\n}\n\n/**\n * The finishing action which follows a FETCH_CONTACT action\n * @param {Object} $0\n * @param {Object} [$0.contact] The contact object.\n * @param {Object} [$0.error] A Basic error object\n * @returns {Object} A flux standard action representing the FETCH_CONTACT_FINISH action.\n */\nexport function fetchContactFinish({ contact, error }) {\n  return {\n    type: actionTypes.FETCH_CONTACT_FINISH,\n    payload: error || contact,\n    error: Boolean(error)\n  }\n}\n\n/**\n * Removes a contact from the Address Book\n * @param {string} contactId The id of the contact whom it has been requested to delete from the address book\n * @returns {Object} A flux standard action representing the REMOVE_CONTACT action.\n */\nexport function removeContact(contactId) {\n  return {\n    type: actionTypes.REMOVE_CONTACT,\n    payload: contactId\n  }\n}\n\n/**\n * The finishing action which follows a REMOVE_CONTACT action\n * @param {Object} $0\n * @param {string} [$0.contactId] The id of the contact whom it has been requested to delete from the address book\n * @param {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the REMOVE_CONTACT_FINISH action.\n */\nexport function removeContactFinish({ contactId, error }) {\n  return {\n    type: actionTypes.REMOVE_CONTACT_FINISH,\n    payload: contactId || error,\n    error: !!error\n  }\n}\n\n/**\n * Updates the data for a contact in the Address Book\n * @param {Object} contact The contact object. The contact object must include the ID of the contact being targeted for an update action.\n * @returns {Object} A flux standard action representing the UPDATE_CONTACT action.\n */\nexport function updateContact(contact) {\n  return {\n    type: actionTypes.UPDATE_CONTACT,\n    payload: contact\n  }\n}\n\n/**\n * The finishing action which follows a UPDATE_CONTACT action\n * @param {Object} $0\n * @param {Object} [$0.contact] The contact object.\n * @param {Object} [$0.error] A Basic error object\n * @returns {Object} A flux standard action representing the UPDATE_CONTACT_FINISH action.\n */\nexport function updateContactFinish({ contact, error }) {\n  return {\n    type: actionTypes.UPDATE_CONTACT_FINISH,\n    payload: error || contact,\n    error: !!error\n  }\n}\n","import * as actionTypes from './actionTypes'\n\n/**\n *\n * @param {string} userId The URI uniquely identifying the user.\n * @returns {Object} A flux standard action representing the FETCH_USER action\n */\nexport function fetchUser(userId) {\n  return {\n    type: actionTypes.FETCH_USER,\n    payload: userId\n  }\n}\n\n/**\n * Create a finish action to follow a FETCH_USER action.\n *\n * @param {Object} user A user object\n * @param {Object} [error] An error object.\n * @returns {Object} A flux standard action representing the USER_FETCH_FINISH action.\n */\nexport function fetchUserFinish(user, error) {\n  return {\n    type: actionTypes.FETCH_USER_FINISH,\n    payload: error || user,\n    error: Boolean(error)\n  }\n}\n\n/**\n * Create an action that searches the directory.\n *\n * @param {Object} filters Query filter options.\n * @param {string} [filters.name] Matches firstName or lastName.\n * @param {string} [filters.firstName] Matches firstName.\n * @param {string} [filters.lastName] Matches lastName.\n * @param {string} [filters.userName] Matches userName.\n * @param {string} [filters.phoneNumber] Matches phoneNumber.\n * @param {Object} [options] Sorting options\n * @param {string} [options.sortBy] The attribute upon which to sort results. This can be any of the above listed filters which describe a user attribute.\n * @param {string} [options.order] Order by which to return results. Can be one of \"asc\" or \"desc\".\n * @param {number} [options.max] The maximum number of results to return.\n * @param {string} [options.next] The pointer for a chunk of results, which may be returned from other a previous query.\n * @returns {Object} A flux standard action representing the SEARCH_DIRECTORY action.\n */\nexport function searchDirectory(filters, options) {\n  return {\n    type: actionTypes.SEARCH_DIRECTORY,\n    payload: { filters, options }\n  }\n}\n\n/**\n * Create a finish action to follow the SEARCH_DIRECTORY action.\n *\n * @param {Object} $0 A dictionary object of parameters\n * @param {Array} [$0.users] The user objects\n * @param {Object} [$0.error] An error object.\n * @returns {Object} A flux standard action representing the DIRECTORY_CHANGED action.\n */\nexport function searchDirectoryFinish({ users, error }) {\n  return {\n    type: actionTypes.SEARCH_DIRECTORY_FINISH,\n    payload: error || users,\n    error: Boolean(error)\n  }\n}\n","// Users plugin.\nimport { getContact, getContacts } from '../selectors'\nimport * as eventTypes from '../../interface/events/eventTypes'\n\nexport default function contactsAPI(container) {\n  /**\n   * The 'contacts' namespace allows users to store personal contacts to their account.\n   *\n   * @public\n   * @namespace contacts\n   */\n\n  const { context, emitEvent, UsersOperations: operations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('USERS')\n\n  return {\n    /**\n     * Add a contact to a user's personal address book.\n     * Will trigger the `contacts:new` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method add\n     * @requires addContactAsFriend\n     * @param {Object} contact The contact object.\n     * @param {string} contact.primaryContact The primary userId for the contact\n     * @param {string} contact.contactId The contact's unique contact ID\n     * @param {string} [contact.firstName] The contact's first name\n     * @param {string} [contact.lastName] The contact's last name\n     * @param {string} [contact.photoUrl] The URL address identifying location of user's picture\n     * @param {string} [contact.emailAddress] The contact's email address\n     * @param {string} [contact.homePhone] The contact's home phone number\n     * @param {string} [contact.workPhone] The contact's business phone number\n     * @param {string} [contact.mobilePhone] The contact's mobile phone number\n     * @param {string} [contact.conferenceURL] Conference URL and access code for this user's address book entry\n     * @param {string} [contact.fax] The user's fax number\n     * @param {string} [contact.pager] The user's pager number\n     * @param {string} [contact.groupList] The name of the contact list for which to add this contact to (\"friends\" by default)\n     * @param {boolean} [contact.friendStatus] Indicates whether or not the contact is a friend of the user\n     */\n    async add(contact) {\n      log.debug(API_LOG_TAG + 'contacts.add: ', contact)\n      let contactData\n      try {\n        contactData = await operations.addContact(contact)\n      } catch (error) {\n        emitEvent(eventTypes.CONTACTS_ERROR, { error })\n        return\n      }\n\n      // addContact succeeded\n      emitEvent(eventTypes.CONTACTS_CHANGE, { contactData })\n      emitEvent(eventTypes.CONTACTS_CHANGE, {})\n    },\n\n    /**\n     * Retrieves local information about a contact.\n     *\n     * @public\n     * @memberof contacts\n     * @method get\n     * @param {string} contactId The unique contact ID of the contact.\n     * @return {Object} Contact information.\n     */\n    get(contactId) {\n      log.debug(API_LOG_TAG + 'contacts.get: ', contactId)\n      return getContact(context.getState(), contactId)\n    },\n\n    /**\n     * Retrieves local information about all contacts.\n     *\n     * @public\n     * @memberof contacts\n     * @method getAll\n     * @return {Array} List of contact information.\n     */\n    getAll() {\n      log.debug(API_LOG_TAG + 'contacts.getAll')\n      return getContacts(context.getState())\n    },\n\n    /**\n     * Refreshes the local information about contacts. This will get new contacts from the platform.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method refresh\n     */\n    refresh() {\n      log.debug(API_LOG_TAG + 'contacts.refresh')\n      let contactData\n      try {\n        contactData = operations.refreshContacts()\n      } catch (error) {\n        emitEvent(eventTypes.CONTACTS_ERROR, { error })\n        return\n      }\n\n      // refreshContacts succeeded\n      emitEvent(eventTypes.CONTACTS_CHANGE, { contactData })\n    },\n\n    /**\n     * Remove a contact from a personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method remove\n     * @param  {string} id The Id of the contact that will be removed.\n     */\n    async remove(id) {\n      log.debug(API_LOG_TAG + 'contacts.remove: ', id)\n      let contactId\n      try {\n        contactId = await operations.removeContact(id)\n      } catch (error) {\n        emitEvent(eventTypes.CONTACTS_ERROR, { error })\n        return\n      }\n\n      // removeContact succeeded\n      emitEvent(eventTypes.CONTACTS_CHANGE, { contactId })\n    },\n\n    /**\n     * Update a contact from the user's personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method update\n     * @requires addContactAsFriend\n     * @param {Object} contact The contact object.\n     * @param {string} contact.primaryContact The primary userId for the contact\n     * @param {string} contact.contactId The contact's unique contact ID\n     * @param {string} [contact.firstName] The contact's first name\n     * @param {string} [contact.lastName] The contact's last name\n     * @param {string} [contact.photoUrl] The URL address identifying location of user's picture\n     * @param {string} [contact.emailAddress] The contact's email address\n     * @param {string} [contact.homePhone] The contact's home phone number\n     * @param {string} [contact.workPhone] The contact's business phone number\n     * @param {string} [contact.mobilePhone] The contact's mobile phone number\n     * @param {string} [contact.conferenceURL] Conference URL and access code for this user's address book entry\n     * @param {string} [contact.fax] The user's fax number\n     * @param {string} [contact.pager] The user's pager number\n     * @param {string} [contact.groupList] The name of the contact list for which to add this contact to (\"friends\" by default)\n     * @param {boolean} [contact.friendStatus] Indicates whether or not the contact is a friend of the user\n     */\n    async update(contact) {\n      log.debug(API_LOG_TAG + 'contacts.update: ', contact)\n      let contactData\n      try {\n        contactData = await operations.updateContact(contact)\n      } catch (error) {\n        emitEvent(eventTypes.CONTACTS_ERROR, { error })\n        return\n      }\n      // updateContact succeeded\n      emitEvent(eventTypes.CONTACTS_CHANGE, { contactData })\n    },\n\n    /**\n     * Fetch a contact from the user's personal address book.\n     * Will trigger the `contacts:change` event.\n     *\n     * @public\n     * @memberof contacts\n     * @method fetch\n     * @param  {string} id The unique contact ID of the contact.\n     */\n    async fetch(id) {\n      log.debug(API_LOG_TAG + 'contacts.fetch: ', id)\n      let contact\n      try {\n        contact = await operations.fetchContact(id)\n      } catch (error) {\n        emitEvent(eventTypes.CONTACTS_ERROR, { error })\n        return\n      }\n      // fetchContact succeeded\n      emitEvent(eventTypes.CONTACTS_CHANGE, { contact })\n    }\n  }\n}\n","import usersApi from './users'\nimport contactsApi from './contacts'\n\n/**\n * Users API factory function.\n * Defines the interface between the application and the SDK's Users APIs.\n * Users APIs are organized by their namespacing since it comprises of both `users` and `contacts`.\n * @method createAPI\n * @param {Object} container The bottle container.\n * @returns {Object} Available public APIs for Users.\n */\nexport default function createAPI(container) {\n  return {\n    contacts: contactsApi(container),\n    user: usersApi(container)\n  }\n}\n","// Users plugin.\nimport { getUser, getUsers } from '../selectors'\nimport { USERS_ERROR, USERS_CHANGE, DIRECTORY_CHANGE, DIRECTORY_ERROR } from '../events/eventTypes'\n\nexport default function usersApi(container) {\n  const { context, emitEvent, UsersOperations: operations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('USERS')\n\n  /**\n   * The 'user' namespace allows access to user information for users within the same domain.\n   *\n   * @public\n   * @namespace user\n   */\n\n  /**\n   * The User data object.\n   *\n   * @public\n   * @static\n   * @typedef {Object} User\n   * @memberof user\n   * @property {user.UserID} userId The User ID of the user.\n   * @property {string} emailAddress The email address of the user.\n   * @property {string} firstName The first name of the user.\n   * @property {string} lastName The last name of the user.\n   * @property {string} photoURL The URL to get the photo of the user.\n   * @property {string} buddy Whether the user is a \"buddy\". Values can be \"true\" or \"false\".\n   */\n\n  return {\n    /**\n     * Fetches information about a User.\n     *\n     * The SDK will emit a {@link user.event:users:change users:change}\n     *    event after the operation completes. The User's information will then\n     *    be available.\n     *\n     * Information about an available User can be retrieved using the\n     *    {@link user.get} API.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method fetch\n     * @param {string} userId The User ID of the user.\n     */\n    async fetch(userId) {\n      log.debug(API_LOG_TAG + 'user.fetch: ', userId)\n      let usersData\n      try {\n        usersData = await operations.fetchUser(userId)\n\n        if (usersData) {\n          emitEvent(USERS_CHANGE, { results: [usersData] })\n        }\n      } catch (error) {\n        emitEvent(USERS_ERROR, { error })\n      }\n    },\n\n    /**\n     * Retrieves information about a User, if available.\n     *\n     * See the {@link user.fetch} and {@link user.search} APIs for details about\n     *    making Users' information available.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method get\n     * @param {user.UserID} userId The User ID of the user.\n     * @returns {user.User} The User object for the specified user.\n     */\n    get(userId) {\n      log.debug(API_LOG_TAG + 'user.get: ', userId)\n      return getUser(context.getState(), userId)\n    },\n\n    /**\n     * Retrieves information about all available Users.\n     *\n     * See the {@link user.fetch} and {@link user.search} APIs for details about\n     *    making Users' information available.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method getAll\n     * @returns {Array<user.User>} An array of all the User objects.\n     */\n    getAll() {\n      log.debug(API_LOG_TAG + 'user.getAll')\n      return getUsers(context.getState())\n    },\n\n    /**\n     * Searches the domain's directory for Users.\n     *\n     * Directory searching only supports one filter. If multiple filters are provided, only one of the filters will be used for the search.\n     * A search with no filters provided will return all users.\n     *\n     * The SDK will emit a {@link user.event:directory:change directory:change}\n     *    event after the operation completes. The search results will be\n     *    provided as part of the event, and will also be available using the\n     *    {@link user.get} and {@link user.getAll} APIs.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method search\n     * @requires limitedSearch\n     * @param {Object} filters The filter options for the search.\n     * @param {user.UserID} [filters.userId] Matches the User ID of the user.\n     * @param {string} [filters.name] Matches the firstName or lastName.\n     * @param {string} [filters.firstName] Matches the firstName.\n     * @param {string} [filters.lastName] Matches the lastName.\n     * @param {string} [filters.userName] Matches the userName.\n     * @param {string} [filters.phoneNumber] Matches the phoneNumber.\n     */\n\n    /**\n     * Searches the domain's directory for Users.\n     *\n     * The SDK will emit a {@link user.event:directory:change directory:change}\n     *    event after the operation completes. The search results will be\n     *    provided as part of the event, and will also be available using the\n     *    {@link user.get} and {@link user.getAll} APIs.\n     *\n     * @public\n     * @static\n     * @memberof user\n     * @method search\n     * @requires advancedSearch\n     * @param {Object} filters The filter options for the search.\n     * @param {user.UserID} [filters.userId] Matches the User ID of the user.\n     * @param {string} [filters.name] Matches the firstName or lastName.\n     * @param {string} [filters.firstName] Matches the firstName.\n     * @param {string} [filters.lastName] Matches the lastName.\n     * @param {string} [filters.userName] Matches the userName.\n     * @param {string} [filters.phoneNumber] Matches the phoneNumber.\n     * @param {Object} [options] Sorting options.\n     * @param {string} [options.sortBy] The User property to sort the results by. This can be any of the above listed filters.\n     * @param {string} [options.order] Order in which results are returned. Can be either \"asc\" or \"desc\".\n     * @param {number} [options.max] The maximum number of results to return.\n     * @param {string} [options.next] The pointer for a chunk of results, which may be returned from a previous query.\n     */\n    async search(filters = {}, options = {}) {\n      log.debug(API_LOG_TAG + 'user.search: ', filters, options)\n      let searchData\n      try {\n        searchData = await operations.searchDirectory(filters, options)\n      } catch (error) {\n        emitEvent(DIRECTORY_ERROR, { error })\n        return\n      }\n      // searchDirectory succeeded\n      emitEvent(DIRECTORY_CHANGE, { results: searchData })\n    }\n  }\n}\n","// Contacts actions\n/**\n * A new contact has been added to the address book.\n * @public\n * @memberof contacts\n * @event contacts:new\n * @param {Object} contact The new contact.\n */\nexport const CONTACTS_NEW = 'contacts:new'\n\n/**\n * An error occurred while performing a contact operation.\n * @public\n * @memberof contacts\n * @event contacts:error\n * @param {Object} params\n * @param {Object} params.error The Basic error object.\n */\nexport const CONTACTS_ERROR = 'contacts:error'\n\n/**\n * The contacts list has changed.\n * @public\n * @memberof contacts\n * @event contacts:change\n * @example\n * client.on('contacts:change', function () {\n *    // Get the updated list of contacts.\n *    const contacts = client.contacts.getAll()\n *    ...\n * })\n */\nexport const CONTACTS_CHANGE = 'contacts:change'\n\n// Users actions\n/**\n * The directory has changed.\n * @public\n * @static\n * @memberof user\n * @event directory:change\n * @param {Object} params\n * @param {Array<user.User>} params.results The Users' information returned by the\n *    operation.\n */\nexport const DIRECTORY_CHANGE = 'directory:change'\n\n/**\n * An error occurred while performing a directory operation.\n * @public\n * @memberof user\n * @event directory:error\n * @param {Object} params\n * @param {Object} params.error The Basic error object.\n */\nexport const DIRECTORY_ERROR = 'directory:error'\n\n/**\n * A change has occurred in the users list\n * @public\n * @static\n * @memberof user\n * @event users:change\n * @param {Object} params\n * @param {Array<user.User>} params.results The Users' information returned by the\n *    operation.\n */\nexport const USERS_CHANGE = 'users:change'\n\n/**\n * An error occurred while retrieving the user information\n * @public\n * @static\n * @memberof user\n * @event users:error\n * @param {Object} params\n * @param {Object} params.error params.error The Basic error object.\n */\nexport const USERS_ERROR = 'users:error'\n","// Import the components of the interface.\nimport createAPI from './api/index'\nimport reducer from './reducers'\n\n/**\n * This interface is for a users plugin.\n * @type {string}\n */\nconst name = 'users'\n\n// Export the interface as a single object.\nexport { name, createAPI, reducer }\n","import * as actionTypes from '../actions/actionTypes'\nimport { unset } from 'lodash/fp'\n\nconst reducers = {}\n\nconst contactsPendingReducer = {\n  next(state) {\n    return {\n      ...state,\n      isPending: true\n    }\n  }\n}\n\nreducers[actionTypes.ADD_CONTACT] = contactsPendingReducer\nreducers[actionTypes.REFRESH_CONTACTS] = contactsPendingReducer\nreducers[actionTypes.FETCH_CONTACT] = contactsPendingReducer\nreducers[actionTypes.UPDATE_CONTACT] = contactsPendingReducer\n\nreducers[actionTypes.ADD_CONTACT_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      contacts: {\n        ...state.contacts,\n        [action.payload.contactId]: action.payload\n      },\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.REFRESH_CONTACTS_FINISH] = {\n  next(state, action) {\n    const contacts = {}\n    for (const contact of action.payload) {\n      contacts[contact.contactId] = contact\n    }\n    return {\n      ...state,\n      contacts: contacts,\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.FETCH_CONTACT_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      contacts: {\n        ...state.contacts,\n        [action.payload.contactId]: action.payload\n      },\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.REMOVE_CONTACT_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      contacts: unset(action.payload, state.contacts), // Remove the property from state.contacts whose key is equal to action.payload\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.UPDATE_CONTACT_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      contacts: {\n        ...state.contacts,\n        [action.payload.contactId]: action.payload\n      },\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nexport default reducers\n","import contactsReducers from './contacts'\nimport usersReducers from './users'\nimport { handleActions } from 'redux-actions'\n\n/*\n * Combine all of reducers into a single reducer, defaulting to an empty Object for each\n * substate of contacts and users\n */\nconst reducer = handleActions(\n  { ...contactsReducers, ...usersReducers },\n  {\n    errors: [],\n    contacts: {},\n    users: {},\n    isPending: true\n  }\n)\nexport default reducer\n","import * as actionTypes from '../actions/actionTypes'\n\nconst reducers = {}\n\nreducers[actionTypes.FETCH_USER_FINISH] = {\n  next(state, action) {\n    const user = action.payload\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        [user.primaryContact]: user\n      },\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nreducers[actionTypes.SEARCH_DIRECTORY_FINISH] = {\n  next(state, action) {\n    const users = {}\n    for (const user of action.payload) {\n      users[user.primaryContact] = user\n    }\n    return {\n      ...state,\n      users: {\n        ...state.users,\n        ...users\n      },\n      isPending: false\n    }\n  },\n  throw(state, action) {\n    return {\n      ...state,\n      isPending: false,\n      errors: state.errors.concat(action.payload)\n    }\n  }\n}\n\nexport default reducers\n","import { cloneDeep } from 'lodash/fp'\n\n/*\n * Redux state selector functions.\n */\n\n/**\n * Gets the contacts from state.\n * @method getContacts\n * @return {Object}\n */\nexport function getContacts(state) {\n  return cloneDeep(state.users.contacts)\n}\n\n/**\n * Gets a contact from the state whose ID matches the supplied parameter\n * @method getContact\n * @return {Object}\n */\nexport function getContact(state, id) {\n  return cloneDeep(state.users.contacts[id])\n}\n\n/**\n * Gets the users from state.\n * @method getUsers\n * @return {Array<User>} An array of all the User objects.\n */\nexport function getUsers(state) {\n  const allUsers = cloneDeep(state.users.users)\n  return Object.values(allUsers)\n}\n\n/**\n * Gets the users from state.\n * @method getUser\n * @return {Object}\n */\nexport function getUser(state, name) {\n  return cloneDeep(state.users.users[name])\n}\n","import { name, reducer, createAPI } from '../interface'\nimport createOperations from './operations'\nimport createRequests from './requests'\n\n/**\n * Users service plugin factory.\n * Provides the SDK with the 'Users' feature.\n * @method usersFactory\n */\nexport default function usersFactory(bottle) {\n  // Register the component factory functions to the bottle.\n  bottle.factory('UsersAPI', createAPI)\n  bottle.factory('UsersOperations', createOperations)\n  bottle.factory('UsersRequests', createRequests)\n\n  return {\n    capabilities: ['addContactAsFriend', 'limitedSearch'],\n    name,\n    reducer\n  }\n}\n","// Users' Actions\nimport * as actions from '../interface/actions/users'\nimport * as contactsActions from '../interface/actions/contacts'\nimport { getConnectionInfo } from '../../auth/interface/selectors'\nimport BasicError, { usersCodes } from '../../../src/errors'\n\nimport { isEmpty } from 'lodash/fp'\n\n/**\n * Users Operations factory function for Link.\n * @method createOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for Users plugin.\n */\nexport default function createOperations(container) {\n  const { context, logManager, UsersRequests: requests } = container\n  const log = logManager.getLogger('USERS')\n\n  // see SPiDR 4.3 REST API Documentation - 12.11.3\n  function searchTypeInteger(searchType) {\n    switch (searchType) {\n      case 'first_name':\n      case 'firstName':\n      case 'FIRSTNAME':\n        return 1\n      case 'last_name':\n      case 'lastName':\n      case 'LASTNAME':\n        return 2\n      case 'name':\n      case 'NAME':\n        return 3\n      case 'phone_number':\n      case 'phoneNumber':\n      case 'PHONENUMBER':\n        return 4\n      case 'user_id':\n      case 'userId':\n      case 'USERID':\n      case 'user_name':\n      case 'userName':\n      case 'USERNAME':\n        return 5\n    }\n  }\n\n  /**\n   * remoteContactFromLocal\n   *\n   * At the time of development, `nickName` is the property by which contact resources are keyed in the back end.\n   * Since the manner in which a `nickName` is used and regarded in common practice suggests that it can be changed,\n   * we are exposing it as a property named `contactId` and informing developers that this is a unique property.\n   * This function is used to normalize the naming convention when preparing contact data to be sent for a REST request.\n   *\n   * @param {Object} contact A contact object\n   */\n  function remoteContactFromLocal(contact) {\n    if ('contactId' in contact) {\n      contact.nickname = contact.contactId\n      delete contact.contactId\n    }\n    // We must remove all empty values, as the back end servicing Link does not permit them\n    for (const prop in contact) {\n      if (!contact[prop] || contact[prop].length === 0) {\n        delete contact[prop]\n      }\n    }\n    return contact\n  }\n\n  /**\n   * localContactFromRemote\n   *\n   * Convert a contact object from the back end format used in REST calls, to the format maintained in the state\n   *\n   * @param {Object} contact A contact object\n   */\n  function localContactFromRemote(contact) {\n    if ('nickname' in contact) {\n      contact.contactId = contact.nickname\n      delete contact.nickname\n    }\n    return contact\n  }\n\n  /**\n   * Operation to fetch information about a user.\n   * @method fetchUser\n   * @param {string} userId The User ID of the user.\n   * @returns {Object} The user data associated with userId.\n   * @throws {Error} An error if request fails.\n   */\n  async function fetchUser(userId) {\n    const { dispatch } = context\n\n    // Dispatch a fetch action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.fetchUser(userId))\n\n    const body = {\n      searchCriteria: userId,\n      searchType: searchTypeInteger('user_id')\n    }\n\n    try {\n      const connection = getConnectionInfo(context.getState())\n      const directory = await requests.getDirectory(connection, body)\n      if (directory.length > 0) {\n        // Update state by dispatching an action\n        dispatch(actions.fetchUserFinish(directory[0]))\n        return directory[0]\n      } else {\n        log.debug('Fetch user request was successful, but result was empty')\n      }\n    } catch (error) {\n      // Dispatch an error action for backwards-compatible of action logs.\n      //     This does not affect state or emit an event.\n      dispatch(actions.fetchUserFinish(error))\n\n      throw error\n    }\n  }\n\n  /**\n   * Operation to update a contact in the address book.\n   * @method updateContact\n   * @param {Object} contact The contact that needs to be updated.\n   * @returns {Object} The updated contact.\n   * @throws {Error} An error if this operation fails.\n   */\n  async function updateContact(contact) {\n    const { dispatch } = context\n\n    // Dispatch updateContact action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(contactsActions.updateContact(contact))\n\n    if (!contact || isEmpty(contact)) {\n      log.info('Could not update contact; invalid input.')\n\n      // TODO: check and throw the proper error code.\n      const validationError = new BasicError({\n        code: usersCodes.INVALID_PARAM,\n        message: 'Could not update contact(s); invalid input.'\n      })\n\n      // Dispatch the failure action. This is for logging backwards compatibility.\n      dispatch(contactsActions.updateContactFinish({ error: validationError }))\n\n      // Throw the error, so it makes it back to the API.\n      throw validationError\n    }\n\n    try {\n      const contactRestObject = remoteContactFromLocal({ ...contact })\n      const contactData = {\n        addressBookRequest: {\n          addressBookEntries: [contactRestObject]\n        }\n      }\n      const result = await requests.contactRequest({\n        extraURL: 'contacts/' + contact.contactId,\n        body: JSON.stringify(contactData),\n        method: 'PUT'\n      })\n\n      if (result) {\n        // Dispatch updateContactFinish action for backwards-compatible of action logs.\n        //     This does not affect state or emit an event.\n        dispatch(contactsActions.updateContactFinish({ contact }))\n\n        return contact\n      }\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(contactsActions.updateContactFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  /**\n   * Operation to add a contact to the address book.\n   * @method addContact\n   * @param {Object} contact the contact to be added.\n   * @returns {Object} The added contact.\n   * @throws {Error} An error if request fails.\n   */\n  async function addContact(contact) {\n    const { dispatch } = context\n\n    // Dispatch addContact action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(contactsActions.addContact(contact))\n\n    log.info('Attempting to add contact(s):', contact)\n\n    if (!contact || isEmpty(contact)) {\n      log.info('Could not add contact(s); invalid input.')\n\n      // TODO: check and throw the proper error code.\n      const validationError = new BasicError({\n        code: usersCodes.INVALID_PARAM,\n        message: 'Could not add contact(s); invalid input.'\n      })\n\n      // Dispatch the failure action. This is for logging backwards compatibility.\n      dispatch(contactsActions.addContactFinish({ error: validationError }))\n\n      // Throw the error, so it makes it back to the API.\n      throw validationError\n    }\n\n    try {\n      const contactData = {\n        addressBookRequest: { addressBookEntries: [remoteContactFromLocal({ ...contact })] }\n      }\n\n      const result = await requests.contactRequest({\n        extraURL: 'contacts/',\n        body: JSON.stringify(contactData),\n        method: 'POST'\n      })\n\n      let localContact = {}\n\n      if (result) {\n        localContact = localContactFromRemote(result)\n\n        // Dispatch addContactFinish action for backwards-compatible of action logs.\n        //     This does not affect state or emit an event.\n        dispatch(contactsActions.addContactFinish({ contact: localContact }))\n      }\n      return localContact\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(contactsActions.addContactFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  /**\n   * Operation to refresh the state's contacts by fetching the latest contacts from the user's address book.\n   * @method refreshContacts\n   * @returns {Object} The latest local contacts from the user's address book.\n   * @throws {Error} An error if request fails.\n   */\n  async function refreshContacts() {\n    const { dispatch } = context\n\n    try {\n      // Dispatch refreshContacts action for backwards-compatible of action logs.\n      //     This does not affect state or emit an event.\n      dispatch(contactsActions.refreshContacts())\n\n      const res = await requests.contactRequest({ method: 'GET' })\n      let contacts = []\n\n      if (res) {\n        contacts = res.result.addressBookEntries ? res.result.addressBookEntries.map(localContactFromRemote) : []\n\n        // Dispatch refreshContactsFinish action for backwards-compatible of action logs.\n        //     This does not affect state or emit an event.\n        dispatch(contactsActions.refreshContactsFinish({ contacts }))\n      }\n      return contacts\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(contactsActions.refreshContactsFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  /**\n   * Operation to remove contact with specified id.\n   * @method removeContact\n   * @param {string} id The ID of the contact to be removed.\n   * @returns {Object} The ID associated with removed contact.\n   * @throws {Error} An error if request fails.\n   */\n  async function removeContact(id) {\n    const { dispatch } = context\n\n    // Dispatch removeContact action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(contactsActions.removeContact(id))\n\n    log.info('Attempting to remove the contact: ', id)\n\n    if (!id) {\n      log.info('Could not remove contact; invalid id.')\n\n      // TODO: check and throw the proper error code.\n      const validationError = new BasicError({\n        code: usersCodes.INVALID_PARAM,\n        message: 'Could not remove contact; invalid id.'\n      })\n\n      // Dispatch the failure action. This is for logging backwards compatibility.\n      dispatch(contactsActions.removeContactFinish({ error: validationError }))\n\n      // Throw the error, so it makes it back to the API.\n      throw validationError\n    }\n\n    try {\n      const result = await requests.contactRequest({\n        extraURL: 'contacts/' + encodeURIComponent(id),\n        method: 'DELETE'\n      })\n\n      let contactId = ''\n\n      if (result) {\n        // Dispatch removeContactFinish action for backwards-compatible of action logs.\n        //     This does not affect state or emit an event.\n        dispatch(contactsActions.removeContactFinish({ contactId: id }))\n        contactId = id\n      }\n      return contactId\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(contactsActions.removeContactFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  /**\n   * Operation to fetch a contact from the user's Personal Address Book.\n   * @method fetchContact\n   * @param {string} id The ID of the contact to be retrieved.\n   * @returns {Object} The contact associated with the provided ID.\n   * @throws {Error} An error if request fails.\n   */\n  async function fetchContact(id) {\n    const { dispatch } = context\n\n    // Dispatch fetchContact action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(contactsActions.fetchContact(id))\n\n    log.info('Attempting to fetch the contact: ', id)\n\n    if (!id) {\n      log.info('Could not fetch contact; invalid id.')\n\n      // TODO: check and throw the proper error code.\n      const validationError = new BasicError({\n        code: usersCodes.INVALID_PARAM,\n        message: 'Could not fetch contact; invalid id.'\n      })\n\n      // Dispatch the failure action. This is for logging backwards compatibility.\n      dispatch(contactsActions.fetchContactFinish({ error: validationError }))\n\n      // Throw the error, so it makes it back to the API.\n      throw validationError\n    }\n\n    try {\n      const result = await requests.contactRequest({\n        extraURL: `contacts/${id}`,\n        method: 'GET'\n      })\n\n      if (result) {\n        const contact = localContactFromRemote(result.result.addressBookEntries[0])\n\n        // Dispatch fetchContactFinish action for backwards-compatible of action logs.\n        //     This does not affect state or emit an event.\n        dispatch(contactsActions.fetchContactFinish({ contact }))\n\n        return contact\n      }\n    } catch (error) {\n      // Dispatch the failure action. This is for action logs backwards compatibility.\n      dispatch(contactsActions.fetchContactFinish({ error }))\n\n      // Rethrow the error so it makes it back to the API.\n      throw error\n    }\n  }\n\n  /**\n   * Triggers a directory search using certain search criteria.\n   *\n   * @param {Object} filters The filters used for narrowing down the results\n   * @param {Object} options The formatting parameters specifying how the result should be returned (e.g. sorted in ascending order, etc)\n   * @returns {Object} A map of users that match the criteria specified by `filters`.\n   * @throws {Error} An error if request fails.\n   */\n  async function searchDirectory(filters, options) {\n    const { dispatch } = context\n\n    // Dispatch a search action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(actions.searchDirectory(filters, options))\n\n    let type\n    // Look for first defined filter provided\n    for (const filter in filters) {\n      if (filters.hasOwnProperty(filter) && filters[filter]) {\n        type = filter\n        break\n      }\n    }\n    log.debug(`Using criteria '${type}' with value '${filters[type]}' to search directory.`)\n\n    const body = {\n      searchCriteria: filters[type],\n      searchType: searchTypeInteger(type)\n    }\n\n    try {\n      const connection = getConnectionInfo(context.getState())\n      const users = await requests.getDirectory(connection, body)\n\n      const usersData = users.map(localUserFromRemote)\n      dispatch(actions.searchDirectoryFinish({ users: usersData }))\n\n      return usersData\n    } catch (error) {\n      // Dispatch an error action for backwards-compatible of action logs.\n      //     This does not affect state or emit an event.\n      dispatch(actions.searchDirectoryFinish({ error }))\n\n      throw error\n    }\n  }\n\n  /**\n   * localUserFromRemote\n   *\n   * Converts a user object from the back end format used in REST calls, to the format maintained in the state.\n   * In particular, it ensures that the user object has a `userId` property,\n   * as this is the property by which users are keyed in our state.\n   *\n   * @param {Object} user A user object\n   * @returns {Object} The user object\n   */\n  function localUserFromRemote(user) {\n    return {\n      ...user,\n      userId: user.primaryContact || user.userId\n    }\n  }\n\n  return {\n    // API operations:\n    fetchUser,\n    addContact,\n    removeContact,\n    updateContact,\n    fetchContact,\n    searchDirectory,\n    refreshContacts\n  }\n}\n","// Other plugins.\nimport { getRequestInfo } from '../../auth/interface/selectors'\nimport { isEmpty } from 'lodash/fp'\n\nimport BasicError, { usersCodes } from '../../errors'\n\n/**\n * Users Link REST Requests factory function.\n * Defines the REST interface between the SDK and KL's Users REST APIs.\n * @method createRequests\n * @param  {Object} container The bottle container.\n * @return {Object} Available requests for Users.\n */\nexport default function createRequests(container) {\n  const { context, logManager, sendRequest } = container\n  const log = logManager.getLogger('USERS')\n\n  async function getDirectory(conn, params = {}) {\n    const version = conn.server.version\n    var url = `${conn.server.protocol}://${conn.server.server}:${conn.server.port}/rest/version/${version}/user/${conn.username}/directory`\n\n    const queryParams = {}\n    if (params.searchType) {\n      queryParams.criteria = params.searchCriteria\n      queryParams.criteriaType = params.searchType\n    } else if (params.searchCriteria) {\n      queryParams.criteria = params.searchCriteria\n    }\n    const method = 'GET'\n    const response = await sendRequest({ url, queryParams, method })\n    const { error, result, body } = response\n    if (error) {\n      if (body) {\n        // Handle errors from the server.\n        const { statusCode } = body.directory\n        log.debug(`Failed to search directory with status code ${statusCode}.`)\n        // TODO: Proper errors.\n        throw new BasicError({ code: statusCode, message: `Failed to search directory; status ${statusCode}.` })\n      } else {\n        // Handle errors from the request helper.\n        const { message } = result\n        log.debug(`Directory search request failed: ${message}`)\n        // TODO: Proper errors.\n        throw new BasicError({ message: `Directory search request failed: ${message}` })\n      }\n    } else {\n      if (body && body.directory.statusCode === 0) {\n        // Request was successful.\n        return body.directory.directoryItems || []\n      } else {\n        // Unknown case.\n        log.debug('Unknown error case for directory search.')\n        throw new BasicError({ message: 'Unknown error.' })\n      }\n    }\n  }\n\n  async function contactRequest(params = {}) {\n    const requestInfo = getRequestInfo(context.getState())\n    const version = requestInfo.version\n\n    const { extraURL, method } = params\n\n    let url\n    if (extraURL) {\n      url = `${requestInfo.baseURL}/rest/version/${version}/user/${requestInfo.username}/addressbook/${extraURL}`\n    } else {\n      url = `${requestInfo.baseURL}/rest/version/${version}/user/${requestInfo.username}/addressbook`\n    }\n\n    const options = {\n      method,\n      url,\n      body: params.body\n    }\n\n    // TODO: Update usersCodes to reflect the proper errors' codes.\n    const bodyStatusCodeMap = {\n      4: usersCodes.REFRESH_CONTACTS_FAIL, // not authenticated\n      27: usersCodes.REFRESH_CONTACTS_FAIL, // bad request\n      35: usersCodes.REFRESH_CONTACTS_FAIL // bad request\n    }\n\n    const HTTPStatusCodes = {\n      FORBIDDEN: 403\n    }\n\n    // Credentials not set. Therefore, request is not sent (unauthorized issue).\n    if (!requestInfo.username) {\n      const message = 'Failed to add contact; user not authenticated (credentials not set).'\n      log.info(message)\n      throw new BasicError({\n        code: usersCodes.REFRESH_CONTACTS_FAIL,\n        message\n      })\n    }\n\n    const response = await sendRequest(options)\n    const { body, error, result } = response\n\n    if (!error) {\n      const { addressBookResponse } = body\n      log.info(`${method} contact(s) performed successfully; Status code: ${addressBookResponse.statusCode}`)\n      return { result: addressBookResponse || {} }\n    }\n\n    let errorCode = ''\n    let errorMessage = ''\n\n    if (!isEmpty(body)) {\n      // Handle responses with a body status code (errors from the server).\n      const { statusCode } = body.addressBookResponse\n      errorMessage = `Failed to ${method} contact(s). Status Code ${statusCode}`\n      errorCode = bodyStatusCodeMap[statusCode] || usersCodes.UNKNOWN\n    } else {\n      // Handle responses without a body status code. HTTP status code is checked to determine the error.\n      // Either REST request issues or unknown server issues.\n      const { code, message } = result\n\n      errorMessage = `Failed to ${method} contact(s); ${message}.`\n      errorCode = code === HTTPStatusCodes.FORBIDDEN ? usersCodes.REFRESH_CONTACTS_FAIL : usersCodes.UNKNOWN\n    }\n\n    log.info(errorMessage)\n    throw new BasicError({\n      code: errorCode,\n      message: errorMessage\n    })\n  }\n\n  return {\n    // Operation requests.\n    getDirectory,\n    contactRequest\n  }\n}\n","// Webrtc plugin.\nimport { deviceActions } from '../interface/actions'\nimport * as eventTypes from '../interface/eventTypes'\n\n/**\n * Sets up listeners for events emitted from the Webrtc-stack's Device Manager.\n *\n * Events received from the Webrtc-stack are used to:\n *    1) Create actions to update SDK state about Webrtc-layer changes.\n *    2) Sometimes create events to emit to the application to reflect the changes\n *        to SDK state.\n *\n * The actions and events are passed to a \"handler\" which knows what to do with\n *    them in the current context (ie. not always direct dispatch/emit).\n * @method watchDeviceEvents\n * @param {Object} manager The WebRTC Device Manager.\n * @param {Function} handler Function for handling actions and events.\n */\nexport default function watchDeviceEvents(manager, handler) {\n  // Manager event handlers.\n  /**\n   * @method change\n   * @param {boolean} [actionOnly] True if this event should not be emitted to the application.\n   */\n  const change = actionOnly => {\n    // Get the latest devices after they changed, then emit the device list\n    //  upwards.\n    manager.checkDevices().then(devices => {\n      const devicesChangedAction = deviceActions.devicesChanged(devices)\n      const devicesChangedEvent = actionOnly ? undefined : { type: eventTypes.DEVICES_CHANGED, args: {} }\n      handler(devicesChangedAction, devicesChangedEvent)\n    })\n  }\n\n  manager.on('change', change)\n\n  // Return an unsubscribe function that removes all event listeners.\n  const unsubscribe = () => {\n    manager.off('change', change)\n  }\n\n  return unsubscribe\n}\n","// Manager channels.\nimport watchDeviceEvents from './devices'\nimport watchTrackManagerEvents from './trackManager'\nimport watchSessionManagerEvents from './sessionManager'\nimport watchMediaManagerEvents from './mediaManager'\n\n// Webrtc plugin.\nimport { TRACK_ENDED } from '../interface/eventTypes'\nimport * as webrtcActionTypes from '../interface/actionTypes'\n\n// Other plugins.\nimport { MEDIA_CONNECTION_CHANGE } from '../../call/interface/eventTypes'\nimport { getCallByWebrtcSessionId } from '../../call/interface/selectors'\n\n/**\n * Function that connects the Webrtc-stack's events directly to the SDK.\n *\n * Sets up all of the \"manager channels\" to listen for Webrtc-stack events\n *    and passes in a \"handler\" for what the manager channels should do with\n *    actions/events generated from the Webrtc-stack events.\n * @method watchManagers\n * @param {Object} container The bottle container.\n */\nexport default function watchManagers(container) {\n  const { WebRTC } = container\n\n  // Create a function to handle the actions/events that come from the webrc\n  //    channels. In this context, they can be directly dispatched / emitted.\n  const messageHandler = createHandler(container)\n\n  // These functions return unsubscribe functions to turn off the event listeners\n  // TODO: These events should be unsubscribed from gracefully along with SDK destruction.\n  //  However, there is no mechanism to easily allow that currently.\n  watchDeviceEvents(WebRTC.devices, messageHandler)\n  watchTrackManagerEvents(WebRTC.track, messageHandler)\n  watchMediaManagerEvents(WebRTC.media, messageHandler)\n  watchSessionManagerEvents(WebRTC.sessionManager, messageHandler)\n}\n\n/**\n * Factory for webrtc-stack message handler function.\n * @name createHandler\n * @param {Object} container\n * @return {Function} Message handler function.\n */\nexport function createHandler(container) {\n  /**\n   * Logic for handling a message received from the webrtc-stack.\n   * @param {Object} message\n   * @param {Object} [message.action]\n   * @param {Object} [message.event]\n   * @return {undefined}\n   */\n  return function handleMessage(action, event) {\n    try {\n      /*\n       * This is a workaround to prevent an uncaught exception being thrown to console\n       *    when the SDK has been destroyed but native WebRTC events are still bubbling\n       *    up. If the SDK has been destroyed, getting state will throw an error and the\n       *    event will stop being processed here.\n       *\n       * The proper solution is to clean-up WebRTC resources as part of destroying the SDK.\n       * See KJS-2415 for the proper solution.\n       * See KJS-2416 for why this was added here.\n       */\n      container.context.getState()\n    } catch (err) {\n      return\n    }\n\n    // All messages from the webrtc-stack are expected to be formatted as an\n    //    action or event.\n\n    if (action) {\n      /*\n       * Check if there is a call-level event associated with this action.\n       * This is for actions that require access to SDK data (rather than only\n       *    webrtc-stack data). This is the first point that the message from\n       *    the webrtc-stack has access to the `container`.\n       */\n      const callEvent = getAssociatedCallEvent(container.context, action)\n\n      container.context.dispatch(action)\n\n      if (callEvent) {\n        container.emitEvent(callEvent.type, callEvent.args)\n      }\n    }\n\n    if (event) {\n      container.emitEvent(event.type, event.args)\n    }\n  }\n}\n\n/**\n * Map function between actions and associated events.\n * @param {Object} context\n * @param {Object} action\n * @return {Event|undefined}\n */\nfunction getAssociatedCallEvent(context, action) {\n  switch (action.type) {\n    case webrtcActionTypes.SESSION_ICE_CONNECTION_STATE_CHANGE: {\n      const call = getCallByWebrtcSessionId(context.getState(), action.payload.id)\n      if (call) {\n        return {\n          type: MEDIA_CONNECTION_CHANGE,\n          args: { callId: call.id, previous: { state: call.mediaConnectionState } }\n        }\n      }\n      break\n    }\n    case webrtcActionTypes.SESSION_TRACK_ENDED: {\n      const { trackId, local, isUnsolicited, id } = action.payload\n\n      if (local && isUnsolicited) {\n        const call = getCallByWebrtcSessionId(context.getState(), id)\n        return {\n          type: TRACK_ENDED,\n          args: {\n            callId: call.id,\n            trackId,\n            isLocal: local\n          }\n        }\n      }\n      break\n    }\n  }\n}\n","// Webrtc plugin.\nimport { mediaActions } from '../interface/actions'\n\n/**\n * Sets up event listeners for a Media's events.\n * The events are turned into actions and dispatched\n *    to be handled by redux.\n * @method watchMediaEvents\n * @param {Object} media A Media object.\n * @param {Object} handler Handler function for handling actions and events.\n */\nexport default function watchMediaEvents(media, handler) {\n  // Media received a new track.\n  const newTrack = ({ mediaId, trackId }) => {\n    // Pass the action to the handler to be handled as appropriate\n    const mediaNewTrackAction = mediaActions.mediaNewTrack(mediaId, { trackId })\n    handler(mediaNewTrackAction)\n  }\n\n  const trackEnded = ({ mediaId, trackId }) => {\n    // Pass the action to the handler to be handled as appropriate\n    const mediaTrackEndedAction = mediaActions.mediaTrackEnded(mediaId, { trackId })\n    handler(mediaTrackEndedAction)\n  }\n\n  const unsubscribe = () => {\n    media.off('media:stopped', unsubscribe)\n    media.off('track:new', newTrack)\n    media.off('track:ended', trackEnded)\n  }\n\n  // If the media is stopped we will turn off event listeners for this media.\n  //  The Media Manager will handle updating state with the media \"remove\" event that gets emitted\n  //  following media \"stopped\" events.\n  media.on('media:stopped', unsubscribe)\n  media.on('track:new', newTrack)\n  media.on('track:ended', trackEnded)\n\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport { mediaActions } from '../interface/actions'\nimport watchMediaEvents from './media'\n\n/**\n * Sets up event listeners for Media Manager events. The events are turned into\n *    actions and dispatched to be handled by redux.\n * @method watchMediaManagerEvents\n * @param {Object} manager The Media Manager.\n * @param {Object} handler Handler function for handling actions and events.\n */\nexport default function watchMediaManagerEvents(manager, handler) {\n  const newMedia = id => {\n    const media = manager.get(id)\n\n    // If it is a new Media, watch for its events.\n    watchMediaEvents(media, handler)\n\n    // Pass the action to the handler to be handled as appropriate\n    const detached = media.getTracks().some(track => track.isDetached())\n    const newMediaAction = mediaActions.newMedia(id, {\n      local: media.getState().isLocal,\n      detached,\n      tracks: media.getTracks().map(track => track.id)\n    })\n    handler(newMediaAction)\n  }\n\n  const removedMedia = id => {\n    // Pass the action to the handler to be handled as appropriate\n    const removedMediaAction = mediaActions.removedMedia(id)\n    handler(removedMediaAction)\n  }\n\n  manager.on('media:new', newMedia)\n  manager.on('media:removed', removedMedia)\n\n  const unsubscribe = () => {\n    manager.off('media:new', newMedia)\n    manager.off('media:removed', removedMedia)\n  }\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport { sessionActions } from '../interface/actions'\n\n/**\n * Sets up event listeners for a Session's events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchSessionEvents\n * @param {Object} session The Session object.\n * @param {Object} handler Handler function for handling actions and events.\n */\nexport default function watchSessionEvents(session, handler) {\n  // Session received a new track.\n  const newTrack = ({ local, trackId }) => {\n    // Pass the action to the handler to be handled as appropriate\n    const newTrackAction = sessionActions.sessionNewTrack(session.id, {\n      local,\n      trackId\n    })\n    handler(newTrackAction)\n  }\n\n  const trackEnded = ({ local, trackId, isUnsolicited }) => {\n    /**\n     * When a track has ended,\n     * update redux state's webrtc.session.localTracks/remoteTracks array\n     * by removing the specified trackId.\n     * ('local' boolean will determine whether to update localTracks or remoteTracks)\n     */\n    handler(\n      sessionActions.sessionTrackEnded(session.id, {\n        local,\n        trackId,\n        isUnsolicited\n      })\n    )\n  }\n\n  const trackReplaced = ({ oldTrackId, trackId }) => {\n    // Pass the action to the handler to be handled as appropriate\n    const trackReplacedAction = sessionActions.sessionTrackReplaced(session.id, {\n      oldTrackId,\n      trackId\n    })\n    handler(trackReplacedAction)\n  }\n\n  const iceConnectionStateChange = obj => {\n    // Pass the action to the handler to be handled as appropriate\n    const iceConnectionStateChangeAction = sessionActions.sessionIceConnectionStateChange(session.id, {\n      iceConnectionState: obj.iceConnectionState\n    })\n    handler(iceConnectionStateChangeAction)\n  }\n\n  const iceCandidateCollected = obj => {\n    // Pass the action to the handler to be handled as appropriate\n    const iceCandidateCollectedAction = sessionActions.sessionIceCandidateCollected(session.id, obj)\n    handler(iceCandidateCollectedAction)\n  }\n\n  const iceGatheringStateChange = obj => {\n    // Pass the action to the handler to be handled as appropriate\n    const iceGatheringStateChangeAction = sessionActions.sessionIceGatheringStateChange(session.id, obj)\n    handler(iceGatheringStateChangeAction)\n  }\n\n  const iceCollectionScheduledCheck = obj => {\n    // Pass the action to the handler to be handled as appropriate\n    const iceCollectionScheduledCheckAction = sessionActions.sessionIceCollectionScheduledCheck(session.id, obj)\n    handler(iceCollectionScheduledCheckAction)\n  }\n\n  // Listen for when audio files end (from `insertAudio` API).\n  const audioFileEnded = isSuccess => {\n    handler(sessionActions.sessionAudioEnded(session.id, { error: !isSuccess }))\n  }\n\n  session.on('new:track', newTrack)\n  session.on('track:ended', trackEnded)\n  session.on('track:replaced', trackReplaced)\n  session.on('peer:iceConnectionStateChange', iceConnectionStateChange)\n  session.on('peer:iceGatheringStateChange', iceGatheringStateChange)\n  session.on('peer:iceCandidateCollected', iceCandidateCollected)\n  session.on('peer:iceCollectionScheduledCheck', iceCollectionScheduledCheck)\n  session.on('audioFileEnded', audioFileEnded)\n\n  const unsubscribe = () => {\n    session.off('new:track', newTrack)\n    session.off('track:ended', trackEnded)\n    session.off('track:replaced', trackReplaced)\n    session.off('peer:iceConnectionStateChange', iceConnectionStateChange)\n    session.off('peer:iceGatheringStateChange', iceGatheringStateChange)\n    session.off('peer:iceCandidateCollected', iceCandidateCollected)\n    session.off('peer:iceCollectionScheduledCheck', iceCollectionScheduledCheck)\n    session.off('audioFileEnded', audioFileEnded)\n  }\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport { sessionActions } from '../interface/actions'\nimport watchSessionEvents from './session'\n\n/**\n * Sets up event listeners for Session Manager Events.\n * The events are turned into actions and dispatched\n *    to be handled by redux elsewhere.\n * @method watchSessionManagerEvents\n * @param {Object} manager The webRTC Session Manager.\n * @param {Object} handler Handler function for handling actions and events.\n */\nexport default function watchSessionManagerEvents(manager, handler) {\n  // Handle new Session.\n  const sessionAdded = id => {\n    const session = manager.get(id)\n    const state = session.getState()\n    delete state.id\n\n    // If it is a new Session, watch for its events.\n    watchSessionEvents(session, handler)\n\n    // Pass the action to the handler to be handled as appropriate\n    const sessionAddedAction = sessionActions.sessionAdded(id, state)\n    handler(sessionAddedAction)\n  }\n\n  // Handle Sessions ending.\n  const sessionRemoved = id => {\n    // Pass the action to the handler to be handled as appropriate\n    const sessionRemovedAction = sessionActions.sessionRemoved(id)\n    handler(sessionRemovedAction)\n  }\n\n  manager.on('session:new', sessionAdded)\n  manager.on('session:removed', sessionRemoved)\n  const unsubscribe = () => {\n    manager.off('session:new', sessionAdded)\n    manager.off('session:removed', sessionRemoved)\n  }\n  return unsubscribe\n}\n","// Libraries.\nimport { trackActions } from '../interface/actions'\nimport * as eventTypes from '../interface/eventTypes'\n\n/**\n * Sets up event listeners for a Track object's events.\n * The events simply dispatch actions to be handled by redux.\n * @method watchTrackEvents\n * @param {Object} track A Track object.\n * @param {Object} handler Handler function for handling actions and events.\n */\nexport default function watchTrackEvents(track, handler) {\n  // The track source (which affected the track identified by trackId) was muted.\n  // An example of a track source is a physical media device such as:\n  // microphone or camera.\n  const trackSourceMuted = trackData => {\n    const trackSourceMutedAction = trackActions.trackSourceMuted([trackData.trackId], {\n      mediaId: trackData.mediaId,\n      isLocal: trackData.isLocal\n    })\n    const trackSourceMutedEvent = {\n      type: eventTypes.TRACK_SOURCE_MUTED,\n      args: {\n        trackIds: [trackData.trackId],\n        trackId: trackData.trackId,\n        isLocal: trackData.isLocal,\n        id: trackData.mediaId\n      }\n    }\n    // Pass the action and event to the handler to be handled as appropriate\n    handler(trackSourceMutedAction, trackSourceMutedEvent)\n  }\n\n  // The track source (which affected the track identified by trackId) was unmuted.\n  const trackSourceUnmuted = trackData => {\n    const trackSourceUnmutedAction = trackActions.trackSourceUnmuted([trackData.trackId], {\n      mediaId: trackData.mediaId,\n      isLocal: trackData.isLocal\n    })\n    const trackSourceUnmutedEvent = {\n      type: eventTypes.TRACK_SOURCE_UNMUTED,\n      args: {\n        trackIds: [trackData.trackId],\n        trackId: trackData.trackId,\n        isLocal: trackData.isLocal,\n        id: trackData.mediaId\n      }\n    }\n    // Pass the action and event to the handler to be handled as appropriate\n    handler(trackSourceUnmutedAction, trackSourceUnmutedEvent)\n  }\n\n  const unsubscribe = () => {\n    track.off('ended', unsubscribe)\n    track.off('muted', trackSourceMuted)\n    track.off('unmuted', trackSourceUnmuted)\n  }\n\n  // If the track is ended we will turn off event listeners for the track object.\n  //  The trackManager will handle updating state with the track \"remove\" event that gets emitted\n  //  following track \"ended\" events.\n  track.on('ended', unsubscribe)\n  track.on('muted', trackSourceMuted)\n  track.on('unmuted', trackSourceUnmuted)\n\n  return unsubscribe\n}\n","// Call plugin.\nimport { trackActions } from '../interface/actions'\nimport { TRACK_ENDED } from '../interface/eventTypes'\nimport watchTrackEvents from './track'\n\n/**\n * Sets up event listeners for Track Manager Events.\n * The events are turned into actions and dispatched\n *    to be handled by redux.\n * @method watchTrackManagerEvents\n * @param {Object} manager The webRTC Track Manager.\n * @param {Object} handler Handler function for handling actions and events.\n */\nexport default function watchTrackManagerEvents(manager, handler) {\n  // Handler for new tracks\n  const trackAdded = id => {\n    const track = manager.get(id)\n    const state = track.getState()\n\n    // Translate the track state from native WebRTC to SDK style.\n    // This is to change the \"muted\" property to be what people generally know\n    //    \"muted\" to be.\n    state.sourceMuted = state.muted\n    state.muted = !state.enabled\n\n    delete state.enabled\n    delete state.id\n\n    // Set up event listeners for the added track\n    watchTrackEvents(track, handler)\n\n    // Pass the action to the handler to be handled as appropriate\n    const trackAddedAction = trackActions.trackAdded(id, state)\n    handler(trackAddedAction)\n  }\n\n  // Handler for removed/ended tracks\n  const trackRemoved = id => {\n    // Pass the action to the handler to be handled as appropriate\n    const trackRemovedAction = trackActions.trackRemoved(id)\n    // Check if track is detached and emit a 'track ended' event if it is\n    const track = manager.get(id)\n    const trackEndedEvent = track.isDetached()\n      ? {\n          type: TRACK_ENDED,\n          args: {\n            trackId: id,\n            isLocal: true,\n            detached: true\n          }\n        }\n      : undefined\n    handler(trackRemovedAction, trackEndedEvent)\n  }\n\n  // Listen for track add or remove events\n  manager.on('add', trackAdded)\n  manager.on('remove', trackRemoved)\n\n  // Return an unsubscribe function that removes all event listeners.\n  const unsubscribe = () => {\n    manager.off('add', trackAdded)\n    manager.off('remove', trackRemoved)\n  }\n\n  return unsubscribe\n}\n","// Webrtc plugin.\nimport pluginInterface from './interface'\nimport createAPI from './interface/api/index'\nimport createMediaOperations from './operations/media'\nimport createLogOperations from './operations/logs'\nimport createWebRTCOperations from './operations/webrtc'\nimport { miscActions } from './interface/actions'\nimport watchManagers from './channels'\nimport createMiddleware from './middleware'\n\n// Other plugins.\nimport { logManager } from '../logs'\nimport { getLevel } from '../logs/interface/selectors'\n\n// Libraries.\nimport initialize, { getBrowserDetails, getWebRTCSupportCapabilities } from 'kandy-webrtc'\n\nconst log = logManager.getLogger('WEBRTC')\n\n/**\n * WebRTC plugin factory.\n * @method webrtcPlugin\n */\nexport default function webrtcPlugin(bottle) {\n  const { mediaDevices, peerConnection } = getWebRTCSupportCapabilities()\n  if (!mediaDevices || !peerConnection) {\n    log.warn(\n      'Calls are not supported on this platform due to lack of WebRTC support. Media APIs will not be available.'\n    )\n    return\n  }\n\n  // Initialize the webRTC.\n  const webRTC = initialize()\n\n  // Register the component factory functions to the bottle.\n  bottle.factory('WebRTCAPI', createAPI)\n  bottle.factory('WebRTCMediaOperations', createMediaOperations)\n  bottle.factory('WebRTCLogOperations', createLogOperations)\n  bottle.factory('WebRTCOperations', createWebRTCOperations)\n\n  // Register the WebRTC stack to the bottle. This lets other component access it.\n  bottle.factory('WebRTC', () => webRTC.managers)\n\n  // Register a function to check browser info after SDK initialization has finished.\n  bottle.defer(initWebrtc)\n\n  // Configure the WebRTC stack's log level on SDK initialization.\n  bottle.defer(initLogLevel)\n\n  // Register a function to start listening for events from the WebRTC managers after SDK initialization has finished.\n  bottle.defer(watchManagers)\n\n  return {\n    name: 'webrtc',\n    reducer: pluginInterface.reducer,\n    middleware: createMiddleware\n  }\n}\n\n/**\n * WebRTC initialization function to check and set browser details.\n * @method initWebrtc\n * @param {Object} container The bottle container.\n */\nexport function initWebrtc(container) {\n  const { logManager, context } = container\n  const log = logManager.getLogger('WEBRTC')\n\n  // Use the webRTC stack to check the browser details.\n  const details = getBrowserDetails()\n  log.info(`Browser details: ${details.browser}, version ${details.version}.`)\n  context.dispatch(miscActions.setBrowserDetails(details))\n}\n\n/**\n * WebRTC initialization function to set the log level on SDK initialization\n * @method initLogLevel\n * @param  {Object} container The bottle container.\n */\nexport function initLogLevel(container) {\n  const { context, WebRTCLogOperations: operations } = container\n  // Get the WEBRTC logger's level.\n  const level = getLevel(context.getState(), 'WEBRTC')\n  // Call the \"set log level\" operation for the WEBRTC logger, pretending that we\n  //    received an action updating its level.\n  operations.updateLogLevel({ payload: { WEBRTC: level } })\n}\n","const prefix = '@@KANDY/WEBRTC/'\n\n/**\n * Device action types.\n */\nexport const DEVICES_CHANGE = prefix + 'DEVICES/CHANGE'\nexport const INITIALIZE_DEVICES = prefix + 'INITIALIZE_DEVICES'\nexport const INITIALIZE_DEVICES_FINISH = prefix + 'INITIALIZE_DEVICES_FINISH'\n\n/**\n * Track action types.\n */\nconst trackPrefix = prefix + 'TRACK/'\n\nexport const TRACK_ADDED = trackPrefix + 'ADDED'\nexport const TRACK_REMOVED = trackPrefix + 'REMOVED'\n\nexport const RENDER_TRACKS = trackPrefix + 'RENDER'\nexport const RENDER_TRACKS_FINISH = trackPrefix + 'RENDER_FINISH'\n\nexport const REMOVE_TRACKS = trackPrefix + 'REMOVE'\nexport const REMOVE_TRACKS_FINISH = trackPrefix + 'REMOVE_FINISH'\n\nexport const MUTE_TRACKS = trackPrefix + 'MUTE'\nexport const MUTE_TRACKS_FINISH = trackPrefix + 'MUTE_FINISH'\nexport const UNMUTE_TRACKS = trackPrefix + 'UNMUTE'\nexport const UNMUTE_TRACKS_FINISH = trackPrefix + 'UNMUTE_FINISH'\n\nexport const TRACK_SOURCE_MUTED = trackPrefix + 'SOURCE_MUTED'\nexport const TRACK_SOURCE_UNMUTED = trackPrefix + 'SOURCE_UNMUTED'\n\n/**\n * Session action types.\n */\nconst sessionPrefix = prefix + 'SESSION/'\n\nexport const SESSION_ADDED = sessionPrefix + 'ADDED'\nexport const SESSION_REMOVED = sessionPrefix + 'REMOVED'\n\nexport const SESSION_NEW_TRACK = sessionPrefix + 'NEW_TRACK'\nexport const SESSION_TRACK_ENDED = sessionPrefix + 'TRACK_ENDED'\nexport const SESSION_TRACK_REPLACED = sessionPrefix + 'TRACK_REPLACED'\n\n// Audio file from the `insertAudio` API has ended.\nexport const SESSION_AUDIO_ENDED = sessionPrefix + 'AUDIO_ENDED'\n\n// Peer events\nexport const SESSION_ICE_CONNECTION_STATE_CHANGE = sessionPrefix + 'ICE_CONNECTION_STATE_CHANGE'\nexport const SESSION_ICE_GATHERING_STATE_CHANGE = sessionPrefix + 'ICE_GATHERING_STATE_CHANGE'\nexport const SESSION_ICE_CANDIDATE_COLLECTED = sessionPrefix + 'ICE_CANDIDATE_COLLECTED'\nexport const SESSION_ICE_COLLECTION_SCHEDULED_CHECK = sessionPrefix + 'ICE_CANDIDATE_SCHEDULED_CHECK'\n\n/**\n * Media action types.\n */\nconst mediaPrefix = prefix + 'MEDIA/'\n\nexport const MEDIA_NEW = mediaPrefix + 'NEW'\nexport const MEDIA_REMOVED = mediaPrefix + 'REMOVED'\nexport const MEDIA_CHANGE = mediaPrefix + 'CHANGE'\n\nexport const MEDIA_NEW_TRACK = mediaPrefix + 'NEW_TRACK'\nexport const MEDIA_TRACK_ENDED = mediaPrefix + 'TRACK_ENDED'\n\n/**\n * Misc. action types.\n */\nexport const SET_BROWSER_DETAILS = prefix + 'SET_BROWSER_DETAILS'\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\nexport function devicesChanged(devices) {\n  return {\n    type: actionTypes.DEVICES_CHANGE,\n    payload: devices\n  }\n}\n\nexport function initializeDevice(browserConstraints) {\n  return {\n    type: actionTypes.INITIALIZE_DEVICES,\n    payload: browserConstraints\n  }\n}\n\n/**\n * The finishing action which follows the INITIALIZE_DEVICES action\n * @param {Object} $0\n * @param {Object} [$0.devices] The device object.\n * @param {Object} [$0.error] An error object. Only present if an error occurred.\n * @returns {Object} A flux standard action representing the INITIALIZE_DEVICES_FINISH action.\n */\nexport function initializeDeviceFinish({ devices, error }) {\n  return {\n    payload: error || devices,\n    error: Boolean(error),\n    type: actionTypes.INITIALIZE_DEVICES_FINISH\n  }\n}\n","import * as deviceActionsImport from './devices'\nimport * as trackActionsImport from './tracks'\nimport * as sessionActionsImport from './sessions'\nimport * as mediaActionsImport from './media'\nimport * as miscActionsImport from './misc'\n\n// Apparently the following doesn't work:\n//      export * as newName from './place';\n// So import everything from each file, then re-export.\nexport const deviceActions = deviceActionsImport\nexport const trackActions = trackActionsImport\nexport const sessionActions = sessionActionsImport\nexport const mediaActions = mediaActionsImport\nexport const miscActions = miscActionsImport\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { isEmpty } from 'lodash/fp'\n\nfunction mediaActionHelper(type, id, payload = {}, meta = {}) {\n  const action = {\n    type,\n    payload: {\n      ...payload,\n      id\n    }\n  }\n\n  // Only have meta and error properties on the action if they're needed.\n  if (!isEmpty(meta)) {\n    action.meta = meta\n  }\n  if (payload.error) {\n    action.error = true\n  }\n  return action\n}\n\nexport function newMedia(id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_NEW, id, params)\n}\n\nexport function removedMedia(id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_REMOVED, id, params)\n}\n\nexport function mediaNewTrack(id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_NEW_TRACK, id, params)\n}\n\nexport function mediaTrackEnded(id, params) {\n  return mediaActionHelper(actionTypes.MEDIA_TRACK_ENDED, id, params)\n}\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n/**\n * Action creator\n * @method setBrowserDetails\n * @param  {Object} details\n * @param  {string} details.browser\n * @param  {number} details.version\n * @return {Object} A Flux-Standard-action.\n */\nexport function setBrowserDetails(details) {\n  return {\n    type: actionTypes.SET_BROWSER_DETAILS,\n    payload: details\n  }\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { isEmpty } from 'lodash/fp'\n\nfunction sessionActionHelper(type, id, payload = {}, meta = {}) {\n  const action = {\n    type,\n    payload: {\n      ...payload,\n      id\n    }\n  }\n\n  // Only have meta and error properties on the action if they're needed.\n  if (!isEmpty(meta)) {\n    action.meta = meta\n  }\n  if (payload.error) {\n    action.error = true\n  }\n  return action\n}\n\nexport function sessionAdded(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_ADDED, id, params)\n}\n\nexport function sessionRemoved(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_REMOVED, id, params)\n}\n\nexport function sessionNewTrack(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_NEW_TRACK, id, params)\n}\n\nexport function sessionTrackEnded(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_TRACK_ENDED, id, params)\n}\n\nexport function sessionTrackReplaced(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_TRACK_REPLACED, id, params)\n}\n\nexport function sessionIceConnectionStateChange(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_ICE_CONNECTION_STATE_CHANGE, id, params)\n}\n\nexport function sessionIceGatheringStateChange(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_ICE_GATHERING_STATE_CHANGE, id, params)\n}\n\nexport function sessionIceCandidateCollected(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_ICE_CANDIDATE_COLLECTED, id, params)\n}\n\nexport function sessionIceCollectionScheduledCheck(id, params) {\n  return sessionActionHelper(actionTypes.SESSION_ICE_COLLECTION_SCHEDULED_CHECK, id, params)\n}\n\n/*\n * Action to signify that an audio file has ended. Dispatched at the end of the\n *    `insertAudio` Session method.\n */\nexport function sessionAudioEnded(id, params) {\n  return {\n    type: actionTypes.SESSION_AUDIO_ENDED,\n    payload: { id, ...params },\n    error: Boolean(params.error)\n  }\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\nfunction trackManagerHelper(type, trackId, payload = {}, meta = {}) {\n  return {\n    type,\n    payload: {\n      ...payload,\n      trackId\n    },\n    meta\n  }\n}\n\nexport function trackAdded(trackId, params) {\n  return trackManagerHelper(actionTypes.TRACK_ADDED, trackId, params)\n}\n\nexport function trackRemoved(trackId, params) {\n  return trackManagerHelper(actionTypes.TRACK_REMOVED, trackId, params)\n}\n\nfunction trackHelper(type, payload = {}, meta = {}) {\n  const action = {\n    type,\n    payload,\n    meta\n  }\n\n  if (payload.error) {\n    action.error = true\n  }\n\n  return action\n}\n\nexport function muteTracks(trackIds) {\n  return trackHelper(actionTypes.MUTE_TRACKS, trackIds)\n}\n\nexport function muteTracksFinish(trackIds, params) {\n  return trackHelper(actionTypes.MUTE_TRACKS_FINISH, { trackIds: trackIds, ...params })\n}\n\nexport function unmuteTracks(trackIds) {\n  return trackHelper(actionTypes.UNMUTE_TRACKS, trackIds)\n}\n\nexport function unmuteTracksFinish(trackIds, params) {\n  return trackHelper(actionTypes.UNMUTE_TRACKS_FINISH, { trackIds: trackIds, ...params })\n}\n\nexport function trackSourceMuted(trackIds, params) {\n  return trackHelper(actionTypes.TRACK_SOURCE_MUTED, { trackIds: trackIds, ...params })\n}\n\nexport function trackSourceUnmuted(trackIds, params) {\n  return trackHelper(actionTypes.TRACK_SOURCE_UNMUTED, { trackIds: trackIds, ...params })\n}\n\nexport function renderTracks(trackIds, params) {\n  return trackHelper(actionTypes.RENDER_TRACKS, {\n    trackIds,\n    ...params\n  })\n}\n\nexport function renderTracksFinish(trackIds, params) {\n  return trackHelper(actionTypes.RENDER_TRACKS_FINISH, {\n    trackIds,\n    ...params\n  })\n}\n\nexport function removeTracks(trackIds, params) {\n  return trackHelper(actionTypes.REMOVE_TRACKS, {\n    trackIds,\n    ...params\n  })\n}\n\nexport function removeTracksFinish(trackIds, params) {\n  return trackHelper(actionTypes.REMOVE_TRACKS_FINISH, {\n    trackIds,\n    ...params\n  })\n}\n","// Webrtc plugin.\nimport { isPlainObject } from 'lodash/fp'\nimport { getBrowserDetails as getBrowserDetailsSelector } from '../selectors'\n\n// Namespaced APIs.\nimport createMediaAPI from './media'\n\n/**\n * WebRTC API factory function.\n * @method createAPI\n * @param  {Object} container The bottle container.\n * @param  {Object} container.context The factory context.\n * @return {Object} API.\n */\nexport default function createAPI(container) {\n  const { context, logManager, API_LOG_TAG, WebRTCOperations: operations } = container\n  const log = logManager.getLogger('WEBRTC')\n\n  const mediaApi = createMediaAPI(container)\n\n  /**\n   * Retrieve information about the browser being used.\n   *\n   * Browser information being defined indicates that the browser supports\n   *    basic webRTC scenarios.\n   * @public\n   * @memberof api\n   * @method getBrowserDetails\n   * @return {Object} Object containing `browser` and `version` information.\n   * @example\n   * const details = client.getBrowserDetails()\n   *\n   * log(`Browser in use: ${details.browser}, version ${details.version}.`)\n   */\n  function getBrowserDetails() {\n    log.debug(API_LOG_TAG + 'getBrowserDetails')\n    return getBrowserDetailsSelector(context.getState())\n  }\n\n  /**\n   * Set up provided WebRTC functionality proxies on top of WebRTC to enable\n   * WebRTC call features on platforms that would otherwise not support them.\n   * @private\n   * @method setupProxy\n   * @param {Object} proxies The WebRTC proxies.\n   */\n  function setupProxy(proxies) {\n    log.debug(API_LOG_TAG + 'webrtc.setupProxy')\n\n    if (!isPlainObject(proxies)) {\n      log.error('Provided proxies is not an appropriate object.')\n      return\n    }\n\n    operations.setupProxies(proxies)\n  }\n\n  /**\n   * Teardown all WebRTC functionality proxies that were set on top of WebRTC.\n   * @private\n   * @method teardownProxy\n   */\n  async function teardownProxy() {\n    log.debug(API_LOG_TAG + 'webrtc.teardownProxy')\n\n    await operations.teardownProxies()\n  }\n\n  return {\n    media: mediaApi,\n    getBrowserDetails,\n    webrtc: { setupProxy, teardownProxy }\n  }\n}\n","// Webrtc plugin.\nimport { getDevices, getMediaById, getTrackById } from '../selectors'\nimport * as eventTypes from '../eventTypes'\n\n// Other plugins.\nimport { logCssSelector } from '../../../common/utils'\n\n/**\n * Media related APIs.\n * @method mediaAPI\n * @param  {Function} dispatch Redux dispatch.\n * @param  {Function} getState Redux getState.\n * @return {Object}\n */\nexport default function createMediaAPI(container) {\n  const { context, WebRTCMediaOperations: operations, logManager, API_LOG_TAG, emitEvent } = container\n  const log = logManager.getLogger('MEDIA')\n\n  return {\n    /**\n     * Retrieves the available media devices for use.\n     *\n     * The {@link media.event:devices:change devices:change} event will be\n     *    emitted when the available media devices have changed.\n     *\n     * @public\n     * @static\n     * @memberof media\n     * @method getDevices\n     * @return {Object} The lists of camera, microphone, and speaker devices.\n     */\n    getDevices() {\n      log.debug(API_LOG_TAG + 'media.getDevices')\n      return getDevices(context.getState())\n    },\n\n    /**\n     * Retrieves an available Media object with a specific Media ID.\n     * @public\n     * @static\n     * @memberof media\n     * @method getById\n     * @param  {string} mediaId The ID of the Media to retrieve.\n     * @return {call.MediaObject} A Media object.\n     */\n    getById(mediaId) {\n      log.debug(API_LOG_TAG + 'media.getById: ', mediaId)\n      return getMediaById(context.getState(), mediaId)\n    },\n\n    /**\n     * Retrieve an available Track object with a specific Track ID.\n     * @public\n     * @static\n     * @memberof media\n     * @method getTrackById\n     * @param  {string} trackId The ID of the Track to retrieve.\n     * @return {call.TrackObject} A Track object.\n     */\n    getTrackById(trackId) {\n      log.debug(API_LOG_TAG + 'media.getTrackById: ', trackId)\n      return getTrackById(context.getState(), trackId)\n    },\n\n    /**\n     * Requests permission to access media devices on the end-user's machine.\n     *\n     * This API will trigger the browser to ask the end-user for permission to\n     *    access their camera and/or microphone. These permissions are\n     *    needed for the SDK to read information about the devices (the label,\n     *    for example) and for using the devices for a call.\n     *\n     * If the browser does not yet have permission, it will prompt the end-user\n     *    with a small pop-up window, giving the user a chance to allow/deny the\n     *    permissions. The behaviour of this pop-up window differs slightly\n     *    based on the browser; it may automatically save the user's decision\n     *    (such as in Chrome and Safari) or it may require the user to choose\n     *    whether their decision should be saved (such as in Firefox).\n     *\n     * This API is not required for proper usage of media and/or calls, but\n     *    helps to prepare a user before a call is made or received. It allows\n     *    an application to prompt the user for device permissions when it is\n     *    convenient for them, rather than during call setup. If the user saves\n     *    their decision, they will not be prompted again when the SDK accesses\n     *    those devices for a call.\n     *\n     * For device information, the {@link media.getDevices} API will retrieve\n     *    the list of media devices available for the SDK to use. If this list\n     *    is empty, or is missing information, it is likely that the browser\n     *    does not have permission to access the device's information. We\n     *    recommend using the {@link media.initializeDevices} API in this\n     *    scenario if you would like to allow the end-user to select which\n     *    device(s) they would like to use when they make a call, rather than\n     *    using the system default.\n     *\n     * The SDK will emit a {@link media.event:devices:change devices:change}\n     *    event when the operation is successful or a\n     *    {@link media.event:devices:error devices:error} event if an error is\n     *    encountered.\n     * @public\n     * @static\n     * @memberof media\n     * @method initializeDevices\n     * @param {Object} [constraints]\n     * @param {boolean} [constraints.audio=true] Whether to ask for audio device permissions.\n     * @param {boolean} [constraints.video=true] Whether to ask for video device permissions.\n     * @example\n     * // The SDK will ask for both audio and video permissions by default.\n     * client.media.initializeDevices()\n     *\n     * // The SDK will only ask for audio permissions.\n     * client.media.initializeDevices({ audio: true, video: false })\n     */\n    async initializeDevices(constraints) {\n      log.debug(API_LOG_TAG + 'media.initializeDevices: ', constraints)\n      const browserConstraints = {\n        audio: constraints === undefined ? true : constraints.audio,\n        video: constraints === undefined ? true : constraints.video\n      }\n\n      try {\n        await operations.initializeDevices(browserConstraints)\n      } catch (error) {\n        emitEvent(eventTypes.INITIALIZE_DEVICES_ERROR, { error }) // error is the payload\n        return\n      }\n\n      emitEvent(eventTypes.DEVICES_CHANGED, {}) // empty payload.\n    },\n\n    /**\n     * Create local media Tracks.\n     * @public\n     * @static\n     * @memberof media\n     * @method createLocalMedia\n     * @param {Object} mediaConstraints Collection of constraints for each media type.\n     * @param {boolean} [mediaConstraints.audio] Native media constraints for audio.\n     * @param {boolean} [mediaConstraints.video] Native media constraints for video.\n     * @param {boolean} [mediaConstraints.screen] Native media constraints for display (screen).\n     * @returns {Promise} Resolves with an array of objects containing both a media type and a media object.\n     * @throws {BasicError} Throws a USER_MEDIA_ERROR error if any any other media type other than audio, video or screen is passed in mediaConstraints.\n     * @throws {BasicError} Throws a USER_MEDIA_ERROR error if provided constraints cannot be fulfilled.\n     * @throws {BasicError} Throws a USER_MEDIA_ERROR error if it fails to get media for other reasons.\n     * @example\n     * // Create detached media for your local video\n     * const medias = await client.media.createLocalMedia({ video: true })\n     */\n    async createLocalMedia(mediaConstraints) {\n      log.debug(`${API_LOG_TAG}media.createLocalMedia: `, mediaConstraints)\n\n      const medias = await operations.createLocal(mediaConstraints, true)\n\n      return medias.map(media => {\n        return {\n          type: media.type,\n          media: getMediaById(context.getState(), media.media.id)\n        }\n      })\n    },\n\n    /**\n     * Get local media Tracks.\n     * @public\n     * @static\n     * @memberof media\n     * @method getLocalMedia\n     * @returns {Promise} Resolves with an array of objects containing both a media type and a media object.\n     * @example\n     * await client.media.createLocalMedia({ video: true })\n     * // Get all detached tracks\n     * const medias = await client.media.getLocalMedia()\n     */\n    async getLocalMedia() {\n      log.debug(API_LOG_TAG + 'media.getLocalMedia')\n\n      const medias = await operations.getLocalMedia()\n\n      return medias.map(media => {\n        return {\n          type: media.type,\n          media: getMediaById(context.getState(), media.media.id)\n        }\n      })\n    },\n\n    /**\n     * Dispose local media Tracks.\n     * @public\n     * @static\n     * @memberof media\n     * @method disposeLocalMedia\n     * @param {string} trackId An id to a track to be cleaned up.\n     * @returns {Promise<undefined>}\n     * @throws {BasicError} An error indicating that trackId must be defined.\n     * @throws {BasicError} An error indicating that the track that is to be disposed is in use by a call.\n     * @throws {BasicError} An error indicating that the track that is to be disposed was not created locally.\n     */\n    async disposeLocalMedia(trackId) {\n      log.debug(API_LOG_TAG + 'media.disposeLocalMedia: ' + trackId)\n\n      await operations.disposeLocalMedia(trackId)\n    },\n\n    /**\n     * Render Media Tracks in a container.\n     *\n     * The container is specified by providing a CSS selector string that\n     *    corresponds to the HTMLElement to act as the container.\n     * @public\n     * @static\n     * @memberof media\n     * @method renderTracks\n     * @param  {Array<string>} trackIds List of Track IDs to be rendered.\n     * @param  {string} cssSelector A CSS selector string that uniquely\n     *    identifies an element. Ensure that special characters are properly\n     *    escaped.\n     * @param  {Object} [options] Additional options for rendering the tracks.\n     * @param  {string} [options.speakerId] The speaker's Device ID to use for audio tracks.\n     * @example\n     * // When a Call receives a new track, render it.\n     * client.on('call:tracksAdded', function (params) {\n     *    params.trackIds.forEach(trackId => {\n     *      const track = client.media.getTrackById(trackId)\n     *      const container = track.isLocal ? localContainer : remoteContainer\n\n     *      // Render the Call's new track when it first becomes available.\n     *      client.media.renderTracks([ trackId ], container)\n     *    }\n     * })\n     */\n    async renderTracks(trackIds, cssSelector, options = {}) {\n      log.debug(API_LOG_TAG + 'media.renderTracks: ', trackIds, logCssSelector(cssSelector), options)\n      let retValue\n      try {\n        retValue = await operations.renderTracks(trackIds, cssSelector, options)\n      } catch (error) {\n        emitEvent(eventTypes.TRACK_RENDERED, { trackIds: error.filteredTrackIds, error: error.basicError })\n        return\n      }\n\n      emitEvent(eventTypes.TRACK_RENDERED, retValue)\n    },\n\n    /**\n     * Remove Media Tracks from a container.\n     *\n     * The container is specified by providing a CSS selector string that\n     *    corresponds to the HTMLElement to act as the container.\n     * @public\n     * @static\n     * @memberof media\n     * @method removeTracks\n     * @param  {Array<string>} trackIds List of Track IDs to stop being rendered.\n     * @param  {string} cssSelector A CSS selector string that uniquely\n     *    identifies an element. Ensure that special characters are properly\n     *    escaped.\n     */\n    async removeTracks(trackIds, cssSelector) {\n      log.debug(API_LOG_TAG + 'media.removeTracks: ', trackIds, logCssSelector(cssSelector))\n      await operations.removeTracks(trackIds, cssSelector)\n    },\n\n    /**\n     * Mutes the specified Tracks.\n     *\n     * This API prevents the media of the specified Tracks from being rendered. Audio\n     *     Tracks will become silent and video Tracks will be a black frame.\n     * This does not stop media from being received by those Tracks. The media simply\n     *     cannot be used by the application while the Track is muted.\n     *\n     * If a local Track being sent in a Call is muted, the Track will be\n     *    noticeably muted for the remote user. If a remote Track received in a\n     *    call is muted, the result will only be noticeable locally.\n     *\n     * This mute operation acts on those specified Tracks directly.\n     * It does not act on the active Call as a whole.\n     *\n     * The SDK will emit a {@link media.event:media:muted media:muted} event\n     *    when a Track has been muted.\n     * @public\n     * @static\n     * @memberof media\n     * @method muteTracks\n     * @param  {Array<string>} trackIds List of Track IDs.\n     */\n    async muteTracks(trackIds) {\n      log.debug(API_LOG_TAG + 'media.muteTracks: ', trackIds)\n      let affectedTrackIds\n\n      try {\n        affectedTrackIds = await operations.muteTracks(trackIds)\n      } catch (error) {\n        // TODO: Remove duplication of data in payload of this event\n        emitEvent(eventTypes.TRACKS_MUTED, {\n          trackIds: error.trackIds,\n          tracks: error.trackIds,\n          error: error.basicError\n        })\n        return\n      }\n      // TODO: Remove duplication of data in payload of this event\n      emitEvent(eventTypes.TRACKS_MUTED, { trackIds: affectedTrackIds, tracks: affectedTrackIds })\n    },\n\n    /**\n     * Unmutes the specified Tracks.\n     *\n     * Media will resume its normal rendering for the Tracks.\n     * Like the 'muteTracks' API, this unmute operation acts on those specified Tracks directly.\n     * Therefore it does not act on active Call as a whole.\n     *\n     * The SDK will emit a {@link media.event:media:unmuted media:unmuted} event\n     *    when a Track has been unmuted.\n     * @public\n     * @static\n     * @memberof media\n     * @method unmuteTracks\n     * @param  {Array<string>} trackIds List of Track IDs.\n     */\n    async unmuteTracks(trackIds) {\n      log.debug(API_LOG_TAG + 'media.unmuteTracks: ', trackIds)\n      let affectedTrackIds\n\n      try {\n        affectedTrackIds = await operations.unmuteTracks(trackIds)\n      } catch (error) {\n        // TODO: Remove duplication of data in payload of this event\n        emitEvent(eventTypes.TRACKS_UNMUTED, {\n          trackIds: error.trackIds,\n          tracks: error.trackIds,\n          error: error.basicError\n        })\n        return\n      }\n      // TODO: Remove duplication of data in payload of this event\n      emitEvent(eventTypes.TRACKS_UNMUTED, { trackIds: affectedTrackIds, tracks: affectedTrackIds })\n    }\n  }\n}\n","/**\n * The media devices available for use have changed.\n *\n * Information about the available media devices can be retrieved using the\n *    {@link media.getDevices} API.\n *\n * @public\n * @static\n * @memberof media\n * @event devices:change\n * @example\n * // Listen for changes to available media devices.\n * client.on('devices:change', function () {\n *    // Retrieve the latest media device lists.\n *    const devices = client.media.getDevices()\n * })\n */\nexport const DEVICES_CHANGED = 'devices:change'\n\n/**\n * An error occurred while trying to access media devices.\n *\n * The most common causes of this error are when the browser does not have\n *    permission from the end-user to access the devices, or when the browser\n *    cannot find a media device that fulfills the\n *    {@link call.MediaConstraint MediaConstraint(s)} that was provided.\n *\n * @public\n * @static\n * @memberof media\n * @event devices:error\n * @param {Object} params\n * @param {Error} params.error The Basic error object.\n */\nexport const INITIALIZE_DEVICES_ERROR = 'devices:error'\n\n/**\n * The specified Tracks have been muted.\n *\n * A Track can be muted using the {@link media.muteTracks} API.\n * @public\n * @memberof media\n * @event media:muted\n * @param {Object} params\n * @param {Array<string>} params.tracks The list of Tracks that were muted.\n */\nexport const TRACKS_MUTED = 'media:muted'\n\n/**\n * The specified Tracks have been unmuted.\n *\n * A Track can be unmuted using the {@link media.unmuteTracks}\n *    API.\n * @public\n * @memberof media\n * @event media:unmuted\n * @param {Object} params\n * @param {Array<string>} params.tracks The list of Tracks that were unmuted.\n */\nexport const TRACKS_UNMUTED = 'media:unmuted'\n\n/**\n * The specified Track has had its media source muted.\n *\n * The Track is still active, but is not receiving media any longer. An audio\n *    track will be silent and a video track will be a black frame. It is\n *    possible for the track to start receiving media again (see the\n *    {@link media.event:media:sourceUnmuted media:sourceUnmuted} event).\n *\n * This event is generated outside the control of the SDK. This will predominantly\n *    happen for a remote track during network issues, where media will lose frames\n *    and be \"choppy\". This may also happen for a local track if the browser or\n *    end-user stops allowing the SDK to access the media device, for example.\n * @public\n * @static\n * @memberof media\n * @event media:sourceMuted\n * @param {Object} params\n * @param {string} params.trackId The track that is affected as a result of media source being muted.\n */\nexport const TRACK_SOURCE_MUTED = 'media:sourceMuted'\n\n/**\n * The specified Track has started receiving media from its source once again.\n *\n * The Track returns to the state before it was muted (see the\n *    {@link media.event:media:sourceMuted media:sourceMuted} event), and will\n *    be able to display video or play audio once again.\n *\n * This event is generated outside the control of the SDK, when the cause of the\n *    media source being muted had been undone.\n * @public\n * @static\n * @memberof media\n * @event media:sourceUnmuted\n * @param {Object} params\n * @param {string} params.trackId The track that is affected as a result of media source being unmuted.\n */\nexport const TRACK_SOURCE_UNMUTED = 'media:sourceUnmuted'\n\n/**\n * The specified Track has been rendered into an element.\n *\n * @public\n * @static\n * @memberof media\n * @event media:trackRendered\n * @param {Object} params\n * @param {Array<string>} params.trackIds The list of track id's that were rendered.\n * @param {string} params.selector The css selector used to identify the element the track is rendered into.\n * @param {api.BasicError} [params.error] An error object, if the operation was not successful.\n */\nexport const TRACK_RENDERED = 'media:trackRendered'\n\n/**\n * A local Track has ended unexpectedly. The Track may still be part of a Call but\n *    has become disconnected from its media source and is not recoverable.\n *\n * This event is emitted when an action other than an SDK operation stops the\n *    track. The most comon scenarios are when a device being used for a Call\n *    disconnects, any local tracks (such as audio from a bluetooth headset's\n *    microphone or video from a USB camera) from that device will be ended.\n *    Another scenario is for screensharing, where some browsers provide the\n *    ability to stop screensharing directly rather than through an SDK operation.\n *\n * When a local track ends this way, it will still be part of the Call but will\n *    not have any media. The track can be removed from the call with the\n *    {@link call.removeMedia} API so the remote side of the Call knows the track\n *    has stopped, or the track can be replaced with a new track using the\n *    {@link call.replaceTrack} API to prevent any interruption.\n * @public\n * @static\n * @memberof media\n * @event media:trackEnded\n * @param {Object} params\n * @param {Object} params.trackId The Track that has ended.\n * @param {Object} params.callId The ID of the Call the Track is used in.\n */\nexport const TRACK_ENDED = 'media:trackEnded'\n","import api from './api'\nimport reducer from './reducers'\n\nexport default {\n  name: 'webrtc',\n  api,\n  reducer\n}\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\n/**\n * The devices substate keeps tracks the of the media devices available for use.\n */\nconst reducers = {}\n\n// Replace old devices with newly checked devices.\nreducers[actionTypes.SET_BROWSER_DETAILS] = {\n  next(state, action) {\n    return action.payload\n  }\n}\n\nconst reducer = handleActions(reducers, {})\nexport default reducer\n","// Call plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\n/**\n * The devices substate keeps tracks the of the media devices available for use.\n */\nconst reducers = {}\n\n// Replace old devices with newly checked devices.\nreducers[actionTypes.DEVICES_CHANGE] = {\n  next(state, action) {\n    return action.payload\n  }\n}\n\n// Replace with newly checked devices.\nreducers[actionTypes.INITIALIZE_DEVICES_FINISH] = {\n  next(state, action) {\n    return action.payload\n  }\n}\n\n// The initial state of the reducer.\nconst defaultState = {\n  camera: [],\n  microphone: [],\n  speaker: []\n}\n\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","import devices from './devices'\nimport media from './media'\nimport tracks from './tracks'\nimport sessions from './sessions'\nimport browser from './browser'\n\n/**\n * Webrtc plugin top-level reducer.\n * @method reducer\n * @param  {Object} [state={}]\n * @param  {Object} action\n * @return {Object}\n */\nexport default function (state = {}, action) {\n  return {\n    devices: devices(state.devices, action),\n    tracks: tracks(state.tracks, action),\n    sessions: sessions(state.sessions, action),\n    media: media(state.media, action),\n    browser: browser(state.browser, action)\n  }\n}\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { combineActions, handleActions } from 'redux-actions'\nimport { concat, remove } from 'lodash/fp'\n\n// Top-tier reducers: Handles the whole state.\nconst reducers = {}\n\n// Add the new media object to state.\nreducers[actionTypes.MEDIA_NEW] = {\n  next(state, action) {\n    return concat(state, {\n      ...action.payload\n    })\n  }\n}\n\n// Remove the media object from state.\nreducers[actionTypes.MEDIA_REMOVED] = {\n  next(state, action) {\n    const removeMedia = media => media.id === action.payload.id\n    return remove(removeMedia)(state)\n  }\n}\n\n// Media-tier reducers: Handles only a specific portion of the substate.\nconst mediaReducers = {}\n\nmediaReducers[actionTypes.MEDIA_NEW_TRACK] = {\n  next(state, action) {\n    return {\n      ...state,\n      tracks: concat(state.tracks, [action.payload.trackId])\n    }\n  }\n}\n\n// Remove specified track from media state.\nmediaReducers[actionTypes.MEDIA_TRACK_ENDED] = {\n  next(state, action) {\n    const removeTrack = trackId => trackId === action.payload.trackId\n    return {\n      ...state,\n      tracks: remove(removeTrack, state.tracks)\n    }\n  }\n}\nconst mediaReducer = handleActions(mediaReducers, {})\n\nconst specificMediaActions = combineActions(actionTypes.MEDIA_NEW_TRACK, actionTypes.MEDIA_TRACK_ENDED)\n\nreducers[specificMediaActions] = (state, action) => {\n  return state.map(media => {\n    if (media.id === action.payload.id) {\n      return mediaReducer(media, action)\n    } else {\n      return media\n    }\n  })\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { combineActions, handleActions } from 'redux-actions'\nimport { concat, remove } from 'lodash/fp'\n\nconst reducers = {}\n\nreducers[actionTypes.SESSION_ADDED] = {\n  next(state, action) {\n    return concat(state, action.payload)\n  }\n}\n\nreducers[actionTypes.SESSION_REMOVED] = {\n  next(state, action) {\n    const removeSession = session => session.id === action.payload.id\n    return remove(removeSession)(state)\n  }\n}\n\nconst sessionReducers = {}\n\nsessionReducers[actionTypes.SESSION_NEW_TRACK] = {\n  next(state, action) {\n    if (action.payload.local) {\n      return {\n        ...state,\n        localTracks: state.localTracks.includes(action.payload.trackId)\n          ? state.localTracks\n          : concat(state.localTracks, [action.payload.trackId])\n      }\n    } else {\n      return {\n        ...state,\n        remoteTracks: state.remoteTracks.includes(action.payload.trackId)\n          ? state.remoteTracks\n          : concat(state.remoteTracks, [action.payload.trackId])\n      }\n    }\n  }\n}\n\nsessionReducers[actionTypes.SESSION_TRACK_ENDED] = {\n  next(state, action) {\n    const removeTrack = trackId => trackId === action.payload.trackId\n    if (action.payload.local) {\n      return {\n        ...state,\n        localTracks: remove(removeTrack, state.localTracks)\n      }\n    } else {\n      return {\n        ...state,\n        remoteTracks: remove(removeTrack, state.remoteTracks)\n      }\n    }\n  }\n}\n\nsessionReducers[actionTypes.SESSION_TRACK_REPLACED] = {\n  next(state, action) {\n    // Remove old track id if it still exists\n    const removeTrack = trackId => trackId === action.payload.oldTrackId\n    const newLocalTracks = remove(removeTrack, state.localTracks)\n    // Add new track id if it doesn't exist\n    if (newLocalTracks.indexOf(action.payload.trackId) === -1) {\n      newLocalTracks.push(action.payload.trackId)\n    }\n    return {\n      ...state,\n      localTracks: newLocalTracks\n    }\n  }\n}\n\nconst sessionReducer = handleActions(sessionReducers, {})\n\nconst specificSessionActions = combineActions(\n  actionTypes.SESSION_NEW_TRACK,\n  actionTypes.SESSION_TRACK_ENDED,\n  actionTypes.SESSION_TRACK_REPLACED\n)\n\nreducers[specificSessionActions] = (state, action) => {\n  return state.map(session => {\n    if (session.id === action.payload.id) {\n      return sessionReducer(session, action)\n    } else {\n      return session\n    }\n  })\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","// Webrtc plugin.\nimport * as actionTypes from '../actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\nimport { concat, remove } from 'lodash/fp'\n\nconst reducers = {}\n\n// Add the new Track to state.\nreducers[actionTypes.TRACK_ADDED] = {\n  next(state, action) {\n    return concat(state, action.payload)\n  }\n}\n\n/*\n  Bad Workaround: Don't remove the Track information from state when it is\n    removed. Instead, just mark it as \"ended\".\n\n  When a track is removed from a Call, the application only gets the trackId. If\n    they try to get the track with that ID, it will not exist in state. This means\n    the application cannot unrender the track if they rely on the Track state\n    (eg. isLocal or media kind).\n\n  A better alternative would be to remove the Track from state when the Call it\n    is used for ends. That would allow the \"call:tracksRemoved\" event access to\n    the state before they were removed so it could include that information\n    (instead of the app needing to re-get it).\n  That does not work, though, because this reducer does not have access to the Call\n    state (meaning we can't figure out which Session was used for the Call to figure\n    out which Tracks were in that Session...) and the \"end call\" action itself doesn't\n    have the information needed either.\n\n  So leave it in state instead to make sure the application can access it. This\n    should be fixed when the Callstack and WebrtcStack work together better instead\n    of the WebrtcStack just emitting all events as soon as something changes at the\n    lower-level WebRTC.\n*/\nreducers[actionTypes.TRACK_REMOVED] = {\n  next(state, action) {\n    return state.map(track => {\n      if (action.payload.trackId === track.trackId) {\n        return {\n          ...track,\n          state: 'ended'\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n// Store the selector used for rendering the track.\nreducers[actionTypes.RENDER_TRACKS_FINISH] = {\n  next(state, action) {\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          containers: concat(track.containers, action.payload.selector)\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n// Remove the selector used for rendering the track.\nreducers[actionTypes.REMOVE_TRACKS_FINISH] = {\n  next(state, action) {\n    // TODO: Only remove one container (instead of all that match)?\n    const removeContainer = container => container === action.payload.selector\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          containers: remove(removeContainer)(track.containers)\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n// TODO: Update this on an action from the track channel?\nreducers[actionTypes.MUTE_TRACKS_FINISH] = {\n  next(state, action) {\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          muted: true\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\nreducers[actionTypes.UNMUTE_TRACKS_FINISH] = {\n  next(state, action) {\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          muted: false\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\nreducers[actionTypes.TRACK_SOURCE_MUTED] = {\n  next(state, action) {\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          sourceMuted: true\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\nreducers[actionTypes.TRACK_SOURCE_UNMUTED] = {\n  next(state, action) {\n    return state.map(track => {\n      if (action.payload.trackIds.includes(track.trackId)) {\n        return {\n          ...track,\n          sourceMuted: false\n        }\n      } else {\n        return track\n      }\n    })\n  }\n}\n\n/*\n * Combine all of top-tier reducers into a single reducer,\n *      each with a default state of an empty array.\n */\nconst reducer = handleActions(reducers, [])\nexport default reducer\n","/**\n * Retrieves media devices available on the system.\n * @method getDevices\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getDevices(state) {\n  return state.webrtc.devices\n}\n\n/**\n * Session selectors.\n */\nexport function getSessions(state) {\n  return state.webrtc.sessions\n}\n\nexport function getSessionById(state, sessionId) {\n  return getSessions(state).find(session => session.id === sessionId)\n}\n\n/**\n * Track selectors.\n */\nexport function getTracks(state) {\n  return state.webrtc.tracks\n}\n\nexport function getTrackById(state, trackId) {\n  return getTracks(state).find(track => track.trackId === trackId)\n}\n\n/**\n * Media selectors.\n * Handles retrieving data from the `state.webrtc.media` substate.\n */\n\n/**\n * Get the list of all media this session.\n * @method getMedia\n * @param  {Object} state Redux state.\n * @return {Array} A list of all media objects.\n */\nexport function getMedia(state) {\n  return state.webrtc.media\n}\n\n/**\n * Get a specific media object.\n * @method getMediaById\n * @param  {Object} state Redux state.\n * @param  {string} mediaId The media to retrieve.\n * @return {Object} A media object.\n */\nexport function getMediaById(state, mediaId) {\n  return getMedia(state).find(media => media.id === mediaId)\n}\n\n/**\n * Retrieves information about the browser.\n * @method getBrowserDetails\n * @param  {Object} state Redux state.\n * @return {Object}\n */\nexport function getBrowserDetails(state) {\n  return state.webrtc.browser\n}\n","import { LEVELS_CHANGE, HANDLERS_CHANGE } from '../logs/interface/actionTypes'\n\n/**\n * WebRTC middleware factory function.\n * @method createMiddleware\n * @param {Object} context The factory context.\n * @return {Function} A redux middleware.\n */\nexport default function createMiddleware(context) {\n  const logOperations = context.container.WebRTCLogOperations\n  /**\n   * Redux middleware: Watch for specific actions and trigger operations\n   *   when we see them.\n   */\n  return next => action => {\n    /**\n     * Let the action happen as it is received.\n     *\n     * The WebRTC middleware operations are not side-effects, they are\n     *   relevant to the operation being performed. As such they can\n     *   happen when necessary without waiting for other operations.\n     */\n\n    // WebRTC doesn't act on any other actions.\n    if (action.type === LEVELS_CHANGE) {\n      // When an action to change log levels is dispatched, WebRTC plugin should deal with it\n      logOperations.updateLogLevel(action)\n    }\n\n    if (action.type === HANDLERS_CHANGE) {\n      // When an action to change log handlers is dispatched, WebRTC plugin should deal with it\n      logOperations.updateLogHandler(action)\n    }\n\n    return next(action)\n  }\n}\n","/**\n * WebRTC Log Operations factory function.\n * @method createLogOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for WebRTC logs.\n */\nexport default function createLogOperations(container) {\n  const { WebRTC } = container\n  const webrtcLogManager = WebRTC.logs\n\n  /**\n   * Functionality operation for \"update webrtc log level\" actions.\n   * @method updateLogLevel\n   * @param  {Object} action A \"log level change\" action.\n   */\n  async function updateLogLevel(action) {\n    // If the WebRTC log level was changed, update the WebRTC stack's loggers.\n    if (action.payload.WEBRTC) {\n      await webrtcLogManager.setLevel(action.payload.WEBRTC)\n      const loggers = await webrtcLogManager.getLoggers()\n\n      loggers.map(logger => logger.setLevel(action.payload.WEBRTC))\n    }\n  }\n\n  /**\n   * Functionality operation for \"update webrtc log handler\" actions.\n   * @method updateLogHandler\n   * @param  {Object} action A \"log handler change\" action.\n   */\n  async function updateLogHandler(action) {\n    // If the WebRTC log handler was changed, update the WebRTC stack's loggers.\n    if (action.payload.WEBRTC) {\n      await webrtcLogManager.setHandler(action.payload.WEBRTC)\n      const loggers = await webrtcLogManager.getLoggers()\n\n      loggers.map(logger => logger.setHandler(action.payload.WEBRTC))\n    }\n  }\n\n  return {\n    // Operations\n    updateLogLevel,\n    updateLogHandler\n  }\n}\n","// Webrtc plugin.\nimport { trackActions, deviceActions } from '../interface/actions'\n\n// Other plugins.\nimport BasicError, { webrtcCodes, callCodes } from '../../errors'\nimport { logCssSelector } from '../../common/utils'\n\n// Libraries.\nimport { isUndefined, isString } from 'lodash/fp'\n\n/**\n * WebRTC Media Operations factory function.\n * @method createMediaOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for WebRTC Media.\n */\nexport default function createMediaOperations(container) {\n  const { WebRTC, context, logManager } = container\n  const log = logManager.getLogger('MEDIA')\n\n  /**\n   * Create local Media object(s).\n   * The underlying WebRTC APIs used are getUserMedia and getDisplayMedia.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n   *    for more information.\n   * @method createLocal\n   * @async\n   * @param  {Object} mediaConstraints Collection of constraints for each media type.\n   * @param  {MediaStreamConstraints} mediaConstraints.audio Native media contraints for audio.\n   * @param  {MediaStreamConstraints} mediaConstraints.video Native media constraints for video.\n   * @param  {MediaStreamConstraints} mediaConstraints.screen Native media constraints for display (screen).\n   * @param {boolean} detached Specifies if the track is detached and can be used with or without a call.\n   * @return {Array<Object>} List of objects containing the media type and the media itself.\n   * @throws {BasicError} Throws a USER_MEDIA_ERROR error if any any other media type other than audio, video or screen is passed in mediaConstraints.\n   * @throws {BasicError} Throws a USER_MEDIA_ERROR error if provided constraints cannot be fulfilled.\n   * @throws {BasicError} Throws a USER_MEDIA_ERROR error if it fails to get media for other reasons.\n   */\n  async function createLocal(mediaConstraints, detached = false) {\n    log.debug('Getting media with constraints: ', mediaConstraints)\n\n    // Only allow media types 'audio', 'video', and 'screen'\n    if (\n      !mediaConstraints ||\n      !Object.keys(mediaConstraints).every(mediaType => ['audio', 'video', 'screen', 'medias'].includes(mediaType))\n    ) {\n      throw new BasicError({\n        code: callCodes.USER_MEDIA_ERROR,\n        message: `mediaConstraints must be an object containing at least one of the following media types (and only these types): 'audio', 'video', and 'screen'`\n      })\n    }\n\n    const medias = []\n\n    try {\n      if (mediaConstraints.screen) {\n        const screenShareConstraints = {\n          video: mediaConstraints.screen\n        }\n        const screenShareMedia = await WebRTC.media.createLocalScreen(screenShareConstraints, detached)\n        medias.push({\n          type: 'screen',\n          media: screenShareMedia\n        })\n      }\n\n      if (mediaConstraints.audio) {\n        const audioConstraints = {\n          audio: mediaConstraints.audio\n        }\n        const audioMedia = await WebRTC.media.createLocal(audioConstraints, detached)\n        medias.push({\n          type: 'audio',\n          media: audioMedia\n        })\n      }\n\n      if (mediaConstraints.video) {\n        const videoConstraints = {\n          video: mediaConstraints.video\n        }\n        const videoMedia = await WebRTC.media.createLocal(videoConstraints, detached)\n\n        medias.push({\n          type: 'video',\n          media: videoMedia\n        })\n      }\n    } catch (err) {\n      let errMessage\n      if (err.name === 'OverconstrainedError') {\n        errMessage = `Failed to get media due to constraint: ${err.constraint}.`\n      } else {\n        errMessage = `Failed to get media => Name: ${err.name}; Error Message :${err.message}.`\n      }\n\n      log.info(errMessage)\n\n      // Clean up successful media object when there is partial media failure.\n      for (const eachMedia of medias) {\n        await eachMedia.media.stop()\n      }\n\n      const errorObj = new BasicError({\n        message: errMessage,\n        code: callCodes.USER_MEDIA_ERROR\n      })\n      throw errorObj\n    }\n\n    return medias\n  }\n\n  /**\n   * Get local media.\n   * @method getLocalMedia\n   * @return {Promise} Resolves to a list of objects containing the media type and the media itself.\n   */\n  async function getLocalMedia() {\n    log.debug('Getting local media')\n\n    const mediaIds = await WebRTC.media.getAll()\n\n    const detachedMedias = []\n    for (const mediaId of mediaIds) {\n      const media = await WebRTC.media.get(mediaId)\n      if (media) {\n        const tracks = await media.getTracks()\n        for (const track of tracks) {\n          const trackState = await track.getState()\n          if (trackState.detached) {\n            detachedMedias.push({ type: trackState.type, media })\n            break\n          }\n        }\n      }\n    }\n    return detachedMedias\n  }\n\n  /**\n   * Dispose local media.\n   * @method disposeLocalMedia\n   * @param {string} trackId A track identifier to dispose of from media.\n   * @throws {BasicError} An error indicating that trackId must be defined.\n   * @throws {BasicError} An error indicating that the track that is to be disposed is in use by a session.\n   * @throws {BasicError} An error indicating that the track that is to be disposed was not created locally.\n   */\n  async function disposeLocalMedia(trackId) {\n    const { dispatch } = context\n\n    if (!trackId) {\n      throw new BasicError({\n        message: 'Track id is `undefined`. You must pass an existing track id to dispose of the associated track.',\n        code: webrtcCodes.INVALID_PARAM\n      })\n    }\n\n    let disposedTrack = await WebRTC.track.get(trackId)\n\n    if (!disposedTrack) {\n      throw new BasicError({\n        message: `Either ${trackId} is not a valid track id type or track does not exist.`,\n        code: webrtcCodes.INVALID_TRACK_ID\n      })\n    }\n\n    // Check if the track is in use by a session\n    const sessions = await WebRTC.sessionManager.getAll()\n\n    sessions.forEach(session => {\n      const tracks = session.localTracks\n      // throw an error if the track is in use by a session\n      if (tracks.find(track => track.id === trackId)) {\n        throw new BasicError({\n          message: `Can't dispose track: ${trackId}. It's in use by session: ${session.id}`,\n          code: webrtcCodes.TRACK_IN_USE\n        })\n      }\n    })\n\n    if (disposedTrack) {\n      const detached = await disposedTrack.isDetached()\n      if (detached) {\n        await disposedTrack.stop()\n      } else {\n        throw new BasicError({\n          message: `Can't dispose track: ${trackId}. Track was not created locally.`,\n          code: webrtcCodes.TRACK_NOT_LOCAL\n        })\n      }\n    }\n\n    // Update the track in state to 'ended'\n    dispatch(trackActions.trackRemoved(trackId))\n  }\n\n  /**\n   * Render Tracks in a specified container.\n   * @method renderTracks\n   * @param  {Array} trackIds A list of track IDs.\n   * @param  {Object} selector A CSS selector string that uniquely identifies an element.\n   * @param  {Object} [options] Additional options for rendering the tracks.\n   * @param  {string} [options.speakerId] The speaker's Device ID to use for audio tracks.\n   */\n  async function renderTracks(trackIds, selector, options) {\n    const { dispatch } = context\n    // Dispatch the associated action for backwards-compatibility\n    dispatch(\n      trackActions.renderTracks(trackIds, {\n        selector,\n        ...options\n      })\n    )\n\n    // Get the tracks that are to be rendered.\n    const tracks = await WebRTC.track.getTracks(trackIds)\n    const filteredTracks = tracks.filter(track => !isUndefined(track))\n    let payload = {}\n\n    // Each of trackIds, selector and speakerId must be present in order to render a track\n    if (\n      trackIds &&\n      // trackIds is an array\n      trackIds instanceof Array &&\n      // trackIds is not empty\n      trackIds.length > 0 &&\n      // selector is not empty\n      selector &&\n      // selector is a string or a DOM element\n      // (note: We can't use instanceof here since elements part of another window are not of the same instance as window.Element)\n      (isString(selector) || 'tagName' in selector)\n    ) {\n      log.info(`Rendering track(s) in element ${logCssSelector(selector)}.`, trackIds)\n\n      // Render the tracks.\n      await Promise.all(\n        filteredTracks.map(async track => {\n          await WebRTC.renderer.renderTrack(track, selector, options.speakerId)\n        })\n      )\n\n      log.info(\n        'Finished rendering track(s).',\n        filteredTracks.map(track => track.id)\n      )\n\n      payload = { selector }\n    } else {\n      const message = 'Failed to render tracks. One of trackIds or cssSelector is missing from request.'\n\n      log.info(\n        message,\n        filteredTracks.map(track => track.id)\n      )\n\n      payload.error = new BasicError({\n        message,\n        code: webrtcCodes.INVALID_PARAM\n      })\n\n      // Include the filtered track IDs in the error to ensure complete backwards compability with the event that is emitted\n      // Since the error event also includes only the filtered track ids\n      const error = {\n        basicError: payload.error,\n        filteredTrackIds: filteredTracks.map(track => track.id)\n      }\n\n      // Report operation done.\n      dispatch(\n        trackActions.renderTracksFinish(\n          filteredTracks.map(track => track.id),\n          payload\n        )\n      )\n\n      throw error\n    }\n\n    // Report operation done.\n    dispatch(\n      trackActions.renderTracksFinish(\n        filteredTracks.map(track => track.id),\n        payload\n      )\n    )\n\n    return {\n      trackIds: filteredTracks.map(track => track.id),\n      selector\n    }\n  }\n\n  /**\n   * Stop Tracks from being rendered in a specified container.\n   * @method removeTracks\n   * @param  {Array} trackIds A list of track IDs.\n   * @param  {Object} selector A CSS selector string that uniquely identifies an element.\n   */\n  async function removeTracks(trackIds, selector) {\n    const { dispatch } = context\n    // Dispatch the associated action for backwards-compatibility\n    dispatch(trackActions.removeTracks(trackIds, { selector }))\n\n    log.info(`Removing track(s) from element ${logCssSelector(selector)}.`, trackIds)\n\n    // Remove the tracks.\n    await Promise.all(\n      trackIds.map(async id => {\n        await WebRTC.renderer.unrenderTrack(id, selector)\n      })\n    )\n\n    log.info('Finished removing track(s).', trackIds)\n\n    // Report operation done.\n    dispatch(trackActions.removeTracksFinish(trackIds, { selector }))\n  }\n\n  /**\n   * Mute certain tracks.\n   * @method muteTracks\n   * @param  {Array} trackIds A list of track IDs.\n   * @return {Array} The list of track IDs which were muted.\n   */\n  async function muteTracks(trackIds) {\n    const { dispatch } = context\n    // Dispatch the associated action for backwards-compatibility\n    dispatch(trackActions.muteTracks(trackIds))\n\n    log.info('Muting track(s).', trackIds)\n\n    if (\n      trackIds &&\n      // trackIds is an array\n      trackIds instanceof Array &&\n      // trackIds is not empty\n      trackIds.length > 0\n    ) {\n      // Get the tracks that are to be muted.\n      const allTracks = await WebRTC.track.getTracks()\n      const tracks = allTracks.filter(track => trackIds.includes(track.id))\n\n      // Mute the tracks\n      Promise.all(tracks.map(track => track.mute()))\n\n      const affectedTrackIds = tracks.map(track => track.id)\n      log.info('Finished muting track(s).', affectedTrackIds)\n\n      // Report operation done.\n      dispatch(trackActions.muteTracksFinish(affectedTrackIds))\n      return affectedTrackIds\n    } else {\n      const message = 'Failed to mute tracks. trackIds is missing (or empty) from request.'\n\n      log.info(message, trackIds)\n\n      const payload = {}\n      payload.error = new BasicError({\n        message,\n        code: webrtcCodes.INVALID_PARAM\n      })\n\n      // Report operation done, but with a failure.\n      dispatch(trackActions.muteTracksFinish(trackIds, payload))\n\n      const error = {\n        basicError: payload.error,\n        trackIds\n      }\n      throw error\n    }\n  }\n\n  /**\n   * Unmute certain tracks.\n   * @method unmuteTracks\n   * @param  {Array} trackIds A list of track IDs.\n   * @return {Array} The list of track IDs which were unmuted.\n   */\n  async function unmuteTracks(trackIds) {\n    const { dispatch } = context\n    // Dispatch the associated action for backwards-compatibility\n    dispatch(trackActions.unmuteTracks(trackIds))\n\n    log.info('Unmuting track(s).', trackIds)\n\n    if (\n      trackIds &&\n      // trackIds is an array\n      trackIds instanceof Array &&\n      // trackIds is not empty\n      trackIds.length > 0\n    ) {\n      // Get the tracks that are to be unmuted.\n      const allTracks = await WebRTC.track.getTracks()\n      const tracks = allTracks.filter(track => trackIds.includes(track.id))\n\n      // Unmute the tracks\n      Promise.all(tracks.map(track => track.unmute()))\n\n      const affectedTrackIds = tracks.map(track => track.id)\n      log.info('Finished unmuting track(s).', affectedTrackIds)\n\n      // Report operation done.\n      dispatch(trackActions.unmuteTracksFinish(affectedTrackIds))\n      return affectedTrackIds\n    } else {\n      const message = 'Failed to unmute tracks. trackIds is missing (or empty) from request.'\n\n      log.info(message, trackIds)\n\n      const payload = {}\n      payload.error = new BasicError({\n        message,\n        code: webrtcCodes.INVALID_PARAM\n      })\n\n      // Report operation done, but with a failure.\n      dispatch(trackActions.unmuteTracksFinish(trackIds, payload))\n\n      const error = {\n        basicError: payload.error,\n        trackIds\n      }\n      throw error\n    }\n  }\n\n  /**\n   * Initialize the media devices.\n   * @method initializeDevices\n   * @param  {Oject} browserConstraints The media constraints\n   */\n  async function initializeDevices(browserConstraints) {\n    const { dispatch } = context\n    // Dispatch the associated action for backwards-compatibility\n    dispatch(deviceActions.initializeDevice(browserConstraints))\n\n    try {\n      // 'browserConstraints' param is optional, so no need to up front validation\n      const devices = await WebRTC.devices.setupDeviceInitialization(browserConstraints)\n      if (devices.error) {\n        // Throw this error (we'll catch it below)\n        throw devices\n      } else {\n        log.info('Successfully initialized devices.', devices)\n\n        // Dispatch the associated action for backwards-compatibility\n        dispatch(deviceActions.initializeDeviceFinish({ devices }))\n      }\n    } catch (error) {\n      log.info(`Encountered error while initializing devices: ${error.message}.`)\n\n      // Dispatch the associated action for backwards-compatibility\n      dispatch(deviceActions.initializeDeviceFinish({ error }))\n      throw error\n    }\n  }\n\n  return {\n    createLocal,\n    getLocalMedia,\n    disposeLocalMedia,\n    renderTracks,\n    removeTracks,\n    muteTracks,\n    unmuteTracks,\n    initializeDevices\n  }\n}\n","import { isPlainObject } from 'lodash/fp'\nimport { devicesChanged } from '../interface/actions/devices'\nimport { DEVICES_CHANGED } from '../interface/eventTypes'\n\n/**\n * WebRTC Operations factory function.\n * @method createWebRTCOperations\n * @param  {Object} container The bottle container.\n * @return {Object} Available operations for WebRTC Media.\n */\nexport default function createWebRTCOperations(container) {\n  const { logManager, WebRTC, emitEvent, context } = container\n  const log = logManager.getLogger('WEBRTC')\n\n  const replacedManagers = {}\n  const addedManagerEventHandlers = {}\n\n  /**\n   * Operation to setup provided proxies on the WebRTC Stack.\n   * @method setupProxies\n   * @param {Object} proxies The provided WebRTC functionality proxies.\n   * @throws {Error} An error if the operation fails.\n   */\n  function setupProxies(proxies) {\n    log.info('Setting up external proxies in WebRTC.')\n\n    // Set proxy methods in WebRTC\n    if (isPlainObject(proxies)) {\n      WebRTC.webrtcManager.setProxies(proxies)\n    }\n\n    // Replace managers with any provided managers\n    if (proxies.managers) {\n      Object.keys(proxies.managers).forEach(manager => {\n        // Store the original manager in order to be able to revert later.\n        // Make sure we don't get rid of the original manager if the manager is already replaced.\n        if (!(manager in replacedManagers)) {\n          replacedManagers[manager] = WebRTC[manager]\n        }\n        // Replace the original manager with the new one.\n        WebRTC[manager] = proxies.managers[manager]\n        log.debug(`Replaced WebRTC ${manager} manager with proxy version.`)\n      })\n    }\n\n    // Setup additional event handlers for any managers\n    if (proxies.managerEventHandlers) {\n      Object.keys(proxies.managerEventHandlers).forEach(manager => {\n        if (manager in WebRTC) {\n          proxies.managerEventHandlers[manager].forEach(handler => {\n            WebRTC[manager].on(handler.eventName, handler.eventFn)\n            log.debug(`Added new '${handler.eventName}' event handler on ${manager} manager.`)\n          })\n          // Store these as added event handlers in order to be able to revert later.\n          addedManagerEventHandlers[manager] = proxies.managerEventHandlers[manager]\n        } else {\n          log.debug(`Provided '${manager}' manager is not a WebRTC manager, skipping event handler proxies.`)\n        }\n      })\n    }\n\n    log.info('Successfully set up external proxies in WebRTC.')\n  }\n\n  /**\n   * Operation to teardown proxies set on the WebRTC Stack.\n   * @method teardownProxies\n   * @throws {Error} An error if the operation fails.\n   */\n  async function teardownProxies() {\n    log.info('Tearing down all external proxies in WebRTC.')\n\n    // Pass in empty proxies to the following function so that it will set empty proxies\n    // in WebRTC causing current WebRTC functionality not to be overriden anymore.\n    WebRTC.webrtcManager.setProxies({ peer: {} })\n\n    // Revert any previously replaced managers to the original ones.\n    Object.keys(replacedManagers).forEach(manager => {\n      WebRTC[manager] = replacedManagers[manager]\n      // Delete the manager from the replacedManagers since it has now been reverted.\n      delete replacedManagers[manager]\n      log.debug(`Reverted WebRTC ${manager} manager to original version.`)\n    })\n\n    // Remove all additional event handlers set on the managers.\n    Object.keys(addedManagerEventHandlers).forEach(manager => {\n      addedManagerEventHandlers[manager].forEach(handler => {\n        WebRTC[manager].off(handler.eventName, handler.eventFn)\n        log.debug(`Removed added '${handler.eventName}' event handler from ${manager} manager.`)\n      })\n      delete addedManagerEventHandlers[manager]\n    })\n\n    log.info('Successfully tore down proxies in WebRTC.')\n\n    log.info('Updating devices after teardown.')\n    const devices = await WebRTC.devices.checkDevices()\n    context.dispatch(devicesChanged(devices))\n    // Emit the event so the application knows that devices have changed.\n    emitEvent(DEVICES_CHANGED, {})\n  }\n\n  return {\n    setupProxies,\n    teardownProxies\n  }\n}\n","// Other plugins.\nimport { logManager } from '../logs'\nconst log = logManager.getLogger('CHANNEL')\n\n/**\n * Converts a channel's send and receive to serialize messages in JSON before sending and after receiving.\n *\n * @param {Object} innerChannel The channel to convert\n */\nexport function jsonChannel(innerChannel) {\n  const jsonChannel = {\n    receive: undefined,\n    send(message) {\n      try {\n        innerChannel.send(JSON.stringify(message))\n      } catch (err) {\n        log.error('Failed to send JSON message over channel: ', err)\n      }\n    }\n  }\n\n  innerChannel.receive = function receiveJSONMessage(message) {\n    try {\n      if (jsonChannel.receive) {\n        jsonChannel.receive(JSON.parse(message))\n      }\n    } catch (err) {\n      log.error('Failed to receive JSON message on channel: ', err)\n    }\n  }\n\n  return jsonChannel\n}\n\n/**\n * Converts a channel with only `send` and `receive` functionality into one that\n *    also has `reply` functionality.\n * This is required by the Proxy Plugin to convert asynchronous code into\n *    synchronous code. The Proxy needs to return a value synchronously when\n *    sending data over the channel.\n * @method replyChannel\n * @param  {Object} channel\n * @return {Object} The same channel, but with a `reply` method as well.\n */\nexport function replyChannel(channel) {\n  /**\n   * Track sent messages by their ID.\n   * @type {Object}\n   */\n  const sentMessages = {}\n\n  channel.receive = function receiveMessage(message) {\n    const { messageId, data } = message\n\n    // Determine how the message needs to be handled.\n    if (messageId && sentMessages[messageId]) {\n      if (sentMessages[messageId].isExpired) {\n        // If the reply came after the time-out, ignore the message.\n        log.debug(`Received reply from timed-out message ${messageId}. Ignoring.`)\n        delete sentMessages[messageId]\n      } else {\n        // If the message has an ID from a sent message, then it is a reply to\n        //    that message. Resolve the promise associated with it.\n        log.debug(`Received reply from message ${messageId}.`)\n        sentMessages[messageId].resolve(data)\n      }\n    } else if (messageId && !sentMessages[messageId]) {\n      // If the message has an ID that we don't know about, then the application\n      //    will need to handle it.\n      if (api.receive) {\n        log.debug(`Received new message ${messageId}.`)\n        api.receive(messageId, data)\n      } else {\n        log.error('No listener set for handling received messages.', data)\n      }\n    } else {\n      // If the message didn't have an ID, then it wasn't from our test channel.\n      log.warn('Received message without an ID on the channel; ignoring.', message)\n    }\n  }\n\n  /*\n   * The interface that the Proxy Plugin will use.\n   */\n  const api = {}\n\n  /**\n   * Send a message over the channel.\n   * @method send\n   * @param {string} messageId A unique ID to track the sent message.\n   * @param {Object} data\n   * @param {Function} [callback] Function called when a reply is received.\n   */\n  api.send = (messageId, data, callback) => {\n    if (sentMessages[messageId]) {\n      // The ID has already been used for sending a message.\n      callback(null, new Error('Cannot send message; ID already used.'))\n      return\n    }\n\n    // Attach a messageId to the message.\n    // This lets the remote side reply to this message by using the messageId.\n    const message = {\n      data,\n      messageId\n    }\n\n    if (callback) {\n      // If there is a callback function, then a reply is expected.\n      // Wrap `send` is a promise so that we can correlate receiving a reply\n      //    to the callback.\n      new Promise(resolve => {\n        // Race receiving the reply against a time-out.\n        // 12s was chosen to be slightly longer than a valid WebRTC operation\n        //    timeout (collecting ICE candidates can take 10s).\n        const timeoutId = setTimeout(() => {\n          log.debug(`Message ${messageId} timed-out. Failing operation.`)\n          sentMessages[messageId].isExpired = true\n          callback(null, new Error('Operation timed-out; no reply from other side of channel.'))\n        }, 12000)\n\n        // Store `resolve` so we can call it call it when we receive a reply.\n        sentMessages[messageId] = {\n          resolve,\n          timeoutId,\n          isExpired: false\n        }\n\n        // Send the message over the channel.\n        log.debug(`Sending new message ${messageId} with reply expected.`)\n        channel.send(message)\n      }).then(data => {\n        // The message received a reply, so remove the reference.\n        clearTimeout(sentMessages[messageId].timeoutId)\n        delete sentMessages[messageId]\n\n        if (typeof callback === 'function') {\n          callback(data)\n        }\n      })\n    } else {\n      // Send the message over the channel.\n      log.debug(`Sending new message ${messageId}.`)\n      channel.send(message)\n    }\n  }\n\n  /**\n   * Listener for receiving a message from the channel.\n   * @method receive\n   * @param {string} messageId\n   * @param {Object} data\n   */\n  // eslint-disable-next-line\n  api.receive = undefined\n\n  /**\n   * Send a reply to a specific received message over the channel.\n   * @method reply\n   * @param {string} messageId\n   * @param {Object} data\n   */\n  api.reply = (messageId, data) => {\n    // Attach the messageId to the message.\n    const message = {\n      data,\n      messageId\n    }\n\n    log.debug(`Replying to message ${messageId}.`)\n    channel.send(message)\n  }\n\n  return api\n}\n","// Proxy Plugin.\nimport pluginInterface from './interface'\nimport initializeProxy from './proxyStack'\n\nimport { logManager } from '../logs'\n\n// Libraries.\nimport initialize, { getWebRTCSupportCapabilities } from 'kandy-webrtc'\nimport { isFunction } from 'lodash/fp'\nimport createOperations from './operations'\nimport createAPI from './interface/api'\n\nconst log = logManager.getLogger('PROXY')\n\n/**\n * Proxy Plugin factory.\n * The Proxy Plugin is responsible for setting up the webRTC /\n *    Media Proxy within the SDK. This includes replacing the\n *    webRTC stack with a Proxy stack, providing an interface\n *    for an application to configure the Proxy stack, and,\n *    in general, bringing all of the Proxy components together.\n * @method proxyFactory\n * @return {Object} Plugin components.\n */\nexport default function proxyFactory(bottle) {\n  // If WebRTC is not supported, don't set up the Proxy plugin.\n  const { mediaDevices, peerConnection } = getWebRTCSupportCapabilities()\n  if (!mediaDevices || !peerConnection) {\n    log.warn(\n      'Calls are not supported on this platform due to lack of WebRTC support. Proxy APIs will not be available.'\n    )\n    return\n  }\n\n  bottle.factory('ProxyApi', createAPI)\n  bottle.factory('ProxyOperations', createOperations)\n\n  // Replace the WebrtcStack provided as a component to the bottle by the ProxyStack.\n  bottle.decorator('WebRTC', function (webRTC) {\n    /*\n     * Bad workaround; required because of KJS-77.\n     * The Proxy plugin will initialize its own Webrtc-stack, which means there are two of them.\n     *    The original one from the webrtc plugin won't be used, but we still need to disable\n     *    it listening for \"device changed\" events on the browser.\n     */\n    webRTC.devices.setListening(false)\n\n    // Return the portion of the ProxyStack that is identical to the Webrtc-Stack.\n    return proxy.managers\n  })\n\n  // Register a function to check browser info after SDK initialization has finished.\n  bottle.defer(initProxy)\n\n  const capabilities = ['mediaProxy']\n\n  // Initialize a real webRTC stack.\n  const webRTC = initialize()\n  // Initialize the Proxy stack. The real webRTC stack is needed for\n  //    when proxy-mode is disabled.\n  const proxy = initializeProxy(webRTC)\n  bottle.value('ProxyStack', proxy)\n\n  function initProxy(container) {\n    const { ProxyStack, logManager } = container\n    const log = logManager.getLogger('PROXY')\n\n    // Make sure that webRTC is the Proxy Stack.\n    if (!ProxyStack.setProxyMode || !isFunction(ProxyStack.setProxyMode)) {\n      log.error('Cannot setup Proxy Plugin: Proxy Stack not found.')\n    }\n  }\n\n  return {\n    name: pluginInterface.name,\n    reducer: pluginInterface.reducer,\n    initProxy,\n    capabilities\n  }\n}\n","const PREFIX = '@@KANDY/PROXY/'\n\nexport const SET_MODE = PREFIX + 'SET_MODE'\nexport const SET_MODE_FINISH = PREFIX + 'SET_MODE_FINISH'\n\nexport const SET_CHANNEL = PREFIX + 'SET_CHANNEL'\nexport const SET_CHANNEL_FINISH = PREFIX + 'SET_CHANNEL_FINISH'\n\nexport const INITIALIZE = PREFIX + 'INITIALIZE'\nexport const INITIALIZE_FINISH = PREFIX + 'INITIALIZE_FINISH'\n","import * as actionTypes from './actionTypes'\n\nfunction actionHelper(type, payload = {}) {\n  const action = {\n    type,\n    payload: {\n      ...payload\n    }\n  }\n\n  if (payload.error) {\n    action.error = true\n  }\n\n  return action\n}\n\nexport function setProxyMode(value) {\n  return actionHelper(actionTypes.SET_MODE, { value })\n}\n\nexport function setProxyModeFinish({ error, value }) {\n  return actionHelper(actionTypes.SET_MODE_FINISH, { error, value })\n}\n\nexport function setChannel(channel) {\n  return actionHelper(actionTypes.SET_CHANNEL, { channel })\n}\n\nexport function setChannelFinish({ error }) {\n  return actionHelper(actionTypes.SET_CHANNEL_FINISH, { error })\n}\n\nexport function initializeRemote(config) {\n  return actionHelper(actionTypes.INITIALIZE, { config })\n}\n\nexport function initializeRemoteFinish({ error, browser }) {\n  return actionHelper(actionTypes.INITIALIZE_FINISH, { error, browser })\n}\n","/**\n * The 'proxy' namespace allows for a secondary mode for making calls: proxy mode.\n * When proxy mode is enabled, the SDK will redirect webRTC / media operations from the current machine to a remote machine using a channel.\n *\n * This is an advanced feature that enables support for Calls in particular scenarios that would otherwise not support them.\n *\n * @public\n * @namespace proxy\n */\n\n/**\n * The Channel object that the Proxy module needs to be provided.\n *\n * @public\n * @static\n * @typedef {Object} Channel\n * @memberof proxy\n * @example\n * // The channel the application uses for communicating with a remote endpoint.\n * const appChannel = ...\n *\n * // The channel the application will provide to the Proxy module for use.\n * const channel = {\n *    send: function (data) {\n *      // Any encoding / wrapping needed for a Proxy message being sent\n *      //    over the channel.\n *      appChannel.sendMessage(data)\n *    },\n *    // The Proxy module will set this function.\n *    receive: undefined\n * }\n * appChannel.on('message', data => {\n *    // Any decoding / unwrapping needed for the received message.\n *    channel.receive(data)\n * })\n *\n * client.proxy.setChannel(channel)\n */\n\n/**\n * Channel function that the Proxy module will use to send messages to the remote side.\n * @public\n * @memberof proxy.Channel\n * @name send\n * @function\n * @param {Object} data Message to be sent over the channel.\n */\n\n/**\n * API that the Proxy module will assign a listener function for accepting received messages.\n * This function should receive all messages sent from the remote side of the channel.\n * @public\n * @memberof proxy.Channel\n * @name receive\n * @function\n * @param {Object} data The message received from the Channel.\n */\n\n// Proxy plugin.\nimport { getProxyState } from './selectors'\nimport * as eventTypes from '../interface/eventTypes'\n\n/**\n * Proxy API factory function.\n * @method createAPI\n * @param {Object} container The bottle container.\n * @returns {Object} Available public APIs for Proxy.\n */\nexport default function createAPI(container) {\n  const { context, emitEvent, ProxyOperations: operations, logManager, API_LOG_TAG } = container\n  const log = logManager.getLogger('PROXY')\n\n  const proxyApi = {\n    /**\n     * Sets whether Call functionality should be proxied to the Remote SDK or not.\n     *    When set to `true`, WebRTC operations will be proxied over a channel. When\n     *    set to `false`, WebRTC operation will occur as normal on the local machine.\n     *\n     * Setting proxy mode is a required step for being able to use the Proxy\n     *    functionality. It is recommended that this is the last step, after setting\n     *    a channel and initializing the remote endpoint. Proxy mode cannot be changed if there\n     *    is an on-going call.\n     *\n     * On completion, this API will trigger a {@link proxy.event:proxy:change proxy:change}\n     *    event on success. The {@link proxy.getProxyMode} or {@link proxy.getInfo}\n     *    APIs can be used to verify that proxy mode has been changed. If an error\n     *    is encountered, this API will trigger a {@link proxy.event:proxy:error proxy:error}\n     *    event.\n     * @public\n     * @static\n     * @memberof proxy\n     * @method setProxyMode\n     * @param {boolean} value Whether proxy mode should be enabled.\n     * @example\n     * // On success, the `proxy.setProxyMode` API will trigger a `proxy:change` event.\n     * client.on('proxy:change', params => {\n     *    const isProxied = client.proxy.getProxyMode()\n     *    log(`Proxy mode set to ${isProxied}.`)\n     * })\n     * // On error, the `proxy.setProxyMode` API will trigger a `proxy:error` event.\n     * client.on('proxy:error', params => {\n     *    const { code, message } = params.error\n     *    log(`Failed to set proxy mode due to ${code}: ${message}.`)\n     * })\n     *\n     * // Get the current proxy state to ensure we can set proxy mode to `true`.\n     * const { proxyMode, hasChannel, remoteInitialized } = client.proxy.getInfo()\n     * if (\n     *    hasChannel === true && // A channel was previously provided.\n     *    remoteInitialized === true && // The Remote SDK is ready.\n     *    proxyMode === false && // Proxy mode is not already `true`.\n     * ) {\n     *    client.proxy.setProxyMode(true)\n     * }\n     */\n    async setProxyMode(value) {\n      log.debug(API_LOG_TAG + 'proxy.setProxyMode: ', value)\n\n      try {\n        await operations.setProxyMode(value)\n      } catch (error) {\n        emitEvent(eventTypes.PROXY_ERROR, { error })\n        return\n      }\n      emitEvent(eventTypes.PROXY_CHANGE)\n    },\n\n    /**\n     * Retrieves the current mode for Proxy behaviour.\n     *\n     * When set to `true`, WebRTC operations will be proxied over a channel. When\n     *    set to `false`, WebRTC operation will occur as normal on the local machine.\n     *    See the {@link proxy.setProxyMode} API for more information.\n     * @public\n     * @static\n     * @memberof proxy\n     * @method getProxyMode\n     * @return {boolean} Whether proxy mode is currently enabled.\n     */\n    getProxyMode() {\n      const { getState } = context\n      log.debug(API_LOG_TAG + 'proxy.getProxyMode')\n      return getProxyState(getState()).proxyMode\n    },\n\n    /**\n     * Retrieves information about the proxy.\n     * @public\n     * @static\n     * @memberof proxy\n     * @method getInfo\n     * @returns {Object} proxy Object containing information about the proxy.\n     * @returns {boolean} proxy.proxyMode Current operating mode.\n     * @returns {boolean} proxy.hasChannel Proxy has a channel associated with it.\n     * @returns {boolean} proxy.remoteInitialized Proxy initialization state.\n     * @returns {Object} proxy.browser Details for the browser the proxy is using.\n     * @example\n     * const proxy = client.proxy.getInfo()\n     *\n     * log(`Proxy Browser in use: ${proxy.browser}, mode: ${proxy.proxyMode}, channel: ${proxy.hasChannel}, initialized: ${proxy.remoteInitialized}.`)\n     */\n    getInfo() {\n      const { getState } = context\n      log.debug(API_LOG_TAG + 'proxy.getInfo')\n      return getProxyState(getState())\n    },\n\n    /**\n     * Retrieve information about the proxy's browser being used.\n     * Browser information being defined indicates that the browser supports\n     *    basic webRTC scenarios.\n     * @public\n     * @static\n     * @memberof proxy\n     * @method getProxyDetails\n     * @return {Object} Object containing `browser` and `version` information.\n     * @example\n     * const details = client.proxy.getProxyDetails()\n     *\n     * log(`Proxy Browser in use: ${details.browser}, version ${details.version}.`)\n     */\n    getProxyDetails() {\n      const { getState } = context\n      log.debug(API_LOG_TAG + 'proxy.getProxyDetails')\n      return getProxyState(getState()).browser\n    },\n\n    /**\n     * Sets the channel to be used while proxy mode is enabled.\n     *\n     * Providing a channel is a required step for being able to use the Proxy\n     *    functionality. This should be the first step, before initializing the\n     *    remote endpoint and setting proxy mode.\n     *\n     * On completion, this API will trigger a {@link proxy.event:proxy:change proxy:change}\n     *    event on success. The {@link proxy.getInfo} API can be used to verify\n     *    that a channel has been set. If an error is encountered, this API will\n     *    trigger a {@link proxy.event:proxy:error proxy:error} event. A channel\n     *    cannot be set if there is an on-going call.\n     * @public\n     * @static\n     * @memberof proxy\n     * @method setChannel\n     * @param {proxy.Channel} channel See the `Channel` module for information.\n     * @example\n     * client.on('proxy:change', () => {\n     *    const { hasChannel } = client.proxy.getInfo()\n     *    log(`A channel ${hasChannel ? 'has': 'has not'} been set.`)\n     * })\n     * client.on('proxy:error', params => {\n     *    const { code, message } = params.error\n     *    log(`Encountered error ${code}: ${message}.`)\n     * })\n     *\n     * const appChannel = ...\n     * client.proxy.setChannel(appChannel)\n     */\n    async setChannel(channel) {\n      log.debug(API_LOG_TAG + 'proxy.setChannel: ', channel)\n      try {\n        await operations.setChannel(channel)\n      } catch (error) {\n        emitEvent(eventTypes.PROXY_ERROR, { error })\n        return\n      }\n      emitEvent(eventTypes.PROXY_CHANGE)\n    },\n\n    /**\n     * Sends an initialization message over the channel with webRTC configurations.\n     *\n     * Initializing the Remote SDK is a required step before being able to use the\n     *    Proxy functionality. This step requires a channel having been set previously\n     *    (see the {@link proxy.setChannel API}). It is recommended to perform this\n     *    step before setting the proxy mode (see the {@link proxy.setProxyMode} API).\n     *\n     * On completion, this API will trigger a {@link proxy.event:proxy:change proxy:change}\n     *    event on success. The {@link proxy.getInfo} API can be used to verify\n     *    that the remote endpoint is initialized. If an error is encountered, this\n     *    API will trigger a {@link proxy.event:proxy:error proxy:error} event.\n     *\n     * This API will perform a version-check between this SDK and the Remote SDK.\n     *    Their versions must be the same, otherwise initialization will fail.\n     * @public\n     * @static\n     * @memberof proxy\n     * @method initializeRemote\n     * @param  {Object} config\n     * @example\n     * // Get the current proxy state to ensure we can initialize the Remote SDK.\n     * const { hasChannel, remoteInitialized } = client.proxy.getInfo()\n     * if (\n     *    hasChannel === true && // A channel was previously provided.\n     *    remoteInitialized === false // The Remote SDK was not previously initializted.\n     * ) {\n     *    client.proxy.initializeRemote()\n     * }\n     */\n    async initializeRemote(config) {\n      log.debug(API_LOG_TAG + 'proxy.initializeRemote: ', config)\n      try {\n        await operations.initializeRemote(config)\n      } catch (error) {\n        emitEvent(eventTypes.PROXY_ERROR, { error })\n        return\n      }\n      emitEvent(eventTypes.PROXY_CHANGE)\n    }\n  }\n\n  // Namespace the API.\n  return { proxy: proxyApi }\n}\n","/**\n * A Proxy API has completed and changed the proxy state.\n *\n * The {@link proxy.getInfo} API can be used to retrieve the current proxy state.\n * @public\n * @memberof proxy\n * @event proxy:change\n */\nexport const PROXY_CHANGE = 'proxy:change'\n\n/**\n * A Proxy API has resulted in an error.\n *\n * The {@link proxy.getInfo} API can be used to retrieve the current proxy state.\n * @public\n * @memberof proxy\n * @event proxy:error\n * @param {Object} params\n * @param {BasicError} params.error An error with `code` and `message` information.\n */\nexport const PROXY_ERROR = 'proxy:error'\n","import api from './api'\nimport reducer from './reducers'\n\n/*\n * Expose the components of the Proxy Interface as a single object.\n */\nexport default {\n  name: 'proxy',\n  api,\n  reducer\n}\n","// Proxy plugin.\nimport * as actionTypes from './actionTypes'\n\n// Libraries.\nimport { handleActions } from 'redux-actions'\n\n// The reducer's default state.\nconst defaultState = {\n  proxyMode: false,\n  hasChannel: false,\n  remoteInitialized: false,\n  browser: {}\n}\n\nconst reducers = {}\n\n// Proxy Mode has changed.\nreducers[actionTypes.SET_MODE_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      proxyMode: action.payload.value\n    }\n  }\n}\n\n// A channel has been provided.\nreducers[actionTypes.SET_CHANNEL_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      hasChannel: true,\n      remoteInitialized: false\n    }\n  }\n}\n\n// The remote side has been initialized.\nreducers[actionTypes.INITIALIZE_FINISH] = {\n  next(state, action) {\n    return {\n      ...state,\n      browser: action.payload.browser,\n      remoteInitialized: true\n    }\n  }\n}\n\nconst reducer = handleActions(reducers, defaultState)\nexport default reducer\n","// Libraries.\nimport { cloneDeep } from 'lodash/fp'\n\n/**\n * Selector functions.\n * Used to retrieve specific portions of redux state without\n *    needing to know the structure of state.\n */\n\n/**\n * Retrieves the Proxy Plugin state.\n * @method getProxyState\n * @param {Object} state Redux state.\n * @return {Object} Proxy plugin state.\n */\nexport function getProxyState(state) {\n  return cloneDeep(state.proxy)\n}\n","import { getActiveCalls } from '../call/interface/selectors'\nimport BasicError, { proxyCodes } from '../errors'\nimport { devicesChanged } from '../webrtc/interface/actions/devices'\nimport * as proxyActions from './interface/actions'\nimport * as webrtcEvents from '../webrtc/interface/eventTypes'\nimport { getLevel } from '../logs/interface/selectors'\nimport { getProxyState } from './interface/selectors'\nimport { isEmpty } from 'lodash'\n\n// Webrtc plugin.\nimport { createHandler } from '../webrtc/channels'\n\nexport default function createOperations(container) {\n  const { context, emitEvent, ProxyStack, logManager } = container\n  const log = logManager.getLogger('PROXY')\n\n  function handleMessages(ProxyStack) {\n    const messageHandler = createHandler(container)\n    /**\n     * Listen for messages received from the ProxyStack.\n     *\n     * These messages should be actions (and possibly accompanying events) that\n     *    were generated by the Webrtc plugin's \"channels\" (/webrtc/channels/).\n     * The listener is the \"local side\" of the `contextHelper` for how the SDK\n     *    should handle Webrtc-stack events. The \"remote side\" is defined in the\n     *    ProxyStack.\n     */\n    ProxyStack.onMessage((messageId, data) => {\n      const proxyState = getProxyState(context.getState())\n      if (!proxyState.proxyMode) {\n        log.debug(`Not in Proxy mode, ignoring previous message (${messageId}).`)\n      } else if (data && (data.action || data.event)) {\n        log.debug(`Received event from remote webrtc stack (${data.action.type}).`)\n        // Pass the message to the Webrtc plugin's handler logic.\n        // All messages received should be from the webrtc-stack.\n        messageHandler(data.action, data.event)\n      } else {\n        log.debug(`Received unknown message type; ignoring message (${messageId}).`, data)\n      }\n    })\n  }\n\n  /**\n   * Operation to set the proxy mode for the Proxy Stack.\n   * @method setProxyMode\n   * @param {Object} value\n   * @throws {Error} An error if the operation fails.\n   */\n  async function setProxyMode(value) {\n    const { dispatch } = context\n\n    log.info(`Setting proxy mode to ${value}.`)\n\n    // Dispatch setProxyMode action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(proxyActions.setProxyMode(value))\n\n    // Check to see if there are any on-going calls.\n    const calls = getActiveCalls(context.getState())\n    const proxyState = getProxyState(context.getState())\n\n    if (calls.length > 0) {\n      log.info('Cannot change proxy mode while there are on-going calls.')\n\n      const error = new BasicError({\n        code: proxyCodes.IN_ACTIVE_CALL,\n        message: 'Cannot change proxy mode while there are on-going calls.'\n      })\n\n      dispatch(proxyActions.setProxyModeFinish({ error }))\n      // Throw the error, so it makes it back to the API.\n      throw error\n    } else if (proxyState.proxyMode === value) {\n      log.info('Proxy mode already set to provided value.')\n\n      const error = new BasicError({\n        code: proxyCodes.INVALID_PARAM,\n        message: 'Proxy mode already set to provided value.'\n      })\n\n      dispatch(proxyActions.setProxyModeFinish({ error }))\n      throw error\n    }\n\n    // set value on the Proxy stack\n    const result = await ProxyStack.setProxyMode(value)\n\n    const response = { value }\n\n    // If the mode wasn't set, define an error to be included in the finish action.\n    if (!result) {\n      log.info(`Failed to set proxy mode to ${value}.`)\n\n      // TODO: set a proper error code\n      const error = new BasicError({\n        code: 'proxy:1',\n        message: `Failed to set proxy mode to ${value}.`\n      })\n\n      response.error = error\n      dispatch(proxyActions.setProxyModeFinish(response))\n\n      // Throw the error, so it makes it back to the API.\n      throw error\n    } else {\n      log.info(`Finished setting proxy mode to ${value}.`)\n    }\n\n    dispatch(proxyActions.setProxyModeFinish(response))\n\n    if (value && !proxyState.remoteInitialized) {\n      log.warn(\n        'Proxy mode has been enabled, but the Remote SDK has not been inititalized yet. Call functionality will fail in this state.'\n      )\n      // Return now to prevent the rest of the operation. The \"device check\" message\n      //    will fail and throw an error to the application.\n      return\n    }\n\n    // After Proxy mode is changed, manually update devices to ensure they are\n    //    from the correct machine.\n    const devices = await ProxyStack.managers.devices.checkDevices()\n\n    if (devices.microphone && devices.camera && devices.speaker) {\n      log.debug('Updating available media devices based on proxy mode change.', devices)\n      // Only update state with the devices if its an actual device object.\n      // If the Remote SDK is not initialized yet, it will return garbage.\n      dispatch(devicesChanged(devices))\n\n      // Emit the event so the application knows that devices have changed.\n      emitEvent(webrtcEvents.DEVICES_CHANGED, {})\n    }\n  }\n\n  /**\n   * Operation to setup the communication channel for the Proxy Stack.\n   * @method setChannel\n   * @param {Object} channel The communication channel.\n   * @throws {Error} An error if operation fails.\n   */\n  async function setChannel(channel) {\n    const { dispatch } = context\n    log.info('Setting channel for use in proxy mode.')\n\n    // Dispatch setChannel action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(proxyActions.setChannel(channel))\n\n    // Basic validation\n    if (!channel || isEmpty(channel)) {\n      log.info('Could not set channel; Invalid input.')\n      const error = new BasicError({\n        code: proxyCodes.INVALID_PARAM,\n        message: 'Could not set channel; Invalid input.'\n      })\n\n      dispatch(proxyActions.setChannelFinish({ error }))\n      throw error\n    }\n    // Check to see if there are any on-going calls.\n    const calls = getActiveCalls(context.getState())\n\n    if (calls.length > 0) {\n      log.info('Cannot set channel while there are on-going calls.')\n      const error = new BasicError({\n        code: proxyCodes.IN_ACTIVE_CALL,\n        message: 'Cannot set channel while there are on-going calls.'\n      })\n\n      dispatch(proxyActions.setChannelFinish({ error }))\n      // Throw the error, so it makes it back to the API.\n      throw error\n    }\n    // set channel on the Proxy stack (i.e. not on the webRTC stack)\n    const result = await ProxyStack.setChannel(channel)\n\n    const response = {}\n    // If the channel wasn't set, define an error to be included\n    //    in the finish action.\n    if (!result) {\n      log.info('Failed to set channel for proxy mode.')\n      const error = new BasicError({\n        code: proxyCodes.SET_PROXY_CHANNEL_FAIL,\n        message: 'Failed to set proxy channel.'\n      })\n      response.error = error\n      dispatch(proxyActions.setChannelFinish(response))\n      // Throw the error, so it makes it back to the API.\n      throw error\n    }\n\n    log.info('Finished setting channel for proxy mode.')\n    // Channel was successfully set.\n    // Listen for messages received from the channel.\n    handleMessages(ProxyStack)\n\n    dispatch(proxyActions.setChannelFinish(response))\n\n    // Should we even care to return an empty object ?\n    // API will not look at it, because if there are no errors thrown, it will consider a success.\n    return response\n  }\n\n  /**\n   * Operation to initialize the remote SDK in proxy mode\n   * @param {Object} config The configuration used by remote SDK during its initialization.\n   * @return {Object} If successful, it returns an object indicating the browser where Remote SDK initialization took place.\n   * @throws {Error} An error indicating the cause of failed initialization.\n   */\n  async function initializeRemote(config) {\n    const { dispatch } = context\n    log.info('Initializing the Remote SDK for proxy mode.')\n\n    // Dispatch initializeRemote action for backwards-compatible of action logs.\n    //     This does not affect state or emit an event.\n    dispatch(proxyActions.initializeRemote(config))\n\n    // Get the current local log levels for the loggers that the remote end also uses.\n    //    Send this as part of the init command, so the two sides are in-sync.\n    const webrtcLevel = getLevel(context.getState(), 'WEBRTC')\n    const proxyLevel = getLevel(context.getState(), 'PROXY')\n    const channelLevel = getLevel(context.getState(), 'CHANNEL')\n    const logLevels = { WEBRTC: webrtcLevel, PROXY: proxyLevel, CHANNEL: channelLevel }\n\n    const result = await ProxyStack.initialize(config, logLevels)\n    if (result.error) {\n      log.info('Failed to initialize the Remote SDK.')\n      dispatch(proxyActions.initializeRemoteFinish({ error: result.error.message }))\n\n      throw result.error\n    }\n\n    log.info('Finished initializing the Remote SDK.')\n    dispatch(proxyActions.initializeRemoteFinish({ browser: result.browser }))\n    return { browser: result.browser }\n  }\n\n  return {\n    setProxyMode,\n    initializeRemote,\n    setChannel\n  }\n}\n","// Proxy plugin.\nimport modelProxy from './model'\n\n// Other plugins.\nimport { logManager } from '../../logs'\n\n// Libraries.\nimport { isArray, isNull } from 'lodash/fp'\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * Creates an ES6 Proxy to wrap a webRTC manager.\n * @method createManagerProxy\n * @param  {Object} base The base object being wrapped.\n * @param  {boolean} base.proxyMode Whether operations should be proxied or not.\n * @param  {string} base.modelType The type of manager this is.\n * @param  {Object} actualManager A webRTC manager.\n * @return {Proxy}\n */\nexport default function (base, actualManager) {\n  // Hardcode `id` as manager, since this function is only for manager proxies.\n  base.id = 'manager'\n\n  const log = logManager.getLogger('PROXY', base.modelType)\n  log.debug(`Creating manager proxy for ${base.modelType}.`, base)\n\n  return new Proxy(base, {\n    /**\n     * Proxy \"getter\" calls on the Proxy.\n     * This function is called anytime a property on `base` is accessed,\n     *    eg. `base.someProp`\n     * @param {Object} objTarget base\n     * @param {string} prop Property being accessed.\n     * @param {Object} receiver The Proxy object.\n     */\n    get: function (objTarget, prop, receiver) {\n      // If the Proxy Stack is not in proxy mode, return the property from the\n      //    actual webRTC manager object.\n      if (!objTarget.proxyMode || !objTarget.channel) {\n        return actualManager[prop]\n      }\n      // Otherwise, the webRTC operation needs to be proxied over the channel.\n\n      /*\n       * Tell redux-saga that this is not a promise.\n       * Otherwise it will handle it differently under-the-hood and break things.\n       * Ref: github.com/redux-saga/redux-saga/blob/master/packages/is/src/index.js#L10\n       */\n      if (!objTarget[prop] && prop === 'then') {\n        return undefined\n      }\n\n      if (objTarget[prop]) {\n        // If something that actually exists is being accessed,\n        //    then return that thing.\n        return objTarget[prop]\n      } else {\n        // Otherwise, it's probably accessing a prop that it\n        //    expects to be a function. So return a function proxy.\n        return new Proxy(() => {}, {\n          /**\n           * Proxy function calls.\n           * This function is called when the dummy function is called,\n           * @example\n           *    const someProp = base.someProp  // Triggers the above `get`.\n           *    someProp()                      // Triggers this `apply`.\n           * @param  {Function} funcTarget The dummy function.\n           * @param  {boolean} thisArg The `base` object wrapped by the first proxy layer.\n           * @param  {Array}  args List of function parameters.\n           */\n          apply: function (funcTarget, thisArg, args) {\n            // Assemble the webRTC command to be sent over the channel.\n            const operation = {\n              modelType: thisArg.modelType,\n              id: thisArg.id,\n              operation: prop,\n              params: args\n            }\n\n            if (thisArg.proxyMode && thisArg.channel && thisArg.channel.send) {\n              /*\n               * All manager APIs will now return a Promise, even if they didn't\n               *    before. This is needed to wait for the remote response.\n               * Since sagas `yield` on these API calls, they will also wait\n               *    until the promise resolves.\n               */\n              return new Promise((resolve, reject) => {\n                // Record the time when the message is sent.\n                const sentTime = Date.now()\n\n                function callback(data, error) {\n                  if (data) {\n                    // Strip operation timing data out of the reply and only forward the result from the remote side.\n                    const { opTiming } = data\n                    data = data.result\n                    if (opTiming) {\n                      const receivedTime = Date.now()\n\n                      log.debug(`Received manager ${operation.operation} response (${messageId}).`, data)\n\n                      // If there are operation timings in the data, report them here.\n                      if (opTiming) {\n                        log.debug(\n                          `Remote operation ${operation.operation} timing sent: ${sentTime}, receivedRemote: ${opTiming.start}, remoteReplied: ${opTiming.end}, receivedLocal: ${receivedTime}`\n                        )\n                      }\n                    }\n                  }\n\n                  /**\n                   * Parse the data received from the remote side.\n                   */\n                  function parseData(data) {\n                    if (data && data.modelType === 'multiple') {\n                      // If the response has multiple WebRTC models, each need to\n                      //    be wrapped with a proxy for the Callstack.\n                      const proxies = {}\n                      Object.keys(data).forEach(key => {\n                        if (key === 'modelType') {\n                          // Skip.\n                        } else if (Array.isArray(key)) {\n                          proxies[key] = data[key].map(parseData)\n                        } else {\n                          proxies[key] = parseData(data[key])\n                        }\n                      })\n                      return proxies\n                    } else if (data && data.modelType) {\n                      // If the response is a Webrtc model, we need to wrap it\n                      //    with a proxy for the Callstack.\n                      return modelProxy(data, thisArg.channel)\n                    } else if (isNull(data)) {\n                      // The JSON codec encoder/decoder converts undefined to\n                      //    null (because of JSON stringify/parse), so undo\n                      //    that if the data is explicitly null value.\n                      return undefined\n                    } else if (data && data.error && data.error.name) {\n                      // If the response is a named error, then something was\n                      //    reject or thrown on the remote side. Reconstruct it\n                      //    then re-reject it to be handled by the Callstack.\n                      const err = new Error()\n                      // Set whatever keys,values where saved in data.error\n                      for (const [key, value] of Object.entries(data.error)) {\n                        err[key] = value\n                      }\n                      reject(err)\n                    } else {\n                      return data\n                    }\n                  }\n\n                  if (error) {\n                    reject(error)\n                  } else if (isArray(data)) {\n                    const proxies = data.map(parseData)\n                    resolve(proxies)\n                  } else {\n                    resolve(parseData(data))\n                  }\n                }\n\n                const messageId = uuidV4().substring(0, 8)\n                log.debug(`Sending manager ${operation.operation} operation (${messageId}).`, operation)\n\n                thisArg.channel.send(messageId, operation, callback)\n              })\n            }\n          }\n        })\n      }\n    }\n  })\n}\n","// Other plugins.\nimport { logManager } from '../../logs'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * Creates an ES6 Proxy to wrap a webRTC object.\n * @method modelProxy\n * @param  {Object}  base The base object being wrapped.\n * @param  {Channel} channel The channel to use for proxying commands.\n * @return {Proxy}   A proxied webRTC object.\n */\nexport default function modelProxy(base, channel) {\n  const log = logManager.getLogger('PROXY', `${base.modelType}/${base.id}`)\n  log.debug(`Creating model proxy for ${base.modelType}/${base.id}.`)\n\n  return new Proxy(base, {\n    get: function (objTarget, prop, receiver) {\n      /*\n       * Tell redux-saga that this is not a promise.\n       * Otherwise it will handle it differently under-the-hood and break things.\n       * Ref: github.com/redux-saga/redux-saga/blob/master/packages/is/src/index.js#L10\n       */\n      if (!objTarget[prop] && prop === 'then') {\n        return undefined\n      }\n\n      /*\n       * Tell the Proxy channel (and anything else) that the original object is\n       *    already a JSON object.\n       * When sending this Proxy over the channel, it will try to JSON.stringify()\n       *    it, which actually first tries to call toJSON on it.\n       * Mimic the real toJSON with a function that returns the original object.\n       */\n      if (prop === 'toJSON') {\n        return () => objTarget\n      }\n\n      /**\n       * The base object used to create a model's proxy may have references to\n       *    other webRTC objects. We need to proxy those references as well.\n       * Session: localTracks, remoteTracks, allLocalTracks\n       * Media: tracks\n       */\n      if (['localTracks', 'allLocalTracks', 'remoteTracks', 'tracks'].includes(prop)) {\n        return objTarget[prop].map(track => modelProxy(track, channel))\n      }\n\n      if (objTarget[prop]) {\n        // If something that actually exists is being accessed,\n        //    then return that thing.\n        return objTarget[prop]\n      } else {\n        // Otherwise, it's probably accessing a prop that it\n        //    expects to be a function. So return a function proxy.\n        return new Proxy(() => {}, {\n          /**\n           * Proxy function calls.\n           * This function is called when the dummy function is called,\n           * @example\n           *    const someProp = base.someProp  // Triggers the above `get`.\n           *    someProp()                      // Triggers this `apply`.\n           * @param  {Function} funcTarget The dummy function.\n           * @param  {boolean} thisArg The `base` object wrapped by the first proxy layer.\n           * @param  {Array}  args List of function parameters.\n           */\n          apply: function (funcTarget, thisArg, args) {\n            // Assemble the webRTC command to be sent over the channel.\n            const operation = {\n              modelType: thisArg.modelType,\n              id: thisArg.id,\n              operation: prop,\n              params: args\n            }\n\n            /*\n             * All APIs will now return a Promise, even if they didn't\n             *    before. This is needed to wait for the remote response.\n             * Since sagas `yield` on these API calls, they will also wait\n             *    until the promise resolves.\n             */\n            return new Promise((resolve, reject) => {\n              // Record the time when the message is sent.\n              const sentTime = Date.now()\n\n              function callback(data, error) {\n                if (data) {\n                  // Strip operation timing data out of the reply and only forward the result from the remote side.\n                  const { opTiming } = data\n                  data = data.result\n                  if (opTiming) {\n                    const receivedTime = Date.now()\n\n                    log.debug(`Received model ${operation.operation} response (${messageId}).`, data)\n\n                    // If there are operation timings in the data, report them here.\n                    if (opTiming) {\n                      log.debug(\n                        `Remote operation ${operation.operation} timing sent: ${sentTime}, receivedRemote: ${opTiming.start}, remoteReplied: ${opTiming.end}, receivedLocal: ${receivedTime}`\n                      )\n                    }\n                  }\n                }\n\n                if (operation.operation === 'getStats') {\n                  // If-block required for https://jira.rbbn.com/browse/KAA-2056\n                  // The RTCStatsReport does not serialize over the wire natively\n                  // So we need to reconstruct it here\n                  data = new Map(data)\n                }\n\n                log.debug(`Received model response for ${messageId}.`, data)\n\n                /**\n                 * Parse the data received from the remote side.\n                 */\n                function parseData(data) {\n                  if (data && data.modelType && operation.operation === 'getTracks') {\n                    // If the operation we sent across was `getTracks`, then the\n                    //    response data should be Webrtc model(s). We need to\n                    //    wrap it with a proxy for the Callstack.\n                    return modelProxy(data, channel)\n                  } else if (data === null) {\n                    // The JSON codec encoder/decoder converts undefined to\n                    //    null (because of JSON stringify/parse), so undo\n                    //    that if the data is explicitly null value.\n                    return undefined\n                  } else {\n                    return data\n                  }\n                }\n\n                if (error) {\n                  reject(error)\n                } else if (Array.isArray(data)) {\n                  const proxies = data.map(parseData)\n                  resolve(proxies)\n                } else {\n                  resolve(parseData(data))\n                }\n                resolve(data)\n              }\n\n              const messageId = uuidV4().substring(0, 8)\n              log.debug(`Sending model ${operation.operation} operation (${messageId}).`, operation)\n\n              channel.send(messageId, operation, callback)\n            })\n          }\n        })\n      }\n    }\n  })\n}\n","// Proxy plugin.\nimport createManagerProxy from './proxies/manager'\nimport { jsonChannel, replyChannel } from './channel'\n\n// Other plugins.\nimport { logManager } from '../logs'\nimport { getVersion } from '../common/version'\nimport BasicError, { proxyCodes } from '../errors'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\n\nconst log = logManager.getLogger('PROXY')\n\n/**\n * Creates a Proxied webRTC Stack.\n * This Proxy Stack is the replacement for the actual webRTC stack.\n * @method initializeProxy\n * @param {Object} webRTC The local webRTC stack.\n * @return {Object} The Proxy Stack.\n */\nexport default function initializeProxy(webRTC) {\n  // The base of the proxy stack.\n  const base = {\n    // Whether operations should be proxied.\n    proxyMode: false,\n    // The channel to use for proxying operations.\n    channel: undefined,\n    // Whether the Client side is ready.\n    clientReady: false,\n    // The proxied webRTC managers.\n    managers: {}\n  }\n\n  /*\n   * Recreate each of the actual webRTC managers as a proxied manager.\n   * Creating proxies at the manager level (instead of only at the stack level)\n   *    allows the Proxy Stack to be used in scenarios where the managers\n   *    themselves are stored (rather than only using the stack from the top\n   *    level).\n   * Specifically, this allows us to use the Proxy Stack in the webRTC examples\n   *    for testing outside of the SDK/redux context.\n   */\n  for (const manager in webRTC.managers) {\n    base.managers[manager] = createManagerProxy(\n      {\n        modelType: manager,\n        proxyMode: base.proxyMode,\n        channel: base.channel\n      },\n      webRTC.managers[manager]\n    )\n  }\n\n  /**\n   * Sets proxy mode for the Proxy Stack.\n   * @method setProxyMode\n   * @param {boolean} value\n   * @return {boolean} Whether the setting was successfully changed or not.\n   */\n  const setProxyMode = value => {\n    if (typeof value !== 'boolean') {\n      log.debug('Provided value is not a boolean; cannot set proxy mode.')\n      return false\n    }\n\n    log.debug('Setting proxyMode for managers to ' + value)\n    base.proxyMode = value\n\n    for (const manProxy in base.managers) {\n      base.managers[manProxy].proxyMode = value\n    }\n\n    // While in Proxy mode, stop the local DeviceManager from\n    //    listening for device change events from the browser.\n    // Start listening again when taken out of Proxy mode.\n    webRTC.managers.devices.setListening(!value)\n\n    return true\n  }\n\n  /**\n   * Retrieves the current mode of the Proxy Stack.\n   * @method getProxyMode\n   * @return {boolean}\n   */\n  const getProxyMode = () => {\n    return base.proxyMode\n  }\n\n  /**\n   * Sets the channel to be used for proxying operations.\n   * @method setChannel\n   * @param {Channel} channel\n   */\n  const setChannel = channel => {\n    // TODO: How to unset a channel?\n    // TODO: Make (more) sure its a valid channel.\n    if (!channel || !channel.send) {\n      log.debug('Provided channel does not support the expected interface.')\n      return false\n    }\n\n    const wrappedChannel = replyChannel(jsonChannel(channel))\n    base.channel = wrappedChannel\n    base.clientReady = false\n\n    for (const manProxy in base.managers) {\n      base.managers[manProxy].channel = wrappedChannel\n    }\n\n    return true\n  }\n\n  /**\n   * Retrieves the current channel to be used.\n   * @method getChannel\n   * @return {Channel}\n   */\n  const getChannel = () => {\n    return base.channel\n  }\n\n  /**\n   * Sets the listener function for receiving messages from the channel.\n   * @method setReceiver\n   * @param  {Function} listener\n   */\n  const onMessage = listener => {\n    base.channel.receive = listener\n  }\n\n  /**\n   * Attempts to initialize the Client side to be ready for use.\n   * @method initialize\n   * @param {Object} config WebRTC stack configuration.\n   * @param {Object} logLevels  The initial log levels for the Remote end's loggers.\n   * @param {string} logLevels.WEBRTC Log level for the Remote WebRTC stack.\n   * @param {string} logLevels.PROXY  Log level for the Remote Proxy operations.\n   */\n  const initialize = (config, logLevels) => {\n    // Version of the local SDK.\n    const version = getVersion()\n\n    return new Promise(resolve => {\n      /*\n       * Validation checks:\n       *    - we have not already initialized the Remote SDK,\n       *    - we have a Proxy channel for sending messages.\n       */\n      if (base.clientReady) {\n        log.debug('Cannot initialize remote: Already initialized.')\n        resolve({\n          error: new BasicError({\n            message: 'Remote SDK has already been initialized.',\n            code: proxyCodes.INVALID_STATE\n          })\n        })\n      } else if (!base.channel) {\n        log.debug('Cannot initialize remote: Proxy channel not found.')\n        resolve({\n          error: new BasicError({\n            message: 'Proxy channel not found.',\n            code: proxyCodes.INVALID_STATE\n          })\n        })\n      } else {\n        // Send the \"initialize\" message to the Remote SDK.\n        const callback = (data, error) => {\n          log.debug('Received initialize response.', data)\n          if (error) {\n            // Error Scenario: The channel itself encountered an error.\n            const isTimeout = error.message.includes('timed-out')\n            resolve({\n              error: new BasicError({\n                message: error.message,\n                code: isTimeout ? proxyCodes.TIMEOUT : proxyCodes.UNKNOWN\n              })\n            })\n          } else if (data.error) {\n            // Convert the stringified error into a BasicError instance.\n            const error = new BasicError(data.error)\n            /*\n             * Error scenarios:\n             *    - remote SDK was already initialized,\n             *    - SDK versions do not match,\n             *    - generic error; should not happen.\n             */\n            if (error.code === proxyCodes.INVALID_STATE && data.initialized) {\n              log.warn('Remote SDK responded as already initialized.')\n              resolve({ error })\n            } else if (error.code === proxyCodes.VERSION_MISMATCH) {\n              log.error(`Remote SDK responded with a version mismatch error. Remote SDK version: ${data.remoteVersion}`)\n              resolve({ error })\n            } else {\n              log.info('Remote SDK responded with an error.')\n              resolve({ error })\n            }\n          } else if (data.remoteVersion !== version) {\n            // Remote SDK version < 6.7.1 does not return an error for version mismatch\n            log.error(`Remote SDK responded with a version mismatch error. Remote SDK version: ${data.remoteVersion}`)\n            resolve({\n              error: new BasicError({\n                code: proxyCodes.VERSION_MISMATCH,\n                message: 'Remote SDK version does not match; initialization failed.'\n              })\n            })\n          } else if (data.initialized) {\n            // The Client is now ready.\n            base.clientReady = true\n            resolve({ browser: data.browser })\n          } else {\n            // Error scenario: Message had no error, but also did not initialize\n            //    the Remote SDK?\n            log.debug('Remote SDK responded with an unhandled message.')\n            resolve({\n              error: new BasicError({\n                message: 'Unknown error; could not process response.',\n                code: proxyCodes.INVALID_STATE\n              })\n            })\n          }\n        }\n\n        const messageId = uuidV4()\n        base.channel.send(\n          messageId,\n          {\n            initialize: true,\n            version,\n            config,\n            logLevels\n          },\n          callback\n        )\n      }\n    })\n  }\n\n  /**\n   * Set the SDP handlers the webRTC stack should use with the pipeline.\n   * @method setHandlers\n   * @param  {Array} handlers List of SDP handlers.\n   */\n  function setHandlers(handlers) {\n    webRTC.sdp.pipeline.setHandlers(handlers)\n  }\n\n  /**\n   * Retrieve details about the browser.\n   * Intended to only be used for retrieving the local browser details. The\n   *    Proxy details are retrieved when initializing the remote SDK.\n   * @method getBrowserDetails\n   * @return {Object}\n   */\n  function getBrowserDetails() {\n    // Query the local webRTC stack if we're not in proxy mode.\n    if (!base.proxyMode) {\n      return webRTC.getBrowserDetails()\n    }\n  }\n\n  return {\n    // Proxy stack specific.\n    setProxyMode,\n    getProxyMode,\n    setChannel,\n    getChannel,\n    onMessage,\n    // webRTC imitations.\n    initialize,\n    sdp: {\n      pipeline: {\n        setHandlers\n      }\n    },\n    managers: base.managers,\n    getBrowserDetails\n  }\n}\n","/**\n * Log levels supported by Loggers.\n * When a level is set, all logs of that level and higher will be logged.\n * @type {Object}\n */\nexport const logLevels = {\n  TRACE: 'TRACE',\n  DEBUG: 'DEBUG',\n  INFO: 'INFO',\n  WARN: 'WARN',\n  ERROR: 'ERROR',\n  SILENT: 'SILENT'\n}\n\n/**\n * Numeric values for each log level.\n * When a level is set, all logs of that level and higher will be logged.\n * @type {Object}\n */\nexport const levelValues = {\n  TRACE: 0,\n  DEBUG: 1,\n  INFO: 2,\n  WARN: 3,\n  ERROR: 4,\n  SILENT: 5\n}\n\n/**\n * Supported Log methods and their set log level; `<logMethod>: <logLevel>`\n * Used to construct the logging methods on a Logger.\n * @type {Object}\n */\nexport const logMethods = {\n  // Standard methods.\n  trace: logLevels.TRACE,\n  debug: logLevels.DEBUG,\n  info: logLevels.INFO,\n  warn: logLevels.WARN,\n  error: logLevels.ERROR,\n  // Extra console methods.\n  log: logLevels.DEBUG,\n  group: logLevels.DEBUG,\n  groupEnd: logLevels.DEBUG,\n  groupCollapsed: logLevels.DEBUG\n}\n\n/**\n * The log level for all timer methods.\n * @type {string}\n */\nexport const timeLevel = logLevels.DEBUG\n","import createManager from './logManager'\nimport defaultLogFormatter from './logFormatter'\nimport { logLevels as levelImport } from './constants'\n\n/**\n * Package main.\n */\n\n// Main export is the manager's factory function.\nexport default createManager\n\n// Named export for the log level constants the package uses / expects.\nexport const logLevels = levelImport\n\n// Default log formatter used by the defaultLogHandler\nexport const logFormatter = defaultLogFormatter\n","/**\n * Default function for the SDK to use for log formatting.\n *    Uses entry information to form a prefix.\n * @method defaultLogFormatter\n * @param  {LogEntry} entry\n */\nexport default function defaultLogFormatter(entry) {\n  // Compile the meta info of the log for a prefix.\n  const { timestamp, level, target } = entry\n\n  // Find a short name to reference which Logger this log is from.\n  //    This is mostly to cut down the ID if it's too long for a human to read.\n  const shortId = target.id && target.id.length > 8 ? target.id.substring(0, 6) : target.id\n  const shortName = shortId ? `${target.type}/${shortId}` : target.type\n\n  const logInfo = `${timestamp} - ${shortName} - ${level}`\n\n  // Assume that the first message parameter is a string.\n  const log = entry.messages[0]\n\n  return `${logInfo} - ${log}`\n}\n","import defaultLogFormatter from './logFormatter'\n/**\n * Default function for the SDK to use for logging.\n *    Uses entry information to form a prefix, then logs to console.\n * @method defaultLogHandler\n * @param  {LogEntry} entry\n */\nexport default function defaultLogHandler(entry) {\n  let { method } = entry\n\n  // For the time-related methods, don't actually use the console methods.\n  //    The Logger already did the timing, so simply log out the info.\n  if (method.includes('time')) {\n    method = 'debug'\n  }\n\n  const formattedString = defaultLogFormatter(entry)\n  const tail = entry.messages.slice(1)\n  // eslint-disable-next-line no-console\n  console[method](formattedString, ...tail)\n}\n","import createLogger from './logger'\nimport defaultLogHandler from './logHandler'\nimport { logLevels } from './constants'\nimport { checkLevel, checkHandler } from './validation'\n\nconst defaultType = Symbol('Default')\n\n/**\n * Creates a Log Manager.\n * @method createManager\n * @param  {Object}     [options={}]\n * @param  {Function}   [options.handler]      The default log handler used for\n *    Loggers that don't have a handler set.\n * @param  {string}     [options.level='INFO'] The default log level used for\n *    Loggers that don't have a level set.\n * @return {LogManager}\n */\nexport default function createManager(options = {}) {\n  const loggers = {}\n\n  /**\n   * Mapping between a Logger `type` and their default settings. Created Loggers\n   *    will use their `type` settings if they exist. Otherwise the \"global\"\n   *    options provided during Manager creation.\n   * @type {Object}\n   */\n  const settings = {\n    [defaultType]: {\n      handler: options.handler ? checkHandler(options.handler) : defaultLogHandler,\n      level: options.level ? checkLevel(options.level) : logLevels.INFO\n    }\n  }\n\n  /**\n   * Gets a specific logger. If the logger doesn't exist, a new one will be\n   *    created.\n   * @method getLogger\n   * @param  {string} type Human-readable type/name for the logger.\n   * @param  {string} [id] A unique identifier for the logger.\n   * @return {Logger}\n   */\n  function getLogger(type, id = '') {\n    id = String(id)\n\n    // Combine the name and ID to create the \"full\" logger name.\n    const loggerName = id ? `${type}-${id}` : type\n\n    let logger = loggers[loggerName]\n    // If the logger does not exist, create a new one.\n    if (!logger) {\n      // This logger logs items from a specific \"target\".\n      const target = { type, id, name: loggerName }\n      const options = {\n        level: getLevel(type),\n        handler: getHandler(type)\n      }\n\n      logger = createLogger(target, options)\n\n      // Save the new logger to be returned by future getter calls.\n      loggers[loggerName] = logger\n    }\n\n    return logger\n  }\n\n  /**\n   * Gets all created loggers, or Loggers of a specific type.\n   * @method getLoggers\n   * @param {string} [type] The type of Loggers to retrieve.\n   * @return {Array<Logger>} List of Loggers.\n   */\n  function getLoggers(type) {\n    if (type) {\n      return Object.values(loggers).filter(logger => logger.type === type)\n    } else {\n      return Object.values(loggers)\n    }\n  }\n\n  /**\n   * Sets the default `level` to be used when creating Loggers.\n   *\n   * Can set the level \"globally\" or per `type`, depending if `type` is provided\n   *    or not. When set for a specific type, only Loggers of that type will use\n   *    the set level. When set \"globally\", all Loggers without a set type will\n   *    use the level as a default.\n   *\n   * Setting the level only affects Loggers created after that point.\n   * @method setLevel\n   * @param  {string} type  The type of Logger to set the option for.\n   * @param  {string} level The logLevel to be set.\n   * @throws Throws an error if level is not a valid log level.\n   * @example\n   * const manager = createManager({ level: logLevels.WARN })\n   *\n   * // Setting the level for a type sets it for created Loggers of that type.\n   * manager.setLevel('Call', logLevels.DEBUG)\n   * const logger1 = manager.getLogger('Call')\n   * // logger1.getLevel() === logLevels.DEBUG\n   *\n   * // Loggers created of types without a set level uses the Manager's level.\n   * const logger2 = manager.getLogger('Auth')\n   * // logger2.getLevel() === logLevels.WARN\n   *\n   * // Setting the level without a type changes the Manager's level.\n   * manager.setLevel(logLevels.INFO)\n   * const logger3 = manager.getLogger('Messaging')\n   * // logger3.getLevel() === logLevels.INFO\n   *\n   * // Setting the level for a type does not affect previously created Loggers.\n   * manager.setLevel('Auth', logLevels.INFO)\n   * // logger2.getLevel() !== logLevels.INFO\n   * // logger2.getLevel() === logLevels.WARN\n   */\n  function setLevel(type, level) {\n    // Signature can be: `setLevel(type, level)` or `setLevel(level)`.\n    // Normalize the parameters to always be consistent.\n    if (level === undefined) {\n      level = type\n      type = defaultType\n    }\n\n    // Ensure `settings[type]` is an object.\n    if (!settings[type]) {\n      settings[type] = {}\n    }\n\n    // Set the level.\n    settings[type].level = checkLevel(level)\n  }\n\n  /**\n   * Gets the default `level` that is used when creating Loggers.\n   *\n   * Can get the level used \"globally\" or per `type`, depending if `type` is\n   *    provided or not.\n   *\n   * See the `setLevel` API for setting these values.\n   * See the Logger APIs for getting this value for an already created Logger.\n   * @method getLevel\n   * @param  {string} [type] A type of Logger.\n   * @return {LogLevel}\n   * @example\n   * const manager = createManager({ level: logLevels.WARN })\n   *\n   * // If a type's level has not been set, gets the \"global\" level.\n   * // manager.getLevel('Call') === logLevels.WARN\n   *\n   * // If a type's level has been set, gets its level.\n   * manager.setLevel('Auth', logLevels.DEBUG)\n   * // manager.getLevel('Auth') === logLevels.DEBUG\n   *\n   * // Can get the \"global\" level.\n   * manager.setLevel(logLevels.INFO)\n   * // manager.getLevel() === logLevels.INFO\n   */\n  function getLevel(type) {\n    // Signature can be: `getLevel(type)` or `getLevel()`.\n    // Normalize the parameters to always be consistent.\n    type = type || defaultType\n\n    return (settings[type] && settings[type].level) || settings[defaultType].level\n  }\n\n  /**\n   * Sets the default `handler` to be used when creating Loggers.\n   *\n   * Can set the handler \"globally\" or per `type`, depending if `type` is\n   *    provided or not. When set for a specific type, only Loggers of that type\n   *    will use the set handler. When set \"globally\", all Loggers without a set\n   *    type will use the handler as a default.\n   *\n   * Setting the handler only affects Loggers created after that point.\n   * @method setHandler\n   * @param  {string}     type    The type of Logger to set the option for.\n   * @param  {LogHandler} handler The log handler to be set.\n   * @throws Throws an error if handler is not a function.\n   * @example\n   * const manager = createManager({ handler: managerHandler })\n   *\n   * // Setting the handler for a type sets it for created Loggers of that type.\n   * manager.setHandler('Call', callHandler)\n   * const logger1 = manager.getLogger('Call')\n   * // logger1.getHandler() === callHandler\n   *\n   * // Loggers created of types without a set handler uses the Manager's handler.\n   * const logger2 = manager.getLogger('Auth')\n   * // logger2.getHandler() === managerHandler\n   *\n   * // Setting the handler without a type changes the Manager's handler.\n   * manager.setHandler(newHandler)\n   * const logger3 = manager.getLogger('Messaging')\n   * // logger3.getHandler() === newHandler\n   *\n   * // Setting the handler for a type does not affect previously created Loggers.\n   * manager.setHandler('Auth', authHandler)\n   * // logger2.getHandler() !== authHandler\n   * // logger2.getHandler() === managerHandler\n   */\n  function setHandler(type, handler) {\n    // Signature can be: `setHandler(type, handler)` or `setHandler(handler)`.\n    // Normalize the parameters to always be consistent.\n    if (typeof type === 'function' && handler === undefined) {\n      handler = type\n      type = defaultType\n    }\n\n    // Ensure `settings[type]` is an object.\n    if (!settings[type]) {\n      settings[type] = {}\n    }\n\n    // Set the handler.\n    settings[type].handler = checkHandler(handler)\n  }\n\n  /**\n   * Gets the default `handler` that is used when creating Loggers.\n   *\n   * Can get the handler used \"globally\" or per `type`, depending if `type` is\n   *    provided or not.\n   *\n   * See the `setHandler` API for setting these values.\n   * See the Logger APIs for getting this value for an already created Logger.\n   * @method getHandler\n   * @param  {string} [type] A type of Logger.\n   * @return {LogHandler}\n   * @example\n   * const manager = createManager({ handler: managerHandler })\n   *\n   * // If a type's handler has not been set, gets the \"global\" handler.\n   * // manager.getHandler('Call') === managerHandler\n   *\n   * // If a type's handler has been set, gets its handler.\n   * manager.setHandler('Auth', authHandler)\n   * // manager.getHandler('Auth') === authHandler\n   *\n   * // Can get the \"global\" handler.\n   * manager.setHandler(newHandler)\n   * // manager.getHandler() === newHandler\n   */\n  function getHandler(type) {\n    // Signature can be: `getHandler(type)` or `getHandler()`.\n    // Normalize the parameters to always be consistent.\n    type = type || defaultType\n\n    return (settings[type] && settings[type].handler) || settings[defaultType].handler\n  }\n\n  return {\n    getLogger,\n    getLoggers,\n    setLevel,\n    getLevel,\n    setHandler,\n    getHandler\n  }\n}\n","import { levelValues, logMethods, logLevels, timeLevel } from './constants'\nimport { checkLevel, checkHandler } from './validation'\nimport createTimer from './timer'\n\n/**\n * Creates a Logger.\n * @method createLogger\n * @param  {Object}   target          The subject of the logs from this logger.\n * @param  {Object}   options\n * @param  {Function} options.handler The function to receive/handle log entries.\n * @param  {string}   options.level   The log level to be set.\n * @return {Logger}\n */\nexport default function createLogger(target, options = {}) {\n  // Validate provided options. Do not let invalid options be set.\n  const level = checkLevel(options.level)\n  const handler = checkHandler(options.handler)\n\n  /**\n   * Logger data.\n   * @type {Object}\n   * @property {Object}   target  Metadata about the \"target\" of the Logger.\n   * @property {LogLevel} level   The currently set log level.\n   * @property {Function} handler The currently set Log Handler.\n   */\n  const logger = {\n    target,\n    level,\n    handler\n  }\n\n  /**\n   * Currying function to dynamically create the Logger's logging methods.\n   * @method logFunc\n   * @param  {string} method   Name of the logger method to create.\n   * @param  {string} logLevel The log level for the method.\n   * @param  {Object} [injectables] Other values to include in the LogEntry.\n   * @return {Function} A log method.\n   */\n  function logFunc(method, logLevel, injectables) {\n    /*\n     * Return the function that will be used as `log.<method>`.\n     */\n    return function (...args) {\n      // Compare the logged level and the configured level.\n      const shouldLog = levelValues[logLevel] >= levelValues[logger.level]\n      // If this entry shouldn't be logged, don't do anything.\n      if (!shouldLog) {\n        return\n      }\n\n      // Create the Log Entry to be handed off to the handler.\n      const entry = {\n        // Extra data to be added to the LogEntry.\n        ...injectables,\n        // Meta-info about the log.\n        method,\n        timestamp: Date.now(),\n        level: logLevel,\n        target: logger.target,\n        // The actual arguments logged.\n        messages: [...args]\n      }\n\n      logger.handler(entry)\n    }\n  }\n\n  /**\n   * Sets the Logger's current log level.\n   * @method setLevel\n   * @param  {string} level The logLevel to be set.\n   * @throws Throws an error if level is not a valid log level.\n   * @example\n   * logger.setLevel(logLevels.INFO)\n   * logger.info('This will be logged.')\n   * logger.debug('This will not be logged.')\n   */\n  function setLevel(level) {\n    logger.level = checkLevel(level)\n  }\n\n  /**\n   * Gets the Logger's current log level.\n   * @method getLevel\n   * @return {string} The log level.\n   * @example\n   * logger.setLevel(logLevels.DEBUG)\n   * const level = logger.getLevel()\n   * // level === logLevels.DEBUG\n   */\n  function getLevel() {\n    return logger.level\n  }\n\n  /**\n   * Sets the Logger's current log handler.\n   * @method setHandler\n   * @param  {Function} handler The log handler to be set.\n   * @throws Throws an error if handler is not a function.\n   * @example\n   * const logger = manager.getLogger('Test', '123')\n   * logger.setHandler((logEntry) => {\n   *    console.log(logEntry.target.name, ...logEntry.messages)\n   * })\n   * logger.info('I am a logged message.')\n   * // logs: \"Test-123 I am a logged message.\"\n   */\n  function setHandler(handler) {\n    logger.handler = checkHandler(handler)\n  }\n\n  /**\n   * Gets the Logger's current log handler.\n   * @method getHandler\n   * @return {Function} The log handler.\n   * @example\n   * logger.setHandler(customHandler)\n   * const handler = logger.getHandler()\n   * // handler === customHandler.DEBUG\n   */\n  function getHandler() {\n    return logger.handler\n  }\n\n  const api = {\n    getHandler,\n    setHandler,\n    getLevel,\n    setLevel,\n    get type() {\n      return logger.target.type\n    },\n    get id() {\n      return logger.target.id\n    },\n    get name() {\n      return logger.target.name\n    }\n  }\n\n  // For all supported log methods, create a function on the Logger for it.\n  for (const method in logMethods) {\n    api[method] = logFunc(method, logMethods[method])\n  }\n\n  // Create log functions for the Timer to use.\n  // Follows the same style as above logMethods, but curries it once more\n  //    to align the timer parameters as needed.\n  const timeLog = (message, data) => logFunc(data.event, timeLevel, { timer: data })(message)\n  const timeWarn = (message, data) => logFunc('warn', logLevels.WARN, { timer: data })(message)\n  const timer = createTimer(timeLog, timeWarn)\n\n  return {\n    ...api,\n    ...timer\n  }\n}\n","import { checkHandler } from './validation'\n\n/**\n * Timer factory function.\n * The Timer imitates the Console's Time APIs.\n * Ref: https://developer.mozilla.org/en-US/docs/Web/API/console#Timers\n * @method createTimer\n * @param  {Function} log  Function for logging timer information.\n * @param  {Function} warn Function for warning about timer misuse.\n * @return {Timer}\n */\nexport default function createTimer(log, warn) {\n  // Validate that params are a function.\n  //    Uses functions as `log(message, data)`.\n  checkHandler(log)\n  checkHandler(warn)\n\n  /**\n   * Mapping of on-going timers; <name>: <start>.\n   * @type {Object}\n   */\n  const timers = {}\n\n  /**\n   * Starts a timer. Logs a message to indicate it was started.\n   * Logs a warning if the timer has already been started.\n   * @method timeStart\n   * @param  {string} name Name to identify the timer.\n   */\n  function time(name) {\n    const now = Date.now()\n    // Base info about this timer call.\n    const data = {\n      event: 'time',\n      name\n    }\n\n    if (timers.hasOwnProperty(name)) {\n      data.start = timers[name]\n      warn(`Timer ${name} already started.`, data)\n    } else {\n      // Set the new timer.\n      timers[name] = now\n\n      data.start = now\n      log(`Timer ${name} started.`, data)\n    }\n  }\n\n  /**\n   * Ends a timer. Logs a message with the elapsed time.\n   * @method timeEnd\n   * @param  {string} name Name to identify the timer.\n   */\n  function timeEnd(name) {\n    const now = Date.now()\n    // Base info about this timer call.\n    const data = {\n      event: 'timeEnd',\n      name,\n      start: timers[name]\n    }\n\n    if (timers.hasOwnProperty(name)) {\n      const start = timers[name]\n      // End the timer.\n      delete timers[name]\n\n      const elapsed = now - start\n      data.end = now\n      data.elapsed = elapsed\n\n      log(`Timer ${name} ended, taking ${elapsed}ms.`, data)\n    } else {\n      warn(`Timer ${name} has not been started.`, data)\n    }\n  }\n\n  /**\n   * Adds a split to the timer. Logs a message with the elapsed time so far.\n   * Logs a warning if the timer has not been started.\n   * @method timeSplit\n   * @param  {string} name Name to identify the timer.\n   */\n  function timeLog(name) {\n    const now = Date.now()\n    // Base info about this timer call.\n    const data = {\n      event: 'timeLog',\n      name,\n      start: timers[name]\n    }\n\n    if (timers.hasOwnProperty(name)) {\n      const elapsed = now - timers[name]\n      data.split = now\n      data.elapsed = elapsed\n\n      log(`Timer ${name} split, at ${elapsed}ms so far.`, data)\n    } else {\n      warn(`Timer ${name} has not been started.`, data)\n    }\n  }\n\n  return {\n    time,\n    timeEnd,\n    timeLog\n  }\n}\n","import { logLevels } from './constants'\n\n/**\n * Helper function to validate a \"log level\" string before its used in the library.\n * @method checkLevel\n * @param  {string} level A log level provided by a user.\n * @return {string}       The log level as expected by the library.\n * @throws Will throw an error if the `level` parameter is invalid.\n */\nexport function checkLevel(level) {\n  // Ensure: is defined and is a string.\n  const upperLevel = level && level.toUpperCase && level.toUpperCase()\n\n  // Ensure: is a supported log level.\n  if (upperLevel && logLevels[upperLevel]) {\n    return logLevels[upperLevel]\n  } else {\n    throw new Error('Provided level is not a valid log level.')\n  }\n}\n\n/**\n * Helper function to validate a \"log handler\".\n * Basically just \"is function\" that throws an error if false.\n * @method checkHandler\n * @param  {Function} handler A log handler function, ideally.\n * @return {Function}         The same log handler function, ideally.\n * @throws Will throw an error if the `handler` provided is not a function.\n */\nexport function checkHandler(handler) {\n  if (handler && typeof handler === 'function') {\n    return handler\n  } else {\n    throw new Error('Provided log handler is not a function.')\n  }\n}\n","import createReporter from './reporter'\n\n/**\n * Package main.\n */\n\n// Main export is the manager's factory function.\nexport default createReporter\n","import createTimelineEvent from './timelineEvent'\n\n// Utils\nimport { isString } from 'lodash/fp'\n\n/**\n * Factory function to create reports.\n * @method reportFactory\n * @param {string} type The type of report to be created.\n * @param {id} The unique identifier for this new report.\n * @return {Report}\n */\nexport default function reportFactory(type, id) {\n  const API_TAG = 'API invoked: '\n  // Events (for this report instance) will be appended to this timeline\n  const timeline = []\n  // Data (associated with this report) will be indexed by the specific data type\n  const reportData = {}\n  // Computed metrics\n  const metrics = []\n  // A map of metrics and the events and handlers used to compute them.\n  const metricHandlers = {}\n\n  /**\n   * Add a new event to the Reports timeline.\n   * @method addEvent\n   * @param {string} The type of event being added.\n   * @throws {Error} Throws an error if type fails to validate.\n   * @return {TimelineEvent} A new TimelineEvent.\n   */\n  function addEvent(type) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}report.addEvent: Invalid type (${typeof type}), must be of type string.`)\n    }\n    const newEvent = createTimelineEvent(type, onEventEnded)\n    timeline.push(newEvent)\n\n    return newEvent\n  }\n\n  /**\n   * Add data to the Report.\n   * @method addData\n   * @param {string} type The type of data being added to the Report.\n   * @param {*} data The data being added to the Report.\n   * @throws {Error} Throws an error if any of the two parameters fail to validate.\n   * @return {undefined}\n   */\n  function addData(type, data) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}report.addData: Invalid type (${typeof type}), must be of type string.`)\n    }\n    if (data === undefined) {\n      throw new Error(`${API_TAG}report.addData: No data provided.`)\n    }\n    reportData[type] = data\n  }\n\n  /**\n   * Find and return data added to a report.\n   * @method getData\n   * @param {string|undefined} key The key the for the data requested, if no key is provided return the entire data object.\n   * @return {*} The data mapped to key.\n   */\n  function getData(key) {\n    if (key) {\n      return reportData[key]\n    } else {\n      return reportData\n    }\n  }\n\n  /**\n   * Add computed metric to the Report.\n   * @method addMetric\n   * @param {string} type The type of metric being added to the Report.\n   * @param {*} data The metric data being added to the Report.\n   * @throws {Error} Throws an error if the type is not of type string.\n   * @return {undefined}\n   */\n  function addMetric(type, data) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}report.addMetric: Invalid type (${typeof type}), must be of type string.`)\n    }\n    if (data === undefined) {\n      throw new Error(`${API_TAG}report.addMetric: No data provided.`)\n    }\n    metrics.push({ type, data })\n  }\n\n  /**\n   * Update computed metric in the Report by adding the event ID which was responsible\n   * for computing such metric.\n   * There could be multiple events which account for the calculation (or updating)\n   * of a given metric value so any time this function is called, it will add event ID to existing\n   * list of event IDS.\n   * @method addEventIdToMetric\n   * @param {string} type The type of metric being updated in the Report.\n   * @param {string} eventId The event ID, as a unique identifier.\n   * @throws {Error} Throws an error if the type is not a string.\n   * @throws {Error} Throws an error if the type is not found.\n   * @throws {Error} Throws an error if the eventId is not a string.\n   * @throws {Error} Throws an error if the eventId is not found.\n   * @return {undefind}\n   */\n  function addEventIdToMetric(type, eventId) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}report.addEventIdToMetric: Invalid type (${typeof type}), must be of type string.`)\n    }\n    if (!eventId || !isString(eventId)) {\n      throw new Error(\n        `${API_TAG}report.addEventIdToMetric: Invalid eventId (${typeof eventId}), must be of type string.`\n      )\n    }\n    const metric = metrics.find(metric => metric.type === type)\n\n    if (!metric) {\n      return\n    }\n    if (!metric.eventIds) {\n      metric.eventIds = []\n    }\n    // Adding in the order the events happen.\n    // (i.e. last eventId in array being the most recent one)\n    metric.eventIds.push(eventId)\n  }\n\n  /**\n   * Get the data for a provided metric type.\n   * @method getMetric\n   * @param {string} type The type of metric to return.\n   * @throws {Error} Throws an error if the type is not a string.\n   * @return {*} The data associated with the provided metric type.\n   */\n  function getMetric(type) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}report.getMetric: Invalid type (${typeof type}), must be of type string.`)\n    }\n\n    return metrics.filter(metric => metric.type === type).map(metric => metric.data)\n  }\n\n  /**\n   * Register a handler to allow the user to act on specific events once they've ended.\n   * @method registerMetricHandler\n   * @param type {string} An identifier for the type of metric to be handled.\n   * @param events {Array} An array of event types that trigger this handler.\n   * @param handler {function} A function that handles the event for this metric type.\n   * @throws {Error} Throws an error if any of the three parameters fail to validate.\n   * @return {undefined}\n   */\n  function registerMetricHandler(type, events, handler) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}report.registerMetricHandler: Invalid type (${typeof type}), must be of type string.`)\n    }\n    if (!events) {\n      throw new Error(\n        `${API_TAG}report.registerMetricHandler: Invalid events (${typeof type}), must be a string or an array with at least one event type.`\n      )\n    }\n    if (!handler || typeof handler !== 'function') {\n      throw new Error(\n        `${API_TAG}report.registerMetricHandler: Invalid handler (${typeof handler}, must be a function.)`\n      )\n    }\n\n    if (isString(events)) {\n      events = [events]\n    }\n\n    // Add/update the handler to our event handler map.\n    metricHandlers[type] = {\n      events,\n      handler\n    }\n  }\n\n  /**\n   * Unregister a metric handler.\n   * @method unregisterMetricHandler\n   * @param type {string} An identifier for the type of metric we no longer need to report on.\n   * @return {undefined}\n   */\n  function unregisterMetricHandler(type) {\n    if (type) {\n      delete metricHandlers[type]\n    }\n  }\n\n  /**\n   * A listener for when TimelineEvents have ended.\n   * This listener will only invoke the metric handler, if the passed event had no error.\n   * This way, all our calculated metric values apply only to successful scenarios.\n   *\n   * @method onEventEnded\n   * @param {Object} event The event which has been ended.\n   * @return undefined\n   */\n  function onEventEnded(event) {\n    if (event.error) {\n      // Don't allow metrics to be created for failed events.\n      return\n    }\n    // Check if we need to run a metric calculation handler against this event\n    for (const metric in metricHandlers) {\n      if (metricHandlers[metric].events.includes(event.type)) {\n        // Call the provided metric handler.\n        metricHandlers[metric].handler(report, event)\n        // Add the event's ID to the metric.\n        addEventIdToMetric(metric, event.id)\n      }\n    }\n  }\n\n  /**\n   * Traverse the list of events and return the first one that matches the provided id.\n   * @method getEvent\n   * @param {string} id The id for the event being requested.\n   * @return {TimelineEvent} The event with matching id.\n   */\n  function getEvent(id) {\n    for (let i = 0; i < timeline.length; i++) {\n      if (timeline[i].id === id) {\n        return timeline[i]\n      } else {\n        const subEvent = timeline[i].getEvent(id)\n        if (subEvent) {\n          return subEvent\n        }\n      }\n    }\n  }\n\n  /**\n   * Find the last event of a specific type.\n   * @method findLastOngoingEvent\n   * @param {Array<string>|string} [type] The type of event to search for.\n   * @return {TimelineEvent} The last event matching the provided type.\n   */\n  function findLastOngoingEvent(type) {\n    // KJS-1898: Using an alternative way for `findLast` as that prototype method is not supported in Chrome versions prior to M97.\n    // TODO: Revert back to using `findLast` once our babel strategy is finalized.\n\n    // Make a copy first, since `reverse()` will do a mutation on original array, which we don't want\n    // for the rest of operatins within this report.\n    const copiedTimeline = [...timeline]\n    return copiedTimeline.reverse().find(event => {\n      // If no type is provided return the latest ongoing event\n      // If an array is provided, find the last ongoing event that is part of the array\n      // If a string is provided, find that particular last ongoing event\n      if (!type && !event.isEnded()) {\n        return event\n      } else if (Array.isArray(type) && type.includes(event.type) && !event.isEnded()) {\n        return event\n      } else if (event.type === type && !event.isEnded()) {\n        return event\n      }\n    })\n  }\n\n  /**\n   * Return a serializable version of this Report.\n   * @method getSerializable\n   * @return {Object} A read-only, serializable version of the Report.\n   */\n  function getSerializable() {\n    // We omit the functions and just return the properties.\n    return {\n      type,\n      id,\n      timeline: timeline.map(event => event.getSerializable()),\n      data: reportData,\n      metrics\n    }\n  }\n\n  const report = {\n    type,\n    id,\n    timeline,\n    metrics,\n    addEvent,\n    getEvent,\n    findLastOngoingEvent,\n    addData,\n    getData,\n    addMetric,\n    getMetric,\n    registerMetricHandler,\n    unregisterMetricHandler,\n    getSerializable\n  }\n\n  return report\n}\n","import reportFactory from './report'\n\n// Utils\nimport { isString } from 'lodash/fp'\n\n/**\n * Creates a Reporter.\n * @method createReporter\n * @return {Reporter}\n */\nexport default function createReporter() {\n  const API_TAG = 'API invoked: '\n\n  // All reports created so far, indexed by id.\n  const reports = {}\n\n  /**\n   * Create a new report.\n   * @method createReport\n   * @param type {string} The type of report to create.\n   * @param id {string} A unique identifier to represent this report.\n   * @throws {Error} Throws an error if any of the two parameters fail to validate.\n   * @return {Report} A new Report is returned if validation passed.\n   */\n  function createReport(type, id) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}reporter.createReport: Invalid type (${typeof type}), must be of type string.`)\n    }\n\n    if (!id || !isString(id)) {\n      throw new Error(`${API_TAG}reporter.createReport: Invalid id (${typeof id}), must be of type string.`)\n    }\n\n    if (reports.hasOwnProperty(id)) {\n      throw new Error(`${API_TAG}reporter.createReport: Cannot create report. One already exists for id: ${id}`)\n    }\n    // Create a blank report\n    const newReport = reportFactory(type, id)\n\n    // ... and it under the id that was provided\n    reports[id] = newReport\n\n    return newReport\n  }\n\n  /**\n   * Get a report.\n   * @method getReport\n   * @param {string} id A unique identifier representing a report.\n   * @return {Report|undefined} The report object or undefined if no report was found for that id (or the id was invalid).\n   */\n  function getReport(id) {\n    return reports[id]\n  }\n\n  /**\n   * Delete a report.\n   * @method deleteReport\n   * @param {string} id A unique identifier representing a report.\n   * @throws {Error} Throws an error if id fails to validate.\n   * @return {undefined}\n   */\n  function deleteReport(id) {\n    if (!id || !isString(id)) {\n      throw new Error(`${API_TAG}reporter.deleteReport: Invalid id ${typeof id} (must be of type string).`)\n    }\n    delete reports[id]\n  }\n  return {\n    createReport,\n    getReport,\n    deleteReport\n  }\n}\n","// Utils\nimport { isString } from 'lodash/fp'\nimport { v4 as uuidV4 } from 'uuid'\n\n/**\n * Creates a TimelineEvent.\n * @method createTimelineEvent\n * @param {string} The type of event being created.\n * @return {TimelineEvent}\n */\nexport default function createTimelineEvent(type, onEventEnded, pId) {\n  const start = new Date().getTime()\n  const id = uuidV4()\n  // The id of this events parent (if one exists)\n  const parentId = pId\n  //  this will hold any sub-events for this event\n  const timeline = []\n  // this will hold associated data for this event, indexed by type\n  const eventData = {}\n  // Computed metrics\n  const metrics = []\n\n  const API_TAG = 'API invoked: '\n  /**\n   * Add a new event to this events timeline.\n   * @method addEvent\n   * @param {string} type The type of event being added.\n   * @throws {Error} Throws an error if type fails to validate.\n   * @return {TimelineEvent} A new TimelineEvent.\n   */\n  function addEvent(type) {\n    if (this.end) {\n      // iF event was marked as ended, we cannot add further sub-events to it.\n      throw new Error(\n        `${API_TAG}timelineEvent.addEvent: Cannot add further sub-events. Event has been marked as ended.`\n      )\n    }\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}timelineEvent.addEvent: Invalid type (${typeof type}), must be of type string.`)\n    }\n    const newSubEvent = createTimelineEvent(type, onEventEnded, id)\n\n    // Store the sub-event in the timeline beloging to parent event\n    timeline.push(newSubEvent)\n\n    return newSubEvent\n  }\n\n  /**\n   * Add data to the TimelineEvent.\n   * @method addData\n   * @param {string} type The type of data being added to the TimelineEvent.\n   * @param {Object} data The data being added to the TimelineEvent.\n   * @throws {Error} Throws an error if type fails to validate.\n   * @return {undefined}\n   */\n  function addData(type, data) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}timelineEvent.addData: Invalid type (${typeof type}), must be of type string.`)\n    }\n    if (data === undefined) {\n      throw new Error(`${API_TAG}timelineEvent.addData: No data provided.`)\n    }\n    // Add data to parent event (event if parent event has been marked as ended)\n    eventData[type] = data\n  }\n\n  /**\n   * Find and return data added to a report.\n   * @method getData\n   * @param {string|undefined} key The key the for the data requested, if no key is provided return the entire data object.\n   * @return {*} The data mapped to key.\n   */\n  function getData(key) {\n    if (key) {\n      return eventData[key]\n    } else {\n      return eventData\n    }\n  }\n\n  /**\n   * Add computed metric to the TimelineEvent.\n   * @method addMetric\n   * @param {string} type The type of metric being added to the TimelineEvent.\n   * @param {*} data The metric data being added to the TimelineEvent.\n   * @throws {Error} Throws an error if the type is not of type string.\n   * @return {undefined}\n   */\n  function addMetric(type, data) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}timelineEvent.addMetric: Invalid type (${typeof type}), must be of type string.`)\n    }\n    if (data === undefined) {\n      throw new Error(`${API_TAG}timelineEvent.addMetric: No data provided.`)\n    }\n    metrics.push({ type, data })\n  }\n\n  /**\n   * Get the data for a provided metric type.\n   * @method getMetric\n   * @param {string} type The type of metric to return.\n   * @throws {Error} Throws an error if the type is not a string.\n   * @return {*} The data associated with the provided metric type.\n   */\n  function getMetric(type) {\n    if (!type || !isString(type)) {\n      throw new Error(`${API_TAG}timelineEvent.getMetric: Invalid type (${typeof type}), must be of type string.`)\n    }\n\n    return metrics.filter(metric => metric.type === type).map(metric => metric.data)\n  }\n\n  /**\n   * Traverse the list of events and return the first one that matches the provided id.\n   * @method getEvent\n   * @param {string} id The id for the event being requested.\n   * @return {TimelineEvent} The event with matching id.\n   */\n  function getEvent(id) {\n    for (let i = 0; i < timeline.length; i++) {\n      if (timeline[i].id === id) {\n        return timeline[i]\n      } else {\n        const subEvent = timeline[i].getEvent(id)\n        if (subEvent) {\n          return subEvent\n        }\n      }\n    }\n  }\n\n  /**\n   * Find the last event of a specific type.\n   * @method findLastOngoingEvent\n   * @param {string} type The type of event to search for.\n   * @return {TimelineEvent} The last event matching the provided type.\n   */\n  function findLastOngoingEvent(type) {\n    // KJS-1898: Using an alternative way for `findLast` as that prototype method is not supported in Chrome versions prior to M97.\n    // TODO: Revert back to using `findLast` once our babel strategy is finalized.\n\n    // Make a copy first, since `reverse()` will do a mutation on original array, which we don't want\n    // for the rest of operatins within this report.\n    const copiedTimeline = [...timeline]\n    return copiedTimeline.reverse().find(event => {\n      if (event.type === type && !event.isEnded()) {\n        return event\n      }\n    })\n  }\n\n  /**\n   * End a TimelineEvent.\n   * @method endEvent\n   * @param {Error} An optional error object.\n   *   This can be provided if there is an error by the time SDK ends this event instance.\n   * @return {undefined}\n   */\n  function endEvent(err) {\n    if (this.end) {\n      // We already marked this event as ended.\n      return\n    }\n    if (err) {\n      this.error = err\n    }\n    this.end = new Date().getTime()\n    onEventEnded(event)\n  }\n\n  /**\n   * Check if the event has an end time.\n   * @method isEnded\n   * @return {boolean}\n   */\n  function isEnded() {\n    return !!this.end\n  }\n\n  /**\n   * Set an error on the event.\n   * @method setError\n   * @param {Error} An error object.\n   * @throws {Error} An error indicating that the event has already ended.\n   * @return {undefined}\n   */\n  function setError(err) {\n    if (this.end) {\n      throw new Error(\"Can't set error on an event that has already ended.\")\n    }\n    this.error = err\n  }\n\n  /**\n   * Get an error that may have been set on this event.\n   * @method getError\n   * @return {Error|undefined}\n   */\n  function getError() {\n    return this.error\n  }\n\n  /**\n   * Return a serializable version of this TimelineEvent.\n   * @method getSerializable\n   * @return {Object} A read-only, serializable version of the TimelineEvent.\n   */\n  function getSerializable() {\n    // We omit the functions and return just the properties.\n    return {\n      type,\n      id,\n      parentId,\n      timeline: timeline.map(event => event.getSerializable()),\n      data: eventData,\n      metrics,\n      start,\n      end: this.end,\n      error: this.error\n    }\n  }\n\n  const event = {\n    type,\n    id,\n    parentId,\n    timeline,\n    metrics,\n    start,\n    addEvent,\n    isEnded,\n    getEvent,\n    findLastOngoingEvent,\n    addData,\n    getData,\n    addMetric,\n    getMetric,\n    endEvent,\n    setError,\n    getError,\n    getSerializable\n  }\n\n  return event\n}\n","import { PEER } from '../constants'\n\n/**\n * Configuration object for a Peer.\n * @typedef {Object} PeerConfig\n * @property {Object} [rtcConfig] Configuration for the native RTCPeerConnection.\n * @property {String} [trickleIceMode=FULL] The initial mode the Peer will use when receiving ICE candidates.\n * @property {Boolean} [removeBundling=false] Remove the a=group attribute to stop media bundling\n * @property {Function} [halfTrickleThreshold] Function that determines whether the threshold has been met when in HALF trickle mode.\n */\nexport default {\n  trickleIceMode: PEER.TRICKLE_ICE.FULL,\n  removeBundling: false,\n  halfTrickleThreshold: isPassedHalfTrickleThreshold\n}\n\n/**\n * Default function for determining whether the HALF trickle ICE threshold has\n *    been met, to start trickling ICE candidates.\n * Defines the threshold as one relay candidate being gathered.\n * @method isPassedHalfTrickleThreshold\n * @param  {String}             sdp          The local SDP of the Peer.\n * @param  {RTCIceCandidate}    iceCandidate The native candidate object that triggered this check.\n * @param  {Number}             time         The amount of time (ms) since ICE collection began.\n * @return {Boolean} Whether the \"half trickle\" threshold has been passed.\n */\nfunction isPassedHalfTrickleThreshold({ sdp, iceCandidate, time }) {\n  const passedHalf = iceCandidate.candidate.indexOf('relay') !== -1\n  return passedHalf\n}\n","import { PEER } from '../../constants'\n\n/**\n * Event wrapper for `icecandidate` event.\n * Reference: developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/onicecandidate\n * @method onicecandidate\n * @param  {Function} listener The listener function for the event.\n * @return {Boolean}  Whether the assignment succeeded or not.\n */\nexport default function onicecandidate(listener) {\n  const { nativePeer, proxyPeer, config, iceTimer, emitter, iceCandidates, log } = this\n\n  /**\n   * Intercept the PeerConnection onicecandidate event.\n   * Handle the candidate as defined by the current trickle ICE mode config.\n   * Trickle ICE scenarios:\n   *   - FULL: Trickle.\n   *   - HALF, pre-half: Wait for \"half\" or null candidate.\n   *   - HALF, post-half: Trickle.\n   *   - NONE: Wait for null candidate.\n   */\n  nativePeer.onicecandidate = event => {\n    log.debug(\n      `ICE candidate received (trickling?: ${config.trickleIceMode === PEER.TRICKLE_ICE.FULL}): `,\n      event.candidate\n    )\n\n    // Keep track of all candidates gathered by this collection process.\n    if (event.candidate !== null) {\n      iceCandidates.push(event.candidate)\n    }\n\n    // Emit an event for the session to pick up for the ice collection check\n    const elapsedTime = iceTimer.timeFromStart()\n    emitter.emit('iceCandidateCollected', {\n      iceCollectionDuration: elapsedTime,\n      iceCandidates,\n      iceGatheringState: proxyPeer.iceGatheringState,\n      rtcPeerConnectionConfig: config,\n      rtcLocalSessionDescription: proxyPeer.localDescription\n    })\n\n    if (config.trickleIceMode === PEER.TRICKLE_ICE.FULL) {\n      // If trickling is enabled, emit an event for every ICE candidate. The\n      //    Peer is already ready for negotiation at this point.\n      if (event.candidate) {\n        // Only trickle non-null (ie. actual) candidates.\n        listener(event)\n      }\n    } else if (config.trickleIceMode === PEER.TRICKLE_ICE.HALF) {\n      // For half trickle, only start trickling after a certain threshold.\n      //    Peer will be considered ready for negotiation after that point.\n      const haveHalf = config.halfTrickleThreshold({\n        sdp: proxyPeer.localDescription.sdp,\n        iceCandidate: event.candidate,\n        time: elapsedTime\n      })\n\n      if (haveHalf) {\n        log.debug('Half ICE collection process complete; ready for negotiation.')\n        config.trickleIceMode = PEER.TRICKLE_ICE.FULL\n        emitter.emit('onnegotiationready')\n      } else {\n        log.debug(\"Peer's half trickle threshold not reached.\")\n      }\n    }\n  }\n\n  return true\n}\n","/**\n * Event wrapper for `iceconnectionstatechange` event.\n * Reference: developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/oniceconnectionstatechange\n * @method oniceconnectionstatechange\n * @param  {Function} listener The listener function for the event.\n * @return {Boolean}  Whether the assignment succeeded or not.\n */\nexport default function oniceconnectionstatechange(listener) {\n  const { nativePeer, log } = this\n\n  nativePeer.oniceconnectionstatechange = function (event) {\n    log.debug(`Peer received iceconnectionstatechange event: ${nativePeer.iceConnectionState}`)\n    listener(event)\n  }\n\n  return true\n}\n","import { PEER } from '../../constants'\n\n/**\n * Event wrapper for `icegatheringstatechange` event.\n * Reference: developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/onicegatheringstatechange\n * @method onicegatheringstatechange\n * @param  {Function} listener The listener function for the event.\n * @return {Boolean}  Whether the assignment succeeded or not.\n */\nexport default function onicegatheringstatechange(listener) {\n  const { nativePeer, iceTimer, log } = this\n\n  /**\n   * Intercept the PeerConnection onicegatheringstatechange event.\n   * Time how long ICE collection takes and handles scenarios when it takes\n   *    too long.\n   */\n  nativePeer.onicegatheringstatechange = event => {\n    const gatheringState = event.target.iceGatheringState\n    log.debug(`Peer iceGatheringState changed to ${gatheringState}.`)\n\n    if (gatheringState === PEER.ICE_GATHERING_STATE.GATHERING) {\n      iceTimer.start()\n      // TODO: Handle \"ICE collection taking too long\" scenario.\n    } else if (gatheringState === PEER.ICE_GATHERING_STATE.COMPLETE) {\n      log.debug(`Peer took ${iceTimer.timeFromStart()}ms to collect ICE candidates.`)\n      iceTimer.stop()\n    }\n    // Bubble the event up.\n    listener(event)\n  }\n\n  return true\n}\n","import onicecandidate from './icecandidate'\nimport oniceconnectionstatechange from './iceconnectionstatechange'\nimport onicegatheringstatechange from './icegatheringstatechange'\nimport onnegotiationneeded from './negotiationneeded'\nimport onsignalingstatechange from './signalingstatechange'\nimport ontrack from './track'\n\nexport default {\n  onicecandidate,\n  oniceconnectionstatechange,\n  onicegatheringstatechange,\n  onnegotiationneeded,\n  onsignalingstatechange,\n  ontrack\n}\n","/**\n * Event wrapper for `negotiationneeded` event.\n * Reference: developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/onnegotiationneeded\n * @method onnegotiationneeded\n * @param  {Function} listener The listener function for the event.\n * @return {Boolean}  Whether the assignment succeeded or not.\n */\nexport default function onnegotiationneeded(listener) {\n  const { nativePeer, log } = this\n\n  nativePeer.onnegotiationneeded = function (event) {\n    log.debug('Peer received negotiationneeded event.')\n    listener(event)\n  }\n\n  return true\n}\n","/**\n * Event wrapper for `signalingstatechange` event.\n * Reference: developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/onsignalingstatechange\n * @method onsignalingstatechange\n * @param  {Function} listener The listener function for the event.\n * @return {Boolean}  Whether the assignment succeeded or not.\n */\nexport default function onsignalingstatechange(listener) {\n  const { nativePeer, log } = this\n\n  nativePeer.onsignalingstatechange = function (event) {\n    log.debug(`Peer received signalingstatechange event: ${nativePeer.signalingState}`)\n    listener(event)\n  }\n\n  return true\n}\n","/**\n * Event wrapper for `track` event.\n * Reference: developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/ontrack\n * @method ontrack\n * @param  {Function} listener The listener function for the event.\n * @return {Boolean}  Whether the assignment succeeded or not.\n */\nexport default function ontrack(listener) {\n  const { proxyPeer, nativePeer, trackManager, log } = this\n\n  nativePeer.ontrack = async event => {\n    /**\n     * transceiver: The RTCRtpTransceiver for this remote track. (Available in unified-plan)\n     * receiver: The RTCRtpReceiver for this remote track.\n     * track: The remote MediaStreamTrack.\n     * streams: Array of MediaStreams the track is in.\n     */\n    // event object contains transceiver which already has track attached to its receiver\n    const { track: nativeTrack, streams, transceiver } = event\n    log.debug(`Peer received ${nativeTrack.kind} Track ${nativeTrack.id}.`)\n\n    if (!proxyPeer.transceivers.find(tran => tran.mid === transceiver.mid)) {\n      // If we are not already tracking this Transceiver in the Peer model, then add it.\n      proxyPeer.transceivers.push(transceiver)\n    }\n\n    /*\n     * When the remote side adds a track, it should have an associated MediaStream\n     *    which we get access to here. This allows us to listen for events on that\n     *    MediaStream (important for knowing when the track has ended).\n     * It's possible that the remote Sender does not have a Stream set, so we create\n     *    a Stream for it. This should be considered a problematic scenario, since\n     *    we rely on the remote Stream for certain events.\n     * Reference: KAA-2628\n     */\n    let targetStream\n    if (streams.length === 0) {\n      targetStream = await new MediaStream([nativeTrack])\n      log.debug('New Track is not associated with remote Stream.')\n    } else {\n      targetStream = streams[0]\n      log.debug(`New Track is associated with remote Stream ${targetStream.id}.`)\n    }\n\n    // Convert the native MediaStreamTrack into a Track object.\n    // Specify that this is not a local one (i.e. it's a remote track)\n    const track = trackManager.add(nativeTrack, nativeTrack.kind, targetStream, false)\n\n    listener(track)\n  }\n\n  return true\n}\n","/*\n * Wrapper imports.\n * Events, methods, and properties that we want to wrap/add to the native Peer.\n */\nimport events from './events'\nimport methods from './methods'\nimport properties from './properties'\n\nimport defaults from './config'\nimport { logManager } from '../logs'\n\n// Libraries.\nimport mergeValues from '@rbbn/utilities/mergeValues'\nimport EventEmitter from 'rbbn-emitter'\nimport { createTimer } from './utils/timer'\n\n// EXTERNAL PROXY CODE\nlet proxies\n/**\n * Function used to apply proxied functionality on top of the peer. Typically triggered by an\n * external proxy SDK.\n */\nexport function setPeerProxies(peerProxies) {\n  proxies = peerProxies\n}\n\n/**\n * Create a Proxied Peer.\n * This Peer is a native PeerConnection that has had some new functionality\n *    added and some existing functionality \"augmented\". Where an event, a\n *    method, or a property has been defined (see folders), we intercept/add\n *    that functionality.\n * @method peer\n * @return {Peer}\n */\nexport default function peer(id, config = {}, trackManager) {\n  const log = logManager.getLogger('Peer', id)\n  config = mergeValues(defaults, config)\n  log.info('Creating new Peer.')\n\n  const iceTimer = createTimer()\n  const emitter = new EventEmitter()\n\n  // Create the native Peer.\n  log.debug('Creating native PeerConnection.', config.rtcConfig)\n  const nativePeer = new RTCPeerConnection(config.rtcConfig, { optional: [{ googDscp: true }] })\n\n  // Add the event emitter methods to the wrapped methods as well.\n  const customMethods = {\n    ...methods,\n    ...proxies, // EXTERNAL PROXY CODE\n    on: emitter.on.bind(emitter),\n    off: emitter.off.bind(emitter),\n    once: emitter.once.bind(emitter)\n  }\n\n  /**\n   * The Peer model.\n   * @typedef {Peer}\n   * @property {RTCPeerConnection} peer     The native PeerConnection.\n   * @property {string}            id       The unique identifier for the Peer.\n   * @property {boolean}           dtlsRole The DTLS role selected for this PeerConnection. Set after the initial negotiation is completed.\n   * @property {Object}            trackManager Manager that tracks all MediaStreamTracks.\n   * @property {Object}            log      Logger specific to this Peer.\n   * @property {Object}            iceTimer Timer tool (specifically for ICE collection).\n   * @property {EventEmitter}      emitter\n   * @property {Array<RTCIceCandidate>} iceCandidates Gathered candidates.\n   * @property {timeoutID} [iceLoop] Reference to the on-going ICE collection loop.\n   * @property {Array<RTCRtpTransceiver>} transceivers List of transceivers on the peer.\n   */\n  const base = {\n    nativePeer,\n    proxyPeer: undefined,\n    id,\n    dtlsRole: null,\n    config,\n    trackManager,\n    log,\n    iceTimer,\n    emitter,\n    iceCandidates: [],\n    iceLoop: undefined,\n    transceivers: []\n  }\n\n  /**\n   * Create the Proxy object that will be used as the PeerConnection.\n   *\n   * This will intercept all `get` and `set` operations and either forward them\n   *    directly to the real PeerConnection or to our wrapped operations.\n   * This allows us to shim part or all of the PeerConnection's API. We can\n   *    decide which operations we want to intercept while allowing others to\n   *    pass through unchanged.\n   */\n  base.proxyPeer = new Proxy(base, {\n    /**\n     * Intercept \"get\" calls on the Proxy.\n     * This function is called anytime a property on `base` is accessed,\n     *    eg. `base.someProp`\n     * @param {Object} target    base\n     * @param {string} prop      Property being accessed.\n     * @param {Object} receiver  The Proxy object.\n     */\n    get: function (target, prop, receiver) {\n      if (typeof base.nativePeer[prop] === 'function') {\n        /*\n         * If a function is being accessed, determine whether we want to\n         *    return the native function or our own.\n         */\n        if (Object.keys(customMethods).includes(prop)) {\n          // Return our wrapped version of the original function.\n          return customMethods[prop].bind(base)\n        } else {\n          // Return the original function, bound to have the original context.\n          return base.nativePeer[prop].bind(base.nativePeer)\n        }\n      } else if (customMethods[prop] && typeof customMethods[prop] === 'function') {\n        /*\n         * If a non-native function is being accessed, return our custom method.\n         * These are methods that are not on the native RTCPeerConnection\n         *    object, but we added to the old Peer model.\n         */\n        // TODO: Move all of this functionality to a higher level of abstraction.\n        return customMethods[prop].bind(base)\n      } else if (properties[prop]) {\n        /*\n         * If a PeerConnection property is being accessed, and we have a\n         *    wrapping for it, return our wrapper property.\n         */\n        if (typeof properties[prop] === 'function') {\n          // If our property wrapper is a function, call the function and return\n          //    the results.\n          return properties[prop].bind(base)()\n        } else {\n          // Otherwise, just return the original results.\n          return base.nativePeer[prop]\n        }\n      } else if (prop !== 'nativePeer' && base[prop]) {\n        /*\n         * If a Peer model property, other than the peer, is being accessed,\n         *    return it. The Peer model shouldn't have any properties that the\n         *    PeerConnection also has (to avoid conflicts).\n         */\n        return base[prop]\n      } else {\n        // Otherwise, return the property from the PeerConnection itself.\n        return base.nativePeer[prop]\n      }\n    },\n\n    /**\n     * Intercept \"set\" calls on the Proxy.\n     * This function is called anytime a property on `base` is assigned,\n     *    eg. `base.someProp = value`\n     * @method\n     * @param  {Object} target   base\n     * @param  {string} prop     Property being set.\n     * @param  {Any}    value    The value being set.\n     * @param  {Proxy}  receiver The Proxy object.\n     * @return {boolean}         Whether the assignment succeeded or not.\n     */\n    set: function (target, prop, value, receiver) {\n      if (events[prop]) {\n        // If a value is being set on one of our \"wrapped events\", then call\n        //    the \"event function\".\n        return events[prop].bind(base)(value)\n      } else if (prop === 'dtlsRole') {\n        /**\n         * Only allow the `dtlsRole` property of the Peer model be set. The\n         *    Session needs to be able to get/set this property, in the case\n         *    where it recreates the Peer multiple times, so it needs to set the\n         *    role to something specific.\n         * Reference: KAA-1816\n         */\n        base.dtlsRole = value\n        return true\n      } else {\n        // Otherwise, try to set the value on the native Peer.\n        return Reflect.set(base.nativePeer, prop, value)\n      }\n    }\n  })\n\n  /**\n   * For event debugging purposes, start with a dummy listener for every event.\n   *    This ensures our Proxy is listening for the events (in the case nothing\n   *    else is listening), so that debug information from the event wrappers\n   *    are logged.\n   */\n  for (const eventName in events) {\n    base.proxyPeer[eventName] = () => {}\n  }\n\n  return base.proxyPeer\n}\n","/**\n * Add an ICE candidate to the connection.\n * @method addIceCandidate\n * @param  {RTCIceCandidate} candidate A native candidate object.\n * @return {Promise} Resolves when the candidate is successfully added.\n */\nexport default function addIceCandidate(candidate) {\n  const { nativePeer, proxyPeer, id, log } = this\n  log.info('Adding ICE candidate.')\n\n  return new Promise((resolve, reject) => {\n    if (proxyPeer.remoteDescription.type && proxyPeer.remoteDescription.sdp) {\n      nativePeer.addIceCandidate(candidate).then(resolve).catch(reject)\n    } else {\n      log.info('Cannot set remote ICE candidate without a remote description.')\n      // TODO: Better error.\n      reject(new Error(`Peer ${id} cannot set remote ICE candidate without a remote description.`))\n    }\n  })\n}\n","/**\n * Add a Transceiver to the connection.\n * @method addTransceiver\n * @param  {Track} track A Track object.\n * @return {RTCRtpTransceiver}\n */\nexport default function addTransceiver(track) {\n  const { proxyPeer, nativePeer, log } = this\n  log.info(`Adding new ${track.track.kind} track.`)\n\n  let transceiver\n  try {\n    transceiver = nativePeer.addTransceiver(track.track, { direction: 'sendrecv', streams: [track.getStream()] })\n    // Store the reference to the Transceiver on our Peer as well.\n    proxyPeer.transceivers.push(transceiver)\n  } catch (err) {\n    // TODO: Better error handling.\n    log.info(`Failed to add track: ${err.message}`)\n  }\n\n  // TODO: What to return here? Probably shouldn't expose the transceiver itself.\n  return transceiver\n}\n","/**\n * Clean the Peer by closing the RTCPeerConnection.\n * @method close\n */\nexport default function close() {\n  const { nativePeer, id, emitter, iceLoop, log } = this\n  log.info('Closing Peer.')\n\n  if (iceLoop) {\n    // Clear the ICE collection loop timeout if it exists.\n    clearTimeout(iceLoop)\n  }\n\n  nativePeer.close()\n  emitter.emit('peer:closed', id)\n}\n","import { PEER } from '../../constants'\n\nimport { runPipeline } from '../../sdpUtils/pipeline'\nimport { removeTrickleIce, removeBundling, changeMediaDirection, preventDtlsRoleChange } from '../../sdpUtils/handlers'\n\n/**\n * Creates an SDP answer, given that a remote offer has been set.\n * @method createAnswer\n * @param  {RTCAnswerOptions} [options={}] Options used to customize the answer.\n * @param  {Object} [options.mediaDirections] Directions to use for media.\n * @param  {string} [options.mediaDirections.audio]\n * @param  {string} [options.mediaDirections.video]\n * @return {Promise} Resolves with the answer.\n */\nexport default function createAnswer(options = {}) {\n  const { nativePeer, config, dtlsRole, log } = this\n  log.info('Creating local answer.')\n\n  // Remove options.mediaDirections.\n  // This is because directions are now set in transceivers.\n  delete options.mediaDirections\n\n  return new Promise((resolve, reject) => {\n    nativePeer\n      .createAnswer(options)\n      .then(answer => {\n        const sdpHandlers = []\n\n        /*\n         * Always include the `preventDtlsRoleChange` handler. This ensures\n         *    that the SDP's DTLS role does not change during a renegotiation.\n         */\n        sdpHandlers.push(preventDtlsRoleChange)\n\n        if (config.trickleIceMode === PEER.TRICKLE_ICE.NONE) {\n          // Modify the answer to claim the Peer doesn't support trickle ICE.\n          sdpHandlers.push(removeTrickleIce)\n        }\n        if (config.removeBundling) {\n          // Modify the offer to remove media bundling\n          sdpHandlers.push(removeBundling)\n        }\n        if (options.mediaDirections) {\n          // Modify the answer to set media directions as desired.\n          sdpHandlers.push(changeMediaDirection(options.mediaDirections))\n        }\n        if (sdpHandlers.length > 0) {\n          // Run the SDP pipeline with only these handlers.\n          answer.sdp = runPipeline(sdpHandlers, answer.sdp, {\n            type: answer.type,\n            endpoint: PEER.ENDPOINT.LOCAL,\n            dtlsRole: dtlsRole\n          })\n        }\n\n        log.info('Finished creating local answer.')\n        resolve(answer)\n      })\n      .catch(reject)\n  })\n}\n","import { PEER } from '../../constants'\n\nimport { runPipeline } from '../../sdpUtils/pipeline'\nimport { removeTrickleIce, removeBundling, changeMediaDirection } from '../../sdpUtils/handlers'\n\n/**\n * Creates an SDP offer.\n * @method createOffer\n * @param  {RTCOfferOptions} [options={}] Options used to customize the offer.\n * @param  {Object} [options.mediaDirections] Directions to use for media.\n * @param  {string} [options.mediaDirections.audio]\n * @param  {string} [options.mediaDirections.video]\n * @return {Promise} Resolves with the offer.\n */\nexport default function createOffer(options = {}) {\n  const { nativePeer, config, log } = this\n  log.info('Creating local offer.')\n\n  // Remove options.mediaDirections.\n  // This is because directions are now set in transceivers.\n  delete options.mediaDirections\n\n  return new Promise((resolve, reject) => {\n    nativePeer\n      .createOffer(options)\n      .then(offer => {\n        const sdpHandlers = []\n        if (config.trickleIceMode === PEER.TRICKLE_ICE.NONE) {\n          // Modify the offer to claim the Peer doesn't support trickle ICE.\n          sdpHandlers.push(removeTrickleIce)\n        }\n        if (config.removeBundling) {\n          // Modify the offer to remove media bundling\n          sdpHandlers.push(removeBundling)\n        }\n        if (options.mediaDirections) {\n          // Modify the offer to set media directions as desired.\n          sdpHandlers.push(changeMediaDirection(options.mediaDirections))\n        }\n        if (sdpHandlers.length > 0) {\n          // Run the SDP pipeline with only these handlers.\n          offer.sdp = runPipeline(sdpHandlers, offer.sdp, {\n            type: offer.type,\n            endpoint: PEER.ENDPOINT.LOCAL\n          })\n        }\n\n        log.info('Finished creating local offer.')\n        resolve(offer)\n      })\n      .catch(reject)\n  })\n}\n","/**\n * Finds a transceiver that can be reused.\n * A transceiver can be reused if it satisfies the following conditions:\n *   - it does not have a track on its sender\n *   - it has the same kind (audio or video) as what we specified\n *   - it has been used before (if it has not been used then we are not \"reusing\" it)\n * @method findReusableTransceiver\n * @param {string} kind The kind of transceiver to find (audio or video)\n * @returns {Object} Transceiver object that matches kind, has no sender track, and has currentDirection. Otherwise undefined.\n */\nexport default function findReusableTransceiver(kind) {\n  const { proxyPeer } = this\n\n  const transceivers = proxyPeer.getTransceivers()\n  return transceivers.find(\n    transceiver =>\n      transceiver.sender.track == null &&\n      transceiver.receiver &&\n      transceiver.receiver.track &&\n      transceiver.receiver.track.kind === kind &&\n      // Ensure the transceiver is not stopped, it could be null if negotiation has not yet complete.\n      transceiver.currentDirection !== 'stopped'\n  )\n}\n","/**\n * Retrieve a snapshot of the Peer object's current state.\n * @method getState\n * @return {Object}\n */\nexport default function getState() {\n  const { proxyPeer, config, id } = this\n\n  return {\n    id,\n    config: config,\n    localDesc: proxyPeer.localDescription,\n    signalingState: proxyPeer.signalingState,\n    localTracks: proxyPeer.localTracks,\n    remoteTracks: proxyPeer.remoteTracks,\n    senderTracks: proxyPeer.senderTracks\n  }\n}\n","/**\n * Retrieve RTCStatsReport for a sender or the peerConnection.\n * @method getStats\n * @param {string} [TrackId] Return stats for peerConnection if trackId is not provided\n * @return {Promise} Resolves with the RTCStatsReport\n */\nexport default function getStats(trackId) {\n  const { nativePeer, proxyPeer, log } = this\n  log.info(`Getting stats ${trackId ? 'for track.' : '.'}`)\n  // If no trackId is supplied, get the stats from the RTCPeerConnection. Otherwise, find an RTCSender\n  // associated with the trackId and get the stats from it.\n\n  // Use the trackId if it was provided\n  if (trackId) {\n    return new Promise((resolve, reject) => {\n      const senders = proxyPeer.getSenders()\n      // search for a sender associated with the trackId\n      const sender = senders.find(sender => sender.track.id === trackId)\n      if (sender) {\n        sender.getStats().then(resolve).catch(reject)\n      } else {\n        const errMsg = `Cannot find sender with trackId: ${trackId}`\n        log.info(errMsg)\n        reject(new Error(errMsg))\n      }\n    })\n  } else {\n    // get the stats associated with the peerConnection if no trackId is supplied\n    return nativePeer.getStats()\n  }\n}\n","/**\n * Retrieve the list of Transceivers on the Peer.\n * @method getTransceivers\n * @return {Array<RTCRtpTransceiver>}\n */\nexport default function getTransceivers() {\n  const { proxyPeer } = this\n\n  // Return our Peer's saved list of transceivers instead of using the native\n  //    getTransceivers API. This is for \"proxied webrtc\" mode, where a native\n  //    API call causes delays.\n  return proxyPeer.transceivers\n}\n","import addIceCandidate from './addIceCandidate'\nimport addTransceiver from './addTransceiver'\nimport close from './close'\nimport createAnswer from './createAnswer'\nimport createOffer from './createOffer'\nimport findReusableTransceiver from './findReusableTransceiver'\nimport getState from './getState'\nimport getStats from './getStats'\nimport getTransceivers from './getTransceivers'\nimport removeTrack from './removeTrack'\nimport replaceTrack from './replaceTrack'\nimport sendDTMF from './sendDTMF'\nimport setLocalDescription from './setLocalDescription'\nimport setRemoteDescription from './setRemoteDescription'\n\nconst methods = {\n  addIceCandidate,\n  addTransceiver,\n  close,\n  createAnswer,\n  createOffer,\n  findReusableTransceiver,\n  getState,\n  getStats,\n  getTransceivers,\n  removeTrack,\n  replaceTrack,\n  sendDTMF,\n  setLocalDescription,\n  setRemoteDescription\n}\n\nexport default methods\n","/**\n * Remove a Track from the connection.\n * @method removeTrack\n * @param  {string} trackId An id for a Track object.\n */\nexport default function removeTrack(trackId) {\n  const { nativePeer, proxyPeer, log } = this\n  log.info(`Removing track ${trackId}.`)\n\n  const track = proxyPeer.senderTracks.find(track => track.id === trackId)\n  if (!track) {\n    log.info(`Invalid track ID ${trackId}; no such track found.`)\n    return\n  } else if (proxyPeer.signalingState === ' closed') {\n    log.info('Peer is closed; cannot remove track.')\n    return\n  }\n\n  // Get the RtpSender for the Track we want to remove.\n  const sender = proxyPeer\n    .getSenders()\n    .filter(sender => sender.track !== null)\n    .find(sender => sender.track.id === trackId)\n  nativePeer.removeTrack(sender)\n}\n","/**\n * Replaces a specified transceiver's sender.track.\n * @method replaceTrack\n * @param {Object} newTrack The MediaStreamTrack we want to place into the sender.\n * @param {Object} options Options for specifying which transceiver's sender should be replaced. They are ordered by priority.\n * @param {Array} [options.trackId] The track id whose transceivers we want to set the direction of.\n * @return {Object} A Promise object which is fulfilled once the track has been replaced\n */\nexport default function replaceTrack(newTrack, options) {\n  const { proxyPeer, log } = this\n  log.info(`Replacing track ${options.trackId} with new ${newTrack.kind} track.`)\n\n  return new Promise((resolve, reject) => {\n    // Find the transceiver related to the provided track ID.\n    const targetTransceiver = proxyPeer\n      .getTransceivers()\n      .find(transceiver => transceiver.sender.track && transceiver.sender.track.id === options.trackId)\n\n    const sender = targetTransceiver ? targetTransceiver.sender : undefined\n\n    if (sender) {\n      sender\n        .replaceTrack(newTrack)\n        .then(resolve)\n        .catch(error => {\n          log.info(`Failed to replace track; ${error.message}`)\n          reject(error)\n        })\n    } else {\n      log.info(`Failed to replace track; could not find track ${options.trackId}.`)\n      reject(new Error(`Sender for track ${options.trackId} not found.`))\n    }\n  })\n}\n","/**\n * Send DTMF tones.\n * @method sendDTMF\n * @param {Object} DTMFOptions The DTMF options.\n * @param {string} DTMFOptions.tone DTMF tone to send. Valid values are [0,1,2,3,4,5,6,7,8,9,#].\n * @param {number} DTMFOptions.duration=100 The amount of time, in milliseconds, that each DTMF tone should last.\n * @param {number} DTMFOptions.intertoneGap=70 The length of time, in milliseconds, to wait between tones.\n * @param {Object} [sendOptions] The send options.\n * @param {func} [sendOptions.callback] Optional callback for tone event .\n * @param {string} [sendOptions.trackId] The trackId of the sender to use.\n * @return {Boolean} Whether the DTMF tones were inserted\n */\nexport default function sendDTMF({ tone, duration = 100, intertoneGap = 70 }, { callback, trackId }) {\n  const { proxyPeer, log } = this\n  log.info('Sending DTMF tones.', tone)\n\n  if (!proxyPeer.getSenders) {\n    log.info('Failed to send tones; getSenders is not supported by this browser.')\n    return false\n  }\n  const senders = proxyPeer.getSenders()\n  // Use the trackId if it was provided\n  if (trackId) {\n    const sender = senders.find(sender => sender.track.id === trackId)\n    if (!sender) {\n      log.info(`Failed to send tones; could not find track ${trackId}.`)\n      return false\n    }\n    insertDTMF(sender, tone, duration, intertoneGap, callback, log)\n    return true\n  } else {\n    let result\n    for (let i = 0; i < senders.length; i++) {\n      result = insertDTMF(senders[i], tone, duration, intertoneGap, callback, log)\n      if (result) {\n        return true\n      }\n    }\n\n    log.info('Failed to send tones; could not find an appropriate track.')\n    return false\n  }\n}\n\n/**\n * Helper function to sendDTMF tones .\n * @private\n * @method insertDTMF\n * @param {sender} object\n * @param {string} tone\n * @param {number} duration\n * @param {number} intertoneGap\n * @param {Function} callback\n */\nfunction insertDTMF(sender, tone, duration, intertoneGap, callback, log) {\n  /**\n   * Event handler when tone is played.\n   * @private\n   * @method handleToneChangeEvent\n   * @param  {event} event\n   */\n  function handleToneChangeEvent(event) {\n    if (event.tone !== '') {\n      log.debug('Tone played: ' + event.tone)\n    } else {\n      log.debug('All tones have played.')\n    }\n  }\n\n  if (sender.dtmf) {\n    const dtmfSender = sender.dtmf\n    if (callback) {\n      dtmfSender.ontonechange = callback\n    } else {\n      dtmfSender.ontonechange = handleToneChangeEvent\n    }\n    try {\n      dtmfSender.insertDTMF(tone, duration, intertoneGap)\n      return true\n    } catch (err) {\n      log.debug(err.message)\n      return false\n    }\n  } else {\n    log.debug('The sender requires DTMF which is not support by this browser.')\n    return false\n  }\n}\n","import { PEER } from '../../constants'\n\n// Utils.\nimport iceCollectionScheduledCheck from '../utils/iceCollectionScheduledCheck'\n\n/**\n * Sets an SDP as the local description of the connection.\n * The returned Promise will resolve when the Peer is ready for negotiation,\n *    taking into account the Peer's `trickleIceMode` configuration.\n * @method setLocalDescription\n * @param  {RTCSessionDescription} sessionDesc\n * @return {Promise}\n */\nexport default function setLocalDescription(desc) {\n  const { nativePeer, proxyPeer, config, id, emitter, iceTimer, log } = this\n\n  // TODO: SDP pipeline here.\n  log.info(`Setting local description ${desc.type} in ${proxyPeer.signalingState} state.`)\n  log.debug(`Setting local description ${desc.type}:`, desc.sdp)\n\n  /**\n   * Scenario: A local answer SDP is being applied to the Peer, but it does\n   *    not have a selected DTLS role yet. This should occur during initial\n   *    negotiation, before responding with this Peer's answer.\n   * Set the local Peer's DTLS role depending on what role was generated. This\n   *    role will be kept throughout all renegotiations.\n   */\n  if (!this.dtlsRole && desc.type === 'answer') {\n    const dtlsMatch = desc.sdp.match(/a=setup:(\\w*?)[\\r\\n]/)\n    if (dtlsMatch) {\n      log.debug(`Selecting DTLS role ${dtlsMatch[1]}.`)\n      this.dtlsRole = dtlsMatch[1]\n    }\n  }\n\n  return new Promise((resolve, reject) => {\n    // We always want to wait for the PeerConnection to be ready for\n    //    negotiation before resolving setLocalDescription.\n    // Each trickle ICE option (FULL/HALF/NONE) emits \"negotiation ready\" event once.\n    emitter.once('onnegotiationready', () => {\n      if (iceTimer.isStarted()) {\n        // In a HALF trickle scenario, the Peer will be ready for negotiation\n        //    before ICE collection has completed. Log that timing.\n        log.debug(`Took ${iceTimer.timeFromStart()}ms to collect ICE candidates before negotiation.`)\n      }\n      resolve()\n    })\n\n    nativePeer\n      .setLocalDescription(desc)\n      .then(() => {\n        log.info('Finished setting local description.')\n        log.debug(`State is now ${proxyPeer.signalingState}.`)\n\n        if (config.trickleIceMode === PEER.TRICKLE_ICE.FULL) {\n          // Trickling ICE candidates means that we can begin negotiation immediately.\n          log.debug('Ready for negotiation (full trickleICE).')\n          emitter.emit('onnegotiationready')\n        } else {\n          // ICE candidates aren't always gathered (only initially and when something\n          //    changes), but we rely on \"gathering complete\" to know when the Peer is\n          //    ready for negotiation. Give the Peer some time to start gathering\n          //    before deciding if we need to wait for gathering to complete or not.\n          // The timeout is needed because of a bug in Chrome:\n          //    https://bugs.chromium.org/p/webrtc/issues/detail?id=1873\n          // Known issue: If candidate collection takes less time than this timeout,\n          //    the logged message will be incorrect, but will functionally still work.\n          setTimeout(() => {\n            if (proxyPeer.iceGatheringState === 'complete') {\n              // Gathering is \"complete\", so we are ready for negotiation.\n              log.debug('Ready for negotiation; ICE candidate collection not needed.')\n              emitter.emit('onnegotiationready')\n            } else {\n              log.debug(`Waiting for ICE collection process (${config.trickleIceMode}).`)\n              // Register the ice collection check function callback to start the candidate collection\n              //  looping process\n              proxyPeer.isIceCollectionCheckOngoing = true\n              iceCollectionScheduledCheck(this)\n            }\n          }, 25)\n        }\n      })\n      .catch(err => {\n        log.info('Failed to set local description.')\n        log.debug(`Peer ${id}: ${err}`)\n        // Parse native error. Make it more understand and/or\n        //    provide a better log about what went wrong.\n        reject(err)\n      })\n  })\n}\n","/**\n * Sets an SDP as the remote description of the connection.\n * @method setRemoteDescription\n * @param  {RTCSessionDescription} sessionDesc\n */\nexport default function setRemoteDescription(desc) {\n  const { nativePeer, proxyPeer, id, log } = this\n\n  // TODO: SDP pipeline here.\n  log.info(`Setting remote description ${desc.type} in ${proxyPeer.signalingState} state.`)\n  log.debug(`Setting remote description ${desc.type}:`, desc.sdp)\n\n  /**\n   * Scenario: A remote answer SDP is being applied to the Peer, but it does\n   *    not have a selected DTLS role yet. This should occur only when the\n   *    initial negotiation is being completed.\n   * Set the local Peer's DTLS role depending on what the remote Peer\n   *    selected. This role will be kept throughout all renegotiations.\n   */\n  if (!this.dtlsRole && desc.type === 'answer') {\n    const dtlsMatch = desc.sdp.match(/a=setup:(\\w*?)[\\r\\n]/)\n    if (dtlsMatch) {\n      const localRole = dtlsMatch[1] === 'active' ? 'passive' : 'active'\n      log.debug(`Selecting DTLS role ${localRole}. Remote Peer selected ${dtlsMatch[1]} DTLS role.`)\n      this.dtlsRole = localRole\n    }\n  }\n\n  // TODO: Update `config.trickleIceMode` to either NONE or FULL (from HALF)\n  //    depending on remote support, since HALF is only needed for initial.\n  return new Promise((resolve, reject) => {\n    nativePeer\n      .setRemoteDescription(desc)\n      .then(() => {\n        log.info('Finished setting remote description.')\n        log.debug(`State is now ${proxyPeer.signalingState}.`)\n        resolve()\n      })\n      .catch(err => {\n        log.info('Failed to set remote description.')\n        log.debug(`Peer ${id}: ${err}`)\n        // Parse native error. Make it more understand and/or\n        //    provide a better log about what went wrong.\n        reject(err)\n      })\n  })\n}\n","import localDescription from './localDescription'\nimport localTracks from './localTracks'\nimport remoteDescription from './remoteDescription'\nimport remoteTracks from './remoteTracksActive'\nimport remoteTracksAll from './remoteTracks'\nimport senderTracks from './senderTracks'\n\nexport default { localDescription, localTracks, remoteDescription, remoteTracks, remoteTracksAll, senderTracks }\n","/**\n * The SDP for the local end of the connection.\n * @method getLocalDescription\n */\nexport default function getLocalDescription() {\n  const { nativePeer, log } = this\n  log.info('Getting local description.')\n\n  const localDesc = nativePeer.localDescription\n  /*\n   * Ensure it is a RTCSessionDescription object.\n   * In some scenarios (based on browser?), it may return an empty object\n   *    instead of undefined when there is no local description.\n   * TODO: Determine if this is still needed, or if we can use the native\n   *    property directly.\n   */\n  if (localDesc && localDesc.sdp && localDesc.type) {\n    return localDesc\n  } else {\n    return undefined\n  }\n}\n","/**\n * @method getLocalTracks\n * @return {Array} List of active Track objects added to the Peer locally.\n */\nexport default function localTracks() {\n  const { proxyPeer, trackManager, log } = this\n  log.info('Getting local tracks.')\n\n  // Return the list of Tracks from active senders.\n  return (\n    proxyPeer\n      .getSenders()\n      /**\n       * Remove any Senders that do not have an associated track.\n       * We only want to retrieve Senders that do have tracks, because those are\n       *    the local tracks that have been added to the Peer.\n       * Senders without tracks are part of a Transceiver where the Receiver has\n       *    a remote track, but no local track has been added to it. We don't\n       *    care about this for the \"get local tracks\" operation.\n       */\n      .filter(sender => Boolean(sender.track))\n      .map(sender => trackManager.get(sender.track.id))\n      .filter(track => {\n        // Make sure the trackManager has the track and that its active.\n        // It's possible that Peer has the sender but not the actual track yet.\n        return track && track.getState().state === 'live' && track.getStream().active\n      })\n  )\n}\n","/**\n * The SDP for the remote end of the connection.\n * @method getRemoteDescription\n */\nexport default function getRemoteDescription() {\n  const { nativePeer, log } = this\n  log.info('Getting remote description.')\n\n  const remoteDesc = nativePeer.remoteDescription\n  /*\n   * Ensure it is a RTCSessionDescription object.\n   * In some scenarios (based on browser?), it may return an empty object\n   *    instead of undefined when there is no local description.\n   * TODO: Determine if this is still needed, or if we can use the native\n   *    property directly.\n   */\n  if (remoteDesc && remoteDesc.sdp && remoteDesc.type) {\n    return remoteDesc\n  } else {\n    return undefined\n  }\n}\n","/**\n * @method getRemoteTracks\n * @return {Array} List of active Track objects the Peer has received remotely.\n */\nexport default function getRemoteTracks() {\n  const { proxyPeer, trackManager, log } = this\n  log.info('Getting remote tracks.')\n\n  // Return the list of Tracks from active receivers.\n  return (\n    proxyPeer\n      .getReceivers()\n      /**\n       * Remove any Receivers that do not have an associated track.\n       * We only want to retrieve Receivers that do have tracks, because those are\n       *    the remote tracks that have been added to the Peer.\n       * Receivers without tracks are part of a Transceiver where the Sender has\n       *    a local track, but no remote track has been added to it. We don't\n       *    care about this for the \"get remote tracks\" operation.\n       */\n      .filter(receiver => Boolean(receiver.track))\n      .map(receiver => trackManager.get(receiver.track.id))\n      .filter(track => {\n        // Make sure the trackManager has the track\n        return track && track.getState().state === 'live'\n      })\n  )\n}\n","/**\n * @method getRemoteTracks\n * @return {Array} List of active Track objects the Peer has received remotely.\n */\nexport default function getRemoteTracks() {\n  const { proxyPeer, trackManager, log } = this\n  log.info('Getting remote tracks.')\n\n  // Return the list of Tracks from active receivers.\n  return (\n    proxyPeer\n      .getReceivers()\n      /**\n       * Remove any Receivers that do not have an associated track.\n       * We only want to retrieve Receivers that do have tracks, because those are\n       *    the remote tracks that have been added to the Peer.\n       * Receivers without tracks are part of a Transceiver where the Sender has\n       *    a local track, but no remote track has been added to it. We don't\n       *    care about this for the \"get remote tracks\" operation.\n       */\n      .filter(receiver => Boolean(receiver.track))\n      .map(receiver => trackManager.get(receiver.track.id))\n      .filter(track => {\n        // Make sure the trackManager has the track and that its active.\n        // It's possible that Peer has the receiver but not the actual track yet.\n        return track && track.getState().state === 'live' && track.getStream().active\n      })\n  )\n}\n","/**\n * This method is similar to the `localTracks` method, however this method returns\n *  all of the sender's tracks (ended or not) rather than just the active/live ones.\n *\n * @method senderTracks\n * @return {Array} List of Track objects added to the Peer locally.\n */\nexport default function senderTracks() {\n  const { proxyPeer, log } = this\n  log.info('Getting sender tracks.')\n\n  // Return the list of Tracks from senders.\n  return (\n    proxyPeer\n      .getSenders()\n      /**\n       * Remove any Senders that do not have an associated track.\n       * We only want to retrieve Senders that do have tracks, because those are\n       *    the local tracks that have been added to the Peer.\n       * Senders without tracks are part of a Transceiver where the Receiver has\n       *    a remote track, but no local track has been added to it. We don't\n       *    care about this for the \"get local tracks\" operation.\n       */\n      .filter(sender => Boolean(sender.track))\n      .map(sender => sender.track)\n  )\n}\n","/**\n *\n * Util for emitting an event with the necessary peer information for the ice\n * collection scheduled check.\n * @method iceCollectionScheduledCheck\n * @param {Object} proxyBase The \"base\" of the Proxy Peer object.\n */\nexport default function iceCollectionScheduledCheck(proxyBase) {\n  const { proxyPeer, iceTimer, iceCandidates, emitter, config } = proxyBase\n\n  // The time, in milliseconds, that ICE collection has taken so far.\n  const elapsedTime = iceTimer.timeFromStart()\n\n  emitter.emit('scheduledCheck', {\n    iceCollectionDuration: elapsedTime,\n    iceCandidates,\n    iceGatheringState: proxyPeer.iceGatheringState,\n    rtcPeerConnectionConfig: config,\n    rtcLocalSessionDescription: proxyPeer.localDescription\n  })\n}\n","/**\n * Prototype for a timer object that can keep time and be stopped and started.\n */\nconst timerPrototype = {\n  /**\n   * Start the timer\n   * @returns {boolean} True if the timer was successfully started, false if it was already started.\n   */\n  start() {\n    if (!this.isStarted()) {\n      this._startTime = now()\n      return true\n    }\n    return false\n  },\n\n  /**\n   * Stops the timer\n   * @returns {boolean} True if the timer was successfully stopped, false if it was already stopped.\n   */\n  stop() {\n    if (this.isStarted()) {\n      this._startTime = undefined\n      return true\n    }\n\n    return false\n  },\n\n  /**\n   * @returns {boolean} True if the timer is started, false otherwise.\n   */\n  isStarted() {\n    return Boolean(this._startTime)\n  },\n\n  /**\n   * @returns {number} The time in milliseconds since the timer was started, or 0 if it wasn't started.\n   */\n  timeFromStart() {\n    return this.isStarted() ? now() - this._startTime : 0\n  }\n}\n\n/**\n * @returns A timestamp in milliseconds since the unix-epoch\n */\nfunction now() {\n  return new Date().getTime()\n}\n\n/**\n * Create a new timer object. Timers are not started when created and need to be started manually.\n *\n * @returns {Object} The timer object that supports the timer interface.\n */\nexport function createTimer() {\n  return Object.create(timerPrototype)\n}\n","/**\n * Constants relating to the Peer model.\n */\nexport const PEER = {\n  TRICKLE_ICE: {\n    FULL: 'FULL',\n    HALF: 'HALF',\n    NONE: 'NONE'\n  },\n  // Defined by the RTCPeerConnection.iceGatheringState spec.\n  ICE_GATHERING_STATE: {\n    NEW: 'new',\n    GATHERING: 'gathering',\n    COMPLETE: 'complete'\n  },\n  ENDPOINT: {\n    LOCAL: 'local',\n    REMOTE: 'remote'\n  }\n}\n\n/**\n * SDP constants for media direction.\n * @type {Object}\n */\nexport const MEDIA_DIR = {\n  INACTIVE: 'inactive',\n  SEND_ONLY: 'sendonly',\n  RECV_ONLY: 'recvonly',\n  SEND_RECV: 'sendrecv'\n}\n\n/**\n * Reasons for calling the Ice Collection Check function.\n * @name ICE_COLLECTION_CHECK_REASONS\n */\nexport const ICE_COLLECTION_CHECK_REASONS = {\n  ICE_GATHERING_STATE_CHANGE: 'IceGatheringStateChanged',\n  NEW_CANDIDATE: 'NewCandidate',\n  SCHEDULED: 'Scheduled'\n}\n\n/**\n * Result types for the Ice Collection Check Function.\n * @name ICE_COLLECTION_RESULT_TYPES\n */\nexport const ICE_COLLECTION_RESULT_TYPES = {\n  START_CALL: 'StartCall',\n  WAIT: 'Wait',\n  ERROR: 'Error'\n}\n","// Models.\nimport Track from '../models/track'\nimport Media from '../models/media'\nimport Peer from '../Peer'\n\n// Managers.\nimport MediaManager from '../managers/mediaManager'\nimport PeerManager from '../managers/peerManager'\nimport SessionManager from '../managers/sessionManager'\nimport DeviceManager from '../managers/deviceManager'\nimport TrackManager from '../managers/trackManager'\nimport WebRTCManager from '../managers/webrtcManager'\nimport Renderer from '../managers/renderer'\n\nimport { logManager } from '../logs'\n\n// SDP helpers.\nimport sdpPipeline from '../sdpUtils/pipeline'\nimport * as sdpHandlers from '../sdpUtils/handlers'\n\n// Utils\nimport { getBrowserDetails as getDetails } from '../utils'\n\n// Re-export this function so it can be used directly instead of through the\n//    initialized WebrtcStack. It is renamed because of weird import/export behaviour.\nexport const getBrowserDetails = getDetails\n\n/**\n * @returns An dictionary of features that are supported on this platform.\n */\nexport function getWebRTCSupportCapabilities() {\n  return {\n    mediaDevices: Boolean(navigator.mediaDevices),\n    peerConnection: Boolean(window.RTCPeerConnection)\n  }\n}\n\nexport default function initialize() {\n  const log = logManager.getLogger('WebRTC')\n\n  const browserDetails = getBrowserDetails()\n  if (browserDetails.version) {\n    log.debug(`Browser details: ${browserDetails.browser}, version ${browserDetails.version}.`)\n  } else {\n    log.debug('Browser details: Not supported by webRTC adapter.')\n  }\n\n  const renderer = new Renderer()\n  const deviceManager = new DeviceManager()\n  const trackManager = new TrackManager()\n  const mediaManager = new MediaManager({ trackManager })\n  const peerManager = new PeerManager({ trackManager })\n  const sessionManager = new SessionManager({\n    peerManager,\n    mediaManager,\n    trackManager,\n    deviceManager\n  })\n  const webrtcManager = new WebRTCManager()\n\n  return {\n    models: {\n      Track,\n      Media,\n      Peer\n    },\n    // TODO: Make naming consistent.\n    managers: {\n      devices: deviceManager,\n      media: mediaManager,\n      peerManager: peerManager,\n      sessionManager,\n      track: trackManager,\n      // Give access to the Log Manager.\n      // TODO: Don't include it under managers. It's here now because of\n      //    ProxyStack annoyingness.\n      logs: logManager,\n      webrtcManager,\n      renderer\n    },\n    sdp: {\n      pipeline: sdpPipeline,\n      handlers: sdpHandlers\n    },\n    // Export this on the webRTC stack for backwards compatibility.\n    getBrowserDetails\n  }\n}\n","import createManager from 'kandy-logger'\n\nconst manager = createManager({ level: 'DEBUG' })\nexport const logManager = manager\n","import { logManager } from '../logs'\n\n// Libraries.\nimport EventEmitter from 'rbbn-emitter'\n\n/*\n * A conversion from MediaDeviceInfo.kind values to their more common terms.\n * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo/kind\n * @enum {String}\n */\nexport const WEBRTC_DEVICE_KINDS = {\n  audioinput: 'microphone',\n  videoinput: 'camera',\n  audiooutput: 'speaker'\n}\n\n/**\n * Manager for connected devices.\n * Keeps an up-to-date list of all devices.\n * @class DeviceManager\n */\nexport default function DeviceManager() {\n  const log = logManager.getLogger('Manager', 'Device')\n\n  // Internal variables.\n  const emitter = new EventEmitter()\n  // Store each device type separately, so that `deviceId` is unique\n  //    per kind (there is a `default` deviceId per kind).\n  let microphone = []\n  let camera = []\n  let speaker = []\n\n  // Check devices on initialization.\n  checkDevices().then(() => {\n    if (isListening) {\n      // Emit an initial event to notify that devices are available.\n      emitter.emit('change')\n    } else {\n      log.info('Initial media device discovery ignored.')\n    }\n  })\n\n  // Check devices whenever they change.\n  let isListening = true\n  let recentDeviceChange = false\n  navigator.mediaDevices.addEventListener('devicechange', () => {\n    // A physical device change results in one event per\n    //    device \"kind\". Group the events together.\n    // Only emit an event if the Manager is supposed to\n    //    be listening for changes.\n    if (!recentDeviceChange && isListening) {\n      log.info('Media device change detected.')\n      recentDeviceChange = true\n      setTimeout(() => {\n        recentDeviceChange = false\n        checkDevices().then(() => {\n          if (isListening) {\n            // Emit an event to notify of the change.\n            emitter.emit('change')\n          } else {\n            log.info('Media device change ignored after being detected.')\n          }\n        })\n      }, 50)\n    } else {\n      log.info(`Media device change detected, but ${!isListening ? 'ignoring' : 'throttling'}.`)\n    }\n  })\n\n  /**\n   * Sets the Manager to watch or ignore the \"device change\"\n   *    events from the browser.\n   * @method setListening\n   * @param {Boolean} flag Whether to watch for events.\n   * @return {undefined}\n   */\n  function setListening(flag) {\n    log.debug(`Listening for device changes: ${flag}`)\n    isListening = flag\n  }\n\n  /**\n   * Updates the stored device lists with the latest devices.\n   * @method checkDevices\n   * @return {Promise}\n   */\n  function checkDevices() {\n    log.info('Checking media devices.')\n    return new Promise((resolve, reject) => {\n      navigator.mediaDevices\n        .enumerateDevices()\n        .then(devices => {\n          // Clear the stored devices, to prevent duplicates.\n          microphone = []\n          camera = []\n          speaker = []\n          devices.forEach(device => {\n            const kind = WEBRTC_DEVICE_KINDS[device.kind]\n            switch (kind) {\n              case 'microphone':\n                microphone.push(device)\n                break\n              case 'camera':\n                camera.push(device)\n                break\n              case 'speaker':\n                speaker.push(device)\n                break\n            }\n          })\n          resolve(get())\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Ask for permission and gets the list of available device(s) available from the end-user's devices.\n   * @method setupDeviceInitialization\n   * @param browserConstraints\n   * @return {Object}\n   */\n  function setupDeviceInitialization(browserConstraints) {\n    return new Promise((resolve, reject) => {\n      navigator.mediaDevices\n        .getUserMedia(browserConstraints)\n        .then(mediaStream => {\n          mediaStream.getTracks().forEach(track => {\n            track.stop()\n          })\n          const devices = checkDevices()\n          resolve(devices)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Retrieves the stored device lists.\n   * @method get\n   * @return {Object}\n   */\n  function get() {\n    return {\n      microphone,\n      camera,\n      speaker\n    }\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  function emit(...args) {\n    return emitter.emit(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    setListening,\n    checkDevices,\n    setupDeviceInitialization,\n    get,\n    on,\n    once,\n    off,\n    emit\n  }\n}\n","import { logManager } from '../logs'\n\n// Models that this manager directly manages.\nimport Media from '../models/media'\n\n// Libraries.\nimport EventEmitter from 'rbbn-emitter'\n\n/**\n * Manager for Media objects.\n * Allows the creation and retrieval of media objects.\n * @class MediaManager\n */\nexport default function MediaManager(managers) {\n  const log = logManager.getLogger('Manager', 'Media')\n\n  // Internal variables.\n  const trackManager = managers.trackManager\n  const medias = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Retrieve a snapshot of all Media objects' current state.\n   * @method getState\n   * @return {Array}\n   */\n  function getState() {\n    return getAll().map(id => get(id).getState())\n  }\n\n  /**\n   * Workaround to get Firefox to behave similarly to Chrome regarding device permission prompts.\n   * @method browserConstraintsWorkaround\n   * @param  {MediaStreamConstraints}  constraints\n   * @return {Object}  media constraints\n   */\n  function browserConstraintsWorkaround(constraints) {\n    /**\n     * Firefox workaround.\n     *\n     * Issue Summary: Browser behaviour for prompting the user for device\n     *    permissions is not consistent for consecutive gUM calls. The following\n     *    workaround makes it consistent if the less-specific constraint is\n     *    provided.\n     *\n     * Context: The `deviceId` constraint format can be either a string or an\n     *    object. The object format allows precise control over how the browser\n     *    should try to get the track. It can be specified to fail if it can't\n     *    fulfill the constraint (exact), or whether the constraint is \"best\n     *    effort\" (ideal). When the string format is given, it follows the\n     *    \"ideal\" behaviour.\n     * See: https://developer.mozilla.org/en-US/docs/Web/API/ConstrainDOMString\n     *\n     *  - When the \"ideal\" behaviour is followed and the user has not given\n     *      permission (and not disallowed), the browser will prompt the user\n     *      for permission.\n     *  - [Issue] When the \"ideal\" behaviour is followed and the user has given\n     *      permission previously, the browser will not prompt the user for\n     *      permission.\n     *\n     * Problem: When gUM is called for a different device (ideal behaviour) than\n     *    permission was granted for previously, the browser will not prompt the\n     *    user to give permission for the (new) device. This results in gUM\n     *    using the original device for the new track.\n     *\n     * This happens on Firefox because the prompt for media permissions is\n     *    specific to a single device. For Chrome, the prompt is generic to any\n     *    device.\n     * If permissions are always allowed (\"remember my decision\" on Firefox or\n     *    default on Chrome), this issue wouldn't be seen.\n     *\n     * Workaround: When the behaviour (idea / exact) isn't specified, default\n     *    to exact (instead of letting the browser default to ideal; as per the\n     *    specification).\n     *\n     * This ensures that the browser always prompts the user to give permissions\n     *    for the device (if not already granted). It is also more in-line with\n     *    what might be expected when you ask for a certain device (ie. don't\n     *    return a different device unless it was specified that it's okay).\n     */\n    for (const kind in constraints) {\n      if (\n        constraints[kind] &&\n        typeof constraints[kind] === 'object' &&\n        typeof constraints[kind].deviceId === 'string'\n      ) {\n        // Don't allow a \"bare\" value be provided for deviceId. Change it to use\n        //    \"exact\".\n        const id = constraints[kind].deviceId\n        constraints[kind].deviceId = { exact: id }\n      }\n    }\n    return constraints\n  }\n\n  /**\n   * Wraps native mediaStream, adds tracks to trackManager and Media, and sets up event handlers on a given media.\n   * @method setupMedia\n   * @param {MediaStream} mediaStream Creating a Media object with it.\n   * @param {string} type The media type to use when creating tracks.\n   * @param {boolean} isDetached Specifies if the track is detached and can be used with or without a call.\n   * @return {Media}\n   */\n  function setupMedia(mediaStream, type, isDetached) {\n    const media = new Media(mediaStream, true)\n    log.debug(`Creating Media with ID: ${media.id}.`)\n\n    // Only add tracks to a Media objects using the `addTrack` method.\n    // Specify that this is a local track we're adding\n    mediaStream.getTracks().forEach(nativeTrack => {\n      const wrappedTrack = trackManager.add(nativeTrack, type ? type : nativeTrack.kind, mediaStream, true, isDetached)\n\n      media.addTrack(wrappedTrack)\n    })\n\n    media.once('media:stopped', mediaId => {\n      remove(mediaId)\n    })\n\n    media.on('track:ended', ({ mediaId, trackId }) => {\n      if (media.getTracks().length === 0) {\n        remove(mediaId)\n      }\n    })\n\n    media.on('track:muted', ({ mediaId, trackId }) => {\n      // TBD: Add any extra behaviour (if needed) here\n    })\n\n    return media\n  }\n\n  /**\n   * Create a new local Media object.\n   * Use the provided constraints to get user media as the base MediaStream.\n   * @method createLocal\n   * @param  {MediaStreamConstraints}  constraints\n   * @param  {boolean} isDetached Specifies if the track is detached and can be used with or without a call.\n   * @return {Promise}\n   */\n  function createLocal(constraints, isDetached) {\n    const constraintsWorkaround = browserConstraintsWorkaround(constraints)\n\n    // Get user media, ...\n    return new Promise((resolve, reject) => {\n      // TODO: Proper error checking.\n      // TODO: Use the WebAPI directly here? Probably not.\n      navigator.mediaDevices\n        .getUserMedia(constraintsWorkaround)\n        .then(mediaStream => {\n          // Only pass the type if it's screenshare, otherwise, let the media kind determine the type\n          const media = setupMedia(mediaStream, undefined, isDetached)\n\n          medias.set(media.id, media)\n          // TODO: Better event. Include metadata?\n          emitter.emit('media:new', media.id)\n\n          resolve(media)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Creates a new local Screen Media object.\n   * Use the provided constraints to get user media as the base MediaStream.\n   * @method createLocalScreen\n   * @param {MediaStreamConstraints} constraints\n   * @param  {boolean} isDetached Specifies if the track is detached and can be used with or without a call.\n   * @return {promise}\n   */\n  function createLocalScreen(constraints, isDetached) {\n    const constraintsWorkaround = browserConstraintsWorkaround(constraints)\n\n    return new Promise((resolve, reject) => {\n      navigator.mediaDevices\n        .getDisplayMedia(constraintsWorkaround)\n        .then(mediaStream => {\n          // Only pass the type if it's screenshare, otherwise, let the media kind determine the type\n          const type = 'screen'\n          const media = setupMedia(mediaStream, type, isDetached)\n\n          medias.set(media.id, media)\n          // TODO: Better event. Include metadata?\n          emitter.emit('media:new', media.id)\n\n          resolve(media)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Create a new remote Media object.\n   * Use provided stream/tracks as the base media objects.\n   * @method createRemote\n   * @param  {MediaStream} mediaStream Native MediaStream object.\n   * @param  {Tracks[]} tracks Array of Track objects.\n   * @return {Media}\n   */\n  function createRemote(stream, tracks = []) {\n    const media = new Media(stream, false)\n\n    tracks.forEach(track => {\n      media.addTrack(track)\n    })\n\n    media.once('media:stopped', mediaId => {\n      remove(mediaId)\n    })\n\n    media.on('track:ended', ({ mediaId, trackId }) => {\n      if (media.getTracks().length === 0) {\n        remove(mediaId)\n      }\n    })\n\n    medias.set(media.id, media)\n    // TODO: Better event. Include metadata?\n    emitter.emit('media:new', media.id)\n    return media\n  }\n\n  /**\n   * Removes a Media object from the medias array.\n   * @private\n   * @method remove\n   * @param {String} mediaId\n   */\n  function remove(mediaId) {\n    const media = get(mediaId)\n    if (media) {\n      medias.delete(mediaId)\n      emitter.emit('media:removed', mediaId)\n    }\n  }\n\n  /**\n   * Retrieve an existing Media object.\n   * @method get\n   * @param  {String} mediaId ID of the desired Media object.\n   * @return {Media}\n   */\n  function get(mediaId) {\n    const media = medias.get(mediaId)\n    if (!media) {\n      log.debug(`No media found with ID: ${mediaId}.`)\n    }\n    return media\n  }\n\n  /**\n   * Retrieve a list of all existing Media object's IDs.\n   * @method getAll\n   * @return {Array} List of Media IDs.\n   */\n  function getAll() {\n    return Array.from(medias.keys())\n  }\n\n  /**\n   * Finds the Media object that contains the specified Track.\n   * @method findTrack\n   * @param  {string}  trackId The ID of the Track to find.\n   * @return {string} The ID of the Media object that contains the Track.\n   */\n  function findTrack(trackId) {\n    // Search through all Media objects for the one that has the desired track.\n    const allMedia = Array.from(medias.values())\n    const media = allMedia.find(media => media.getTrack(trackId))\n    if (media) {\n      log.debug(`Found Media (${media.id}) with Track ${trackId}.`)\n      return media.id\n    } else {\n      log.debug(`Found no Media with Track ${trackId}.`)\n    }\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    // Getter APIs.\n    get,\n    getAll,\n    getState,\n    findTrack,\n    // Create APIs.\n    createLocal,\n    createLocalScreen,\n    createRemote,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","import { logManager } from '../logs'\n\nimport Peer from '../Peer'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\nimport EventEmitter from 'rbbn-emitter'\n\n/**\n * Manager for Peer objects.\n * Allows the creation and retrieval of peer objects.\n * @method PeerManager\n */\nexport default function PeerManager(managers) {\n  const log = logManager.getLogger('Manager', 'Peer')\n\n  // Internal variables.\n  const trackManager = managers.trackManager\n  const peers = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Retrieve a snapshot of all Peer objects' current state.\n   * @method getState\n   * @return {Array}\n   */\n  function getState() {\n    return getAll().map(id => get(id).getState())\n  }\n\n  /**\n   * Create a new Peer using the provided configs.\n   * @method create\n   * @param  {Object} [config={}]\n   * @return {Peer}\n   */\n  function create(config = {}) {\n    const peer = new Peer(uuidV4(), config, trackManager)\n    peer.once('peer:closed', id => peers.delete(id))\n    peers.set(peer.id, peer)\n    emitter.emit('peer:new', peer.id)\n    return peer\n  }\n\n  /**\n   * Retrieves an existing Peer object.\n   * @method get\n   * @param  {String} id ID of the desired Peer object.\n   * @return {Peer}\n   */\n  function get(id) {\n    const peer = peers.get(id)\n    if (!peer) {\n      log.debug(`No Peer found with ID: ${id}.`)\n    }\n    return peer\n  }\n\n  /**\n   * Retrieve a list of all existing Peer object's IDs.\n   * @method getAll\n   * @return {Array} List of Peer IDs.\n   */\n  function getAll() {\n    return Array.from(peers.keys())\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    getState,\n    get,\n    getAll,\n    create,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","import { logManager } from '../logs'\nimport { makeSafeForCSS } from '../utils'\n\n/*\n * IMPORTANT NOTE: This file is largely duplicated in other packages (search filename in project).\n * Ideally, once we complete KJS-174, we can avoid this duplication, but for now ensure changes here\n * are reflected in the duplicates as necessary.\n */\n\n/**\n * Renderer for managing where Tracks are rendered.\n */\nexport default function Renderer() {\n  /*\n   * Object holding reference to all tracks currently rendered and to where.\n   *    Entry format: { containers, rendererId }\n   *    `containers` is the array of HTMLElements where the track is rendered.\n   *    `rendererId` is the ID used when creating DOM elements for this track.\n   */\n  const entries = {}\n\n  /**\n   * Renders this Track as a subelement of the specified element.\n   * @method renderTrack\n   * @param  {HTMLElement|String} container The DOM element to be rendered in,\n   *    or a unique CSS selector for the DOM element.\n   * @param  {String} [speakerId] The device ID to be used for audio output.\n   * @return {boolean} true if rendering of track suceeded, false otherwise.\n   */\n  function renderTrack(track, container, speakerId) {\n    const log = logManager.getLogger('Track', track.id)\n\n    let element\n    // If a string was provided, use it as a CSS selector to find the element.\n    if (typeof container === 'string') {\n      log.info(`Rendering track in element using selector: ${container}`)\n\n      element = document.querySelector(container)\n      if (!element) {\n        log.error(`Unable to get container with selector: ${container}.`)\n        return false\n      }\n    } else {\n      log.info('Rendering track in provided HTMLElement.')\n      element = container\n    }\n\n    const type = track.getState().kind\n    // Create a unique rendering ID for this track.\n    const rendererId = `${type}-${makeSafeForCSS(track.id)}`\n\n    // Get the existing entry for this track.\n    let entry = entries[track.id]\n    if (entry) {\n      if (entry.containers.indexOf(element) > -1) {\n        // Already rendered in element.\n        log.warn('Failed to render track; already rendered in element.')\n        return false\n      } else {\n        // Rendering the track in a second element; no issue with that.\n      }\n    } else {\n      // Create an empty entry; track is not rendered anywhere else.\n      entry = { containers: [], rendererId }\n    }\n\n    // Element is a valid place to render track, so add it to the entry then render it.\n    entry.containers.push(element)\n\n    const renderer = document.createElement(type)\n    renderer.id = rendererId\n    renderer.style.height = '100%'\n    renderer.style.width = '100%'\n\n    const stream = track.getStream()\n    try {\n      renderer.srcObject = stream\n    } catch (error) {\n      log.debug('srcObject property not supported; reverting to createObjectURL.')\n      // TODO: AdapterJS handles this, we should remove this.\n      renderer.src = window.URL.createObjectURL(stream)\n    }\n\n    renderer.autoplay = 'true'\n\n    if (type === 'video') {\n      renderer.muted = 'true'\n      // Needed for IOS autoplay.\n      renderer.playsInline = 'true'\n      // Needed for Android.\n      renderer.play().catch(err => {\n        log.debug(`Could not autoplay renderer #${renderer.id}: ${err.message}`)\n      })\n    }\n\n    // Set speaker if it was provided and it's supported.\n    if (speakerId && typeof renderer.setSinkId !== 'undefined') {\n      // TODO: Better then/catch handling.\n      renderer\n        .setSinkId(speakerId)\n        .then(() => {\n          log.debug(`Set to use speaker: ${speakerId}.`)\n        })\n        .catch(error => {\n          log.debug(`Could not set speaker to use ${speakerId}: ${error.message}`)\n        })\n    } else if (speakerId && typeof renderer.setSinkId === 'undefined') {\n      log.info('Failed to set speaker; setSinkId not supported in this browser.')\n    }\n\n    element.appendChild(renderer)\n\n    // Save the new/updated entry to the Renderer scope.\n    entries[track.id] = entry\n    return true\n  }\n\n  /**\n   * Stop rendering this Track from the specified element.\n   * @method unrenderTrack\n   * @param  {string}      trackId   ID of the track to be unrendered.\n   * @param  {HTMLElement} container The DOM element to be removed from, or\n   *     a unique CSS selector for the DOM element.\n   * @return {boolean} true if unrendering of track suceeded, false otherwise.\n   */\n  function unrenderTrack(trackId, container) {\n    const log = logManager.getLogger('Track', trackId)\n\n    // Get the existing entry for this track.\n    const entry = entries[trackId]\n    if (!entry) {\n      log.info('Failed to unrender track; not rendered anywhere.')\n      return false\n    }\n\n    let element\n    // If a string was provided, use it as a CSS selector to find the element.\n    if (typeof container === 'string') {\n      log.info(`Unrendering track from element using selector: ${container}`)\n\n      element = document.querySelector(container)\n      if (!element) {\n        log.error(`Unable to get container with selector: ${container}.`)\n        return false\n      }\n    } else {\n      log.info('Unrendering track from provided HTMLElement.')\n      element = container\n    }\n\n    const index = entry.containers.findIndex(item => item === element)\n    if (index === -1) {\n      // Not rendered in element.\n      log.info('Failed to unrender track; not rendered in element.')\n      return false\n    }\n\n    const renderer = element.querySelector(`#${entry.rendererId}`)\n\n    if (renderer.srcObject) {\n      renderer.srcObject = null\n    } else if (renderer.src) {\n      renderer.src = null\n    }\n    element.removeChild(renderer)\n\n    entry.containers.splice(index, 1)\n    // If this track isn't rendered anywhere anymore, remove the reference to it.\n    if (entry.containers.length === 0) {\n      delete entries[trackId]\n    }\n    return true\n  }\n\n  return {\n    renderTrack,\n    unrenderTrack\n  }\n}\n","import { logManager } from '../logs'\nimport Session from '../models/session'\n\n// Libraries.\nimport { v4 as uuidV4 } from 'uuid'\nimport EventEmitter from 'rbbn-emitter'\n\n/**\n * Manager for Session objects.\n * Allows for creation and retrieval of session objects.\n * @method SessionManager\n */\nexport default function SessionManager(managers) {\n  const log = logManager.getLogger('Manager', 'Session')\n  // Internal variables.\n  const sessions = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Create a new Session object.\n   * @method create\n   * @param {Object} [config]\n   * @param {Object} [config.peer] Configs for the Session's Peer object.\n   * @return {Session}\n   */\n  function create(config = {}) {\n    const session = new Session(uuidV4(), managers, config)\n    session.once('session:ended', id => {\n      sessions.delete(id)\n      emitter.emit('session:removed', id)\n    })\n    sessions.set(session.id, session)\n    emitter.emit('session:new', session.id)\n    return session\n  }\n\n  /**\n   * Retrieve an existing Session object.\n   * @method get\n   * @param  {String} sessionId ID of the desired Session object.\n   * @return {Session}\n   */\n  function get(sessionId) {\n    const session = sessions.get(sessionId)\n    if (!session) {\n      log.debug(`No session found with ID: ${sessionId}.`)\n    }\n    return session\n  }\n\n  /**\n   * Retrieve a list of all existing Sessions.\n   * @method getAll\n   * @return {Array} List of Media IDs.\n   */\n  function getAll() {\n    return Array.from(sessions.values())\n  }\n\n  /**\n   * Get an existing Session object, and add media to it before returning.\n   *    This method is an optimization. It combines `sessionManager.get` and\n   *    `session.addWithMedia` into a single method instead of two.\n   * @method getWithMedia\n   * @return {Promise} Resolves with the Session and Media objects.\n   */\n  function getWithMedia(sessionId, mediaConstrants, dscpControls) {\n    const session = sessions.get(sessionId)\n    if (!session) {\n      log.debug(`No session found with ID: ${sessionId}.`)\n      return\n    }\n\n    return new Promise((resolve, reject) => {\n      session\n        .addNewMedia(mediaConstrants, dscpControls)\n        .then(medias => {\n          resolve({ session, medias })\n        })\n        .catch(reject)\n    })\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    create,\n    get,\n    getAll,\n    getWithMedia,\n    on,\n    once,\n    off\n  }\n}\n","import Track from '../models/track'\n\n// Libraries.\nimport EventEmitter from 'rbbn-emitter'\n\n/**\n * Manager / store for Track objects.\n * @method TrackManager\n */\nexport default function TrackManager() {\n  /**\n   * The Track objects being managed.\n   * @type {Map}\n   */\n  const tracks = new Map()\n  const emitter = new EventEmitter()\n\n  /**\n   * Retrieve a Track object.\n   * @method get\n   * @param  {string} trackId\n   * @return {Track}\n   */\n  function get(trackId) {\n    return tracks.get(trackId)\n  }\n\n  /**\n   * Retrieve a list of Track objects.\n   * If no tracks are specified, will return all tracks.\n   * @method getTracks\n   * @param  {Array} [trackIds] List of tracks to retrieve.\n   * @return {Array}\n   */\n  function getTracks(trackIds) {\n    if (trackIds) {\n      return trackIds.map(trackId => tracks.get(trackId))\n    } else {\n      return Array.from(tracks.values())\n    }\n  }\n\n  /**\n   * Wraps a MediaStreamTrack into a Track object and adds\n   *    it to the manager.\n   * @method add\n   * @param  {MediaStreamTrack} track A native track object.\n   * @param  {string} type The media type to use when creating tracks.\n   * @param  {MediaStream} stream\n   * @param  {boolean} isLocalTrack Specifies if the track parameter is a local one or a remote one.\n   * @param  {boolean} isDetached Specifies if the track is detached and can be used with or without a call.\n   * @return {Track} The added/wrapped Track object.\n   */\n  function add(track, type, stream, isLocalTrack, isDetached) {\n    const targetTrack = tracks.get(track.id)\n\n    // Chrome issue: track.stream is outdated and needs to be updated to newStream.\n    // targetTrack.stream.active is false & targetTrack.stream.getTracks() gives us an empty array.\n    // stream.active is true & stream.getTracks() gives us the correct array of tracks.\n    // Set/update the new stream as the track's stream\n    if (targetTrack && !targetTrack.getStream().active && stream.active) {\n      // The track was previously registered and is being re-added with new stream\n      targetTrack.setStream(stream)\n      return targetTrack\n    } else if (targetTrack) {\n      // This track is already registered.\n      return targetTrack\n    } else {\n      // Wrap the track as a Track object.\n      const wrappedTrack = new Track(track, stream)\n\n      // Set the requested media type (audio, video, screen) before we save it in the state\n      wrappedTrack.setType(type)\n\n      // Mark it as local (or remote) before we save it in the state\n      wrappedTrack.setIsLocal(isLocalTrack)\n\n      // Mark as detached before we save it in the state\n      wrappedTrack.setIsDetached(isDetached)\n\n      tracks.set(track.id, wrappedTrack)\n\n      // Remove the track from the manager when it ends.\n      wrappedTrack.once('ended', event => {\n        if (!event.isUnsolicited || event.isDetached) {\n          remove({ trackId: track.id })\n        }\n      })\n\n      emitter.emit('add', wrappedTrack.id)\n      return wrappedTrack\n    }\n  }\n\n  /**\n   * Remove a Track from the manager.\n   * @method remove\n   * @param  {string} trackId\n   * @return {Boolean} Whether the Track existed (and hence removed).\n   */\n  function remove({ trackId }) {\n    const track = get(trackId)\n    if (track) {\n      emitter.emit('remove', trackId)\n      tracks.delete(trackId)\n      // Clean up any listeners.\n      track.off('ended', remove)\n    }\n\n    return Boolean(track)\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    get,\n    getTracks,\n    add,\n    remove,\n    on,\n    once,\n    off\n  }\n}\n","import { setPeerProxies } from '../Peer'\nimport { logManager } from '../logs'\n\n/**\n * \"Manager\" for general WebRTC functions.\n * @class WebRTCManager\n */\nexport default function WebRTCManager(managers) {\n  const log = logManager.getLogger('Manager', 'WebRTC')\n\n  /**\n   * Retrieve the list of available and supported codecs based on the browser's capabilities for sending media.\n   * @method getAvailableCodecs\n   * @param {string} kind The kind of media of which to get the supported codecs of.\n   * @return {Array|undefined}\n   */\n  function getAvailableCodecs(kind) {\n    const capabilities = RTCRtpSender.getCapabilities(kind)\n    if (capabilities && capabilities.codecs) {\n      return capabilities.codecs\n    }\n  }\n\n  /**\n   * Set provided proxies using the \"set proxies\" functions per WebRTC functionality\n   * @param {Object} proxies An object of proxied WebRTC functionality\n   * @param {Object} proxies.peerProxies An object containing WebRTC Peer functionality proxies\n   */\n  function setProxies(proxies) {\n    // Set the provided peer proxies\n    if (proxies.peer) {\n      setPeerProxies(proxies.peer)\n\n      if (Object.keys(proxies.peer).length) {\n        log.debug('Peer functionality has been updated with proxies.')\n      } else {\n        log.debug('Peer functionality has been updated to remove proxies.')\n      }\n    }\n\n    // TODO: Set any other proxies (media? track?) as necessary\n  }\n  /**\n   * The exposed API.\n   */\n  return {\n    getAvailableCodecs,\n    setProxies\n  }\n}\n","import { logManager } from '../logs'\n\n// Libraries.\nimport EventEmitter from 'rbbn-emitter'\n\n/**\n * Object to represent a \"media\" object.\n * Wraps a MediaStream object.\n * @class Media\n * TODO: Rename to Stream? Would be more straight-forward since Tracks can be\n *    managed directly (with trackManager), instead of through a \"Media\" object.\n */\nexport default function Media(nativeStream, isLocal) {\n  const log = logManager.getLogger('Media', nativeStream.id)\n  log.info(`Creating new ${isLocal ? 'local' : 'remote'} Media.`)\n\n  // Internal variables.\n  const id = nativeStream.id\n  const stream = nativeStream\n  const emitter = new EventEmitter()\n\n  /**\n   * Mapping of the IDs of this Media object's tracks to the Track object.\n   * @type {Map}\n   */\n  const tracks = new Map()\n\n  /**\n   * Retrieve a snapshot of the Media object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState() {\n    return {\n      id: id,\n      tracks: Array.from(tracks.values()).map(track => track.getState()),\n      isLocal: isLocal\n    }\n  }\n\n  /**\n   * Add a track to this Media object.\n   * @method addTrack\n   * @param {Track} track The Track object to add to the Media object.\n   */\n  function addTrack(track) {\n    if (tracks.has(track.id)) {\n      log.debug(`Track (${track.id}) is already in Media (${id}).`)\n      return\n    }\n\n    // Add the native MediaStreamTrack to the MediaStream, if not already a part of the stream.\n    if (!stream.getTracks().find(streamTrack => streamTrack.id === track.id)) {\n      stream.addTrack(track.track)\n    }\n\n    // Add the Track to the Media object.\n    tracks.set(track.id, track)\n\n    /**\n     * When a track ends, remove it from the Media object then clean it up.\n     */\n    track.on('ended', () => {\n      const removedTrack = removeTrack(track.id)\n      // Might be from old already deleted media which has no tracks anymore.\n      if (removedTrack) {\n        emitter.emit('track:ended', {\n          mediaId: id,\n          trackId: removedTrack.id\n        })\n      }\n    })\n    // TODO: Emit event or return result?\n    emitter.emit('track:new', {\n      mediaId: id,\n      trackId: track.id\n    })\n\n    /**\n     * When a track is muted, we generate our own internal event\n     */\n    track.on('muted', event => {\n      const wrappedTrack = getTrack(event.trackId)\n      if (wrappedTrack && wrappedTrack.track && wrappedTrack.track.muted) {\n        // Emit our internal event.\n        // Note that wrappedTrack.id is same as wrappedTrack.track & event.trackId\n        emitter.emit('track:muted', {\n          mediaId: id,\n          trackId: event.trackId\n        })\n      }\n    })\n\n    /**\n     * When a track is unmuted, we generate our own internal event\n     */\n    track.on('unmuted', event => {\n      const wrappedTrack = getTrack(event.trackId)\n      if (wrappedTrack && wrappedTrack.track && wrappedTrack.track.muted === false) {\n        // Emit our internal event.\n        // Note that wrappedTrack.id is same as wrappedTrack.track & event.trackId\n        emitter.emit('track:unmuted', {\n          mediaId: id,\n          trackId: event.trackId\n        })\n      }\n    })\n  }\n\n  /**\n   * Remove a track from the Media object.\n   * @private\n   * @method removeTrack\n   * @param  {string} trackId The Track to remove.\n   */\n  function removeTrack(trackId) {\n    const track = getTrack(trackId)\n    if (track) {\n      tracks.delete(trackId)\n      return track\n    }\n  }\n\n  /**\n   * Stop all Tracks within this Media object.\n   * @method stop\n   */\n  function stop() {\n    getTracks().forEach(track => {\n      track.stop()\n    })\n    emitter.emit('media:stopped', this.id)\n  }\n\n  /**\n   * Retrieve the list of Track object this this Media object manages.\n   * @method getTracks\n   * @return {Array} The list of Track objects.\n   */\n  function getTracks() {\n    return Array.from(tracks.values())\n  }\n\n  /**\n   * Retrieve a specific Track object from within the Media object.\n   * @method getTrack\n   * @param  {String} trackId ID of the Track to retrieve.\n   * @return {Track}\n   */\n  function getTrack(trackId) {\n    return tracks.get(trackId)\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id,\n    tracks,\n    isLocal,\n    // Getter APIs.\n    getState,\n    getTracks,\n    getTrack,\n    // Create APIs.\n    addTrack,\n    // Cleanup APIs.\n    stop,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","import { logManager } from '../logs'\nimport { setTransceiverDirection } from '../sdpUtils/transceiverUtils'\n\n// Helpers.\nimport { PEER, ICE_COLLECTION_CHECK_REASONS, ICE_COLLECTION_RESULT_TYPES } from '../constants'\n\n// SDP Helpers.\nimport sdpPipeline from '../sdpUtils/pipeline'\nimport { getSdpSessionId } from '../sdpUtils/extractors'\n\n// General Utils.\nimport { getBrowserDetails } from '../utils'\nimport iceCollectionScheduledCheck from '../Peer/utils/iceCollectionScheduledCheck'\n\n// Libraries.\nimport mergeValues from '@rbbn/utilities/mergeValues'\nimport EventEmitter from 'rbbn-emitter'\nimport { debounce } from 'lodash/fp'\nconst unfixedDebounce = debounce.convert({ fixed: false })\n\n/**\n * Object to represent a webRTC Session for a single peer.\n * \"Session\" being an abstraction of a webRTC connection between another peer.\n * Performs logic for initializing and connecting a peer connection.\n * Manages media added to / received from the peer connection.\n * @method Session\n */\nexport default function Session(id, managers, config = {}) {\n  const log = logManager.getLogger('Session', id)\n  log.info('Creating new Session.')\n\n  // Internal variables.\n  const sessionId = id\n  let peerId\n  const peerManager = managers.peerManager\n  const mediaManager = managers.mediaManager\n  const trackManager = managers.trackManager\n  const deviceManager = managers.deviceManager\n  const emitter = new EventEmitter()\n\n  // Session settings\n  const settings = {\n    dscpControls: {}\n  }\n\n  // This structure is used to remember the dtls role of a peer relative to some remote sdp.\n  // key: the remote sdp's session id (o= line).\n  // value: the dtls role that the current peer's local sdp has.\n  // This is needed because a remote SDP with the same sessionId as a previous one may reappear later on\n  //  (music-unhold scenario) and the roles will be expected to be the same.\n  const dtlsRoleRecord = new Map()\n\n  // The latest remote description successfully set, even if the Peer has\n  //    been recreated since it was set.\n  let latestRemoteDescription\n\n  // Create and initialize the peer\n  let peer = peerManager.create(config.peer)\n  if (peer) {\n    // The id of the created peer\n    peerId = peer.id\n    setupPeerEventHandlers(peer)\n  } else {\n    throw new Error(`Peer creation error in Session ${sessionId}.`)\n  }\n\n  /**\n   * Records the peer's dtlsRole if it hasn't been recorded yet and associates it with a remote sdp's sessionId.\n   * @method recordNewDtlsRole\n   */\n  function recordNewDtlsRole() {\n    const remoteSdpSessionId = getSdpSessionId(peer.remoteDescription.sdp)\n    if (!dtlsRoleRecord.get(remoteSdpSessionId)) {\n      dtlsRoleRecord.set(remoteSdpSessionId, peer.dtlsRole)\n    }\n  }\n\n  /**\n   * @property {Array} getLocalTracks List of active Track objects the Session has added locally.\n   */\n  function getLocalTracks() {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.localTracks\n    } else {\n      return []\n    }\n  }\n\n  /**\n   * @property {Array} getAllLocalTracks List of all Track objects the Session has added locally.\n   */\n  function getAllLocalTracks() {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      // Get all local Track objects, not just the active ones.\n      return peer.senderTracks.map(nativeTrack => trackManager.get(nativeTrack.id))\n    } else {\n      return []\n    }\n  }\n\n  /**\n   * @property {Array} getRemoteTracks List of active Track objects the Session has received remotely.\n   */\n  function getRemoteTracks() {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.remoteTracks\n    } else {\n      return []\n    }\n  }\n\n  /**\n   * Retrieve a snapshot of the Session object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState() {\n    return {\n      id: sessionId,\n      localTracks: getLocalTracks(),\n      remoteTracks: getRemoteTracks(),\n      allLocalTracks: getAllLocalTracks()\n    }\n  }\n\n  /**\n   * Setup a warm PeerConnection.\n   * @method warmup\n   */\n  function warmup() {}\n\n  /**\n   * Add Track objects to the Session.\n   * @method addTracks\n   * @param  {Array} tracks List of Track objects.\n   * @param  {Object} dscpTrackMapping Track - DSCPSettings map\n   */\n  function addTracks(tracks, dscpTrackMapping) {\n    const peer = peerManager.get(peerId)\n    // TODO: Better error handling?\n    if (peer) {\n      const addTrackOrReuseTransceiverPromises = tracks.map(async track => {\n        // We try to find a reusable transceiver that we can attach the track to achieve the following:\n        // - Avoid transceiver pollution and needing to create a brand new transceiver to attach the track to.\n        // - Allow re-adding of the same track type that has been previously removed.\n        //   (This is so that we can still have re-adding of tracks when using the \"basic\" media API which imposes a 1-audio & 1-video limit)\n        const reusableTransceiver = peer.findReusableTransceiver(track.track.kind)\n\n        // If we can find a reusable transceiver, reuse it.\n        if (reusableTransceiver) {\n          // Replace the dummy track on the Sender with the actual track we want to send.\n          try {\n            await reusableTransceiver.sender.replaceTrack(track.track)\n          } catch (err) {\n            log.error(err)\n            throw err\n          }\n          /*\n           * Set the correct direction on the Transceiver to include that we now want to send:\n           *   - sendrecv --> sendrecv\n           *   - sendonly --> sendonly\n           *   - recvonly --> sendrecv\n           *   - inactive --> sendonly\n           */\n          reusableTransceiver.direction = ['sendrecv', 'recvonly'].includes(reusableTransceiver.direction)\n            ? 'sendrecv'\n            : 'sendonly'\n\n          log.info(`Track (${track.track.kind} : ${track.id}) reused transceiver (mid: ${reusableTransceiver.mid}).`)\n        } else {\n          // To get around the current limitation described above, we use peerConnection's `addTrack` when we can't find a reusable transceiver.\n          // `addTrack` does one of the following when called:\n          // - Create a new transceiver and attaches the track and stream to the sender\n          // - Find and use an existing transceiver that has never been used to send data before and attach the track and stream to the sender.\n          await peer.addTransceiver(track)\n          log.info(`Added track (${track.track.kind} : ${track.id}).`)\n        }\n\n        // Indicate that the Session has a new Track.\n        emitter.emit('new:track', {\n          local: true,\n          trackId: track.id\n        })\n\n        // Add the dscpControls to the session's settings map\n        settings.dscpControls = mergeValues(settings.dscpControls, dscpTrackMapping)\n\n        // Setup event handler for once the track ends\n        track.once('ended', ({ isUnsolicited }) => {\n          const peer = peerManager.get(peerId)\n          if (peer) {\n            // If the PeerConnection is closed, we don't need to worry about\n            //    removing the track (and it would throw an error anyway).\n            if (peer.signalingState !== 'closed') {\n              // If this track ending was expected, remove it from the Peer\n              //    immediately. Otherwise another operation will remove it.\n              if (!isUnsolicited) {\n                peer.removeTrack(track.id)\n\n                // Bubble the event upwards to event listeners.\n                emitter.emit('track:ended', {\n                  local: true,\n                  trackId: track.id,\n                  isUnsolicited\n                })\n              } else {\n                // In the event this track ending was due to a device change\n                // we should update our device list before notifying the client that\n                // the track ended so they don't try to use a removed device\n                // `true` --> Tell the SDK to _not_ bubble this event to the\n                //    application; only update state. The device disconnection\n                //    will trigger it's own \"device change\" event.\n                deviceManager.emit('change', true)\n\n                // Wait 50ms before emitting `track:ended` to allow the SDK\n                // a chance to update the device list in state\n                setTimeout(() => {\n                  emitter.emit('track:ended', {\n                    local: true,\n                    trackId: track.id,\n                    isUnsolicited\n                  })\n                }, 50)\n              }\n\n              // Remove track from session dscp settings\n              if (settings.dscpControls.hasOwnProperty(track.id)) {\n                log.debug(`Removing track ${track.id} from session dscp settings`)\n                delete settings.dscpControls[track.id]\n              }\n            } else {\n              log.debug(\n                `Received ended event for track ${track.id}, but its associated Peer ${peer.id} is closed. Ignoring this event...`\n              )\n            }\n          }\n        })\n      })\n\n      return Promise.all(addTrackOrReuseTransceiverPromises)\n    }\n  }\n\n  /**\n   * Creates a local SDP offer.\n   * @method createOffer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local offer.\n   * @return {Promise} Resolves with the offer.\n   */\n  function createOffer(options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      // Remove options.mediaDirections.\n      // This is because directions are now set in transceivers.\n      if (options.mediaDirections) {\n        setTransceiversDirection(options.mediaDirections)\n        delete options.mediaDirections\n      }\n\n      peer\n        .createOffer(options)\n        .then(offer => {\n          if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n            log.debug('Modifying local offer with SDP pipeline.')\n            offer.sdp = sdpPipeline.run(options.sdpHandlers, offer.sdp, {\n              type: offer.type,\n              endpoint: PEER.ENDPOINT.LOCAL\n            })\n          }\n\n          resolve(offer)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Sets a local SDP.\n   * @method setLocalDescription\n   * @param  {Object} description The description containing the SDP to set as the local description.\n   * @return {Promise} Resolves with the description.\n   */\n  function setLocalDescription(description) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer\n        .setLocalDescription(description)\n        .then(() => {\n          // Record the peer's dtls role if setting a local answer.\n          if (description.type === 'answer') {\n            recordNewDtlsRole()\n          }\n\n          // Set any parameters on the peer's senders if applicable\n          setParameters()\n\n          // Resolve with the _current_ local description, which may be\n          //    different than the provided description due trickle ICE config.\n          resolve(peer.localDescription)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Rollback the local description.\n   * @method rollbackLocalDescription\n   * @return {Promise} Resolves with the rollbacked description or error.\n   */\n  function rollbackLocalDescription() {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer\n        .setLocalDescription({ type: 'rollback' })\n        .then(() => {\n          resolve(peer.localDescription)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Parse the result of a call to the ice collection check function and act accordingly:\n   *  'StartCall' type - emit the negotiation ready event\n   *  'Error' type - end the session\n   *  'Wait' type - Schedule a callback to the ice collection check function\n   * @method iceCollectionCheckResult\n   * @param {Object} result The result of ice collection check function.\n   * @param {string} result.type The action to take.\n   * @param {number} result.wait How many ms to wait for the next scheduled check.\n   */\n  function iceCollectionCheckResult(result) {\n    const peer = peerManager.get(peerId)\n    if (!peer) {\n      return new Error(`Peer not found in Session ${sessionId}.`)\n    }\n\n    if (result.type === ICE_COLLECTION_RESULT_TYPES.START_CALL) {\n      log.info('Proceeding with the negotiation as instructed by the ice collection check.')\n      peer.isIceCollectionCheckOngoing = false\n      peer.emitter.emit('onnegotiationready')\n    } else if (result.type === ICE_COLLECTION_RESULT_TYPES.ERROR) {\n      log.info('Cleaning up session as instructed by the ice collection check.')\n      peer.isIceCollectionCheckOngoing = false\n      const localTracks = getLocalTracks()\n      localTracks.forEach(track => track.stop())\n      end()\n    } else if (result.type === ICE_COLLECTION_RESULT_TYPES.WAIT) {\n      // If `result.wait` is not set, then the ice collection check function is only waiting for either\n      //  ice candidate events or ice gathering state change events\n      if (result.wait) {\n        log.debug(`Setting a scheduled check for the ice collection check after ${result.wait} ms`)\n        peer.iceLoop = setTimeout(() => iceCollectionScheduledCheck(peer), result.wait)\n      }\n    } else {\n      log.info('Unexpected result type from ICE collection check function, ending call.')\n      peer.isIceCollectionCheckOngoing = false\n      const localTracks = getLocalTracks()\n      localTracks.forEach(track => track.stop())\n      end()\n    }\n  }\n\n  /**\n   * Sets parameters on the RTCRtpSenders\n   * @param {Object} mediaConstraints\n   */\n  function setParameters(mediaConstraints) {\n    // RTCRtpSender.setParameters is currently unsupported on Firefox (or at least not supported as it should be)\n    if (getBrowserDetails().browser === 'firefox') {\n      log.debug('Setting sender parameters not supported on Firefox; skipping.')\n      return\n    }\n\n    const promises = []\n\n    // Set the DSCPControls (i.e., network priorities) if set in the session's settings\n    for (const trackId in settings.dscpControls) {\n      promises.push(\n        new Promise((resolve, reject) => {\n          log.debug(`Setting networkPriority ${settings.dscpControls[trackId]} for sender with track ${trackId}`)\n          setNetworkPriority(trackId, settings.dscpControls[trackId]).then(resolve).catch(reject)\n        })\n      )\n    }\n\n    return Promise.all(promises)\n  }\n\n  /**\n   * Sets the networkPriority in the peer connection's sender's encodings.\n   * @method setNetworkPriority\n   * @param {string} trackId The track ID\n   * @param {string} networkPriority The network priority value to set\n   * @return {Promise} Resolves with the setParameters()\n   */\n  async function setNetworkPriority(trackId, networkPriority) {\n    const peer = peerManager.get(peerId)\n    const senders = peer.getSenders()\n\n    // search for a sender associated with the provided track id\n    const sender = senders.find(sender => sender.track.id === trackId)\n    if (sender) {\n      // Need to perform a getParameters() prior to a setParameters()\n      const parameters = await sender.getParameters()\n      parameters.encodings.forEach(encoding => {\n        encoding.networkPriority = networkPriority\n      })\n      return sender.setParameters(parameters)\n    } else {\n      const errMsg = `Cannot find sender associated with trackId: ${trackId}`\n      log.info(errMsg)\n      return Promise.reject(errMsg)\n    }\n  }\n\n  /**\n   * Generates (and sets) a local SDP offer.\n   * @method generateOffer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local offer.\n   * @return {Promise} Resolves with the offer.\n   */\n  function generateOffer(options = {}) {\n    // Backwards compatibility: Create the offer and set it as one operation.\n    return new Promise((resolve, reject) => {\n      createOffer(options).then(setLocalDescription).then(resolve).catch(reject)\n    })\n  }\n\n  /**\n   * Replaces a specified transceiver's sender.track.\n   * @method replaceTrack\n   * @param {Object} newTrack The MediaStreamTrack we want to place into the sender.\n   * @param {Object} options Options for specifying which transceiver's sender should be replaced. They are ordered by priority.\n   * @param {String} [options.trackId] The transceiver with the specific sender.track.id.\n   * @param {String} [options.mid] The transceiver with the specific media id.\n   * @return {Object} A Promise object which is fulfilled once the track has been replaced\n   */\n  function replaceTrack(newTrack, options) {\n    const peer = peerManager.get(peerId)\n    const track = trackManager.get(newTrack.id)\n    return peer\n      .replaceTrack(track.track, options)\n      .then(() => {\n        track.once('ended', ({ isUnsolicited }) => {\n          const peer = peerManager.get(peerId)\n          if (peer) {\n            // If the PeerConnection is closed, we don't need to worry about\n            //    removing the track (and it would throw an error anyway).\n            if (peer.signalingState !== 'closed') {\n              // If this track ending was expected, remove it from the Peer\n              //    immediately. Otherwise another operation will remove it.\n              if (!isUnsolicited) {\n                peer.removeTrack(track.id)\n              }\n\n              emitter.emit('track:ended', {\n                local: true,\n                trackId: track.id,\n                isUnsolicited\n              })\n              // Remove track from session dscp settings\n              if (settings.dscpControls.hasOwnProperty(track.id)) {\n                log.debug(`Removing track ${track.id} from session dscp settings`)\n                delete settings.dscpControls[track.id]\n              }\n            } else {\n              log.debug(\n                `Received ended event for track ${track.id}, but its associated Peer ${peer.id} is closed. Ignoring this event...`\n              )\n            }\n          }\n        })\n\n        emitter.emit('track:replaced', {\n          oldTrackId: options.trackId,\n          trackId: newTrack.id\n        })\n      })\n      .catch(err => err)\n  }\n\n  /**\n   * Sets the direction of transceivers.\n   * @method setTransceiversDirection\n   * @param {Object} mediaDirections Options for specifying the directions we want to set for certain medias (i.e., audio and video)\n   * @param {Array} [mediaDirections.audio] The direction we want to set of the transceivers with audio tracks\n   * @param {Array} [mediaDirections.video] The direction we want to set of the transceivers with video tracks\n   * @return {undefined}\n   */\n  function setTransceiversDirection(mediaDirections) {\n    const peer = peerManager.get(peerId)\n\n    // Set EVERY Transceiver's direction. This includes those with active tracks\n    //    and those without.\n    peer.getTransceivers().forEach(transceiver => {\n      const kind = transceiver.receiver.track.kind\n      setTransceiverDirection(transceiver, mediaDirections[kind])\n    })\n  }\n\n  /**\n   * Processes (and sets) a remote SDP offer.\n   * @method processOffer\n   * @param  {RTCSessionDescription} offer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the remote offer.\n   * @return {Promise}\n   */\n  function processOffer(offer, options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n        log.debug('Modifying remote offer with SDP pipeline.')\n        offer.sdp = sdpPipeline.run(options.sdpHandlers, offer.sdp, {\n          type: offer.type,\n          endpoint: PEER.ENDPOINT.REMOTE\n        })\n      }\n\n      peer\n        .setRemoteDescription(offer)\n        .then(() => {\n          // Set the offer as the latest remote description.\n          latestRemoteDescription = offer\n          resolve()\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Creates a local SDP answer.\n   * @method createAnswer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local answer.\n   * @return {Promise} Resolves with the answer.\n   */\n  function createAnswer(options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      // Remove options.mediaDirections.\n      // This is because directions are now set in transceivers.\n      if (options.mediaDirections) {\n        setTransceiversDirection(options.mediaDirections)\n        delete options.mediaDirections\n      }\n\n      // Set the dtlsRole here if the following are true:\n      // - It previously existed for this specific remote sdp.\n      // - It hasn't been set on a recreated peer yet.\n      const remoteSdpSessionId = getSdpSessionId(peer.remoteDescription.sdp)\n      const previousDtlsRole = dtlsRoleRecord.get(remoteSdpSessionId)\n      if (!peer.dtlsRole && previousDtlsRole) {\n        peer.dtlsRole = previousDtlsRole\n      }\n\n      peer\n        .createAnswer(options)\n        .then(answer => {\n          if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n            log.debug('Modifying local answer with SDP pipeline.')\n            answer.sdp = sdpPipeline.run(options.sdpHandlers, answer.sdp, {\n              type: answer.type,\n              endpoint: PEER.ENDPOINT.LOCAL\n            })\n          }\n          resolve(answer)\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Generates (and sets) a local SDP answer.\n   * @method generateAnswer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Object} [options.mediaDirections] Directions to use for media.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the local answer.\n   * @return {Promise} Resolves with the answer.\n   */\n  function generateAnswer(options = {}) {\n    // For backwards compatibility: Should use other APIs directly.\n    return new Promise((resolve, reject) => {\n      createAnswer(options).then(setLocalDescription).then(resolve).catch(reject)\n    })\n  }\n\n  /**\n   * Processes (and sets) a remote SDP answer.\n   * @method processAnswer\n   * @param  {RTCSessionDescription} answer\n   * @param  {Object} [options] Options for configuring the SDP.\n   * @param  {Array}  [options.sdpHandlers] SDP handlers for modifying the remote answer.\n   * @return {Promise}\n   */\n  function processAnswer(answer, options = {}) {\n    if (options.sdpHandlers || sdpPipeline.getHandlers().length) {\n      log.debug('Modifying remote answer with SDP pipeline.')\n      answer.sdp = sdpPipeline.run(options.sdpHandlers, answer.sdp, {\n        type: answer.type,\n        endpoint: PEER.ENDPOINT.REMOTE\n      })\n    }\n\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer\n        .setRemoteDescription(answer)\n        .then(() => {\n          // Record the peer's dtls role.\n          recordNewDtlsRole()\n\n          // Set the answer as the latest remote description.\n          latestRemoteDescription = answer\n\n          resolve()\n        })\n        .catch(reject)\n    })\n  }\n\n  /**\n   * Add an ICE candidate from the remote endpoint.\n   * @method addIceCandidate\n   * @param  {RTCIceCandidate} candidate\n   * @param  {Object} [options]\n   * @param  {string} [options.label] The Peer to perform the operation on.\n   * @return {Promise}\n   */\n  function addIceCandidate(candidate, options = {}) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n      }\n\n      peer.addIceCandidate(candidate).then(resolve).catch(reject)\n    })\n  }\n\n  /**\n   * End the Session.\n   * @method end\n   */\n  function end() {\n    log.info('Ending Session.')\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      peer.close()\n    }\n    emitter.emit('session:ended', sessionId)\n  }\n\n  /**\n   * Removes specified Track objects from the Session.\n   * @method removeTrack\n   * @param  {Array} trackIds List of IDs of Track objects to remove.\n   */\n  function removeTracks(trackIds) {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      // Get the list of all tracks on the Peer (event ended ones).\n      const allLocalTracks = peer.senderTracks\n      trackIds.forEach(trackId => {\n        if (allLocalTracks.findIndex(track => track.id === trackId) > -1) {\n          peer.removeTrack(trackId)\n          // Remove the track from the session dscp settings\n          if (settings.dscpControls.hasOwnProperty(trackId)) {\n            log.debug(`Removing track ${trackId} from session dscp settings`)\n            delete settings.dscpControls[trackId]\n          }\n        }\n      })\n    }\n  }\n\n  /*\n   * Restarts ICE connection\n   * @method restartIce\n   */\n  function restartIce() {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      peer.restartIce()\n    }\n  }\n\n  /*\n   * Get the DTLS role of the Peer\n   * @method getDtlsRole\n   * @return {string} The DTLS role of the Peer\n   */\n  function getDtlsRole() {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.dtlsRole\n    }\n  }\n\n  /**\n   * Send DTMF tones on specified Track object from the Session.\n   * @method sendDTMF\n   * @param {Object} options The DTMF options.\n   * @param {string} options.tone DTMF tone to send. Valid values are [0,1,2,3,4,5,6,7,8,9,#].\n   * @param {number} [options.duration=100] The amount of time, in milliseconds, that each DTMF tone should last.\n   * @param {number} [options.intertoneGap=70] The length of time, in milliseconds, to wait between tones.\n   * @param {Object} [sendOptions] The send options.\n   * @param {func} [sendOptions.callback] Optional callback for tone event .\n   * @param {string} [sendOptions.trackId] The trackId of the sender to use.\n   * @return {boolean} The success or fail indicator\n   */\n  function sendDTMF(DTMFOptions, sendOptions = {}) {\n    const peer = peerManager.get(peerId)\n    if (peer) {\n      return peer.sendDTMF(DTMFOptions, sendOptions)\n    } else {\n      return false\n    }\n  }\n\n  /**\n   * Retrieve RTCStatsReport from a sender.\n   * @method getStats\n   * @param  {string} trackId The track id associated with a sender.\n   * @return {Promise}\n   */\n  function getStats(trackId) {\n    return new Promise((resolve, reject) => {\n      const peer = peerManager.get(peerId)\n      if (!peer) {\n        reject(new Error(`Peer not found in Session ${sessionId}.`))\n        return\n      }\n      peer.getStats(trackId).then(resolve).catch(reject)\n    })\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * Sets up event handlers on a given peer.\n   * @method setupPeerEventHandlers\n   * @param {PeerConnection} targetPeer The peer to set event handlers on.\n   */\n  function setupPeerEventHandlers(targetPeer) {\n    targetPeer.oniceconnectionstatechange = event => {\n      emitter.emit('peer:iceConnectionStateChange', {\n        iceConnectionState: targetPeer.iceConnectionState\n      })\n    }\n\n    // TODO: Use `uniqueLabel` when setting event listeners (and bubbling events).\n    // When the peer gets an ICE candidate, emit it as\n    //  a message to be sent to the other end.\n    targetPeer.onicecandidate = event => {\n      emitter.emit('onicecandidate', {\n        candidate: event.candidate\n      })\n    }\n\n    /*\n     * Ice Collection Check Events:\n     *\n     * Emit an event for the session channel everytime:\n     *  - the ICE gathering state changes\n     *  - an ICE candidate is collected\n     *  - it is time for a scheduled call to the collection check function\n     *\n     */\n    targetPeer.onicegatheringstatechange = event => {\n      // Only emit the event if we are in an ongoing ice collection check loop\n      if (targetPeer.isIceCollectionCheckOngoing) {\n        // Clear any previous timeout/loop\n        if (targetPeer.iceLoop) {\n          clearTimeout(targetPeer.iceLoop)\n          targetPeer.iceLoop = undefined\n        }\n        emitter.emit('peer:iceGatheringStateChange', {\n          reason: ICE_COLLECTION_CHECK_REASONS.ICE_GATHERING_STATE_CHANGE,\n          iceCollectionDuration: targetPeer.iceTimer.timeFromStart(),\n          iceCandidates: targetPeer.iceCandidates,\n          iceGatheringState: targetPeer.iceGatheringState,\n          rtcPeerConnectionConfig: targetPeer.config,\n          rtcLocalSessionDescription: targetPeer.localDescription\n        })\n      }\n    }\n\n    // Debounce the listener for the ice candidate event since they can be emitted quite quickly\n    //  one after another. Options: leading:true will ensure the first invocation always occur, and\n    //  trailing:false (default) ensures the last invocation will occur after the delay as appropriate.\n    targetPeer.on(\n      'iceCandidateCollected',\n      unfixedDebounce(50)(\n        iceCollectionInfo => {\n          // Only emit the event if we are in an ongoing ice collection check process\n          if (targetPeer.isIceCollectionCheckOngoing) {\n            // Clear any previous timeout/loop\n            if (targetPeer.iceLoop) {\n              clearTimeout(targetPeer.iceLoop)\n              targetPeer.iceLoop = undefined\n            }\n            emitter.emit('peer:iceCandidateCollected', {\n              reason: ICE_COLLECTION_CHECK_REASONS.NEW_CANDIDATE,\n              ...iceCollectionInfo\n            })\n          }\n        },\n        { leading: true }\n      )\n    )\n\n    targetPeer.on('scheduledCheck', iceCollectionInfo => {\n      // Only emit the event if we are in an ongoing ice collection check loop\n      if (targetPeer.isIceCollectionCheckOngoing) {\n        // Clear any previous timeout/loop\n        if (targetPeer.iceLoop) {\n          clearTimeout(targetPeer.iceLoop)\n          targetPeer.iceLoop = undefined\n        }\n        emitter.emit('peer:iceCollectionScheduledCheck', {\n          reason: ICE_COLLECTION_CHECK_REASONS.SCHEDULED,\n          ...iceCollectionInfo\n        })\n      }\n    })\n\n    // Handle when the Peer receives a new remote track.\n    targetPeer.ontrack = track => {\n      let media = mediaManager.get(track.getStream().id)\n      if (media) {\n        // Add the new Track to its Media object.\n        media.addTrack(track)\n      } else {\n        // Create a new Media object using the Track.\n        media = mediaManager.createRemote(track.getStream(), [track])\n      }\n\n      track.once('ended', () => {\n        emitter.emit('track:ended', {\n          local: false,\n          trackId: track.id,\n          // If a remote track is ended, then a remote action triggered it. Consider\n          //    this solicited since we don't want to take an action here.\n          isUnsolicited: false\n        })\n      })\n\n      const { kind } = track.getState()\n      log.info(`Received new track (${kind} : ${track.id})`)\n\n      // Indicate that the Session has a new Track.\n      emitter.emit('new:track', {\n        local: false,\n        trackId: track.id\n      })\n    }\n  }\n\n  /**\n   * Creates a new peer and replaces the current peer being used by this session.\n   *     This will close the previous Peer, stopping any media being sent/received on it.\n   * @method recreatePeer\n   */\n  async function recreatePeer() {\n    const oldPeer = peer\n    const newPeer = peerManager.create(config.peer)\n    if (newPeer) {\n      // The id of the created peer\n      peerId = newPeer.id\n      log.debug(`Recreated Peer with ID: ${peerId}`)\n      peer = newPeer\n\n      // Copy tracks\n      await Promise.all(\n        oldPeer.localTracks.map(async oldLocalTrack => {\n          await newPeer.addTransceiver(oldLocalTrack)\n        })\n      )\n\n      // Set event handlers\n      setupPeerEventHandlers(newPeer)\n\n      // Close the old peer\n      oldPeer.close()\n    } else {\n      throw new Error(`Peer creation error in Session ${sessionId}.`)\n    }\n  }\n\n  function getPeer() {\n    return peer\n  }\n\n  function getRemoteDescription() {\n    return peer.remoteDescription\n  }\n\n  function getLatestRemoteDesc() {\n    return latestRemoteDescription\n  }\n\n  /**\n   * Given a list of media section IDs, return the list of remote track IDs from\n   *     the Transceivers that the media sections represent.\n   * @param {Array<string>} mids List of media section IDs.\n   * @return {Array<string>} List of remote track IDs.\n   */\n  function getRemoteTrackIdsFromTransceivers(mids) {\n    const transceivers = peer.getTransceivers()\n\n    const remoteTrackIds = []\n    // Iterate over every transceiver\n    transceivers.forEach(transceiver => {\n      // If the transceiver's mid value is in our list of mids, add it to the\n      //    remoteTrackIds array to be returned.\n      // The `if` condition looks sketchy because we are comparing a string to\n      //    a number.\n      if (mids.some(mid => mid + '' === transceiver.mid)) {\n        const id = transceiver.receiver.track.id\n        remoteTrackIds.push(id)\n      }\n    })\n\n    return remoteTrackIds\n  }\n\n  /**\n   * Get all active, incoming remote tracks that are part of the Session.\n   * @return {Array<string>} List of remote track IDs.\n   */\n  function getIncomingRemoteTrackIds() {\n    const transceivers = peer.getTransceivers()\n\n    const remoteTrackIds = []\n    transceivers.forEach(transceiver => {\n      // Check the `direction` of the transceiver.\n      // For incoming calls, the `currentDirection` property will not be set since that transceiver\n      // is not yet fully negotiated.\n      const isReceiving =\n        transceiver.mid !== null &&\n        transceiver.direction.includes('recv') &&\n        transceiver.receiver.track.readyState === 'live'\n      if (isReceiving) {\n        remoteTrackIds.push(transceiver.receiver.track.id)\n      }\n    })\n\n    return remoteTrackIds\n  }\n\n  /**\n   * Get all active, remote tracks that are part of the Session.\n   * @return {Array<string>} List of remote track IDs.\n   */\n  function getActiveRemoteTrackIds() {\n    const transceivers = peer.getTransceivers()\n\n    const remoteTrackIds = []\n    transceivers.forEach(transceiver => {\n      // transceiver.mid !== null --> The Transceiver is in the SDP.\n      // currentDirection --> The Transceiver has been negotiated.\n      // currentDirection.includes(recv) --> It has a remote track.\n      // track.readyState === live ---> It is active (...not thorough).\n      const isReceiving =\n        transceiver.mid !== null &&\n        transceiver.currentDirection &&\n        transceiver.currentDirection.includes('recv') &&\n        transceiver.receiver.track.readyState === 'live'\n      if (isReceiving) {\n        remoteTrackIds.push(transceiver.receiver.track.id)\n      }\n    })\n\n    return remoteTrackIds\n  }\n\n  /**\n   * Session method to load an audio file and insert it into the Session by\n   *    replacing an existing audio track temporarily.\n   *\n   * Provides feedback at two points in time:\n   *    1) When the audio file starts playing, or fails to start playing.\n   *        Done by fulfilling the method's Promise.\n   *    2) When the audio file ends playing, or encounters an error while playing.\n   *        Done by emitting an event.\n   *\n   * If the original audio track is replaced, but cannot be put back on the Session afterwards,\n   *    it is considered an error scenario. To \"fix\" this, the method will stop that track.\n   *    this is meant to avoid it being a \"ghost\" track. It will:\n   *        1) Clean-up resources and release the microphone,\n   *        2) Allow an application to handle it the same as any other track ending unsolicated.\n   *\n   * @method insertAudio\n   * @param {string} filePath\n   * @return {Promise} Resolves when audio file starts playing. Rejects if fails to start.\n   */\n  function insertAudio(filePath) {\n    return new Promise((resolve, reject) => {\n      let isReady = false\n      /*\n       * `playIfReady` needs to be called twice to start playing the audio file.\n       *    Once to ensure it \"can play through\".\n       *    Once to ensure the media will be streamed through the Peer.\n       */\n      function playIfReady() {\n        if (isReady) {\n          audio.play()\n        } else {\n          isReady = true\n        }\n      }\n\n      /*\n       * End the original track from the Call, but pretend that it was \"unsolicited\". This\n       *    makes it appear the same as if something other than the SDK stopped the track\n       *    so that it falls into the same error-handling scenario as them.\n       */\n      function endOriginalTrack() {\n        log.info(`Stopping track ${oldTrack.id} to release the microphone after error.`)\n        oldTrack.track.stop()\n        oldTrack.track.onended(new Event('track-error'))\n      }\n\n      // Get the audio track we will be replacing temporarily.\n      const peer = peerManager.get(peerId)\n      const oldTrack = peer.localTracks.find(track => {\n        return track.track.kind === 'audio' && track.track.readyState === 'live'\n      })\n      if (!oldTrack) {\n        reject(new Error('No valid local audio track found to insert audio file on.'))\n      }\n      // The ID of the track currently on the Call.\n      let currentTrackId = oldTrack.id\n\n      const audio = new Audio(filePath)\n      // Set the volume to 20%.\n      audio.volume = 0.2\n\n      // Create a source node from that MediaElement.\n      const context = new AudioContext()\n      const source = context.createMediaElementSource(audio)\n\n      // Connect the source node to the destination (which has a MediaStream).\n      const dest = context.createMediaStreamDestination()\n      source.connect(dest)\n      const audioTrack = dest.stream.getAudioTracks()[0]\n\n      /*\n       * Replace the existing audio track on the Peer with the file's track.\n       * When it has been replaced, that is 1 of 2 conditions to be met before playing it.\n       */\n      peer\n        .replaceTrack(audioTrack, { trackId: oldTrack.id })\n        .then(() => {\n          // The original track has successfully been replaced; take note of that.\n          currentTrackId = audioTrack.id\n          log.debug('Replaced audio from file media.')\n          playIfReady()\n        })\n        .catch(err => {\n          log.info(`Failed to replace audio with file media: ${err.message}.`)\n          reject(new Error('Failed to replace audio track with file media.'))\n        })\n\n      /*\n       * Audio event listeners:\n       *    - canplaythrough: Enough of the file has been loaded that buffering isn't needed.\n       *    - play: The file has started playing.\n       *    - error: An error was encountered.\n       *    - ended: The file has stopped playing.\n       *\n       * From our usage of `audio`:\n       *    - canplaythrough: Happens once, before we start playing the file.\n       *    - play: Indicates we have started playing the file.\n       *    - error: Most likely that the file could not start playing because `new Audio(filePath)`\n       *        failed. Could also happen mid-play, but unknown.\n       *    - ended: Indicates the file reached the end (successfully).\n       *\n       * Ref: https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement\n       */\n\n      // When the track \"can play through\", that is 1 of 2 conditions to be met before playing it.\n      audio.oncanplaythrough = () => {\n        log.debug('File media ready to be played.')\n        playIfReady()\n      }\n\n      // When the file start's playing, resolve the `insertAudio` promise to provide feedback.\n      audio.onplay = () => {\n        log.debug(`Audio file started playing. Duration of ${audio.duration} seconds.`)\n        resolve(audio.duration)\n      }\n\n      // On an error, reject the `insertAudio` promise to provide feedback.\n      audio.onerror = () => {\n        log.info('Encountered error trying to play audio file.')\n\n        // If the original track is not on the Peer when this error happened,\n        //    try to put it back before rejecting the `insertAudio` method.\n        if (currentTrackId !== oldTrack.id) {\n          peer.replaceTrack(oldTrack.track, { trackId: audioTrack.id }).catch(() => {\n            // If we can't \"rollback\" the operation, end the original track\n            //    to prevent it from becoming a \"ghost\" track.\n            endOriginalTrack()\n          })\n        }\n        // Reject the promise if it hasn't been fulfilled.\n        reject(new Error('Failed to play audio file.'))\n        // Emit a failure event in case the promise has already been fulfilled.\n        emitter.emit('audioFileEnded', false)\n      }\n\n      // When the file ends, replace the original audio track back on the Peer.\n      audio.onended = event => {\n        log.debug('Audio file ended playing.')\n\n        peer\n          .replaceTrack(oldTrack.track, { trackId: audioTrack.id })\n          .then(() => {\n            log.debug('Replaced original audio track.')\n            emitter.emit('audioFileEnded', true)\n          })\n          .catch(err => {\n            log.info('Failed to replace original audio track.', err)\n            endOriginalTrack()\n            // Failed to replace the original audio track.\n            emitter.emit('audioFileEnded', false)\n          })\n      }\n    })\n  }\n\n  /**\n   * Special-case method that combines getUserMedia and adding the tracks to\n   *    the Session.\n   * The goal of combining these methods is for Proxy-mode, to reduce the number\n   *    of times messages need to cross the channel. This function reduces the\n   *    trips from 3 (createLocal, getTracks, addTracks) to 1 (addNewMedia).\n   * @method addNewMedia\n   * @param {Object} mediaConstraints\n   * @return {Promise}\n   */\n  function addNewMedia(constraints, dscpControls) {\n    /*\n     * Helper method that wraps the getUserMedia functions on the MediaManager.\n     *    The wrapper is to prevent them from rejecting, so even a failure will\n     *    resolve the promise returned by this function. This allows the calling\n     *    function to wait for all promises to settle, so that media can be\n     *    cleaned-up if need be. (For some reason Promise.allSettled was causing\n     *    errors...)\n     * @method getMedia\n     */\n    function getMedia(constraints) {\n      const { audio, video, screen } = constraints\n\n      return new Promise(resolve => {\n        if (audio || video) {\n          mediaManager\n            .createLocal({ audio, video })\n            .then(media => {\n              resolve({ status: 'fulfilled', value: media })\n            })\n            .catch(err => {\n              resolve({ status: 'rejected', value: err })\n            })\n        } else if (screen) {\n          mediaManager\n            .createLocalScreen({ screen })\n            .then(media => {\n              resolve({ status: 'fulfilled', value: media })\n            })\n            .catch(err => {\n              resolve({ status: 'rejected', value: err })\n            })\n        }\n      })\n    }\n\n    return new Promise((resolve, reject) => {\n      const { audio, video, screen } = constraints\n      let mediaProm, screenProm\n\n      if (audio || video) {\n        mediaProm = getMedia({ audio, video })\n      }\n      if (screen) {\n        screenProm = getMedia({ screen })\n      }\n\n      Promise.all([mediaProm, screenProm]).then(results => {\n        if (results.some(result => result && result.status === 'rejected')) {\n          // At least one promise rejected. Clean-up any successful media, then\n          //    reject the original promise.\n          const medias = results.filter(result => result && result.status === 'fulfilled').map(result => result.value)\n\n          Promise.all(medias.map(media => media.stop)).then(() => {\n            const err = results.find(result => result.status === 'rejected').value\n\n            let errMessage\n            if (err.name === 'OverconstrainedError') {\n              errMessage = `Failed to get media due to constraint: ${err.constraint}.`\n            } else {\n              errMessage = `Failed to get media => Name: ${err.name}; Error Message :${err.message}.`\n            }\n            log.info(errMessage)\n\n            const newErr = new Error(errMessage)\n            newErr.name = err.name\n            reject(newErr)\n          })\n        } else {\n          // All media was gathered successfully.\n          const dscpTrackMapping = {}\n          const tracks = results.reduce((acc, cur) => {\n            // Add the tracks from the current media object to the accumulator.\n            if (cur) {\n              const tracks = cur.value.getTracks()\n              if (dscpControls) {\n                for (const track of tracks) {\n                  if (track.getType() === 'audio' && dscpControls.audioNetworkPriority) {\n                    dscpTrackMapping[track.id] = dscpControls.audioNetworkPriority\n                  } else if (track.getType() === 'video' && dscpControls.videoNetworkPriority) {\n                    dscpTrackMapping[track.id] = dscpControls.videoNetworkPriority\n                  } else if (track.getType() === 'screen' && dscpControls.screenNetworkPriority) {\n                    dscpTrackMapping[track.id] = dscpControls.screenNetworkPriority\n                  }\n                }\n              }\n              return acc.concat(tracks)\n            }\n            // If cur is undefined, just return the accumulator.\n            return acc\n          }, [])\n\n          addTracks(tracks, dscpTrackMapping)\n            .then(() => {\n              const medias = results.filter(result => result && result.value).map(result => result.value)\n              resolve(medias)\n            })\n            .catch(reject)\n        }\n      })\n    })\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id: sessionId,\n    config,\n    // Getter APIs.\n    get peer() {\n      return getPeer()\n    },\n    getState,\n    get localTracks() {\n      return getLocalTracks()\n    },\n    get remoteTracks() {\n      return getRemoteTracks()\n    },\n    get allLocalTracks() {\n      return getAllLocalTracks()\n    },\n    warmup,\n    addTracks,\n    removeTracks,\n    replaceTrack,\n    setTransceiversDirection,\n    // Negotiation APIs.\n    createOffer,\n    createAnswer,\n    setLocalDescription,\n    getRemoteDescription,\n    getLatestRemoteDesc,\n    generateOffer,\n    processOffer,\n    generateAnswer,\n    processAnswer,\n    iceCollectionCheckResult,\n    // Other APIs.\n    recreatePeer,\n    rollbackLocalDescription,\n    addIceCandidate,\n    restartIce,\n    getDtlsRole,\n    end,\n    sendDTMF,\n    getStats,\n    setParameters,\n    getRemoteTrackIdsFromTransceivers,\n    getIncomingRemoteTrackIds,\n    getActiveRemoteTrackIds,\n    insertAudio,\n    addNewMedia,\n    // Event APIs.\n    on,\n    once,\n    off\n  }\n}\n","import { logManager } from '../logs'\n\n// Libraries.\nimport EventEmitter from 'rbbn-emitter'\n\n/**\n * Wrapper object for a native MediaStreamTrack object.\n * Ref: https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack\n * @method Track\n */\nexport default function Track(mediaTrack, mediaStream) {\n  const log = logManager.getLogger('Track', mediaTrack.id)\n  log.info(`Creating new ${mediaTrack.kind} Track.`)\n\n  // Internal variables.\n  const id = mediaTrack.id\n  const track = mediaTrack\n  let stream = mediaStream\n  let type\n  let isLocalTrack\n  let isDetatchedTrack\n  let constraints = {}\n  const emitter = new EventEmitter()\n\n  /**\n   * When a track ends, the Track itself doesn't do anything about it.\n   * It \"bubbles\" the event up to be handled at a higher level.\n   */\n  track.onended = event => {\n    // Check whether this function was called because a native event was emitted\n    //    or if it was called manually by the SDK.\n    const isNative = event instanceof Event\n\n    const endpoint = isLocalTrack ? 'local' : 'remote'\n    const trigger = isNative ? 'unsolicited' : 'solicited'\n    log.debug(`Track ended (${endpoint}, ${trigger}).`, event)\n\n    emitter.emit('ended', {\n      trackId: track.id,\n      /*\n       * If an event triggered this listener, then it was a remote notification\n       *    (for remote track) or browser action (for local track) that caused it.\n       *    If it was a local track, then the track ending was not part of a\n       *    renegotiation and something will need to handle this situation.\n       *\n       * Otherwise, the SDK called `track.onended()` when we stopped the track as\n       *    part of an operation. The operation should handle the track being\n       *    ended since it was solicited.\n       */\n      isUnsolicited: isNative,\n      isDetached: isDetached()\n    })\n  }\n\n  /**\n   * When a track is muted, we forward this to any listener.\n   * This handler is typically invoked by actions triggered outside the\n   * direct control of the webrtc SDK.\n   */\n  track.onmute = event => {\n    log.debug('Event emitted: ', event)\n    emitter.emit('muted', {\n      trackId: track.id,\n      mediaId: stream.id,\n      isLocal: isLocalTrack\n    })\n  }\n\n  /**\n   * When a track is unmuted, we forward this to any listener.\n   * This handler is typically invoked by actions triggered outside the\n   * direct control of the webrtc SDK.\n   */\n  track.onunmute = event => {\n    log.debug('Event emitted: ', event)\n    emitter.emit('unmuted', {\n      trackId: track.id,\n      mediaId: stream.id,\n      isLocal: isLocalTrack\n    })\n  }\n\n  function setType(mediaType) {\n    type = mediaType\n  }\n\n  function getType() {\n    return type\n  }\n\n  function setIsLocal(isLocal) {\n    isLocalTrack = isLocal\n  }\n\n  function isLocal() {\n    return isLocalTrack\n  }\n\n  function setIsDetached(detached) {\n    isDetatchedTrack = detached\n  }\n\n  function isDetached() {\n    return isDetatchedTrack\n  }\n\n  function setStream(newStream) {\n    stream = newStream\n  }\n  function getStream() {\n    return stream\n  }\n\n  /**\n   * Retrieve a snapshot of the Track object's current state.\n   * @method getState\n   * @return {Object}\n   */\n  function getState() {\n    return {\n      id,\n      streamId: stream.id,\n      kind: track.kind,\n      type,\n      isLocal: isLocalTrack,\n      label: track.label,\n      muted: track.muted,\n      enabled: track.enabled,\n      state: track.readyState,\n      detached: isDetatchedTrack\n    }\n  }\n\n  /**\n   * Set this Track to be disabled and disallow the Track to render the source stream.\n   * @method mute\n   */\n  function mute() {\n    track.enabled = false\n  }\n\n  /**\n   * Set this Track to be enabled and allow the Track to render the source stream.\n   * @method unmute\n   */\n  function unmute() {\n    track.enabled = true\n  }\n\n  /**\n   * Calls native stop() function to deassociate the source and the track.\n   * @method stop\n   */\n  function stop() {\n    if (track.readyState === 'ended') {\n      log.debug('Track already ended.')\n      return\n    }\n\n    track.stop()\n    /**\n     * Treat stopping the track the same as it being ended.\n     * Normally, onended is not triggered when `stop` is called, only when it is\n     *    \"remotely ended\".\n     */\n    track.onended()\n  }\n\n  /**\n   * Gets the currently set constraints for the track.\n   * @method getConstraints\n   * @return {Object}\n   */\n  function getConstraints() {\n    return constraints\n  }\n\n  /**\n   * Set the values for constrainable properties of the track.\n   * @method applyConstraints\n   * @param  {Object} constraints The list of constrainable properties.\n   */\n  function setConstraints(constr) {\n    constraints = constr\n  }\n\n  function on(...args) {\n    return emitter.on(...args)\n  }\n\n  function once(...args) {\n    return emitter.once(...args)\n  }\n\n  function off(...args) {\n    return emitter.off(...args)\n  }\n\n  /**\n   * The exposed API.\n   */\n  return {\n    id,\n    // Track APIs.\n    getState,\n    mute,\n    unmute,\n    stop,\n    getConstraints,\n    setConstraints,\n    // Event APIs.\n    on,\n    off,\n    once,\n    // The native track and stream was accessible before, so it was\n    //    used when it probably shouldn't have been.\n    // TODO: Find a better solution.\n    track,\n    setStream,\n    getStream,\n    setType,\n    getType,\n    setIsLocal,\n    isLocal,\n    setIsDetached,\n    isDetached\n  }\n}\n","/**\n * Extracts the session ID from the SDP.\n * Session ID is located in the o= line.\n * Ref: https://tools.ietf.org/html/rfc4566#section-5.2\n * @method getSdpSessionId\n * @param  {string} sdp A valid SDP string.\n * @return {string} The SDP's session ID.\n */\nexport function getSdpSessionId(sdp) {\n  const oLine = sdp.match(/o=.*/gm)\n\n  if (oLine && oLine[0]) {\n    return oLine[0].split(' ')[1]\n  }\n}\n","import { logManager } from '../logs'\n// Constants.\nimport { MEDIA_DIR } from '../constants'\n\nconst log = logManager.getLogger('SdpPipeline')\n\n/**\n * SDP handler to remove the trickle ICE option from media groups.\n * Modifies the SDP so it claims to not support trickle ICE.\n * @method removeTrickleIce\n * @param  {Object} sdp\n * @param  {Object} info\n * @param  {String} info.type\n * @param  {String} info.endpoint\n * @param  {Object} originalSdp\n * @return {Object}\n */\nexport function removeTrickleIce(sdp, info, originalSdp) {\n  sdp.media.forEach(media => {\n    if (media.iceOptions === 'trickle') {\n      log.debug(`Removing trickle ICE option from ${media.type} media.`)\n      delete media.iceOptions\n    }\n  })\n\n  return sdp\n}\n\n/**\n * SDP handler to delete the bundle groupings line from the SDP.\n * PeerConnections do not have an option to completely disable bundling, so\n *    manually removing the line from the SDP is needed to prevent bundling.\n * @method removeBundling\n * @param  {Object}     sdp           The session description.\n * @param  {Object}     info          Information about the session description.\n * @param  {RTCSdpType} info.type     The session description's type.\n * @param  {String}     info.endpoint Which end of the connection created the SDP.\n * @param  {Object}     originalSdp   The original SDP before any modifications.\n * @return {Object}\n */\nexport function removeBundling(sdp, info, originalSdp) {\n  if (sdp.groups) {\n    log.debug('Removing SDP bundling groups.')\n    delete sdp.groups\n  }\n\n  return sdp\n}\n\n/**\n * Currying function to create an SDP handler.\n * The SDP handler modifies the SDP to change the direction of media.\n * @method changeMediaDirection\n * @param  {Object} mediaDirections\n * @param  {string} [audio] Direction to set for audio.\n * @param  {string} [video] Direction to set for video.\n * @return {Function} SDP handler.\n */\nexport function changeMediaDirection({ audio, video }) {\n  function isValid(direction) {\n    return Object.values(MEDIA_DIR).includes(direction)\n  }\n\n  /**\n   * SDP handler to change the direction of media a-lines.\n   */\n  return (sdp, info, originalSdp) => {\n    sdp.media.forEach(media => {\n      if (media.type === 'audio' && isValid(audio)) {\n        media.direction = audio\n      } else if (media.type === 'video' && isValid(video)) {\n        media.direction = video\n      }\n    })\n    return sdp\n  }\n}\n\n/**\n * SDP handler to modify the DTLS role of a locally generated answer SDP.\n *\n * The point of this SDP handler is to avoid a DTLS role conflict during a\n *    renegotiation. A role conflict occurs when DTLS roles have been selected\n *    during initial negotiation, but during renegotiation, the answerer selects\n *    the opposite role than previously used.\n *\n * This handler only needs to be used when the Peer is generating an answer SDP.\n *    That is the only point when a conflicting role can be chosen.\n *\n * This handler prevents the role changing by comparing the SDP's role with the\n *    role that the Peer previously selected. If they conflict, the Peer's\n *    previous role is used.\n *\n * Related stories: KAA-1426, KAA-1562.\n * References: https://groups.google.com/forum/#!topic/discuss-webrtc/gsw3OEAwNKo\n * @method preventDtlsRoleChange\n * @param  {Object}     newSdp          The session description.\n * @param  {Object}     info            Information about the session description.\n * @param  {RTCSdpType} info.type       The session description's type.\n * @param  {string}     info.endpoint   Which end of the connection created the SDP.\n * @param  {string}     [info.dtlsRole] The previously select DTLS role of the Peer.\n * @param  {Object}     originalSdp     The sdp in its initial state.\n * @return {Object}                     The modified SDP.\n */\nexport function preventDtlsRoleChange(newSdp, info, originalSdp) {\n  /**\n   * This SDP handler only affects local answer SDPs.\n   *  - Only local because we are trying to prevent role conflict issues caused\n   *        by the answerer choosing the \"wrong\" role during a renegotiation.\n   *  - Only answer because offers are always actpass.\n   */\n  if (info.endpoint === 'local' && info.type === 'answer') {\n    for (const mLine of newSdp.media) {\n      /**\n       * If the generated DTLS role is different than what the Peer expects,\n       *    replace it. The Peer expects the DTLS role to stay the same\n       *    throughout renegotiations.\n       */\n      if (mLine.setup && info.dtlsRole && mLine.setup !== info.dtlsRole) {\n        log.debug(`Changing DTLS role from ${mLine.setup} to ${info.dtlsRole}.`)\n        mLine.setup = info.dtlsRole\n      }\n    }\n  }\n  return newSdp\n}\n","// Libraries.\nimport sdpTransform from 'sdp-transform'\nimport { cloneDeep, isArray, isFunction } from 'lodash/fp'\n\nimport { logManager } from '../logs'\nconst log = logManager.getLogger('SdpPipeline')\n\n/**\n * Basic SDP pipeline runner.\n * Does not include any default handlers.\n * @method sdpPipeline\n * @param  {Array}      handlers       List of functions that transform the SDP.\n * @param  {String}     sdp            The session description.\n * @param  {RTCSdpType} info           Information about the session description.\n * @param  {RTCSdpType} info.type      The session description's type.\n * @param  {String}     info.endpoint  Which end of the connection created the SDP.\n * @param  {Boolean}    info.isInitiator Whether this session initiated the connection or not.\n * @return {String}     The modified session description.\n\n */\nexport function runPipeline(handlers, sdp, info) {\n  const objectSdp = sdpTransform.parse(sdp)\n\n  const originalSdp = Object.freeze(objectSdp)\n  let newSdp = cloneDeep(originalSdp)\n\n  if (isArray(handlers)) {\n    handlers.forEach(handler => {\n      if (isFunction(handler)) {\n        newSdp = handler(newSdp, info, originalSdp)\n      } else {\n        log.error('SDP handler not a function; skipping.')\n      }\n    })\n  }\n\n  return sdpTransform.write(newSdp)\n}\n\n/**\n * Create an instance of the SDP pipeline.\n * Allows for persistent SDP handlers to be set and implicitly used.\n * @method createPipeline\n * @return {Object} An SDP pipeline.\n */\nfunction createPipeline() {\n  /**\n   * SDP handlers that should be included with every pipeline run.\n   * @type {Array}\n   */\n  let defaultHandlers = []\n\n  /**\n   * Use the pipeline to process an SDP.\n   * @method run\n   * @param  {Array}      handlers      List of functions that transform the SDP.\n   * @param  {String}     sdp           The session description.\n   * @param  {RTCSdpType} info          Information about the session description.\n   * @param  {RTCSdpType} info.type     The session description's type.\n   * @param  {String}     info.endpoint Which end of the connection created the SDP.\n   * @return {String}     The modified session description.\n   */\n  function run(handlers = [], sdp, info) {\n    return runPipeline(handlers.concat(defaultHandlers), sdp, info)\n  }\n\n  /**\n   * Set the SDP handlers that should be included with every pipeline run.\n   * @method setHandlers\n   * @param  {Array} handlers List of SDP handler functions.\n   */\n  function setHandlers(handlers) {\n    if (isArray(handlers)) {\n      defaultHandlers = defaultHandlers.concat(handlers)\n    }\n  }\n\n  /**\n   * Get the SDP handlers that are included with every pipeline run.\n   * @method getHandlers\n   * @return {Array} List of SDP handler functions.\n   */\n  function getHandlers() {\n    return defaultHandlers\n  }\n\n  return {\n    run,\n    setHandlers,\n    getHandlers\n  }\n}\n\n// Export an instance of the pipeline to be used by everything.\nexport default createPipeline()\n","import { MEDIA_DIR } from '../constants'\nimport { values, includes } from 'lodash/fp'\n\nimport { logManager } from '../logs'\nconst log = logManager.getLogger('SdpPipeline')\n\n/**\n * Sets a transceiver's direction.\n * Checks that the desired direction is a valid one.\n * @method setTransceiverDirection\n * @param {Object} transceiver The transceiver that we want to modify.\n * @param {String} targetDirection The desired direction we want to change to.\n * @return {Boolean} Indicator on whether the transceiver direction was successfully changed.\n */\nexport function setTransceiverDirection(transceiver, targetDirection) {\n  if (!includes(targetDirection, values(MEDIA_DIR))) {\n    log.info(`Invalid direction \"${targetDirection}\"`)\n    return false\n  }\n\n  // Only in Safari:\n  //  - has transceiver.setDirection\n  //  - transceiver.direction is readOnly\n  if (transceiver.setDirection) {\n    transceiver.setDirection(targetDirection)\n  } else {\n    transceiver.direction = targetDirection\n  }\n  return true\n}\n","import adapter from 'webrtc-adapter/out/adapter'\n\nexport function makeSafeForCSS(name) {\n  if (!name) {\n    return name\n  } else {\n    return name.replace(/[^a-z0-9]/g, '')\n  }\n}\n\n/**\n * @returns The browser details as provided by webrtc-adapter\n */\nexport function getBrowserDetails() {\n  return adapter.browserDetails\n}\n","import { mergeAllWith, isArray } from 'lodash/fp'\n\n/**\n * Deeply merges the values of multiple objects. Objects on the left receive the values from objects on their right.\n * Unlike lodash's default merge behavior this doesn't merge arrays.\n *\n * @name mergeValues\n * @param {...Object} objects - Objects to merge\n * @return {Object} A new object containing the merged values.\n */\nexport default function mergeValues(...objects) {\n  return mergeAllWith((leftValue, rightValue) => {\n    // Overwrite the default behavior of lodash's merge for arrays and simply\n    // clobber what's on the left so we don't end up with merged arrays.\n    if (isArray(leftValue)) {\n      return rightValue\n    }\n  }, objects)\n}\n","import paramParser from 'query-string'\n\n/**\n * Utility function to convert an object to a query string.\n *\n * @param {Object} params An object of query parameters to be parsed and converted for use in a URL string\n * @param {Object} [options] Options to be passed to the query-string library\n * * @param {String} [options.arrayFormat] Format in which to compose array values which were passed as query parameters\n */\nexport default function toQueryString(params = {}, options = {}) {\n  if (Object.keys(params).length > 0) {\n    const stringifiedParams = paramParser.stringify(params, options)\n    return '?' + stringifiedParams\n  }\n  return ''\n}\n","/*! https://mths.be/base64 v1.0.0 by @mathias | MIT license */\n;(function(root) {\n\n\t// Detect free variables `exports`.\n\tvar freeExports = typeof exports == 'object' && exports;\n\n\t// Detect free variable `module`.\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\n\t// Detect free variable `global`, from Node.js or Browserified code, and use\n\t// it as `root`.\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tvar InvalidCharacterError = function(message) {\n\t\tthis.message = message;\n\t};\n\tInvalidCharacterError.prototype = new Error;\n\tInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\n\tvar error = function(message) {\n\t\t// Note: the error messages used throughout this file match those used by\n\t\t// the native `atob`/`btoa` implementation in Chromium.\n\t\tthrow new InvalidCharacterError(message);\n\t};\n\n\tvar TABLE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\t// http://whatwg.org/html/common-microsyntaxes.html#space-character\n\tvar REGEX_SPACE_CHARACTERS = /[\\t\\n\\f\\r ]/g;\n\n\t// `decode` is designed to be fully compatible with `atob` as described in the\n\t// HTML Standard. http://whatwg.org/html/webappapis.html#dom-windowbase64-atob\n\t// The optimized base64-decoding algorithm used is based on @atk’s excellent\n\t// implementation. https://gist.github.com/atk/1020396\n\tvar decode = function(input) {\n\t\tinput = String(input)\n\t\t\t.replace(REGEX_SPACE_CHARACTERS, '');\n\t\tvar length = input.length;\n\t\tif (length % 4 == 0) {\n\t\t\tinput = input.replace(/==?$/, '');\n\t\t\tlength = input.length;\n\t\t}\n\t\tif (\n\t\t\tlength % 4 == 1 ||\n\t\t\t// http://whatwg.org/C#alphanumeric-ascii-characters\n\t\t\t/[^+a-zA-Z0-9/]/.test(input)\n\t\t) {\n\t\t\terror(\n\t\t\t\t'Invalid character: the string to be decoded is not correctly encoded.'\n\t\t\t);\n\t\t}\n\t\tvar bitCounter = 0;\n\t\tvar bitStorage;\n\t\tvar buffer;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\twhile (++position < length) {\n\t\t\tbuffer = TABLE.indexOf(input.charAt(position));\n\t\t\tbitStorage = bitCounter % 4 ? bitStorage * 64 + buffer : buffer;\n\t\t\t// Unless this is the first of a group of 4 characters…\n\t\t\tif (bitCounter++ % 4) {\n\t\t\t\t// …convert the first 8 bits to a single ASCII character.\n\t\t\t\toutput += String.fromCharCode(\n\t\t\t\t\t0xFF & bitStorage >> (-2 * bitCounter & 6)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t};\n\n\t// `encode` is designed to be fully compatible with `btoa` as described in the\n\t// HTML Standard: http://whatwg.org/html/webappapis.html#dom-windowbase64-btoa\n\tvar encode = function(input) {\n\t\tinput = String(input);\n\t\tif (/[^\\0-\\xFF]/.test(input)) {\n\t\t\t// Note: no need to special-case astral symbols here, as surrogates are\n\t\t\t// matched, and the input is supposed to only contain ASCII anyway.\n\t\t\terror(\n\t\t\t\t'The string to be encoded contains characters outside of the ' +\n\t\t\t\t'Latin1 range.'\n\t\t\t);\n\t\t}\n\t\tvar padding = input.length % 3;\n\t\tvar output = '';\n\t\tvar position = -1;\n\t\tvar a;\n\t\tvar b;\n\t\tvar c;\n\t\tvar buffer;\n\t\t// Make sure any padding is handled outside of the loop.\n\t\tvar length = input.length - padding;\n\n\t\twhile (++position < length) {\n\t\t\t// Read three bytes, i.e. 24 bits.\n\t\t\ta = input.charCodeAt(position) << 16;\n\t\t\tb = input.charCodeAt(++position) << 8;\n\t\t\tc = input.charCodeAt(++position);\n\t\t\tbuffer = a + b + c;\n\t\t\t// Turn the 24 bits into four chunks of 6 bits each, and append the\n\t\t\t// matching character for each of them to the output.\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 18 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 12 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer >> 6 & 0x3F) +\n\t\t\t\tTABLE.charAt(buffer & 0x3F)\n\t\t\t);\n\t\t}\n\n\t\tif (padding == 2) {\n\t\t\ta = input.charCodeAt(position) << 8;\n\t\t\tb = input.charCodeAt(++position);\n\t\t\tbuffer = a + b;\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 10) +\n\t\t\t\tTABLE.charAt((buffer >> 4) & 0x3F) +\n\t\t\t\tTABLE.charAt((buffer << 2) & 0x3F) +\n\t\t\t\t'='\n\t\t\t);\n\t\t} else if (padding == 1) {\n\t\t\tbuffer = input.charCodeAt(position);\n\t\t\toutput += (\n\t\t\t\tTABLE.charAt(buffer >> 2) +\n\t\t\t\tTABLE.charAt((buffer << 4) & 0x3F) +\n\t\t\t\t'=='\n\t\t\t);\n\t\t}\n\n\t\treturn output;\n\t};\n\n\tvar base64 = {\n\t\t'encode': encode,\n\t\t'decode': decode,\n\t\t'version': '1.0.0'\n\t};\n\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine(function() {\n\t\t\treturn base64;\n\t\t});\n\t}\telse if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = base64;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (var key in base64) {\n\t\t\t\tbase64.hasOwnProperty(key) && (freeExports[key] = base64[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.base64 = base64;\n\t}\n\n}(this));\n","/**\n * BottleJS v2.0.1 - 2022-06-28\n * A powerful dependency injection micro container\n *\n * Copyright (c) 2022 Stephen Young\n * Licensed MIT\n */\nvar Bottle;\n\n/**\n * String constants\n */\nvar DELIMITER = '.';\nvar FUNCTION_TYPE = 'function';\nvar STRING_TYPE = 'string';\nvar GLOBAL_NAME = '__global__';\nvar PROVIDER_SUFFIX = 'Provider';\n\n/**\n * Unique id counter;\n *\n * @type Number\n */\nvar id = 0;\n\n/**\n * Local slice alias\n *\n * @type Functions\n */\nvar slice = Array.prototype.slice;\n\n/**\n * Iterator used to walk down a nested object.\n *\n * If Bottle.config.strict is true, this method will throw an exception if it encounters an\n * undefined path\n *\n * @param Object obj\n * @param String prop\n * @return mixed\n * @throws Error if Bottle is unable to resolve the requested service.\n */\nvar getNested = function getNested(obj, prop) {\n    var service = obj[prop];\n    if (service === undefined && Bottle.config.strict) {\n        throw new Error('Bottle was unable to resolve a service.  `' + prop + '` is undefined.');\n    }\n    return service;\n};\n\n/**\n * Get a nested bottle. Will set and return if not set.\n *\n * @param String name\n * @return Bottle\n */\nvar getNestedBottle = function getNestedBottle(name) {\n    var bottle;\n    if (!this.nested[name]) {\n        bottle = Bottle.pop();\n        this.nested[name] = bottle;\n        this.factory(name, function SubProviderFactory() {\n            return bottle.container;\n        });\n    }\n    return this.nested[name];\n};\n\n/**\n * Get a service stored under a nested key\n *\n * @param String fullname\n * @return Service\n */\nvar getNestedService = function getNestedService(fullname) {\n    return fullname.split(DELIMITER).reduce(getNested, this);\n};\n\n/**\n * Function used by provider to set up middleware for each request.\n *\n * @param Number id\n * @param String name\n * @param Object instance\n * @param Object container\n * @return void\n */\nvar applyMiddleware = function applyMiddleware(middleware, name, instance, container) {\n    var descriptor = {\n        configurable : true,\n        enumerable : true\n    };\n    if (middleware.length) {\n        descriptor.get = function getWithMiddlewear() {\n            var index = 0;\n            var next = function nextMiddleware(err) {\n                if (err) {\n                    throw err;\n                }\n                if (middleware[index]) {\n                    middleware[index++](instance, next);\n                }\n            };\n            next();\n            return instance;\n        };\n    } else {\n        descriptor.value = instance;\n        descriptor.writable = true;\n    }\n\n    Object.defineProperty(container, name, descriptor);\n\n    return container[name];\n};\n\n/**\n * Register middleware.\n *\n * @param String name\n * @param Function func\n * @return Bottle\n */\nvar middleware = function middleware(fullname, func) {\n    var parts, name;\n    if (typeof fullname === FUNCTION_TYPE) {\n        func = fullname;\n        fullname = GLOBAL_NAME;\n    }\n\n    parts = fullname.split(DELIMITER);\n    name = parts.shift();\n    if (parts.length) {\n        getNestedBottle.call(this, name).middleware(parts.join(DELIMITER), func);\n    } else {\n        if (!this.middlewares[name]) {\n            this.middlewares[name] = [];\n        }\n        this.middlewares[name].push(func);\n    }\n    return this;\n};\n\n/**\n * Used to process decorators in the provider\n *\n * @param Object instance\n * @param Function func\n * @return Mixed\n */\nvar reducer = function reducer(instance, func) {\n    return func(instance);\n};\n\n\n/**\n * Get decorators and middleware including globals\n *\n * @return array\n */\nvar getWithGlobal = function getWithGlobal(collection, name) {\n    return (collection[name] || []).concat(collection.__global__ || []);\n};\n\n\n/**\n * Create the provider properties on the container\n *\n * @param String name\n * @param Function Provider\n * @return Bottle\n */\nvar createProvider = function createProvider(name, Provider) {\n    var providerName, properties, container, id, decorators, middlewares;\n\n    id = this.id;\n    container = this.container;\n    decorators = this.decorators;\n    middlewares = this.middlewares;\n    providerName = name + PROVIDER_SUFFIX;\n\n    properties = Object.create(null);\n    properties[providerName] = {\n        configurable : true,\n        enumerable : true,\n        get : function getProvider() {\n            var instance = new Provider();\n            delete container[providerName];\n            container[providerName] = instance;\n            return instance;\n        }\n    };\n\n    properties[name] = {\n        configurable : true,\n        enumerable : true,\n        get : function getService() {\n            var provider = container[providerName];\n            var instance;\n            if (provider) {\n                // filter through decorators\n                instance = getWithGlobal(decorators, name).reduce(reducer, provider.$get(container));\n\n                delete container[providerName];\n                delete container[name];\n            }\n            return instance === undefined ? instance : applyMiddleware(getWithGlobal(middlewares, name),\n                name, instance, container);\n        }\n    };\n\n    Object.defineProperties(container, properties);\n    return this;\n};\n\n\n/**\n * Register a provider.\n *\n * @param String fullname\n * @param Function Provider\n * @return Bottle\n */\nvar provider = function provider(fullname, Provider) {\n    var parts, name;\n    parts = fullname.split(DELIMITER);\n    if (this.providerMap[fullname] && parts.length === 1 && !this.container[fullname + PROVIDER_SUFFIX]) {\n        return console.error(fullname + ' provider already instantiated.');\n    }\n    this.originalProviders[fullname] = Provider;\n    this.providerMap[fullname] = true;\n\n    name = parts.shift();\n\n    if (parts.length) {\n        getNestedBottle.call(this, name).provider(parts.join(DELIMITER), Provider);\n        return this;\n    }\n    return createProvider.call(this, name, Provider);\n};\n\n/**\n * Register a factory inside a generic provider.\n *\n * @param String name\n * @param Function Factory\n * @return Bottle\n */\nvar factory = function factory(name, Factory) {\n    return provider.call(this, name, function GenericProvider() {\n        this.$get = Factory;\n    });\n};\n\n/**\n * Private helper for creating service and service factories.\n *\n * @param String name\n * @param Function Service\n * @return Bottle\n */\nvar createService = function createService(name, Service, isClass) {\n    var deps = arguments.length > 3 ? slice.call(arguments, 3) : [];\n    var bottle = this;\n    return factory.call(this, name, function GenericFactory() {\n        var serviceFactory = Service; // alias for jshint\n        var args = deps.map(getNestedService, bottle.container);\n\n        if (!isClass) {\n            return serviceFactory.apply(null, args);\n        }\n        return new (Service.bind.apply(Service, [null].concat(args)))();\n    });\n};\n\n/**\n * Register a class service\n *\n * @param String name\n * @param Function Service\n * @return Bottle\n */\nvar service = function service(name, Service) {\n    return createService.apply(this, [name, Service, true].concat(slice.call(arguments, 2)));\n};\n\n/**\n * Register a function service\n */\nvar serviceFactory = function serviceFactory(name, factoryService) {\n    return createService.apply(this, [name, factoryService, false].concat(slice.call(arguments, 2)));\n};\n\n/**\n * Define a mutable property on the container.\n *\n * @param String name\n * @param mixed val\n * @return void\n * @scope container\n */\nvar defineValue = function defineValue(name, val) {\n    Object.defineProperty(this, name, {\n        configurable : true,\n        enumerable : true,\n        value : val,\n        writable : true\n    });\n};\n\n/**\n * Iterator for setting a plain object literal via defineValue\n *\n * @param Object container\n * @param string name\n */\nvar setValueObject = function setValueObject(container, name) {\n    var nestedContainer = container[name];\n    if (!nestedContainer) {\n        nestedContainer = {};\n        defineValue.call(container, name, nestedContainer);\n    }\n    return nestedContainer;\n};\n\n\n/**\n * Register a value\n *\n * @param String name\n * @param mixed val\n * @return Bottle\n */\nvar value = function value(name, val) {\n    var parts;\n    parts = name.split(DELIMITER);\n    name = parts.pop();\n    defineValue.call(parts.reduce(setValueObject, this.container), name, val);\n    return this;\n};\n\n/**\n * Define an enumerable, non-configurable, non-writable value.\n *\n * @param String name\n * @param mixed value\n * @return undefined\n */\nvar defineConstant = function defineConstant(name, value) {\n    Object.defineProperty(this, name, {\n        configurable : false,\n        enumerable : true,\n        value : value,\n        writable : false\n    });\n};\n\n/**\n * Register a constant\n *\n * @param String name\n * @param mixed value\n * @return Bottle\n */\nvar constant = function constant(name, value) {\n    var parts = name.split(DELIMITER);\n    name = parts.pop();\n    defineConstant.call(parts.reduce(setValueObject, this.container), name, value);\n    return this;\n};\n\n/**\n * Register decorator.\n *\n * @param String fullname\n * @param Function func\n * @return Bottle\n */\nvar decorator = function decorator(fullname, func) {\n    var parts, name;\n    if (typeof fullname === FUNCTION_TYPE) {\n        func = fullname;\n        fullname = GLOBAL_NAME;\n    }\n\n    parts = fullname.split(DELIMITER);\n    name = parts.shift();\n    if (parts.length) {\n        getNestedBottle.call(this, name).decorator(parts.join(DELIMITER), func);\n    } else {\n        if (!this.decorators[name]) {\n            this.decorators[name] = [];\n        }\n        this.decorators[name].push(func);\n    }\n    return this;\n};\n\n/**\n * Register a function that will be executed when Bottle#resolve is called.\n *\n * @param Function func\n * @return Bottle\n */\nvar defer = function defer(func) {\n    this.deferred.push(func);\n    return this;\n};\n\n\n/**\n * Immediately instantiates the provided list of services and returns them.\n *\n * @param Array services\n * @return Array Array of instances (in the order they were provided)\n */\nvar digest = function digest(services) {\n    return (services || []).map(getNestedService, this.container);\n};\n\n/**\n * Register an instance factory inside a generic factory.\n *\n * @param {String} name - The name of the service\n * @param {Function} Factory - The factory function, matches the signature required for the\n * `factory` method\n * @return Bottle\n */\nvar instanceFactory = function instanceFactory(name, Factory) {\n    return factory.call(this, name, function GenericInstanceFactory(container) {\n        return {\n            instance : Factory.bind(Factory, container)\n        };\n    });\n};\n\n/**\n * A filter function for removing bottle container methods and providers from a list of keys\n */\nvar byMethod = function byMethod(name) {\n    return !/^\\$(?:decorator|register|list)$|Provider$/.test(name);\n};\n\n/**\n * List the services registered on the container.\n *\n * @param Object container\n * @return Array\n */\nvar list = function list(container) {\n    return Object.keys(container || this.container || {}).filter(byMethod);\n};\n\n/**\n * Named bottle instances\n *\n * @type Object\n */\nvar bottles = {};\n\n/**\n * Get an instance of bottle.\n *\n * If a name is provided the instance will be stored in a local hash.  Calling Bottle.pop multiple\n * times with the same name will return the same instance.\n *\n * @param String name\n * @return Bottle\n */\nvar pop = function pop(name) {\n    var instance;\n    if (typeof name === STRING_TYPE) {\n        instance = bottles[name];\n        if (!instance) {\n            bottles[name] = instance = new Bottle();\n            instance.constant('BOTTLE_NAME', name);\n        }\n        return instance;\n    }\n    return new Bottle();\n};\n\n/**\n * Clear all named bottles.\n */\nvar clear = function clear(name) {\n    if (typeof name === STRING_TYPE) {\n        delete bottles[name];\n    } else {\n        bottles = {};\n    }\n};\n\n/**\n * Register a service, factory, provider, or value based on properties on the object.\n *\n * properties:\n *  * Obj.$name   String required ex: `'Thing'`\n *  * Obj.$type   String optional 'service', 'factory', 'provider', 'value'.  Default: 'service'\n *  * Obj.$inject Mixed  optional only useful with $type 'service' name or array of names\n *  * Obj.$value  Mixed  optional Normally Obj is registered on the container.  However, if this\n *                       property is included, it's value will be registered on the container\n *                       instead of the object itsself.  Useful for registering objects on the\n *                       bottle container without modifying those objects with bottle specific keys.\n *\n * @param Function Obj\n * @return Bottle\n */\nvar register = function register(Obj) {\n    var value = Obj.$value === undefined ? Obj : Obj.$value;\n    return this[Obj.$type || 'service'].apply(this, [Obj.$name, value].concat(Obj.$inject || []));\n};\n\n/**\n * Deletes providers from the map and container.\n *\n * @param String name\n * @return void\n */\nvar removeProviderMap = function resetProvider(name) {\n    delete this.providerMap[name];\n    delete this.container[name];\n    delete this.container[name + PROVIDER_SUFFIX];\n};\n\n/**\n * Resets providers on a bottle instance. If 'names' array is provided, only the named providers will be reset.\n *\n * @param Array names\n * @return void\n */\nvar resetProviders = function resetProviders(names) {\n    var tempProviders = this.originalProviders;\n    var shouldFilter = Array.isArray(names);\n\n    Object.keys(this.originalProviders).forEach(function resetProvider(originalProviderName) {\n        if (shouldFilter && names.indexOf(originalProviderName) === -1) {\n            return;\n        }\n        var parts = originalProviderName.split(DELIMITER);\n        if (parts.length > 1) {\n            parts.forEach(removeProviderMap, getNestedBottle.call(this, parts[0]));\n        }\n        removeProviderMap.call(this, originalProviderName);\n        this.provider(originalProviderName, tempProviders[originalProviderName]);\n    }, this);\n};\n\n\n/**\n * Execute any deferred functions\n *\n * @param Mixed data\n * @return Bottle\n */\nvar resolve = function resolve(data) {\n    this.deferred.forEach(function deferredIterator(func) {\n        func(data);\n    });\n\n    return this;\n};\n\n\n/**\n * Bottle constructor\n *\n * @param String name Optional name for functional construction\n */\nBottle = function Bottle(name) {\n    if (!(this instanceof Bottle)) {\n        return Bottle.pop(name);\n    }\n\n    this.id = id++;\n\n    this.decorators = {};\n    this.middlewares = {};\n    this.nested = {};\n    this.providerMap = {};\n    this.originalProviders = {};\n    this.deferred = [];\n    this.container = {\n        $decorator : decorator.bind(this),\n        $register : register.bind(this),\n        $list : list.bind(this)\n    };\n};\n\n/**\n * Bottle prototype\n */\nBottle.prototype = {\n    constant : constant,\n    decorator : decorator,\n    defer : defer,\n    digest : digest,\n    factory : factory,\n    instanceFactory: instanceFactory,\n    list : list,\n    middleware : middleware,\n    provider : provider,\n    resetProviders : resetProviders,\n    register : register,\n    resolve : resolve,\n    service : service,\n    serviceFactory : serviceFactory,\n    value : value\n};\n\n/**\n * Bottle static\n */\nBottle.pop = pop;\nBottle.clear = clear;\nBottle.list = list;\n\n/**\n * Global config\n */\nBottle.config = {\n    strict : false\n};\n\nexport default Bottle","'use strict';\n\nconst wrapAnsi16 = (fn, offset) => (...args) => {\n\tconst code = fn(...args);\n\treturn `\\u001B[${code + offset}m`;\n};\n\nconst wrapAnsi256 = (fn, offset) => (...args) => {\n\tconst code = fn(...args);\n\treturn `\\u001B[${38 + offset};5;${code}m`;\n};\n\nconst wrapAnsi16m = (fn, offset) => (...args) => {\n\tconst rgb = fn(...args);\n\treturn `\\u001B[${38 + offset};2;${rgb[0]};${rgb[1]};${rgb[2]}m`;\n};\n\nconst ansi2ansi = n => n;\nconst rgb2rgb = (r, g, b) => [r, g, b];\n\nconst setLazyProperty = (object, property, get) => {\n\tObject.defineProperty(object, property, {\n\t\tget: () => {\n\t\t\tconst value = get();\n\n\t\t\tObject.defineProperty(object, property, {\n\t\t\t\tvalue,\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true\n\t\t\t});\n\n\t\t\treturn value;\n\t\t},\n\t\tenumerable: true,\n\t\tconfigurable: true\n\t});\n};\n\n/** @type {typeof import('color-convert')} */\nlet colorConvert;\nconst makeDynamicStyles = (wrap, targetSpace, identity, isBackground) => {\n\tif (colorConvert === undefined) {\n\t\tcolorConvert = require('color-convert');\n\t}\n\n\tconst offset = isBackground ? 10 : 0;\n\tconst styles = {};\n\n\tfor (const [sourceSpace, suite] of Object.entries(colorConvert)) {\n\t\tconst name = sourceSpace === 'ansi16' ? 'ansi' : sourceSpace;\n\t\tif (sourceSpace === targetSpace) {\n\t\t\tstyles[name] = wrap(identity, offset);\n\t\t} else if (typeof suite === 'object') {\n\t\t\tstyles[name] = wrap(suite[targetSpace], offset);\n\t\t}\n\t}\n\n\treturn styles;\n};\n\nfunction assembleStyles() {\n\tconst codes = new Map();\n\tconst styles = {\n\t\tmodifier: {\n\t\t\treset: [0, 0],\n\t\t\t// 21 isn't widely supported and 22 does the same thing\n\t\t\tbold: [1, 22],\n\t\t\tdim: [2, 22],\n\t\t\titalic: [3, 23],\n\t\t\tunderline: [4, 24],\n\t\t\tinverse: [7, 27],\n\t\t\thidden: [8, 28],\n\t\t\tstrikethrough: [9, 29]\n\t\t},\n\t\tcolor: {\n\t\t\tblack: [30, 39],\n\t\t\tred: [31, 39],\n\t\t\tgreen: [32, 39],\n\t\t\tyellow: [33, 39],\n\t\t\tblue: [34, 39],\n\t\t\tmagenta: [35, 39],\n\t\t\tcyan: [36, 39],\n\t\t\twhite: [37, 39],\n\n\t\t\t// Bright color\n\t\t\tblackBright: [90, 39],\n\t\t\tredBright: [91, 39],\n\t\t\tgreenBright: [92, 39],\n\t\t\tyellowBright: [93, 39],\n\t\t\tblueBright: [94, 39],\n\t\t\tmagentaBright: [95, 39],\n\t\t\tcyanBright: [96, 39],\n\t\t\twhiteBright: [97, 39]\n\t\t},\n\t\tbgColor: {\n\t\t\tbgBlack: [40, 49],\n\t\t\tbgRed: [41, 49],\n\t\t\tbgGreen: [42, 49],\n\t\t\tbgYellow: [43, 49],\n\t\t\tbgBlue: [44, 49],\n\t\t\tbgMagenta: [45, 49],\n\t\t\tbgCyan: [46, 49],\n\t\t\tbgWhite: [47, 49],\n\n\t\t\t// Bright color\n\t\t\tbgBlackBright: [100, 49],\n\t\t\tbgRedBright: [101, 49],\n\t\t\tbgGreenBright: [102, 49],\n\t\t\tbgYellowBright: [103, 49],\n\t\t\tbgBlueBright: [104, 49],\n\t\t\tbgMagentaBright: [105, 49],\n\t\t\tbgCyanBright: [106, 49],\n\t\t\tbgWhiteBright: [107, 49]\n\t\t}\n\t};\n\n\t// Alias bright black as gray (and grey)\n\tstyles.color.gray = styles.color.blackBright;\n\tstyles.bgColor.bgGray = styles.bgColor.bgBlackBright;\n\tstyles.color.grey = styles.color.blackBright;\n\tstyles.bgColor.bgGrey = styles.bgColor.bgBlackBright;\n\n\tfor (const [groupName, group] of Object.entries(styles)) {\n\t\tfor (const [styleName, style] of Object.entries(group)) {\n\t\t\tstyles[styleName] = {\n\t\t\t\topen: `\\u001B[${style[0]}m`,\n\t\t\t\tclose: `\\u001B[${style[1]}m`\n\t\t\t};\n\n\t\t\tgroup[styleName] = styles[styleName];\n\n\t\t\tcodes.set(style[0], style[1]);\n\t\t}\n\n\t\tObject.defineProperty(styles, groupName, {\n\t\t\tvalue: group,\n\t\t\tenumerable: false\n\t\t});\n\t}\n\n\tObject.defineProperty(styles, 'codes', {\n\t\tvalue: codes,\n\t\tenumerable: false\n\t});\n\n\tstyles.color.close = '\\u001B[39m';\n\tstyles.bgColor.close = '\\u001B[49m';\n\n\tsetLazyProperty(styles.color, 'ansi', () => makeDynamicStyles(wrapAnsi16, 'ansi16', ansi2ansi, false));\n\tsetLazyProperty(styles.color, 'ansi256', () => makeDynamicStyles(wrapAnsi256, 'ansi256', ansi2ansi, false));\n\tsetLazyProperty(styles.color, 'ansi16m', () => makeDynamicStyles(wrapAnsi16m, 'rgb', rgb2rgb, false));\n\tsetLazyProperty(styles.bgColor, 'ansi', () => makeDynamicStyles(wrapAnsi16, 'ansi16', ansi2ansi, true));\n\tsetLazyProperty(styles.bgColor, 'ansi256', () => makeDynamicStyles(wrapAnsi256, 'ansi256', ansi2ansi, true));\n\tsetLazyProperty(styles.bgColor, 'ansi16m', () => makeDynamicStyles(wrapAnsi16m, 'rgb', rgb2rgb, true));\n\n\treturn styles;\n}\n\n// Make the export immutable\nObject.defineProperty(module, 'exports', {\n\tenumerable: true,\n\tget: assembleStyles\n});\n","/* MIT license */\n/* eslint-disable no-mixed-operators */\nconst cssKeywords = require('color-name');\n\n// NOTE: conversions should only return primitive values (i.e. arrays, or\n//       values that give correct `typeof` results).\n//       do not use box values types (i.e. Number(), String(), etc.)\n\nconst reverseKeywords = {};\nfor (const key of Object.keys(cssKeywords)) {\n\treverseKeywords[cssKeywords[key]] = key;\n}\n\nconst convert = {\n\trgb: {channels: 3, labels: 'rgb'},\n\thsl: {channels: 3, labels: 'hsl'},\n\thsv: {channels: 3, labels: 'hsv'},\n\thwb: {channels: 3, labels: 'hwb'},\n\tcmyk: {channels: 4, labels: 'cmyk'},\n\txyz: {channels: 3, labels: 'xyz'},\n\tlab: {channels: 3, labels: 'lab'},\n\tlch: {channels: 3, labels: 'lch'},\n\thex: {channels: 1, labels: ['hex']},\n\tkeyword: {channels: 1, labels: ['keyword']},\n\tansi16: {channels: 1, labels: ['ansi16']},\n\tansi256: {channels: 1, labels: ['ansi256']},\n\thcg: {channels: 3, labels: ['h', 'c', 'g']},\n\tapple: {channels: 3, labels: ['r16', 'g16', 'b16']},\n\tgray: {channels: 1, labels: ['gray']}\n};\n\nmodule.exports = convert;\n\n// Hide .channels and .labels properties\nfor (const model of Object.keys(convert)) {\n\tif (!('channels' in convert[model])) {\n\t\tthrow new Error('missing channels property: ' + model);\n\t}\n\n\tif (!('labels' in convert[model])) {\n\t\tthrow new Error('missing channel labels property: ' + model);\n\t}\n\n\tif (convert[model].labels.length !== convert[model].channels) {\n\t\tthrow new Error('channel and label counts mismatch: ' + model);\n\t}\n\n\tconst {channels, labels} = convert[model];\n\tdelete convert[model].channels;\n\tdelete convert[model].labels;\n\tObject.defineProperty(convert[model], 'channels', {value: channels});\n\tObject.defineProperty(convert[model], 'labels', {value: labels});\n}\n\nconvert.rgb.hsl = function (rgb) {\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\tconst min = Math.min(r, g, b);\n\tconst max = Math.max(r, g, b);\n\tconst delta = max - min;\n\tlet h;\n\tlet s;\n\n\tif (max === min) {\n\t\th = 0;\n\t} else if (r === max) {\n\t\th = (g - b) / delta;\n\t} else if (g === max) {\n\t\th = 2 + (b - r) / delta;\n\t} else if (b === max) {\n\t\th = 4 + (r - g) / delta;\n\t}\n\n\th = Math.min(h * 60, 360);\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tconst l = (min + max) / 2;\n\n\tif (max === min) {\n\t\ts = 0;\n\t} else if (l <= 0.5) {\n\t\ts = delta / (max + min);\n\t} else {\n\t\ts = delta / (2 - max - min);\n\t}\n\n\treturn [h, s * 100, l * 100];\n};\n\nconvert.rgb.hsv = function (rgb) {\n\tlet rdif;\n\tlet gdif;\n\tlet bdif;\n\tlet h;\n\tlet s;\n\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\tconst v = Math.max(r, g, b);\n\tconst diff = v - Math.min(r, g, b);\n\tconst diffc = function (c) {\n\t\treturn (v - c) / 6 / diff + 1 / 2;\n\t};\n\n\tif (diff === 0) {\n\t\th = 0;\n\t\ts = 0;\n\t} else {\n\t\ts = diff / v;\n\t\trdif = diffc(r);\n\t\tgdif = diffc(g);\n\t\tbdif = diffc(b);\n\n\t\tif (r === v) {\n\t\t\th = bdif - gdif;\n\t\t} else if (g === v) {\n\t\t\th = (1 / 3) + rdif - bdif;\n\t\t} else if (b === v) {\n\t\t\th = (2 / 3) + gdif - rdif;\n\t\t}\n\n\t\tif (h < 0) {\n\t\t\th += 1;\n\t\t} else if (h > 1) {\n\t\t\th -= 1;\n\t\t}\n\t}\n\n\treturn [\n\t\th * 360,\n\t\ts * 100,\n\t\tv * 100\n\t];\n};\n\nconvert.rgb.hwb = function (rgb) {\n\tconst r = rgb[0];\n\tconst g = rgb[1];\n\tlet b = rgb[2];\n\tconst h = convert.rgb.hsl(rgb)[0];\n\tconst w = 1 / 255 * Math.min(r, Math.min(g, b));\n\n\tb = 1 - 1 / 255 * Math.max(r, Math.max(g, b));\n\n\treturn [h, w * 100, b * 100];\n};\n\nconvert.rgb.cmyk = function (rgb) {\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\n\tconst k = Math.min(1 - r, 1 - g, 1 - b);\n\tconst c = (1 - r - k) / (1 - k) || 0;\n\tconst m = (1 - g - k) / (1 - k) || 0;\n\tconst y = (1 - b - k) / (1 - k) || 0;\n\n\treturn [c * 100, m * 100, y * 100, k * 100];\n};\n\nfunction comparativeDistance(x, y) {\n\t/*\n\t\tSee https://en.m.wikipedia.org/wiki/Euclidean_distance#Squared_Euclidean_distance\n\t*/\n\treturn (\n\t\t((x[0] - y[0]) ** 2) +\n\t\t((x[1] - y[1]) ** 2) +\n\t\t((x[2] - y[2]) ** 2)\n\t);\n}\n\nconvert.rgb.keyword = function (rgb) {\n\tconst reversed = reverseKeywords[rgb];\n\tif (reversed) {\n\t\treturn reversed;\n\t}\n\n\tlet currentClosestDistance = Infinity;\n\tlet currentClosestKeyword;\n\n\tfor (const keyword of Object.keys(cssKeywords)) {\n\t\tconst value = cssKeywords[keyword];\n\n\t\t// Compute comparative distance\n\t\tconst distance = comparativeDistance(rgb, value);\n\n\t\t// Check if its less, if so set as closest\n\t\tif (distance < currentClosestDistance) {\n\t\t\tcurrentClosestDistance = distance;\n\t\t\tcurrentClosestKeyword = keyword;\n\t\t}\n\t}\n\n\treturn currentClosestKeyword;\n};\n\nconvert.keyword.rgb = function (keyword) {\n\treturn cssKeywords[keyword];\n};\n\nconvert.rgb.xyz = function (rgb) {\n\tlet r = rgb[0] / 255;\n\tlet g = rgb[1] / 255;\n\tlet b = rgb[2] / 255;\n\n\t// Assume sRGB\n\tr = r > 0.04045 ? (((r + 0.055) / 1.055) ** 2.4) : (r / 12.92);\n\tg = g > 0.04045 ? (((g + 0.055) / 1.055) ** 2.4) : (g / 12.92);\n\tb = b > 0.04045 ? (((b + 0.055) / 1.055) ** 2.4) : (b / 12.92);\n\n\tconst x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n\tconst y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n\tconst z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n\n\treturn [x * 100, y * 100, z * 100];\n};\n\nconvert.rgb.lab = function (rgb) {\n\tconst xyz = convert.rgb.xyz(rgb);\n\tlet x = xyz[0];\n\tlet y = xyz[1];\n\tlet z = xyz[2];\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? (x ** (1 / 3)) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? (y ** (1 / 3)) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? (z ** (1 / 3)) : (7.787 * z) + (16 / 116);\n\n\tconst l = (116 * y) - 16;\n\tconst a = 500 * (x - y);\n\tconst b = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.hsl.rgb = function (hsl) {\n\tconst h = hsl[0] / 360;\n\tconst s = hsl[1] / 100;\n\tconst l = hsl[2] / 100;\n\tlet t2;\n\tlet t3;\n\tlet val;\n\n\tif (s === 0) {\n\t\tval = l * 255;\n\t\treturn [val, val, val];\n\t}\n\n\tif (l < 0.5) {\n\t\tt2 = l * (1 + s);\n\t} else {\n\t\tt2 = l + s - l * s;\n\t}\n\n\tconst t1 = 2 * l - t2;\n\n\tconst rgb = [0, 0, 0];\n\tfor (let i = 0; i < 3; i++) {\n\t\tt3 = h + 1 / 3 * -(i - 1);\n\t\tif (t3 < 0) {\n\t\t\tt3++;\n\t\t}\n\n\t\tif (t3 > 1) {\n\t\t\tt3--;\n\t\t}\n\n\t\tif (6 * t3 < 1) {\n\t\t\tval = t1 + (t2 - t1) * 6 * t3;\n\t\t} else if (2 * t3 < 1) {\n\t\t\tval = t2;\n\t\t} else if (3 * t3 < 2) {\n\t\t\tval = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n\t\t} else {\n\t\t\tval = t1;\n\t\t}\n\n\t\trgb[i] = val * 255;\n\t}\n\n\treturn rgb;\n};\n\nconvert.hsl.hsv = function (hsl) {\n\tconst h = hsl[0];\n\tlet s = hsl[1] / 100;\n\tlet l = hsl[2] / 100;\n\tlet smin = s;\n\tconst lmin = Math.max(l, 0.01);\n\n\tl *= 2;\n\ts *= (l <= 1) ? l : 2 - l;\n\tsmin *= lmin <= 1 ? lmin : 2 - lmin;\n\tconst v = (l + s) / 2;\n\tconst sv = l === 0 ? (2 * smin) / (lmin + smin) : (2 * s) / (l + s);\n\n\treturn [h, sv * 100, v * 100];\n};\n\nconvert.hsv.rgb = function (hsv) {\n\tconst h = hsv[0] / 60;\n\tconst s = hsv[1] / 100;\n\tlet v = hsv[2] / 100;\n\tconst hi = Math.floor(h) % 6;\n\n\tconst f = h - Math.floor(h);\n\tconst p = 255 * v * (1 - s);\n\tconst q = 255 * v * (1 - (s * f));\n\tconst t = 255 * v * (1 - (s * (1 - f)));\n\tv *= 255;\n\n\tswitch (hi) {\n\t\tcase 0:\n\t\t\treturn [v, t, p];\n\t\tcase 1:\n\t\t\treturn [q, v, p];\n\t\tcase 2:\n\t\t\treturn [p, v, t];\n\t\tcase 3:\n\t\t\treturn [p, q, v];\n\t\tcase 4:\n\t\t\treturn [t, p, v];\n\t\tcase 5:\n\t\t\treturn [v, p, q];\n\t}\n};\n\nconvert.hsv.hsl = function (hsv) {\n\tconst h = hsv[0];\n\tconst s = hsv[1] / 100;\n\tconst v = hsv[2] / 100;\n\tconst vmin = Math.max(v, 0.01);\n\tlet sl;\n\tlet l;\n\n\tl = (2 - s) * v;\n\tconst lmin = (2 - s) * vmin;\n\tsl = s * vmin;\n\tsl /= (lmin <= 1) ? lmin : 2 - lmin;\n\tsl = sl || 0;\n\tl /= 2;\n\n\treturn [h, sl * 100, l * 100];\n};\n\n// http://dev.w3.org/csswg/css-color/#hwb-to-rgb\nconvert.hwb.rgb = function (hwb) {\n\tconst h = hwb[0] / 360;\n\tlet wh = hwb[1] / 100;\n\tlet bl = hwb[2] / 100;\n\tconst ratio = wh + bl;\n\tlet f;\n\n\t// Wh + bl cant be > 1\n\tif (ratio > 1) {\n\t\twh /= ratio;\n\t\tbl /= ratio;\n\t}\n\n\tconst i = Math.floor(6 * h);\n\tconst v = 1 - bl;\n\tf = 6 * h - i;\n\n\tif ((i & 0x01) !== 0) {\n\t\tf = 1 - f;\n\t}\n\n\tconst n = wh + f * (v - wh); // Linear interpolation\n\n\tlet r;\n\tlet g;\n\tlet b;\n\t/* eslint-disable max-statements-per-line,no-multi-spaces */\n\tswitch (i) {\n\t\tdefault:\n\t\tcase 6:\n\t\tcase 0: r = v;  g = n;  b = wh; break;\n\t\tcase 1: r = n;  g = v;  b = wh; break;\n\t\tcase 2: r = wh; g = v;  b = n; break;\n\t\tcase 3: r = wh; g = n;  b = v; break;\n\t\tcase 4: r = n;  g = wh; b = v; break;\n\t\tcase 5: r = v;  g = wh; b = n; break;\n\t}\n\t/* eslint-enable max-statements-per-line,no-multi-spaces */\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.cmyk.rgb = function (cmyk) {\n\tconst c = cmyk[0] / 100;\n\tconst m = cmyk[1] / 100;\n\tconst y = cmyk[2] / 100;\n\tconst k = cmyk[3] / 100;\n\n\tconst r = 1 - Math.min(1, c * (1 - k) + k);\n\tconst g = 1 - Math.min(1, m * (1 - k) + k);\n\tconst b = 1 - Math.min(1, y * (1 - k) + k);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.rgb = function (xyz) {\n\tconst x = xyz[0] / 100;\n\tconst y = xyz[1] / 100;\n\tconst z = xyz[2] / 100;\n\tlet r;\n\tlet g;\n\tlet b;\n\n\tr = (x * 3.2406) + (y * -1.5372) + (z * -0.4986);\n\tg = (x * -0.9689) + (y * 1.8758) + (z * 0.0415);\n\tb = (x * 0.0557) + (y * -0.2040) + (z * 1.0570);\n\n\t// Assume sRGB\n\tr = r > 0.0031308\n\t\t? ((1.055 * (r ** (1.0 / 2.4))) - 0.055)\n\t\t: r * 12.92;\n\n\tg = g > 0.0031308\n\t\t? ((1.055 * (g ** (1.0 / 2.4))) - 0.055)\n\t\t: g * 12.92;\n\n\tb = b > 0.0031308\n\t\t? ((1.055 * (b ** (1.0 / 2.4))) - 0.055)\n\t\t: b * 12.92;\n\n\tr = Math.min(Math.max(0, r), 1);\n\tg = Math.min(Math.max(0, g), 1);\n\tb = Math.min(Math.max(0, b), 1);\n\n\treturn [r * 255, g * 255, b * 255];\n};\n\nconvert.xyz.lab = function (xyz) {\n\tlet x = xyz[0];\n\tlet y = xyz[1];\n\tlet z = xyz[2];\n\n\tx /= 95.047;\n\ty /= 100;\n\tz /= 108.883;\n\n\tx = x > 0.008856 ? (x ** (1 / 3)) : (7.787 * x) + (16 / 116);\n\ty = y > 0.008856 ? (y ** (1 / 3)) : (7.787 * y) + (16 / 116);\n\tz = z > 0.008856 ? (z ** (1 / 3)) : (7.787 * z) + (16 / 116);\n\n\tconst l = (116 * y) - 16;\n\tconst a = 500 * (x - y);\n\tconst b = 200 * (y - z);\n\n\treturn [l, a, b];\n};\n\nconvert.lab.xyz = function (lab) {\n\tconst l = lab[0];\n\tconst a = lab[1];\n\tconst b = lab[2];\n\tlet x;\n\tlet y;\n\tlet z;\n\n\ty = (l + 16) / 116;\n\tx = a / 500 + y;\n\tz = y - b / 200;\n\n\tconst y2 = y ** 3;\n\tconst x2 = x ** 3;\n\tconst z2 = z ** 3;\n\ty = y2 > 0.008856 ? y2 : (y - 16 / 116) / 7.787;\n\tx = x2 > 0.008856 ? x2 : (x - 16 / 116) / 7.787;\n\tz = z2 > 0.008856 ? z2 : (z - 16 / 116) / 7.787;\n\n\tx *= 95.047;\n\ty *= 100;\n\tz *= 108.883;\n\n\treturn [x, y, z];\n};\n\nconvert.lab.lch = function (lab) {\n\tconst l = lab[0];\n\tconst a = lab[1];\n\tconst b = lab[2];\n\tlet h;\n\n\tconst hr = Math.atan2(b, a);\n\th = hr * 360 / 2 / Math.PI;\n\n\tif (h < 0) {\n\t\th += 360;\n\t}\n\n\tconst c = Math.sqrt(a * a + b * b);\n\n\treturn [l, c, h];\n};\n\nconvert.lch.lab = function (lch) {\n\tconst l = lch[0];\n\tconst c = lch[1];\n\tconst h = lch[2];\n\n\tconst hr = h / 360 * 2 * Math.PI;\n\tconst a = c * Math.cos(hr);\n\tconst b = c * Math.sin(hr);\n\n\treturn [l, a, b];\n};\n\nconvert.rgb.ansi16 = function (args, saturation = null) {\n\tconst [r, g, b] = args;\n\tlet value = saturation === null ? convert.rgb.hsv(args)[2] : saturation; // Hsv -> ansi16 optimization\n\n\tvalue = Math.round(value / 50);\n\n\tif (value === 0) {\n\t\treturn 30;\n\t}\n\n\tlet ansi = 30\n\t\t+ ((Math.round(b / 255) << 2)\n\t\t| (Math.round(g / 255) << 1)\n\t\t| Math.round(r / 255));\n\n\tif (value === 2) {\n\t\tansi += 60;\n\t}\n\n\treturn ansi;\n};\n\nconvert.hsv.ansi16 = function (args) {\n\t// Optimization here; we already know the value and don't need to get\n\t// it converted for us.\n\treturn convert.rgb.ansi16(convert.hsv.rgb(args), args[2]);\n};\n\nconvert.rgb.ansi256 = function (args) {\n\tconst r = args[0];\n\tconst g = args[1];\n\tconst b = args[2];\n\n\t// We use the extended greyscale palette here, with the exception of\n\t// black and white. normal palette only has 4 greyscale shades.\n\tif (r === g && g === b) {\n\t\tif (r < 8) {\n\t\t\treturn 16;\n\t\t}\n\n\t\tif (r > 248) {\n\t\t\treturn 231;\n\t\t}\n\n\t\treturn Math.round(((r - 8) / 247) * 24) + 232;\n\t}\n\n\tconst ansi = 16\n\t\t+ (36 * Math.round(r / 255 * 5))\n\t\t+ (6 * Math.round(g / 255 * 5))\n\t\t+ Math.round(b / 255 * 5);\n\n\treturn ansi;\n};\n\nconvert.ansi16.rgb = function (args) {\n\tlet color = args % 10;\n\n\t// Handle greyscale\n\tif (color === 0 || color === 7) {\n\t\tif (args > 50) {\n\t\t\tcolor += 3.5;\n\t\t}\n\n\t\tcolor = color / 10.5 * 255;\n\n\t\treturn [color, color, color];\n\t}\n\n\tconst mult = (~~(args > 50) + 1) * 0.5;\n\tconst r = ((color & 1) * mult) * 255;\n\tconst g = (((color >> 1) & 1) * mult) * 255;\n\tconst b = (((color >> 2) & 1) * mult) * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.ansi256.rgb = function (args) {\n\t// Handle greyscale\n\tif (args >= 232) {\n\t\tconst c = (args - 232) * 10 + 8;\n\t\treturn [c, c, c];\n\t}\n\n\targs -= 16;\n\n\tlet rem;\n\tconst r = Math.floor(args / 36) / 5 * 255;\n\tconst g = Math.floor((rem = args % 36) / 6) / 5 * 255;\n\tconst b = (rem % 6) / 5 * 255;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hex = function (args) {\n\tconst integer = ((Math.round(args[0]) & 0xFF) << 16)\n\t\t+ ((Math.round(args[1]) & 0xFF) << 8)\n\t\t+ (Math.round(args[2]) & 0xFF);\n\n\tconst string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.hex.rgb = function (args) {\n\tconst match = args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);\n\tif (!match) {\n\t\treturn [0, 0, 0];\n\t}\n\n\tlet colorString = match[0];\n\n\tif (match[0].length === 3) {\n\t\tcolorString = colorString.split('').map(char => {\n\t\t\treturn char + char;\n\t\t}).join('');\n\t}\n\n\tconst integer = parseInt(colorString, 16);\n\tconst r = (integer >> 16) & 0xFF;\n\tconst g = (integer >> 8) & 0xFF;\n\tconst b = integer & 0xFF;\n\n\treturn [r, g, b];\n};\n\nconvert.rgb.hcg = function (rgb) {\n\tconst r = rgb[0] / 255;\n\tconst g = rgb[1] / 255;\n\tconst b = rgb[2] / 255;\n\tconst max = Math.max(Math.max(r, g), b);\n\tconst min = Math.min(Math.min(r, g), b);\n\tconst chroma = (max - min);\n\tlet grayscale;\n\tlet hue;\n\n\tif (chroma < 1) {\n\t\tgrayscale = min / (1 - chroma);\n\t} else {\n\t\tgrayscale = 0;\n\t}\n\n\tif (chroma <= 0) {\n\t\thue = 0;\n\t} else\n\tif (max === r) {\n\t\thue = ((g - b) / chroma) % 6;\n\t} else\n\tif (max === g) {\n\t\thue = 2 + (b - r) / chroma;\n\t} else {\n\t\thue = 4 + (r - g) / chroma;\n\t}\n\n\thue /= 6;\n\thue %= 1;\n\n\treturn [hue * 360, chroma * 100, grayscale * 100];\n};\n\nconvert.hsl.hcg = function (hsl) {\n\tconst s = hsl[1] / 100;\n\tconst l = hsl[2] / 100;\n\n\tconst c = l < 0.5 ? (2.0 * s * l) : (2.0 * s * (1.0 - l));\n\n\tlet f = 0;\n\tif (c < 1.0) {\n\t\tf = (l - 0.5 * c) / (1.0 - c);\n\t}\n\n\treturn [hsl[0], c * 100, f * 100];\n};\n\nconvert.hsv.hcg = function (hsv) {\n\tconst s = hsv[1] / 100;\n\tconst v = hsv[2] / 100;\n\n\tconst c = s * v;\n\tlet f = 0;\n\n\tif (c < 1.0) {\n\t\tf = (v - c) / (1 - c);\n\t}\n\n\treturn [hsv[0], c * 100, f * 100];\n};\n\nconvert.hcg.rgb = function (hcg) {\n\tconst h = hcg[0] / 360;\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\n\tif (c === 0.0) {\n\t\treturn [g * 255, g * 255, g * 255];\n\t}\n\n\tconst pure = [0, 0, 0];\n\tconst hi = (h % 1) * 6;\n\tconst v = hi % 1;\n\tconst w = 1 - v;\n\tlet mg = 0;\n\n\t/* eslint-disable max-statements-per-line */\n\tswitch (Math.floor(hi)) {\n\t\tcase 0:\n\t\t\tpure[0] = 1; pure[1] = v; pure[2] = 0; break;\n\t\tcase 1:\n\t\t\tpure[0] = w; pure[1] = 1; pure[2] = 0; break;\n\t\tcase 2:\n\t\t\tpure[0] = 0; pure[1] = 1; pure[2] = v; break;\n\t\tcase 3:\n\t\t\tpure[0] = 0; pure[1] = w; pure[2] = 1; break;\n\t\tcase 4:\n\t\t\tpure[0] = v; pure[1] = 0; pure[2] = 1; break;\n\t\tdefault:\n\t\t\tpure[0] = 1; pure[1] = 0; pure[2] = w;\n\t}\n\t/* eslint-enable max-statements-per-line */\n\n\tmg = (1.0 - c) * g;\n\n\treturn [\n\t\t(c * pure[0] + mg) * 255,\n\t\t(c * pure[1] + mg) * 255,\n\t\t(c * pure[2] + mg) * 255\n\t];\n};\n\nconvert.hcg.hsv = function (hcg) {\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\n\tconst v = c + g * (1.0 - c);\n\tlet f = 0;\n\n\tif (v > 0.0) {\n\t\tf = c / v;\n\t}\n\n\treturn [hcg[0], f * 100, v * 100];\n};\n\nconvert.hcg.hsl = function (hcg) {\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\n\tconst l = g * (1.0 - c) + 0.5 * c;\n\tlet s = 0;\n\n\tif (l > 0.0 && l < 0.5) {\n\t\ts = c / (2 * l);\n\t} else\n\tif (l >= 0.5 && l < 1.0) {\n\t\ts = c / (2 * (1 - l));\n\t}\n\n\treturn [hcg[0], s * 100, l * 100];\n};\n\nconvert.hcg.hwb = function (hcg) {\n\tconst c = hcg[1] / 100;\n\tconst g = hcg[2] / 100;\n\tconst v = c + g * (1.0 - c);\n\treturn [hcg[0], (v - c) * 100, (1 - v) * 100];\n};\n\nconvert.hwb.hcg = function (hwb) {\n\tconst w = hwb[1] / 100;\n\tconst b = hwb[2] / 100;\n\tconst v = 1 - b;\n\tconst c = v - w;\n\tlet g = 0;\n\n\tif (c < 1) {\n\t\tg = (v - c) / (1 - c);\n\t}\n\n\treturn [hwb[0], c * 100, g * 100];\n};\n\nconvert.apple.rgb = function (apple) {\n\treturn [(apple[0] / 65535) * 255, (apple[1] / 65535) * 255, (apple[2] / 65535) * 255];\n};\n\nconvert.rgb.apple = function (rgb) {\n\treturn [(rgb[0] / 255) * 65535, (rgb[1] / 255) * 65535, (rgb[2] / 255) * 65535];\n};\n\nconvert.gray.rgb = function (args) {\n\treturn [args[0] / 100 * 255, args[0] / 100 * 255, args[0] / 100 * 255];\n};\n\nconvert.gray.hsl = function (args) {\n\treturn [0, 0, args[0]];\n};\n\nconvert.gray.hsv = convert.gray.hsl;\n\nconvert.gray.hwb = function (gray) {\n\treturn [0, 100, gray[0]];\n};\n\nconvert.gray.cmyk = function (gray) {\n\treturn [0, 0, 0, gray[0]];\n};\n\nconvert.gray.lab = function (gray) {\n\treturn [gray[0], 0, 0];\n};\n\nconvert.gray.hex = function (gray) {\n\tconst val = Math.round(gray[0] / 100 * 255) & 0xFF;\n\tconst integer = (val << 16) + (val << 8) + val;\n\n\tconst string = integer.toString(16).toUpperCase();\n\treturn '000000'.substring(string.length) + string;\n};\n\nconvert.rgb.gray = function (rgb) {\n\tconst val = (rgb[0] + rgb[1] + rgb[2]) / 3;\n\treturn [val / 255 * 100];\n};\n","const conversions = require('./conversions');\nconst route = require('./route');\n\nconst convert = {};\n\nconst models = Object.keys(conversions);\n\nfunction wrapRaw(fn) {\n\tconst wrappedFn = function (...args) {\n\t\tconst arg0 = args[0];\n\t\tif (arg0 === undefined || arg0 === null) {\n\t\t\treturn arg0;\n\t\t}\n\n\t\tif (arg0.length > 1) {\n\t\t\targs = arg0;\n\t\t}\n\n\t\treturn fn(args);\n\t};\n\n\t// Preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nfunction wrapRounded(fn) {\n\tconst wrappedFn = function (...args) {\n\t\tconst arg0 = args[0];\n\n\t\tif (arg0 === undefined || arg0 === null) {\n\t\t\treturn arg0;\n\t\t}\n\n\t\tif (arg0.length > 1) {\n\t\t\targs = arg0;\n\t\t}\n\n\t\tconst result = fn(args);\n\n\t\t// We're assuming the result is an array here.\n\t\t// see notice in conversions.js; don't use box types\n\t\t// in conversion functions.\n\t\tif (typeof result === 'object') {\n\t\t\tfor (let len = result.length, i = 0; i < len; i++) {\n\t\t\t\tresult[i] = Math.round(result[i]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\t// Preserve .conversion property if there is one\n\tif ('conversion' in fn) {\n\t\twrappedFn.conversion = fn.conversion;\n\t}\n\n\treturn wrappedFn;\n}\n\nmodels.forEach(fromModel => {\n\tconvert[fromModel] = {};\n\n\tObject.defineProperty(convert[fromModel], 'channels', {value: conversions[fromModel].channels});\n\tObject.defineProperty(convert[fromModel], 'labels', {value: conversions[fromModel].labels});\n\n\tconst routes = route(fromModel);\n\tconst routeModels = Object.keys(routes);\n\n\trouteModels.forEach(toModel => {\n\t\tconst fn = routes[toModel];\n\n\t\tconvert[fromModel][toModel] = wrapRounded(fn);\n\t\tconvert[fromModel][toModel].raw = wrapRaw(fn);\n\t});\n});\n\nmodule.exports = convert;\n","const conversions = require('./conversions');\n\n/*\n\tThis function routes a model to all other models.\n\n\tall functions that are routed have a property `.conversion` attached\n\tto the returned synthetic function. This property is an array\n\tof strings, each with the steps in between the 'from' and 'to'\n\tcolor models (inclusive).\n\n\tconversions that are not possible simply are not included.\n*/\n\nfunction buildGraph() {\n\tconst graph = {};\n\t// https://jsperf.com/object-keys-vs-for-in-with-closure/3\n\tconst models = Object.keys(conversions);\n\n\tfor (let len = models.length, i = 0; i < len; i++) {\n\t\tgraph[models[i]] = {\n\t\t\t// http://jsperf.com/1-vs-infinity\n\t\t\t// micro-opt, but this is simple.\n\t\t\tdistance: -1,\n\t\t\tparent: null\n\t\t};\n\t}\n\n\treturn graph;\n}\n\n// https://en.wikipedia.org/wiki/Breadth-first_search\nfunction deriveBFS(fromModel) {\n\tconst graph = buildGraph();\n\tconst queue = [fromModel]; // Unshift -> queue -> pop\n\n\tgraph[fromModel].distance = 0;\n\n\twhile (queue.length) {\n\t\tconst current = queue.pop();\n\t\tconst adjacents = Object.keys(conversions[current]);\n\n\t\tfor (let len = adjacents.length, i = 0; i < len; i++) {\n\t\t\tconst adjacent = adjacents[i];\n\t\t\tconst node = graph[adjacent];\n\n\t\t\tif (node.distance === -1) {\n\t\t\t\tnode.distance = graph[current].distance + 1;\n\t\t\t\tnode.parent = current;\n\t\t\t\tqueue.unshift(adjacent);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn graph;\n}\n\nfunction link(from, to) {\n\treturn function (args) {\n\t\treturn to(from(args));\n\t};\n}\n\nfunction wrapConversion(toModel, graph) {\n\tconst path = [graph[toModel].parent, toModel];\n\tlet fn = conversions[graph[toModel].parent][toModel];\n\n\tlet cur = graph[toModel].parent;\n\twhile (graph[cur].parent) {\n\t\tpath.unshift(graph[cur].parent);\n\t\tfn = link(conversions[graph[cur].parent][cur], fn);\n\t\tcur = graph[cur].parent;\n\t}\n\n\tfn.conversion = path;\n\treturn fn;\n}\n\nmodule.exports = function (fromModel) {\n\tconst graph = deriveBFS(fromModel);\n\tconst conversion = {};\n\n\tconst models = Object.keys(graph);\n\tfor (let len = models.length, i = 0; i < len; i++) {\n\t\tconst toModel = models[i];\n\t\tconst node = graph[toModel];\n\n\t\tif (node.parent === null) {\n\t\t\t// No possible conversion, or this node is the source model.\n\t\t\tcontinue;\n\t\t}\n\n\t\tconversion[toModel] = wrapConversion(toModel, graph);\n\t}\n\n\treturn conversion;\n};\n\n","'use strict';\nmodule.exports = {\n\tstdout: false,\n\tstderr: false\n};\n","'use strict';\nconst ansiStyles = require('ansi-styles');\nconst {stdout: stdoutColor, stderr: stderrColor} = require('supports-color');\nconst {\n\tstringReplaceAll,\n\tstringEncaseCRLFWithFirstIndex\n} = require('./util');\n\nconst {isArray} = Array;\n\n// `supportsColor.level` → `ansiStyles.color[name]` mapping\nconst levelMapping = [\n\t'ansi',\n\t'ansi',\n\t'ansi256',\n\t'ansi16m'\n];\n\nconst styles = Object.create(null);\n\nconst applyOptions = (object, options = {}) => {\n\tif (options.level && !(Number.isInteger(options.level) && options.level >= 0 && options.level <= 3)) {\n\t\tthrow new Error('The `level` option should be an integer from 0 to 3');\n\t}\n\n\t// Detect level if not set manually\n\tconst colorLevel = stdoutColor ? stdoutColor.level : 0;\n\tobject.level = options.level === undefined ? colorLevel : options.level;\n};\n\nclass ChalkClass {\n\tconstructor(options) {\n\t\t// eslint-disable-next-line no-constructor-return\n\t\treturn chalkFactory(options);\n\t}\n}\n\nconst chalkFactory = options => {\n\tconst chalk = {};\n\tapplyOptions(chalk, options);\n\n\tchalk.template = (...arguments_) => chalkTag(chalk.template, ...arguments_);\n\n\tObject.setPrototypeOf(chalk, Chalk.prototype);\n\tObject.setPrototypeOf(chalk.template, chalk);\n\n\tchalk.template.constructor = () => {\n\t\tthrow new Error('`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.');\n\t};\n\n\tchalk.template.Instance = ChalkClass;\n\n\treturn chalk.template;\n};\n\nfunction Chalk(options) {\n\treturn chalkFactory(options);\n}\n\nfor (const [styleName, style] of Object.entries(ansiStyles)) {\n\tstyles[styleName] = {\n\t\tget() {\n\t\t\tconst builder = createBuilder(this, createStyler(style.open, style.close, this._styler), this._isEmpty);\n\t\t\tObject.defineProperty(this, styleName, {value: builder});\n\t\t\treturn builder;\n\t\t}\n\t};\n}\n\nstyles.visible = {\n\tget() {\n\t\tconst builder = createBuilder(this, this._styler, true);\n\t\tObject.defineProperty(this, 'visible', {value: builder});\n\t\treturn builder;\n\t}\n};\n\nconst usedModels = ['rgb', 'hex', 'keyword', 'hsl', 'hsv', 'hwb', 'ansi', 'ansi256'];\n\nfor (const model of usedModels) {\n\tstyles[model] = {\n\t\tget() {\n\t\t\tconst {level} = this;\n\t\t\treturn function (...arguments_) {\n\t\t\t\tconst styler = createStyler(ansiStyles.color[levelMapping[level]][model](...arguments_), ansiStyles.color.close, this._styler);\n\t\t\t\treturn createBuilder(this, styler, this._isEmpty);\n\t\t\t};\n\t\t}\n\t};\n}\n\nfor (const model of usedModels) {\n\tconst bgModel = 'bg' + model[0].toUpperCase() + model.slice(1);\n\tstyles[bgModel] = {\n\t\tget() {\n\t\t\tconst {level} = this;\n\t\t\treturn function (...arguments_) {\n\t\t\t\tconst styler = createStyler(ansiStyles.bgColor[levelMapping[level]][model](...arguments_), ansiStyles.bgColor.close, this._styler);\n\t\t\t\treturn createBuilder(this, styler, this._isEmpty);\n\t\t\t};\n\t\t}\n\t};\n}\n\nconst proto = Object.defineProperties(() => {}, {\n\t...styles,\n\tlevel: {\n\t\tenumerable: true,\n\t\tget() {\n\t\t\treturn this._generator.level;\n\t\t},\n\t\tset(level) {\n\t\t\tthis._generator.level = level;\n\t\t}\n\t}\n});\n\nconst createStyler = (open, close, parent) => {\n\tlet openAll;\n\tlet closeAll;\n\tif (parent === undefined) {\n\t\topenAll = open;\n\t\tcloseAll = close;\n\t} else {\n\t\topenAll = parent.openAll + open;\n\t\tcloseAll = close + parent.closeAll;\n\t}\n\n\treturn {\n\t\topen,\n\t\tclose,\n\t\topenAll,\n\t\tcloseAll,\n\t\tparent\n\t};\n};\n\nconst createBuilder = (self, _styler, _isEmpty) => {\n\tconst builder = (...arguments_) => {\n\t\tif (isArray(arguments_[0]) && isArray(arguments_[0].raw)) {\n\t\t\t// Called as a template literal, for example: chalk.red`2 + 3 = {bold ${2+3}}`\n\t\t\treturn applyStyle(builder, chalkTag(builder, ...arguments_));\n\t\t}\n\n\t\t// Single argument is hot path, implicit coercion is faster than anything\n\t\t// eslint-disable-next-line no-implicit-coercion\n\t\treturn applyStyle(builder, (arguments_.length === 1) ? ('' + arguments_[0]) : arguments_.join(' '));\n\t};\n\n\t// We alter the prototype because we must return a function, but there is\n\t// no way to create a function with a different prototype\n\tObject.setPrototypeOf(builder, proto);\n\n\tbuilder._generator = self;\n\tbuilder._styler = _styler;\n\tbuilder._isEmpty = _isEmpty;\n\n\treturn builder;\n};\n\nconst applyStyle = (self, string) => {\n\tif (self.level <= 0 || !string) {\n\t\treturn self._isEmpty ? '' : string;\n\t}\n\n\tlet styler = self._styler;\n\n\tif (styler === undefined) {\n\t\treturn string;\n\t}\n\n\tconst {openAll, closeAll} = styler;\n\tif (string.indexOf('\\u001B') !== -1) {\n\t\twhile (styler !== undefined) {\n\t\t\t// Replace any instances already present with a re-opening code\n\t\t\t// otherwise only the part of the string until said closing code\n\t\t\t// will be colored, and the rest will simply be 'plain'.\n\t\t\tstring = stringReplaceAll(string, styler.close, styler.open);\n\n\t\t\tstyler = styler.parent;\n\t\t}\n\t}\n\n\t// We can move both next actions out of loop, because remaining actions in loop won't have\n\t// any/visible effect on parts we add here. Close the styling before a linebreak and reopen\n\t// after next line to fix a bleed issue on macOS: https://github.com/chalk/chalk/pull/92\n\tconst lfIndex = string.indexOf('\\n');\n\tif (lfIndex !== -1) {\n\t\tstring = stringEncaseCRLFWithFirstIndex(string, closeAll, openAll, lfIndex);\n\t}\n\n\treturn openAll + string + closeAll;\n};\n\nlet template;\nconst chalkTag = (chalk, ...strings) => {\n\tconst [firstString] = strings;\n\n\tif (!isArray(firstString) || !isArray(firstString.raw)) {\n\t\t// If chalk() was called by itself or with a string,\n\t\t// return the string itself as a string.\n\t\treturn strings.join(' ');\n\t}\n\n\tconst arguments_ = strings.slice(1);\n\tconst parts = [firstString.raw[0]];\n\n\tfor (let i = 1; i < firstString.length; i++) {\n\t\tparts.push(\n\t\t\tString(arguments_[i - 1]).replace(/[{}\\\\]/g, '\\\\$&'),\n\t\t\tString(firstString.raw[i])\n\t\t);\n\t}\n\n\tif (template === undefined) {\n\t\ttemplate = require('./templates');\n\t}\n\n\treturn template(chalk, parts.join(''));\n};\n\nObject.defineProperties(Chalk.prototype, styles);\n\nconst chalk = Chalk(); // eslint-disable-line new-cap\nchalk.supportsColor = stdoutColor;\nchalk.stderr = Chalk({level: stderrColor ? stderrColor.level : 0}); // eslint-disable-line new-cap\nchalk.stderr.supportsColor = stderrColor;\n\nmodule.exports = chalk;\n","'use strict';\nconst TEMPLATE_REGEX = /(?:\\\\(u(?:[a-f\\d]{4}|\\{[a-f\\d]{1,6}\\})|x[a-f\\d]{2}|.))|(?:\\{(~)?(\\w+(?:\\([^)]*\\))?(?:\\.\\w+(?:\\([^)]*\\))?)*)(?:[ \\t]|(?=\\r?\\n)))|(\\})|((?:.|[\\r\\n\\f])+?)/gi;\nconst STYLE_REGEX = /(?:^|\\.)(\\w+)(?:\\(([^)]*)\\))?/g;\nconst STRING_REGEX = /^(['\"])((?:\\\\.|(?!\\1)[^\\\\])*)\\1$/;\nconst ESCAPE_REGEX = /\\\\(u(?:[a-f\\d]{4}|{[a-f\\d]{1,6}})|x[a-f\\d]{2}|.)|([^\\\\])/gi;\n\nconst ESCAPES = new Map([\n\t['n', '\\n'],\n\t['r', '\\r'],\n\t['t', '\\t'],\n\t['b', '\\b'],\n\t['f', '\\f'],\n\t['v', '\\v'],\n\t['0', '\\0'],\n\t['\\\\', '\\\\'],\n\t['e', '\\u001B'],\n\t['a', '\\u0007']\n]);\n\nfunction unescape(c) {\n\tconst u = c[0] === 'u';\n\tconst bracket = c[1] === '{';\n\n\tif ((u && !bracket && c.length === 5) || (c[0] === 'x' && c.length === 3)) {\n\t\treturn String.fromCharCode(parseInt(c.slice(1), 16));\n\t}\n\n\tif (u && bracket) {\n\t\treturn String.fromCodePoint(parseInt(c.slice(2, -1), 16));\n\t}\n\n\treturn ESCAPES.get(c) || c;\n}\n\nfunction parseArguments(name, arguments_) {\n\tconst results = [];\n\tconst chunks = arguments_.trim().split(/\\s*,\\s*/g);\n\tlet matches;\n\n\tfor (const chunk of chunks) {\n\t\tconst number = Number(chunk);\n\t\tif (!Number.isNaN(number)) {\n\t\t\tresults.push(number);\n\t\t} else if ((matches = chunk.match(STRING_REGEX))) {\n\t\t\tresults.push(matches[2].replace(ESCAPE_REGEX, (m, escape, character) => escape ? unescape(escape) : character));\n\t\t} else {\n\t\t\tthrow new Error(`Invalid Chalk template style argument: ${chunk} (in style '${name}')`);\n\t\t}\n\t}\n\n\treturn results;\n}\n\nfunction parseStyle(style) {\n\tSTYLE_REGEX.lastIndex = 0;\n\n\tconst results = [];\n\tlet matches;\n\n\twhile ((matches = STYLE_REGEX.exec(style)) !== null) {\n\t\tconst name = matches[1];\n\n\t\tif (matches[2]) {\n\t\t\tconst args = parseArguments(name, matches[2]);\n\t\t\tresults.push([name].concat(args));\n\t\t} else {\n\t\t\tresults.push([name]);\n\t\t}\n\t}\n\n\treturn results;\n}\n\nfunction buildStyle(chalk, styles) {\n\tconst enabled = {};\n\n\tfor (const layer of styles) {\n\t\tfor (const style of layer.styles) {\n\t\t\tenabled[style[0]] = layer.inverse ? null : style.slice(1);\n\t\t}\n\t}\n\n\tlet current = chalk;\n\tfor (const [styleName, styles] of Object.entries(enabled)) {\n\t\tif (!Array.isArray(styles)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!(styleName in current)) {\n\t\t\tthrow new Error(`Unknown Chalk style: ${styleName}`);\n\t\t}\n\n\t\tcurrent = styles.length > 0 ? current[styleName](...styles) : current[styleName];\n\t}\n\n\treturn current;\n}\n\nmodule.exports = (chalk, temporary) => {\n\tconst styles = [];\n\tconst chunks = [];\n\tlet chunk = [];\n\n\t// eslint-disable-next-line max-params\n\ttemporary.replace(TEMPLATE_REGEX, (m, escapeCharacter, inverse, style, close, character) => {\n\t\tif (escapeCharacter) {\n\t\t\tchunk.push(unescape(escapeCharacter));\n\t\t} else if (style) {\n\t\t\tconst string = chunk.join('');\n\t\t\tchunk = [];\n\t\t\tchunks.push(styles.length === 0 ? string : buildStyle(chalk, styles)(string));\n\t\t\tstyles.push({inverse, styles: parseStyle(style)});\n\t\t} else if (close) {\n\t\t\tif (styles.length === 0) {\n\t\t\t\tthrow new Error('Found extraneous } in Chalk template literal');\n\t\t\t}\n\n\t\t\tchunks.push(buildStyle(chalk, styles)(chunk.join('')));\n\t\t\tchunk = [];\n\t\t\tstyles.pop();\n\t\t} else {\n\t\t\tchunk.push(character);\n\t\t}\n\t});\n\n\tchunks.push(chunk.join(''));\n\n\tif (styles.length > 0) {\n\t\tconst errMessage = `Chalk template literal is missing ${styles.length} closing bracket${styles.length === 1 ? '' : 's'} (\\`}\\`)`;\n\t\tthrow new Error(errMessage);\n\t}\n\n\treturn chunks.join('');\n};\n","'use strict';\n\nconst stringReplaceAll = (string, substring, replacer) => {\n\tlet index = string.indexOf(substring);\n\tif (index === -1) {\n\t\treturn string;\n\t}\n\n\tconst substringLength = substring.length;\n\tlet endIndex = 0;\n\tlet returnValue = '';\n\tdo {\n\t\treturnValue += string.substr(endIndex, index - endIndex) + substring + replacer;\n\t\tendIndex = index + substringLength;\n\t\tindex = string.indexOf(substring, endIndex);\n\t} while (index !== -1);\n\n\treturnValue += string.substr(endIndex);\n\treturn returnValue;\n};\n\nconst stringEncaseCRLFWithFirstIndex = (string, prefix, postfix, index) => {\n\tlet endIndex = 0;\n\tlet returnValue = '';\n\tdo {\n\t\tconst gotCR = string[index - 1] === '\\r';\n\t\treturnValue += string.substr(endIndex, (gotCR ? index - 1 : index) - endIndex) + prefix + (gotCR ? '\\r\\n' : '\\n') + postfix;\n\t\tendIndex = index + 1;\n\t\tindex = string.indexOf('\\n', endIndex);\n\t} while (index !== -1);\n\n\treturnValue += string.substr(endIndex);\n\treturn returnValue;\n};\n\nmodule.exports = {\n\tstringReplaceAll,\n\tstringEncaseCRLFWithFirstIndex\n};\n","'use strict'\r\n\r\nmodule.exports = {\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n};\r\n","'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp('(' + token + ')|([^%]+?)', 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn [decodeURIComponent(components.join(''))];\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher) || [];\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher) || [];\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n","'use strict';\nmodule.exports = function (obj, predicate) {\n\tvar ret = {};\n\tvar keys = Object.keys(obj);\n\tvar isArr = Array.isArray(predicate);\n\n\tfor (var i = 0; i < keys.length; i++) {\n\t\tvar key = keys[i];\n\t\tvar val = obj[key];\n\n\t\tif (isArr ? predicate.indexOf(key) !== -1 : predicate(key, val, obj)) {\n\t\t\tret[key] = val;\n\t\t}\n\t}\n\n\treturn ret;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n","module.exports = curry;\n\n/*\n  function add(a, b, c) {\n    return a + b + c;\n  }\n  curry(add)(1)(2)(3); // 6\n  curry(add)(1)(2)(2); // 5\n  curry(add)(2)(4, 3); // 9\n\n  function add(...args) {\n    return args.reduce((sum, n) => sum + n, 0)\n  }\n  var curryAdd4 = curry(add, 4)\n  curryAdd4(1)(2, 3)(4); // 10\n\n  function converter(ratio, input) {\n    return (input*ratio).toFixed(1);\n  }\n  const curriedConverter = curry(converter)\n  const milesToKm = curriedConverter(1.62);\n  milesToKm(35); // 56.7\n  milesToKm(10); // 16.2\n*/\n\nfunction curry(fn, arity) {\n  return function curried() {\n    if (arity == null) {\n      arity = fn.length;\n    }\n    var args = [].slice.call(arguments);\n    if (args.length >= arity) {\n      return fn.apply(this, args);\n    } else {\n      return function() {\n        return curried.apply(this, args.concat([].slice.call(arguments)));\n      };\n    }\n  };\n}\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/** Used as references for the maximum length and index of an array. */\nvar MAX_ARRAY_LENGTH = 4294967295;\n\n/**\n * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n *\n * @private\n * @constructor\n * @param {*} value The value to wrap.\n */\nfunction LazyWrapper(value) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__dir__ = 1;\n  this.__filtered__ = false;\n  this.__iteratees__ = [];\n  this.__takeCount__ = MAX_ARRAY_LENGTH;\n  this.__views__ = [];\n}\n\n// Ensure `LazyWrapper` is an instance of `baseLodash`.\nLazyWrapper.prototype = baseCreate(baseLodash.prototype);\nLazyWrapper.prototype.constructor = LazyWrapper;\n\nmodule.exports = LazyWrapper;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/**\n * The base constructor for creating `lodash` wrapper objects.\n *\n * @private\n * @param {*} value The value to wrap.\n * @param {boolean} [chainAll] Enable explicit method chain sequences.\n */\nfunction LodashWrapper(value, chainAll) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__chain__ = !!chainAll;\n  this.__index__ = 0;\n  this.__values__ = undefined;\n}\n\nLodashWrapper.prototype = baseCreate(baseLodash.prototype);\nLodashWrapper.prototype.constructor = LodashWrapper;\n\nmodule.exports = LodashWrapper;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nmodule.exports = arrayIncludes;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","/**\n * Converts an ASCII `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */\nfunction asciiToArray(string) {\n  return string.split('');\n}\n\nmodule.exports = asciiToArray;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignMergeValue;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var copyObject = require('./_copyObject'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nmodule.exports = baseAssignIn;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var Stack = require('./_Stack'),\n    arrayEach = require('./_arrayEach'),\n    assignValue = require('./_assignValue'),\n    baseAssign = require('./_baseAssign'),\n    baseAssignIn = require('./_baseAssignIn'),\n    cloneBuffer = require('./_cloneBuffer'),\n    copyArray = require('./_copyArray'),\n    copySymbols = require('./_copySymbols'),\n    copySymbolsIn = require('./_copySymbolsIn'),\n    getAllKeys = require('./_getAllKeys'),\n    getAllKeysIn = require('./_getAllKeysIn'),\n    getTag = require('./_getTag'),\n    initCloneArray = require('./_initCloneArray'),\n    initCloneByTag = require('./_initCloneByTag'),\n    initCloneObject = require('./_initCloneObject'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isMap = require('./isMap'),\n    isObject = require('./isObject'),\n    isSet = require('./isSet'),\n    keys = require('./keys'),\n    keysIn = require('./keysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nmodule.exports = baseClone;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = baseFindIndex;\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.has` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHas(object, key) {\n  return object != null && hasOwnProperty.call(object, key);\n}\n\nmodule.exports = baseHas;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIsNaN = require('./_baseIsNaN'),\n    strictIndexOf = require('./_strictIndexOf');\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nmodule.exports = baseIndexOf;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nmodule.exports = baseIsMap;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nmodule.exports = baseIsNaN;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nmodule.exports = baseIsSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","/**\n * The function whose prototype chain sequence wrappers inherit from.\n *\n * @private\n */\nfunction baseLodash() {\n  // No operation performed.\n}\n\nmodule.exports = baseLodash;\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","var Stack = require('./_Stack'),\n    assignMergeValue = require('./_assignMergeValue'),\n    baseFor = require('./_baseFor'),\n    baseMergeDeep = require('./_baseMergeDeep'),\n    isObject = require('./isObject'),\n    keysIn = require('./keysIn'),\n    safeGet = require('./_safeGet');\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nmodule.exports = baseMerge;\n","var assignMergeValue = require('./_assignMergeValue'),\n    cloneBuffer = require('./_cloneBuffer'),\n    cloneTypedArray = require('./_cloneTypedArray'),\n    copyArray = require('./_copyArray'),\n    initCloneObject = require('./_initCloneObject'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLikeObject = require('./isArrayLikeObject'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isPlainObject = require('./isPlainObject'),\n    isTypedArray = require('./isTypedArray'),\n    safeGet = require('./_safeGet'),\n    toPlainObject = require('./toPlainObject');\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nmodule.exports = baseMergeDeep;\n","var arrayMap = require('./_arrayMap'),\n    baseGet = require('./_baseGet'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    baseSortBy = require('./_baseSortBy'),\n    baseUnary = require('./_baseUnary'),\n    compareMultiple = require('./_compareMultiple'),\n    identity = require('./identity'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `_.orderBy` without param guards.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n * @param {string[]} orders The sort orders of `iteratees`.\n * @returns {Array} Returns the new sorted array.\n */\nfunction baseOrderBy(collection, iteratees, orders) {\n  if (iteratees.length) {\n    iteratees = arrayMap(iteratees, function(iteratee) {\n      if (isArray(iteratee)) {\n        return function(value) {\n          return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n        }\n      }\n      return iteratee;\n    });\n  } else {\n    iteratees = [identity];\n  }\n\n  var index = -1;\n  iteratees = arrayMap(iteratees, baseUnary(baseIteratee));\n\n  var result = baseMap(collection, function(value, key, collection) {\n    var criteria = arrayMap(iteratees, function(iteratee) {\n      return iteratee(value);\n    });\n    return { 'criteria': criteria, 'index': ++index, 'value': value };\n  });\n\n  return baseSortBy(result, function(object, other) {\n    return compareMultiple(object, other, orders);\n  });\n}\n\nmodule.exports = baseOrderBy;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","var baseUnset = require('./_baseUnset'),\n    isIndex = require('./_isIndex');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * The base implementation of `_.pullAt` without support for individual\n * indexes or capturing the removed elements.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {number[]} indexes The indexes of elements to remove.\n * @returns {Array} Returns `array`.\n */\nfunction basePullAt(array, indexes) {\n  var length = array ? indexes.length : 0,\n      lastIndex = length - 1;\n\n  while (length--) {\n    var index = indexes[length];\n    if (length == lastIndex || index !== previous) {\n      var previous = index;\n      if (isIndex(index)) {\n        splice.call(array, index, 1);\n      } else {\n        baseUnset(array, index);\n      }\n    }\n  }\n  return array;\n}\n\nmodule.exports = basePullAt;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","var assignValue = require('./_assignValue'),\n    castPath = require('./_castPath'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.set`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @param {Function} [customizer] The function to customize path creation.\n * @returns {Object} Returns `object`.\n */\nfunction baseSet(object, path, value, customizer) {\n  if (!isObject(object)) {\n    return object;\n  }\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      lastIndex = length - 1,\n      nested = object;\n\n  while (nested != null && ++index < length) {\n    var key = toKey(path[index]),\n        newValue = value;\n\n    if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\n      return object;\n    }\n\n    if (index != lastIndex) {\n      var objValue = nested[key];\n      newValue = customizer ? customizer(objValue, key, nested) : undefined;\n      if (newValue === undefined) {\n        newValue = isObject(objValue)\n          ? objValue\n          : (isIndex(path[index + 1]) ? [] : {});\n      }\n    }\n    assignValue(nested, key, newValue);\n    nested = nested[key];\n  }\n  return object;\n}\n\nmodule.exports = baseSet;\n","var identity = require('./identity'),\n    metaMap = require('./_metaMap');\n\n/**\n * The base implementation of `setData` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar baseSetData = !metaMap ? identity : function(func, data) {\n  metaMap.set(func, data);\n  return func;\n};\n\nmodule.exports = baseSetData;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","/**\n * The base implementation of `_.slice` without an iteratee call guard.\n *\n * @private\n * @param {Array} array The array to slice.\n * @param {number} [start=0] The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the slice of `array`.\n */\nfunction baseSlice(array, start, end) {\n  var index = -1,\n      length = array.length;\n\n  if (start < 0) {\n    start = -start > length ? 0 : (length + start);\n  }\n  end = end > length ? length : end;\n  if (end < 0) {\n    end += length;\n  }\n  length = start > end ? 0 : ((end - start) >>> 0);\n  start >>>= 0;\n\n  var result = Array(length);\n  while (++index < length) {\n    result[index] = array[index + start];\n  }\n  return result;\n}\n\nmodule.exports = baseSlice;\n","/**\n * The base implementation of `_.sortBy` which uses `comparer` to define the\n * sort order of `array` and replaces criteria objects with their corresponding\n * values.\n *\n * @private\n * @param {Array} array The array to sort.\n * @param {Function} comparer The function to define sort order.\n * @returns {Array} Returns `array`.\n */\nfunction baseSortBy(array, comparer) {\n  var length = array.length;\n\n  array.sort(comparer);\n  while (length--) {\n    array[length] = array[length].value;\n  }\n  return array;\n}\n\nmodule.exports = baseSortBy;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/**\n * The base implementation of `_.toNumber` which doesn't ensure correct\n * conversions of binary, hexadecimal, or octal string values.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n */\nfunction baseToNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  return +value;\n}\n\nmodule.exports = baseToNumber;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    cacheHas = require('./_cacheHas'),\n    createSet = require('./_createSet'),\n    setToArray = require('./_setToArray');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseUniq;\n","var castPath = require('./_castPath'),\n    last = require('./last'),\n    parent = require('./_parent'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.unset`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The property path to unset.\n * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n */\nfunction baseUnset(object, path) {\n  path = castPath(path, object);\n  object = parent(object, path);\n  return object == null || delete object[toKey(last(path))];\n}\n\nmodule.exports = baseUnset;\n","var baseGet = require('./_baseGet'),\n    baseSet = require('./_baseSet');\n\n/**\n * The base implementation of `_.update`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to update.\n * @param {Function} updater The function to produce the updated value.\n * @param {Function} [customizer] The function to customize path creation.\n * @returns {Object} Returns `object`.\n */\nfunction baseUpdate(object, path, updater, customizer) {\n  return baseSet(object, path, updater(baseGet(object, path)), customizer);\n}\n\nmodule.exports = baseUpdate;\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","var baseSlice = require('./_baseSlice');\n\n/**\n * Casts `array` to a slice if it's needed.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {number} start The start position.\n * @param {number} [end=array.length] The end position.\n * @returns {Array} Returns the cast slice.\n */\nfunction castSlice(array, start, end) {\n  var length = array.length;\n  end = end === undefined ? length : end;\n  return (!start && end >= length) ? array : baseSlice(array, start, end);\n}\n\nmodule.exports = castSlice;\n","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol\n * that is not found in the character symbols.\n *\n * @private\n * @param {Array} strSymbols The string symbols to inspect.\n * @param {Array} chrSymbols The character symbols to find.\n * @returns {number} Returns the index of the last unmatched string symbol.\n */\nfunction charsEndIndex(strSymbols, chrSymbols) {\n  var index = strSymbols.length;\n\n  while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n  return index;\n}\n\nmodule.exports = charsEndIndex;\n","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol\n * that is not found in the character symbols.\n *\n * @private\n * @param {Array} strSymbols The string symbols to inspect.\n * @param {Array} chrSymbols The character symbols to find.\n * @returns {number} Returns the index of the first unmatched string symbol.\n */\nfunction charsStartIndex(strSymbols, chrSymbols) {\n  var index = -1,\n      length = strSymbols.length;\n\n  while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n  return index;\n}\n\nmodule.exports = charsStartIndex;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nmodule.exports = cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nmodule.exports = cloneRegExp;\n","var Symbol = require('./_Symbol');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nmodule.exports = cloneSymbol;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","var isSymbol = require('./isSymbol');\n\n/**\n * Compares values to sort them in ascending order.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {number} Returns the sort order indicator for `value`.\n */\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined,\n        valIsNull = value === null,\n        valIsReflexive = value === value,\n        valIsSymbol = isSymbol(value);\n\n    var othIsDefined = other !== undefined,\n        othIsNull = other === null,\n        othIsReflexive = other === other,\n        othIsSymbol = isSymbol(other);\n\n    if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n        (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n        (valIsNull && othIsDefined && othIsReflexive) ||\n        (!valIsDefined && othIsReflexive) ||\n        !valIsReflexive) {\n      return 1;\n    }\n    if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n        (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n        (othIsNull && valIsDefined && valIsReflexive) ||\n        (!othIsDefined && valIsReflexive) ||\n        !othIsReflexive) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\nmodule.exports = compareAscending;\n","var compareAscending = require('./_compareAscending');\n\n/**\n * Used by `_.orderBy` to compare multiple properties of a value to another\n * and stable sort them.\n *\n * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n * of corresponding values.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {boolean[]|string[]} orders The order to sort by for each property.\n * @returns {number} Returns the sort order indicator for `object`.\n */\nfunction compareMultiple(object, other, orders) {\n  var index = -1,\n      objCriteria = object.criteria,\n      othCriteria = other.criteria,\n      length = objCriteria.length,\n      ordersLength = orders.length;\n\n  while (++index < length) {\n    var result = compareAscending(objCriteria[index], othCriteria[index]);\n    if (result) {\n      if (index >= ordersLength) {\n        return result;\n      }\n      var order = orders[index];\n      return result * (order == 'desc' ? -1 : 1);\n    }\n  }\n  // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n  // that causes it, under certain circumstances, to provide the same value for\n  // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n  // for more details.\n  //\n  // This also ensures a stable sort in V8 and other engines.\n  // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n  return object.index - other.index;\n}\n\nmodule.exports = compareMultiple;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates an array that is the composition of partially applied arguments,\n * placeholders, and provided arguments into a single array of arguments.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to prepend to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgs(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersLength = holders.length,\n      leftIndex = -1,\n      leftLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(leftLength + rangeLength),\n      isUncurried = !isCurried;\n\n  while (++leftIndex < leftLength) {\n    result[leftIndex] = partials[leftIndex];\n  }\n  while (++argsIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[holders[argsIndex]] = args[argsIndex];\n    }\n  }\n  while (rangeLength--) {\n    result[leftIndex++] = args[argsIndex++];\n  }\n  return result;\n}\n\nmodule.exports = composeArgs;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This function is like `composeArgs` except that the arguments composition\n * is tailored for `_.partialRight`.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to append to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgsRight(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersIndex = -1,\n      holdersLength = holders.length,\n      rightIndex = -1,\n      rightLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(rangeLength + rightLength),\n      isUncurried = !isCurried;\n\n  while (++argsIndex < rangeLength) {\n    result[argsIndex] = args[argsIndex];\n  }\n  var offset = argsIndex;\n  while (++rightIndex < rightLength) {\n    result[offset + rightIndex] = partials[rightIndex];\n  }\n  while (++holdersIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[offset + holders[holdersIndex]] = args[argsIndex++];\n    }\n  }\n  return result;\n}\n\nmodule.exports = composeArgsRight;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","var copyObject = require('./_copyObject'),\n    getSymbols = require('./_getSymbols');\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nmodule.exports = copySymbols;\n","var copyObject = require('./_copyObject'),\n    getSymbolsIn = require('./_getSymbolsIn');\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nmodule.exports = copySymbolsIn;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","/**\n * Gets the number of `placeholder` occurrences in `array`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} placeholder The placeholder to search for.\n * @returns {number} Returns the placeholder count.\n */\nfunction countHolders(array, placeholder) {\n  var length = array.length,\n      result = 0;\n\n  while (length--) {\n    if (array[length] === placeholder) {\n      ++result;\n    }\n  }\n  return result;\n}\n\nmodule.exports = countHolders;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the optional `this`\n * binding of `thisArg`.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createBind(func, bitmask, thisArg) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return fn.apply(isBind ? thisArg : this, arguments);\n  }\n  return wrapper;\n}\n\nmodule.exports = createBind;\n","var baseCreate = require('./_baseCreate'),\n    isObject = require('./isObject');\n\n/**\n * Creates a function that produces an instance of `Ctor` regardless of\n * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n *\n * @private\n * @param {Function} Ctor The constructor to wrap.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCtor(Ctor) {\n  return function() {\n    // Use a `switch` statement to work with class constructors. See\n    // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n    // for more details.\n    var args = arguments;\n    switch (args.length) {\n      case 0: return new Ctor;\n      case 1: return new Ctor(args[0]);\n      case 2: return new Ctor(args[0], args[1]);\n      case 3: return new Ctor(args[0], args[1], args[2]);\n      case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n      case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n      case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n      case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n    }\n    var thisBinding = baseCreate(Ctor.prototype),\n        result = Ctor.apply(thisBinding, args);\n\n    // Mimic the constructor's `return` behavior.\n    // See https://es5.github.io/#x13.2.2 for more details.\n    return isObject(result) ? result : thisBinding;\n  };\n}\n\nmodule.exports = createCtor;\n","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    createHybrid = require('./_createHybrid'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/**\n * Creates a function that wraps `func` to enable currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {number} arity The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCurry(func, bitmask, arity) {\n  var Ctor = createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length,\n        placeholder = getHolder(wrapper);\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n      ? []\n      : replaceHolders(args, placeholder);\n\n    length -= holders.length;\n    if (length < arity) {\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, undefined,\n        args, holders, undefined, undefined, arity - length);\n    }\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return apply(fn, this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createCurry;\n","var baseIteratee = require('./_baseIteratee'),\n    isArrayLike = require('./isArrayLike'),\n    keys = require('./keys');\n\n/**\n * Creates a `_.find` or `_.findLast` function.\n *\n * @private\n * @param {Function} findIndexFunc The function to find the collection index.\n * @returns {Function} Returns the new find function.\n */\nfunction createFind(findIndexFunc) {\n  return function(collection, predicate, fromIndex) {\n    var iterable = Object(collection);\n    if (!isArrayLike(collection)) {\n      var iteratee = baseIteratee(predicate, 3);\n      collection = keys(collection);\n      predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n    }\n    var index = findIndexFunc(collection, predicate, fromIndex);\n    return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n  };\n}\n\nmodule.exports = createFind;\n","var LodashWrapper = require('./_LodashWrapper'),\n    flatRest = require('./_flatRest'),\n    getData = require('./_getData'),\n    getFuncName = require('./_getFuncName'),\n    isArray = require('./isArray'),\n    isLaziable = require('./_isLaziable');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_CURRY_FLAG = 8,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256;\n\n/**\n * Creates a `_.flow` or `_.flowRight` function.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new flow function.\n */\nfunction createFlow(fromRight) {\n  return flatRest(function(funcs) {\n    var length = funcs.length,\n        index = length,\n        prereq = LodashWrapper.prototype.thru;\n\n    if (fromRight) {\n      funcs.reverse();\n    }\n    while (index--) {\n      var func = funcs[index];\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      if (prereq && !wrapper && getFuncName(func) == 'wrapper') {\n        var wrapper = new LodashWrapper([], true);\n      }\n    }\n    index = wrapper ? index : length;\n    while (++index < length) {\n      func = funcs[index];\n\n      var funcName = getFuncName(func),\n          data = funcName == 'wrapper' ? getData(func) : undefined;\n\n      if (data && isLaziable(data[0]) &&\n            data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&\n            !data[4].length && data[9] == 1\n          ) {\n        wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);\n      } else {\n        wrapper = (func.length == 1 && isLaziable(func))\n          ? wrapper[funcName]()\n          : wrapper.thru(func);\n      }\n    }\n    return function() {\n      var args = arguments,\n          value = args[0];\n\n      if (wrapper && args.length == 1 && isArray(value)) {\n        return wrapper.plant(value).value();\n      }\n      var index = 0,\n          result = length ? funcs[index].apply(this, args) : value;\n\n      while (++index < length) {\n        result = funcs[index].call(this, result);\n      }\n      return result;\n    };\n  });\n}\n\nmodule.exports = createFlow;\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    countHolders = require('./_countHolders'),\n    createCtor = require('./_createCtor'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    reorder = require('./_reorder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_ARY_FLAG = 128,\n    WRAP_FLIP_FLAG = 512;\n\n/**\n * Creates a function that wraps `func` to invoke it with optional `this`\n * binding of `thisArg`, partial application, and currying.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [partialsRight] The arguments to append to those provided\n *  to the new function.\n * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n  var isAry = bitmask & WRAP_ARY_FLAG,\n      isBind = bitmask & WRAP_BIND_FLAG,\n      isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n      isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n      isFlip = bitmask & WRAP_FLIP_FLAG,\n      Ctor = isBindKey ? undefined : createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length;\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    if (isCurried) {\n      var placeholder = getHolder(wrapper),\n          holdersCount = countHolders(args, placeholder);\n    }\n    if (partials) {\n      args = composeArgs(args, partials, holders, isCurried);\n    }\n    if (partialsRight) {\n      args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n    }\n    length -= holdersCount;\n    if (isCurried && length < arity) {\n      var newHolders = replaceHolders(args, placeholder);\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n        args, newHolders, argPos, ary, arity - length\n      );\n    }\n    var thisBinding = isBind ? thisArg : this,\n        fn = isBindKey ? thisBinding[func] : func;\n\n    length = args.length;\n    if (argPos) {\n      args = reorder(args, argPos);\n    } else if (isFlip && length > 1) {\n      args.reverse();\n    }\n    if (isAry && ary < length) {\n      args.length = ary;\n    }\n    if (this && this !== root && this instanceof wrapper) {\n      fn = Ctor || createCtor(fn);\n    }\n    return fn.apply(thisBinding, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createHybrid;\n","var baseToNumber = require('./_baseToNumber'),\n    baseToString = require('./_baseToString');\n\n/**\n * Creates a function that performs a mathematical operation on two values.\n *\n * @private\n * @param {Function} operator The function to perform the operation.\n * @param {number} [defaultValue] The value used for `undefined` arguments.\n * @returns {Function} Returns the new mathematical operation function.\n */\nfunction createMathOperation(operator, defaultValue) {\n  return function(value, other) {\n    var result;\n    if (value === undefined && other === undefined) {\n      return defaultValue;\n    }\n    if (value !== undefined) {\n      result = value;\n    }\n    if (other !== undefined) {\n      if (result === undefined) {\n        return other;\n      }\n      if (typeof value == 'string' || typeof other == 'string') {\n        value = baseToString(value);\n        other = baseToString(other);\n      } else {\n        value = baseToNumber(value);\n        other = baseToNumber(other);\n      }\n      result = operator(value, other);\n    }\n    return result;\n  };\n}\n\nmodule.exports = createMathOperation;\n","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the `this` binding\n * of `thisArg` and `partials` prepended to the arguments it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} partials The arguments to prepend to those provided to\n *  the new function.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createPartial(func, bitmask, thisArg, partials) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var argsIndex = -1,\n        argsLength = arguments.length,\n        leftIndex = -1,\n        leftLength = partials.length,\n        args = Array(leftLength + argsLength),\n        fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n    while (++leftIndex < leftLength) {\n      args[leftIndex] = partials[leftIndex];\n    }\n    while (argsLength--) {\n      args[leftIndex++] = arguments[++argsIndex];\n    }\n    return apply(fn, isBind ? thisArg : this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createPartial;\n","var isLaziable = require('./_isLaziable'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/**\n * Creates a function that wraps `func` to continue currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {Function} wrapFunc The function to create the `func` wrapper.\n * @param {*} placeholder The placeholder value.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n  var isCurry = bitmask & WRAP_CURRY_FLAG,\n      newHolders = isCurry ? holders : undefined,\n      newHoldersRight = isCurry ? undefined : holders,\n      newPartials = isCurry ? partials : undefined,\n      newPartialsRight = isCurry ? undefined : partials;\n\n  bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n  bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n  if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n    bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n  }\n  var newData = [\n    func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n    newHoldersRight, argPos, ary, arity\n  ];\n\n  var result = wrapFunc.apply(undefined, newData);\n  if (isLaziable(func)) {\n    setData(result, newData);\n  }\n  result.placeholder = placeholder;\n  return setWrapToString(result, func, bitmask);\n}\n\nmodule.exports = createRecurry;\n","var Set = require('./_Set'),\n    noop = require('./noop'),\n    setToArray = require('./_setToArray');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nmodule.exports = createSet;\n","var baseSetData = require('./_baseSetData'),\n    createBind = require('./_createBind'),\n    createCurry = require('./_createCurry'),\n    createHybrid = require('./_createHybrid'),\n    createPartial = require('./_createPartial'),\n    getData = require('./_getData'),\n    mergeData = require('./_mergeData'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString'),\n    toInteger = require('./toInteger');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates a function that either curries or invokes `func` with optional\n * `this` binding and partially applied arguments.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags.\n *    1 - `_.bind`\n *    2 - `_.bindKey`\n *    4 - `_.curry` or `_.curryRight` of a bound function\n *    8 - `_.curry`\n *   16 - `_.curryRight`\n *   32 - `_.partial`\n *   64 - `_.partialRight`\n *  128 - `_.rearg`\n *  256 - `_.ary`\n *  512 - `_.flip`\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to be partially applied.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n  var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n  if (!isBindKey && typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var length = partials ? partials.length : 0;\n  if (!length) {\n    bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n    partials = holders = undefined;\n  }\n  ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n  arity = arity === undefined ? arity : toInteger(arity);\n  length -= holders ? holders.length : 0;\n\n  if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n    var partialsRight = partials,\n        holdersRight = holders;\n\n    partials = holders = undefined;\n  }\n  var data = isBindKey ? undefined : getData(func);\n\n  var newData = [\n    func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n    argPos, ary, arity\n  ];\n\n  if (data) {\n    mergeData(newData, data);\n  }\n  func = newData[0];\n  bitmask = newData[1];\n  thisArg = newData[2];\n  partials = newData[3];\n  holders = newData[4];\n  arity = newData[9] = newData[9] === undefined\n    ? (isBindKey ? 0 : func.length)\n    : nativeMax(newData[9] - length, 0);\n\n  if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n    bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n  }\n  if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n    var result = createBind(func, bitmask, thisArg);\n  } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n    result = createCurry(func, bitmask, arity);\n  } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n    result = createPartial(func, bitmask, thisArg, partials);\n  } else {\n    result = createHybrid.apply(undefined, newData);\n  }\n  var setter = data ? baseSetData : setData;\n  return setWrapToString(setter(result, newData), func, bitmask);\n}\n\nmodule.exports = createWrap;\n","var baseMerge = require('./_baseMerge'),\n    isObject = require('./isObject');\n\n/**\n * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n * objects into destination objects that are passed thru.\n *\n * @private\n * @param {*} objValue The destination value.\n * @param {*} srcValue The source value.\n * @param {string} key The key of the property to merge.\n * @param {Object} object The parent object of `objValue`.\n * @param {Object} source The parent object of `srcValue`.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n * @returns {*} Returns the value to assign.\n */\nfunction customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n  if (isObject(objValue) && isObject(srcValue)) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, objValue);\n    baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n    stack['delete'](srcValue);\n  }\n  return objValue;\n}\n\nmodule.exports = customDefaultsMerge;\n","var isPlainObject = require('./isPlainObject');\n\n/**\n * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n * objects.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {string} key The key of the property to inspect.\n * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n */\nfunction customOmitClone(value) {\n  return isPlainObject(value) ? undefined : value;\n}\n\nmodule.exports = customOmitClone;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","var flatten = require('./flatten'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * A specialized version of `baseRest` which flattens the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @returns {Function} Returns the new function.\n */\nfunction flatRest(func) {\n  return setToString(overRest(func, undefined, flatten), func + '');\n}\n\nmodule.exports = flatRest;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbolsIn = require('./_getSymbolsIn'),\n    keysIn = require('./keysIn');\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nmodule.exports = getAllKeysIn;\n","var metaMap = require('./_metaMap'),\n    noop = require('./noop');\n\n/**\n * Gets metadata for `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {*} Returns the metadata for `func`.\n */\nvar getData = !metaMap ? noop : function(func) {\n  return metaMap.get(func);\n};\n\nmodule.exports = getData;\n","var realNames = require('./_realNames');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the name of `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {string} Returns the function name.\n */\nfunction getFuncName(func) {\n  var result = (func.name + ''),\n      array = realNames[result],\n      length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n  while (length--) {\n    var data = array[length],\n        otherFunc = data.func;\n    if (otherFunc == null || otherFunc == func) {\n      return data.name;\n    }\n  }\n  return result;\n}\n\nmodule.exports = getFuncName;\n","/**\n * Gets the argument placeholder value for `func`.\n *\n * @private\n * @param {Function} func The function to inspect.\n * @returns {*} Returns the placeholder value.\n */\nfunction getHolder(func) {\n  var object = func;\n  return object.placeholder;\n}\n\nmodule.exports = getHolder;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var arrayPush = require('./_arrayPush'),\n    getPrototype = require('./_getPrototype'),\n    getSymbols = require('./_getSymbols'),\n    stubArray = require('./stubArray');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nmodule.exports = getSymbolsIn;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","/** Used to match wrap detail comments. */\nvar reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n    reSplitDetails = /,? & /;\n\n/**\n * Extracts wrapper details from the `source` body comment.\n *\n * @private\n * @param {string} source The source to inspect.\n * @returns {Array} Returns the wrapper details.\n */\nfunction getWrapDetails(source) {\n  var match = source.match(reWrapDetails);\n  return match ? match[1].split(reSplitDetails) : [];\n}\n\nmodule.exports = getWrapDetails;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = '\\\\ufe0e\\\\ufe0f';\n\n/** Used to compose unicode capture groups. */\nvar rsZWJ = '\\\\u200d';\n\n/** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\nvar reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n/**\n * Checks if `string` contains Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n */\nfunction hasUnicode(string) {\n  return reHasUnicode.test(string);\n}\n\nmodule.exports = hasUnicode;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nmodule.exports = initCloneArray;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer'),\n    cloneDataView = require('./_cloneDataView'),\n    cloneRegExp = require('./_cloneRegExp'),\n    cloneSymbol = require('./_cloneSymbol'),\n    cloneTypedArray = require('./_cloneTypedArray');\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nmodule.exports = initCloneByTag;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","/** Used to match wrap detail comments. */\nvar reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/;\n\n/**\n * Inserts wrapper `details` in a comment at the top of the `source` body.\n *\n * @private\n * @param {string} source The source to modify.\n * @returns {Array} details The details to insert.\n * @returns {string} Returns the modified source.\n */\nfunction insertWrapDetails(source, details) {\n  var length = details.length;\n  if (!length) {\n    return source;\n  }\n  var lastIndex = length - 1;\n  details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n  details = details.join(length > 2 ? ', ' : ' ');\n  return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n}\n\nmodule.exports = insertWrapDetails;\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var LazyWrapper = require('./_LazyWrapper'),\n    getData = require('./_getData'),\n    getFuncName = require('./_getFuncName'),\n    lodash = require('./wrapperLodash');\n\n/**\n * Checks if `func` has a lazy counterpart.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n *  else `false`.\n */\nfunction isLaziable(func) {\n  var funcName = getFuncName(func),\n      other = lodash[funcName];\n\n  if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n    return false;\n  }\n  if (func === other) {\n    return true;\n  }\n  var data = getData(other);\n  return !!data && func === data[0];\n}\n\nmodule.exports = isLaziable;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Merges the function metadata of `source` into `data`.\n *\n * Merging metadata reduces the number of wrappers used to invoke a function.\n * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n * may be applied regardless of execution order. Methods like `_.ary` and\n * `_.rearg` modify function arguments, making the order in which they are\n * executed important, preventing the merging of metadata. However, we make\n * an exception for a safe combined case where curried functions have `_.ary`\n * and or `_.rearg` applied.\n *\n * @private\n * @param {Array} data The destination metadata.\n * @param {Array} source The source metadata.\n * @returns {Array} Returns `data`.\n */\nfunction mergeData(data, source) {\n  var bitmask = data[1],\n      srcBitmask = source[1],\n      newBitmask = bitmask | srcBitmask,\n      isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n  var isCombo =\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n    ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n  // Exit early if metadata can't be merged.\n  if (!(isCommon || isCombo)) {\n    return data;\n  }\n  // Use source `thisArg` if available.\n  if (srcBitmask & WRAP_BIND_FLAG) {\n    data[2] = source[2];\n    // Set when currying a bound function.\n    newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n  }\n  // Compose partial arguments.\n  var value = source[3];\n  if (value) {\n    var partials = data[3];\n    data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n    data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n  }\n  // Compose partial right arguments.\n  value = source[5];\n  if (value) {\n    partials = data[5];\n    data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n    data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n  }\n  // Use source `argPos` if available.\n  value = source[7];\n  if (value) {\n    data[7] = value;\n  }\n  // Use source `ary` if it's smaller.\n  if (srcBitmask & WRAP_ARY_FLAG) {\n    data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n  }\n  // Use source `arity` if one is not provided.\n  if (data[9] == null) {\n    data[9] = source[9];\n  }\n  // Use source `func` and merge bitmasks.\n  data[0] = source[0];\n  data[1] = newBitmask;\n\n  return data;\n}\n\nmodule.exports = mergeData;\n","var WeakMap = require('./_WeakMap');\n\n/** Used to store function metadata. */\nvar metaMap = WeakMap && new WeakMap;\n\nmodule.exports = metaMap;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","var baseGet = require('./_baseGet'),\n    baseSlice = require('./_baseSlice');\n\n/**\n * Gets the parent value at `path` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} path The path to get the parent value of.\n * @returns {*} Returns the parent value.\n */\nfunction parent(object, path) {\n  return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n}\n\nmodule.exports = parent;\n","/** Used to lookup unminified function names. */\nvar realNames = {};\n\nmodule.exports = realNames;\n","var copyArray = require('./_copyArray'),\n    isIndex = require('./_isIndex');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Reorder `array` according to the specified indexes where the element at\n * the first index is assigned as the first element, the element at\n * the second index is assigned as the second element, and so on.\n *\n * @private\n * @param {Array} array The array to reorder.\n * @param {Array} indexes The arranged array indexes.\n * @returns {Array} Returns `array`.\n */\nfunction reorder(array, indexes) {\n  var arrLength = array.length,\n      length = nativeMin(indexes.length, arrLength),\n      oldArray = copyArray(array);\n\n  while (length--) {\n    var index = indexes[length];\n    array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n  }\n  return array;\n}\n\nmodule.exports = reorder;\n","/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/**\n * Replaces all `placeholder` elements in `array` with an internal placeholder\n * and returns an array of their indexes.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {*} placeholder The placeholder to replace.\n * @returns {Array} Returns the new array of placeholder indexes.\n */\nfunction replaceHolders(array, placeholder) {\n  var index = -1,\n      length = array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (value === placeholder || value === PLACEHOLDER) {\n      array[index] = PLACEHOLDER;\n      result[resIndex++] = index;\n    }\n  }\n  return result;\n}\n\nmodule.exports = replaceHolders;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nmodule.exports = safeGet;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","var baseSetData = require('./_baseSetData'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets metadata for `func`.\n *\n * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n * period of time, it will trip its breaker and transition to an identity\n * function to avoid garbage collection pauses in V8. See\n * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n * for more details.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar setData = shortOut(baseSetData);\n\nmodule.exports = setData;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","var getWrapDetails = require('./_getWrapDetails'),\n    insertWrapDetails = require('./_insertWrapDetails'),\n    setToString = require('./_setToString'),\n    updateWrapDetails = require('./_updateWrapDetails');\n\n/**\n * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n * with wrapper details in a comment at the top of the source body.\n *\n * @private\n * @param {Function} wrapper The function to modify.\n * @param {Function} reference The reference function.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Function} Returns `wrapper`.\n */\nfunction setWrapToString(wrapper, reference, bitmask) {\n  var source = (reference + '');\n  return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n}\n\nmodule.exports = setWrapToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = strictIndexOf;\n","var asciiToArray = require('./_asciiToArray'),\n    hasUnicode = require('./_hasUnicode'),\n    unicodeToArray = require('./_unicodeToArray');\n\n/**\n * Converts `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */\nfunction stringToArray(string) {\n  return hasUnicode(string)\n    ? unicodeToArray(string)\n    : asciiToArray(string);\n}\n\nmodule.exports = stringToArray;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = '\\\\ufe0e\\\\ufe0f';\n\n/** Used to compose unicode capture groups. */\nvar rsAstral = '[' + rsAstralRange + ']',\n    rsCombo = '[' + rsComboRange + ']',\n    rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n    rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n    rsNonAstral = '[^' + rsAstralRange + ']',\n    rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n    rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n    rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nvar reOptMod = rsModifier + '?',\n    rsOptVar = '[' + rsVarRange + ']?',\n    rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\nvar reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n/**\n * Converts a Unicode `string` to an array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the converted array.\n */\nfunction unicodeToArray(string) {\n  return string.match(reUnicode) || [];\n}\n\nmodule.exports = unicodeToArray;\n","var arrayEach = require('./_arrayEach'),\n    arrayIncludes = require('./_arrayIncludes');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256,\n    WRAP_FLIP_FLAG = 512;\n\n/** Used to associate wrap methods with their bit flags. */\nvar wrapFlags = [\n  ['ary', WRAP_ARY_FLAG],\n  ['bind', WRAP_BIND_FLAG],\n  ['bindKey', WRAP_BIND_KEY_FLAG],\n  ['curry', WRAP_CURRY_FLAG],\n  ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n  ['flip', WRAP_FLIP_FLAG],\n  ['partial', WRAP_PARTIAL_FLAG],\n  ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n  ['rearg', WRAP_REARG_FLAG]\n];\n\n/**\n * Updates wrapper `details` based on `bitmask` flags.\n *\n * @private\n * @returns {Array} details The details to modify.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Array} Returns `details`.\n */\nfunction updateWrapDetails(details, bitmask) {\n  arrayEach(wrapFlags, function(pair) {\n    var value = '_.' + pair[0];\n    if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n      details.push(value);\n    }\n  });\n  return details.sort();\n}\n\nmodule.exports = updateWrapDetails;\n","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    copyArray = require('./_copyArray');\n\n/**\n * Creates a clone of `wrapper`.\n *\n * @private\n * @param {Object} wrapper The wrapper to clone.\n * @returns {Object} Returns the cloned wrapper.\n */\nfunction wrapperClone(wrapper) {\n  if (wrapper instanceof LazyWrapper) {\n    return wrapper.clone();\n  }\n  var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n  result.__actions__ = copyArray(wrapper.__actions__);\n  result.__index__  = wrapper.__index__;\n  result.__values__ = wrapper.__values__;\n  return result;\n}\n\nmodule.exports = wrapperClone;\n","var createMathOperation = require('./_createMathOperation');\n\n/**\n * Adds two numbers.\n *\n * @static\n * @memberOf _\n * @since 3.4.0\n * @category Math\n * @param {number} augend The first number in an addition.\n * @param {number} addend The second number in an addition.\n * @returns {number} Returns the total.\n * @example\n *\n * _.add(6, 4);\n * // => 10\n */\nvar add = createMathOperation(function(augend, addend) {\n  return augend + addend;\n}, 0);\n\nmodule.exports = add;\n","var createWrap = require('./_createWrap');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_ARY_FLAG = 128;\n\n/**\n * Creates a function that invokes `func`, with up to `n` arguments,\n * ignoring any additional arguments.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {Function} func The function to cap arguments for.\n * @param {number} [n=func.length] The arity cap.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Function} Returns the new capped function.\n * @example\n *\n * _.map(['6', '8', '10'], _.ary(parseInt, 1));\n * // => [6, 8, 10]\n */\nfunction ary(func, n, guard) {\n  n = guard ? undefined : n;\n  n = (func && n == null) ? func.length : n;\n  return createWrap(func, WRAP_ARY_FLAG, undefined, undefined, undefined, undefined, n);\n}\n\nmodule.exports = ary;\n","var baseClone = require('./_baseClone');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * Creates a shallow clone of `value`.\n *\n * **Note:** This method is loosely based on the\n * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n * and supports cloning arrays, array buffers, booleans, date objects, maps,\n * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n * arrays. The own enumerable properties of `arguments` objects are cloned\n * as plain objects. An empty object is returned for uncloneable values such\n * as error objects, functions, DOM nodes, and WeakMaps.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to clone.\n * @returns {*} Returns the cloned value.\n * @see _.cloneDeep\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var shallow = _.clone(objects);\n * console.log(shallow[0] === objects[0]);\n * // => true\n */\nfunction clone(value) {\n  return baseClone(value, CLONE_SYMBOLS_FLAG);\n}\n\nmodule.exports = clone;\n","var baseClone = require('./_baseClone');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nmodule.exports = cloneDeep;\n","var arrayPush = require('./_arrayPush'),\n    baseFlatten = require('./_baseFlatten'),\n    copyArray = require('./_copyArray'),\n    isArray = require('./isArray');\n\n/**\n * Creates a new array concatenating `array` with any additional arrays\n * and/or values.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to concatenate.\n * @param {...*} [values] The values to concatenate.\n * @returns {Array} Returns the new concatenated array.\n * @example\n *\n * var array = [1];\n * var other = _.concat(array, 2, [3], [[4]]);\n *\n * console.log(other);\n * // => [1, 2, 3, [4]]\n *\n * console.log(array);\n * // => [1]\n */\nfunction concat() {\n  var length = arguments.length;\n  if (!length) {\n    return [];\n  }\n  var args = Array(length - 1),\n      array = arguments[0],\n      index = length;\n\n  while (index--) {\n    args[index - 1] = arguments[index];\n  }\n  return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n}\n\nmodule.exports = concat;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","var createWrap = require('./_createWrap');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_CURRY_FLAG = 8;\n\n/**\n * Creates a function that accepts arguments of `func` and either invokes\n * `func` returning its result, if at least `arity` number of arguments have\n * been provided, or returns a function that accepts the remaining `func`\n * arguments, and so on. The arity of `func` may be specified if `func.length`\n * is not sufficient.\n *\n * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,\n * may be used as a placeholder for provided arguments.\n *\n * **Note:** This method doesn't set the \"length\" property of curried functions.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Function\n * @param {Function} func The function to curry.\n * @param {number} [arity=func.length] The arity of `func`.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Function} Returns the new curried function.\n * @example\n *\n * var abc = function(a, b, c) {\n *   return [a, b, c];\n * };\n *\n * var curried = _.curry(abc);\n *\n * curried(1)(2)(3);\n * // => [1, 2, 3]\n *\n * curried(1, 2)(3);\n * // => [1, 2, 3]\n *\n * curried(1, 2, 3);\n * // => [1, 2, 3]\n *\n * // Curried with placeholders.\n * curried(1)(_, 3)(2);\n * // => [1, 2, 3]\n */\nfunction curry(func, arity, guard) {\n  arity = guard ? undefined : arity;\n  var result = createWrap(func, WRAP_CURRY_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n  result.placeholder = curry.placeholder;\n  return result;\n}\n\n// Assign default placeholders.\ncurry.placeholder = {};\n\nmodule.exports = curry;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var baseRest = require('./_baseRest'),\n    eq = require('./eq'),\n    isIterateeCall = require('./_isIterateeCall'),\n    keysIn = require('./keysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own and inherited enumerable string keyed properties of source\n * objects to the destination object for all destination properties that\n * resolve to `undefined`. Source objects are applied from left to right.\n * Once a property is set, additional values of the same property are ignored.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.defaultsDeep\n * @example\n *\n * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n * // => { 'a': 1, 'b': 2 }\n */\nvar defaults = baseRest(function(object, sources) {\n  object = Object(object);\n\n  var index = -1;\n  var length = sources.length;\n  var guard = length > 2 ? sources[2] : undefined;\n\n  if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n    length = 1;\n  }\n\n  while (++index < length) {\n    var source = sources[index];\n    var props = keysIn(source);\n    var propsIndex = -1;\n    var propsLength = props.length;\n\n    while (++propsIndex < propsLength) {\n      var key = props[propsIndex];\n      var value = object[key];\n\n      if (value === undefined ||\n          (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        object[key] = source[key];\n      }\n    }\n  }\n\n  return object;\n});\n\nmodule.exports = defaults;\n","var apply = require('./_apply'),\n    baseRest = require('./_baseRest'),\n    customDefaultsMerge = require('./_customDefaultsMerge'),\n    mergeWith = require('./mergeWith');\n\n/**\n * This method is like `_.defaults` except that it recursively assigns\n * default properties.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 3.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.defaults\n * @example\n *\n * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n * // => { 'a': { 'b': 2, 'c': 3 } }\n */\nvar defaultsDeep = baseRest(function(args) {\n  args.push(undefined, customDefaultsMerge);\n  return apply(mergeWith, undefined, args);\n});\n\nmodule.exports = defaultsDeep;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseRest = require('./_baseRest'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of `array` values not included in the other given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order and references of result values are\n * determined by the first array.\n *\n * **Note:** Unlike `_.pullAll`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...Array} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.without, _.xor\n * @example\n *\n * _.difference([2, 1], [2, 3]);\n * // => [1]\n */\nvar difference = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n    : [];\n});\n\nmodule.exports = difference;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var createFind = require('./_createFind'),\n    findIndex = require('./findIndex');\n\n/**\n * Iterates over elements of `collection`, returning the first element\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {*} Returns the matched element, else `undefined`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'age': 36, 'active': true },\n *   { 'user': 'fred',    'age': 40, 'active': false },\n *   { 'user': 'pebbles', 'age': 1,  'active': true }\n * ];\n *\n * _.find(users, function(o) { return o.age < 40; });\n * // => object for 'barney'\n *\n * // The `_.matches` iteratee shorthand.\n * _.find(users, { 'age': 1, 'active': true });\n * // => object for 'pebbles'\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.find(users, ['active', false]);\n * // => object for 'fred'\n *\n * // The `_.property` iteratee shorthand.\n * _.find(users, 'active');\n * // => object for 'barney'\n */\nvar find = createFind(findIndex);\n\nmodule.exports = find;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIteratee = require('./_baseIteratee'),\n    toInteger = require('./toInteger');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This method is like `_.find` except that it returns the index of the first\n * element `predicate` returns truthy for instead of the element itself.\n *\n * @static\n * @memberOf _\n * @since 1.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': false },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': true }\n * ];\n *\n * _.findIndex(users, function(o) { return o.user == 'barney'; });\n * // => 0\n *\n * // The `_.matches` iteratee shorthand.\n * _.findIndex(users, { 'user': 'fred', 'active': false });\n * // => 1\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findIndex(users, ['active', false]);\n * // => 0\n *\n * // The `_.property` iteratee shorthand.\n * _.findIndex(users, 'active');\n * // => 2\n */\nfunction findIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = fromIndex == null ? 0 : toInteger(fromIndex);\n  if (index < 0) {\n    index = nativeMax(length + index, 0);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index);\n}\n\nmodule.exports = findIndex;\n","var baseFlatten = require('./_baseFlatten'),\n    map = require('./map');\n\n/**\n * Creates a flattened array of values by running each element in `collection`\n * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n * with three arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * function duplicate(n) {\n *   return [n, n];\n * }\n *\n * _.flatMap([1, 2], duplicate);\n * // => [1, 1, 2, 2]\n */\nfunction flatMap(collection, iteratee) {\n  return baseFlatten(map(collection, iteratee), 1);\n}\n\nmodule.exports = flatMap;\n","var baseFlatten = require('./_baseFlatten');\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nmodule.exports = flatten;\n","var createFlow = require('./_createFlow');\n\n/**\n * This method is like `_.flow` except that it creates a function that\n * invokes the given functions from right to left.\n *\n * @static\n * @since 3.0.0\n * @memberOf _\n * @category Util\n * @param {...(Function|Function[])} [funcs] The functions to invoke.\n * @returns {Function} Returns the new composite function.\n * @see _.flow\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * var addSquare = _.flowRight([square, _.add]);\n * addSquare(1, 2);\n * // => 9\n */\nvar flowRight = createFlow(true);\n\nmodule.exports = flowRight;\n","module.exports = require('./placeholder');\n","var mapping = require('./_mapping'),\n    fallbackHolder = require('./placeholder');\n\n/** Built-in value reference. */\nvar push = Array.prototype.push;\n\n/**\n * Creates a function, with an arity of `n`, that invokes `func` with the\n * arguments it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} n The arity of the new function.\n * @returns {Function} Returns the new function.\n */\nfunction baseArity(func, n) {\n  return n == 2\n    ? function(a, b) { return func.apply(undefined, arguments); }\n    : function(a) { return func.apply(undefined, arguments); };\n}\n\n/**\n * Creates a function that invokes `func`, with up to `n` arguments, ignoring\n * any additional arguments.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @param {number} n The arity cap.\n * @returns {Function} Returns the new function.\n */\nfunction baseAry(func, n) {\n  return n == 2\n    ? function(a, b) { return func(a, b); }\n    : function(a) { return func(a); };\n}\n\n/**\n * Creates a clone of `array`.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the cloned array.\n */\nfunction cloneArray(array) {\n  var length = array ? array.length : 0,\n      result = Array(length);\n\n  while (length--) {\n    result[length] = array[length];\n  }\n  return result;\n}\n\n/**\n * Creates a function that clones a given object using the assignment `func`.\n *\n * @private\n * @param {Function} func The assignment function.\n * @returns {Function} Returns the new cloner function.\n */\nfunction createCloner(func) {\n  return function(object) {\n    return func({}, object);\n  };\n}\n\n/**\n * A specialized version of `_.spread` which flattens the spread array into\n * the arguments of the invoked `func`.\n *\n * @private\n * @param {Function} func The function to spread arguments over.\n * @param {number} start The start position of the spread.\n * @returns {Function} Returns the new function.\n */\nfunction flatSpread(func, start) {\n  return function() {\n    var length = arguments.length,\n        lastIndex = length - 1,\n        args = Array(length);\n\n    while (length--) {\n      args[length] = arguments[length];\n    }\n    var array = args[start],\n        otherArgs = args.slice(0, start);\n\n    if (array) {\n      push.apply(otherArgs, array);\n    }\n    if (start != lastIndex) {\n      push.apply(otherArgs, args.slice(start + 1));\n    }\n    return func.apply(this, otherArgs);\n  };\n}\n\n/**\n * Creates a function that wraps `func` and uses `cloner` to clone the first\n * argument it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} cloner The function to clone arguments.\n * @returns {Function} Returns the new immutable function.\n */\nfunction wrapImmutable(func, cloner) {\n  return function() {\n    var length = arguments.length;\n    if (!length) {\n      return;\n    }\n    var args = Array(length);\n    while (length--) {\n      args[length] = arguments[length];\n    }\n    var result = args[0] = cloner.apply(undefined, args);\n    func.apply(undefined, args);\n    return result;\n  };\n}\n\n/**\n * The base implementation of `convert` which accepts a `util` object of methods\n * required to perform conversions.\n *\n * @param {Object} util The util object.\n * @param {string} name The name of the function to convert.\n * @param {Function} func The function to convert.\n * @param {Object} [options] The options object.\n * @param {boolean} [options.cap=true] Specify capping iteratee arguments.\n * @param {boolean} [options.curry=true] Specify currying.\n * @param {boolean} [options.fixed=true] Specify fixed arity.\n * @param {boolean} [options.immutable=true] Specify immutable operations.\n * @param {boolean} [options.rearg=true] Specify rearranging arguments.\n * @returns {Function|Object} Returns the converted function or object.\n */\nfunction baseConvert(util, name, func, options) {\n  var isLib = typeof name == 'function',\n      isObj = name === Object(name);\n\n  if (isObj) {\n    options = func;\n    func = name;\n    name = undefined;\n  }\n  if (func == null) {\n    throw new TypeError;\n  }\n  options || (options = {});\n\n  var config = {\n    'cap': 'cap' in options ? options.cap : true,\n    'curry': 'curry' in options ? options.curry : true,\n    'fixed': 'fixed' in options ? options.fixed : true,\n    'immutable': 'immutable' in options ? options.immutable : true,\n    'rearg': 'rearg' in options ? options.rearg : true\n  };\n\n  var defaultHolder = isLib ? func : fallbackHolder,\n      forceCurry = ('curry' in options) && options.curry,\n      forceFixed = ('fixed' in options) && options.fixed,\n      forceRearg = ('rearg' in options) && options.rearg,\n      pristine = isLib ? func.runInContext() : undefined;\n\n  var helpers = isLib ? func : {\n    'ary': util.ary,\n    'assign': util.assign,\n    'clone': util.clone,\n    'curry': util.curry,\n    'forEach': util.forEach,\n    'isArray': util.isArray,\n    'isError': util.isError,\n    'isFunction': util.isFunction,\n    'isWeakMap': util.isWeakMap,\n    'iteratee': util.iteratee,\n    'keys': util.keys,\n    'rearg': util.rearg,\n    'toInteger': util.toInteger,\n    'toPath': util.toPath\n  };\n\n  var ary = helpers.ary,\n      assign = helpers.assign,\n      clone = helpers.clone,\n      curry = helpers.curry,\n      each = helpers.forEach,\n      isArray = helpers.isArray,\n      isError = helpers.isError,\n      isFunction = helpers.isFunction,\n      isWeakMap = helpers.isWeakMap,\n      keys = helpers.keys,\n      rearg = helpers.rearg,\n      toInteger = helpers.toInteger,\n      toPath = helpers.toPath;\n\n  var aryMethodKeys = keys(mapping.aryMethod);\n\n  var wrappers = {\n    'castArray': function(castArray) {\n      return function() {\n        var value = arguments[0];\n        return isArray(value)\n          ? castArray(cloneArray(value))\n          : castArray.apply(undefined, arguments);\n      };\n    },\n    'iteratee': function(iteratee) {\n      return function() {\n        var func = arguments[0],\n            arity = arguments[1],\n            result = iteratee(func, arity),\n            length = result.length;\n\n        if (config.cap && typeof arity == 'number') {\n          arity = arity > 2 ? (arity - 2) : 1;\n          return (length && length <= arity) ? result : baseAry(result, arity);\n        }\n        return result;\n      };\n    },\n    'mixin': function(mixin) {\n      return function(source) {\n        var func = this;\n        if (!isFunction(func)) {\n          return mixin(func, Object(source));\n        }\n        var pairs = [];\n        each(keys(source), function(key) {\n          if (isFunction(source[key])) {\n            pairs.push([key, func.prototype[key]]);\n          }\n        });\n\n        mixin(func, Object(source));\n\n        each(pairs, function(pair) {\n          var value = pair[1];\n          if (isFunction(value)) {\n            func.prototype[pair[0]] = value;\n          } else {\n            delete func.prototype[pair[0]];\n          }\n        });\n        return func;\n      };\n    },\n    'nthArg': function(nthArg) {\n      return function(n) {\n        var arity = n < 0 ? 1 : (toInteger(n) + 1);\n        return curry(nthArg(n), arity);\n      };\n    },\n    'rearg': function(rearg) {\n      return function(func, indexes) {\n        var arity = indexes ? indexes.length : 0;\n        return curry(rearg(func, indexes), arity);\n      };\n    },\n    'runInContext': function(runInContext) {\n      return function(context) {\n        return baseConvert(util, runInContext(context), options);\n      };\n    }\n  };\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Casts `func` to a function with an arity capped iteratee if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @returns {Function} Returns the cast function.\n   */\n  function castCap(name, func) {\n    if (config.cap) {\n      var indexes = mapping.iterateeRearg[name];\n      if (indexes) {\n        return iterateeRearg(func, indexes);\n      }\n      var n = !isLib && mapping.iterateeAry[name];\n      if (n) {\n        return iterateeAry(func, n);\n      }\n    }\n    return func;\n  }\n\n  /**\n   * Casts `func` to a curried function if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @param {number} n The arity of `func`.\n   * @returns {Function} Returns the cast function.\n   */\n  function castCurry(name, func, n) {\n    return (forceCurry || (config.curry && n > 1))\n      ? curry(func, n)\n      : func;\n  }\n\n  /**\n   * Casts `func` to a fixed arity function if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @param {number} n The arity cap.\n   * @returns {Function} Returns the cast function.\n   */\n  function castFixed(name, func, n) {\n    if (config.fixed && (forceFixed || !mapping.skipFixed[name])) {\n      var data = mapping.methodSpread[name],\n          start = data && data.start;\n\n      return start  === undefined ? ary(func, n) : flatSpread(func, start);\n    }\n    return func;\n  }\n\n  /**\n   * Casts `func` to an rearged function if needed.\n   *\n   * @private\n   * @param {string} name The name of the function to inspect.\n   * @param {Function} func The function to inspect.\n   * @param {number} n The arity of `func`.\n   * @returns {Function} Returns the cast function.\n   */\n  function castRearg(name, func, n) {\n    return (config.rearg && n > 1 && (forceRearg || !mapping.skipRearg[name]))\n      ? rearg(func, mapping.methodRearg[name] || mapping.aryRearg[n])\n      : func;\n  }\n\n  /**\n   * Creates a clone of `object` by `path`.\n   *\n   * @private\n   * @param {Object} object The object to clone.\n   * @param {Array|string} path The path to clone by.\n   * @returns {Object} Returns the cloned object.\n   */\n  function cloneByPath(object, path) {\n    path = toPath(path);\n\n    var index = -1,\n        length = path.length,\n        lastIndex = length - 1,\n        result = clone(Object(object)),\n        nested = result;\n\n    while (nested != null && ++index < length) {\n      var key = path[index],\n          value = nested[key];\n\n      if (value != null &&\n          !(isFunction(value) || isError(value) || isWeakMap(value))) {\n        nested[key] = clone(index == lastIndex ? value : Object(value));\n      }\n      nested = nested[key];\n    }\n    return result;\n  }\n\n  /**\n   * Converts `lodash` to an immutable auto-curried iteratee-first data-last\n   * version with conversion `options` applied.\n   *\n   * @param {Object} [options] The options object. See `baseConvert` for more details.\n   * @returns {Function} Returns the converted `lodash`.\n   */\n  function convertLib(options) {\n    return _.runInContext.convert(options)(undefined);\n  }\n\n  /**\n   * Create a converter function for `func` of `name`.\n   *\n   * @param {string} name The name of the function to convert.\n   * @param {Function} func The function to convert.\n   * @returns {Function} Returns the new converter function.\n   */\n  function createConverter(name, func) {\n    var realName = mapping.aliasToReal[name] || name,\n        methodName = mapping.remap[realName] || realName,\n        oldOptions = options;\n\n    return function(options) {\n      var newUtil = isLib ? pristine : helpers,\n          newFunc = isLib ? pristine[methodName] : func,\n          newOptions = assign(assign({}, oldOptions), options);\n\n      return baseConvert(newUtil, realName, newFunc, newOptions);\n    };\n  }\n\n  /**\n   * Creates a function that wraps `func` to invoke its iteratee, with up to `n`\n   * arguments, ignoring any additional arguments.\n   *\n   * @private\n   * @param {Function} func The function to cap iteratee arguments for.\n   * @param {number} n The arity cap.\n   * @returns {Function} Returns the new function.\n   */\n  function iterateeAry(func, n) {\n    return overArg(func, function(func) {\n      return typeof func == 'function' ? baseAry(func, n) : func;\n    });\n  }\n\n  /**\n   * Creates a function that wraps `func` to invoke its iteratee with arguments\n   * arranged according to the specified `indexes` where the argument value at\n   * the first index is provided as the first argument, the argument value at\n   * the second index is provided as the second argument, and so on.\n   *\n   * @private\n   * @param {Function} func The function to rearrange iteratee arguments for.\n   * @param {number[]} indexes The arranged argument indexes.\n   * @returns {Function} Returns the new function.\n   */\n  function iterateeRearg(func, indexes) {\n    return overArg(func, function(func) {\n      var n = indexes.length;\n      return baseArity(rearg(baseAry(func, n), indexes), n);\n    });\n  }\n\n  /**\n   * Creates a function that invokes `func` with its first argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function() {\n      var length = arguments.length;\n      if (!length) {\n        return func();\n      }\n      var args = Array(length);\n      while (length--) {\n        args[length] = arguments[length];\n      }\n      var index = config.rearg ? 0 : (length - 1);\n      args[index] = transform(args[index]);\n      return func.apply(undefined, args);\n    };\n  }\n\n  /**\n   * Creates a function that wraps `func` and applys the conversions\n   * rules by `name`.\n   *\n   * @private\n   * @param {string} name The name of the function to wrap.\n   * @param {Function} func The function to wrap.\n   * @returns {Function} Returns the converted function.\n   */\n  function wrap(name, func, placeholder) {\n    var result,\n        realName = mapping.aliasToReal[name] || name,\n        wrapped = func,\n        wrapper = wrappers[realName];\n\n    if (wrapper) {\n      wrapped = wrapper(func);\n    }\n    else if (config.immutable) {\n      if (mapping.mutate.array[realName]) {\n        wrapped = wrapImmutable(func, cloneArray);\n      }\n      else if (mapping.mutate.object[realName]) {\n        wrapped = wrapImmutable(func, createCloner(func));\n      }\n      else if (mapping.mutate.set[realName]) {\n        wrapped = wrapImmutable(func, cloneByPath);\n      }\n    }\n    each(aryMethodKeys, function(aryKey) {\n      each(mapping.aryMethod[aryKey], function(otherName) {\n        if (realName == otherName) {\n          var data = mapping.methodSpread[realName],\n              afterRearg = data && data.afterRearg;\n\n          result = afterRearg\n            ? castFixed(realName, castRearg(realName, wrapped, aryKey), aryKey)\n            : castRearg(realName, castFixed(realName, wrapped, aryKey), aryKey);\n\n          result = castCap(realName, result);\n          result = castCurry(realName, result, aryKey);\n          return false;\n        }\n      });\n      return !result;\n    });\n\n    result || (result = wrapped);\n    if (result == func) {\n      result = forceCurry ? curry(result, 1) : function() {\n        return func.apply(this, arguments);\n      };\n    }\n    result.convert = createConverter(realName, func);\n    result.placeholder = func.placeholder = placeholder;\n\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  if (!isObj) {\n    return wrap(name, func, defaultHolder);\n  }\n  var _ = func;\n\n  // Convert methods by ary cap.\n  var pairs = [];\n  each(aryMethodKeys, function(aryKey) {\n    each(mapping.aryMethod[aryKey], function(key) {\n      var func = _[mapping.remap[key] || key];\n      if (func) {\n        pairs.push([key, wrap(key, func, _)]);\n      }\n    });\n  });\n\n  // Convert remaining methods.\n  each(keys(_), function(key) {\n    var func = _[key];\n    if (typeof func == 'function') {\n      var length = pairs.length;\n      while (length--) {\n        if (pairs[length][0] == key) {\n          return;\n        }\n      }\n      func.convert = createConverter(key, func);\n      pairs.push([key, func]);\n    }\n  });\n\n  // Assign to `_` leaving `_.prototype` unchanged to allow chaining.\n  each(pairs, function(pair) {\n    _[pair[0]] = pair[1];\n  });\n\n  _.convert = convertLib;\n  _.placeholder = _;\n\n  // Assign aliases.\n  each(keys(_), function(key) {\n    each(mapping.realToAlias[key] || [], function(alias) {\n      _[alias] = _[key];\n    });\n  });\n\n  return _;\n}\n\nmodule.exports = baseConvert;\n","module.exports = {\n  'cap': false,\n  'curry': false,\n  'fixed': false,\n  'immutable': false,\n  'rearg': false\n};\n","/** Used to map aliases to their real names. */\nexports.aliasToReal = {\n\n  // Lodash aliases.\n  'each': 'forEach',\n  'eachRight': 'forEachRight',\n  'entries': 'toPairs',\n  'entriesIn': 'toPairsIn',\n  'extend': 'assignIn',\n  'extendAll': 'assignInAll',\n  'extendAllWith': 'assignInAllWith',\n  'extendWith': 'assignInWith',\n  'first': 'head',\n\n  // Methods that are curried variants of others.\n  'conforms': 'conformsTo',\n  'matches': 'isMatch',\n  'property': 'get',\n\n  // Ramda aliases.\n  '__': 'placeholder',\n  'F': 'stubFalse',\n  'T': 'stubTrue',\n  'all': 'every',\n  'allPass': 'overEvery',\n  'always': 'constant',\n  'any': 'some',\n  'anyPass': 'overSome',\n  'apply': 'spread',\n  'assoc': 'set',\n  'assocPath': 'set',\n  'complement': 'negate',\n  'compose': 'flowRight',\n  'contains': 'includes',\n  'dissoc': 'unset',\n  'dissocPath': 'unset',\n  'dropLast': 'dropRight',\n  'dropLastWhile': 'dropRightWhile',\n  'equals': 'isEqual',\n  'identical': 'eq',\n  'indexBy': 'keyBy',\n  'init': 'initial',\n  'invertObj': 'invert',\n  'juxt': 'over',\n  'omitAll': 'omit',\n  'nAry': 'ary',\n  'path': 'get',\n  'pathEq': 'matchesProperty',\n  'pathOr': 'getOr',\n  'paths': 'at',\n  'pickAll': 'pick',\n  'pipe': 'flow',\n  'pluck': 'map',\n  'prop': 'get',\n  'propEq': 'matchesProperty',\n  'propOr': 'getOr',\n  'props': 'at',\n  'symmetricDifference': 'xor',\n  'symmetricDifferenceBy': 'xorBy',\n  'symmetricDifferenceWith': 'xorWith',\n  'takeLast': 'takeRight',\n  'takeLastWhile': 'takeRightWhile',\n  'unapply': 'rest',\n  'unnest': 'flatten',\n  'useWith': 'overArgs',\n  'where': 'conformsTo',\n  'whereEq': 'isMatch',\n  'zipObj': 'zipObject'\n};\n\n/** Used to map ary to method names. */\nexports.aryMethod = {\n  '1': [\n    'assignAll', 'assignInAll', 'attempt', 'castArray', 'ceil', 'create',\n    'curry', 'curryRight', 'defaultsAll', 'defaultsDeepAll', 'floor', 'flow',\n    'flowRight', 'fromPairs', 'invert', 'iteratee', 'memoize', 'method', 'mergeAll',\n    'methodOf', 'mixin', 'nthArg', 'over', 'overEvery', 'overSome','rest', 'reverse',\n    'round', 'runInContext', 'spread', 'template', 'trim', 'trimEnd', 'trimStart',\n    'uniqueId', 'words', 'zipAll'\n  ],\n  '2': [\n    'add', 'after', 'ary', 'assign', 'assignAllWith', 'assignIn', 'assignInAllWith',\n    'at', 'before', 'bind', 'bindAll', 'bindKey', 'chunk', 'cloneDeepWith',\n    'cloneWith', 'concat', 'conformsTo', 'countBy', 'curryN', 'curryRightN',\n    'debounce', 'defaults', 'defaultsDeep', 'defaultTo', 'delay', 'difference',\n    'divide', 'drop', 'dropRight', 'dropRightWhile', 'dropWhile', 'endsWith', 'eq',\n    'every', 'filter', 'find', 'findIndex', 'findKey', 'findLast', 'findLastIndex',\n    'findLastKey', 'flatMap', 'flatMapDeep', 'flattenDepth', 'forEach',\n    'forEachRight', 'forIn', 'forInRight', 'forOwn', 'forOwnRight', 'get',\n    'groupBy', 'gt', 'gte', 'has', 'hasIn', 'includes', 'indexOf', 'intersection',\n    'invertBy', 'invoke', 'invokeMap', 'isEqual', 'isMatch', 'join', 'keyBy',\n    'lastIndexOf', 'lt', 'lte', 'map', 'mapKeys', 'mapValues', 'matchesProperty',\n    'maxBy', 'meanBy', 'merge', 'mergeAllWith', 'minBy', 'multiply', 'nth', 'omit',\n    'omitBy', 'overArgs', 'pad', 'padEnd', 'padStart', 'parseInt', 'partial',\n    'partialRight', 'partition', 'pick', 'pickBy', 'propertyOf', 'pull', 'pullAll',\n    'pullAt', 'random', 'range', 'rangeRight', 'rearg', 'reject', 'remove',\n    'repeat', 'restFrom', 'result', 'sampleSize', 'some', 'sortBy', 'sortedIndex',\n    'sortedIndexOf', 'sortedLastIndex', 'sortedLastIndexOf', 'sortedUniqBy',\n    'split', 'spreadFrom', 'startsWith', 'subtract', 'sumBy', 'take', 'takeRight',\n    'takeRightWhile', 'takeWhile', 'tap', 'throttle', 'thru', 'times', 'trimChars',\n    'trimCharsEnd', 'trimCharsStart', 'truncate', 'union', 'uniqBy', 'uniqWith',\n    'unset', 'unzipWith', 'without', 'wrap', 'xor', 'zip', 'zipObject',\n    'zipObjectDeep'\n  ],\n  '3': [\n    'assignInWith', 'assignWith', 'clamp', 'differenceBy', 'differenceWith',\n    'findFrom', 'findIndexFrom', 'findLastFrom', 'findLastIndexFrom', 'getOr',\n    'includesFrom', 'indexOfFrom', 'inRange', 'intersectionBy', 'intersectionWith',\n    'invokeArgs', 'invokeArgsMap', 'isEqualWith', 'isMatchWith', 'flatMapDepth',\n    'lastIndexOfFrom', 'mergeWith', 'orderBy', 'padChars', 'padCharsEnd',\n    'padCharsStart', 'pullAllBy', 'pullAllWith', 'rangeStep', 'rangeStepRight',\n    'reduce', 'reduceRight', 'replace', 'set', 'slice', 'sortedIndexBy',\n    'sortedLastIndexBy', 'transform', 'unionBy', 'unionWith', 'update', 'xorBy',\n    'xorWith', 'zipWith'\n  ],\n  '4': [\n    'fill', 'setWith', 'updateWith'\n  ]\n};\n\n/** Used to map ary to rearg configs. */\nexports.aryRearg = {\n  '2': [1, 0],\n  '3': [2, 0, 1],\n  '4': [3, 2, 0, 1]\n};\n\n/** Used to map method names to their iteratee ary. */\nexports.iterateeAry = {\n  'dropRightWhile': 1,\n  'dropWhile': 1,\n  'every': 1,\n  'filter': 1,\n  'find': 1,\n  'findFrom': 1,\n  'findIndex': 1,\n  'findIndexFrom': 1,\n  'findKey': 1,\n  'findLast': 1,\n  'findLastFrom': 1,\n  'findLastIndex': 1,\n  'findLastIndexFrom': 1,\n  'findLastKey': 1,\n  'flatMap': 1,\n  'flatMapDeep': 1,\n  'flatMapDepth': 1,\n  'forEach': 1,\n  'forEachRight': 1,\n  'forIn': 1,\n  'forInRight': 1,\n  'forOwn': 1,\n  'forOwnRight': 1,\n  'map': 1,\n  'mapKeys': 1,\n  'mapValues': 1,\n  'partition': 1,\n  'reduce': 2,\n  'reduceRight': 2,\n  'reject': 1,\n  'remove': 1,\n  'some': 1,\n  'takeRightWhile': 1,\n  'takeWhile': 1,\n  'times': 1,\n  'transform': 2\n};\n\n/** Used to map method names to iteratee rearg configs. */\nexports.iterateeRearg = {\n  'mapKeys': [1],\n  'reduceRight': [1, 0]\n};\n\n/** Used to map method names to rearg configs. */\nexports.methodRearg = {\n  'assignInAllWith': [1, 0],\n  'assignInWith': [1, 2, 0],\n  'assignAllWith': [1, 0],\n  'assignWith': [1, 2, 0],\n  'differenceBy': [1, 2, 0],\n  'differenceWith': [1, 2, 0],\n  'getOr': [2, 1, 0],\n  'intersectionBy': [1, 2, 0],\n  'intersectionWith': [1, 2, 0],\n  'isEqualWith': [1, 2, 0],\n  'isMatchWith': [2, 1, 0],\n  'mergeAllWith': [1, 0],\n  'mergeWith': [1, 2, 0],\n  'padChars': [2, 1, 0],\n  'padCharsEnd': [2, 1, 0],\n  'padCharsStart': [2, 1, 0],\n  'pullAllBy': [2, 1, 0],\n  'pullAllWith': [2, 1, 0],\n  'rangeStep': [1, 2, 0],\n  'rangeStepRight': [1, 2, 0],\n  'setWith': [3, 1, 2, 0],\n  'sortedIndexBy': [2, 1, 0],\n  'sortedLastIndexBy': [2, 1, 0],\n  'unionBy': [1, 2, 0],\n  'unionWith': [1, 2, 0],\n  'updateWith': [3, 1, 2, 0],\n  'xorBy': [1, 2, 0],\n  'xorWith': [1, 2, 0],\n  'zipWith': [1, 2, 0]\n};\n\n/** Used to map method names to spread configs. */\nexports.methodSpread = {\n  'assignAll': { 'start': 0 },\n  'assignAllWith': { 'start': 0 },\n  'assignInAll': { 'start': 0 },\n  'assignInAllWith': { 'start': 0 },\n  'defaultsAll': { 'start': 0 },\n  'defaultsDeepAll': { 'start': 0 },\n  'invokeArgs': { 'start': 2 },\n  'invokeArgsMap': { 'start': 2 },\n  'mergeAll': { 'start': 0 },\n  'mergeAllWith': { 'start': 0 },\n  'partial': { 'start': 1 },\n  'partialRight': { 'start': 1 },\n  'without': { 'start': 1 },\n  'zipAll': { 'start': 0 }\n};\n\n/** Used to identify methods which mutate arrays or objects. */\nexports.mutate = {\n  'array': {\n    'fill': true,\n    'pull': true,\n    'pullAll': true,\n    'pullAllBy': true,\n    'pullAllWith': true,\n    'pullAt': true,\n    'remove': true,\n    'reverse': true\n  },\n  'object': {\n    'assign': true,\n    'assignAll': true,\n    'assignAllWith': true,\n    'assignIn': true,\n    'assignInAll': true,\n    'assignInAllWith': true,\n    'assignInWith': true,\n    'assignWith': true,\n    'defaults': true,\n    'defaultsAll': true,\n    'defaultsDeep': true,\n    'defaultsDeepAll': true,\n    'merge': true,\n    'mergeAll': true,\n    'mergeAllWith': true,\n    'mergeWith': true,\n  },\n  'set': {\n    'set': true,\n    'setWith': true,\n    'unset': true,\n    'update': true,\n    'updateWith': true\n  }\n};\n\n/** Used to map real names to their aliases. */\nexports.realToAlias = (function() {\n  var hasOwnProperty = Object.prototype.hasOwnProperty,\n      object = exports.aliasToReal,\n      result = {};\n\n  for (var key in object) {\n    var value = object[key];\n    if (hasOwnProperty.call(result, value)) {\n      result[value].push(key);\n    } else {\n      result[value] = [key];\n    }\n  }\n  return result;\n}());\n\n/** Used to map method names to other names. */\nexports.remap = {\n  'assignAll': 'assign',\n  'assignAllWith': 'assignWith',\n  'assignInAll': 'assignIn',\n  'assignInAllWith': 'assignInWith',\n  'curryN': 'curry',\n  'curryRightN': 'curryRight',\n  'defaultsAll': 'defaults',\n  'defaultsDeepAll': 'defaultsDeep',\n  'findFrom': 'find',\n  'findIndexFrom': 'findIndex',\n  'findLastFrom': 'findLast',\n  'findLastIndexFrom': 'findLastIndex',\n  'getOr': 'get',\n  'includesFrom': 'includes',\n  'indexOfFrom': 'indexOf',\n  'invokeArgs': 'invoke',\n  'invokeArgsMap': 'invokeMap',\n  'lastIndexOfFrom': 'lastIndexOf',\n  'mergeAll': 'merge',\n  'mergeAllWith': 'mergeWith',\n  'padChars': 'pad',\n  'padCharsEnd': 'padEnd',\n  'padCharsStart': 'padStart',\n  'propertyOf': 'get',\n  'rangeStep': 'range',\n  'rangeStepRight': 'rangeRight',\n  'restFrom': 'rest',\n  'spreadFrom': 'spread',\n  'trimChars': 'trim',\n  'trimCharsEnd': 'trimEnd',\n  'trimCharsStart': 'trimStart',\n  'zipAll': 'zip'\n};\n\n/** Used to track methods that skip fixing their arity. */\nexports.skipFixed = {\n  'castArray': true,\n  'flow': true,\n  'flowRight': true,\n  'iteratee': true,\n  'mixin': true,\n  'rearg': true,\n  'runInContext': true\n};\n\n/** Used to track methods that skip rearranging arguments. */\nexports.skipRearg = {\n  'add': true,\n  'assign': true,\n  'assignIn': true,\n  'bind': true,\n  'bindKey': true,\n  'concat': true,\n  'difference': true,\n  'divide': true,\n  'eq': true,\n  'gt': true,\n  'gte': true,\n  'isEqual': true,\n  'lt': true,\n  'lte': true,\n  'matchesProperty': true,\n  'merge': true,\n  'multiply': true,\n  'overArgs': true,\n  'partial': true,\n  'partialRight': true,\n  'propertyOf': true,\n  'random': true,\n  'range': true,\n  'rangeRight': true,\n  'subtract': true,\n  'zip': true,\n  'zipObject': true,\n  'zipObjectDeep': true\n};\n","module.exports = {\n  'ary': require('../ary'),\n  'assign': require('../_baseAssign'),\n  'clone': require('../clone'),\n  'curry': require('../curry'),\n  'forEach': require('../_arrayEach'),\n  'isArray': require('../isArray'),\n  'isError': require('../isError'),\n  'isFunction': require('../isFunction'),\n  'isWeakMap': require('../isWeakMap'),\n  'iteratee': require('../iteratee'),\n  'keys': require('../_baseKeys'),\n  'rearg': require('../rearg'),\n  'toInteger': require('../toInteger'),\n  'toPath': require('../toPath')\n};\n","var convert = require('./convert'),\n    func = convert('add', require('../add'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('cloneDeep', require('../cloneDeep'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","module.exports = require('./flowRight');\n","var convert = require('./convert'),\n    func = convert('concat', require('../concat'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","module.exports = require('./includes');\n","var baseConvert = require('./_baseConvert'),\n    util = require('./_util');\n\n/**\n * Converts `func` of `name` to an immutable auto-curried iteratee-first data-last\n * version with conversion `options` applied. If `name` is an object its methods\n * will be converted.\n *\n * @param {string} name The name of the function to wrap.\n * @param {Function} [func] The function to wrap.\n * @param {Object} [options] The options object. See `baseConvert` for more details.\n * @returns {Function|Object} Returns the converted function or object.\n */\nfunction convert(name, func, options) {\n  return baseConvert(util, name, func, options);\n}\n\nmodule.exports = convert;\n","var convert = require('./convert'),\n    func = convert('debounce', require('../debounce'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('defaults', require('../defaults'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('defaultsDeep', require('../defaultsDeep'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('difference', require('../difference'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('find', require('../find'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('flatMap', require('../flatMap'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('flowRight', require('../flowRight'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('has', require('../has'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('includes', require('../includes'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isArray', require('../isArray'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isElement', require('../isElement'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isEmpty', require('../isEmpty'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isEqual', require('../isEqual'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isFunction', require('../isFunction'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isNil', require('../isNil'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isNull', require('../isNull'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isNumber', require('../isNumber'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isPlainObject', require('../isPlainObject'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isString', require('../isString'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('isUndefined', require('../isUndefined'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('join', require('../join'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('map', require('../map'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('merge', require('../merge'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('mergeAllWith', require('../mergeWith'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('omit', require('../omit'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('partial', require('../partial'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","/**\n * The default argument placeholder value for methods.\n *\n * @type {Object}\n */\nmodule.exports = {};\n","var convert = require('./convert'),\n    func = convert('remove', require('../remove'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('reverse', require('../reverse'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('sortBy', require('../sortBy'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('trimCharsStart', require('../trimStart'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('trimEnd', require('../trimEnd'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('union', require('../union'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('unionBy', require('../unionBy'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('unionWith', require('../unionWith'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('unset', require('../unset'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('update', require('../update'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('values', require('../values'), require('./_falseOptions'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var convert = require('./convert'),\n    func = convert('without', require('../without'));\n\nfunc.placeholder = require('./placeholder');\nmodule.exports = func;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var baseHas = require('./_baseHas'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct property of `object`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = { 'a': { 'b': 2 } };\n * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.has(object, 'a');\n * // => true\n *\n * _.has(object, 'a.b');\n * // => true\n *\n * _.has(object, ['a', 'b']);\n * // => true\n *\n * _.has(other, 'a');\n * // => false\n */\nfunction has(object, path) {\n  return object != null && hasPath(object, path, baseHas);\n}\n\nmodule.exports = has;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseIndexOf = require('./_baseIndexOf'),\n    isArrayLike = require('./isArrayLike'),\n    isString = require('./isString'),\n    toInteger = require('./toInteger'),\n    values = require('./values');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Checks if `value` is in `collection`. If `collection` is a string, it's\n * checked for a substring of `value`, otherwise\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * is used for equality comparisons. If `fromIndex` is negative, it's used as\n * the offset from the end of `collection`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object|string} collection The collection to inspect.\n * @param {*} value The value to search for.\n * @param {number} [fromIndex=0] The index to search from.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {boolean} Returns `true` if `value` is found, else `false`.\n * @example\n *\n * _.includes([1, 2, 3], 1);\n * // => true\n *\n * _.includes([1, 2, 3], 1, 2);\n * // => false\n *\n * _.includes({ 'a': 1, 'b': 2 }, 1);\n * // => true\n *\n * _.includes('abcd', 'bc');\n * // => true\n */\nfunction includes(collection, value, fromIndex, guard) {\n  collection = isArrayLike(collection) ? collection : values(collection);\n  fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n  var length = collection.length;\n  if (fromIndex < 0) {\n    fromIndex = nativeMax(length + fromIndex, 0);\n  }\n  return isString(collection)\n    ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n    : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n}\n\nmodule.exports = includes;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var isObjectLike = require('./isObjectLike'),\n    isPlainObject = require('./isPlainObject');\n\n/**\n * Checks if `value` is likely a DOM element.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.\n * @example\n *\n * _.isElement(document.body);\n * // => true\n *\n * _.isElement('<body>');\n * // => false\n */\nfunction isElement(value) {\n  return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);\n}\n\nmodule.exports = isElement;\n","var baseKeys = require('./_baseKeys'),\n    getTag = require('./_getTag'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLike = require('./isArrayLike'),\n    isBuffer = require('./isBuffer'),\n    isPrototype = require('./_isPrototype'),\n    isTypedArray = require('./isTypedArray');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = isEmpty;\n","var baseIsEqual = require('./_baseIsEqual');\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nmodule.exports = isEqual;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike'),\n    isPlainObject = require('./isPlainObject');\n\n/** `Object#toString` result references. */\nvar domExcTag = '[object DOMException]',\n    errorTag = '[object Error]';\n\n/**\n * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n * `SyntaxError`, `TypeError`, or `URIError` object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n * @example\n *\n * _.isError(new Error);\n * // => true\n *\n * _.isError(Error);\n * // => false\n */\nfunction isError(value) {\n  if (!isObjectLike(value)) {\n    return false;\n  }\n  var tag = baseGetTag(value);\n  return tag == errorTag || tag == domExcTag ||\n    (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n}\n\nmodule.exports = isError;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var baseIsMap = require('./_baseIsMap'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nmodule.exports = isMap;\n","/**\n * Checks if `value` is `null` or `undefined`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n * @example\n *\n * _.isNil(null);\n * // => true\n *\n * _.isNil(void 0);\n * // => true\n *\n * _.isNil(NaN);\n * // => false\n */\nfunction isNil(value) {\n  return value == null;\n}\n\nmodule.exports = isNil;\n","/**\n * Checks if `value` is `null`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n * @example\n *\n * _.isNull(null);\n * // => true\n *\n * _.isNull(void 0);\n * // => false\n */\nfunction isNull(value) {\n  return value === null;\n}\n\nmodule.exports = isNull;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var baseIsSet = require('./_baseIsSet'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nmodule.exports = isSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nmodule.exports = isString;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nmodule.exports = isUndefined;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar weakMapTag = '[object WeakMap]';\n\n/**\n * Checks if `value` is classified as a `WeakMap` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.\n * @example\n *\n * _.isWeakMap(new WeakMap);\n * // => true\n *\n * _.isWeakMap(new Map);\n * // => false\n */\nfunction isWeakMap(value) {\n  return isObjectLike(value) && getTag(value) == weakMapTag;\n}\n\nmodule.exports = isWeakMap;\n","var baseClone = require('./_baseClone'),\n    baseIteratee = require('./_baseIteratee');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1;\n\n/**\n * Creates a function that invokes `func` with the arguments of the created\n * function. If `func` is a property name, the created function returns the\n * property value for a given element. If `func` is an array or object, the\n * created function returns `true` for elements that contain the equivalent\n * source properties, otherwise it returns `false`.\n *\n * @static\n * @since 4.0.0\n * @memberOf _\n * @category Util\n * @param {*} [func=_.identity] The value to convert to a callback.\n * @returns {Function} Returns the callback.\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': true },\n *   { 'user': 'fred',   'age': 40, 'active': false }\n * ];\n *\n * // The `_.matches` iteratee shorthand.\n * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));\n * // => [{ 'user': 'barney', 'age': 36, 'active': true }]\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.filter(users, _.iteratee(['user', 'fred']));\n * // => [{ 'user': 'fred', 'age': 40 }]\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, _.iteratee('user'));\n * // => ['barney', 'fred']\n *\n * // Create custom iteratee shorthands.\n * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {\n *   return !_.isRegExp(func) ? iteratee(func) : function(string) {\n *     return func.test(string);\n *   };\n * });\n *\n * _.filter(['abc', 'def'], /ef/);\n * // => ['def']\n */\nfunction iteratee(func) {\n  return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));\n}\n\nmodule.exports = iteratee;\n","/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeJoin = arrayProto.join;\n\n/**\n * Converts all elements in `array` into a string separated by `separator`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to convert.\n * @param {string} [separator=','] The element separator.\n * @returns {string} Returns the joined string.\n * @example\n *\n * _.join(['a', 'b', 'c'], '~');\n * // => 'a~b~c'\n */\nfunction join(array, separator) {\n  return array == null ? '' : nativeJoin.call(array, separator);\n}\n\nmodule.exports = join;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nmodule.exports = last;\n","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseMerge = require('./_baseMerge'),\n    createAssigner = require('./_createAssigner');\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nmodule.exports = merge;\n","var baseMerge = require('./_baseMerge'),\n    createAssigner = require('./_createAssigner');\n\n/**\n * This method is like `_.merge` except that it accepts `customizer` which\n * is invoked to produce the merged values of the destination and source\n * properties. If `customizer` returns `undefined`, merging is handled by the\n * method instead. The `customizer` is invoked with six arguments:\n * (objValue, srcValue, key, object, source, stack).\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} sources The source objects.\n * @param {Function} customizer The function to customize assigned values.\n * @returns {Object} Returns `object`.\n * @example\n *\n * function customizer(objValue, srcValue) {\n *   if (_.isArray(objValue)) {\n *     return objValue.concat(srcValue);\n *   }\n * }\n *\n * var object = { 'a': [1], 'b': [2] };\n * var other = { 'a': [3], 'b': [4] };\n *\n * _.mergeWith(object, other, customizer);\n * // => { 'a': [1, 3], 'b': [2, 4] }\n */\nvar mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n  baseMerge(object, source, srcIndex, customizer);\n});\n\nmodule.exports = mergeWith;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","var arrayMap = require('./_arrayMap'),\n    baseClone = require('./_baseClone'),\n    baseUnset = require('./_baseUnset'),\n    castPath = require('./_castPath'),\n    copyObject = require('./_copyObject'),\n    customOmitClone = require('./_customOmitClone'),\n    flatRest = require('./_flatRest'),\n    getAllKeysIn = require('./_getAllKeysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * The opposite of `_.pick`; this method creates an object composed of the\n * own and inherited enumerable property paths of `object` that are not omitted.\n *\n * **Note:** This method is considerably slower than `_.pick`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [paths] The property paths to omit.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.omit(object, ['a', 'c']);\n * // => { 'b': '2' }\n */\nvar omit = flatRest(function(object, paths) {\n  var result = {};\n  if (object == null) {\n    return result;\n  }\n  var isDeep = false;\n  paths = arrayMap(paths, function(path) {\n    path = castPath(path, object);\n    isDeep || (isDeep = path.length > 1);\n    return path;\n  });\n  copyObject(object, getAllKeysIn(object), result);\n  if (isDeep) {\n    result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n  }\n  var length = paths.length;\n  while (length--) {\n    baseUnset(result, paths[length]);\n  }\n  return result;\n});\n\nmodule.exports = omit;\n","var baseRest = require('./_baseRest'),\n    createWrap = require('./_createWrap'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_PARTIAL_FLAG = 32;\n\n/**\n * Creates a function that invokes `func` with `partials` prepended to the\n * arguments it receives. This method is like `_.bind` except it does **not**\n * alter the `this` binding.\n *\n * The `_.partial.placeholder` value, which defaults to `_` in monolithic\n * builds, may be used as a placeholder for partially applied arguments.\n *\n * **Note:** This method doesn't set the \"length\" property of partially\n * applied functions.\n *\n * @static\n * @memberOf _\n * @since 0.2.0\n * @category Function\n * @param {Function} func The function to partially apply arguments to.\n * @param {...*} [partials] The arguments to be partially applied.\n * @returns {Function} Returns the new partially applied function.\n * @example\n *\n * function greet(greeting, name) {\n *   return greeting + ' ' + name;\n * }\n *\n * var sayHelloTo = _.partial(greet, 'hello');\n * sayHelloTo('fred');\n * // => 'hello fred'\n *\n * // Partially applied with placeholders.\n * var greetFred = _.partial(greet, _, 'fred');\n * greetFred('hi');\n * // => 'hi fred'\n */\nvar partial = baseRest(function(func, partials) {\n  var holders = replaceHolders(partials, getHolder(partial));\n  return createWrap(func, WRAP_PARTIAL_FLAG, undefined, partials, holders);\n});\n\n// Assign default placeholders.\npartial.placeholder = {};\n\nmodule.exports = partial;\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","var createWrap = require('./_createWrap'),\n    flatRest = require('./_flatRest');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_REARG_FLAG = 256;\n\n/**\n * Creates a function that invokes `func` with arguments arranged according\n * to the specified `indexes` where the argument value at the first index is\n * provided as the first argument, the argument value at the second index is\n * provided as the second argument, and so on.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {Function} func The function to rearrange arguments for.\n * @param {...(number|number[])} indexes The arranged argument indexes.\n * @returns {Function} Returns the new function.\n * @example\n *\n * var rearged = _.rearg(function(a, b, c) {\n *   return [a, b, c];\n * }, [2, 0, 1]);\n *\n * rearged('b', 'c', 'a')\n * // => ['a', 'b', 'c']\n */\nvar rearg = flatRest(function(func, indexes) {\n  return createWrap(func, WRAP_REARG_FLAG, undefined, undefined, undefined, indexes);\n});\n\nmodule.exports = rearg;\n","var baseIteratee = require('./_baseIteratee'),\n    basePullAt = require('./_basePullAt');\n\n/**\n * Removes all elements from `array` that `predicate` returns truthy for\n * and returns an array of the removed elements. The predicate is invoked\n * with three arguments: (value, index, array).\n *\n * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n * to pull elements from an array by value.\n *\n * @static\n * @memberOf _\n * @since 2.0.0\n * @category Array\n * @param {Array} array The array to modify.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new array of removed elements.\n * @example\n *\n * var array = [1, 2, 3, 4];\n * var evens = _.remove(array, function(n) {\n *   return n % 2 == 0;\n * });\n *\n * console.log(array);\n * // => [1, 3]\n *\n * console.log(evens);\n * // => [2, 4]\n */\nfunction remove(array, predicate) {\n  var result = [];\n  if (!(array && array.length)) {\n    return result;\n  }\n  var index = -1,\n      indexes = [],\n      length = array.length;\n\n  predicate = baseIteratee(predicate, 3);\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result.push(value);\n      indexes.push(index);\n    }\n  }\n  basePullAt(array, indexes);\n  return result;\n}\n\nmodule.exports = remove;\n","/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeReverse = arrayProto.reverse;\n\n/**\n * Reverses `array` so that the first element becomes the last, the second\n * element becomes the second to last, and so on.\n *\n * **Note:** This method mutates `array` and is based on\n * [`Array#reverse`](https://mdn.io/Array/reverse).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to modify.\n * @returns {Array} Returns `array`.\n * @example\n *\n * var array = [1, 2, 3];\n *\n * _.reverse(array);\n * // => [3, 2, 1]\n *\n * console.log(array);\n * // => [3, 2, 1]\n */\nfunction reverse(array) {\n  return array == null ? array : nativeReverse.call(array);\n}\n\nmodule.exports = reverse;\n","var baseFlatten = require('./_baseFlatten'),\n    baseOrderBy = require('./_baseOrderBy'),\n    baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates an array of elements, sorted in ascending order by the results of\n * running each element in a collection thru each iteratee. This method\n * performs a stable sort, that is, it preserves the original sort order of\n * equal elements. The iteratees are invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {...(Function|Function[])} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 36 },\n *   { 'user': 'fred',   'age': 30 },\n *   { 'user': 'barney', 'age': 34 }\n * ];\n *\n * _.sortBy(users, [function(o) { return o.user; }]);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n *\n * _.sortBy(users, ['user', 'age']);\n * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n */\nvar sortBy = baseRest(function(collection, iteratees) {\n  if (collection == null) {\n    return [];\n  }\n  var length = iteratees.length;\n  if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n    iteratees = [];\n  } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n    iteratees = [iteratees[0]];\n  }\n  return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n});\n\nmodule.exports = sortBy;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var toNumber = require('./toNumber');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nmodule.exports = toFinite;\n","var toFinite = require('./toFinite');\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nmodule.exports = toInteger;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var arrayMap = require('./_arrayMap'),\n    copyArray = require('./_copyArray'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol'),\n    stringToPath = require('./_stringToPath'),\n    toKey = require('./_toKey'),\n    toString = require('./toString');\n\n/**\n * Converts `value` to a property path array.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Util\n * @param {*} value The value to convert.\n * @returns {Array} Returns the new property path array.\n * @example\n *\n * _.toPath('a.b.c');\n * // => ['a', 'b', 'c']\n *\n * _.toPath('a[0].b.c');\n * // => ['a', '0', 'b', 'c']\n */\nfunction toPath(value) {\n  if (isArray(value)) {\n    return arrayMap(value, toKey);\n  }\n  return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));\n}\n\nmodule.exports = toPath;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nmodule.exports = toPlainObject;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var baseToString = require('./_baseToString'),\n    castSlice = require('./_castSlice'),\n    charsEndIndex = require('./_charsEndIndex'),\n    stringToArray = require('./_stringToArray'),\n    toString = require('./toString'),\n    trimmedEndIndex = require('./_trimmedEndIndex');\n\n/**\n * Removes trailing whitespace or specified characters from `string`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category String\n * @param {string} [string=''] The string to trim.\n * @param {string} [chars=whitespace] The characters to trim.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {string} Returns the trimmed string.\n * @example\n *\n * _.trimEnd('  abc  ');\n * // => '  abc'\n *\n * _.trimEnd('-_-abc-_-', '_-');\n * // => '-_-abc'\n */\nfunction trimEnd(string, chars, guard) {\n  string = toString(string);\n  if (string && (guard || chars === undefined)) {\n    return string.slice(0, trimmedEndIndex(string) + 1);\n  }\n  if (!string || !(chars = baseToString(chars))) {\n    return string;\n  }\n  var strSymbols = stringToArray(string),\n      end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;\n\n  return castSlice(strSymbols, 0, end).join('');\n}\n\nmodule.exports = trimEnd;\n","var baseToString = require('./_baseToString'),\n    castSlice = require('./_castSlice'),\n    charsStartIndex = require('./_charsStartIndex'),\n    stringToArray = require('./_stringToArray'),\n    toString = require('./toString');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * Removes leading whitespace or specified characters from `string`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category String\n * @param {string} [string=''] The string to trim.\n * @param {string} [chars=whitespace] The characters to trim.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {string} Returns the trimmed string.\n * @example\n *\n * _.trimStart('  abc  ');\n * // => 'abc  '\n *\n * _.trimStart('-_-abc-_-', '_-');\n * // => 'abc-_-'\n */\nfunction trimStart(string, chars, guard) {\n  string = toString(string);\n  if (string && (guard || chars === undefined)) {\n    return string.replace(reTrimStart, '');\n  }\n  if (!string || !(chars = baseToString(chars))) {\n    return string;\n  }\n  var strSymbols = stringToArray(string),\n      start = charsStartIndex(strSymbols, stringToArray(chars));\n\n  return castSlice(strSymbols, start).join('');\n}\n\nmodule.exports = trimStart;\n","var baseFlatten = require('./_baseFlatten'),\n    baseRest = require('./_baseRest'),\n    baseUniq = require('./_baseUniq'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values, in order, from all given arrays using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of combined values.\n * @example\n *\n * _.union([2], [1, 2]);\n * // => [2, 1]\n */\nvar union = baseRest(function(arrays) {\n  return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n});\n\nmodule.exports = union;\n","var baseFlatten = require('./_baseFlatten'),\n    baseIteratee = require('./_baseIteratee'),\n    baseRest = require('./_baseRest'),\n    baseUniq = require('./_baseUniq'),\n    isArrayLikeObject = require('./isArrayLikeObject'),\n    last = require('./last');\n\n/**\n * This method is like `_.union` except that it accepts `iteratee` which is\n * invoked for each element of each `arrays` to generate the criterion by\n * which uniqueness is computed. Result values are chosen from the first\n * array in which the value occurs. The iteratee is invoked with one argument:\n * (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Array} Returns the new array of combined values.\n * @example\n *\n * _.unionBy([2.1], [1.2, 2.3], Math.floor);\n * // => [2.1, 1.2]\n *\n * // The `_.property` iteratee shorthand.\n * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n * // => [{ 'x': 1 }, { 'x': 2 }]\n */\nvar unionBy = baseRest(function(arrays) {\n  var iteratee = last(arrays);\n  if (isArrayLikeObject(iteratee)) {\n    iteratee = undefined;\n  }\n  return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), baseIteratee(iteratee, 2));\n});\n\nmodule.exports = unionBy;\n","var baseFlatten = require('./_baseFlatten'),\n    baseRest = require('./_baseRest'),\n    baseUniq = require('./_baseUniq'),\n    isArrayLikeObject = require('./isArrayLikeObject'),\n    last = require('./last');\n\n/**\n * This method is like `_.union` except that it accepts `comparator` which\n * is invoked to compare elements of `arrays`. Result values are chosen from\n * the first array in which the value occurs. The comparator is invoked\n * with two arguments: (arrVal, othVal).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of combined values.\n * @example\n *\n * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n *\n * _.unionWith(objects, others, _.isEqual);\n * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n */\nvar unionWith = baseRest(function(arrays) {\n  var comparator = last(arrays);\n  comparator = typeof comparator == 'function' ? comparator : undefined;\n  return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined, comparator);\n});\n\nmodule.exports = unionWith;\n","var baseUnset = require('./_baseUnset');\n\n/**\n * Removes the property at `path` of `object`.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to unset.\n * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 7 } }] };\n * _.unset(object, 'a[0].b.c');\n * // => true\n *\n * console.log(object);\n * // => { 'a': [{ 'b': {} }] };\n *\n * _.unset(object, ['a', '0', 'b', 'c']);\n * // => true\n *\n * console.log(object);\n * // => { 'a': [{ 'b': {} }] };\n */\nfunction unset(object, path) {\n  return object == null ? true : baseUnset(object, path);\n}\n\nmodule.exports = unset;\n","var baseUpdate = require('./_baseUpdate'),\n    castFunction = require('./_castFunction');\n\n/**\n * This method is like `_.set` except that accepts `updater` to produce the\n * value to set. Use `_.updateWith` to customize `path` creation. The `updater`\n * is invoked with one argument: (value).\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 4.6.0\n * @category Object\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {Function} updater The function to produce the updated value.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.update(object, 'a[0].b.c', function(n) { return n * n; });\n * console.log(object.a[0].b.c);\n * // => 9\n *\n * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });\n * console.log(object.x[0].y.z);\n * // => 0\n */\nfunction update(object, path, updater) {\n  return object == null ? object : baseUpdate(object, path, castFunction(updater));\n}\n\nmodule.exports = update;\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var baseDifference = require('./_baseDifference'),\n    baseRest = require('./_baseRest'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array excluding all given values using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * **Note:** Unlike `_.pull`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...*} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.xor\n * @example\n *\n * _.without([2, 1, 2, 3], 1, 2);\n * // => [3]\n */\nvar without = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, values)\n    : [];\n});\n\nmodule.exports = without;\n","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    baseLodash = require('./_baseLodash'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike'),\n    wrapperClone = require('./_wrapperClone');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates a `lodash` object which wraps `value` to enable implicit method\n * chain sequences. Methods that operate on and return arrays, collections,\n * and functions can be chained together. Methods that retrieve a single value\n * or may return a primitive value will automatically end the chain sequence\n * and return the unwrapped value. Otherwise, the value must be unwrapped\n * with `_#value`.\n *\n * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n * enabled using `_.chain`.\n *\n * The execution of chained methods is lazy, that is, it's deferred until\n * `_#value` is implicitly or explicitly called.\n *\n * Lazy evaluation allows several methods to support shortcut fusion.\n * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n * the creation of intermediate arrays and can greatly reduce the number of\n * iteratee executions. Sections of a chain sequence qualify for shortcut\n * fusion if the section is applied to an array and iteratees accept only\n * one argument. The heuristic for whether a section qualifies for shortcut\n * fusion is subject to change.\n *\n * Chaining is supported in custom builds as long as the `_#value` method is\n * directly or indirectly included in the build.\n *\n * In addition to lodash methods, wrappers have `Array` and `String` methods.\n *\n * The wrapper `Array` methods are:\n * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n *\n * The wrapper `String` methods are:\n * `replace` and `split`\n *\n * The wrapper methods that support shortcut fusion are:\n * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n *\n * The chainable wrapper methods are:\n * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n * `zipObject`, `zipObjectDeep`, and `zipWith`\n *\n * The wrapper methods that are **not** chainable by default are:\n * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n * `upperFirst`, `value`, and `words`\n *\n * @name _\n * @constructor\n * @category Seq\n * @param {*} value The value to wrap in a `lodash` instance.\n * @returns {Object} Returns the new `lodash` wrapper instance.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * var wrapped = _([1, 2, 3]);\n *\n * // Returns an unwrapped value.\n * wrapped.reduce(_.add);\n * // => 6\n *\n * // Returns a wrapped value.\n * var squares = wrapped.map(square);\n *\n * _.isArray(squares);\n * // => false\n *\n * _.isArray(squares.value());\n * // => true\n */\nfunction lodash(value) {\n  if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n    if (value instanceof LodashWrapper) {\n      return value;\n    }\n    if (hasOwnProperty.call(value, '__wrapped__')) {\n      return wrapperClone(value);\n    }\n  }\n  return new LodashWrapper(value);\n}\n\n// Ensure wrappers are instances of `baseLodash`.\nlodash.prototype = baseLodash.prototype;\nlodash.prototype.constructor = lodash;\n\nmodule.exports = lodash;\n","'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\nconst filterObject = require('filter-obj');\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\nconst encodeFragmentIdentifier = Symbol('encodeFragmentIdentifier');\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'colon-list-separator':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), ':list='].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), ':list=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\tcase 'bracket-separator': {\n\t\t\tconst keyValueSep = options.arrayFormat === 'bracket-separator' ?\n\t\t\t\t'[]=' :\n\t\t\t\t'=';\n\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\t// Translate null to an empty string so that it doesn't serialize as 'null'\n\t\t\t\tvalue = value === null ? '' : value;\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), keyValueSep, encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'colon-list-separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(:list)$/.exec(key);\n\t\t\t\tkey = key.replace(/:list$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.includes(options.arrayFormatSeparator);\n\t\t\t\tconst isEncodedArray = (typeof value === 'string' && !isArray && decode(value, options).includes(options.arrayFormatSeparator));\n\t\t\t\tvalue = isEncodedArray ? decode(value, options) : value;\n\t\t\t\tconst newValue = isArray || isEncodedArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : value === null ? value : decode(value, options);\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tcase 'bracket-separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = /(\\[\\])$/.test(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!isArray) {\n\t\t\t\t\taccumulator[key] = value ? decode(value, options) : value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst arrayValue = value === null ?\n\t\t\t\t\t[] :\n\t\t\t\t\tvalue.split(options.arrayFormatSeparator).map(item => decode(item, options));\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = arrayValue;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], arrayValue);\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nfunction parse(query, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof query !== 'string') {\n\t\treturn ret;\n\t}\n\n\tquery = query.trim().replace(/^[?#&]/, '');\n\n\tif (!query) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of query.split('&')) {\n\t\tif (param === '') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [key, value] = splitOnFirst(options.decode ? param.replace(/\\+/g, ' ') : param, '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : ['comma', 'separator', 'bracket-separator'].includes(options.arrayFormat) ? value : decode(value, options);\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\tfor (const key of Object.keys(ret)) {\n\t\tconst value = ret[key];\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const k of Object.keys(value)) {\n\t\t\t\tvalue[k] = parseValue(value[k], options);\n\t\t\t}\n\t\t} else {\n\t\t\tret[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn ret;\n\t}\n\n\treturn (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ','\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key])) ||\n\t\t(options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const key of Object.keys(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = object[key];\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\tif (value.length === 0 && options.arrayFormat === 'bracket-separator') {\n\t\t\t\treturn encode(key, options) + '[]';\n\t\t\t}\n\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (url, options) => {\n\toptions = Object.assign({\n\t\tdecode: true\n\t}, options);\n\n\tconst [url_, hash] = splitOnFirst(url, '#');\n\n\treturn Object.assign(\n\t\t{\n\t\t\turl: url_.split('?')[0] || '',\n\t\t\tquery: parse(extract(url), options)\n\t\t},\n\t\toptions && options.parseFragmentIdentifier && hash ? {fragmentIdentifier: decode(hash, options)} : {}\n\t);\n};\n\nexports.stringifyUrl = (object, options) => {\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\t[encodeFragmentIdentifier]: true\n\t}, options);\n\n\tconst url = removeHash(object.url).split('?')[0] || '';\n\tconst queryFromUrl = exports.extract(object.url);\n\tconst parsedQueryFromUrl = exports.parse(queryFromUrl, {sort: false});\n\n\tconst query = Object.assign(parsedQueryFromUrl, object.query);\n\tlet queryString = exports.stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\tlet hash = getHash(object.url);\n\tif (object.fragmentIdentifier) {\n\t\thash = `#${options[encodeFragmentIdentifier] ? encode(object.fragmentIdentifier, options) : object.fragmentIdentifier}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n};\n\nexports.pick = (input, filter, options) => {\n\toptions = Object.assign({\n\t\tparseFragmentIdentifier: true,\n\t\t[encodeFragmentIdentifier]: false\n\t}, options);\n\n\tconst {url, query, fragmentIdentifier} = exports.parseUrl(input, options);\n\treturn exports.stringifyUrl({\n\t\turl,\n\t\tquery: filterObject(query, filter),\n\t\tfragmentIdentifier\n\t}, options);\n};\n\nexports.exclude = (input, filter, options) => {\n\tconst exclusionFilter = Array.isArray(filter) ? key => !filter.includes(key) : (key, value) => !filter(key, value);\n\n\treturn exports.pick(input, exclusionFilter, options);\n};\n","export default (function (value) {\n  return typeof value === 'function';\n});","export default (function (value) {\n  return typeof value === 'symbol' || typeof value === 'object' && Object.prototype.toString.call(value) === '[object Symbol]';\n});","export default (function (value) {\n  return value.length === 0;\n});","export default (function (value) {\n  return value.toString();\n});","export default (function (value) {\n  return typeof value === 'string';\n});","export var DEFAULT_NAMESPACE = '/';\nexport var ACTION_TYPE_DELIMITER = '||';","import invariant from 'invariant';\nimport isFunction from './utils/isFunction';\nimport isSymbol from './utils/isSymbol';\nimport isEmpty from './utils/isEmpty';\nimport toString from './utils/toString';\nimport isString from './utils/isString';\nimport { ACTION_TYPE_DELIMITER } from './constants';\n\nfunction isValidActionType(type) {\n  return isString(type) || isFunction(type) || isSymbol(type);\n}\n\nfunction isValidActionTypes(types) {\n  if (isEmpty(types)) {\n    return false;\n  }\n\n  return types.every(isValidActionType);\n}\n\nexport default function combineActions() {\n  for (var _len = arguments.length, actionsTypes = new Array(_len), _key = 0; _key < _len; _key++) {\n    actionsTypes[_key] = arguments[_key];\n  }\n\n  invariant(isValidActionTypes(actionsTypes), 'Expected action types to be strings, symbols, or action creators');\n  var combinedActionType = actionsTypes.map(toString).join(ACTION_TYPE_DELIMITER);\n  return {\n    toString: function toString() {\n      return combinedActionType;\n    }\n  };\n}","export default (function (value) {\n  return value;\n});","export default (function (value) {\n  return value === null;\n});","import invariant from 'invariant';\nimport isFunction from './utils/isFunction';\nimport identity from './utils/identity';\nimport isNull from './utils/isNull';\nexport default function createAction(type, payloadCreator, metaCreator) {\n  if (payloadCreator === void 0) {\n    payloadCreator = identity;\n  }\n\n  invariant(isFunction(payloadCreator) || isNull(payloadCreator), 'Expected payloadCreator to be a function, undefined or null');\n  var finalPayloadCreator = isNull(payloadCreator) || payloadCreator === identity ? identity : function (head) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return head instanceof Error ? head : payloadCreator.apply(void 0, [head].concat(args));\n  };\n  var hasMeta = isFunction(metaCreator);\n  var typeString = type.toString();\n\n  var actionCreator = function actionCreator() {\n    var payload = finalPayloadCreator.apply(void 0, arguments);\n    var action = {\n      type: type\n    };\n\n    if (payload instanceof Error) {\n      action.error = true;\n    }\n\n    if (payload !== undefined) {\n      action.payload = payload;\n    }\n\n    if (hasMeta) {\n      action.meta = metaCreator.apply(void 0, arguments);\n    }\n\n    return action;\n  };\n\n  actionCreator.toString = function () {\n    return typeString;\n  };\n\n  return actionCreator;\n}","export default (function (value) {\n  if (typeof value !== 'object' || value === null) return false;\n  var proto = value;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(value) === proto;\n});","export default (function (value) {\n  return Array.isArray(value);\n});","export default (function (value) {\n  return value === null || value === undefined;\n});","export default (function (array) {\n  return array[array.length - 1];\n});","import camelCase from 'to-camel-case';\nvar namespacer = '/';\nexport default (function (type) {\n  return type.indexOf(namespacer) === -1 ? camelCase(type) : type.split(namespacer).map(camelCase).join(namespacer);\n});","export default (function (array, callback) {\n  return array.reduce(function (partialObject, element) {\n    return callback(partialObject, element);\n  }, {});\n});","export default (function (value) {\n  return typeof Map !== 'undefined' && value instanceof Map;\n});","import isMap from './isMap';\nexport default function ownKeys(object) {\n  if (isMap(object)) {\n    // We are using loose transforms in babel. Here we are trying to convert an\n    // interable to an array. Loose mode expects everything to already be an\n    // array. The problem is that our eslint rules encourage us to prefer\n    // spread over Array.from.\n    //\n    // Instead of disabling loose mode we simply disable the warning.\n    // eslint-disable-next-line unicorn/prefer-spread\n    return Array.from(object.keys());\n  }\n\n  if (typeof Reflect !== 'undefined' && typeof Reflect.ownKeys === 'function') {\n    return Reflect.ownKeys(object);\n  }\n\n  var keys = Object.getOwnPropertyNames(object);\n\n  if (typeof Object.getOwnPropertySymbols === 'function') {\n    keys = keys.concat(Object.getOwnPropertySymbols(object));\n  }\n\n  return keys;\n}","import isMap from './isMap';\nexport default function get(key, x) {\n  return isMap(x) ? x.get(key) : x[key];\n}","import { DEFAULT_NAMESPACE, ACTION_TYPE_DELIMITER } from '../constants';\nimport ownKeys from './ownKeys';\nimport get from './get';\nexport default (function (predicate) {\n  return function flatten(map, _temp, partialFlatMap, partialFlatActionType) {\n    var _ref = _temp === void 0 ? {} : _temp,\n        _ref$namespace = _ref.namespace,\n        namespace = _ref$namespace === void 0 ? DEFAULT_NAMESPACE : _ref$namespace,\n        prefix = _ref.prefix;\n\n    if (partialFlatMap === void 0) {\n      partialFlatMap = {};\n    }\n\n    if (partialFlatActionType === void 0) {\n      partialFlatActionType = '';\n    }\n\n    function connectNamespace(type) {\n      var _ref2;\n\n      if (!partialFlatActionType) return type;\n      var types = type.toString().split(ACTION_TYPE_DELIMITER);\n      var partials = partialFlatActionType.split(ACTION_TYPE_DELIMITER);\n      return (_ref2 = []).concat.apply(_ref2, partials.map(function (p) {\n        return types.map(function (t) {\n          return \"\" + p + namespace + t;\n        });\n      })).join(ACTION_TYPE_DELIMITER);\n    }\n\n    function connectPrefix(type) {\n      if (partialFlatActionType || !prefix || prefix && new RegExp(\"^\" + prefix + namespace).test(type)) {\n        return type;\n      }\n\n      return \"\" + prefix + namespace + type;\n    }\n\n    ownKeys(map).forEach(function (type) {\n      var nextNamespace = connectPrefix(connectNamespace(type));\n      var mapValue = get(type, map);\n\n      if (predicate(mapValue)) {\n        flatten(mapValue, {\n          namespace: namespace,\n          prefix: prefix\n        }, partialFlatMap, nextNamespace);\n      } else {\n        partialFlatMap[nextNamespace] = mapValue;\n      }\n    });\n    return partialFlatMap;\n  };\n});","import isPlainObject from './isPlainObject';\nimport flattenWhenNode from './flattenWhenNode';\nexport default flattenWhenNode(isPlainObject);","import { DEFAULT_NAMESPACE } from '../constants';\nimport isEmpty from './isEmpty';\nimport camelCase from './camelCase';\nexport default function unflattenActionCreators(flatActionCreators, _temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      _ref$namespace = _ref.namespace,\n      namespace = _ref$namespace === void 0 ? DEFAULT_NAMESPACE : _ref$namespace,\n      prefix = _ref.prefix;\n\n  function unflatten(flatActionType, partialNestedActionCreators, partialFlatActionTypePath) {\n    var nextNamespace = camelCase(partialFlatActionTypePath.shift());\n\n    if (isEmpty(partialFlatActionTypePath)) {\n      partialNestedActionCreators[nextNamespace] = flatActionCreators[flatActionType];\n    } else {\n      if (!partialNestedActionCreators[nextNamespace]) {\n        partialNestedActionCreators[nextNamespace] = {};\n      }\n\n      unflatten(flatActionType, partialNestedActionCreators[nextNamespace], partialFlatActionTypePath);\n    }\n  }\n\n  var nestedActionCreators = {};\n  Object.getOwnPropertyNames(flatActionCreators).forEach(function (type) {\n    var unprefixedType = prefix ? type.replace(\"\" + prefix + namespace, '') : type;\n    return unflatten(type, nestedActionCreators, unprefixedType.split(namespace));\n  });\n  return nestedActionCreators;\n}","function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport invariant from 'invariant';\nimport isPlainObject from './utils/isPlainObject';\nimport isFunction from './utils/isFunction';\nimport identity from './utils/identity';\nimport isArray from './utils/isArray';\nimport isString from './utils/isString';\nimport isNil from './utils/isNil';\nimport getLastElement from './utils/getLastElement';\nimport camelCase from './utils/camelCase';\nimport arrayToObject from './utils/arrayToObject';\nimport flattenActionMap from './utils/flattenActionMap';\nimport unflattenActionCreators from './utils/unflattenActionCreators';\nimport createAction from './createAction';\nimport { DEFAULT_NAMESPACE } from './constants';\nexport default function createActions(actionMap) {\n  for (var _len = arguments.length, identityActions = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    identityActions[_key - 1] = arguments[_key];\n  }\n\n  var options = isPlainObject(getLastElement(identityActions)) ? identityActions.pop() : {};\n  invariant(identityActions.every(isString) && (isString(actionMap) || isPlainObject(actionMap)), 'Expected optional object followed by string action types');\n\n  if (isString(actionMap)) {\n    return actionCreatorsFromIdentityActions([actionMap].concat(identityActions), options);\n  }\n\n  return _objectSpread({}, actionCreatorsFromActionMap(actionMap, options), actionCreatorsFromIdentityActions(identityActions, options));\n}\n\nfunction actionCreatorsFromActionMap(actionMap, options) {\n  var flatActionMap = flattenActionMap(actionMap, options);\n  var flatActionCreators = actionMapToActionCreators(flatActionMap);\n  return unflattenActionCreators(flatActionCreators, options);\n}\n\nfunction actionMapToActionCreators(actionMap, _temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      prefix = _ref.prefix,\n      _ref$namespace = _ref.namespace,\n      namespace = _ref$namespace === void 0 ? DEFAULT_NAMESPACE : _ref$namespace;\n\n  function isValidActionMapValue(actionMapValue) {\n    if (isFunction(actionMapValue) || isNil(actionMapValue)) {\n      return true;\n    }\n\n    if (isArray(actionMapValue)) {\n      var _actionMapValue$ = actionMapValue[0],\n          payload = _actionMapValue$ === void 0 ? identity : _actionMapValue$,\n          meta = actionMapValue[1];\n      return isFunction(payload) && isFunction(meta);\n    }\n\n    return false;\n  }\n\n  return arrayToObject(Object.keys(actionMap), function (partialActionCreators, type) {\n    var _objectSpread2;\n\n    var actionMapValue = actionMap[type];\n    invariant(isValidActionMapValue(actionMapValue), 'Expected function, undefined, null, or array with payload and meta ' + (\"functions for \" + type));\n    var prefixedType = prefix ? \"\" + prefix + namespace + type : type;\n    var actionCreator = isArray(actionMapValue) ? createAction.apply(void 0, [prefixedType].concat(actionMapValue)) : createAction(prefixedType, actionMapValue);\n    return _objectSpread({}, partialActionCreators, (_objectSpread2 = {}, _objectSpread2[type] = actionCreator, _objectSpread2));\n  });\n}\n\nfunction actionCreatorsFromIdentityActions(identityActions, options) {\n  var actionMap = arrayToObject(identityActions, function (partialActionMap, type) {\n    var _objectSpread3;\n\n    return _objectSpread({}, partialActionMap, (_objectSpread3 = {}, _objectSpread3[type] = identity, _objectSpread3));\n  });\n  var actionCreators = actionMapToActionCreators(actionMap, options);\n  return arrayToObject(Object.keys(actionCreators), function (partialActionCreators, type) {\n    var _objectSpread4;\n\n    return _objectSpread({}, partialActionCreators, (_objectSpread4 = {}, _objectSpread4[camelCase(type)] = actionCreators[type], _objectSpread4));\n  });\n}","import curry from 'just-curry-it';\nimport createAction from './createAction';\nexport default (function (type, payloadCreator) {\n  return curry(createAction(type, payloadCreator), payloadCreator.length);\n});","export default (function (value) {\n  return value === undefined;\n});","import invariant from 'invariant';\nimport isFunction from './utils/isFunction';\nimport isPlainObject from './utils/isPlainObject';\nimport identity from './utils/identity';\nimport isNil from './utils/isNil';\nimport isUndefined from './utils/isUndefined';\nimport toString from './utils/toString';\nimport { ACTION_TYPE_DELIMITER } from './constants';\nexport default function handleAction(type, reducer, defaultState) {\n  if (reducer === void 0) {\n    reducer = identity;\n  }\n\n  var types = toString(type).split(ACTION_TYPE_DELIMITER);\n  invariant(!isUndefined(defaultState), \"defaultState for reducer handling \" + types.join(', ') + \" should be defined\");\n  invariant(isFunction(reducer) || isPlainObject(reducer), 'Expected reducer to be a function or object with next and throw reducers');\n\n  var _ref = isFunction(reducer) ? [reducer, reducer] : [reducer.next, reducer.throw].map(function (aReducer) {\n    return isNil(aReducer) ? identity : aReducer;\n  }),\n      nextReducer = _ref[0],\n      throwReducer = _ref[1];\n\n  return function (state, action) {\n    if (state === void 0) {\n      state = defaultState;\n    }\n\n    var actionType = action.type;\n\n    if (!actionType || types.indexOf(toString(actionType)) === -1) {\n      return state;\n    }\n\n    return (action.error === true ? throwReducer : nextReducer)(state, action);\n  };\n}","export default (function () {\n  for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  var initialState = typeof args[args.length - 1] !== 'function' && args.pop();\n  var reducers = args;\n\n  if (typeof initialState === 'undefined') {\n    throw new TypeError('The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.');\n  }\n\n  return function (prevState, value) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n      args[_key2 - 2] = arguments[_key2];\n    }\n\n    var prevStateIsUndefined = typeof prevState === 'undefined';\n    var valueIsUndefined = typeof value === 'undefined';\n\n    if (prevStateIsUndefined && valueIsUndefined && initialState) {\n      return initialState;\n    }\n\n    return reducers.reduce(function (newState, reducer) {\n      return reducer.apply(undefined, [newState, value].concat(args));\n    }, prevStateIsUndefined && !valueIsUndefined && initialState ? initialState : prevState);\n  };\n});","import isPlainObject from './isPlainObject';\nimport isMap from './isMap';\nimport hasGeneratorInterface from './hasGeneratorInterface';\nimport flattenWhenNode from './flattenWhenNode';\nexport default flattenWhenNode(function (node) {\n  return (isPlainObject(node) || isMap(node)) && !hasGeneratorInterface(node);\n});","import ownKeys from './ownKeys';\nexport default function hasGeneratorInterface(handler) {\n  var keys = ownKeys(handler);\n  var hasOnlyInterfaceNames = keys.every(function (ownKey) {\n    return ownKey === 'next' || ownKey === 'throw';\n  });\n  return keys.length && keys.length <= 2 && hasOnlyInterfaceNames;\n}","import reduceReducers from 'reduce-reducers';\nimport invariant from 'invariant';\nimport isPlainObject from './utils/isPlainObject';\nimport isMap from './utils/isMap';\nimport ownKeys from './utils/ownKeys';\nimport flattenReducerMap from './utils/flattenReducerMap';\nimport handleAction from './handleAction';\nimport get from './utils/get';\nexport default function handleActions(handlers, defaultState, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  invariant(isPlainObject(handlers) || isMap(handlers), 'Expected handlers to be a plain object.');\n  var flattenedReducerMap = flattenReducerMap(handlers, options);\n  var reducers = ownKeys(flattenedReducerMap).map(function (type) {\n    return handleAction(type, get(type, flattenedReducerMap), defaultState);\n  });\n  var reducer = reduceReducers.apply(void 0, reducers.concat([defaultState]));\n  return function (state, action) {\n    if (state === void 0) {\n      state = defaultState;\n    }\n\n    return reducer(state, action);\n  };\n}","'use strict';\n\nvar compose = require('redux').compose;\n\nexports.__esModule = true;\nexports.composeWithDevTools =\n  typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n    ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n    : function () {\n        if (arguments.length === 0) return undefined;\n        if (typeof arguments[0] === 'object') return compose;\n        return compose.apply(null, arguments);\n      };\n\nexports.devToolsEnhancer =\n  typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__\n    ? window.__REDUX_DEVTOOLS_EXTENSION__\n    : function () {\n        return function (noop) {\n          return noop;\n        };\n      };\n","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?t(exports):\"function\"==typeof define&&define.amd?define([\"exports\"],t):t(e.reduxLogger=e.reduxLogger||{})}(this,function(e){\"use strict\";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,\"kind\",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,\"path\",{value:t,enumerable:!0})}function n(e,t,r){n.super_.call(this,\"E\",e),Object.defineProperty(this,\"lhs\",{value:t,enumerable:!0}),Object.defineProperty(this,\"rhs\",{value:r,enumerable:!0})}function o(e,t){o.super_.call(this,\"N\",e),Object.defineProperty(this,\"rhs\",{value:t,enumerable:!0})}function i(e,t){i.super_.call(this,\"D\",e),Object.defineProperty(this,\"lhs\",{value:t,enumerable:!0})}function a(e,t,r){a.super_.call(this,\"A\",e),Object.defineProperty(this,\"index\",{value:t,enumerable:!0}),Object.defineProperty(this,\"item\",{value:r,enumerable:!0})}function f(e,t,r){var n=e.slice((r||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,n),e}function u(e){var t=\"undefined\"==typeof e?\"undefined\":N(e);return\"object\"!==t?t:e===Math?\"math\":null===e?\"null\":Array.isArray(e)?\"array\":\"[object Date]\"===Object.prototype.toString.call(e)?\"date\":\"function\"==typeof e.toString&&/^\\/.*\\//.test(e.toString())?\"regexp\":\"object\"}function l(e,t,r,c,s,d,p){s=s||[],p=p||[];var g=s.slice(0);if(\"undefined\"!=typeof d){if(c){if(\"function\"==typeof c&&c(g,d))return;if(\"object\"===(\"undefined\"==typeof c?\"undefined\":N(c))){if(c.prefilter&&c.prefilter(g,d))return;if(c.normalize){var h=c.normalize(g,d,e,t);h&&(e=h[0],t=h[1])}}}g.push(d)}\"regexp\"===u(e)&&\"regexp\"===u(t)&&(e=e.toString(),t=t.toString());var y=\"undefined\"==typeof e?\"undefined\":N(e),v=\"undefined\"==typeof t?\"undefined\":N(t),b=\"undefined\"!==y||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(d),m=\"undefined\"!==v||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(d);if(!b&&m)r(new o(g,t));else if(!m&&b)r(new i(g,e));else if(u(e)!==u(t))r(new n(g,e,t));else if(\"date\"===u(e)&&e-t!==0)r(new n(g,e,t));else if(\"object\"===y&&null!==e&&null!==t)if(p.filter(function(t){return t.lhs===e}).length)e!==t&&r(new n(g,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var w;e.length;for(w=0;w<e.length;w++)w>=t.length?r(new a(g,w,new i(void 0,e[w]))):l(e[w],t[w],r,c,g,w,p);for(;w<t.length;)r(new a(g,w,new o(void 0,t[w++])))}else{var x=Object.keys(e),S=Object.keys(t);x.forEach(function(n,o){var i=S.indexOf(n);i>=0?(l(e[n],t[n],r,c,g,n,p),S=f(S,i)):l(e[n],void 0,r,c,g,n,p)}),S.forEach(function(e){l(void 0,t[e],r,c,g,e,p)})}p.length=p.length-1}else e!==t&&(\"number\"===y&&isNaN(e)&&isNaN(t)||r(new n(g,e,t)))}function c(e,t,r,n){return n=n||[],l(e,t,function(e){e&&n.push(e)},r),n.length?n:void 0}function s(e,t,r){if(r.path&&r.path.length){var n,o=e[t],i=r.path.length-1;for(n=0;n<i;n++)o=o[r.path[n]];switch(r.kind){case\"A\":s(o[r.path[n]],r.index,r.item);break;case\"D\":delete o[r.path[n]];break;case\"E\":case\"N\":o[r.path[n]]=r.rhs}}else switch(r.kind){case\"A\":s(e[t],r.index,r.item);break;case\"D\":e=f(e,t);break;case\"E\":case\"N\":e[t]=r.rhs}return e}function d(e,t,r){if(e&&t&&r&&r.kind){for(var n=e,o=-1,i=r.path?r.path.length-1:0;++o<i;)\"undefined\"==typeof n[r.path[o]]&&(n[r.path[o]]=\"number\"==typeof r.path[o]?[]:{}),n=n[r.path[o]];switch(r.kind){case\"A\":s(r.path?n[r.path[o]]:n,r.index,r.item);break;case\"D\":delete n[r.path[o]];break;case\"E\":case\"N\":n[r.path[o]]=r.rhs}}}function p(e,t,r){if(r.path&&r.path.length){var n,o=e[t],i=r.path.length-1;for(n=0;n<i;n++)o=o[r.path[n]];switch(r.kind){case\"A\":p(o[r.path[n]],r.index,r.item);break;case\"D\":o[r.path[n]]=r.lhs;break;case\"E\":o[r.path[n]]=r.lhs;break;case\"N\":delete o[r.path[n]]}}else switch(r.kind){case\"A\":p(e[t],r.index,r.item);break;case\"D\":e[t]=r.lhs;break;case\"E\":e[t]=r.lhs;break;case\"N\":e=f(e,t)}return e}function g(e,t,r){if(e&&t&&r&&r.kind){var n,o,i=e;for(o=r.path.length-1,n=0;n<o;n++)\"undefined\"==typeof i[r.path[n]]&&(i[r.path[n]]={}),i=i[r.path[n]];switch(r.kind){case\"A\":p(i[r.path[n]],r.index,r.item);break;case\"D\":i[r.path[n]]=r.lhs;break;case\"E\":i[r.path[n]]=r.lhs;break;case\"N\":delete i[r.path[n]]}}}function h(e,t,r){if(e&&t){var n=function(n){r&&!r(e,t,n)||d(e,t,n)};l(e,t,n)}}function y(e){return\"color: \"+F[e].color+\"; font-weight: bold\"}function v(e){var t=e.kind,r=e.path,n=e.lhs,o=e.rhs,i=e.index,a=e.item;switch(t){case\"E\":return[r.join(\".\"),n,\"→\",o];case\"N\":return[r.join(\".\"),o];case\"D\":return[r.join(\".\")];case\"A\":return[r.join(\".\")+\"[\"+i+\"]\",a];default:return[]}}function b(e,t,r,n){var o=c(e,t);try{n?r.groupCollapsed(\"diff\"):r.group(\"diff\")}catch(e){r.log(\"diff\")}o?o.forEach(function(e){var t=e.kind,n=v(e);r.log.apply(r,[\"%c \"+F[t].text,y(t)].concat(P(n)))}):r.log(\"—— no diff ——\");try{r.groupEnd()}catch(e){r.log(\"—— diff end —— \")}}function m(e,t,r,n){switch(\"undefined\"==typeof e?\"undefined\":N(e)){case\"object\":return\"function\"==typeof e[n]?e[n].apply(e,P(r)):e[n];case\"function\":return e(t);default:return e}}function w(e){var t=e.timestamp,r=e.duration;return function(e,n,o){var i=[\"action\"];return i.push(\"%c\"+String(e.type)),t&&i.push(\"%c@ \"+n),r&&i.push(\"%c(in \"+o.toFixed(2)+\" ms)\"),i.join(\" \")}}function x(e,t){var r=t.logger,n=t.actionTransformer,o=t.titleFormatter,i=void 0===o?w(t):o,a=t.collapsed,f=t.colors,u=t.level,l=t.diff,c=\"undefined\"==typeof t.titleFormatter;e.forEach(function(o,s){var d=o.started,p=o.startedTime,g=o.action,h=o.prevState,y=o.error,v=o.took,w=o.nextState,x=e[s+1];x&&(w=x.prevState,v=x.started-d);var S=n(g),k=\"function\"==typeof a?a(function(){return w},g,o):a,j=D(p),E=f.title?\"color: \"+f.title(S)+\";\":\"\",A=[\"color: gray; font-weight: lighter;\"];A.push(E),t.timestamp&&A.push(\"color: gray; font-weight: lighter;\"),t.duration&&A.push(\"color: gray; font-weight: lighter;\");var O=i(S,j,v);try{k?f.title&&c?r.groupCollapsed.apply(r,[\"%c \"+O].concat(A)):r.groupCollapsed(O):f.title&&c?r.group.apply(r,[\"%c \"+O].concat(A)):r.group(O)}catch(e){r.log(O)}var N=m(u,S,[h],\"prevState\"),P=m(u,S,[S],\"action\"),C=m(u,S,[y,h],\"error\"),F=m(u,S,[w],\"nextState\");if(N)if(f.prevState){var L=\"color: \"+f.prevState(h)+\"; font-weight: bold\";r[N](\"%c prev state\",L,h)}else r[N](\"prev state\",h);if(P)if(f.action){var T=\"color: \"+f.action(S)+\"; font-weight: bold\";r[P](\"%c action    \",T,S)}else r[P](\"action    \",S);if(y&&C)if(f.error){var M=\"color: \"+f.error(y,h)+\"; font-weight: bold;\";r[C](\"%c error     \",M,y)}else r[C](\"error     \",y);if(F)if(f.nextState){var _=\"color: \"+f.nextState(w)+\"; font-weight: bold\";r[F](\"%c next state\",_,w)}else r[F](\"next state\",w);l&&b(h,w,r,k);try{r.groupEnd()}catch(e){r.log(\"—— log end ——\")}})}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},L,e),r=t.logger,n=t.stateTransformer,o=t.errorTransformer,i=t.predicate,a=t.logErrors,f=t.diffPredicate;if(\"undefined\"==typeof r)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error(\"[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\\n// Logger with default options\\nimport { logger } from 'redux-logger'\\nconst store = createStore(\\n  reducer,\\n  applyMiddleware(logger)\\n)\\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\\nimport createLogger from 'redux-logger'\\nconst logger = createLogger({\\n  // ...options\\n});\\nconst store = createStore(\\n  reducer,\\n  applyMiddleware(logger)\\n)\\n\"),function(){return function(e){return function(t){return e(t)}}};var u=[];return function(e){var r=e.getState;return function(e){return function(l){if(\"function\"==typeof i&&!i(r,l))return e(l);var c={};u.push(c),c.started=O.now(),c.startedTime=new Date,c.prevState=n(r()),c.action=l;var s=void 0;if(a)try{s=e(l)}catch(e){c.error=o(e)}else s=e(l);c.took=O.now()-c.started,c.nextState=n(r());var d=t.diff&&\"function\"==typeof f?f(r,l):t.diff;if(x(u,Object.assign({},t,{diff:d})),u.length=0,c.error)throw c.error;return s}}}}var k,j,E=function(e,t){return new Array(t+1).join(e)},A=function(e,t){return E(\"0\",t-e.toString().length)+e},D=function(e){return A(e.getHours(),2)+\":\"+A(e.getMinutes(),2)+\":\"+A(e.getSeconds(),2)+\".\"+A(e.getMilliseconds(),3)},O=\"undefined\"!=typeof performance&&null!==performance&&\"function\"==typeof performance.now?performance:Date,N=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},P=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},C=[];k=\"object\"===(\"undefined\"==typeof global?\"undefined\":N(global))&&global?global:\"undefined\"!=typeof window?window:{},j=k.DeepDiff,j&&C.push(function(){\"undefined\"!=typeof j&&k.DeepDiff===c&&(k.DeepDiff=j,j=void 0)}),t(n,r),t(o,r),t(i,r),t(a,r),Object.defineProperties(c,{diff:{value:c,enumerable:!0},observableDiff:{value:l,enumerable:!0},applyDiff:{value:h,enumerable:!0},applyChange:{value:d,enumerable:!0},revertChange:{value:g,enumerable:!0},isConflict:{value:function(){return\"undefined\"!=typeof j},enumerable:!0},noConflict:{value:function(){return C&&(C.forEach(function(e){e()}),C=null),c},enumerable:!0}});var F={E:{color:\"#2196F3\",text:\"CHANGED:\"},N:{color:\"#4CAF50\",text:\"ADDED:\"},D:{color:\"#F44336\",text:\"DELETED:\"},A:{color:\"#2196F3\",text:\"ARRAY:\"}},L={level:\"log\",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return\"inherit\"},prevState:function(){return\"#9E9E9E\"},action:function(){return\"#03A9F4\"},nextState:function(){return\"#4CAF50\"},error:function(){return\"#F20404\"}},diff:!1,diffPredicate:void 0,transformer:void 0},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,r=e.getState;return\"function\"==typeof t||\"function\"==typeof r?S()({dispatch:t,getState:r}):void console.error(\"\\n[redux-logger v3] BREAKING CHANGE\\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\\n[redux-logger v3] Change\\n[redux-logger v3] import createLogger from 'redux-logger'\\n[redux-logger v3] to\\n[redux-logger v3] import { createLogger } from 'redux-logger'\\n\")};e.defaults=L,e.createLogger=S,e.logger=T,e.default=T,Object.defineProperty(e,\"__esModule\",{value:!0})});\n","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nexport default function _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import _objectSpread from '@babel/runtime/helpers/esm/objectSpread2';\n\n/**\n * Adapted from React: https://github.com/facebook/react/blob/master/packages/shared/formatProdErrorMessage.js\n *\n * Do not require this module directly! Use normal throw error calls. These messages will be replaced with error codes\n * during build.\n * @param {number} code\n */\nfunction formatProdErrorMessage(code) {\n  return \"Minified Redux error #\" + code + \"; visit https://redux.js.org/Errors?code=\" + code + \" for the full message or \" + 'use the non-minified dev environment for full errors. ';\n}\n\n// Inlined version of the `symbol-observable` polyfill\nvar $$observable = (function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n})();\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n// Inlined / shortened version of `kindOf` from https://github.com/jonschlinkert/kind-of\nfunction miniKindOf(val) {\n  if (val === void 0) return 'undefined';\n  if (val === null) return 'null';\n  var type = typeof val;\n\n  switch (type) {\n    case 'boolean':\n    case 'string':\n    case 'number':\n    case 'symbol':\n    case 'function':\n      {\n        return type;\n      }\n  }\n\n  if (Array.isArray(val)) return 'array';\n  if (isDate(val)) return 'date';\n  if (isError(val)) return 'error';\n  var constructorName = ctorName(val);\n\n  switch (constructorName) {\n    case 'Symbol':\n    case 'Promise':\n    case 'WeakMap':\n    case 'WeakSet':\n    case 'Map':\n    case 'Set':\n      return constructorName;\n  } // other\n\n\n  return type.slice(8, -1).toLowerCase().replace(/\\s/g, '');\n}\n\nfunction ctorName(val) {\n  return typeof val.constructor === 'function' ? val.constructor.name : null;\n}\n\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === 'string' && val.constructor && typeof val.constructor.stackTraceLimit === 'number';\n}\n\nfunction isDate(val) {\n  if (val instanceof Date) return true;\n  return typeof val.toDateString === 'function' && typeof val.getDate === 'function' && typeof val.setDate === 'function';\n}\n\nfunction kindOf(val) {\n  var typeOfVal = typeof val;\n\n  if (process.env.NODE_ENV !== 'production') {\n    typeOfVal = miniKindOf(val);\n  }\n\n  return typeOfVal;\n}\n\n/**\n * @deprecated\n *\n * **We recommend using the `configureStore` method\n * of the `@reduxjs/toolkit` package**, which replaces `createStore`.\n *\n * Redux Toolkit is our recommended approach for writing Redux logic today,\n * including store setup, reducers, data fetching, and more.\n *\n * **For more details, please read this Redux docs page:**\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * `configureStore` from Redux Toolkit is an improved version of `createStore` that\n * simplifies setup and helps avoid common bugs.\n *\n * You should not be using the `redux` core package by itself today, except for learning purposes.\n * The `createStore` method from the core `redux` package will not be removed, but we encourage\n * all users to migrate to using Redux Toolkit for all Redux code.\n *\n * If you want to use `createStore` without this visual deprecation warning, use\n * the `legacy_createStore` import instead:\n *\n * `import { legacy_createStore as createStore} from 'redux'`\n *\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : 'It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : \"Expected the enhancer to be a function. Instead, received: '\" + kindOf(enhancer) + \"'\");\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : \"Expected the root reducer to be a function. Instead, received: '\" + kindOf(reducer) + \"'\");\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : 'You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : \"Expected the listener to be a function. Instead, received: '\" + kindOf(listener) + \"'\");\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : 'You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : 'You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n      currentListeners = null;\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : \"Actions must be plain objects. Instead, the actual type was: '\" + kindOf(action) + \"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.\");\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : 'Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : \"Expected the nextReducer to be a function. Instead, received: '\" + kindOf(nextReducer));\n    }\n\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : \"Expected the observer to be an object. Instead, received: '\" + kindOf(observer) + \"'\");\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n/**\n * Creates a Redux store that holds the state tree.\n *\n * **We recommend using `configureStore` from the\n * `@reduxjs/toolkit` package**, which replaces `createStore`:\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nvar legacy_createStore = createStore;\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return \"The \" + argumentName + \" has unexpected type of \\\"\" + kindOf(inputState) + \"\\\". Expected argument to be an object with the following \" + (\"keys: \\\"\" + reducerKeys.join('\", \"') + \"\\\"\");\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return \"Unexpected \" + (unexpectedKeys.length > 1 ? 'keys' : 'key') + \" \" + (\"\\\"\" + unexpectedKeys.join('\", \"') + \"\\\" found in \" + argumentName + \". \") + \"Expected to find one of the known reducer keys instead: \" + (\"\\\"\" + reducerKeys.join('\", \"') + \"\\\". Unexpected keys will be ignored.\");\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, {\n      type: ActionTypes.INIT\n    });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(12) : \"The slice reducer for key \\\"\" + key + \"\\\" returned undefined during initialization. \" + \"If the state passed to the reducer is undefined, you must \" + \"explicitly return the initial state. The initial state may \" + \"not be undefined. If you don't want to set a value for this reducer, \" + \"you can use null instead of undefined.\");\n    }\n\n    if (typeof reducer(undefined, {\n      type: ActionTypes.PROBE_UNKNOWN_ACTION()\n    }) === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(13) : \"The slice reducer for key \\\"\" + key + \"\\\" returned undefined when probed with a random type. \" + (\"Don't try to handle '\" + ActionTypes.INIT + \"' or other actions in \\\"redux/*\\\" \") + \"namespace. They are considered private. Instead, you must return the \" + \"current state for any unknown actions, unless it is undefined, \" + \"in which case you must return the initial state, regardless of the \" + \"action type. The initial state may not be undefined, but can be null.\");\n    }\n  });\n}\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\n\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning(\"No reducer provided for key \\\"\" + key + \"\\\"\");\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n\n  var finalReducerKeys = Object.keys(finalReducers); // This is used to make sure we don't warn about the same\n  // keys multiple times.\n\n  var unexpectedKeyCache;\n\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError;\n\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n\n      if (typeof nextStateForKey === 'undefined') {\n        var actionType = action && action.type;\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(14) : \"When called with an action of type \" + (actionType ? \"\\\"\" + String(actionType) + \"\\\"\" : '(unknown type)') + \", the slice reducer for key \\\"\" + _key + \"\\\" returned undefined. \" + \"To ignore an action, you must explicitly return the previous state. \" + \"If you want this reducer to hold no value, you can return null instead of undefined.\");\n      }\n\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n\n    hasChanged = hasChanged || finalReducerKeys.length !== Object.keys(state).length;\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass an action creator as the first argument,\n * and get a dispatch wrapped function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(16) : \"bindActionCreators expected an object or a function, but instead received: '\" + kindOf(actionCreators) + \"'. \" + \"Did you write \\\"import ActionCreators from\\\" instead of \\\"import * as ActionCreators from\\\"?\");\n  }\n\n  var boundActionCreators = {};\n\n  for (var key in actionCreators) {\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n\n  return boundActionCreators;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      var store = createStore.apply(void 0, arguments);\n\n      var _dispatch = function dispatch() {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(15) : 'Dispatching while constructing your middleware is not allowed. ' + 'Other middleware would not be applied to this dispatch.');\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(void 0, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(void 0, chain)(store.dispatch);\n      return _objectSpread(_objectSpread({}, store), {}, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\nexport { ActionTypes as __DO_NOT_USE__ActionTypes, applyMiddleware, bindActionCreators, combineReducers, compose, createStore, legacy_createStore };\n","var grammar = module.exports = {\n  v: [{\n    name: 'version',\n    reg: /^(\\d*)$/\n  }],\n  o: [{\n    // o=- 20518 0 IN IP4 203.0.113.1\n    // NB: sessionId will be a String in most cases because it is huge\n    name: 'origin',\n    reg: /^(\\S*) (\\d*) (\\d*) (\\S*) IP(\\d) (\\S*)/,\n    names: ['username', 'sessionId', 'sessionVersion', 'netType', 'ipVer', 'address'],\n    format: '%s %s %d %s IP%d %s'\n  }],\n  // default parsing of these only (though some of these feel outdated)\n  s: [{ name: 'name' }],\n  i: [{ name: 'description' }],\n  u: [{ name: 'uri' }],\n  e: [{ name: 'email' }],\n  p: [{ name: 'phone' }],\n  z: [{ name: 'timezones' }], // TODO: this one can actually be parsed properly...\n  r: [{ name: 'repeats' }],   // TODO: this one can also be parsed properly\n  // k: [{}], // outdated thing ignored\n  t: [{\n    // t=0 0\n    name: 'timing',\n    reg: /^(\\d*) (\\d*)/,\n    names: ['start', 'stop'],\n    format: '%d %d'\n  }],\n  c: [{\n    // c=IN IP4 10.47.197.26\n    name: 'connection',\n    reg: /^IN IP(\\d) (\\S*)/,\n    names: ['version', 'ip'],\n    format: 'IN IP%d %s'\n  }],\n  b: [{\n    // b=AS:4000\n    push: 'bandwidth',\n    reg: /^(TIAS|AS|CT|RR|RS):(\\d*)/,\n    names: ['type', 'limit'],\n    format: '%s:%s'\n  }],\n  m: [{\n    // m=video 51744 RTP/AVP 126 97 98 34 31\n    // NB: special - pushes to session\n    // TODO: rtp/fmtp should be filtered by the payloads found here?\n    reg: /^(\\w*) (\\d*) ([\\w/]*)(?: (.*))?/,\n    names: ['type', 'port', 'protocol', 'payloads'],\n    format: '%s %d %s %s'\n  }],\n  a: [\n    {\n      // a=rtpmap:110 opus/48000/2\n      push: 'rtp',\n      reg: /^rtpmap:(\\d*) ([\\w\\-.]*)(?:\\s*\\/(\\d*)(?:\\s*\\/(\\S*))?)?/,\n      names: ['payload', 'codec', 'rate', 'encoding'],\n      format: function (o) {\n        return (o.encoding)\n          ? 'rtpmap:%d %s/%s/%s'\n          : o.rate\n            ? 'rtpmap:%d %s/%s'\n            : 'rtpmap:%d %s';\n      }\n    },\n    {\n      // a=fmtp:108 profile-level-id=24;object=23;bitrate=64000\n      // a=fmtp:111 minptime=10; useinbandfec=1\n      push: 'fmtp',\n      reg: /^fmtp:(\\d*) ([\\S| ]*)/,\n      names: ['payload', 'config'],\n      format: 'fmtp:%d %s'\n    },\n    {\n      // a=control:streamid=0\n      name: 'control',\n      reg: /^control:(.*)/,\n      format: 'control:%s'\n    },\n    {\n      // a=rtcp:65179 IN IP4 193.84.77.194\n      name: 'rtcp',\n      reg: /^rtcp:(\\d*)(?: (\\S*) IP(\\d) (\\S*))?/,\n      names: ['port', 'netType', 'ipVer', 'address'],\n      format: function (o) {\n        return (o.address != null)\n          ? 'rtcp:%d %s IP%d %s'\n          : 'rtcp:%d';\n      }\n    },\n    {\n      // a=rtcp-fb:98 trr-int 100\n      push: 'rtcpFbTrrInt',\n      reg: /^rtcp-fb:(\\*|\\d*) trr-int (\\d*)/,\n      names: ['payload', 'value'],\n      format: 'rtcp-fb:%s trr-int %d'\n    },\n    {\n      // a=rtcp-fb:98 nack rpsi\n      push: 'rtcpFb',\n      reg: /^rtcp-fb:(\\*|\\d*) ([\\w-_]*)(?: ([\\w-_]*))?/,\n      names: ['payload', 'type', 'subtype'],\n      format: function (o) {\n        return (o.subtype != null)\n          ? 'rtcp-fb:%s %s %s'\n          : 'rtcp-fb:%s %s';\n      }\n    },\n    {\n      // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n      // a=extmap:1/recvonly URI-gps-string\n      // a=extmap:3 urn:ietf:params:rtp-hdrext:encrypt urn:ietf:params:rtp-hdrext:smpte-tc 25@600/24\n      push: 'ext',\n      reg: /^extmap:(\\d+)(?:\\/(\\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\\S*)(?: (\\S*))?/,\n      names: ['value', 'direction', 'encrypt-uri', 'uri', 'config'],\n      format: function (o) {\n        return (\n          'extmap:%d' +\n          (o.direction ? '/%s' : '%v') +\n          (o['encrypt-uri'] ? ' %s' : '%v') +\n          ' %s' +\n          (o.config ? ' %s' : '')\n        );\n      }\n    },\n    {\n      // a=extmap-allow-mixed\n      name: 'extmapAllowMixed',\n      reg: /^(extmap-allow-mixed)/\n    },\n    {\n      // a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32\n      push: 'crypto',\n      reg: /^crypto:(\\d*) ([\\w_]*) (\\S*)(?: (\\S*))?/,\n      names: ['id', 'suite', 'config', 'sessionConfig'],\n      format: function (o) {\n        return (o.sessionConfig != null)\n          ? 'crypto:%d %s %s %s'\n          : 'crypto:%d %s %s';\n      }\n    },\n    {\n      // a=setup:actpass\n      name: 'setup',\n      reg: /^setup:(\\w*)/,\n      format: 'setup:%s'\n    },\n    {\n      // a=connection:new\n      name: 'connectionType',\n      reg: /^connection:(new|existing)/,\n      format: 'connection:%s'\n    },\n    {\n      // a=mid:1\n      name: 'mid',\n      reg: /^mid:([^\\s]*)/,\n      format: 'mid:%s'\n    },\n    {\n      // a=msid:0c8b064d-d807-43b4-b434-f92a889d8587 98178685-d409-46e0-8e16-7ef0db0db64a\n      name: 'msid',\n      reg: /^msid:(.*)/,\n      format: 'msid:%s'\n    },\n    {\n      // a=ptime:20\n      name: 'ptime',\n      reg: /^ptime:(\\d*(?:\\.\\d*)*)/,\n      format: 'ptime:%d'\n    },\n    {\n      // a=maxptime:60\n      name: 'maxptime',\n      reg: /^maxptime:(\\d*(?:\\.\\d*)*)/,\n      format: 'maxptime:%d'\n    },\n    {\n      // a=sendrecv\n      name: 'direction',\n      reg: /^(sendrecv|recvonly|sendonly|inactive)/\n    },\n    {\n      // a=ice-lite\n      name: 'icelite',\n      reg: /^(ice-lite)/\n    },\n    {\n      // a=ice-ufrag:F7gI\n      name: 'iceUfrag',\n      reg: /^ice-ufrag:(\\S*)/,\n      format: 'ice-ufrag:%s'\n    },\n    {\n      // a=ice-pwd:x9cml/YzichV2+XlhiMu8g\n      name: 'icePwd',\n      reg: /^ice-pwd:(\\S*)/,\n      format: 'ice-pwd:%s'\n    },\n    {\n      // a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33\n      name: 'fingerprint',\n      reg: /^fingerprint:(\\S*) (\\S*)/,\n      names: ['type', 'hash'],\n      format: 'fingerprint:%s %s'\n    },\n    {\n      // a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host\n      // a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10\n      // a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10\n      // a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10\n      // a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10\n      push:'candidates',\n      reg: /^candidate:(\\S*) (\\d*) (\\S*) (\\d*) (\\S*) (\\d*) typ (\\S*)(?: raddr (\\S*) rport (\\d*))?(?: tcptype (\\S*))?(?: generation (\\d*))?(?: network-id (\\d*))?(?: network-cost (\\d*))?/,\n      names: ['foundation', 'component', 'transport', 'priority', 'ip', 'port', 'type', 'raddr', 'rport', 'tcptype', 'generation', 'network-id', 'network-cost'],\n      format: function (o) {\n        var str = 'candidate:%s %d %s %d %s %d typ %s';\n\n        str += (o.raddr != null) ? ' raddr %s rport %d' : '%v%v';\n\n        // NB: candidate has three optional chunks, so %void middles one if it's missing\n        str += (o.tcptype != null) ? ' tcptype %s' : '%v';\n\n        if (o.generation != null) {\n          str += ' generation %d';\n        }\n\n        str += (o['network-id'] != null) ? ' network-id %d' : '%v';\n        str += (o['network-cost'] != null) ? ' network-cost %d' : '%v';\n        return str;\n      }\n    },\n    {\n      // a=end-of-candidates (keep after the candidates line for readability)\n      name: 'endOfCandidates',\n      reg: /^(end-of-candidates)/\n    },\n    {\n      // a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401 ...\n      name: 'remoteCandidates',\n      reg: /^remote-candidates:(.*)/,\n      format: 'remote-candidates:%s'\n    },\n    {\n      // a=ice-options:google-ice\n      name: 'iceOptions',\n      reg: /^ice-options:(\\S*)/,\n      format: 'ice-options:%s'\n    },\n    {\n      // a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1\n      push: 'ssrcs',\n      reg: /^ssrc:(\\d*) ([\\w_-]*)(?::(.*))?/,\n      names: ['id', 'attribute', 'value'],\n      format: function (o) {\n        var str = 'ssrc:%d';\n        if (o.attribute != null) {\n          str += ' %s';\n          if (o.value != null) {\n            str += ':%s';\n          }\n        }\n        return str;\n      }\n    },\n    {\n      // a=ssrc-group:FEC 1 2\n      // a=ssrc-group:FEC-FR 3004364195 1080772241\n      push: 'ssrcGroups',\n      // token-char = %x21 / %x23-27 / %x2A-2B / %x2D-2E / %x30-39 / %x41-5A / %x5E-7E\n      reg: /^ssrc-group:([\\x21\\x23\\x24\\x25\\x26\\x27\\x2A\\x2B\\x2D\\x2E\\w]*) (.*)/,\n      names: ['semantics', 'ssrcs'],\n      format: 'ssrc-group:%s %s'\n    },\n    {\n      // a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV\n      name: 'msidSemantic',\n      reg: /^msid-semantic:\\s?(\\w*) (\\S*)/,\n      names: ['semantic', 'token'],\n      format: 'msid-semantic: %s %s' // space after ':' is not accidental\n    },\n    {\n      // a=group:BUNDLE audio video\n      push: 'groups',\n      reg: /^group:(\\w*) (.*)/,\n      names: ['type', 'mids'],\n      format: 'group:%s %s'\n    },\n    {\n      // a=rtcp-mux\n      name: 'rtcpMux',\n      reg: /^(rtcp-mux)/\n    },\n    {\n      // a=rtcp-rsize\n      name: 'rtcpRsize',\n      reg: /^(rtcp-rsize)/\n    },\n    {\n      // a=sctpmap:5000 webrtc-datachannel 1024\n      name: 'sctpmap',\n      reg: /^sctpmap:([\\w_/]*) (\\S*)(?: (\\S*))?/,\n      names: ['sctpmapNumber', 'app', 'maxMessageSize'],\n      format: function (o) {\n        return (o.maxMessageSize != null)\n          ? 'sctpmap:%s %s %s'\n          : 'sctpmap:%s %s';\n      }\n    },\n    {\n      // a=x-google-flag:conference\n      name: 'xGoogleFlag',\n      reg: /^x-google-flag:([^\\s]*)/,\n      format: 'x-google-flag:%s'\n    },\n    {\n      // a=rid:1 send max-width=1280;max-height=720;max-fps=30;depend=0\n      push: 'rids',\n      reg: /^rid:([\\d\\w]+) (\\w+)(?: ([\\S| ]*))?/,\n      names: ['id', 'direction', 'params'],\n      format: function (o) {\n        return (o.params) ? 'rid:%s %s %s' : 'rid:%s %s';\n      }\n    },\n    {\n      // a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]\n      // a=imageattr:* send [x=800,y=640] recv *\n      // a=imageattr:100 recv [x=320,y=240]\n      push: 'imageattrs',\n      reg: new RegExp(\n        // a=imageattr:97\n        '^imageattr:(\\\\d+|\\\\*)' +\n        // send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]\n        '[\\\\s\\\\t]+(send|recv)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*)' +\n        // recv [x=330,y=250]\n        '(?:[\\\\s\\\\t]+(recv|send)[\\\\s\\\\t]+(\\\\*|\\\\[\\\\S+\\\\](?:[\\\\s\\\\t]+\\\\[\\\\S+\\\\])*))?'\n      ),\n      names: ['pt', 'dir1', 'attrs1', 'dir2', 'attrs2'],\n      format: function (o) {\n        return 'imageattr:%s %s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    {\n      // a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8\n      // a=simulcast:recv 1;4,5 send 6;7\n      name: 'simulcast',\n      reg: new RegExp(\n        // a=simulcast:\n        '^simulcast:' +\n        // send 1,2,3;~4,~5\n        '(send|recv) ([a-zA-Z0-9\\\\-_~;,]+)' +\n        // space + recv 6;~7,~8\n        '(?:\\\\s?(send|recv) ([a-zA-Z0-9\\\\-_~;,]+))?' +\n        // end\n        '$'\n      ),\n      names: ['dir1', 'list1', 'dir2', 'list2'],\n      format: function (o) {\n        return 'simulcast:%s %s' + (o.dir2 ? ' %s %s' : '');\n      }\n    },\n    {\n      // old simulcast draft 03 (implemented by Firefox)\n      //   https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03\n      // a=simulcast: recv pt=97;98 send pt=97\n      // a=simulcast: send rid=5;6;7 paused=6,7\n      name: 'simulcast_03',\n      reg: /^simulcast:[\\s\\t]+([\\S+\\s\\t]+)$/,\n      names: ['value'],\n      format: 'simulcast: %s'\n    },\n    {\n      // a=framerate:25\n      // a=framerate:29.97\n      name: 'framerate',\n      reg: /^framerate:(\\d+(?:$|\\.\\d+))/,\n      format: 'framerate:%s'\n    },\n    {\n      // RFC4570\n      // a=source-filter: incl IN IP4 239.5.2.31 10.1.15.5\n      name: 'sourceFilter',\n      reg: /^source-filter: *(excl|incl) (\\S*) (IP4|IP6|\\*) (\\S*) (.*)/,\n      names: ['filterMode', 'netType', 'addressTypes', 'destAddress', 'srcList'],\n      format: 'source-filter: %s %s %s %s %s'\n    },\n    {\n      // a=bundle-only\n      name: 'bundleOnly',\n      reg: /^(bundle-only)/\n    },\n    {\n      // a=label:1\n      name: 'label',\n      reg: /^label:(.+)/,\n      format: 'label:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-5\n      name: 'sctpPort',\n      reg: /^sctp-port:(\\d+)$/,\n      format: 'sctp-port:%s'\n    },\n    {\n      // RFC version 26 for SCTP over DTLS\n      // https://tools.ietf.org/html/draft-ietf-mmusic-sctp-sdp-26#section-6\n      name: 'maxMessageSize',\n      reg: /^max-message-size:(\\d+)$/,\n      format: 'max-message-size:%s'\n    },\n    {\n      // RFC7273\n      // a=ts-refclk:ptp=IEEE1588-2008:39-A7-94-FF-FE-07-CB-D0:37\n      push:'tsRefClocks',\n      reg: /^ts-refclk:([^\\s=]*)(?:=(\\S*))?/,\n      names: ['clksrc', 'clksrcExt'],\n      format: function (o) {\n        return 'ts-refclk:%s' + (o.clksrcExt != null ? '=%s' : '');\n      }\n    },\n    {\n      // RFC7273\n      // a=mediaclk:direct=963214424\n      name:'mediaClk',\n      reg: /^mediaclk:(?:id=(\\S*))? *([^\\s=]*)(?:=(\\S*))?(?: *rate=(\\d+)\\/(\\d+))?/,\n      names: ['id', 'mediaClockName', 'mediaClockValue', 'rateNumerator', 'rateDenominator'],\n      format: function (o) {\n        var str = 'mediaclk:';\n        str += (o.id != null ? 'id=%s %s' : '%v%s');\n        str += (o.mediaClockValue != null ? '=%s' : '');\n        str += (o.rateNumerator != null ? ' rate=%s' : '');\n        str += (o.rateDenominator != null ? '/%s' : '');\n        return str;\n      }\n    },\n    {\n      // a=keywds:keywords\n      name: 'keywords',\n      reg: /^keywds:(.+)$/,\n      format: 'keywds:%s'\n    },\n    {\n      // a=content:main\n      name: 'content',\n      reg: /^content:(.+)/,\n      format: 'content:%s'\n    },\n    // BFCP https://tools.ietf.org/html/rfc4583\n    {\n      // a=floorctrl:c-s\n      name: 'bfcpFloorCtrl',\n      reg: /^floorctrl:(c-only|s-only|c-s)/,\n      format: 'floorctrl:%s'\n    },\n    {\n      // a=confid:1\n      name: 'bfcpConfId',\n      reg: /^confid:(\\d+)/,\n      format: 'confid:%s'\n    },\n    {\n      // a=userid:1\n      name: 'bfcpUserId',\n      reg: /^userid:(\\d+)/,\n      format: 'userid:%s'\n    },\n    {\n      // a=floorid:1\n      name: 'bfcpFloorId',\n      reg: /^floorid:(.+) (?:m-stream|mstrm):(.+)/,\n      names: ['id', 'mStream'],\n      format: 'floorid:%s mstrm:%s'\n    },\n    {\n      // any a= that we don't understand is kept verbatim on media.invalid\n      push: 'invalid',\n      names: ['value']\n    }\n  ]\n};\n\n// set sensible defaults to avoid polluting the grammar with boring details\nObject.keys(grammar).forEach(function (key) {\n  var objs = grammar[key];\n  objs.forEach(function (obj) {\n    if (!obj.reg) {\n      obj.reg = /(.*)/;\n    }\n    if (!obj.format) {\n      obj.format = '%s';\n    }\n  });\n});\n","var parser = require('./parser');\nvar writer = require('./writer');\n\nexports.write = writer;\nexports.parse = parser.parse;\nexports.parseParams = parser.parseParams;\nexports.parseFmtpConfig = parser.parseFmtpConfig; // Alias of parseParams().\nexports.parsePayloads = parser.parsePayloads;\nexports.parseRemoteCandidates = parser.parseRemoteCandidates;\nexports.parseImageAttributes = parser.parseImageAttributes;\nexports.parseSimulcastStreamList = parser.parseSimulcastStreamList;\n","var toIntIfInt = function (v) {\n  return String(Number(v)) === v ? Number(v) : v;\n};\n\nvar attachProperties = function (match, location, names, rawName) {\n  if (rawName && !names) {\n    location[rawName] = toIntIfInt(match[1]);\n  }\n  else {\n    for (var i = 0; i < names.length; i += 1) {\n      if (match[i+1] != null) {\n        location[names[i]] = toIntIfInt(match[i+1]);\n      }\n    }\n  }\n};\n\nvar parseReg = function (obj, location, content) {\n  var needsBlank = obj.name && obj.names;\n  if (obj.push && !location[obj.push]) {\n    location[obj.push] = [];\n  }\n  else if (needsBlank && !location[obj.name]) {\n    location[obj.name] = {};\n  }\n  var keyLocation = obj.push ?\n    {} :  // blank object that will be pushed\n    needsBlank ? location[obj.name] : location; // otherwise, named location or root\n\n  attachProperties(content.match(obj.reg), keyLocation, obj.names, obj.name);\n\n  if (obj.push) {\n    location[obj.push].push(keyLocation);\n  }\n};\n\nvar grammar = require('./grammar');\nvar validLine = RegExp.prototype.test.bind(/^([a-z])=(.*)/);\n\nexports.parse = function (sdp) {\n  var session = {}\n    , media = []\n    , location = session; // points at where properties go under (one of the above)\n\n  // parse lines we understand\n  sdp.split(/(\\r\\n|\\r|\\n)/).filter(validLine).forEach(function (l) {\n    var type = l[0];\n    var content = l.slice(2);\n    if (type === 'm') {\n      media.push({rtp: [], fmtp: []});\n      location = media[media.length-1]; // point at latest media line\n    }\n\n    for (var j = 0; j < (grammar[type] || []).length; j += 1) {\n      var obj = grammar[type][j];\n      if (obj.reg.test(content)) {\n        return parseReg(obj, location, content);\n      }\n    }\n  });\n\n  session.media = media; // link it up\n  return session;\n};\n\nvar paramReducer = function (acc, expr) {\n  var s = expr.split(/=(.+)/, 2);\n  if (s.length === 2) {\n    acc[s[0]] = toIntIfInt(s[1]);\n  } else if (s.length === 1 && expr.length > 1) {\n    acc[s[0]] = undefined;\n  }\n  return acc;\n};\n\nexports.parseParams = function (str) {\n  return str.split(/;\\s?/).reduce(paramReducer, {});\n};\n\n// For backward compatibility - alias will be removed in 3.0.0\nexports.parseFmtpConfig = exports.parseParams;\n\nexports.parsePayloads = function (str) {\n  return str.toString().split(' ').map(Number);\n};\n\nexports.parseRemoteCandidates = function (str) {\n  var candidates = [];\n  var parts = str.split(' ').map(toIntIfInt);\n  for (var i = 0; i < parts.length; i += 3) {\n    candidates.push({\n      component: parts[i],\n      ip: parts[i + 1],\n      port: parts[i + 2]\n    });\n  }\n  return candidates;\n};\n\nexports.parseImageAttributes = function (str) {\n  return str.split(' ').map(function (item) {\n    return item.substring(1, item.length-1).split(',').reduce(paramReducer, {});\n  });\n};\n\nexports.parseSimulcastStreamList = function (str) {\n  return str.split(';').map(function (stream) {\n    return stream.split(',').map(function (format) {\n      var scid, paused = false;\n\n      if (format[0] !== '~') {\n        scid = toIntIfInt(format);\n      } else {\n        scid = toIntIfInt(format.substring(1, format.length));\n        paused = true;\n      }\n\n      return {\n        scid: scid,\n        paused: paused\n      };\n    });\n  });\n};\n","var grammar = require('./grammar');\n\n// customized util.format - discards excess arguments and can void middle ones\nvar formatRegExp = /%[sdv%]/g;\nvar format = function (formatStr) {\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  return formatStr.replace(formatRegExp, function (x) {\n    if (i >= len) {\n      return x; // missing argument\n    }\n    var arg = args[i];\n    i += 1;\n    switch (x) {\n    case '%%':\n      return '%';\n    case '%s':\n      return String(arg);\n    case '%d':\n      return Number(arg);\n    case '%v':\n      return '';\n    }\n  });\n  // NB: we discard excess arguments - they are typically undefined from makeLine\n};\n\nvar makeLine = function (type, obj, location) {\n  var str = obj.format instanceof Function ?\n    (obj.format(obj.push ? location : location[obj.name])) :\n    obj.format;\n\n  var args = [type + '=' + str];\n  if (obj.names) {\n    for (var i = 0; i < obj.names.length; i += 1) {\n      var n = obj.names[i];\n      if (obj.name) {\n        args.push(location[obj.name][n]);\n      }\n      else { // for mLine and push attributes\n        args.push(location[obj.names[i]]);\n      }\n    }\n  }\n  else {\n    args.push(location[obj.name]);\n  }\n  return format.apply(null, args);\n};\n\n// RFC specified order\n// TODO: extend this with all the rest\nvar defaultOuterOrder = [\n  'v', 'o', 's', 'i',\n  'u', 'e', 'p', 'c',\n  'b', 't', 'r', 'z', 'a'\n];\nvar defaultInnerOrder = ['i', 'c', 'b', 'a'];\n\n\nmodule.exports = function (session, opts) {\n  opts = opts || {};\n  // ensure certain properties exist\n  if (session.version == null) {\n    session.version = 0; // 'v=0' must be there (only defined version atm)\n  }\n  if (session.name == null) {\n    session.name = ' '; // 's= ' must be there if no meaningful name set\n  }\n  session.media.forEach(function (mLine) {\n    if (mLine.payloads == null) {\n      mLine.payloads = '';\n    }\n  });\n\n  var outerOrder = opts.outerOrder || defaultOuterOrder;\n  var innerOrder = opts.innerOrder || defaultInnerOrder;\n  var sdp = [];\n\n  // loop through outerOrder for matching properties on session\n  outerOrder.forEach(function (type) {\n    grammar[type].forEach(function (obj) {\n      if (obj.name in session && session[obj.name] != null) {\n        sdp.push(makeLine(type, obj, session));\n      }\n      else if (obj.push in session && session[obj.push] != null) {\n        session[obj.push].forEach(function (el) {\n          sdp.push(makeLine(type, obj, el));\n        });\n      }\n    });\n  });\n\n  // then for each media line, follow the innerOrder\n  session.media.forEach(function (mLine) {\n    sdp.push(makeLine('m', grammar.m[0], mLine));\n\n    innerOrder.forEach(function (type) {\n      grammar[type].forEach(function (obj) {\n        if (obj.name in mLine && mLine[obj.name] != null) {\n          sdp.push(makeLine(type, obj, mLine));\n        }\n        else if (obj.push in mLine && mLine[obj.push] != null) {\n          mLine[obj.push].forEach(function (el) {\n            sdp.push(makeLine(type, obj, el));\n          });\n        }\n      });\n    });\n  });\n\n  return sdp.join('\\r\\n') + '\\r\\n';\n};\n","'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n","'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n","\nvar space = require('to-space-case')\n\n/**\n * Export.\n */\n\nmodule.exports = toCamelCase\n\n/**\n * Convert a `string` to camel case.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction toCamelCase(string) {\n  return space(string).replace(/\\s(\\w)/g, function (matches, letter) {\n    return letter.toUpperCase()\n  })\n}\n","\n/**\n * Export.\n */\n\nmodule.exports = toNoCase\n\n/**\n * Test whether a string is camel-case.\n */\n\nvar hasSpace = /\\s/\nvar hasSeparator = /(_|-|\\.|:)/\nvar hasCamel = /([a-z][A-Z]|[A-Z][a-z])/\n\n/**\n * Remove any starting case from a `string`, like camel or snake, but keep\n * spaces and punctuation that may be important otherwise.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction toNoCase(string) {\n  if (hasSpace.test(string)) return string.toLowerCase()\n  if (hasSeparator.test(string)) return (unseparate(string) || string).toLowerCase()\n  if (hasCamel.test(string)) return uncamelize(string).toLowerCase()\n  return string.toLowerCase()\n}\n\n/**\n * Separator splitter.\n */\n\nvar separatorSplitter = /[\\W_]+(.|$)/g\n\n/**\n * Un-separate a `string`.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction unseparate(string) {\n  return string.replace(separatorSplitter, function (m, next) {\n    return next ? ' ' + next : ''\n  })\n}\n\n/**\n * Camelcase splitter.\n */\n\nvar camelSplitter = /(.)([A-Z]+)/g\n\n/**\n * Un-camelcase a `string`.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction uncamelize(string) {\n  return string.replace(camelSplitter, function (m, previous, uppers) {\n    return previous + ' ' + uppers.toLowerCase().split('').join(' ')\n  })\n}\n","\nvar clean = require('to-no-case')\n\n/**\n * Export.\n */\n\nmodule.exports = toSpaceCase\n\n/**\n * Convert a `string` to space case.\n *\n * @param {String} string\n * @return {String}\n */\n\nfunction toSpaceCase(string) {\n  return clean(string).replace(/[\\W_]+(.|$)/g, function (matches, match) {\n    return match ? ' ' + match : ''\n  }).trim()\n}\n","/*! https://mths.be/utf8js v3.0.0 by @mathias */\n;(function(root) {\n\n\tvar stringFromCharCode = String.fromCharCode;\n\n\t// Taken from https://mths.be/punycode\n\tfunction ucs2decode(string) {\n\t\tvar output = [];\n\t\tvar counter = 0;\n\t\tvar length = string.length;\n\t\tvar value;\n\t\tvar extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t// Taken from https://mths.be/punycode\n\tfunction ucs2encode(array) {\n\t\tvar length = array.length;\n\t\tvar index = -1;\n\t\tvar value;\n\t\tvar output = '';\n\t\twhile (++index < length) {\n\t\t\tvalue = array[index];\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t}\n\t\treturn output;\n\t}\n\n\tfunction checkScalarValue(codePoint) {\n\t\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t}\n\t/*--------------------------------------------------------------------------*/\n\n\tfunction createByte(codePoint, shift) {\n\t\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n\t}\n\n\tfunction encodeCodePoint(codePoint) {\n\t\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\t\treturn stringFromCharCode(codePoint);\n\t\t}\n\t\tvar symbol = '';\n\t\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t\t}\n\t\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\t\tcheckScalarValue(codePoint);\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\t\tsymbol += createByte(codePoint, 6);\n\t\t}\n\t\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\t\tsymbol += createByte(codePoint, 12);\n\t\t\tsymbol += createByte(codePoint, 6);\n\t\t}\n\t\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\t\treturn symbol;\n\t}\n\n\tfunction utf8encode(string) {\n\t\tvar codePoints = ucs2decode(string);\n\t\tvar length = codePoints.length;\n\t\tvar index = -1;\n\t\tvar codePoint;\n\t\tvar byteString = '';\n\t\twhile (++index < length) {\n\t\t\tcodePoint = codePoints[index];\n\t\t\tbyteString += encodeCodePoint(codePoint);\n\t\t}\n\t\treturn byteString;\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\tfunction readContinuationByte() {\n\t\tif (byteIndex >= byteCount) {\n\t\t\tthrow Error('Invalid byte index');\n\t\t}\n\n\t\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\t\tbyteIndex++;\n\n\t\tif ((continuationByte & 0xC0) == 0x80) {\n\t\t\treturn continuationByte & 0x3F;\n\t\t}\n\n\t\t// If we end up here, it’s not a continuation byte\n\t\tthrow Error('Invalid continuation byte');\n\t}\n\n\tfunction decodeSymbol() {\n\t\tvar byte1;\n\t\tvar byte2;\n\t\tvar byte3;\n\t\tvar byte4;\n\t\tvar codePoint;\n\n\t\tif (byteIndex > byteCount) {\n\t\t\tthrow Error('Invalid byte index');\n\t\t}\n\n\t\tif (byteIndex == byteCount) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Read first byte\n\t\tbyte1 = byteArray[byteIndex] & 0xFF;\n\t\tbyteIndex++;\n\n\t\t// 1-byte sequence (no continuation bytes)\n\t\tif ((byte1 & 0x80) == 0) {\n\t\t\treturn byte1;\n\t\t}\n\n\t\t// 2-byte sequence\n\t\tif ((byte1 & 0xE0) == 0xC0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\t\tif (codePoint >= 0x80) {\n\t\t\t\treturn codePoint;\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid continuation byte');\n\t\t\t}\n\t\t}\n\n\t\t// 3-byte sequence (may include unpaired surrogates)\n\t\tif ((byte1 & 0xF0) == 0xE0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tbyte3 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\t\tif (codePoint >= 0x0800) {\n\t\t\t\tcheckScalarValue(codePoint);\n\t\t\t\treturn codePoint;\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid continuation byte');\n\t\t\t}\n\t\t}\n\n\t\t// 4-byte sequence\n\t\tif ((byte1 & 0xF8) == 0xF0) {\n\t\t\tbyte2 = readContinuationByte();\n\t\t\tbyte3 = readContinuationByte();\n\t\t\tbyte4 = readContinuationByte();\n\t\t\tcodePoint = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0C) |\n\t\t\t\t(byte3 << 0x06) | byte4;\n\t\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\t\treturn codePoint;\n\t\t\t}\n\t\t}\n\n\t\tthrow Error('Invalid UTF-8 detected');\n\t}\n\n\tvar byteArray;\n\tvar byteCount;\n\tvar byteIndex;\n\tfunction utf8decode(byteString) {\n\t\tbyteArray = ucs2decode(byteString);\n\t\tbyteCount = byteArray.length;\n\t\tbyteIndex = 0;\n\t\tvar codePoints = [];\n\t\tvar tmp;\n\t\twhile ((tmp = decodeSymbol()) !== false) {\n\t\t\tcodePoints.push(tmp);\n\t\t}\n\t\treturn ucs2encode(codePoints);\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\troot.version = '3.0.0';\n\troot.encode = utf8encode;\n\troot.decode = utf8decode;\n\n}(typeof exports === 'undefined' ? this.utf8 = {} : exports));\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"NIL\", {\n  enumerable: true,\n  get: function get() {\n    return _nil.default;\n  }\n});\nObject.defineProperty(exports, \"parse\", {\n  enumerable: true,\n  get: function get() {\n    return _parse.default;\n  }\n});\nObject.defineProperty(exports, \"stringify\", {\n  enumerable: true,\n  get: function get() {\n    return _stringify.default;\n  }\n});\nObject.defineProperty(exports, \"v1\", {\n  enumerable: true,\n  get: function get() {\n    return _v.default;\n  }\n});\nObject.defineProperty(exports, \"v3\", {\n  enumerable: true,\n  get: function get() {\n    return _v2.default;\n  }\n});\nObject.defineProperty(exports, \"v4\", {\n  enumerable: true,\n  get: function get() {\n    return _v3.default;\n  }\n});\nObject.defineProperty(exports, \"v5\", {\n  enumerable: true,\n  get: function get() {\n    return _v4.default;\n  }\n});\nObject.defineProperty(exports, \"validate\", {\n  enumerable: true,\n  get: function get() {\n    return _validate.default;\n  }\n});\nObject.defineProperty(exports, \"version\", {\n  enumerable: true,\n  get: function get() {\n    return _version.default;\n  }\n});\n\nvar _v = _interopRequireDefault(require(\"./v1.js\"));\n\nvar _v2 = _interopRequireDefault(require(\"./v3.js\"));\n\nvar _v3 = _interopRequireDefault(require(\"./v4.js\"));\n\nvar _v4 = _interopRequireDefault(require(\"./v5.js\"));\n\nvar _nil = _interopRequireDefault(require(\"./nil.js\"));\n\nvar _version = _interopRequireDefault(require(\"./version.js\"));\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nvar _stringify = _interopRequireDefault(require(\"./stringify.js\"));\n\nvar _parse = _interopRequireDefault(require(\"./parse.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  const output = [];\n  const length32 = input.length * 32;\n  const hexTab = '0123456789abcdef';\n\n  for (let i = 0; i < length32; i += 8) {\n    const x = input[i >> 5] >>> i % 32 & 0xff;\n    const hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  let a = 1732584193;\n  let b = -271733879;\n  let c = -1732584194;\n  let d = 271733878;\n\n  for (let i = 0; i < x.length; i += 16) {\n    const olda = a;\n    const oldb = b;\n    const oldc = c;\n    const oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  const length8 = input.length * 8;\n  const output = new Uint32Array(getOutputLength(length8));\n\n  for (let i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  const lsw = (x & 0xffff) + (y & 0xffff);\n  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nvar _default = md5;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nvar _default = {\n  randomUUID\n};\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = '00000000-0000-0000-0000-000000000000';\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction parse(uuid) {\n  if (!(0, _validate.default)(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  let v;\n  const arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nvar _default = parse;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = rng;\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\n\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  const l = bytes.length / 4 + 2;\n  const N = Math.ceil(l / 16);\n  const M = new Array(N);\n\n  for (let i = 0; i < N; ++i) {\n    const arr = new Uint32Array(16);\n\n    for (let j = 0; j < 16; ++j) {\n      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];\n    }\n\n    M[i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (let i = 0; i < N; ++i) {\n    const W = new Uint32Array(80);\n\n    for (let t = 0; t < 16; ++t) {\n      W[t] = M[i][t];\n    }\n\n    for (let t = 16; t < 80; ++t) {\n      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n\n    for (let t = 0; t < 80; ++t) {\n      const s = Math.floor(t / 20);\n      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nvar _default = sha1;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nexports.unsafeStringify = unsafeStringify;\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nfunction unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!(0, _validate.default)(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nvar _default = stringify;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _rng = _interopRequireDefault(require(\"./rng.js\"));\n\nvar _stringify = require(\"./stringify.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\nlet _nodeId;\n\nlet _clockseq; // Previous uuid creation time\n\n\nlet _lastMSecs = 0;\nlet _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  let i = buf && offset || 0;\n  const b = buf || new Array(16);\n  options = options || {};\n  let node = options.node || _nodeId;\n  let clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    const seedBytes = options.random || (options.rng || _rng.default)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  let msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  let nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  const dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  const tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  const tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (let n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || (0, _stringify.unsafeStringify)(b);\n}\n\nvar _default = v1;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _v = _interopRequireDefault(require(\"./v35.js\"));\n\nvar _md = _interopRequireDefault(require(\"./md5.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst v3 = (0, _v.default)('v3', 0x30, _md.default);\nvar _default = v3;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.URL = exports.DNS = void 0;\nexports.default = v35;\n\nvar _stringify = require(\"./stringify.js\");\n\nvar _parse = _interopRequireDefault(require(\"./parse.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  const bytes = [];\n\n  for (let i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nconst DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexports.DNS = DNS;\nconst URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexports.URL = URL;\n\nfunction v35(name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    var _namespace;\n\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = (0, _parse.default)(namespace);\n    }\n\n    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    let bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (let i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return (0, _stringify.unsafeStringify)(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _native = _interopRequireDefault(require(\"./native.js\"));\n\nvar _rng = _interopRequireDefault(require(\"./rng.js\"));\n\nvar _stringify = require(\"./stringify.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction v4(options, buf, offset) {\n  if (_native.default.randomUUID && !buf && !options) {\n    return _native.default.randomUUID();\n  }\n\n  options = options || {};\n\n  const rnds = options.random || (options.rng || _rng.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return (0, _stringify.unsafeStringify)(rnds);\n}\n\nvar _default = v4;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _v = _interopRequireDefault(require(\"./v35.js\"));\n\nvar _sha = _interopRequireDefault(require(\"./sha1.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst v5 = (0, _v.default)('v5', 0x50, _sha.default);\nvar _default = v5;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regex = _interopRequireDefault(require(\"./regex.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && _regex.default.test(uuid);\n}\n\nvar _default = validate;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction version(uuid) {\n  if (!(0, _validate.default)(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  return parseInt(uuid.slice(14, 15), 16);\n}\n\nvar _default = version;\nexports.default = _default;","var Rule = function Rule(name, fn, args, modifiers) {\n  this.name = name;\n  this.fn = fn;\n  this.args = args;\n  this.modifiers = modifiers;\n};\n\nRule.prototype._test = function _test (value) {\n  var fn = this.fn;\n\n  try {\n    testAux(this.modifiers.slice(), fn, this)(value);\n  } catch (ex) {\n    fn = function () { return false; };\n  }\n\n  try {\n    return testAux(this.modifiers.slice(), fn, this)(value);\n  } catch (ex$1) {\n    return false;\n  }\n};\n\nRule.prototype._check = function _check (value) {\n  try {\n    testAux(this.modifiers.slice(), this.fn, this)(value);\n  } catch (ex) {\n    if (testAux(this.modifiers.slice(), function (it) { return it; }, this)(false)) {\n      return;\n    }\n  }\n\n  if (!testAux(this.modifiers.slice(), this.fn, this)(value)) {\n    throw null;\n  }\n};\n\nRule.prototype._testAsync = function _testAsync (value) {\n    var this$1 = this;\n\n  return new Promise(function (resolve, reject) {\n    testAsyncAux(\n      this$1.modifiers.slice(),\n      this$1.fn,\n      this$1\n    )(value)\n      .then(function (valid) {\n        if (valid) {\n          resolve(value);\n        } else {\n          reject(null);\n        }\n      })\n      .catch(function (ex) { return reject(ex); });\n  });\n};\n\nfunction pickFn(fn, variant) {\n  if ( variant === void 0 ) variant = 'simple';\n\n  return typeof fn === 'object' ? fn[variant] : fn;\n}\n\nfunction testAux(modifiers, fn, rule) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAux(modifiers, fn, rule);\n    return modifier.perform(nextFn, rule);\n  } else {\n    return pickFn(fn);\n  }\n}\n\nfunction testAsyncAux(modifiers, fn, rule) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAsyncAux(modifiers, fn, rule);\n    return modifier.performAsync(nextFn, rule);\n  } else {\n    return function (value) { return Promise.resolve(pickFn(fn, 'async')(value)); };\n  }\n}\n\nvar Modifier = function Modifier(name, perform, performAsync) {\n  this.name = name;\n  this.perform = perform;\n  this.performAsync = performAsync;\n};\n\nvar ValidationError = /*@__PURE__*/(function (Error) {\n  function ValidationError(rule, value, cause, target) {\n    var remaining = [], len = arguments.length - 4;\n    while ( len-- > 0 ) remaining[ len ] = arguments[ len + 4 ];\n\n    Error.call(this, remaining);\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ValidationError);\n    }\n    this.rule = rule;\n    this.value = value;\n    this.cause = cause;\n    this.target = target;\n  }\n\n  if ( Error ) ValidationError.__proto__ = Error;\n  ValidationError.prototype = Object.create( Error && Error.prototype );\n  ValidationError.prototype.constructor = ValidationError;\n\n  return ValidationError;\n}(Error));\n\nvar Context = function Context(chain, nextRuleModifiers) {\n  if ( chain === void 0 ) chain = [];\n  if ( nextRuleModifiers === void 0 ) nextRuleModifiers = [];\n\n  this.chain = chain;\n  this.nextRuleModifiers = nextRuleModifiers;\n};\n\nContext.prototype._applyRule = function _applyRule (ruleFn, name) {\n    var this$1 = this;\n\n  return function () {\n      var args = [], len = arguments.length;\n      while ( len-- ) args[ len ] = arguments[ len ];\n\n    this$1.chain.push(\n      new Rule(name, ruleFn.apply(this$1, args), args, this$1.nextRuleModifiers)\n    );\n    this$1.nextRuleModifiers = [];\n    return this$1;\n  };\n};\n\nContext.prototype._applyModifier = function _applyModifier (modifier, name) {\n  this.nextRuleModifiers.push(\n    new Modifier(name, modifier.simple, modifier.async)\n  );\n  return this;\n};\n\nContext.prototype._clone = function _clone () {\n  return new Context(this.chain.slice(), this.nextRuleModifiers.slice());\n};\n\nContext.prototype.test = function test (value) {\n  return this.chain.every(function (rule) { return rule._test(value); });\n};\n\nContext.prototype.testAll = function testAll (value) {\n  var err = [];\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      err.push(new ValidationError(rule, value, ex));\n    }\n  });\n  return err;\n};\n\nContext.prototype.check = function check (value) {\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      throw new ValidationError(rule, value, ex);\n    }\n  });\n};\n\nContext.prototype.testAsync = function testAsync (value) {\n    var this$1 = this;\n\n  return new Promise(function (resolve, reject) {\n    executeAsyncRules(value, this$1.chain.slice(), resolve, reject);\n  });\n};\n\nfunction executeAsyncRules(value, rules, resolve, reject) {\n  if (rules.length) {\n    var rule = rules.shift();\n    rule._testAsync(value).then(\n      function () {\n        executeAsyncRules(value, rules, resolve, reject);\n      },\n      function (cause) {\n        reject(new ValidationError(rule, value, cause));\n      }\n    );\n  } else {\n    resolve(value);\n  }\n}\n\nvar consideredEmpty = function (value, considerTrimmedEmptyString) {\n  if (\n    considerTrimmedEmptyString &&\n    typeof value === 'string' &&\n    value.trim().length === 0\n  ) {\n    return true;\n  }\n\n  return value === undefined || value === null;\n};\n\nfunction optional (validation, considerTrimmedEmptyString) {\n  if ( considerTrimmedEmptyString === void 0 ) considerTrimmedEmptyString = false;\n\n  return ({\n  simple: function (value) { return consideredEmpty(value, considerTrimmedEmptyString) ||\n    validation.check(value) === undefined; },\n  async: function (value) { return consideredEmpty(value, considerTrimmedEmptyString) ||\n    validation.testAsync(value); },\n});\n}\n\nfunction v8n() {\n  return typeof Proxy !== 'undefined'\n    ? proxyContext(new Context())\n    : proxylessContext(new Context());\n}\n\n// Custom rules\nvar customRules = {};\n\nv8n.extend = function(newRules) {\n  Object.assign(customRules, newRules);\n};\n\nv8n.clearCustomRules = function() {\n  customRules = {};\n};\n\nfunction proxyContext(context) {\n  return new Proxy(context, {\n    get: function get(obj, prop) {\n      if (prop in obj) {\n        return obj[prop];\n      }\n\n      var newContext = proxyContext(context._clone());\n\n      if (prop in availableModifiers) {\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n      if (prop in customRules) {\n        return newContext._applyRule(customRules[prop], prop);\n      }\n      if (prop in availableRules) {\n        return newContext._applyRule(availableRules[prop], prop);\n      }\n    },\n  });\n}\n\nfunction proxylessContext(context) {\n  var addRuleSet = function (ruleSet, targetContext) {\n    Object.keys(ruleSet).forEach(function (prop) {\n      targetContext[prop] = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var newContext = proxylessContext(targetContext._clone());\n        var contextWithRuleApplied = newContext._applyRule(\n          ruleSet[prop],\n          prop\n        ).apply(void 0, args);\n        return contextWithRuleApplied;\n      };\n    });\n    return targetContext;\n  };\n\n  var contextWithAvailableRules = addRuleSet(availableRules, context);\n  var contextWithAllRules = addRuleSet(\n    customRules,\n    contextWithAvailableRules\n  );\n\n  Object.keys(availableModifiers).forEach(function (prop) {\n    Object.defineProperty(contextWithAllRules, prop, {\n      get: function () {\n        var newContext = proxylessContext(contextWithAllRules._clone());\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      },\n    });\n  });\n\n  return contextWithAllRules;\n}\n\nvar availableModifiers = {\n  not: {\n    simple: function (fn) { return function (value) { return !fn(value); }; },\n    async: function (fn) { return function (value) { return Promise.resolve(fn(value))\n        .then(function (result) { return !result; })\n        .catch(function () { return true; }); }; },\n  },\n\n  some: {\n    simple: function (fn) { return function (value) {\n      return split(value).some(function (item) {\n        try {\n          return fn(item);\n        } catch (ex) {\n          return false;\n        }\n      });\n    }; },\n    async: function (fn) { return function (value) {\n      return Promise.all(\n        split(value).map(function (item) {\n          try {\n            return fn(item).catch(function () { return false; });\n          } catch (ex) {\n            return false;\n          }\n        })\n      ).then(function (result) { return result.some(Boolean); });\n    }; },\n  },\n\n  every: {\n    simple: function (fn) { return function (value) { return value !== false && split(value).every(fn); }; },\n    async: function (fn) { return function (value) { return Promise.all(split(value).map(fn)).then(function (result) { return result.every(Boolean); }); }; },\n  },\n\n  strict: {\n    simple: function (fn, rule) { return function (value) {\n      if (isSchemaRule(rule) && value && typeof value === 'object') {\n        return (\n          Object.keys(rule.args[0]).length === Object.keys(value).length &&\n          fn(value)\n        );\n      }\n      return fn(value);\n    }; },\n    async: function (fn, rule) { return function (value) { return Promise.resolve(fn(value))\n        .then(function (result) {\n          if (isSchemaRule(rule) && value && typeof value === 'object') {\n            return (\n              Object.keys(rule.args[0]).length === Object.keys(value).length &&\n              result\n            );\n          }\n          return result;\n        })\n        .catch(function () { return false; }); }; },\n  },\n};\n\nfunction isSchemaRule(rule) {\n  return (\n    rule &&\n    rule.name === 'schema' &&\n    rule.args.length > 0 &&\n    typeof rule.args[0] === 'object'\n  );\n}\n\nfunction split(value) {\n  if (typeof value === 'string') {\n    return value.split('');\n  }\n  return value;\n}\n\nvar availableRules = {\n  // Value\n\n  equal: function (expected) { return function (value) { return value == expected; }; },\n\n  exact: function (expected) { return function (value) { return value === expected; }; },\n\n  // Types\n\n  number: function (allowInfinite) {\n    if ( allowInfinite === void 0 ) allowInfinite = true;\n\n    return function (value) { return typeof value === 'number' && (allowInfinite || isFinite(value)); };\n},\n\n  integer: function () { return function (value) {\n    var isInteger = Number.isInteger || isIntegerPolyfill;\n    return isInteger(value);\n  }; },\n\n  numeric: function () { return function (value) { return !isNaN(parseFloat(value)) && isFinite(value); }; },\n\n  string: function () { return testType('string'); },\n\n  boolean: function () { return testType('boolean'); },\n\n  undefined: function () { return testType('undefined'); },\n\n  null: function () { return testType('null'); },\n\n  array: function () { return testType('array'); },\n\n  object: function () { return testType('object'); },\n\n  instanceOf: function (instance) { return function (value) { return value instanceof instance; }; },\n\n  // Pattern\n\n  pattern: function (expected) { return function (value) { return expected.test(value); }; },\n\n  lowercase: function () { return function (value) {\n    return (\n      typeof value === 'boolean' ||\n      (value === value.toLowerCase() && value.trim() !== '')\n    );\n  }; },\n\n  uppercase: function () { return function (value) { return value === value.toUpperCase() && value.trim() !== ''; }; },\n\n  vowel: function () { return function (value) { return /^[aeiou]+$/i.test(value); }; },\n\n  consonant: function () { return function (value) { return /^(?=[^aeiou])([a-z]+)$/i.test(value); }; },\n\n  // Value at\n\n  first: function (expected) { return function (value) { return value[0] == expected; }; },\n\n  last: function (expected) { return function (value) { return value[value.length - 1] == expected; }; },\n\n  // Length\n\n  empty: function () { return function (value) { return value.length === 0; }; },\n\n  length: function (min, max) { return function (value) { return value.length >= min && value.length <= (max || min); }; },\n\n  minLength: function (min) { return function (value) { return value.length >= min; }; },\n\n  maxLength: function (max) { return function (value) { return value.length <= max; }; },\n\n  // Range\n\n  negative: function () { return function (value) { return value < 0; }; },\n\n  positive: function () { return function (value) { return value >= 0; }; },\n\n  between: function (a, b) { return function (value) { return value >= a && value <= b; }; },\n\n  range: function (a, b) { return function (value) { return value >= a && value <= b; }; },\n\n  lessThan: function (n) { return function (value) { return value < n; }; },\n\n  lessThanOrEqual: function (n) { return function (value) { return value <= n; }; },\n\n  greaterThan: function (n) { return function (value) { return value > n; }; },\n\n  greaterThanOrEqual: function (n) { return function (value) { return value >= n; }; },\n\n  // Divisible\n\n  even: function () { return function (value) { return value % 2 === 0; }; },\n\n  odd: function () { return function (value) { return value % 2 !== 0; }; },\n\n  includes: function (expected) { return function (value) { return ~value.indexOf(expected); }; },\n\n  schema: function (schema) { return testSchema(schema); },\n\n  // branching\n\n  passesAnyOf: function () {\n    var validations = [], len = arguments.length;\n    while ( len-- ) validations[ len ] = arguments[ len ];\n\n    return function (value) { return validations.some(function (validation) { return validation.test(value); }); };\n},\n\n  optional: optional,\n};\n\nfunction testType(expected) {\n  return function (value) {\n    return (\n      (Array.isArray(value) && expected === 'array') ||\n      (value === null && expected === 'null') ||\n      typeof value === expected\n    );\n  };\n}\n\nfunction isIntegerPolyfill(value) {\n  return (\n    typeof value === 'number' && isFinite(value) && Math.floor(value) === value\n  );\n}\n\nfunction testSchema(schema) {\n  return {\n    simple: function (value) {\n      var causes = [];\n      Object.keys(schema).forEach(function (key) {\n        var nestedValidation = schema[key];\n        try {\n          nestedValidation.check((value || {})[key]);\n        } catch (ex) {\n          ex.target = key;\n          causes.push(ex);\n        }\n      });\n      if (causes.length > 0) {\n        throw causes;\n      }\n      return true;\n    },\n    async: function (value) {\n      var causes = [];\n      var nested = Object.keys(schema).map(function (key) {\n        var nestedValidation = schema[key];\n        return nestedValidation.testAsync((value || {})[key]).catch(function (ex) {\n          ex.target = key;\n          causes.push(ex);\n        });\n      });\n      return Promise.all(nested).then(function () {\n        if (causes.length > 0) {\n          throw causes;\n        }\n\n        return true;\n      });\n    },\n  };\n}\n\nexport default v8n;\n","'use strict';\n\nvar chalk = require('chalk');\n\nvar typeColors = {\n  modified: 'yellow',\n  added: 'green',\n  removed: 'red'\n};\n\nvar defaultOptions = {\n  indent: '  ',\n  newLine: '\\n',\n  wrap: function wrap(type, text) {\n    return chalk[typeColors[type]](text);\n  },\n  color: true\n};\n\nfunction isObject(obj) {\n  return typeof obj === 'object' && obj && !Array.isArray(obj);\n}\n\nfunction printVar(variable) {\n  if (typeof variable === 'function') {\n    return variable.toString().replace(/\\{.+\\}/,'{}');\n  } else if((typeof variable === 'object' || typeof variable === 'string') && !(variable instanceof RegExp)) {\n    return JSON.stringify(variable);\n  }\n\n  return '' + variable;\n}\n\nfunction indentSubItem(text, options) {\n  return text.split(options.newLine).map(function onMap(line, index) {\n    if (index === 0) {\n      return line;\n    }\n    return options.indent + line;\n  }).join(options.newLine);\n}\n\nfunction keyChanged(key, text, options) {\n  return options.indent + key + ': ' + indentSubItem(text, options) + options.newLine\n}\n\nfunction keyRemoved(key, variable, options) {\n  return options.wrap('removed', '- ' + key + ': ' + printVar(variable)) + options.newLine;\n}\n\nfunction keyAdded(key, variable, options) {\n  return options.wrap('added', '+ ' + key + ': ' + printVar(variable)) + options.newLine;\n}\n\nfunction diffInternal(left, right, options) {\n  var text = '';\n  var changed = false;\n  var itemDiff;\n  var keys;\n  var subOutput = '';\n\n  if (Array.isArray(left) && Array.isArray(right)) {\n    for (var i = 0; i < left.length; i++) {\n      if (i < right.length) {\n        itemDiff = diffInternal(left[i], right[i], options);\n        if (itemDiff.changed) {\n          subOutput += keyChanged(i, itemDiff.text, options);\n          changed = true;\n        }\n      } else {\n        subOutput += keyRemoved(i, left[i], options);\n        changed = true;\n      }\n    }\n    if (right.length > left.length) {\n      for (; i < right.length; i++) {\n        subOutput +=  keyAdded(i, right[i], options);\n      }\n      changed = true;\n    }\n    if (changed) {\n      text = '[' + options.newLine + subOutput + ']';\n    }\n  } else if (isObject(left) && isObject(right)) {\n    keys = Object.keys(left);\n    var rightObj = Object.assign({}, right);\n    var key;\n    keys.sort();\n    for (var i = 0; i < keys.length; i++) {\n      key = keys[i];\n      if (right.hasOwnProperty(key)) {\n        itemDiff = diffInternal(left[key], right[key], options);\n        if (itemDiff.changed) {\n          subOutput += keyChanged(key, itemDiff.text, options);\n          changed = true;\n        }\n        delete rightObj[key];\n      } else {\n        subOutput += keyRemoved(key, left[key], options);\n        changed = true;\n      }\n    }\n\n    var addedKeys = Object.keys(rightObj);\n    for (var i = 0; i < addedKeys.length; i++) {\n      subOutput += keyAdded(addedKeys[i], right[addedKeys[i]], options);\n      changed = true;\n    }\n\n    if (changed) {\n      text = '{' + options.newLine + subOutput + '}';\n    }\n\n  } else if (left !== right) {\n    text = options.wrap('modified', printVar(left) + ' => ' + printVar(right));\n    changed = true;\n  }\n\n  return {\n    changed: changed,\n    text: text\n  };\n}\n\nfunction diff(left, right, options) {\n  options = options || {};\n  if (!options.color && options.wrap) {\n    throw new Error('Can\\'t specify wrap and color options together.')\n  }\n\n  var combinedOptions = Object.assign({}, defaultOptions, options);\n  if (!combinedOptions.color) {\n    combinedOptions.wrap = function(type, text) { return text }\n  }\n\n  return diffInternal(left, right, combinedOptions)\n}\n\n\nmodule.exports = diff;","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nvar _adapter_factory = require(\"./adapter_factory.js\");\nvar adapter = (0, _adapter_factory.adapterFactory)({\n  window: typeof window === 'undefined' ? undefined : window\n});\nmodule.exports = adapter; // this is the difference from adapter_core.\n\n},{\"./adapter_factory.js\":2}],2:[function(require,module,exports){\n\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.adapterFactory = adapterFactory;\nvar utils = _interopRequireWildcard(require(\"./utils\"));\nvar chromeShim = _interopRequireWildcard(require(\"./chrome/chrome_shim\"));\nvar firefoxShim = _interopRequireWildcard(require(\"./firefox/firefox_shim\"));\nvar safariShim = _interopRequireWildcard(require(\"./safari/safari_shim\"));\nvar commonShim = _interopRequireWildcard(require(\"./common_shim\"));\nvar sdp = _interopRequireWildcard(require(\"sdp\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n\n// Browser shims.\n\n// Shimming starts here.\nfunction adapterFactory() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    window = _ref.window;\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    shimChrome: true,\n    shimFirefox: true,\n    shimSafari: true\n  };\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n  var adapter = {\n    browserDetails: browserDetails,\n    commonShim: commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp: sdp\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n  return adapter;\n}\n\n},{\"./chrome/chrome_shim\":3,\"./common_shim\":6,\"./firefox/firefox_shim\":7,\"./safari/safari_shim\":10,\"./utils\":11,\"sdp\":12}],3:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fixNegotiationNeeded = fixNegotiationNeeded;\nexports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\nexports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\nObject.defineProperty(exports, \"shimGetDisplayMedia\", {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\nexports.shimGetStats = shimGetStats;\nObject.defineProperty(exports, \"shimGetUserMedia\", {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\nexports.shimMediaStream = shimMediaStream;\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\nvar utils = _interopRequireWildcard(require(\"../utils.js\"));\nvar _getusermedia = require(\"./getusermedia\");\nvar _getdisplaymedia = require(\"./getdisplaymedia\");\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\nfunction shimOnTrack(window) {\n  if (_typeof(window) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get: function get() {\n        return this._ontrack;\n      },\n      set: function set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n      var _this = this;\n      if (!this._ontrackpoly) {\n        this._ontrackpoly = function (e) {\n          // onaddstream does not fire when a track is added to an existing\n          // stream. But stream.onaddtrack is implemented so we use that.\n          e.stream.addEventListener('addtrack', function (te) {\n            var receiver;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === te.track.id;\n              });\n            } else {\n              receiver = {\n                track: te.track\n              };\n            }\n            var event = new Event('track');\n            event.track = te.track;\n            event.receiver = receiver;\n            event.transceiver = {\n              receiver: receiver\n            };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n          e.stream.getTracks().forEach(function (track) {\n            var receiver;\n            if (window.RTCPeerConnection.prototype.getReceivers) {\n              receiver = _this.getReceivers().find(function (r) {\n                return r.track && r.track.id === track.id;\n              });\n            } else {\n              receiver = {\n                track: track\n              };\n            }\n            var event = new Event('track');\n            event.track = track;\n            event.receiver = receiver;\n            event.transceiver = {\n              receiver: receiver\n            };\n            event.streams = [e.stream];\n            _this.dispatchEvent(event);\n          });\n        };\n        this.addEventListener('addstream', this._ontrackpoly);\n      }\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver', {\n          value: {\n            receiver: e.receiver\n          }\n        });\n      }\n      return e;\n    });\n  }\n}\nfunction shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (_typeof(window) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    var shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\n      return {\n        track: track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n        var sender = origAddTrack.apply(this, arguments);\n        if (!sender) {\n          sender = shimSenderWithDtmf(this, track);\n          this._senders.push(sender);\n        }\n        return sender;\n      };\n      var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n        origRemoveTrack.apply(this, arguments);\n        var idx = this._senders.indexOf(sender);\n        if (idx !== -1) {\n          this._senders.splice(idx, 1);\n        }\n      };\n    }\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      var _this2 = this;\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(function (track) {\n        _this2._senders.push(shimSenderWithDtmf(_this2, track));\n      });\n    };\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      var _this3 = this;\n      this._senders = this._senders || [];\n      origRemoveStream.apply(this, [stream]);\n      stream.getTracks().forEach(function (track) {\n        var sender = _this3._senders.find(function (s) {\n          return s.track === track;\n        });\n        if (sender) {\n          // remove sender\n          _this3._senders.splice(_this3._senders.indexOf(sender), 1);\n        }\n      });\n    };\n  } else if (_typeof(window) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      var _this4 = this;\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this4;\n      });\n      return senders;\n    };\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get: function get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\nfunction shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    var _this5 = this;\n    var _arguments = Array.prototype.slice.call(arguments),\n      selector = _arguments[0],\n      onSucc = _arguments[1],\n      onErr = _arguments[2];\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 || typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n    var fixChromeStats_ = function fixChromeStats_(response) {\n      var standardReport = {};\n      var reports = response.result();\n      reports.forEach(function (report) {\n        var standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(function (name) {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function makeMapStats(stats) {\n      return new Map(Object.keys(stats).map(function (key) {\n        return [key, stats[key]];\n      }));\n    };\n    if (arguments.length >= 2) {\n      var successCallbackWrapper_ = function successCallbackWrapper_(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n      return origGetStats.apply(this, [successCallbackWrapper_, selector]);\n    }\n\n    // promise-support\n    return new Promise(function (resolve, reject) {\n      origGetStats.apply(_this5, [function (response) {\n        resolve(makeMapStats(fixChromeStats_(response)));\n      }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\nfunction shimSenderReceiverGetStats(window) {\n  if (!(_typeof(window) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        var _this6 = this;\n        var senders = origGetSenders.apply(this, []);\n        senders.forEach(function (sender) {\n          return sender._pc = _this6;\n        });\n        return senders;\n      };\n    }\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      var sender = this;\n      return this._pc.getStats().then(function (result) {\n        return (\n          /* Note: this will include stats of all senders that\n           *   send a track with the same id as sender.track as\n           *   it is not possible to identify the RTCRtpSender.\n           */\n          utils.filterStats(result, sender.track, true)\n        );\n      });\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n        var _this7 = this;\n        var receivers = origGetReceivers.apply(this, []);\n        receivers.forEach(function (receiver) {\n          return receiver._pc = _this7;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      var receiver = this;\n      return this._pc.getStats().then(function (result) {\n        return utils.filterStats(result, receiver.track, false);\n      });\n    };\n  }\n  if (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  var origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\n      var track = arguments[0];\n      var sender;\n      var receiver;\n      var err;\n      this.getSenders().forEach(function (s) {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(function (r) {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || sender && receiver) {\n        return Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\nfunction shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n    var _this8 = this;\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    return Object.keys(this._shimmedLocalStreams).map(function (streamId) {\n      return _this8._shimmedLocalStreams[streamId][0];\n    });\n  };\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n    if (!stream) {\n      return origAddTrack.apply(this, arguments);\n    }\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    var sender = origAddTrack.apply(this, arguments);\n    if (!this._shimmedLocalStreams[stream.id]) {\n      this._shimmedLocalStreams[stream.id] = [stream, sender];\n    } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n      this._shimmedLocalStreams[stream.id].push(sender);\n    }\n    return sender;\n  };\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    var _this9 = this;\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this9.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    var existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    var newSenders = this.getSenders().filter(function (newSender) {\n      return existingSenders.indexOf(newSender) === -1;\n    });\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    delete this._shimmedLocalStreams[stream.id];\n    return origRemoveStream.apply(this, arguments);\n  };\n  var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n    var _this10 = this;\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n    if (sender) {\n      Object.keys(this._shimmedLocalStreams).forEach(function (streamId) {\n        var idx = _this10._shimmedLocalStreams[streamId].indexOf(sender);\n        if (idx !== -1) {\n          _this10._shimmedLocalStreams[streamId].splice(idx, 1);\n        }\n        if (_this10._shimmedLocalStreams[streamId].length === 1) {\n          delete _this10._shimmedLocalStreams[streamId];\n        }\n      });\n    }\n    return origRemoveTrack.apply(this, arguments);\n  };\n}\nfunction shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  var origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n    var _this11 = this;\n    var nativeStreams = origGetLocalStreams.apply(this);\n    this._reverseStreams = this._reverseStreams || {};\n    return nativeStreams.map(function (stream) {\n      return _this11._reverseStreams[stream.id];\n    });\n  };\n  var origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    var _this12 = this;\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n    stream.getTracks().forEach(function (track) {\n      var alreadyExists = _this12.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      var newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n  var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n    origRemoveStream.apply(this, [this._streams[stream.id] || stream]);\n    delete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\n    delete this._streams[stream.id];\n  };\n  window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n    var _this13 = this;\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    var streams = [].slice.call(arguments, 1);\n    if (streams.length !== 1 || !streams[0].getTracks().find(function (t) {\n      return t === track;\n    })) {\n      // this is not fully correct but all we can manage without\n      // [[associated MediaStreams]] internal slot.\n      throw new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\n    }\n    var alreadyExists = this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n    if (alreadyExists) {\n      throw new DOMException('Track already exists.', 'InvalidAccessError');\n    }\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n    var oldStream = this._streams[stream.id];\n    if (oldStream) {\n      // this is using odd Chrome behaviour, use with caution:\n      // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n      // Note: we rely on the high-level addTrack/dtmf shim to\n      // create the sender with a dtmf sender.\n      oldStream.addTrack(track);\n\n      // Trigger ONN async.\n      Promise.resolve().then(function () {\n        _this13.dispatchEvent(new Event('negotiationneeded'));\n      });\n    } else {\n      var newStream = new window.MediaStream([track]);\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      this.addStream(newStream);\n    }\n    return this.getSenders().find(function (s) {\n      return s.track === track;\n    });\n  };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    var sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n      var externalStream = pc._reverseStreams[internalId];\n      var internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp: sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function (method) {\n    var nativeMethod = window.RTCPeerConnection.prototype[method];\n    var methodObj = _defineProperty({}, method, function () {\n      var _this14 = this;\n      var args = arguments;\n      var isLegacyCall = arguments.length && typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [function (description) {\n          var desc = replaceInternalStreamId(_this14, description);\n          args[0].apply(null, [desc]);\n        }, function (err) {\n          if (args[1]) {\n            args[1].apply(null, err);\n          }\n        }, arguments[2]]);\n      }\n      return nativeMethod.apply(this, arguments).then(function (description) {\n        return replaceInternalStreamId(_this14, description);\n      });\n    });\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n  var origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\n    if (!arguments.length || !arguments[0].type) {\n      return origSetLocalDescription.apply(this, arguments);\n    }\n    arguments[0] = replaceExternalStreamId(this, arguments[0]);\n    return origSetLocalDescription.apply(this, arguments);\n  };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  var origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\n    get: function get() {\n      var description = origLocalDescription.get.apply(this);\n      if (description.type === '') {\n        return description;\n      }\n      return replaceInternalStreamId(this, description);\n    }\n  });\n  window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n    var _this15 = this;\n    if (this.signalingState === 'closed') {\n      throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n    }\n    // We can not yet check for sender instanceof RTCRtpSender\n    // since we shim RTPSender. So we check if sender._pc is set.\n    if (!sender._pc) {\n      throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\n    }\n    var isLocal = sender._pc === this;\n    if (!isLocal) {\n      throw new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\n    }\n\n    // Search for the native stream the senders track belongs to.\n    this._streams = this._streams || {};\n    var stream;\n    Object.keys(this._streams).forEach(function (streamid) {\n      var hasTrack = _this15._streams[streamid].getTracks().find(function (track) {\n        return sender.track === track;\n      });\n      if (hasTrack) {\n        stream = _this15._streams[streamid];\n      }\n    });\n    if (stream) {\n      if (stream.getTracks().length === 1) {\n        // if this is the last track of the stream, remove the stream. This\n        // takes care of any shimmed _senders.\n        this.removeStream(this._reverseStreams[stream.id]);\n      } else {\n        // relying on the same odd chrome behaviour as above.\n        stream.removeTrack(sender.track);\n      }\n      this.dispatchEvent(new Event('negotiationneeded'));\n    }\n  };\n}\nfunction shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n        return nativeMethod.apply(this, arguments);\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nfunction fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function (e) {\n    var pc = e.target;\n    if (browserDetails.version < 72 || pc.getConfiguration && pc.getConfiguration().sdpSemantics === 'plan-b') {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n\n},{\"../utils.js\":11,\"./getdisplaymedia\":4,\"./getusermedia\":5}],4:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n    return getSourceId(constraints).then(function (sourceId) {\n      var widthSpecified = constraints.video && constraints.video.width;\n      var heightSpecified = constraints.video && constraints.video.height;\n      var frameRateSpecified = constraints.video && constraints.video.frameRate;\n      constraints.video = {\n        mandatory: {\n          chromeMediaSource: 'desktop',\n          chromeMediaSourceId: sourceId,\n          maxFrameRate: frameRateSpecified || 3\n        }\n      };\n      if (widthSpecified) {\n        constraints.video.mandatory.maxWidth = widthSpecified;\n      }\n      if (heightSpecified) {\n        constraints.video.mandatory.maxHeight = heightSpecified;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    });\n  };\n}\n\n},{}],5:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetUserMedia = shimGetUserMedia;\nvar utils = _interopRequireWildcard(require(\"../utils.js\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar logging = utils.log;\nfunction shimGetUserMedia(window, browserDetails) {\n  var navigator = window && window.navigator;\n  if (!navigator.mediaDevices) {\n    return;\n  }\n  var constraintsToChrome_ = function constraintsToChrome_(c) {\n    if (_typeof(c) !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function (key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = _typeof(c[key]) === 'object' ? c[key] : {\n        ideal: c[key]\n      };\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function oldname_(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return name === 'deviceId' ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function (mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n  var shimConstraints_ = function shimConstraints_(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && _typeof(constraints.audio) === 'object') {\n      var remap = function remap(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && _typeof(constraints.video) === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && (_typeof(face) === 'object' ? face : {\n        ideal: face\n      });\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n      if (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices().then(function (devices) {\n            devices = devices.filter(function (d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function (d) {\n              return matches.some(function (match) {\n                return d.label.toLowerCase().includes(match);\n              });\n            });\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {\n                exact: dev.deviceId\n              } : {\n                ideal: dev.deviceId\n              };\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n  var shimError_ = function shimError_(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString: function toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n  var getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function (c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function (e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (cs) {\n      return shimConstraints_(cs, function (c) {\n        return origGetUserMedia(c).then(function (stream) {\n          if (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function (track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function (e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n}\n\n},{\"../utils.js\":11}],6:[function(require,module,exports){\n/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.removeExtmapAllowMixed = removeExtmapAllowMixed;\nexports.shimAddIceCandidateNullOrEmpty = shimAddIceCandidateNullOrEmpty;\nexports.shimConnectionState = shimConnectionState;\nexports.shimMaxMessageSize = shimMaxMessageSize;\nexports.shimParameterlessSetLocalDescription = shimParameterlessSetLocalDescription;\nexports.shimRTCIceCandidate = shimRTCIceCandidate;\nexports.shimRTCIceCandidateRelayProtocol = shimRTCIceCandidateRelayProtocol;\nexports.shimSendThrowTypeError = shimSendThrowTypeError;\nvar _sdp = _interopRequireDefault(require(\"sdp\"));\nvar utils = _interopRequireWildcard(require(\"./utils\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\n    return;\n  }\n  var NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (_typeof(args) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      var nativeCandidate = new NativeRTCIceCandidate(args);\n      var parsedCandidate = _sdp[\"default\"].parseCandidate(args.candidate);\n      for (var key in parsedCandidate) {\n        if (!(key in nativeCandidate)) {\n          Object.defineProperty(nativeCandidate, key, {\n            value: parsedCandidate[key]\n          });\n        }\n      }\n\n      // Override serializer to not serialize the extra attributes.\n      nativeCandidate.toJSON = function toJSON() {\n        return {\n          candidate: nativeCandidate.candidate,\n          sdpMid: nativeCandidate.sdpMid,\n          sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n          usernameFragment: nativeCandidate.usernameFragment\n        };\n      };\n      return nativeCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\nfunction shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || window.RTCIceCandidate && 'relayProtocol' in window.RTCIceCandidate.prototype) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\n    if (e.candidate) {\n      var parsedCandidate = _sdp[\"default\"].parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp'\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\nfunction shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get: function get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n  var sctpInDescription = function sctpInDescription(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    var sections = _sdp[\"default\"].splitSections(description.sdp);\n    sections.shift();\n    return sections.some(function (mediaSection) {\n      var mLine = _sdp[\"default\"].parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n  var getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    var version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n  var getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    var canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n  var getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    var maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n    var match = _sdp[\"default\"].matchPrefix(description.sdp, 'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n  var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n    this._sctp = null;\n    // Chrome decided to not expose .sctp in plan-b mode.\n    // As usual, adapter.js has to do an 'ugly worakaround'\n    // to cover up the mess.\n    if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n      var _this$getConfiguratio = this.getConfiguration(),\n        sdpSemantics = _this$getConfiguratio.sdpSemantics;\n      if (sdpSemantics === 'plan-b') {\n        Object.defineProperty(this, 'sctp', {\n          get: function get() {\n            return typeof this._sctp === 'undefined' ? null : this._sctp;\n          },\n          enumerable: true,\n          configurable: true\n        });\n      }\n    }\n    if (sctpInDescription(arguments[0])) {\n      // Check if the remote is FF.\n      var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n      // Get the maximum message size the local peer is capable of sending\n      var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n      // Get the maximum message size of the remote peer.\n      var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n      // Determine final maximum message size\n      var maxMessageSize;\n      if (canSendMMS === 0 && remoteMMS === 0) {\n        maxMessageSize = Number.POSITIVE_INFINITY;\n      } else if (canSendMMS === 0 || remoteMMS === 0) {\n        maxMessageSize = Math.max(canSendMMS, remoteMMS);\n      } else {\n        maxMessageSize = Math.min(canSendMMS, remoteMMS);\n      }\n\n      // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n      // attribute.\n      var sctp = {};\n      Object.defineProperty(sctp, 'maxMessageSize', {\n        get: function get() {\n          return maxMessageSize;\n        }\n      });\n      this._sctp = sctp;\n    }\n    return origSetRemoteDescription.apply(this, arguments);\n  };\n}\nfunction shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    var origDataChannelSend = dc.send;\n    dc.send = function send() {\n      var data = arguments[0];\n      var length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' + pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  var origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel = function createDataChannel() {\n    var dataChannel = origCreateDataChannel.apply(this, arguments);\n    wrapDcSend(dataChannel, this);\n    return dataChannel;\n  };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', function (e) {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nfunction shimConnectionState(window) {\n  if (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get: function get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get: function get() {\n      return this._onconnectionstatechange || null;\n    },\n    set: function set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange', this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  ['setLocalDescription', 'setRemoteDescription'].forEach(function (method) {\n    var origMethod = proto[method];\n    proto[method] = function () {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = function (e) {\n          var pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            var newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\nfunction removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  var nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      var sdp = desc.sdp.split('\\n').filter(function (line) {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription && desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp: sdp\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\nfunction shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\n    if (!arguments[0]) {\n      if (arguments[1]) {\n        arguments[1].apply(null);\n      }\n      return Promise.resolve();\n    }\n    // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n    // in older versions.\n    // Native support for ignoring exists for Chrome M77+.\n    // Safari ignores as well, exact version unknown but works in the same\n    // version that also ignores addIceCandidate(null).\n    if ((browserDetails.browser === 'chrome' && browserDetails.version < 78 || browserDetails.browser === 'firefox' && browserDetails.version < 68 || browserDetails.browser === 'safari') && arguments[0] && arguments[0].candidate === '') {\n      return Promise.resolve();\n    }\n    return nativeAddIceCandidate.apply(this, arguments);\n  };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nfunction shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  var nativeSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\n    var _this = this;\n    var desc = arguments[0] || {};\n    if (_typeof(desc) !== 'object' || desc.type && desc.sdp) {\n      return nativeSetLocalDescription.apply(this, arguments);\n    }\n    // The remaining steps should technically happen when SLD comes off the\n    // RTCPeerConnection's operations chain (not ahead of going on it), but\n    // this is too difficult to shim. Instead, this shim only covers the\n    // common case where the operations chain is empty. This is imperfect, but\n    // should cover many cases. Rationale: Even if we can't reduce the glare\n    // window to zero on imperfect implementations, there's value in tapping\n    // into the perfect negotiation pattern that several browsers support.\n    desc = {\n      type: desc.type,\n      sdp: desc.sdp\n    };\n    if (!desc.type) {\n      switch (this.signalingState) {\n        case 'stable':\n        case 'have-local-offer':\n        case 'have-remote-pranswer':\n          desc.type = 'offer';\n          break;\n        default:\n          desc.type = 'answer';\n          break;\n      }\n    }\n    if (desc.sdp || desc.type !== 'offer' && desc.type !== 'answer') {\n      return nativeSetLocalDescription.apply(this, [desc]);\n    }\n    var func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n    return func.apply(this).then(function (d) {\n      return nativeSetLocalDescription.apply(_this, [d]);\n    });\n  };\n}\n\n},{\"./utils\":11,\"sdp\":12}],7:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimAddTransceiver = shimAddTransceiver;\nexports.shimCreateAnswer = shimCreateAnswer;\nexports.shimCreateOffer = shimCreateOffer;\nObject.defineProperty(exports, \"shimGetDisplayMedia\", {\n  enumerable: true,\n  get: function get() {\n    return _getdisplaymedia.shimGetDisplayMedia;\n  }\n});\nexports.shimGetParameters = shimGetParameters;\nObject.defineProperty(exports, \"shimGetUserMedia\", {\n  enumerable: true,\n  get: function get() {\n    return _getusermedia.shimGetUserMedia;\n  }\n});\nexports.shimOnTrack = shimOnTrack;\nexports.shimPeerConnection = shimPeerConnection;\nexports.shimRTCDataChannel = shimRTCDataChannel;\nexports.shimReceiverGetStats = shimReceiverGetStats;\nexports.shimRemoveStream = shimRemoveStream;\nexports.shimSenderGetStats = shimSenderGetStats;\nvar utils = _interopRequireWildcard(require(\"../utils\"));\nvar _getusermedia = require(\"./getusermedia\");\nvar _getdisplaymedia = require(\"./getdisplaymedia\");\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction shimOnTrack(window) {\n  if (_typeof(window) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return {\n          receiver: this.receiver\n        };\n      }\n    });\n  }\n}\nfunction shimPeerConnection(window, browserDetails) {\n  if (_typeof(window) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n        return nativeMethod.apply(this, arguments);\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n  }\n  var modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n  var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    var _arguments = Array.prototype.slice.call(arguments),\n      selector = _arguments[0],\n      onSucc = _arguments[1],\n      onErr = _arguments[2];\n    return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n      if (browserDetails.version < 53 && !onSucc) {\n        // Shim only promise getStats with spec-hyphens in type names\n        // Leave callback version alone; misc old uses of forEach before Map\n        try {\n          stats.forEach(function (stat) {\n            stat.type = modernStatsTypes[stat.type] || stat.type;\n          });\n        } catch (e) {\n          if (e.name !== 'TypeError') {\n            throw e;\n          }\n          // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n          stats.forEach(function (stat, i) {\n            stats.set(i, Object.assign({}, stat, {\n              type: modernStatsTypes[stat.type] || stat.type\n            }));\n          });\n        }\n      }\n      return stats;\n    }).then(onSucc, onErr);\n  };\n}\nfunction shimSenderGetStats(window) {\n  if (!(_typeof(window) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      var _this = this;\n      var senders = origGetSenders.apply(this, []);\n      senders.forEach(function (sender) {\n        return sender._pc = _this;\n      });\n      return senders;\n    };\n  }\n  var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      var sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n  };\n}\nfunction shimReceiverGetStats(window) {\n  if (!(_typeof(window) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      var _this2 = this;\n      var receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(function (receiver) {\n        return receiver._pc = _this2;\n      });\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\nfunction shimRemoveStream(window) {\n  if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n    var _this3 = this;\n    utils.deprecated('removeStream', 'removeTrack');\n    this.getSenders().forEach(function (sender) {\n      if (sender.track && stream.getTracks().includes(sender.track)) {\n        _this3.removeTrack(sender);\n      }\n    });\n  };\n}\nfunction shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\nfunction shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(_typeof(window) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver = function addTransceiver() {\n      this.setParametersPromises = [];\n      // WebIDL input coercion and validation\n      var sendEncodings = arguments[1] && arguments[1].sendEncodings;\n      if (sendEncodings === undefined) {\n        sendEncodings = [];\n      }\n      sendEncodings = _toConsumableArray(sendEncodings);\n      var shouldPerformCheck = sendEncodings.length > 0;\n      if (shouldPerformCheck) {\n        // If sendEncodings params are provided, validate grammar\n        sendEncodings.forEach(function (encodingParam) {\n          if ('rid' in encodingParam) {\n            var ridRegex = /^[a-z0-9]{0,16}$/i;\n            if (!ridRegex.test(encodingParam.rid)) {\n              throw new TypeError('Invalid RID value provided.');\n            }\n          }\n          if ('scaleResolutionDownBy' in encodingParam) {\n            if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n              throw new RangeError('scale_resolution_down_by must be >= 1.0');\n            }\n          }\n          if ('maxFramerate' in encodingParam) {\n            if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n              throw new RangeError('max_framerate must be >= 0.0');\n            }\n          }\n        });\n      }\n      var transceiver = origAddTransceiver.apply(this, arguments);\n      if (shouldPerformCheck) {\n        // Check if the init options were applied. If not we do this in an\n        // asynchronous way and save the promise reference in a global object.\n        // This is an ugly hack, but at the same time is way more robust than\n        // checking the sender parameters before and after the createOffer\n        // Also note that after the createoffer we are not 100% sure that\n        // the params were asynchronously applied so we might miss the\n        // opportunity to recreate offer.\n        var sender = transceiver.sender;\n        var params = sender.getParameters();\n        if (!('encodings' in params) ||\n        // Avoid being fooled by patched getParameters() below.\n        params.encodings.length === 1 && Object.keys(params.encodings[0]).length === 0) {\n          params.encodings = sendEncodings;\n          sender.sendEncodings = sendEncodings;\n          this.setParametersPromises.push(sender.setParameters(params).then(function () {\n            delete sender.sendEncodings;\n          })[\"catch\"](function () {\n            delete sender.sendEncodings;\n          }));\n        }\n      }\n      return transceiver;\n    };\n  }\n}\nfunction shimGetParameters(window) {\n  if (!(_typeof(window) === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  var origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters = function getParameters() {\n      var params = origGetParameters.apply(this, arguments);\n      if (!('encodings' in params)) {\n        params.encodings = [].concat(this.sendEncodings || [{}]);\n      }\n      return params;\n    };\n  }\n}\nfunction shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(_typeof(window) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    var _arguments2 = arguments,\n      _this4 = this;\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateOffer.apply(_this4, _arguments2);\n      })[\"finally\"](function () {\n        _this4.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\nfunction shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(_typeof(window) === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  var origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    var _arguments3 = arguments,\n      _this5 = this;\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises).then(function () {\n        return origCreateAnswer.apply(_this5, _arguments3);\n      })[\"finally\"](function () {\n        _this5.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n\n},{\"../utils\":11,\"./getdisplaymedia\":8,\"./getusermedia\":9}],8:[function(require,module,exports){\n/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetDisplayMedia = shimGetDisplayMedia;\nfunction shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n    if (!(constraints && constraints.video)) {\n      var err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\n      err.name = 'NotFoundError';\n      // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n      err.code = 8;\n      return Promise.reject(err);\n    }\n    if (constraints.video === true) {\n      constraints.video = {\n        mediaSource: preferredMediaSource\n      };\n    } else {\n      constraints.video.mediaSource = preferredMediaSource;\n    }\n    return window.navigator.mediaDevices.getUserMedia(constraints);\n  };\n}\n\n},{}],9:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimGetUserMedia = shimGetUserMedia;\nvar utils = _interopRequireWildcard(require(\"../utils\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction shimGetUserMedia(window, browserDetails) {\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n  navigator.getUserMedia = function (constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n  if (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function remap(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (c) {\n      if (_typeof(c) === 'object' && _typeof(c.audio) === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function () {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function (c) {\n        if (this.kind === 'audio' && _typeof(c) === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n\n},{\"../utils\":11}],10:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.shimAudioContext = shimAudioContext;\nexports.shimCallbacksAPI = shimCallbacksAPI;\nexports.shimConstraints = shimConstraints;\nexports.shimCreateOfferLegacy = shimCreateOfferLegacy;\nexports.shimGetUserMedia = shimGetUserMedia;\nexports.shimLocalStreamsAPI = shimLocalStreamsAPI;\nexports.shimRTCIceServerUrls = shimRTCIceServerUrls;\nexports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\nexports.shimTrackEventTransceiver = shimTrackEventTransceiver;\nvar utils = _interopRequireWildcard(require(\"../utils\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nfunction shimLocalStreamsAPI(window) {\n  if (_typeof(window) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      return this._localStreams;\n    };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      var _this = this;\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(function (track) {\n        return _addTrack.call(_this, track, stream);\n      });\n      stream.getVideoTracks().forEach(function (track) {\n        return _addTrack.call(_this, track, stream);\n      });\n    };\n    window.RTCPeerConnection.prototype.addTrack = function addTrack(track) {\n      var _this2 = this;\n      for (var _len = arguments.length, streams = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        streams[_key - 1] = arguments[_key];\n      }\n      if (streams) {\n        streams.forEach(function (stream) {\n          if (!_this2._localStreams) {\n            _this2._localStreams = [stream];\n          } else if (!_this2._localStreams.includes(stream)) {\n            _this2._localStreams.push(stream);\n          }\n        });\n      }\n      return _addTrack.apply(this, arguments);\n    };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      var _this3 = this;\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      var index = this._localStreams.indexOf(stream);\n      if (index === -1) {\n        return;\n      }\n      this._localStreams.splice(index, 1);\n      var tracks = stream.getTracks();\n      this.getSenders().forEach(function (sender) {\n        if (tracks.includes(sender.track)) {\n          _this3.removeTrack(sender);\n        }\n      });\n    };\n  }\n}\nfunction shimRemoteStreamsAPI(window) {\n  if (_typeof(window) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams = function getRemoteStreams() {\n      return this._remoteStreams ? this._remoteStreams : [];\n    };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get: function get() {\n        return this._onaddstream;\n      },\n      set: function set(f) {\n        var _this4 = this;\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!_this4._remoteStreams) {\n              _this4._remoteStreams = [];\n            }\n            if (_this4._remoteStreams.includes(stream)) {\n              return;\n            }\n            _this4._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            _this4.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n      var pc = this;\n      if (!this._onaddstreampoly) {\n        this.addEventListener('track', this._onaddstreampoly = function (e) {\n          e.streams.forEach(function (stream) {\n            if (!pc._remoteStreams) {\n              pc._remoteStreams = [];\n            }\n            if (pc._remoteStreams.indexOf(stream) >= 0) {\n              return;\n            }\n            pc._remoteStreams.push(stream);\n            var event = new Event('addstream');\n            event.stream = stream;\n            pc.dispatchEvent(event);\n          });\n        });\n      }\n      return origSetRemoteDescription.apply(pc, arguments);\n    };\n  }\n}\nfunction shimCallbacksAPI(window) {\n  if (_typeof(window) !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  var prototype = window.RTCPeerConnection.prototype;\n  var origCreateOffer = prototype.createOffer;\n  var origCreateAnswer = prototype.createAnswer;\n  var setLocalDescription = prototype.setLocalDescription;\n  var setRemoteDescription = prototype.setRemoteDescription;\n  var addIceCandidate = prototype.addIceCandidate;\n  prototype.createOffer = function createOffer(successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = origCreateOffer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.createAnswer = function createAnswer(successCallback, failureCallback) {\n    var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n    var promise = origCreateAnswer.apply(this, [options]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  var withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n  withCallback = function withCallback(description, successCallback, failureCallback) {\n    var promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n  withCallback = function withCallback(candidate, successCallback, failureCallback) {\n    var promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\nfunction shimGetUserMedia(window) {\n  var navigator = window && window.navigator;\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    var mediaDevices = navigator.mediaDevices;\n    var _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n  if (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\n    }.bind(navigator);\n  }\n}\nfunction shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({}, constraints, {\n      video: utils.compactObject(constraints.video)\n    });\n  }\n  return constraints;\n}\nfunction shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  var OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection = function RTCPeerConnection(pcConfig, pcConstraints) {\n    if (pcConfig && pcConfig.iceServers) {\n      var newIceServers = [];\n      for (var i = 0; i < pcConfig.iceServers.length; i++) {\n        var server = pcConfig.iceServers[i];\n        if (server.urls === undefined && server.url) {\n          utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n          server = JSON.parse(JSON.stringify(server));\n          server.urls = server.url;\n          delete server.url;\n          newIceServers.push(server);\n        } else {\n          newIceServers.push(pcConfig.iceServers[i]);\n        }\n      }\n      pcConfig.iceServers = newIceServers;\n    }\n    return new OrigPeerConnection(pcConfig, pcConstraints);\n  };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get: function get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\nfunction shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (_typeof(window) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get: function get() {\n        return {\n          receiver: this.receiver\n        };\n      }\n    });\n  }\n}\nfunction shimCreateOfferLegacy(window) {\n  var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer(offerOptions) {\n    if (offerOptions) {\n      if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n      }\n      var audioTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.receiver.track.kind === 'audio';\n      });\n      if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n        if (audioTransceiver.direction === 'sendrecv') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('sendonly');\n          } else {\n            audioTransceiver.direction = 'sendonly';\n          }\n        } else if (audioTransceiver.direction === 'recvonly') {\n          if (audioTransceiver.setDirection) {\n            audioTransceiver.setDirection('inactive');\n          } else {\n            audioTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\n        this.addTransceiver('audio', {\n          direction: 'recvonly'\n        });\n      }\n      if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n        // support bit values\n        offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n      }\n      var videoTransceiver = this.getTransceivers().find(function (transceiver) {\n        return transceiver.receiver.track.kind === 'video';\n      });\n      if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n        if (videoTransceiver.direction === 'sendrecv') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('sendonly');\n          } else {\n            videoTransceiver.direction = 'sendonly';\n          }\n        } else if (videoTransceiver.direction === 'recvonly') {\n          if (videoTransceiver.setDirection) {\n            videoTransceiver.setDirection('inactive');\n          } else {\n            videoTransceiver.direction = 'inactive';\n          }\n        }\n      } else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\n        this.addTransceiver('video', {\n          direction: 'recvonly'\n        });\n      }\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\nfunction shimAudioContext(window) {\n  if (_typeof(window) !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n},{\"../utils\":11}],11:[function(require,module,exports){\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.compactObject = compactObject;\nexports.deprecated = deprecated;\nexports.detectBrowser = detectBrowser;\nexports.disableLog = disableLog;\nexports.disableWarnings = disableWarnings;\nexports.extractVersion = extractVersion;\nexports.filterStats = filterStats;\nexports.log = log;\nexports.walkStats = walkStats;\nexports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nfunction extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function wrappedCallback(e) {\n      var modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\n  };\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function (nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap][\"delete\"](cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\n  };\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap, this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap, this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\nfunction disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + _typeof(bool) + '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nfunction disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + _typeof(bool) + '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\nfunction log() {\n  if ((typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nfunction deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod + ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nfunction detectBrowser(window) {\n  // Returned result object.\n  var result = {\n    browser: null,\n    version: null\n  };\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator || !window.navigator.userAgent) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n  var navigator = window.navigator;\n  if (navigator.mozGetUserMedia) {\n    // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia || window.isSecureContext === false && window.webkitRTCPeerConnection) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n    // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver && 'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else {\n    // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nfunction compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n  return Object.keys(data).reduce(function (accumulator, key) {\n    var isObj = isObject(data[key]);\n    var value = isObj ? compactObject(data[key]) : data[key];\n    var isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, _defineProperty({}, key, value));\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nfunction walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(function (name) {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(function (id) {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nfunction filterStats(result, track, outbound) {\n  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  var filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  var trackStats = [];\n  result.forEach(function (value) {\n    if (value.type === 'track' && value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(function (trackStat) {\n    result.forEach(function (stats) {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n},{}],12:[function(require,module,exports){\n/* eslint-env node */\n'use strict';\n\n// SDP helpers.\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function () {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function (blob) {\n  return blob.trim().split('\\n').map(function (line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function (blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function (part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function (blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function (blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function (blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function (line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function (line) {\n  var parts = void 0;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: { 1: 'rtp', 2: 'rtcp' }[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default:\n        // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function (candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n\n  var component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress && candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function (line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function (line) {\n  var parts = line.substring(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function (codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate + (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function (line) {\n  var parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' ')\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function (headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) + (headerExtension.direction && headerExtension.direction !== 'sendrecv' ? '/' + headerExtension.direction : '') + ' ' + headerExtension.uri + (headerExtension.attributes ? ' ' + headerExtension.attributes : '') + '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function (line) {\n  var parsed = {};\n  var kv = void 0;\n  var parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function (codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function (param) {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function (line) {\n  var parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function (codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function (fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type + (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') + '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function (line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substring(7, sp), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function (line) {\n  var parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function (ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function (mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function (line) {\n  var parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase() // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function (mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function (params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function (fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function (line) {\n  var parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3)\n  };\n};\n\nSDPUtils.writeCryptoLine = function (parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' + parameters.cryptoSuite + ' ' + (_typeof(parameters.keyParams) === 'object' ? SDPUtils.writeCryptoKeyParams(parameters.keyParams) : parameters.keyParams) + (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') + '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function (keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function (keyParams) {\n  return keyParams.keyMethod + ':' + keyParams.keySalt + (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') + (keyParams.mkiValue && keyParams.mkiLength ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function (mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function (mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10)\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function (params) {\n  var sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' + 'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function (mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (var i = 3; i < mline.length; i++) {\n    // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:' + pt + ' ').map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default:\n          // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function (line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  var wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ').map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(function (codec) {\n    wildcardRtcpFb.forEach(function (fb) {\n      var duplicate = codec.rtcpFeedback.find(function (existingFeedback) {\n        return existingFeedback.type === fb.type && existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function (kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(function (codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function (codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function (codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function (extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function (mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:').map(function (line) {\n    return SDPUtils.parseSsrcMedia(line);\n  }).filter(function (parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc = void 0;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID').map(function (line) {\n    var parts = line.substring(17).split(' ');\n    return parts.map(function (part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function (codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = { ssrc: secondarySsrc };\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95 - 50 * 40 * 8;\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function (params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function (mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:').map(function (line) {\n    return SDPUtils.parseSsrcMedia(line);\n  }).filter(function (obj) {\n    return obj.attribute === 'cname';\n  })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function (rtcpParameters) {\n  var sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc + ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function (mediaSection) {\n  var parts = void 0;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return { stream: parts[0], track: parts[1] };\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:').map(function (line) {\n    return SDPUtils.parseSsrcMedia(line);\n  }).filter(function (msidParts) {\n    return msidParts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return { stream: parts[0], track: parts[1] };\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function (mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize = void 0;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = sctpMapLines[0].substring(10).split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function (media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = ['m=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n', 'c=IN IP4 0.0.0.0\\r\\n', 'a=sctp-port:' + sctp.port + '\\r\\n'];\n  } else {\n    output = ['m=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n', 'c=IN IP4 0.0.0.0\\r\\n', 'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function () {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function (sessId, sessVer, sessUser) {\n  var sessionId = void 0;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' + 'o=' + user + ' ' + sessionId + ' ' + version + ' IN IP4 127.0.0.1\\r\\n' + 's=-\\r\\n' + 't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function (mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n      // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function (mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function (mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function (mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function (mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function (blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif ((typeof module === 'undefined' ? 'undefined' : _typeof(module)) === 'object') {\n  module.exports = SDPUtils;\n}\n},{}]},{},[1])(1)\n});\n","'use strict';\nvar isCallable = require('../internals/is-callable');\nvar tryToString = require('../internals/try-to-string');\n\nvar $TypeError = TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw new $TypeError(tryToString(argument) + ' is not a function');\n};\n","'use strict';\nvar isPossiblePrototype = require('../internals/is-possible-prototype');\n\nvar $String = String;\nvar $TypeError = TypeError;\n\nmodule.exports = function (argument) {\n  if (isPossiblePrototype(argument)) return argument;\n  throw new $TypeError(\"Can't set \" + $String(argument) + ' as a prototype');\n};\n","'use strict';\nvar has = require('../internals/set-helpers').has;\n\n// Perform ? RequireInternalSlot(M, [[SetData]])\nmodule.exports = function (it) {\n  has(it);\n  return it;\n};\n","'use strict';\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] === undefined) {\n  defineProperty(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","'use strict';\nvar isObject = require('../internals/is-object');\n\nvar $String = String;\nvar $TypeError = TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw new $TypeError($String(argument) + ' is not an object');\n};\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    if (length === 0) return !IS_INCLUDES && -1;\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el !== el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value !== value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar isArray = require('../internals/is-array');\n\nvar $TypeError = TypeError;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Safari < 13 does not throw an error in this case\nvar SILENT_ON_NON_WRITABLE_LENGTH_SET = DESCRIPTORS && !function () {\n  // makes no sense without proper strict mode support\n  if (this !== undefined) return true;\n  try {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty([], 'length', { writable: false }).length = 1;\n  } catch (error) {\n    return error instanceof TypeError;\n  }\n}();\n\nmodule.exports = SILENT_ON_NON_WRITABLE_LENGTH_SET ? function (O, length) {\n  if (isArray(O) && !getOwnPropertyDescriptor(O, 'length').writable) {\n    throw new $TypeError('Cannot set read only .length');\n  } return O.length = length;\n} : function (O, length) {\n  return O.length = length;\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) === 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) === 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","'use strict';\nvar hasOwn = require('../internals/has-own-property');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","'use strict';\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","'use strict';\nvar makeBuiltIn = require('../internals/make-built-in');\nvar defineProperty = require('../internals/object-define-property');\n\nmodule.exports = function (target, name, descriptor) {\n  if (descriptor.get) makeBuiltIn(descriptor.get, name, { getter: true });\n  if (descriptor.set) makeBuiltIn(descriptor.set, name, { setter: true });\n  return defineProperty.f(target, name, descriptor);\n};\n","'use strict';\nvar isCallable = require('../internals/is-callable');\nvar definePropertyModule = require('../internals/object-define-property');\nvar makeBuiltIn = require('../internals/make-built-in');\nvar defineGlobalProperty = require('../internals/define-global-property');\n\nmodule.exports = function (O, key, value, options) {\n  if (!options) options = {};\n  var simple = options.enumerable;\n  var name = options.name !== undefined ? options.name : key;\n  if (isCallable(value)) makeBuiltIn(value, name, options);\n  if (options.global) {\n    if (simple) O[key] = value;\n    else defineGlobalProperty(key, value);\n  } else {\n    try {\n      if (!options.unsafe) delete O[key];\n      else if (O[key]) simple = true;\n    } catch (error) { /* empty */ }\n    if (simple) O[key] = value;\n    else definePropertyModule.f(O, key, {\n      value: value,\n      enumerable: false,\n      configurable: !options.nonConfigurable,\n      writable: !options.nonWritable\n    });\n  } return O;\n};\n","'use strict';\nvar globalThis = require('../internals/global-this');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(globalThis, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    globalThis[key] = value;\n  } return value;\n};\n","'use strict';\nvar fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] !== 7;\n});\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar isObject = require('../internals/is-object');\n\nvar document = globalThis.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","'use strict';\nvar $TypeError = TypeError;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF; // 2 ** 53 - 1 == 9007199254740991\n\nmodule.exports = function (it) {\n  if (it > MAX_SAFE_INTEGER) throw $TypeError('Maximum allowed index exceeded');\n  return it;\n};\n","'use strict';\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","'use strict';\nvar globalThis = require('../internals/global-this');\n\nvar navigator = globalThis.navigator;\nvar userAgent = navigator && navigator.userAgent;\n\nmodule.exports = userAgent ? String(userAgent) : '';\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar userAgent = require('../internals/environment-user-agent');\n\nvar process = globalThis.process;\nvar Deno = globalThis.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar $Error = Error;\nvar replace = uncurryThis(''.replace);\n\nvar TEST = (function (arg) { return String(new $Error(arg).stack); })('zxcasd');\n// eslint-disable-next-line redos/no-vulnerable -- safe\nvar V8_OR_CHAKRA_STACK_ENTRY = /\\n\\s*at [^:]*:[^\\n]*/;\nvar IS_V8_OR_CHAKRA_STACK = V8_OR_CHAKRA_STACK_ENTRY.test(TEST);\n\nmodule.exports = function (stack, dropEntries) {\n  if (IS_V8_OR_CHAKRA_STACK && typeof stack == 'string' && !$Error.prepareStackTrace) {\n    while (dropEntries--) stack = replace(stack, V8_OR_CHAKRA_STACK_ENTRY, '');\n  } return stack;\n};\n","'use strict';\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar clearErrorStack = require('../internals/error-stack-clear');\nvar ERROR_STACK_INSTALLABLE = require('../internals/error-stack-installable');\n\n// non-standard V8\nvar captureStackTrace = Error.captureStackTrace;\n\nmodule.exports = function (error, C, stack, dropEntries) {\n  if (ERROR_STACK_INSTALLABLE) {\n    if (captureStackTrace) captureStackTrace(error, C);\n    else createNonEnumerableProperty(error, 'stack', clearErrorStack(stack, dropEntries));\n  }\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = !fails(function () {\n  var error = new Error('a');\n  if (!('stack' in error)) return true;\n  // eslint-disable-next-line es/no-object-defineproperty -- safe\n  Object.defineProperty(error, 'stack', createPropertyDescriptor(1, 7));\n  return error.stack !== 7;\n});\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar defineBuiltIn = require('../internals/define-built-in');\nvar defineGlobalProperty = require('../internals/define-global-property');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target         - name of the target object\n  options.global         - target is the global object\n  options.stat           - export as static methods of target\n  options.proto          - export as prototype methods of target\n  options.real           - real prototype method for the `pure` version\n  options.forced         - export even if the native feature is available\n  options.bind           - bind methods to the target, required for the `pure` version\n  options.wrap           - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe         - use the simple assignment of property instead of delete + defineProperty\n  options.sham           - add a flag to not completely full polyfills\n  options.enumerable     - export as enumerable property\n  options.dontCallGetSet - prevent calling a getter on target\n  options.name           - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = globalThis;\n  } else if (STATIC) {\n    target = globalThis[TARGET] || defineGlobalProperty(TARGET, {});\n  } else {\n    target = globalThis[TARGET] && globalThis[TARGET].prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.dontCallGetSet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    defineBuiltIn(target, key, sourceProperty, options);\n  }\n};\n","'use strict';\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","'use strict';\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar apply = FunctionPrototype.apply;\nvar call = FunctionPrototype.call;\n\n// eslint-disable-next-line es/no-reflect -- safe\nmodule.exports = typeof Reflect == 'object' && Reflect.apply || (NATIVE_BIND ? call.bind(apply) : function () {\n  return call.apply(apply, arguments);\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-function-prototype-bind -- safe\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n","'use strict';\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar hasOwn = require('../internals/has-own-property');\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\n\nmodule.exports = function (object, key, method) {\n  try {\n    // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n    return uncurryThis(aCallable(Object.getOwnPropertyDescriptor(object, key)[method]));\n  } catch (error) { /* empty */ }\n};\n","'use strict';\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar call = FunctionPrototype.call;\nvar uncurryThisWithBind = NATIVE_BIND && FunctionPrototype.bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? uncurryThisWithBind : function (fn) {\n  return function () {\n    return call.apply(fn, arguments);\n  };\n};\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar isCallable = require('../internals/is-callable');\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(globalThis[namespace]) : globalThis[namespace] && globalThis[namespace][method];\n};\n","'use strict';\n// `GetIteratorDirect(obj)` abstract operation\n// https://tc39.es/proposal-iterator-helpers/#sec-getiteratordirect\nmodule.exports = function (obj) {\n  return {\n    iterator: obj,\n    next: obj.next,\n    done: false\n  };\n};\n","'use strict';\nvar aCallable = require('../internals/a-callable');\nvar isNullOrUndefined = require('../internals/is-null-or-undefined');\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return isNullOrUndefined(func) ? undefined : aCallable(func);\n};\n","'use strict';\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar call = require('../internals/function-call');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\n\nvar INVALID_SIZE = 'Invalid size';\nvar $RangeError = RangeError;\nvar $TypeError = TypeError;\nvar max = Math.max;\n\nvar SetRecord = function (set, intSize) {\n  this.set = set;\n  this.size = max(intSize, 0);\n  this.has = aCallable(set.has);\n  this.keys = aCallable(set.keys);\n};\n\nSetRecord.prototype = {\n  getIterator: function () {\n    return getIteratorDirect(anObject(call(this.keys, this.set)));\n  },\n  includes: function (it) {\n    return call(this.has, this.set, it);\n  }\n};\n\n// `GetSetRecord` abstract operation\n// https://tc39.es/proposal-set-methods/#sec-getsetrecord\nmodule.exports = function (obj) {\n  anObject(obj);\n  var numSize = +obj.size;\n  // NOTE: If size is undefined, then numSize will be NaN\n  // eslint-disable-next-line no-self-compare -- NaN check\n  if (numSize !== numSize) throw new $TypeError(INVALID_SIZE);\n  var intSize = toIntegerOrInfinity(numSize);\n  if (intSize < 0) throw new $RangeError(INVALID_SIZE);\n  return new SetRecord(obj, intSize);\n};\n","'use strict';\nvar check = function (it) {\n  return it && it.Math === Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  check(typeof this == 'object' && this) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\n// eslint-disable-next-line es/no-object-hasown -- safe\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n","'use strict';\nmodule.exports = {};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a !== 7;\n});\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar $Object = Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !$Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) === 'String' ? split(it, '') : $Object(it);\n} : $Object;\n","'use strict';\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    isCallable(NewTarget = dummy.constructor) &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isCallable = require('../internals/is-callable');\nvar store = require('../internals/shared-store');\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","'use strict';\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\n// `InstallErrorCause` abstract operation\n// https://tc39.es/proposal-error-cause/#sec-errorobjects-install-error-cause\nmodule.exports = function (O, options) {\n  if (isObject(options) && 'cause' in options) {\n    createNonEnumerableProperty(O, 'cause', options.cause);\n  }\n};\n","'use strict';\nvar NATIVE_WEAK_MAP = require('../internals/weak-map-basic-detection');\nvar globalThis = require('../internals/global-this');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar hasOwn = require('../internals/has-own-property');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = globalThis.TypeError;\nvar WeakMap = globalThis.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw new TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  /* eslint-disable no-self-assign -- prototype methods protection */\n  store.get = store.get;\n  store.has = store.has;\n  store.set = store.set;\n  /* eslint-enable no-self-assign -- prototype methods protection */\n  set = function (it, metadata) {\n    if (store.has(it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    store.set(it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return store.get(it) || {};\n  };\n  has = function (it) {\n    return store.has(it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","'use strict';\nvar classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(argument) {\n  return classof(argument) === 'Array';\n};\n","'use strict';\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot\nvar documentAll = typeof document == 'object' && document.all;\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\n// eslint-disable-next-line unicorn/no-typeof-undefined -- required for testing\nmodule.exports = typeof documentAll == 'undefined' && documentAll !== undefined ? function (argument) {\n  return typeof argument == 'function' || argument === documentAll;\n} : function (argument) {\n  return typeof argument == 'function';\n};\n","'use strict';\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value === POLYFILL ? true\n    : value === NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","'use strict';\n// we can't use just `it == null` since of `document.all` special case\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot-aec\nmodule.exports = function (it) {\n  return it === null || it === undefined;\n};\n","'use strict';\nvar isCallable = require('../internals/is-callable');\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n","'use strict';\nvar isObject = require('../internals/is-object');\n\nmodule.exports = function (argument) {\n  return isObject(argument) || argument === null;\n};\n","'use strict';\nmodule.exports = false;\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar $Object = Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, $Object(it));\n};\n","'use strict';\nvar call = require('../internals/function-call');\n\nmodule.exports = function (record, fn, ITERATOR_INSTEAD_OF_RECORD) {\n  var iterator = ITERATOR_INSTEAD_OF_RECORD ? record : record.iterator;\n  var next = record.next;\n  var step, result;\n  while (!(step = call(next, iterator)).done) {\n    result = fn(step.value);\n    if (result !== undefined) return result;\n  }\n};\n","'use strict';\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar getMethod = require('../internals/get-method');\n\nmodule.exports = function (iterator, kind, value) {\n  var innerResult, innerError;\n  anObject(iterator);\n  try {\n    innerResult = getMethod(iterator, 'return');\n    if (!innerResult) {\n      if (kind === 'throw') throw value;\n      return value;\n    }\n    innerResult = call(innerResult, iterator);\n  } catch (error) {\n    innerError = true;\n    innerResult = error;\n  }\n  if (kind === 'throw') throw value;\n  if (innerError) throw innerResult;\n  anObject(innerResult);\n  return value;\n};\n","'use strict';\nvar toLength = require('../internals/to-length');\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar CONFIGURABLE_FUNCTION_NAME = require('../internals/function-name').CONFIGURABLE;\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar enforceInternalState = InternalStateModule.enforce;\nvar getInternalState = InternalStateModule.get;\nvar $String = String;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\nvar stringSlice = uncurryThis(''.slice);\nvar replace = uncurryThis(''.replace);\nvar join = uncurryThis([].join);\n\nvar CONFIGURABLE_LENGTH = DESCRIPTORS && !fails(function () {\n  return defineProperty(function () { /* empty */ }, 'length', { value: 8 }).length !== 8;\n});\n\nvar TEMPLATE = String(String).split('String');\n\nvar makeBuiltIn = module.exports = function (value, name, options) {\n  if (stringSlice($String(name), 0, 7) === 'Symbol(') {\n    name = '[' + replace($String(name), /^Symbol\\(([^)]*)\\).*$/, '$1') + ']';\n  }\n  if (options && options.getter) name = 'get ' + name;\n  if (options && options.setter) name = 'set ' + name;\n  if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n    if (DESCRIPTORS) defineProperty(value, 'name', { value: name, configurable: true });\n    else value.name = name;\n  }\n  if (CONFIGURABLE_LENGTH && options && hasOwn(options, 'arity') && value.length !== options.arity) {\n    defineProperty(value, 'length', { value: options.arity });\n  }\n  try {\n    if (options && hasOwn(options, 'constructor') && options.constructor) {\n      if (DESCRIPTORS) defineProperty(value, 'prototype', { writable: false });\n    // in V8 ~ Chrome 53, prototypes of some methods, like `Array.prototype.values`, are non-writable\n    } else if (value.prototype) value.prototype = undefined;\n  } catch (error) { /* empty */ }\n  var state = enforceInternalState(value);\n  if (!hasOwn(state, 'source')) {\n    state.source = join(TEMPLATE, typeof name == 'string' ? name : '');\n  } return value;\n};\n\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n// eslint-disable-next-line no-extend-native -- required\nFunction.prototype.toString = makeBuiltIn(function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n}, 'toString');\n","'use strict';\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n// eslint-disable-next-line es/no-math-trunc -- safe\nmodule.exports = Math.trunc || function trunc(x) {\n  var n = +x;\n  return (n > 0 ? floor : ceil)(n);\n};\n","'use strict';\nvar toString = require('../internals/to-string');\n\nmodule.exports = function (argument, $default) {\n  return argument === undefined ? arguments.length < 2 ? '' : $default : toString(argument);\n};\n","'use strict';\n/* global ActiveXObject -- old IE, WSH */\nvar anObject = require('../internals/an-object');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  // eslint-disable-next-line no-useless-assignment -- avoid memory leak\n  activeXDocument = null;\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    activeXDocument = new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = typeof document != 'undefined'\n    ? document.domain && activeXDocument\n      ? NullProtoObjectViaActiveX(activeXDocument) // old IE\n      : NullProtoObjectViaIFrame()\n    : NullProtoObjectViaActiveX(activeXDocument); // WSH\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\n// eslint-disable-next-line es/no-object-create -- safe\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : definePropertiesModule.f(result, Properties);\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nexports.f = DESCRIPTORS && !V8_PROTOTYPE_DEFINE_BUG ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var props = toIndexedObject(Properties);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);\n  return O;\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\n\nvar $TypeError = TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw new $TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar call = require('../internals/function-call');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n","'use strict';\nvar internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","'use strict';\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n","'use strict';\nvar internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","'use strict';\n/* eslint-disable no-proto -- safe */\nvar uncurryThisAccessor = require('../internals/function-uncurry-this-accessor');\nvar isObject = require('../internals/is-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n// eslint-disable-next-line es/no-object-setprototypeof -- safe\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    setter = uncurryThisAccessor(Object.prototype, '__proto__', 'set');\n    setter(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    requireObjectCoercible(O);\n    aPossiblePrototype(proto);\n    if (!isObject(O)) return O;\n    if (CORRECT_SETTER) setter(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","'use strict';\nvar call = require('../internals/function-call');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\n\nvar $TypeError = TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw new $TypeError(\"Can't convert object to primitive value\");\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\n\nmodule.exports = function (Target, Source, key) {\n  key in Target || defineProperty(Target, key, {\n    configurable: true,\n    get: function () { return Source[key]; },\n    set: function (it) { Source[key] = it; }\n  });\n};\n","'use strict';\nvar isNullOrUndefined = require('../internals/is-null-or-undefined');\n\nvar $TypeError = TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (isNullOrUndefined(it)) throw new $TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","'use strict';\nvar SetHelpers = require('../internals/set-helpers');\nvar iterate = require('../internals/set-iterate');\n\nvar Set = SetHelpers.Set;\nvar add = SetHelpers.add;\n\nmodule.exports = function (set) {\n  var result = new Set();\n  iterate(set, function (it) {\n    add(result, it);\n  });\n  return result;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar SetHelpers = require('../internals/set-helpers');\nvar clone = require('../internals/set-clone');\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSet = require('../internals/set-iterate');\nvar iterateSimple = require('../internals/iterate-simple');\n\nvar has = SetHelpers.has;\nvar remove = SetHelpers.remove;\n\n// `Set.prototype.difference` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function difference(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  var result = clone(O);\n  if (size(O) <= otherRec.size) iterateSet(O, function (e) {\n    if (otherRec.includes(e)) remove(result, e);\n  });\n  else iterateSimple(otherRec.getIterator(), function (e) {\n    if (has(O, e)) remove(result, e);\n  });\n  return result;\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\n// eslint-disable-next-line es/no-set -- safe\nvar SetPrototype = Set.prototype;\n\nmodule.exports = {\n  // eslint-disable-next-line es/no-set -- safe\n  Set: Set,\n  add: uncurryThis(SetPrototype.add),\n  has: uncurryThis(SetPrototype.has),\n  remove: uncurryThis(SetPrototype['delete']),\n  proto: SetPrototype\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar SetHelpers = require('../internals/set-helpers');\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSet = require('../internals/set-iterate');\nvar iterateSimple = require('../internals/iterate-simple');\n\nvar Set = SetHelpers.Set;\nvar add = SetHelpers.add;\nvar has = SetHelpers.has;\n\n// `Set.prototype.intersection` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function intersection(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  var result = new Set();\n\n  if (size(O) > otherRec.size) {\n    iterateSimple(otherRec.getIterator(), function (e) {\n      if (has(O, e)) add(result, e);\n    });\n  } else {\n    iterateSet(O, function (e) {\n      if (otherRec.includes(e)) add(result, e);\n    });\n  }\n\n  return result;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar has = require('../internals/set-helpers').has;\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSet = require('../internals/set-iterate');\nvar iterateSimple = require('../internals/iterate-simple');\nvar iteratorClose = require('../internals/iterator-close');\n\n// `Set.prototype.isDisjointFrom` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isDisjointFrom\nmodule.exports = function isDisjointFrom(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  if (size(O) <= otherRec.size) return iterateSet(O, function (e) {\n    if (otherRec.includes(e)) return false;\n  }, true) !== false;\n  var iterator = otherRec.getIterator();\n  return iterateSimple(iterator, function (e) {\n    if (has(O, e)) return iteratorClose(iterator, 'normal', false);\n  }) !== false;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar size = require('../internals/set-size');\nvar iterate = require('../internals/set-iterate');\nvar getSetRecord = require('../internals/get-set-record');\n\n// `Set.prototype.isSubsetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSubsetOf\nmodule.exports = function isSubsetOf(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  if (size(O) > otherRec.size) return false;\n  return iterate(O, function (e) {\n    if (!otherRec.includes(e)) return false;\n  }, true) !== false;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar has = require('../internals/set-helpers').has;\nvar size = require('../internals/set-size');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSimple = require('../internals/iterate-simple');\nvar iteratorClose = require('../internals/iterator-close');\n\n// `Set.prototype.isSupersetOf` method\n// https://tc39.github.io/proposal-set-methods/#Set.prototype.isSupersetOf\nmodule.exports = function isSupersetOf(other) {\n  var O = aSet(this);\n  var otherRec = getSetRecord(other);\n  if (size(O) < otherRec.size) return false;\n  var iterator = otherRec.getIterator();\n  return iterateSimple(iterator, function (e) {\n    if (!has(O, e)) return iteratorClose(iterator, 'normal', false);\n  }) !== false;\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar iterateSimple = require('../internals/iterate-simple');\nvar SetHelpers = require('../internals/set-helpers');\n\nvar Set = SetHelpers.Set;\nvar SetPrototype = SetHelpers.proto;\nvar forEach = uncurryThis(SetPrototype.forEach);\nvar keys = uncurryThis(SetPrototype.keys);\nvar next = keys(new Set()).next;\n\nmodule.exports = function (set, fn, interruptible) {\n  return interruptible ? iterateSimple({ iterator: keys(set), next: next }, fn) : forEach(set, fn);\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\n\nvar createSetLike = function (size) {\n  return {\n    size: size,\n    has: function () {\n      return false;\n    },\n    keys: function () {\n      return {\n        next: function () {\n          return { done: true };\n        }\n      };\n    }\n  };\n};\n\nmodule.exports = function (name) {\n  var Set = getBuiltIn('Set');\n  try {\n    new Set()[name](createSetLike(0));\n    try {\n      // late spec change, early WebKit ~ Safari 17.0 beta implementation does not pass it\n      // https://github.com/tc39/proposal-set-methods/pull/88\n      new Set()[name](createSetLike(-1));\n      return false;\n    } catch (error2) {\n      return true;\n    }\n  } catch (error) {\n    return false;\n  }\n};\n","'use strict';\nvar uncurryThisAccessor = require('../internals/function-uncurry-this-accessor');\nvar SetHelpers = require('../internals/set-helpers');\n\nmodule.exports = uncurryThisAccessor(SetHelpers.proto, 'size', 'get') || function (set) {\n  return set.size;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar SetHelpers = require('../internals/set-helpers');\nvar clone = require('../internals/set-clone');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSimple = require('../internals/iterate-simple');\n\nvar add = SetHelpers.add;\nvar has = SetHelpers.has;\nvar remove = SetHelpers.remove;\n\n// `Set.prototype.symmetricDifference` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function symmetricDifference(other) {\n  var O = aSet(this);\n  var keysIter = getSetRecord(other).getIterator();\n  var result = clone(O);\n  iterateSimple(keysIter, function (e) {\n    if (has(O, e)) remove(result, e);\n    else add(result, e);\n  });\n  return result;\n};\n","'use strict';\nvar aSet = require('../internals/a-set');\nvar add = require('../internals/set-helpers').add;\nvar clone = require('../internals/set-clone');\nvar getSetRecord = require('../internals/get-set-record');\nvar iterateSimple = require('../internals/iterate-simple');\n\n// `Set.prototype.union` method\n// https://github.com/tc39/proposal-set-methods\nmodule.exports = function union(other) {\n  var O = aSet(this);\n  var keysIter = getSetRecord(other).getIterator();\n  var result = clone(O);\n  iterateSimple(keysIter, function (it) {\n    add(result, it);\n  });\n  return result;\n};\n","'use strict';\nvar shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","'use strict';\nvar IS_PURE = require('../internals/is-pure');\nvar globalThis = require('../internals/global-this');\nvar defineGlobalProperty = require('../internals/define-global-property');\n\nvar SHARED = '__core-js_shared__';\nvar store = module.exports = globalThis[SHARED] || defineGlobalProperty(SHARED, {});\n\n(store.versions || (store.versions = [])).push({\n  version: '3.38.1',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2014-2024 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n","'use strict';\nvar store = require('../internals/shared-store');\n\nmodule.exports = function (key, value) {\n  return store[key] || (store[key] = value || {});\n};\n","'use strict';\n/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/environment-v8-version');\nvar fails = require('../internals/fails');\nvar globalThis = require('../internals/global-this');\n\nvar $String = globalThis.String;\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol('symbol detection');\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  // nb: Do not call `String` directly to avoid this being optimized out to `symbol+''` which will,\n  // of course, fail.\n  return !$String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","'use strict';\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","'use strict';\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","'use strict';\nvar trunc = require('../internals/math-trunc');\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return number !== number || number === 0 ? 0 : trunc(number);\n};\n","'use strict';\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  var len = toIntegerOrInfinity(argument);\n  return len > 0 ? min(len, 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","'use strict';\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar $Object = Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return $Object(requireObjectCoercible(argument));\n};\n","'use strict';\nvar call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar getMethod = require('../internals/get-method');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar $TypeError = TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw new $TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar isSymbol = require('../internals/is-symbol');\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n","'use strict';\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","'use strict';\nvar classof = require('../internals/classof');\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw new TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n","'use strict';\nvar $String = String;\n\nmodule.exports = function (argument) {\n  try {\n    return $String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n","'use strict';\n/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype !== 42;\n});\n","'use strict';\nvar $TypeError = TypeError;\n\nmodule.exports = function (passed, required) {\n  if (passed < required) throw new $TypeError('Not enough arguments');\n  return passed;\n};\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar isCallable = require('../internals/is-callable');\n\nvar WeakMap = globalThis.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(String(WeakMap));\n","'use strict';\nvar globalThis = require('../internals/global-this');\nvar shared = require('../internals/shared');\nvar hasOwn = require('../internals/has-own-property');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar Symbol = globalThis.Symbol;\nvar WellKnownSymbolsStore = shared('wks');\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol['for'] || Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name)) {\n    WellKnownSymbolsStore[name] = NATIVE_SYMBOL && hasOwn(Symbol, name)\n      ? Symbol[name]\n      : createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\nvar hasOwn = require('../internals/has-own-property');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar proxyAccessor = require('../internals/proxy-accessor');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar normalizeStringArgument = require('../internals/normalize-string-argument');\nvar installErrorCause = require('../internals/install-error-cause');\nvar installErrorStack = require('../internals/error-stack-install');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar IS_PURE = require('../internals/is-pure');\n\nmodule.exports = function (FULL_NAME, wrapper, FORCED, IS_AGGREGATE_ERROR) {\n  var STACK_TRACE_LIMIT = 'stackTraceLimit';\n  var OPTIONS_POSITION = IS_AGGREGATE_ERROR ? 2 : 1;\n  var path = FULL_NAME.split('.');\n  var ERROR_NAME = path[path.length - 1];\n  var OriginalError = getBuiltIn.apply(null, path);\n\n  if (!OriginalError) return;\n\n  var OriginalErrorPrototype = OriginalError.prototype;\n\n  // V8 9.3- bug https://bugs.chromium.org/p/v8/issues/detail?id=12006\n  if (!IS_PURE && hasOwn(OriginalErrorPrototype, 'cause')) delete OriginalErrorPrototype.cause;\n\n  if (!FORCED) return OriginalError;\n\n  var BaseError = getBuiltIn('Error');\n\n  var WrappedError = wrapper(function (a, b) {\n    var message = normalizeStringArgument(IS_AGGREGATE_ERROR ? b : a, undefined);\n    var result = IS_AGGREGATE_ERROR ? new OriginalError(a) : new OriginalError();\n    if (message !== undefined) createNonEnumerableProperty(result, 'message', message);\n    installErrorStack(result, WrappedError, result.stack, 2);\n    if (this && isPrototypeOf(OriginalErrorPrototype, this)) inheritIfRequired(result, this, WrappedError);\n    if (arguments.length > OPTIONS_POSITION) installErrorCause(result, arguments[OPTIONS_POSITION]);\n    return result;\n  });\n\n  WrappedError.prototype = OriginalErrorPrototype;\n\n  if (ERROR_NAME !== 'Error') {\n    if (setPrototypeOf) setPrototypeOf(WrappedError, BaseError);\n    else copyConstructorProperties(WrappedError, BaseError, { name: true });\n  } else if (DESCRIPTORS && STACK_TRACE_LIMIT in OriginalError) {\n    proxyAccessor(WrappedError, OriginalError, STACK_TRACE_LIMIT);\n    proxyAccessor(WrappedError, OriginalError, 'prepareStackTrace');\n  }\n\n  copyConstructorProperties(WrappedError, OriginalError);\n\n  if (!IS_PURE) try {\n    // Safari 13- bug: WebAssembly errors does not have a proper `.name`\n    if (OriginalErrorPrototype.name !== ERROR_NAME) {\n      createNonEnumerableProperty(OriginalErrorPrototype, 'name', ERROR_NAME);\n    }\n    OriginalErrorPrototype.constructor = WrappedError;\n  } catch (error) { /* empty */ }\n\n  return WrappedError;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar fails = require('../internals/fails');\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// FF99+ bug\nvar BROKEN_ON_SPARSE = fails(function () {\n  // eslint-disable-next-line es/no-array-prototype-includes -- detection\n  return !Array(1).includes();\n});\n\n// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true, forced: BROKEN_ON_SPARSE }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n","'use strict';\nvar $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar setArrayLength = require('../internals/array-set-length');\nvar doesNotExceedSafeInteger = require('../internals/does-not-exceed-safe-integer');\nvar fails = require('../internals/fails');\n\nvar INCORRECT_TO_LENGTH = fails(function () {\n  return [].push.call({ length: 0x100000000 }, 1) !== 4294967297;\n});\n\n// V8 <= 121 and Safari <= 15.4; FF < 23 throws InternalError\n// https://bugs.chromium.org/p/v8/issues/detail?id=12681\nvar properErrorOnNonWritableLength = function () {\n  try {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty([], 'length', { writable: false }).push();\n  } catch (error) {\n    return error instanceof TypeError;\n  }\n};\n\nvar FORCED = INCORRECT_TO_LENGTH || !properErrorOnNonWritableLength();\n\n// `Array.prototype.push` method\n// https://tc39.es/ecma262/#sec-array.prototype.push\n$({ target: 'Array', proto: true, arity: 1, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  push: function push(item) {\n    var O = toObject(this);\n    var len = lengthOfArrayLike(O);\n    var argCount = arguments.length;\n    doesNotExceedSafeInteger(len + argCount);\n    for (var i = 0; i < argCount; i++) {\n      O[len] = arguments[i];\n      len++;\n    }\n    setArrayLength(O, len);\n    return len;\n  }\n});\n","'use strict';\n/* eslint-disable no-unused-vars -- required for functions `.length` */\nvar $ = require('../internals/export');\nvar globalThis = require('../internals/global-this');\nvar apply = require('../internals/function-apply');\nvar wrapErrorConstructorWithCause = require('../internals/wrap-error-constructor-with-cause');\n\nvar WEB_ASSEMBLY = 'WebAssembly';\nvar WebAssembly = globalThis[WEB_ASSEMBLY];\n\n// eslint-disable-next-line es/no-error-cause -- feature detection\nvar FORCED = new Error('e', { cause: 7 }).cause !== 7;\n\nvar exportGlobalErrorCauseWrapper = function (ERROR_NAME, wrapper) {\n  var O = {};\n  O[ERROR_NAME] = wrapErrorConstructorWithCause(ERROR_NAME, wrapper, FORCED);\n  $({ global: true, constructor: true, arity: 1, forced: FORCED }, O);\n};\n\nvar exportWebAssemblyErrorCauseWrapper = function (ERROR_NAME, wrapper) {\n  if (WebAssembly && WebAssembly[ERROR_NAME]) {\n    var O = {};\n    O[ERROR_NAME] = wrapErrorConstructorWithCause(WEB_ASSEMBLY + '.' + ERROR_NAME, wrapper, FORCED);\n    $({ target: WEB_ASSEMBLY, stat: true, constructor: true, arity: 1, forced: FORCED }, O);\n  }\n};\n\n// https://tc39.es/ecma262/#sec-nativeerror\nexportGlobalErrorCauseWrapper('Error', function (init) {\n  return function Error(message) { return apply(init, this, arguments); };\n});\nexportGlobalErrorCauseWrapper('EvalError', function (init) {\n  return function EvalError(message) { return apply(init, this, arguments); };\n});\nexportGlobalErrorCauseWrapper('RangeError', function (init) {\n  return function RangeError(message) { return apply(init, this, arguments); };\n});\nexportGlobalErrorCauseWrapper('ReferenceError', function (init) {\n  return function ReferenceError(message) { return apply(init, this, arguments); };\n});\nexportGlobalErrorCauseWrapper('SyntaxError', function (init) {\n  return function SyntaxError(message) { return apply(init, this, arguments); };\n});\nexportGlobalErrorCauseWrapper('TypeError', function (init) {\n  return function TypeError(message) { return apply(init, this, arguments); };\n});\nexportGlobalErrorCauseWrapper('URIError', function (init) {\n  return function URIError(message) { return apply(init, this, arguments); };\n});\nexportWebAssemblyErrorCauseWrapper('CompileError', function (init) {\n  return function CompileError(message) { return apply(init, this, arguments); };\n});\nexportWebAssemblyErrorCauseWrapper('LinkError', function (init) {\n  return function LinkError(message) { return apply(init, this, arguments); };\n});\nexportWebAssemblyErrorCauseWrapper('RuntimeError', function (init) {\n  return function RuntimeError(message) { return apply(init, this, arguments); };\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar difference = require('../internals/set-difference');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.difference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('difference') }, {\n  difference: difference\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar intersection = require('../internals/set-intersection');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\nvar INCORRECT = !setMethodAcceptSetLike('intersection') || fails(function () {\n  // eslint-disable-next-line es/no-array-from, es/no-set -- testing\n  return String(Array.from(new Set([1, 2, 3]).intersection(new Set([3, 2])))) !== '3,2';\n});\n\n// `Set.prototype.intersection` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: INCORRECT }, {\n  intersection: intersection\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar isDisjointFrom = require('../internals/set-is-disjoint-from');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.isDisjointFrom` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('isDisjointFrom') }, {\n  isDisjointFrom: isDisjointFrom\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar isSubsetOf = require('../internals/set-is-subset-of');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.isSubsetOf` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('isSubsetOf') }, {\n  isSubsetOf: isSubsetOf\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar isSupersetOf = require('../internals/set-is-superset-of');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.isSupersetOf` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('isSupersetOf') }, {\n  isSupersetOf: isSupersetOf\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar symmetricDifference = require('../internals/set-symmetric-difference');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.symmetricDifference` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('symmetricDifference') }, {\n  symmetricDifference: symmetricDifference\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar union = require('../internals/set-union');\nvar setMethodAcceptSetLike = require('../internals/set-method-accept-set-like');\n\n// `Set.prototype.union` method\n// https://github.com/tc39/proposal-set-methods\n$({ target: 'Set', proto: true, real: true, forced: !setMethodAcceptSetLike('union') }, {\n  union: union\n});\n","'use strict';\nvar defineBuiltIn = require('../internals/define-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\n\nvar $URLSearchParams = URLSearchParams;\nvar URLSearchParamsPrototype = $URLSearchParams.prototype;\nvar append = uncurryThis(URLSearchParamsPrototype.append);\nvar $delete = uncurryThis(URLSearchParamsPrototype['delete']);\nvar forEach = uncurryThis(URLSearchParamsPrototype.forEach);\nvar push = uncurryThis([].push);\nvar params = new $URLSearchParams('a=1&a=2&b=3');\n\nparams['delete']('a', 1);\n// `undefined` case is a Chromium 117 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=14222\nparams['delete']('b', undefined);\n\nif (params + '' !== 'a=2') {\n  defineBuiltIn(URLSearchParamsPrototype, 'delete', function (name /* , value */) {\n    var length = arguments.length;\n    var $value = length < 2 ? undefined : arguments[1];\n    if (length && $value === undefined) return $delete(this, name);\n    var entries = [];\n    forEach(this, function (v, k) { // also validates `this`\n      push(entries, { key: k, value: v });\n    });\n    validateArgumentsLength(length, 1);\n    var key = toString(name);\n    var value = toString($value);\n    var index = 0;\n    var dindex = 0;\n    var found = false;\n    var entriesLength = entries.length;\n    var entry;\n    while (index < entriesLength) {\n      entry = entries[index++];\n      if (found || entry.key === key) {\n        found = true;\n        $delete(this, entry.key);\n      } else dindex++;\n    }\n    while (dindex < entriesLength) {\n      entry = entries[dindex++];\n      if (!(entry.key === key && entry.value === value)) append(this, entry.key, entry.value);\n    }\n  }, { enumerable: true, unsafe: true });\n}\n","'use strict';\nvar defineBuiltIn = require('../internals/define-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar validateArgumentsLength = require('../internals/validate-arguments-length');\n\nvar $URLSearchParams = URLSearchParams;\nvar URLSearchParamsPrototype = $URLSearchParams.prototype;\nvar getAll = uncurryThis(URLSearchParamsPrototype.getAll);\nvar $has = uncurryThis(URLSearchParamsPrototype.has);\nvar params = new $URLSearchParams('a=1');\n\n// `undefined` case is a Chromium 117 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=14222\nif (params.has('a', 2) || !params.has('a', undefined)) {\n  defineBuiltIn(URLSearchParamsPrototype, 'has', function has(name /* , value */) {\n    var length = arguments.length;\n    var $value = length < 2 ? undefined : arguments[1];\n    if (length && $value === undefined) return $has(this, name);\n    var values = getAll(this, name); // also validates `this`\n    validateArgumentsLength(length, 1);\n    var value = toString($value);\n    var index = 0;\n    while (index < values.length) {\n      if (values[index++] === value) return true;\n    } return false;\n  }, { enumerable: true, unsafe: true });\n}\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar defineBuiltInAccessor = require('../internals/define-built-in-accessor');\n\nvar URLSearchParamsPrototype = URLSearchParams.prototype;\nvar forEach = uncurryThis(URLSearchParamsPrototype.forEach);\n\n// `URLSearchParams.prototype.size` getter\n// https://github.com/whatwg/url/pull/734\nif (DESCRIPTORS && !('size' in URLSearchParamsPrototype)) {\n  defineBuiltInAccessor(URLSearchParamsPrototype, 'size', {\n    get: function size() {\n      var count = 0;\n      forEach(this, function () { count++; });\n      return count;\n    },\n    configurable: true,\n    enumerable: true\n  });\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(81948);\n"],"names":["root","factory","exports","module","define","amd","self","_plugin","_interopRequireDefault","require","_config","_events","e","__esModule","default","name","fn","logs","config","events","options","arguments","length","undefined","plugins","_factory","_core","_basePlugins","_webrtc","_webrtcProxy","_link","_link2","_link3","_link4","_link5","_link6","_link7","_link8","_link9","_sipEvents","_index","_request","_codecRemover","defaultPlugins","basePlugins","auth","subscription","webrtc","proxy","call","callHistory","clickToCall","notifications","connectivity","messaging","mwi","presence","sipEvents","users","linkRequest","commonIndex","create","sdpHandlers","createCodecRemover","prototype","eventMap","subscribeMap","strictMode","checkEvent","type","Error","removeListener","list","listener","i","splice","Object","assign","alias","on","push","off","once","emit","args","Array","slice","noop","listCopy","apply","j","subscribe","unsubscribe","setStrictMode","strict","GONE","LOST_CONNECTION","prefix","_ref","username","password","authname","hmacToken","bearerAccessToken","actionTypes","SET_CREDENTIALS","payload","meta","isSensitive","_ref2","userInfo","connection","error","action","SET_CREDENTIALS_FINISH","token","UPDATE_HMAC_TOKEN","r","t","_getRequireWildcardCache","has","get","n","__proto__","a","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","set","_interopRequireWildcard","WeakMap","container","logManager","context","AuthenticationOperations","operations","API_LOG_TAG","log","getLogger","getUserInfo","debug","selectUserInfo","getState","disconnectReasons","DISCONNECT_REASONS","setCredentials","dispatch","actions","_selectors","_constants","_reducers","_name","_api","_reduxActions","reducers","next","state","throw","_removed","removeXtoken","requestOptions","headers","reducer","handleActions","isConnected","isPending","identity","domain","split","getAuthConfig","server","_cloneDeep2","authentication","protocol","base","port","version","requestInfo","baseURL","connInfo","getConnectionInfo","serviceUnavailableMaxRetries","bottle","v8nValidation","v8n","schema","enums","string","positive","parseOptions","parse","mergeValues","createAPI","defer","updateConfig","initOperations","capabilities","_interface","_actions","_mergeValues","_validation","_setCredentials","emitEvent","anonUsername","realm","existingUsername","activeServices","getSubscribedServices","BasicError","message","code","authCodes","INVALID_STATE","setCredentialsFinished","eventTypes","AUTH_ERROR","methodsOfAuthentication","map","Boolean","filter","x","INVALID_CREDENTIALS","Accept","queryParams","tokenrealm","info","Authorization","base64","encode","utf8","isAnonymous","AUTH_CHANGE","_selectors2","_errors","_base","_utf","isBlocked","getBlocking","getBy","prop","val","find","op","isNegotiation","tracker","status","OP_STATUS","FINISHED","OPERATIONS","END","add","operation","opString","isLocal","ongoing","id","warn","NOT_STARTED","remove","JOIN","DIRECT_TRANSFER","CONSULTATIVE_TRANSFER","includes","index","findIndex","toState","getById","getByType","getNegotiation","getPending","PENDING","getAll","callId","operationId","eventId","opInfo","joinOptions","isJoinedCall","ONGOING","start","startOperation","update","result","updateOperation","resume","resumeOperation","RESOLVING","finish","err","finishOperation","operationUpdate","transition","OP_TRANSITIONS","START","isBlocking","CALL_OPERATION","previous","UPDATE","operationData","RESUME","FINISH","stages","responsesReceived","calls","reduce","acc","cur","hasResolved","hasAllFeedback","every","onComplete","reportEvent","endEvent","feedbackHandlers","sessionComplete","async","params","remoteSuccess","sessionFail","remoteFailure","callEnd","validationError","validate","signalling","receiveResponse","eventType","localOpFlow","_LocalNegotiation","negoFlow","createNegFlow","respondCallUpdate","getCallById","role","joinedFailure","localOffer","deferredResponse","responseReceived","restComplete","remoteResponse","wrtcsSessionId","CALL_STATES","ENDED","sdp","retryAfter","customParameters","customNames","param","customParametersReceived","CUSTOM_PARAMETERS","mediaState","getMediaState","remoteAnswer","processResponse","callCodes","GENERIC_ERROR","rollback","opData","ADD_MEDIA","ADD_BASIC_MEDIA","localOp","currentOperations","webrtcSessionId","rollbackLocal","promise","then","resolve","catch","reject","localChanges","Promise","race","setTimeout","_constants2","_state","Callstack","channel","getCallByWrtcsSessionId","isSlowStart","mediaOffered","audio","video","sdpTransform","media","forEach","aMedia","callIncoming","remoteParticipant","displayName","remoteName","displayNumber","remoteNumber","to","calleeNumber","from","CALL_INCOMING","remoteOffer","toLowerCase","resyncCallState","_sdpTransform","remoteOp","setError","newRemoteOperation","generic","createGeneric","pendingOp","stage","notificationEvent","addEvent","REPORTER_OPERATION_EVENTS_MAP","registerNegotiation","registerUpdate","registerMulti","callManager","_operationMap","_OperationTracker","_Negotiation","_Update","_MultiCall","_uuid","checkCallExistence","INVALID_PARAM","CallReporter","CallRequests","manager","getTracker","getCallIds","keys","exiComplexResponse","priCall","data","priCallId","joinedCallId","stackMethod","make","createReport","local","createTracker","_len","_key","establishOffer","uuidV4","remote","negotiationOffer","SLOW_START","utils","getRemoteOperationInfo","operationMap","isGlare","timeDelayed","updateSessionResponse","statusCode","GLARE","negotiationAnswer","opState","ind","arr","getExistingNegotiation","SLOW_ANSWER","HOLD","UNHOLD","REMOVE_MEDIA","REMOVE_BASIC_MEDIA","MEDIA_RESTART","ANSWER","REJECT","IGNORE","FORWARD_CALL","REPLACE_TRACK","RESYNC","PLAY_AUDIO","SEND_RINGING_FEEDBACK","SEND_CUSTOM_PARAMETERS","SEND_DTMF","GET_STATS","_len2","_key2","newLocalNegotiation","notificationMap","pendingMake","MAKE","MAKE_ANONYMOUS","_len3","_key3","receiveUpdate","makeUpdate","pendingComplex","some","end","callIds","secCallId","blockedId","track","_len4","_key4","newDualCall","instanceFactory","instanceInfo","createFlow","callInfo","eventName","getReport","statusTracker","Operation","flow","_StatusTracker","createLocal","createRemote","_RemoteNegotiation","hasUpdateStages","UpdateOperation","_LocalOperation","_RemoteUpdate","GET_AVAILABLE_CODECS","START_MOH","STOP_MOH","UNKNOWN","NO_CHANGE","GENERIC_REMOTE","CALL_STATUS_ENDED","CALL_CANCELLED","CALL_STATUS_RINGING","CALL_STATUS_FAILED","RECEIVE_EARLY_MEDIA","SESSION_STATUS_ENDED","callOperations","initCallReporter","initSdpOperations","initWebrtcOperations","initUtils","initCallManager","_sdp","_callManager","_reporter","_utils","shouldHandlePattern","sendCallAudit","_actionTypes","actionTypesToDoAuditOn","UPDATE_CALL","PENDING_JOIN","PENDING_MAKE_CALL","indexOf","INITIATED","RINGING","CallstackWebrtc","getOptions","resyncOnConnect","activeCalls","getCalls","CANCELLED","hasNoOperation","activeCall","callStateAfterConnect","sessionStatusResponse","getSession","currentCall","closeCall","callActions","endCallFinish","CALL_TRACKS_REMOVED","trackIds","localTracks","remoteTracks","CALL_STATE_CHANGE","localHold","remoteHold","WS_CONNECT_FINISHED","iceCollectionInfo","callIceCollectionCheck","SESSION_ICE_GATHERING_STATE_CHANGE","SESSION_ICE_CANDIDATE_COLLECTED","SESSION_ICE_COLLECTION_SCHEDULED_CHECK","_getSessions","_iceCollectionCheck","_normalizeIceFailure","_callAudit","callStackMiddlewares","getSessionsMiddleware","iceCollectionCheck","normalizeIceFailure","callAudit","iceConnectionState","SESSION_ICE_CONNECTION_STATE_CHANGE","CALL_MEDIA_CONNECTION_STATES","DISCONNECTED","otherCallId","otherCall","otherWrtcsSessionId","destination","direction","consultativeTransferSessions","responseError","multiFactory","models","MultiCall","instance","createSignalling","_consultativeTransfer","_remoteSuccess","_remoteFailure","_validate","_ConsultativeTransfer","reasonText","COMPLEX_OPERATION_MESSAGES","CONSULTATIVE_TRANSFER_FAILURE","STATUS_CODES","consultativeTransferFinish","customStatusCode","CONSULTATIVE_TRANSFER_SUCCESS","endSession","account","generateEndParams","_eventTypes","_call","ON_HOLD","createStages","_join","_remoteAnswer","_joinedFailure","_Join","setupOutgoingSession","newCallId","currentCallRemoteName","otherCallRemoteName","participantName","participantAddress","CALL_DIRECTION","OUTGOING","mediaConstraints","bandwidth","checkBandwidthControls","dscpControls","turnInfo","getTurnInfo","trickleIceMode","defaultPeerConfig","removeBundling","serverTurnCredentials","operationEvent","findLastOngoingEvent","webrtcInfo","joinStart","usedCallIds","joinFinish","INITIATING","offerSdp","sessionId","mediaIds","newWrtcsSessionId","joinSessions","sessionState","getSessionById","pendingJoin","CALL_JOIN","CALL_TRACKS_ADDED","_constants3","JOIN_FAILURE","JOIN_SUCCESS","primaryCall","secondaryCall","_directTransfer","_make","_answer","_end","_forward","_ignore","_reject","_callCancelled","_addMedia","_hold","_unhold","_removeMedia","_replaceTrack","_playAudioFile","_getAvailableCodecs","_iceRestart","_sendDtmf","_resyncCallState","_getStats","_sendCallAudit","_sendCustomParameters","_sendRingingFeedback","_musicOnHold","_genericRemote","_slowStart","WebRTC","kind","errorMsg","codecs","webrtcManager","getAvailableCodecs","getCodecsOperation","getCallByWebrtcSessionId","latestMainEvent","values","ICE_COLLECTION_OPERATIONS","iceCollectionEvent","setLocalDescEvent","timeline","event","REPORT_EVENTS","PROCESS_MEDIA_LOCAL","relayCandidates","iceCandidates","candidate","component","ICE_COLLECTION","eventData","getData","relayCollectedEvent","RELAY_CANDIDATE_COLLECTED","addData","address","reason","iceCollectionCheckFunction","callOperation","iceCollectionIdealTimeout","iceCollectionMaxTimeout","RESULT_TYPES","ERROR","UNKNOWN_ERROR","session","sessionManager","iceCollectionCheckResult","WAIT","iceCollectionCheckOperation","normalizeIceFailureOp","Notifications","mediaConnectionState","targetCall","takeAction","END_CALL_FINISH","sessionActions","sessionIceConnectionStateChange","FAILED","MEDIA_CONNECTION_CHANGE","_actionTypes2","sendCallAuditOperation","timeoutHandle","successDelay","errorDelay","getAuditDuration","lastAudit","Date","now","prepareRaceTriggers","triggerTimeout","timeout","triggerAudit","clearTimeout","wrtcsSessionIdToUse","isCaller","auditCall","audit","statusVal","handleAuditResult","value","Math","max","callAuditTimer","min","basicError","auditDuration","latestCallState","repeatingTask","raceTriggers","waitTime","localStages","createLocalStages","remoteStages","createRemoteStages","addMediaValidate","rollbackOperation","basicValidate","negFactory","Negotiation","addMedia","addBasicMedia","webrtcAddMediaOperation","_webrtcAddMedia","_rollbackAddMedia","_validateBasic","_remoteOffer","_kandyWebrtc","callBandwidth","finalBandwidth","medias","webrtcAddMedia","tracks","currMedia","concat","updateSession","offer","customBodies","rollbackErr","rollbackAddMedia","rollbackError","browser","getBrowserDetails","callReport","processResponseEvent","getEvent","PROCESS_MEDIA_REMOTE","sessionInfo","answerSdp","receivedAnswer","getMediaById","affectedLocalTracks","CALL_ADDED_MEDIA","mediaId","addMediaFinish","CONNECTED","tracksOfKind","getTrackById","addMediaError","stageData","remoteAddMediaFinish","_remoteTracks","_setMediaInactive","CallstackSDP","CALL_MEDIA_STATES","DUAL_HOLD","LOCAL_HOLD","setMediaInactive","mediaDiff","compareMedia","remoteDesc","answer","handleOffer","answerSDP","getAffectedRemoteTracks","localTracksToRemove","getTracks","invalidTracks","_isUndefined2","_isEmpty2","join","removeTracks","all","stop","rollbackLocalDescription","sessionOptions","createdMedias","trackLists","organizeTracks","dscpTrackMapping","getTrackDscpMapping","addTracks","callConfigOptions","setLocalDescriptionEvent","newSdp","createOffer","runPipeline","step","endpoint","setLocalDescription","setLocalError","mediaStates","eachMedia","_media","directTransferSession","_DirectTransfer","DIRECT_TRANSFER_FAILURE","directTransferFinish","DIRECT_TRANSFER_SUCCESS","genericRemote","updateCall","_hasMediaFlowing","hasMediaFlowing","sameSession","isSameSdpSessionId","recreatePeer","replace","getAllRemoteTracks","hold","_rollbackHold","generateOffer","generateOfferError","rollbackHold","holdCallFinish","remoteHoldFinish","setTransceiversDirection","handleRollbackFailure","iceRestart","_utils2","getDtlsRole","mediaConnectionRetryDelay","delay","restartIce","connected","getConnectionState","waitForReconnect","subscriptionCodes","WS_CONNECTION_ERROR","mediaDirections","getLocalTracks","otherOptions","INVALID_OFFER","restartMediaFinish","localMakeStages","callStatusUpdateRinging","callRinging","receiveEarlyMedia","earlyMedia","updateFactory","Update","createNeg","createPending","createIncoming","setupIncomingCall","_callStatusUpdateRinging","_receiveEarlyMedia","_incomingCall","_RemoteCall","_setupIncomingCall","_setupOutgoingSession","participants","callOptions","createSession","pendingMakeCall","processAnswer","EARLY_MEDIA","sessionProgress","makeCallFinish","startTime","validateDestination","validateMediaConstraints","validateDetachedMedia","callConfig","receiveCallEvent","RECEIVE_CALL","nextState","ringingFeedbackMode","updateCallRinging","iceServers","iceInfo","credential","peer","rtcConfig","sessionCreated","processOffer","screen","finalSdp","createStartStages","createStopStages","startMOH","stopMOH","_start","_stop","remoteStartMohFinish","remoteStopMohFinish","removeValidate","removeMedia","removeBasicMedia","webrtcRemoveMediaOperation","_webrtcRemoveMedia","_rollbackRemoveMedia","CALL_REMOVED_MEDIA","removeMediaFinish","webrtcRemoveMedia","removeMediaError","rollbackRemoveMedia","_isArray2","remoteRemoveMediaFinish","dir","getOpInfo","setRemoteDescriptionEvent","onSlowFinish","actionCreator","actionMap","remoteUnholdFinish","remoteSlowStart","isRemote","getActionCreator","handleUpdates","startStages","remoteFinish","slowStart","_finish","mediaBrokerOnly","slowOffer","createRemoteAnswer","unhold","_rollbackUnhold","parsedSdp","affectedRemoteTracks","unholdCallFinish","rollbackUnhold","newCall","removedTracks","hasMOH","incomingCall","report","answerEvent","gumEvent","GET_USER_MEDIA","detachedMedias","getWithMedia","errorObj","USER_MEDIA_ERROR","detachedMediaObjs","detachedMedia","createAnswer","slowStages","createSlowStages","slowValidate","remoteSlowAnswer","answerSlow","answerWebrtcSession","_slowAnswer","_validate2","_remoteSlowAnswer","_answerWebrtcSession","answerSession","getIncomingRemoteTracks","answerCallFinish","resyncEvent","INCOMING","key","entries","equivalentKey","callAccepted","CALL_CANCEL","callCancelled","remoteOperation","createEnded","_callStatusUpdateEnded","prevCall","forwardSession","forward","trackId","Map","rtcStatsReport","getStats","sdkId","getVersion","sdk","details","sdkMetaData","platform","iter","rtcStatValue","timestamp","stat","_version","_sdkId","ignore","playAudioFile","_playAudio","filePath","onPlayingCallback","duration","insertAudio","NOT_SUPPORTED","SESSION_AUDIO_ENDED","STATE_DESYNC","rejectSession","replaceTrack","replaceTrackWebrtcOperation","_webrtcReplaceTrack","webRtcReplaceTrack","newTrackId","oldTrackState","newTrackKind","noOfTruthyTrackTypes","oldTrack","allLocalTracks","oldTrackKind","newMedias","newTrack","allNewTracks","newTracks","replaceTrackError","sessionStatus","latestCall","resyncFinish","sendCustomParameters","updateCustomParameters","sendDtmf","tone","intertoneGap","gap","Number","stream","getStream","AudioContext","source","createMediaStreamSource","dest","createMediaStreamDestination","connect","getAudioTracks","addTones","close","sendDTMF","_tones","_playMethods","_hasTelephoneEvent","getRemoteDescription","canSendOutBand","hasTelephoneEvent","playOutBand","playInBand","convertTone","test","splitTones","matches","match","targetNode","tones","oscillators","createOscillator","oscNode","createGain","scheduleTone","dur","frequency","setValueAtTime","gain","toneSequence","toneStart","currentTime","delayTime","disconnect","END_LOCAL","END_REMOTE","ADD_MEDIA_REMOTE","ADD_TRACKS","REMOVE_MEDIA_REMOTE","HOLD_LOCAL","HOLD_REMOTE","UNHOLD_LOCAL","UNHOLD_REMOTE","REMOTE_RINGING","REST_REQUEST","AUDIT_CALL","CREATE_SESSION","ANSWER_SESSION","REJECT_SESSION","FORWARD_SESSION","UPDATE_SESSION","GET_SESSION","CALL_RINGING_UPDATE_SESSION","UPDATE_CUSTOM_PARAMETERS_ON_SESSION","END_SESSION","CALL_DURATION","MAKE_CALL_PRE_LOCAL_SETUP","MAKE_CALL_LOCAL_SETUP","MAKE_CALL_REMOTE_SETUP","TIME_TO_MAKE","ANSWER_CALL_PRE_LOCAL_SETUP","ANSWER_CALL_LOCAL_SETUP","TIME_TO_ANSWER","TIME_FROM_RECEIVE_TO_ANSWER","TIME_TO_CALL_SETUP_DURATION","TIME_TO_RINGING","TIME_TO_IGNORE","TIME_TO_REJECT","TIME_TO_ADD_MEDIA","TIME_TO_ADD_MEDIA_REMOTE","TIME_TO_REMOVE_MEDIA","TIME_TO_REMOVE_MEDIA_REMOTE","TIME_TO_RESTART_MEDIA","TIME_TO_HOLD_LOCAL","TIME_TO_HOLD_REMOTE","TIME_TO_UNHOLD_LOCAL","TIME_TO_UNHOLD_REMOTE","TIME_TO_COLLECT_ICE_CANDIDATES","TIME_TO_RELAY_CANDIDATES","TIME_TO_SEND_CUSTOM_PARAMETERS","TIME_TO_FORWARD","TIME_TO_DIRECT_TRANSFER","TIME_TO_CONSULTATIVE_TRANSFER","TIME_TO_JOIN","MAKE_REMOTE","ADD_BASIC_MEDIA_REMOTE","REMOVE_BASIC_MEDIA_REMOTE","START_MOH_REMOTE","STOP_MOH_REMOTE","SLOW_START_REMOTE","UNKNOWN_REMOTE","NO_CHANGE_REMOTE","callStatusUpdateEnded","callReporter","reporter","createReporter","metricHandlers","registerAllMetricHandlers","deleteReport","_metricHandlers","_webrtcReporter","durationHandler","metric","startEvents","autoUnregister","startEvent","timelineEvent","timelineSubEvent","REPORT_METRICS","addMetric","unregisterMetricHandler","callPreSDPHandler","joinedCallDurationHandler","relayCandidatesHandler","collectedCandidates","collectedCandidateInformation","candidateInfo","candidates","handlers","registerMetricHandler","originalSdp","original","setup","generateBandwidthConfigs","limit","mLine","crypto","fingerprint","_compareMedia","_pipeline","prevSdpString","sdpString","isNaive","prevSdp","prevMedia","summarizeMedia","sortedMedia","matchMediasNaive","matchMedias","removed","prevUnmatched","added","currUnmatched","changed","unchanged","matched","current","changes","compareSummary","sending","MEDIA_TRANSITIONS","SAME","receiving","_summarizeMedia","_matchMedias","_compareSummary","change","willSend","STOP","willReceive","prevList","currList","prev","curr","findMatchingMediaIds","prevM","mediaList","sectionId","m","currIndex","findMatchingSectionId","currM","longerLength","wasHold","was3xHold","wasUnhold","was3xUnhold","wasStartMoh","wasAddMedia","wasStopMoh","wasRemoveMedia","wasNoChange","stoppedFlowing","hadMediaFlowing","noActiveMediaAdded","noMediaRemoved","didChange","allStopped","notSending","notReceiving","stillStopped","startedFlowing","sameMedia","noUnchangedSend","onlyStartChanges","onlyStartSending","onlyStartReceiving","wasFlowing","allSendOnly","_ref3","isFlowing","allSending","_ref4","wasntRemoved","somethingStarted","addedSending","changedSending","_ref5","wasntAdded","wasChanged","onlyStopSending","_ref6","onlyAudioChange","inactiveUnchanged","stopSendAudio","noChange","hasUnchanged","unchangedFlowing","changedFlowing","_ref7","wasSending","wasReceiving","removedFlowing","_ref8","addedFlowing","sectionIds","addedMediaSections","changedMedia","sectionIndex","newSectionsWithTracks","mediaSummary","getAddedSectionIds","removedMediaSections","getRemovedSectionIds","heldSections","get3xHeldSectionIds","getHeldSectionIds","unheldSections","get3xUnheldSectionIds","getUnheldSectionIds","getRemoteTrackIdsFromTransceivers","getIncomingRemoteTrackIds","_operations","getActiveRemoteTrackIds","sdpMedia","mid","ssrcGroups","mediaDirection","msid","ssrcs","ssrc","attribute","summary","logLevel","getLevel","logLevels","DEBUG","TRACE","runPipelineYaml","runPipelineDefault","_runDefault","_runYaml","_kandyLogger","objectSdp","freeze","handler","formattedFunctionName","_isFunction2","write","diffed","oldNewSdp","results","diff","text","yamlFormat","sdpToYaml","_variableDiff","finalDiffObject","displayBandwidth","displaySdp","fourSpaces","displayHandlers","displayDiffs","sixSpaces","toString","JSON","stringify","indentation","trimEnd","_compose2","_trimEnd2","_trimCharsStart2","_join2","_map2","eightSpaces","isVideoInactive","item","isAudioInactive","stringSdp","rtp","codec","bandwidthControls","finalBandwidthControls","currentCallState","endParams","prevState","callAction","eventFns","currState","currentState","prevRemote","_without2","getNewRemoteTracks","audioTracks","videoTracks","screenTracks","screenNetworkPriority","screenTrack","audioNetworkPriority","audioTrack","videoNetworkPriority","videoTrack","createGetOperation","_remoteOperation","obj","getLatestRemoteDesc","getOperation","isMediaFlowing","REMOTE_HOLD","detached","isArray","requestedMedia","trackKinds","duplicateKinds","mediaKind","hasSameSessionId","firstSdpSessionId","getSdpSessionId","secondSdpSessionId","oLine","currentDesc","isDetached","_closeCall","_createLocal","_generateOffer","_handleOffer","_receivedAnswer","WebRTCMediaOperations","getUserMediaEvent","sessionNotFoundMsg","newRole","changeDtlsRoleTo","errorInfo","SESSION_MISMATCH","_changeDtlsRoleTo","iceCollectionDelay","maxIceTimeout","skipIceCollection","url","serverUrl","URL","query","search","queryFilterFunc","startsWith","serverQueryParams","URLSearchParams","delete","newQuery","defaultOptions","_logs","_defaults","sdpSemantics","normalizeDestination","array","iceCandidatePoolSize","optional","iceTransportPolicy","bundlePolicy","certificates","expires","peerIdentity","rtcpMuxPolicy","function","boolean","NEW","CHECKING","COMPLETED","CLOSED","CHANGE_MEDIA","HOLD_MEDIA","UNHOLD_MEDIA","MUSIC_ON_HOLD","audioinput","videoinput","audiooutput","START_CALL","callPrefix","turnPrefix","trackPrefix","callActionHelper","ADD_MEDIA_FINISH","ANSWER_CALL","ANSWER_CALL_FINISH","AVAILABLE_CODECS_RETRIEVED","CALL_ACCEPTED","CALL_RINGING","CONSULTATIVE_TRANSFER_FINISH","CUSTOM_PARAMETERS_RECEIVED","DIRECT_TRANSFER_FINISH","END_CALL","FORWARD_CALL_FINISH","deferred","GET_STATS_FINISH","CALL_HOLD","CALL_HOLD_FINISH","IGNORE_CALL","IGNORE_CALL_FINISH","JOIN_FINISH","JOIN_START","MAKE_ANONYMOUS_CALL","callee","credentials","MAKE_ANONYMOUS_CALL_FINISH","MAKE_CALL","MAKE_CALL_FINISH","OPERATION_UPDATE","PENDING_CONSULTATIVE_TRANSFER","PENDING_OPERATION","PLAY_AUDIO_FINISH","PENDING_PLAY_AUDIO","REJECT_CALL","REJECT_CALL_FINISH","REMOTE_ADD_MEDIA_FINISH","CALL_REMOTE_HOLD_FINISH","REMOTE_REMOVE_MEDIA_FINISH","REMOTE_SLOW_START","REMOTE_START_MOH_FINISH","REMOTE_STOP_MOH_FINISH","CALL_REMOTE_UNHOLD_FINISH","REMOVE_MEDIA_FINISH","REPLACE_TRACK_FINISH","MEDIA_RESTART_FINISH","RESYNC_FINISH","SEND_CUSTOM_PARAMETERS_FINISH","SEND_DTMF_FINISH","SEND_RINGING_FEEDBACK_FINISH","SESSION_CREATED","SESSION_PROGRESS","customOptions","SET_CUSTOM_PARAMETERS","_isPlainObject2","CALL_UNHOLD","CALL_UNHOLD_FINISH","callActionsImport","turnActionsImport","TURN_CHANGED","CallManager","directTransfer","normalizeSipUri","getDomain","consultativeTransfer","_normalization","states","mediaConnectionStates","reportEvents","metrics","formatMediaConstraints","makeCall","CALL_STARTED","answerCall","rejectCall","rejectCallFinish","ignoreCall","ignoreCallFinish","forwardCall","forwardCallFinish","endCall","establishApis","midcallApis","complexApis","miscApis","constantsApis","_establish","_midcall","_complex","_misc","holdCall","unholdCall","startVideo","videoOptions","stopVideo","trackObj","replaceTrackFinish","CALL_TRACK_REPLACED","restartMedia","resync","playAudio","playAudioFinish","onPlaying","callback","sendRingingFeedback","sendRingingFeedbackFinish","setCustomParameters","sendCustomParametersFinish","sendDTMFFinish","getStatsFinish","STATS_RECEIVED","getSerializable","availableCodecsRetrieved","AVAILABLE_CODECS","setSdpHandlers","setSdpHandlersAction","_actions2","LOCAL","REMOTE","webrtcActionTypes","callEnder","endTime","callReducers","_concat2","setHandling","isHandling","newState","webrtcId","stateProperties","remoteSlow","tracksLeft","localTracksLeft","addedTracks","_union2","localAdded","callState","removedRemote","removedLocal","localLeft","addedLocal","localRemoved","oldTrackId","callReducer","specificCallActions","combineActions","specificWebrtcSessionActions","updatedCall","operationReducer","turn","_turn","stateProp","unsetOperation","currentOp","_isNil2","_contains2","NO_FINISH_OPS","endedStates","audioOptions","screenOptions","setupCallstack","operationFactories","pluginInterface","createRequests","mediaDevices","peerConnection","getWebRTCSupportCapabilities","parseConfigs","mergeDefaults","browserDetails","iceServer","urls","fixIceServerUrls","removeH264Codecs","middleware","createMiddleware","_middleware","_requests","_configs","_callstack","notificationMessage","sessionData","sessionParams","NOTIFICATION_RECEIVED","remoteInfo","getRemoteParticipant","callStatusUpdateFailed","notificationParams","callNotificationParams","callerName","callerDisplayNumber","calleeDisplayNumber","middlewares","factories","_callCancelledNotification","_callStatusUpdateEndedNotification","_callStatusUpdateFailedNotification","_callStatusUpdateRingingNotification","_sessionStatusUpdateEndedNotification","_incomingCallNotification","_remoteAnswerNotification","_remoteOfferNotification","_resyncSessionStatuses","_sessionProgressNotification","_setTurnCredentials","callCancelledNotification","callStatusUpdateEndedNotification","callStatusUpdateFailedNotification","callStatusUpdateRingingNotification","sessionStatusUpdateEndedNotification","incomingCallNotification","remoteAnswerNotification","remoteOfferNotification","resyncSessionStatuses","sessionProgressNotification","setTurnCredentials","remoteDisplayNumber","sessionStatusUpdateEnded","CallOperations","SUBSCRIBE_FINISHED","subscriptions","turnCredentials","turnActions","turnChanged","sendRequest","getRequestInfo","method","body","callControlRequest","requestEvent","response","requestUtils","linkCallRequest","firstSessionData","secondSessionData","callControlResponse","originator","requestBody","supported","fetchInfo","responseType","websocketId","getWebsocketId","callMeRequest","notifyChannelId","REPORTER_REQUESTS","callDispositionRequest","_selectors3","complexRequests","establishRequests","miscRequests","negotiationRequests","_negotiation","ongoingLocalOp","bodyType","auditCallEvent","generateCallUrl","handleLinkCallRequestError","getMessage","endUrl","notification","isConference","codecStringsToRemove","finalRemoveList","filteredRtp","relevantCodec","fmtpParams","fmtp","c","parseInt","isNumber","payloads","payloadCount","rtcpFb","timeoutConfigs","iceCollectionDuration","iceGatheringState","rtcPeerConnectionConfig","rtcLocalSessionDescription","ICE_COLLECTION_RESULT_TYPES","totalTurnServers","sdpMid","wait","withoutVisualSeparators","inputString","resultingAddressAndDomain","addressString","defaultDomainString","extractedDomain","indexOfAtSymbol","lastIndexOf","substr","extractDomainFromAddress","separateAddressAndDomain","trim","prepend","prependedDataMatches","extractPrependedData","leadingChars","potentialLeadingChars","extractLeadingSpecialCharacters","phoneNumberMatch","isPhoneNumber","domainString","hasMedia","isLocalHold","isRemoteHold","isDualHold","logEntry","ADD_CALL_HISTORY_ENTRY","recordId","DELETE_CALL_HISTORY","DELETE_CALL_HISTORY_FINISH","amount","offset","FETCH_CALL_HISTORY","FETCH_CALL_HISTORY_FINISH","SET_CACHE","CallHistoryOperations","history","getCallHistory","fetch","retrieveCallLogs","_isNumber2","callHistoryCodes","BAD_REQUEST","retrieveCallLogsFinish","CALL_HISTORY_ERROR","CALL_HISTORY_CHANGE","CALL_HISTORY_CACHE_CHANGE","removeCallLogs","removeCallLogsFinish","clear","getCache","getCachedHistory","setCache","dataObj","localLogs","localLogsRemoved","resourceLocation","uniqueLogs","isSimilar","newLogs","_unionBy2","_reverse2","_sortBy2","serverLogEntry","abs","this","fetchRequest","fetchOperation","_operation","CallHistoryRequests","requests","fetchCallLogs","startIndex","count","bodyStatusCodeMap","NOT_AUTHENTICATED","FORBIDDEN","logHistory","logItems","calleeName","errorCode","errorMessage","_fetch","_remove","_setCache","_storeLog","removeRequest","removeOperation","NOT_FOUND","logRecord","setCacheOperation","storeOperation","originalRemoteParticipant","addCallLogEntry","features","returnVal","storeCallLog","PREFIX","caller","CLICK_TO_CALL","requestTime","CLICK_TO_CALL_FINISH","ClickToCallOperations","CLICK_TO_CALL_ERROR","CLICK_TO_CALL_STARTED","createOperations","ClickToCallRequests","clickToCallCodes","MISSING_ARGS","clickToCallFinish","clickToCallData","conn","clickToCallRequest","callingParty","calledParty","errMsg","RESPONSE_ERROR","func","interval","intervalId","getId","setInterval","clearInterval","selector","_isElement2","service","_v8n","extend","exactValues","exact","passesAnyOf","errorMessages","v8nRule","input","_flatMap2","validationErrorMessages","validationResults","testAll","errors","prettyPrint","validationErrorMessageHelper","cause","rule","target","path","newVEM","ruleMessage","enumName","aOrAn","arg","chain","_partial2","_2","api","sanitizeSdesFromSdp","modifySdpBandwidth","SET_SDP_HANDLERS","pluginName","CONFIG_UPDATE","_sanitizeSdesFromSdp","_modifySdpBandwidth","getConfig","getConfiguration","newConfigValues","configs","parseCallConfigs","configApi","ws","onclose","onmessage","onopen","onerror","wsUrl","toQueryString","WebSocket","_toQueryString","createWsAction","isReconnect","WS_ATTEMPT_CONNECT","WS_DISCONNECT","WS_DISCONNECT_FINISHED","WS_RECONNECT_FAILED","WS_CLOSED","WS_ERROR","CHANGE_CONNECTIVITY_CHECKING","Connectivity","SubscriptionOperations","getSocketState","enableConnectivityChecking","enable","changeConnectivityChecking","setPinging","resetConnection","wsState","autoReconnect","getConnectivityConfig","wsInfo","wsReconnectFailed","onConnectionLost","pinging","_omit2","kandy","checkConnectivity","UNSUBSCRIBE_FINISHED","defaultValues","connCheckMethods","KEEP_ALIVE","pingInterval","reconnectLimit","reconnectDelay","reconnectTimeMultiplier","reconnectTimeLimit","webSocketOAuthMode","_defaults2","applyDefaults","checkOptions","responsibleParty","connCheckResponsibility","CLIENT","createWebsocketManager","constants","WS_STATUS","_wsManager","wsManager","NotificationsOperations","wsAttemptConnect","WS_CHANGE","connConfig","shouldCheck","getCheckConnectivity","startTebAttempts","taskTimeout","attemptDelay","delayMultiplier","maxDelay","maxAttempts","message_type","wsConnectFinished","onDisconnect","lostConnection","access_token","processNotification","onMessage","wasClean","wsDisconnectFinished","shouldPing","isPinging","timedPromise","timeoutId","finally","makeTebSequence","delayLimit","multiplier","iterations","nextDelay","pow","task","nextTimeout","taskParams","delays","attemptTask","lastTask","done","lesserDelay","CONNECTING","RECONNECTING","NO_SOCKET","websocket","socketStatus","connectInterrupt","emitter","eventEmitter","getStatus","cleanupWebSocket","stopPinging","readyState","send","openWebsocket","_websocket","_rbbnEmitter","LINK","WEBSOCKET","PUSH","SERVER","PING_PONG","CONNECT_FAIL_WS_ERROR","LINK_UNSUBSCRIBE_FAIL","LINK_SUBSCRIBE_FAIL","LINK_EXTEND_SUBSCRIPTION_FAIL","LINK_UPDATE_SUBSCRIPTION_FAIL","MISSING_SERVICE","LINK_SUBSCRIBE_UNAVAILABLE","INIT_MEDIA_FAILED","NO_ICE_CANDIDATES","MISSING_PARAMETERS","SEND_MESSAGE_FAIL","FETCH_MWI_FAIL","NOT_PROVISIONED","NOT_SUBSCRIBED","INVALID_INPUT","ALREADY_EXISTS","MEDIA_NOT_FOUND","NO_SERVICE_PROVIDED","WS_MESSAGE_ERROR","INVALID_STATUS","INVALID_ACTIVITY","INVALID_REQUEST","REFRESH_CONTACTS_FAIL","DIRECTORY_REQUEST_FAIL","INVALID_TRACK_ID","TRACK_IN_USE","TRACK_NOT_LOCAL","SET_PROXY_CHANNEL_FAIL","IN_ACTIVE_CALL","VERSION_MISMATCH","TIMEOUT","_codes","NO_CODE","constructor","Events","EVENTS_OFF","EVENTS_ON","EVENTS_SUBSCRIBE","EVENTS_UNSUBSCRIBE","eventReducer","aliases","_update2","_add2","pluginFactories","sdkOptions","clonedOptions","common","pluginOptions","factoryDefaults","Bottle","store","loggerMiddleware","destroyedSDK","createInterval","plugin","disableProxy","composeMiddleware","enableReduxDevTools","composeWithDevTools","reduxDevToolsName","composeWithoutDevTools","createStore","combineReducers","applyMiddleware","endsWith","_merge2","getCapabilities","destroy","_destroy","replaceReducer","_redux","_reduxDevtoolsExtension","_bottlejs","_intervalFactory","entry","console","messages","groupEnd","style","level","logInfo","logType","toUpperCase","styleLog","logger","setHandler","logActions","setLevel","actionOptions","INFO","actionOnly","excludeActions","predicate","titleFormatter","colors","transformers","setupTransformers","createLogger","_transformers","_reduxLogger","actionTransformers","exposePayloads","passwordHider","removePayloads","actionTransformer","transformer","actionPipeline","isSafe","time","took","parts","toFixed","_actionHandler","defaultActionHandler","collapsed","createManager","handlerMap","HANDLERS_CHANGE","levelMap","LEVELS_CHANGE","SET_HANDLER","SET_LEVEL","LogsOperations","levels","SILENT","WARN","setLogLevel","setLogHandler","getTypes","clonedState","loggers","getLoggers","types","Set","defaultType","getHandler","levelsChanged","getLevelMap","handlersChanged","getHandlerMap","constant","partialDefaultLogActions","components","createActionLogger","webRTCLogManager","_actions3","CREATE_CONVERSATION","isTypingList","DELETE_CONVERSATION","DELETE_CONVERSATION_FINISH","FETCH_CONVERSATIONS","conversations","FETCH_CONVERSATIONS_FINISHED","conversation","UPDATE_CONVERSATION","messageActionsImport","convoActionsImport","CLEAR_MESSAGES","messageId","DELETE_MESSAGE","DELETE_MESSAGE_FINISH","FETCH_MESSAGES","FETCH_MESSAGES_FINISHED","sender","newConversation","MESSAGE_RECEIVED","read","participant","SEND_MESSAGE_READ_FINISH","messageReadHelper","actionType","sendMessage","sendMessageHelper","SEND_MESSAGE","deliveryStatus","SEND_MESSAGE_FINISH","incomingMessageRead","INCOMING_MESSAGE_READ","sendMessageRead","SEND_MESSAGE_READ","MixinsMessaging","recipient","description","findConversation","Conversation","lastMessage","lastReceived","lastPull","convoActions","createConversation","selectConversations","_mixins","MessagingOperations","Message","part","messageContext","messageActions","MESSAGES_CHANGE","getMessagingConfig","createMessage","clearMessages","getMessages","markRead","convo","_find2","subscriber","subscriberWrapper","_isEqual2","_unionWith2","b","sendMessageFinishHelper","conv","members","member","conversationId","createMixins","messageReceived","MessagingRequests","imnotificationParams","msgText","primaryContact","metaType","getConversations","mimeType","CONVERSATIONS_CHANGE","connectionInfo","messagingCodes","sendMessageFinish","MESSAGES_ERROR","messageData","imRequest","charset","toUrl","imResponse","mwiData","MWI_UPDATE","MWIOperations","voicemail","fetchMwi","MWI_ERROR","MWI_CHANGE","getMwi","mwiReceived","MWIRequests","fetchVoicemails","mwiUpdate","processMwi","mwiNotificationParam","mwiresponse","mwiCodes","totalVoice","unheardVoice","newMessagesWaiting","lastUpdated","ENABLE_NOTIFICATION_CHANNEL","ENABLE_NOTIFICATION_CHANNEL_FINISH","channelEnabled","notificationHelper","PROCESS_NOTIFICATION_FINISH","REGISTER_ANDROID_PUSH_NOTIFICATION","pushProvider","REGISTER_APPLE_PUSH_NOTIFICATION","registration","UNREGISTER_ANDROID_PUSH_NOTIFICATION","UNREGISTER_APPLE_PUSH_NOTIFICATION","PROCESS_NOTIFICATION","process","externalNotification","registerApplePush","services","voipDeviceToken","standardDeviceToken","bundleId","clientCorrelator","isProduction","registerApplePushNotification","registerPushDeviceToken","registerAndroidPush","deviceToken","registerAndroidPushNotification","unregisterApplePush","registrationInfo","unregisterApplePushNotification","unregisterPushDeviceToken","unregisterAndroidPush","unregisterAndroidPushNotification","enableWebsocket","enableNotificationChannel","enableWebsocketChannel","NOTI_CHANGE","NOTI_ERROR","newChannelState","idCacheLength","incomingCallNotificationMode","pushRegistration","_defaultsDeep2","_notification","_pushRegistration","enableNotificationChannelFinish","_processNotification","_enableWebsocketChannel","NotificationRequests","queue","notificationChannel","getNotificationConfig","getNotificationsInfo","notificationId","formattedNotification","_has2","sdpFormat","fetchSDP","eventDataResponse","normalizeSDP","processNotificationFinish","shift","notificationReceived","NOTI_RECEIVED","_registerPushDeviceToken","_unregisterPushDeviceToken","pushNotificationsRegistration","pushNotificationsDeRegistration","bundleID","responseBody","registrationResponse","responseName","statuscode","partialUrl","actionListeners","pattern","singleTake","CREATE_PRESENCE_LIST_FINISH","CREATE_PRESENCE_LIST","presenceListId","DELETE_PRESENCE_LIST","GET","GET_FINISH","GET_PRESENCE_LIST","RECEIVED","SUBSCRIBE","presentityUserId","SUBSCRIBE_FINISH","UNSUBSCRIBE","UNSUBSCRIBE_FINISH","activity","note","UPDATE_FINISH","PresenceOperations","SELF_CHANGE","user","storedUsers","selectors","getPresence","getAllPresence","getSelf","getSelfPresence","loading","userIds","userId","updatedUsers","_ref9","OPEN","ACTIVE","IDLE","AWAY","LUNCH","OTHER","BUSY","VACATION","ON_THE_PHONE","newApi","statuses","STATUS","activities","ACTIVITY","presenceReceived","PresenceRequests","presenceWatcherNotificationParams","updatePresence","presenceCodes","updatePresenceFinish","watchPresence","getPresenceFinish","subscribePresence","presenceWatcherResponse","subscribePresenceFinish","unsubscribePresence","unsubscribePresenceFinish","presenceRequest","presenceResponse","presenceWatcherRequest","userList","getStatusCode","injectAgentVersionHeader","customAgentVersionHeaderSuffix","_requestModule","pluginFactory","createRequestHelper","AUTHORIZATION_ERROR","REQUEST","requestId","nextRequestId","RESPONSE","request","resource","init","fetchResource","responseTypes","makeResponse","validateOptions","fetchOptions","substring","ok","statusText","expectedType","json","blob","none","parseBody","contentType","retryValue","subscribeResponse","authorizationResponse","getTime","apiResponse","httpResponse","logOptions","sanitizeRequest","makeRequest","authorizations","REQUEST_ERROR","logState","groupMethod","actionToLog","pad","num","maxLength","repeat","times","getHours","getMinutes","getSeconds","getMilliseconds","_makeRequest","charAt","queryString","headerValue","authHeader","createIntervals","takeEveryAction","SipEventsOperations","receiveEvent","_intervals","sipEvent","SIP_EVENT_RECEIVED","subscribeUserList","SIP_EVENT_SUBSCRIBE","finishActionHelper","SIP_EVENT_SUBSCRIBE_FINISH","SIP_EVENT_UNSUBSCRIBE","SIP_EVENT_UNSUBSCRIBE_FINISH","userLists","isResub","SIP_EVENT_UPDATE","unsubscribeUserList","SIP_EVENT_UPDATE_FINISH","sip","EVENT_ERROR","EVENT_SUBSCRIPTION_CHANGED","subscribedUsers","getDetails","getSipEventInfo","_reducer","sipIntervals","isRunning","startResubInterval","resubDelay","sipEventCodes","SipEventsRequests","SipEventsIntervals","intervals","startSipEventResub","stopSipEventResub","sipEventSubscribe","_includes2","sipEventSubscribeFinish","getSubscriptionInfo","finishAction","eventSubscriptionResponse","sipEventUnsubscribe","eventInfo","sipEventUnsubscribeFinish","sipEventUpdate","sipEventUpdateFinish","validUserLists","genericNotification","genericNotificationParams","sessionDataType","targetcall","sipEventReceived","EVENT_RECEIVED","links","eventSubscriptionRequest","FULL","PARTIAL","NONE","WS_OVERRIDDEN","actionFormatter","CHANNEL_CLOSED","channelInfo","CHANNEL_OPENED","PLUGIN_SUBSCRIPTION","PLUGIN_UNSUBSCRIPTION","subscriptionId","resourceURL","PLUGIN_SUBSCRIPTION_FINISHED","channelType","PLUGIN_UNSUBSCRIPTION_FINISHED","attemptNum","RESUBSCRIPTION_FINISHED","notificationTypes","normalizeServices","subscribeFlow","SUB_ERROR","unsubscribeFlow","getSubscriptions","subscribed","available","getRegisteredServices","pendingChange","pendingOperation","_remove2","notificationChannels","registeredServices","currentSub","subConfig","authConfig","sub","_subscribe","_unsubscribe","_update","_onConnectionLost","_onSubscriptionGone","_onWebsocketOverridden","createOperation","SubscriptionIntervals","resubInterval","stopResubInterval","unsubscribeFinished","SUB_CHANGE","onSubscriptionGone","getPendingOperation","content","onWebsocketOverridden","requested","received","upperReceived","missing","reqService","SUBSCRIPTION_STATE","subscribeRequest","subscribeOperation","_subscribeFlow","SubscriptionRequests","linkConnection","getSubscriptionExpiry","maxReAttempts","getServiceUnavailableMaxRetries","subscriptionParams","updateHmacToken","servicesInfo","websocketConfig","getWebsocketConfig","websocketInfo","extras","subscribeType","localization","useTurn","notificationType","returnValue","subscribedServices","parseSpidrServices","_services","finishOrCancel","updateSubscription","subscribeFinished","unsubscribeRequest","unsubscribeOperation","_unsubscribeFlow","subscriptionURL","updatedServices","_difference2","resubscribeRequest","updateSubscriptionOperation","newServices","addService","resubscribe","updatedSubscription","resubResponse","minExpiryInSec","MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL","greaterThanOrEqual","initIntervals","_resubscribe","halfwayInterval","lowerLimit","upperLimit","randomVal","floor","random","resubscribeFinished","SUB_RESUB","isFailure","contact","ADD_CONTACT","ADD_CONTACT_FINISH","contactId","FETCH_CONTACT","FETCH_CONTACT_FINISH","REFRESH_CONTACTS","contacts","REFRESH_CONTACTS_FINISH","REMOVE_CONTACT","REMOVE_CONTACT_FINISH","UPDATE_CONTACT","UPDATE_CONTACT_FINISH","FETCH_USER","FETCH_USER_FINISH","filters","SEARCH_DIRECTORY","SEARCH_DIRECTORY_FINISH","UsersOperations","contactData","addContact","CONTACTS_ERROR","CONTACTS_CHANGE","getContact","getContacts","refresh","refreshContacts","removeContact","updateContact","fetchContact","contactsApi","usersApi","_users","_contacts","usersData","fetchUser","USERS_CHANGE","USERS_ERROR","getUser","getUsers","searchData","searchDirectory","DIRECTORY_ERROR","DIRECTORY_CHANGE","contactsPendingReducer","_unset2","contactsReducers","usersReducers","allUsers","UsersRequests","searchTypeInteger","searchType","remoteContactFromLocal","nickname","localContactFromRemote","localUserFromRemote","searchCriteria","directory","getDirectory","fetchUserFinish","contactsActions","usersCodes","addContactFinish","addressBookRequest","addressBookEntries","contactRequest","extraURL","localContact","removeContactFinish","encodeURIComponent","updateContactFinish","fetchContactFinish","searchDirectoryFinish","res","refreshContactsFinish","criteria","criteriaType","directoryItems","addressBookResponse","checkDevices","devices","devicesChangedAction","deviceActions","devicesChanged","devicesChangedEvent","DEVICES_CHANGED","messageHandler","createHandler","watchDeviceEvents","watchTrackManagerEvents","watchMediaManagerEvents","watchSessionManagerEvents","_devices","_trackManager","_sessionManager","_mediaManager","_eventTypes2","callEvent","SESSION_TRACK_ENDED","isUnsolicited","TRACK_ENDED","getAssociatedCallEvent","mediaNewTrackAction","mediaActions","mediaNewTrack","trackEnded","mediaTrackEndedAction","mediaTrackEnded","newMedia","watchMediaEvents","newMediaAction","removedMedia","removedMediaAction","newTrackAction","sessionNewTrack","sessionTrackEnded","trackReplaced","trackReplacedAction","sessionTrackReplaced","iceConnectionStateChange","iceConnectionStateChangeAction","iceCandidateCollected","iceCandidateCollectedAction","sessionIceCandidateCollected","iceGatheringStateChange","iceGatheringStateChangeAction","sessionIceGatheringStateChange","iceCollectionScheduledCheck","iceCollectionScheduledCheckAction","sessionIceCollectionScheduledCheck","audioFileEnded","isSuccess","sessionAudioEnded","sessionAdded","watchSessionEvents","sessionAddedAction","sessionRemoved","sessionRemovedAction","_session","trackSourceMuted","trackData","trackSourceMutedAction","trackActions","trackSourceMutedEvent","TRACK_SOURCE_MUTED","trackSourceUnmuted","trackSourceUnmutedAction","trackSourceUnmutedEvent","TRACK_SOURCE_UNMUTED","trackAdded","sourceMuted","muted","enabled","watchTrackEvents","trackAddedAction","trackRemoved","trackRemovedAction","trackEndedEvent","_track","webRTC","initialize","createMediaOperations","createLogOperations","createWebRTCOperations","managers","initWebrtc","initLogLevel","watchManagers","_channels","_logs2","miscActions","setBrowserDetails","WebRTCLogOperations","updateLogLevel","WEBRTC","sessionPrefix","mediaPrefix","DEVICES_CHANGE","browserConstraints","INITIALIZE_DEVICES","INITIALIZE_DEVICES_FINISH","deviceActionsImport","trackActionsImport","sessionActionsImport","mediaActionsImport","miscActionsImport","mediaActionHelper","MEDIA_NEW_TRACK","MEDIA_TRACK_ENDED","MEDIA_NEW","MEDIA_REMOVED","SET_BROWSER_DETAILS","sessionActionHelper","SESSION_ADDED","SESSION_NEW_TRACK","SESSION_REMOVED","SESSION_TRACK_REPLACED","trackHelper","MUTE_TRACKS","MUTE_TRACKS_FINISH","REMOVE_TRACKS","REMOVE_TRACKS_FINISH","RENDER_TRACKS","RENDER_TRACKS_FINISH","trackManagerHelper","TRACK_ADDED","TRACK_REMOVED","UNMUTE_TRACKS","UNMUTE_TRACKS_FINISH","WebRTCOperations","createMediaAPI","getBrowserDetailsSelector","setupProxy","proxies","setupProxies","teardownProxy","teardownProxies","getDevices","initializeDevices","constraints","INITIALIZE_DEVICES_ERROR","createLocalMedia","getLocalMedia","disposeLocalMedia","renderTracks","cssSelector","retValue","logCssSelector","TRACK_RENDERED","filteredTrackIds","muteTracks","affectedTrackIds","TRACKS_MUTED","unmuteTracks","TRACKS_UNMUTED","camera","microphone","speaker","sessions","_tracks","_sessions","_browser","mediaReducers","mediaReducer","sessionReducers","removeTrack","newLocalTracks","sessionReducer","containers","removeContainer","getSessions","getMedia","logOperations","updateLogHandler","webrtcLogManager","mediaType","screenShareConstraints","screenShareMedia","createLocalScreen","audioConstraints","audioMedia","videoConstraints","videoMedia","errMessage","constraint","trackState","webrtcCodes","disposedTrack","filteredTracks","_isString2","renderTracksFinish","renderer","renderTrack","speakerId","unrenderTrack","removeTracksFinish","mute","muteTracksFinish","unmute","unmuteTracksFinish","initializeDevice","setupDeviceInitialization","initializeDeviceFinish","replacedManagers","addedManagerEventHandlers","setProxies","managerEventHandlers","eventFn","innerChannel","jsonChannel","receive","sentMessages","isExpired","decorator","setListening","initProxy","initializeProxy","ProxyStack","setProxyMode","_proxyStack","actionHelper","INITIALIZE","INITIALIZE_FINISH","SET_CHANNEL","SET_CHANNEL_FINISH","SET_MODE","SET_MODE_FINISH","ProxyOperations","PROXY_ERROR","PROXY_CHANGE","getProxyMode","getProxyState","proxyMode","getInfo","getProxyDetails","setChannel","initializeRemote","hasChannel","remoteInitialized","proxyActions","getActiveCalls","proxyState","proxyCodes","setProxyModeFinish","webrtcEvents","PROXY","CHANNEL","initializeRemoteFinish","setChannelFinish","handleMessages","actualManager","modelType","Proxy","objTarget","receiver","funcTarget","thisArg","sentTime","opTiming","receivedTime","parseData","modelProxy","_isNull2","_model","clientReady","createManagerProxy","manProxy","wrappedChannel","replyChannel","getChannel","isTimeout","initialized","remoteVersion","pipeline","setHandlers","_manager","_channel","trace","group","groupCollapsed","_logManager","_logFormatter","levelImport","defaultLogFormatter","shortId","formattedString","tail","settings","checkHandler","defaultLogHandler","checkLevel","String","loggerName","_logger","_logHandler","Symbol","logFunc","injectables","levelValues","logMethods","timer","createTimer","timeLog","timeLevel","timeWarn","_timer","timers","timeEnd","elapsed","upperLevel","API_TAG","reportData","addEventIdToMetric","eventIds","onEventEnded","newEvent","createTimelineEvent","subEvent","reverse","isEnded","getMetric","_timelineEvent","reports","newReport","reportFactory","_report","pId","parentId","newSubEvent","getError","PEER","TRICKLE_ICE","halfTrickleThreshold","iceCandidate","nativePeer","proxyPeer","iceTimer","onicecandidate","elapsedTime","timeFromStart","localDescription","HALF","oniceconnectionstatechange","onicegatheringstatechange","gatheringState","ICE_GATHERING_STATE","GATHERING","COMPLETE","_icecandidate","_iceconnectionstatechange","_icegatheringstatechange","_negotiationneeded","_signalingstatechange","onnegotiationneeded","onsignalingstatechange","ontrack","signalingState","trackManager","nativeTrack","streams","transceiver","targetStream","transceivers","tran","MediaStream","defaults","EventEmitter","RTCPeerConnection","googDscp","customMethods","methods","bind","dtlsRole","iceLoop","properties","Reflect","peerProxies","_methods","_properties","remoteDescription","addIceCandidate","addTransceiver","preventDtlsRoleChange","removeTrickleIce","changeMediaDirection","ENDPOINT","_handlers","getTransceivers","currentDirection","localDesc","senderTracks","getSenders","_addIceCandidate","_addTransceiver","_close","_createAnswer","_createOffer","_findReusableTransceiver","_getState","_getTransceivers","_removeTrack","_sendDTMF","_setLocalDescription","_setRemoteDescription","findReusableTransceiver","setRemoteDescription","targetTransceiver","insertDTMF","dtmf","dtmfSender","ontonechange","senders","desc","dtlsMatch","isStarted","isIceCollectionCheckOngoing","_iceCollectionScheduledCheck","localRole","_localDescription","_localTracks","_remoteDescription","_remoteTracksActive","_senderTracks","remoteTracksAll","active","getReceivers","proxyBase","timerPrototype","_startTime","INACTIVE","SEND_ONLY","RECV_ONLY","SEND_RECV","ICE_GATHERING_STATE_CHANGE","NEW_CANDIDATE","SCHEDULED","Renderer","deviceManager","DeviceManager","TrackManager","mediaManager","MediaManager","peerManager","PeerManager","SessionManager","WebRTCManager","Track","Media","Peer","sdpPipeline","navigator","window","_Peer","_peerManager","_deviceManager","_webrtcManager","_renderer","isListening","recentDeviceChange","enumerateDevices","device","WEBRTC_DEVICE_KINDS","addEventListener","flag","getUserMedia","mediaStream","browserConstraintsWorkaround","deviceId","setupMedia","wrappedTrack","addTrack","findTrack","getTrack","constraintsWorkaround","getDisplayMedia","peers","element","document","querySelector","rendererId","makeSafeForCSS","createElement","height","width","srcObject","src","createObjectURL","autoplay","playsInline","play","setSinkId","appendChild","removeChild","Session","mediaConstrants","addNewMedia","isLocalTrack","targetTrack","setStream","setType","setIsLocal","setIsDetached","RTCRtpSender","setPeerProxies","nativeStream","streamTrack","removedTrack","peerId","dtlsRoleRecord","latestRemoteDescription","recordNewDtlsRole","remoteSdpSessionId","getAllLocalTracks","getRemoteTracks","addTrackOrReuseTransceiverPromises","reusableTransceiver","getHandlers","run","setParameters","promises","setNetworkPriority","networkPriority","parameters","getParameters","encodings","encoding","setTransceiverDirection","previousDtlsRole","setupPeerEventHandlers","targetPeer","ICE_COLLECTION_CHECK_REASONS","unfixedDebounce","leading","warmup","generateAnswer","oldPeer","newPeer","oldLocalTrack","DTMFOptions","sendOptions","mids","remoteTrackIds","isReady","playIfReady","endOriginalTrack","onended","Event","currentTrackId","Audio","volume","createMediaElementSource","oncanplaythrough","onplay","mediaProm","screenProm","newErr","getType","_transceiverUtils","_extractors","_debounce2","convert","fixed","mediaTrack","isDetatchedTrack","isNative","trigger","onmute","onunmute","streamId","label","getConstraints","setConstraints","constr","newStream","isValid","MEDIA_DIR","groups","iceOptions","defaultHandlers","createPipeline","targetDirection","_values2","setDirection","adapter","_adapter","objects","_mergeAllWith2","leftValue","rightValue","paramParser","_queryString","freeGlobal","g","global","InvalidCharacterError","TABLE","REGEX_SPACE_CHARACTERS","buffer","padding","output","position","charCodeAt","bitStorage","bitCounter","fromCharCode","DELIMITER","FUNCTION_TYPE","STRING_TYPE","GLOBAL_NAME","PROVIDER_SUFFIX","getNested","getNestedBottle","nested","pop","getNestedService","fullname","getWithGlobal","collection","__global__","createProvider","Provider","providerName","decorators","configurable","enumerable","provider","$get","descriptor","writable","defineProperties","providerMap","originalProviders","Factory","createService","Service","isClass","deps","serviceFactory","defineValue","setValueObject","nestedContainer","defineConstant","byMethod","bottles","register","Obj","$value","$type","$name","$inject","removeProviderMap","$decorator","$register","$list","digest","resetProviders","names","tempProviders","shouldFilter","originalProviderName","factoryService","wrapAnsi16","wrapAnsi256","wrapAnsi16m","rgb","ansi2ansi","rgb2rgb","setLazyProperty","object","property","colorConvert","makeDynamicStyles","wrap","targetSpace","isBackground","styles","sourceSpace","suite","codes","modifier","reset","bold","dim","italic","underline","inverse","hidden","strikethrough","color","black","red","green","yellow","blue","magenta","cyan","white","blackBright","redBright","greenBright","yellowBright","blueBright","magentaBright","cyanBright","whiteBright","bgColor","bgBlack","bgRed","bgGreen","bgYellow","bgBlue","bgMagenta","bgCyan","bgWhite","bgBlackBright","bgRedBright","bgGreenBright","bgYellowBright","bgBlueBright","bgMagentaBright","bgCyanBright","bgWhiteBright","gray","bgGray","grey","bgGrey","groupName","styleName","open","cssKeywords","reverseKeywords","channels","labels","hsl","hsv","hwb","cmyk","xyz","lab","lch","hex","keyword","ansi16","ansi256","hcg","apple","model","delta","h","s","l","rdif","gdif","bdif","v","diffc","w","k","reversed","currentClosestKeyword","currentClosestDistance","Infinity","distance","y","z","t2","t3","t1","smin","lmin","hi","f","p","q","vmin","sl","wh","bl","ratio","y2","x2","z2","atan2","PI","sqrt","hr","cos","sin","saturation","round","ansi","mult","rem","colorString","char","integer","chroma","grayscale","hue","pure","mg","conversions","route","fromModel","routes","toModel","wrappedFn","arg0","len","conversion","wrapRounded","raw","wrapRaw","link","wrapConversion","graph","parent","unshift","buildGraph","adjacents","adjacent","node","deriveBFS","stdout","stderr","ansiStyles","stdoutColor","stderrColor","stringReplaceAll","stringEncaseCRLFWithFirstIndex","levelMapping","ChalkClass","chalkFactory","chalk","isInteger","colorLevel","applyOptions","template","arguments_","chalkTag","setPrototypeOf","Chalk","Instance","builder","createBuilder","createStyler","_styler","_isEmpty","visible","usedModels","styler","proto","_generator","openAll","closeAll","applyStyle","lfIndex","strings","firstString","supportsColor","TEMPLATE_REGEX","STYLE_REGEX","STRING_REGEX","ESCAPE_REGEX","ESCAPES","unescape","bracket","fromCodePoint","parseArguments","chunks","chunk","number","isNaN","escape","character","parseStyle","lastIndex","exec","buildStyle","layer","temporary","escapeCharacter","replacer","substringLength","endIndex","postfix","gotCR","singleMatcher","RegExp","multiMatcher","decodeComponents","decodeURIComponent","left","right","decode","tokens","encodedURI","TypeError","replaceMap","customDecodeURIComponent","ret","isArr","condition","format","d","argIndex","framesToPop","arity","curried","DataView","getNative","hashClear","hashDelete","hashGet","hashHas","hashSet","Hash","baseCreate","baseLodash","LazyWrapper","__wrapped__","__actions__","__dir__","__filtered__","__iteratees__","__takeCount__","__views__","listCacheClear","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","ListCache","LodashWrapper","chainAll","__chain__","__index__","__values__","mapCacheClear","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","MapCache","setCacheAdd","setCacheHas","SetCache","__data__","stackClear","stackDelete","stackGet","stackHas","stackSet","Stack","size","Uint8Array","iteratee","resIndex","baseIndexOf","comparator","baseTimes","isArguments","isBuffer","isIndex","isTypedArray","inherited","isArg","isBuff","isType","skipIndexes","baseAssignValue","eq","objValue","copyObject","keysIn","arrayEach","assignValue","baseAssign","baseAssignIn","cloneBuffer","copyArray","copySymbols","copySymbolsIn","getAllKeys","getAllKeysIn","getTag","initCloneArray","initCloneByTag","initCloneObject","isMap","isObject","isSet","argsTag","funcTag","objectTag","cloneableTags","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","tag","isFunc","stacked","subValue","props","objectCreate","arrayIncludes","arrayIncludesWith","arrayMap","baseUnary","cacheHas","isCommon","valuesLength","outer","computed","valuesIndex","baseForOwn","baseEach","createBaseEach","fromIndex","fromRight","arrayPush","isFlattenable","baseFlatten","depth","isStrict","baseFor","createBaseFor","castPath","toKey","keysFunc","symbolsFunc","getRawTag","objectToString","symToStringTag","toStringTag","baseFindIndex","baseIsNaN","strictIndexOf","baseGetTag","isObjectLike","baseIsEqualDeep","baseIsEqual","other","equalArrays","equalByTag","equalObjects","arrayTag","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","matchData","noCustomizer","srcValue","COMPARE_PARTIAL_FLAG","isFunction","isMasked","toSource","reIsHostCtor","funcProto","Function","objectProto","funcToString","reIsNative","isLength","typedArrayTags","baseMatches","baseMatchesProperty","isPrototype","nativeKeys","nativeKeysIn","isProto","isArrayLike","baseIsMatch","getMatchData","matchesStrictComparable","hasIn","isKey","isStrictComparable","assignMergeValue","baseMergeDeep","safeGet","baseMerge","srcIndex","newValue","cloneTypedArray","isArrayLikeObject","isPlainObject","toPlainObject","mergeFunc","isTyped","baseGet","baseIteratee","baseMap","baseSortBy","compareMultiple","iteratees","orders","baseUnset","indexes","overRest","setToString","metaMap","baseSetData","baseSetToString","comparer","sort","isSymbol","symbolProto","symbolToString","baseToString","trimmedEndIndex","reTrimStart","createSet","setToArray","seen","seenIndex","last","baseSet","updater","cache","stringToPath","baseSlice","strSymbols","chrSymbols","arrayBuffer","byteLength","freeExports","nodeType","freeModule","Buffer","allocUnsafe","copy","cloneArrayBuffer","dataView","byteOffset","reFlags","regexp","symbolValueOf","valueOf","symbol","typedArray","valIsDefined","valIsNull","valIsReflexive","valIsSymbol","othIsDefined","othIsNull","othIsReflexive","othIsSymbol","compareAscending","objCriteria","othCriteria","ordersLength","nativeMax","partials","holders","isCurried","argsIndex","argsLength","holdersLength","leftIndex","leftLength","rangeLength","isUncurried","holdersIndex","rightIndex","rightLength","isNew","getSymbols","getSymbolsIn","coreJsData","placeholder","baseRest","isIterateeCall","assigner","sources","guard","eachFunc","iterable","createCtor","isBind","Ctor","wrapper","thisBinding","createHybrid","createRecurry","getHolder","replaceHolders","findIndexFunc","flatRest","getFuncName","isLaziable","funcs","prereq","thru","funcName","plant","composeArgs","composeArgsRight","countHolders","reorder","partialsRight","holdersRight","argPos","ary","isAry","isBindKey","isFlip","holdersCount","newHolders","baseToNumber","operator","defaultValue","setData","setWrapToString","wrapFunc","isCurry","newData","createBind","createCurry","createPartial","mergeData","toInteger","customDefaultsMerge","arraySome","isPartial","arrLength","othLength","arrStacked","othStacked","arrValue","othValue","compared","othIndex","mapToArray","objProps","objLength","objStacked","skipCtor","objCtor","othCtor","flatten","baseGetAllKeys","realNames","otherFunc","isKeyable","baseIsNative","getValue","getPrototype","overArg","getPrototypeOf","nativeObjectToString","isOwn","unmasked","arrayFilter","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","mapTag","promiseTag","setTag","weakMapTag","dataViewTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","ArrayBuffer","ctorString","reWrapDetails","reSplitDetails","hasFunc","reHasUnicode","nativeCreate","cloneDataView","cloneRegExp","cloneSymbol","reWrapComment","spreadableSymbol","isConcatSpreadable","reIsUint","reIsDeepProp","reIsPlainProp","lodash","uid","maskSrcKey","IE_PROTO","assocIndexOf","getMapData","memoize","PLACEHOLDER","nativeMin","srcBitmask","newBitmask","isCombo","freeProcess","nodeUtil","binding","transform","otherArgs","oldArray","freeSelf","shortOut","getWrapDetails","insertWrapDetails","updateWrapDetails","reference","nativeNow","lastCalled","stamp","remaining","pairs","LARGE_ARRAY_SIZE","asciiToArray","hasUnicode","unicodeToArray","memoizeCapped","rePropName","reEscapeChar","quote","subString","reWhitespace","rsAstralRange","rsAstral","rsCombo","rsFitz","rsNonAstral","rsRegional","rsSurrPair","reOptMod","rsModifier","rsOptVar","rsSeq","rsSymbol","reUnicode","wrapFlags","pair","clone","createMathOperation","augend","addend","createWrap","CLONE_DEEP_FLAG","curry","toNumber","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","maxing","trailing","invokeFunc","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","cancel","flush","propsIndex","propsLength","mergeWith","defaultsDeep","baseDifference","difference","createFind","flowRight","mapping","fallbackHolder","baseAry","cloneArray","wrapImmutable","cloner","baseConvert","util","isLib","isObj","cap","immutable","rearg","defaultHolder","forceCurry","forceFixed","forceRearg","pristine","runInContext","helpers","isError","isWeakMap","toPath","each","aryMethodKeys","aryMethod","wrappers","castArray","mixin","nthArg","castFixed","skipFixed","methodSpread","flatSpread","castRearg","skipRearg","methodRearg","aryRearg","cloneByPath","createConverter","realName","aliasToReal","methodName","remap","oldOptions","newUtil","newFunc","newOptions","wrapped","mutate","createCloner","aryKey","otherName","afterRearg","castCurry","iterateeRearg","baseArity","iterateeAry","castCap","_","realToAlias","baseHas","hasPath","baseHasIn","isString","baseIsArguments","stubFalse","baseKeys","baseIsMap","nodeIsMap","objectCtorString","baseIsSet","nodeIsSet","baseIsTypedArray","nodeIsTypedArray","nativeJoin","separator","arrayLikeKeys","baseKeysIn","resolver","memoized","Cache","merge","createAssigner","customOmitClone","omit","paths","partial","baseProperty","basePropertyDeep","basePullAt","nativeReverse","baseOrderBy","sortBy","toFinite","remainder","baseTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","castSlice","charsEndIndex","stringToArray","chars","charsStartIndex","baseUniq","union","arrays","unionBy","unionWith","baseUpdate","castFunction","baseValues","without","wrapperClone","strictUriEncode","decodeComponent","splitOnFirst","filterObject","encodeFragmentIdentifier","validateArrayFormatSeparator","keysSorter","removeHash","hashStart","extract","queryStart","parseValue","parseNumbers","parseBooleans","arrayFormat","arrayFormatSeparator","formatter","accumulator","isEncodedArray","arrayValue","parserForArrayFormat","skipNull","skipEmptyString","keyValueSep","encoderForArrayFormat","objectCopy","parseUrl","url_","hash","parseFragmentIdentifier","fragmentIdentifier","stringifyUrl","queryFromUrl","parsedQueryFromUrl","getHash","pick","exclude","exclusionFilter","DEFAULT_NAMESPACE","ACTION_TYPE_DELIMITER","isValidActionType","actionsTypes","isEmpty","combinedActionType","createAction","payloadCreator","metaCreator","isNull","finalPayloadCreator","head","hasMeta","typeString","partialObject","ownKeys","getOwnPropertyNames","_temp","partialFlatMap","partialFlatActionType","_ref$namespace","namespace","nextNamespace","connectPrefix","connectNamespace","mapValue","flattenWhenNode","unflattenActionCreators","flatActionCreators","unflatten","flatActionType","partialNestedActionCreators","partialFlatActionTypePath","camelCase","nestedActionCreators","unprefixedType","_objectSpread","sym","_defineProperty","createActions","identityActions","getLastElement","actionCreatorsFromIdentityActions","actionMapToActionCreators","flattenActionMap","actionCreatorsFromActionMap","arrayToObject","partialActionCreators","_objectSpread2","actionMapValue","isNil","_actionMapValue$","isValidActionMapValue","prefixedType","actionCreators","partialActionMap","_objectSpread3","_objectSpread4","handleAction","defaultState","isUndefined","aReducer","nextReducer","throwReducer","initialState","prevStateIsUndefined","valueIsUndefined","hasOnlyInterfaceNames","ownKey","flattenedReducerMap","flattenReducerMap","compose","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","devToolsEnhancer","__REDUX_DEVTOOLS_EXTENSION__","super_","o","N","prefilter","normalize","lhs","rhs","S","F","P","started","startedTime","D","E","title","A","O","C","L","T","M","stateTransformer","errorTransformer","logErrors","diffPredicate","performance","iterator","DeepDiff","observableDiff","applyDiff","applyChange","revertChange","isConflict","noConflict","_typeof","_toPropertyKey","hint","prim","toPrimitive","getOwnPropertyDescriptors","formatProdErrorMessage","$$observable","observable","randomString","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","preloadedState","enhancer","currentReducer","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","isSubscribed","listeners","outerSubscribe","observer","observeState","legacy_createStore","reducerKeys","finalReducers","shapeAssertionError","finalReducerKeys","assertReducerShape","hasChanged","_i","previousStateForKey","nextStateForKey","bindActionCreator","bindActionCreators","boundActionCreators","_dispatch","middlewareAPI","grammar","reg","rate","subtype","sessionConfig","str","raddr","tcptype","generation","maxMessageSize","dir2","clksrcExt","mediaClockValue","rateNumerator","rateDenominator","parser","writer","parseParams","parseFmtpConfig","parsePayloads","parseRemoteCandidates","parseImageAttributes","parseSimulcastStreamList","toIntIfInt","parseReg","location","needsBlank","keyLocation","rawName","attachProperties","validLine","paramReducer","expr","ip","scid","paused","formatRegExp","formatStr","makeLine","defaultOuterOrder","defaultInnerOrder","opts","outerOrder","innerOrder","el","separatorIndex","space","letter","hasSpace","hasSeparator","separatorSplitter","unseparate","hasCamel","camelSplitter","uppers","uncamelize","clean","byteArray","byteCount","byteIndex","stringFromCharCode","ucs2decode","extra","counter","checkScalarValue","codePoint","createByte","encodeCodePoint","readContinuationByte","continuationByte","decodeSymbol","byte1","codePoints","byteString","tmp","ucs2encode","_nil","_parse","_stringify","_v","_v2","_v3","_v4","getOutputLength","inputLength8","safeAdd","lsw","md5cmn","cnt","md5ff","md5gg","md5hh","md5ii","bytes","msg","length32","hexTab","md5ToHexEncodedArray","olda","oldb","oldc","oldd","wordsToMd5","length8","Uint32Array","bytesToWords","_default","randomUUID","uuid","getRandomValues","rnds8","ROTL","K","H","ceil","W","unsafeStringify","byteToHex","_rng","_nodeId","_clockseq","_lastMSecs","_lastNSecs","buf","clockseq","seedBytes","rng","msecs","nsecs","dt","tl","tmh","_md","DNS","hashfunc","generateUUID","_namespace","stringToBytes","_native","rnds","_sha","_regex","Rule","modifiers","pickFn","variant","testAux","nextFn","perform","testAsyncAux","performAsync","_test","ex","ex$1","_check","it","_testAsync","this$1","valid","Modifier","ValidationError","captureStackTrace","Context","nextRuleModifiers","executeAsyncRules","rules","_applyRule","ruleFn","_applyModifier","simple","_clone","check","testAsync","consideredEmpty","considerTrimmedEmptyString","proxyContext","proxylessContext","customRules","newContext","availableModifiers","availableRules","addRuleSet","ruleSet","targetContext","contextWithAvailableRules","contextWithAllRules","newRules","clearCustomRules","not","isSchemaRule","equal","expected","allowInfinite","isFinite","isIntegerPolyfill","numeric","parseFloat","testType","null","instanceOf","lowercase","uppercase","vowel","consonant","first","empty","minLength","negative","between","range","lessThan","lessThanOrEqual","greaterThan","even","odd","causes","nestedValidation","testSchema","validations","validation","typeColors","modified","indent","newLine","printVar","variable","keyChanged","line","indentSubItem","keyRemoved","keyAdded","diffInternal","itemDiff","subOutput","rightObj","addedKeys","combinedOptions","adapterFactory","shimChrome","shimFirefox","shimSafari","logging","detectBrowser","commonShim","extractVersion","disableLog","disableWarnings","chromeShim","shimPeerConnection","browserShim","shimAddIceCandidateNullOrEmpty","shimParameterlessSetLocalDescription","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimRTCIceCandidateRelayProtocol","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeExtmapAllowMixed","firefoxShim","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","shimAddTransceiver","shimGetParameters","shimCreateOffer","shimCreateAnswer","safariShim","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","shimAudioContext","nodeInterop","cacheBabelInterop","cacheNodeInterop","newObj","hasPropertyDescriptor","wrapPeerConnectionEvent","pc","shimAddTrackRemoveTrackWithNative","origGetLocalStreams","getLocalStreams","_this11","nativeStreams","_reverseStreams","origAddStream","addStream","_this12","_streams","DOMException","origRemoveStream","removeStream","_this13","oldStream","dispatchEvent","nativeMethod","methodObj","_this14","replaceInternalStreamId","origSetLocalDescription","internalId","externalStream","internalStream","RTCSessionDescription","origLocalDescription","_this15","_pc","streamid","_getdisplaymedia","shimGetDisplayMedia","shimSenderWithDtmf","_dtmf","createDTMFSender","_senders","origAddTrack","origRemoveTrack","idx","_this2","_this3","origGetSenders","_this4","origGetStats","_this5","_arguments","onSucc","onErr","fixChromeStats_","standardReport","standardStats","localcandidate","remotecandidate","makeMapStats","stats","_getusermedia","webkitMediaStream","_ontrack","removeEventListener","origSetRemoteDescription","_this","_ontrackpoly","te","webkitRTCPeerConnection","RTCIceCandidate","RTCRtpReceiver","_this6","filterStats","origGetReceivers","_this7","receivers","srcElement","MediaStreamTrack","_toPrimitive","_this8","_shimmedLocalStreams","_this9","existingSenders","newSenders","newSender","_this10","getSourceId","sourceId","widthSpecified","heightSpecified","frameRateSpecified","frameRate","mandatory","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","constraintsToChrome_","cc","ideal","oldname_","oc","mix","advanced","shimConstraints_","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","dev","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraintName","onSuccess","onError","webkitGetUserMedia","origGetUserMedia","cs","getVideoTracks","nativeSRD","nativeAddIceCandidate","completed","checking","_onconnectionstatechange","cb","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","_sctp","sections","splitSections","mediaSection","parseMLine","sctpInDescription","isFirefox","getRemoteFirefoxVersion","canSendMMS","remoteIsFirefox","canSendMaxMessageSize","remoteMMS","matchPrefix","getMaxMessageSize","POSITIVE_INFINITY","sctp","nativeSetLocalDescription","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","parseCandidate","toJSON","sdpMLineIndex","usernameFragment","relayProtocol","priority","origCreateDataChannel","createDataChannel","dataChannel","wrapDcSend","dc","origDataChannelSend","origAddTransceiver","setParametersPromises","sendEncodings","shouldPerformCheck","_arrayLikeToArray","_arrayWithoutHoles","_iterableToArray","minLen","_unsupportedIterableToArray","_nonIterableSpread","encodingParam","rid","scaleResolutionDownBy","RangeError","maxFramerate","origCreateAnswer","_arguments3","origCreateOffer","_arguments2","origGetParameters","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","DataChannel","RTCDataChannel","deprecated","arr2","preferredMediaSource","mediaSource","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","webkitAudioContext","successCallback","failureCallback","withCallback","shimConstraints","offerOptions","offerToReceiveAudio","audioTransceiver","offerToReceiveVideo","videoTransceiver","_getUserMedia","errcb","_localStreams","_addTrack","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","compactObject","isEmptyObject","oldMethod","newMethod","deprecationWarnings_","userAgent","mozGetUserMedia","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","bool","logDisabled_","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","walkStats","eventNameToWrap","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","handleEvent","_eventMap","nativeRemoveEventListener","unwrappedCb","uastring","pos","resultSet","SDPUtils","localCName","generateIdentifier","splitLines","getDescription","getMediaSections","foundation","relatedAddress","relatedPort","tcpType","ufrag","writeCandidate","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","numChannels","writeRtpMap","pt","preferredPayloadType","parseExtmap","uri","attributes","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","colon","parseSsrcGroup","semantics","getMid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","cryptoSuite","keyParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","writeIceParameters","iceLite","parseRtpParameters","headerExtensions","fecMechanisms","rtcp","mline","profile","rtpmapline","fmtps","wildcardRtcpFb","existingFeedback","writeRtpDescription","caps","maxptime","extension","parseRtpEncodingParameters","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","apt","encParam","codecPayloadType","rtx","fec","mechanism","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","cname","rsize","reducedSize","compound","mux","writeRtcpParameters","parseMsid","spec","planB","msidParts","parseSctpDescription","maxSizeLine","sctpPort","fmt","sctpMapLines","writeSctpDescription","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","getDirection","getKind","isRejected","parseOLine","sessionVersion","netType","addressType","isValidSDP","isCallable","tryToString","$TypeError","argument","isPossiblePrototype","$String","wellKnownSymbol","UNSCOPABLES","ArrayPrototype","toIndexedObject","toAbsoluteIndex","lengthOfArrayLike","createMethod","IS_INCLUDES","$this","DESCRIPTORS","SILENT_ON_NON_WRITABLE_LENGTH_SET","uncurryThis","stringSlice","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","$Object","CORRECT_ARGUMENTS","tryGet","hasOwn","getOwnPropertyDescriptorModule","definePropertyModule","exceptions","createPropertyDescriptor","bitmap","makeBuiltIn","getter","setter","defineGlobalProperty","unsafe","nonConfigurable","nonWritable","globalThis","fails","EXISTS","Deno","versions","v8","$Error","TEST","V8_OR_CHAKRA_STACK_ENTRY","IS_V8_OR_CHAKRA_STACK","dropEntries","prepareStackTrace","createNonEnumerableProperty","clearErrorStack","ERROR_STACK_INSTALLABLE","defineBuiltIn","copyConstructorProperties","isForced","targetProperty","sourceProperty","TARGET","GLOBAL","STATIC","dontCallGetSet","forced","sham","NATIVE_BIND","FunctionPrototype","getDescriptor","PROPER","CONFIGURABLE","aCallable","uncurryThisWithBind","isNullOrUndefined","V","anObject","toIntegerOrInfinity","getIteratorDirect","INVALID_SIZE","$RangeError","SetRecord","intSize","getIterator","numSize","toObject","getBuiltIn","classof","dummy","Wrapper","NewTarget","NewTargetPrototype","functionToString","inspectSource","NATIVE_WEAK_MAP","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","metadata","facade","STATE","enforce","getterFor","TYPE","documentAll","replacement","feature","detection","POLYFILL","NATIVE","isPrototypeOf","USE_SYMBOL_AS_UID","$Symbol","record","ITERATOR_INSTEAD_OF_RECORD","getMethod","innerResult","innerError","toLength","CONFIGURABLE_FUNCTION_NAME","InternalStateModule","enforceInternalState","getInternalState","CONFIGURABLE_LENGTH","TEMPLATE","trunc","$default","activeXDocument","definePropertiesModule","enumBugKeys","html","documentCreateElement","PROTOTYPE","SCRIPT","EmptyConstructor","scriptTag","LT","NullProtoObjectViaActiveX","temp","parentWindow","NullProtoObject","ActiveXObject","iframeDocument","iframe","JS","display","contentWindow","Properties","V8_PROTOTYPE_DEFINE_BUG","objectKeys","IE8_DOM_DEFINE","toPropertyKey","$defineProperty","$getOwnPropertyDescriptor","ENUMERABLE","WRITABLE","Attributes","propertyIsEnumerableModule","internalObjectKeys","$propertyIsEnumerable","NASHORN_BUG","uncurryThisAccessor","requireObjectCoercible","aPossiblePrototype","CORRECT_SETTER","pref","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","Target","Source","SetHelpers","iterate","aSet","getSetRecord","iterateSet","iterateSimple","otherRec","SetPrototype","iteratorClose","interruptible","createSetLike","error2","keysIter","IS_PURE","SHARED","mode","copyright","license","V8_VERSION","IndexedObject","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","NATIVE_SYMBOL","passed","required","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","proxyAccessor","inheritIfRequired","normalizeStringArgument","installErrorCause","installErrorStack","FULL_NAME","FORCED","IS_AGGREGATE_ERROR","STACK_TRACE_LIMIT","OPTIONS_POSITION","ERROR_NAME","OriginalError","OriginalErrorPrototype","BaseError","WrappedError","$","$includes","addToUnscopables","setArrayLength","doesNotExceedSafeInteger","properErrorOnNonWritableLength","argCount","wrapErrorConstructorWithCause","WEB_ASSEMBLY","WebAssembly","exportGlobalErrorCauseWrapper","exportWebAssemblyErrorCauseWrapper","real","setMethodAcceptSetLike","intersection","isDisjointFrom","isSubsetOf","isSupersetOf","symmetricDifference","validateArgumentsLength","$URLSearchParams","URLSearchParamsPrototype","append","$delete","dindex","found","entriesLength","$has","defineBuiltInAccessor","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","definition","nmd","children"],"sourceRoot":""}