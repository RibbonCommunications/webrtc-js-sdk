/*! For license information please see webrtc.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.WebRTC=t():e.WebRTC=t()}(self,()=>(()=>{var e={30:(e,t,n)=>{"use strict";var r=n(96893),o=n(23315),a=n(64466),i=n(3770),s=n(10380),c=n(57137);t.f=r&&!o?Object.defineProperties:function(e,t){i(e);for(var n,r=s(t),o=c(t),l=o.length,u=0;l>u;)a.f(e,n=o[u++],r[n]);return e}},35:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.turnActions=t.callActions=void 0;var r=a(n(50527)),o=a(n(7604));function a(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(a=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}t.callActions=r,t.turnActions=o},53:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mwiUpdate=function(e){let{mwiData:t,error:n}=e;return n?{type:r.MWI_UPDATE,payload:n,error:!0}:{type:r.MWI_UPDATE,payload:{...t}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(41181))},195:(e,t,n)=>{var r=n(84882),o=n(98121),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},325:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"notification",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"pushRegistration",{enumerable:!0,get:function(){return o.default}});var r=a(n(33789)),o=a(n(50539));function a(e){return e&&e.__esModule?e:{default:e}}},350:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,CallstackWebrtc:s,logManager:c}=e;return async function(e){const l=(0,i.getCallByWrtcsSessionId)(t.getState(),e),u=c.getLogger("CALL",(l||{}).id);u.info("Received call cancelled notice; handling.",{wrtcsSessionId:e}),l?[o.CALL_STATES.ENDED,o.CALL_STATES.CANCELLED].includes(l.state)?u.info(`Call cancelled notice for already ${l.state} call. Ignoring.`,{wrtcsSessionId:e}):(await s.closeCall(l.webrtcSessionId),u.info(`Finished handling call cancelled notice. Changing to ${o.CALL_STATES.CANCELLED}.`),t.dispatch(a.callActions.callCancelled(l.id)),n(r.CALL_STATE_CHANGE,{callId:l.id,previous:{state:l.state,localHold:l.localHold,remoteHold:l.remoteHold}})):u.info("Call cancelled notice for unknown wrtcsSession. Ignoring.",{wrtcsSessionId:e})}},n(62234);var r=n(51918),o=n(77126),a=n(35),i=n(40481)},528:(e,t,n)=>{var r=n(39747),o=n(75962);function a(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}a.prototype=r(o.prototype),a.prototype.constructor=a,e.exports=a},679:(e,t,n)=>{"use strict";var r=n(33243),o=n(29800),a=r.Set,i=r.add;e.exports=function(e){var t=new a;return o(e,function(e){i(t,e)}),t}},864:(e,t,n)=>{var r=n(58638),o=n(41439)(function(e,t){return r(e,256,void 0,void 0,void 0,t)});e.exports=o},923:(e,t,n)=>{var r=n(9323),o=/%[sdv%]/g,a=function(e){var t=1,n=arguments,r=n.length;return e.replace(o,function(e){if(t>=r)return e;var o=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(o);case"%d":return Number(o);case"%v":return""}})},i=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var i=t.names[o];t.name?r.push(n[t.name][i]):r.push(n[t.names[o]])}else r.push(n[t.name]);return a.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,o=t.innerOrder||c,a=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?a.push(i(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){a.push(i(t,n,e))})})}),e.media.forEach(function(e){a.push(i("m",r.m[0],e)),o.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?a.push(i(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){a.push(i(t,n,e))})})})}),a.join("\r\n")+"\r\n"}},1011:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=function(e){return new Promise(t=>setTimeout(t,e))},t.logCssSelector=function(e){return(0,r.default)(e)?e.id:e},t.normalizeServices=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>(0,o.default)(e)&&e.hasOwnProperty("service")?e:{service:e})},n(81045),n(84915);var r=a(n(22202)),o=a(n(36705));function a(e){return e&&e.__esModule?e:{default:e}}},1036:(e,t,n)=>{var r=n(92673)("defaultsDeep",n(69383));r.placeholder=n(22991),e.exports=r},1140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,r.checkHandler)(e),(0,r.checkHandler)(t);const n={};return{time:function(r){const o=Date.now(),a={event:"time",name:r};n.hasOwnProperty(r)?(a.start=n[r],t(`Timer ${r} already started.`,a)):(n[r]=o,a.start=o,e(`Timer ${r} started.`,a))},timeEnd:function(r){const o=Date.now(),a={event:"timeEnd",name:r,start:n[r]};if(n.hasOwnProperty(r)){const t=n[r];delete n[r];const i=o-t;a.end=o,a.elapsed=i,e(`Timer ${r} ended, taking ${i}ms.`,a)}else t(`Timer ${r} has not been started.`,a)},timeLog:function(r){const o=Date.now(),a={event:"timeLog",name:r,start:n[r]};if(n.hasOwnProperty(r)){const t=o-n[r];a.split=o,a.elapsed=t,e(`Timer ${r} split, at ${t}ms so far.`,a)}else t(`Timer ${r} has not been started.`,a)}}};var r=n(87398)},1306:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s){const c=(0,o.getCallById)(e,t);if(!c)return new i.default({code:i.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."});if(c.state!==r.CALL_STATES.CONNECTED)return new i.default({code:i.callCodes.INVALID_STATE,message:`Invalid call state: ${c.state}. It should be: ${r.CALL_STATES.CONNECTED}.`});try{(0,a.validateMediaConstraints)(n)}catch(e){return e}if(n&&n.medias)try{(0,a.validateDetachedMedia)(n.medias)}catch(e){return e}return n&&n.medias&&c.localTracks.some(e=>n.medias.map(e=>e.media.tracks).reduce((e,t)=>e.concat(t),[]).includes(e))?new i.default({code:i.callCodes.INVALID_PARAM,message:"One or more of the tracks id's being added already exists on the call."}):void 0},n(62234),n(81045),n(84915),n(55367),n(9925);var r=n(77126),o=n(40481),a=n(9066),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},1386:(e,t,n)=>{var r=n(12393),o=n(62049),a=n(7144),i=n(7452),s=n(13964);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=i,c.prototype.set=s,e.exports=c},1415:(e,t,n)=>{"use strict";var r=n(5613),o=n(94361);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("isSubsetOf",function(e){return e})},{isSubsetOf:o})},1441:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.container);e.factory("Callstack.stages.iceRestart",()=>({local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,a.default)(e.container)}})),e.factory("Callstack.operations.iceRestart",()=>{const t=e.container.Callstack.models.Negotiation;return{local:function(n,r){return t.instance({type:i.OPERATIONS.MEDIA_RESTART,isLocal:!0,stages:e.container.Callstack.stages.iceRestart.local},{callId:n,deferred:r})}}})};var r=s(n(48687)),o=s(n(81275)),a=s(n(72597)),i=n(59090);function s(e){return e&&e.__esModule?e:{default:e}}},1698:()=>{},1877:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1940:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.factory("SipEventsOperations",a.default),e.factory("SipEventsRequests",i.default),e.factory("SipEventsIntervals",s.default),e.defer(e=>{e.Notifications.takeEveryAction(function(e){return e.type===c.NOTIFICATION_RECEIVED&&e.payload.notificationMessage.hasOwnProperty("genericNotificationParams")},t=>{e.SipEventsOperations.receiveEvent(t.payload.notificationMessage)})}),{api:o.default,capabilities:["sipEvents"],name:r.name,reducer:r.reducer}};var r=n(35916),o=l(n(56176)),a=l(n(83840)),i=l(n(34460)),s=l(n(73758));n(41753);var c=n(70506);function l(e){return e&&e.__esModule?e:{default:e}}},1942:e=>{"use strict";e.exports=!1},2178:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997)),o=n(45775);const a={};a[r.SET_BROWSER_DETAILS]={next:(e,t)=>t.payload};const i=(0,o.handleActions)(a,{});t.default=i},2195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.factory("MWIOperations",i.default),e.factory("MWIRequests",s.default),{api:o.default,capabilities:["voicemail"],middleware:a.default,name:r.name,reducer:r.reducer}};var r=n(5174),o=c(n(11918)),a=c(n(16983)),i=c(n(2225)),s=c(n(8753));function c(e){return e&&e.__esModule?e:{default:e}}n(36795)},2225:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:i,MWIRequests:s}=e,{dispatch:c}=t,l=i.getLogger("MWI");return{fetchMwi:async function(){const e=await s.fetchVoicemails();return c(r.mwiUpdate({mwiData:e})),l.info("Successfully retrieved voicemail data from server"),e},mwiReceived:function(e){const t=(0,a.processMwi)({...e,data:e.mwiNotificationParam});c(r.mwiUpdate({mwiData:t})),n(o.MWI_CHANGE,t),l.info("Successfully processed mwi notification")}}};var r=i(n(53)),o=i(n(44717)),a=n(27470);function i(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(i=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},2287:(e,t,n)=>{"use strict";var r=n(39944),o=n(14188),a=n(80831),i=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&o(n=e.toString)&&!a(s=r(n,e)))return s;if(o(n=e.valueOf)&&!a(s=r(n,e)))return s;if("string"!==t&&o(n=e.toString)&&!a(s=r(n,e)))return s;throw new i("Can't convert object to primitive value")}},2306:(e,t,n)=>{e=n.nmd(e);var r=n(74967),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,i=a&&a.exports===o&&r.process,s=function(){try{return a&&a.require&&a.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=s},2321:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,UsersOperations:a,logManager:i,API_LOG_TAG:s}=e,c=i.getLogger("USERS");return{async add(e){let t;c.debug(s+"contacts.add: ",e);try{t=await a.addContact(e)}catch(e){return void n(o.CONTACTS_ERROR,{error:e})}n(o.CONTACTS_CHANGE,{contactData:t}),n(o.CONTACTS_CHANGE,{})},get:e=>(c.debug(s+"contacts.get: ",e),(0,r.getContact)(t.getState(),e)),getAll:()=>(c.debug(s+"contacts.getAll"),(0,r.getContacts)(t.getState())),refresh(){let e;c.debug(s+"contacts.refresh");try{e=a.refreshContacts()}catch(e){return void n(o.CONTACTS_ERROR,{error:e})}n(o.CONTACTS_CHANGE,{contactData:e})},async remove(e){let t;c.debug(s+"contacts.remove: ",e);try{t=await a.removeContact(e)}catch(e){return void n(o.CONTACTS_ERROR,{error:e})}n(o.CONTACTS_CHANGE,{contactId:t})},async update(e){let t;c.debug(s+"contacts.update: ",e);try{t=await a.updateContact(e)}catch(e){return void n(o.CONTACTS_ERROR,{error:e})}n(o.CONTACTS_CHANGE,{contactData:t})},async fetch(e){let t;c.debug(s+"contacts.fetch: ",e);try{t=await a.fetchContact(e)}catch(e){return void n(o.CONTACTS_ERROR,{error:e})}n(o.CONTACTS_CHANGE,{contact:t})}}};var r=n(49639),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(62318))},2427:(e,t,n)=>{var r=function(e){return String(Number(e))===e?Number(e):e},o=function(e,t,n){var o=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:o&&!t[e.name]&&(t[e.name]={});var a=e.push?{}:o?t[e.name]:t;!function(e,t,n,o){if(o&&!n)t[o]=r(e[1]);else for(var a=0;a<n.length;a+=1)null!=e[a+1]&&(t[n[a]]=r(e[a+1]))}(n.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)},a=n(9323),i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var c=a[t][s];if(c.reg.test(i))return o(c,r,i)}}),t.media=n,t};var s=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),o=0;o<n.length;o+=3)t.push({component:n[o],ip:n[o+1],port:n[o+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}},2478:(e,t,n)=>{var r=n(37250),o=n(69454),a=n(97706);e.exports=function(e,t,n){return t==t?a(e,t,n):r(e,o,n)}},2549:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(88398)),o=a(n(72079));function a(e){return e&&e.__esModule?e:{default:e}}t.name="users"},2556:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMwi=function(e){return(0,o.default)(e.mwi)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},2633:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).length>0?"?"+o.default.stringify(e,t):""};var r,o=(r=n(68032))&&r.__esModule?r:{default:r}},2748:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.MessagingOperations;return e=>n=>(n.type===r.NOTIFICATION_RECEIVED&&n.payload.notificationMessage&&"IM"===n.payload.notificationMessage.eventType&&t.messageReceived(n),e(n))};var r=n(70506)},2852:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(79317)),o=i(n(64584)),a=i(n(49759));function i(e){return e&&e.__esModule?e:{default:e}}t.default={name:r.default,api:o.default,reducer:a.default}},2893:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t){return o(e,t)}},t.signalling=o;var r=n(40481);async function o(e,t){const{context:n,CallRequests:o,logManager:a}=e,i=t[0].id,s=t[1].id,c=a.getLogger("CALL",i);c.info("Performing consultative transfer on call.");const l=(0,r.getCallById)(n.getState(),i),u=(0,r.getCallById)(n.getState(),s),d={id:i,wrtcsSessionId:l.wrtcsSessionId,otherWrtcsSessionId:u.wrtcsSessionId,destination:"outgoing"===u.direction?u.to:u.from};try{await o.consultativeTransferSessions(d)}catch(e){throw c.info("Failed to consultative transfer call."),e}c.info("Finished local portion of consultative transfer. Waiting on remote response.")}},2988:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,iceTimer:n,log:o}=this;return t.onicegatheringstatechange=t=>{const a=t.target.iceGatheringState;o.debug(`Peer iceGatheringState changed to ${a}.`),a===r.PEER.ICE_GATHERING_STATE.GATHERING?n.start():a===r.PEER.ICE_GATHERING_STATE.COMPLETE&&(o.debug(`Peer took ${n.timeFromStart()}ms to collect ICE candidates.`),n.stop()),e(t)},!0};var r=n(54507)},2989:(e,t,n)=>{"use strict";var r=n(5613),o=n(39944),a=n(38873),i=n(44977),s=n(3770),c=n(96002),l=n(88500),u=n(20850)("every",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(e){s(this);try{i(e)}catch(e){l(this,"throw",e)}if(u)return o(u,this,e);var t=c(this),n=0;return!a(t,function(t,r){if(!e(t,n++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},3226:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o,u){const d={status:a.OP_STATUS.NOT_STARTED},f=e.logManager.getLogger("CALL",t),p=`${o.isLocal?"local":"remote"} ${o.type}`;return o.type===a.OPERATIONS.JOIN&&u&&u.isJoinedCall&&(d.status=a.OP_STATUS.ONGOING),d.start=()=>{if(f.info(`Operations: Starting ${p} operation. Performing local changes.`),d.status!==a.OP_STATUS.NOT_STARTED)throw f.debug(`Cannot start ${p} operation; already started.`),new Error("Operation tracking has already been started.");i(e,t,n,r,o),d.status=a.OP_STATUS.ONGOING},d.update=i=>{if(f.info(`Operations: Updating ${p} operation. Waiting on remote response.`),d.status!==a.OP_STATUS.ONGOING)throw f.debug(`Cannot update ${p} operation; already pending.`),new Error("Operation tracking cannot be updated.");s(e,t,n,r,o,i),d.status=a.OP_STATUS.PENDING},d.resume=()=>{if(f.info(`Operations: Resuming ${p} operation. Finishing negotiation.`),d.status!==a.OP_STATUS.PENDING)throw f.debug(`Cannot resume ${p} operation; not pending a remote input.`),new Error("Operation tracking cannot be resumed.");c(e,t,n,r,o),d.status=a.OP_STATUS.RESOLVING},d.finish=i=>{if(f.info(`Operations: Finishing ${p} operation as ${i?"failure":"success"}.`),![a.OP_STATUS.ONGOING,a.OP_STATUS.PENDING,a.OP_STATUS.RESOLVING].includes(d.status))throw f.debug(`Cannot finish ${p} operation; already finished.`),new Error("Operation tracking cannot be finished.");l(e,t,n,r,o,i,d.status),d.status=a.OP_STATUS.FINISHED},d},t.finishOperation=l,t.resumeOperation=c,t.startOperation=i,t.updateOperation=s,n(97107),n(62234);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090);function i(e,t,n,i,s){const{context:c,emitEvent:l}=e,{type:u,isNegotiation:d}=s;c.dispatch(r.callActions.operationUpdate(t,u,s.isLocal,{transition:a.OP_TRANSITIONS.START,eventId:i,isBlocking:d,operationId:n})),l(o.CALL_OPERATION,{callId:t,operationId:n,isLocal:s.isLocal,operation:u,transition:a.OP_TRANSITIONS.START,previous:void 0})}function s(e,t,n,i,s,c){const{context:l,emitEvent:u}=e;l.dispatch(r.callActions.operationUpdate(t,s.type,s.isLocal,{transition:a.OP_TRANSITIONS.UPDATE,operationData:c&&c.operationData?c.operationData:void 0,eventId:i,operationId:n})),u(o.CALL_OPERATION,{callId:t,operationId:n,isLocal:s.isLocal,operation:s.type,transition:a.OP_TRANSITIONS.UPDATE,previous:{operation:s.type,status:a.OP_STATUS.ONGOING}})}function c(e,t,n,i,s){const{context:c,emitEvent:l}=e;c.dispatch(r.callActions.operationUpdate(t,s.type,s.isLocal,{transition:a.OP_TRANSITIONS.RESUME,eventId:i,operationId:n})),l(o.CALL_OPERATION,{callId:t,operationId:n,isLocal:s.isLocal,operation:s.type,transition:a.OP_TRANSITIONS.RESUME,previous:{operation:s.type,status:a.OP_STATUS.PENDING}})}function l(e,t,n,i,s,c,l){const{context:u,emitEvent:d}=e;u.dispatch(r.callActions.operationUpdate(t,s.type,s.isLocal,{transition:a.OP_TRANSITIONS.FINISH,eventId:i,operationId:n})),d(o.CALL_OPERATION,{callId:t,operationId:n,isLocal:s.isLocal,operation:s.type,transition:a.OP_TRANSITIONS.FINISH,error:c,previous:{operation:s.type,status:l}})}},3283:(e,t,n)=>{var r=n(56027),o=n(80547),a=Object.prototype,i=a.hasOwnProperty,s=a.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return o(e)&&i.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},3316:e=>{var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var o=t(),a=16-(o-r);if(r=o,a>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},3326:(e,t,n)=>{var r=n(65111),o=n(69334),a=n(81586),i=n(93526),s=n(39032),c=n(29259),l=n(41439),u=n(93650),d=l(function(e,t){var n={};if(null==e)return n;var l=!1;t=r(t,function(t){return t=i(t,e),l||(l=t.length>1),t}),s(e,u(e),n),l&&(n=o(n,7,c));for(var d=t.length;d--;)a(n,t[d]);return n});e.exports=d},3334:(e,t,n)=>{var r=n(36526),o=n(12343),a=n(22053),i=n(53142),s=n(43282);e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?i(e)?o(e[0],e[1]):r(e):s(e)}},3422:(e,t,n)=>{var r=n(57073),o=n(46285),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var i=e[t];a.call(e,t)&&o(i,n)&&(void 0!==n||t in e)||r(e,t,n)}},3478:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallManager:n,Callstack:s,CallReporter:c,emitEvent:l,logManager:u,API_LOG_TAG:d}=e,f=u.getLogger("CALL");async function p(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i||f.debug(d+"call.sendRingingFeedbackAsync: ",e),t.dispatch(o.callActions.sendRingingFeedback(e));const s=(0,r.getCallById)(t.getState(),e);let c;try{await n.sendRingingFeedback(e)}catch(e){c=e}if(t.dispatch(o.callActions.sendRingingFeedbackFinish(e,{error:c})),!(!c||c&&i))throw c;l(a.CALL_STATE_CHANGE,{callId:e,previous:{state:s?s.state:void 0,localHold:s?s.localHold:void 0,remoteHold:s?s.remoteHold:void 0},error:c})}async function g(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];f.debug(d+`call.${r?"sendCustomParameters":"sendCustomParametersAsync"}: `,e),t.dispatch(o.callActions.sendCustomParameters(e));try{await n.sendCustomParameters(e),t.dispatch(o.callActions.sendCustomParametersFinish(e))}catch(n){throw t.dispatch(o.callActions.sendCustomParametersFinish(e,{error:n})),n}}async function _(e,r){let a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:70;arguments.length>4&&void 0!==arguments[4]&&arguments[4]||f.debug(d+"call.sendDTMFAsync: ",e,r,i,s),"number"==typeof r&&(r+=""),t.dispatch(o.callActions.sendDTMF(e,{tone:r,duration:i,intertoneGap:s}));try{await n.sendDtmf(e,r,{duration:i,intertoneGap:s})}catch(e){a=e}if(t.dispatch(o.callActions.sendDTMFFinish(e,{error:a})),a)throw a}return{getAll:function(){return f.debug(d+"call.getAll"),(0,r.getCalls)(t.getState())},getById:function(e){return f.debug(d+"call.getById: ",e),(0,r.getCallById)(t.getState(),e)},sendRingingFeedback:async function(e){f.debug(d+"call.sendRingingFeedback: ",e);try{await p(e,!0)}catch(e){}},sendRingingFeedbackAsync:p,setCustomParameters:async function(e,n){f.debug(d+"call.setCustomParameters: ",e,n),t.dispatch(o.callActions.setCustomParameters(e,n))},sendCustomParameters:async function(e){try{await g(e,!0)}catch{}},sendCustomParametersAsync:g,sendDTMF:async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:70;f.debug(d+"call.sendDTMF: ",e,t,n,r);try{await _(e,t,n,r,!0)}catch(e){}},sendDTMFAsync:_,getStats:async function(e,r){let i,s;f.debug(d+"call.getStats: ",e,r),t.dispatch(o.callActions.getStats(e,{trackId:r}));try{i=await n.getStats(e,r)}catch(e){throw s=e,s}finally{t.dispatch(o.callActions.getStatsFinish(e,{error:s,result:i,trackId:r})),l(a.STATS_RECEIVED,{callId:e,result:i,trackId:r,error:s})}return i},getReport:function(e){f.debug(d+"call.getReport: ",e);const t=c.getReport(e);return t?t.getSerializable():t},getAvailableCodecs:async function(e){let n;f.debug(`${d}call.getAvailableCodecs, kind: ${e}`),t.dispatch(o.callActions.getAvailableCodecs({kind:e},{promise:{}}));try{n=await s.operations.getAvailableCodecs(e),t.dispatch(o.callActions.availableCodecsRetrieved({kind:e,codecs:n})),l(a.AVAILABLE_CODECS,{kind:e,codecs:n})}catch(e){throw f.debug("Failed to retrieve codecs: ",e.message),e}return n},setSdpHandlers:function(e){f.debug(`${d}call.setSdpHandlers, sdpHandlers:`,e),t.dispatch((0,i.setSdpHandlers)(e))}}};var r=n(40481),o=n(35),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),i=n(87310)},3480:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.WebRTCLogOperations;return e=>n=>(n.type===r.LEVELS_CHANGE&&t.updateLogLevel(n),n.type===r.HANDLERS_CHANGE&&t.updateLogHandler(n),e(n))};var r=n(42791)},3514:(e,t,n)=>{var r=n(195),o=n(28486),a=n(3283),i=n(53142),s=n(36529),c=n(75853),l=n(84882),u=n(8666),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||c(e)||u(e)||a(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!r(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},3668:e=>{e.exports=function(e){return null==e}},3727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallHistoryRequests.fetchCallLogs",t=>(0,r.default)(e.container)),e.factory("CallHistoryOperations.fetch",t=>(0,o.default)(e.container))};var r=a(n(32774)),o=a(n(86462));function a(e){return e&&e.__esModule?e:{default:e}}},3766:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},3770:(e,t,n)=>{"use strict";var r=n(80831),o=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(o(e)+" is not an object")}},3816:e=>{e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},3905:(e,t,n)=>{var r=n(65111);e.exports=function(e,t){return r(t,function(t){return e[t]})}},4069:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,proxyPeer:n,log:r}=this;if(r.info(`Removing track ${e}.`),!n.senderTracks.find(t=>t.id===e))return void r.info(`Invalid track ID ${e}; no such track found.`);if(" closed"===n.signalingState)return void r.info("Peer is closed; cannot remove track.");const o=n.getSenders().filter(e=>null!==e.track).find(t=>t.track.id===e);t.removeTrack(o)},n(81045),n(30163),n(45950)},4255:(e,t,n)=>{var r=n(92673)("debounce",n(12784));r.placeholder=n(22991),e.exports=r},4282:(e,t,n)=>{"use strict";var r=n(79117),o=n(10746),a=n(74418),i=n(66209),s=n(48944),c=n(89809),l=r.Symbol,u=o("wks"),d=c?l.for||l:l&&l.withoutSetter||i;e.exports=function(e){return a(u,e)||(u[e]=s&&a(l,e)?l[e]:d("Symbol."+e)),u[e]}},4398:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,ProxyStack:r,logManager:p,TimerTracker:g}=e,_=p.getLogger("PROXY");return{setProxyMode:async function(e){const{dispatch:o,container:u}=t;_.info(`Setting proxy mode to ${e}.`),o(c.setProxyMode(e));const f=(0,a.getActiveCalls)(t.getState()),p=(0,d.getProxyState)(t.getState());if(f.length>0){_.info("Cannot change proxy mode while there are on-going calls.");const e=new i.default({code:i.proxyCodes.IN_ACTIVE_CALL,message:"Cannot change proxy mode while there are on-going calls."});throw o(c.setProxyModeFinish({error:e})),e}if(p.proxyMode===e){_.info("Proxy mode already set to provided value.");const e=new i.default({code:i.proxyCodes.INVALID_PARAM,message:"Proxy mode already set to provided value."});throw o(c.setProxyModeFinish({error:e})),e}const g={value:e};if(!await r.setProxyMode(e)){_.info(`Failed to set proxy mode to ${e}.`);const t=new i.default({code:"proxy:1",message:`Failed to set proxy mode to ${e}.`});throw g.error=t,o(c.setProxyModeFinish(g)),t}if(_.info(`Finished setting proxy mode to ${e}.`),o(c.setProxyModeFinish(g)),e&&!p.remoteInitialized)return void _.warn("Proxy mode has been enabled, but the Remote SDK has not been inititalized yet. Call functionality will fail in this state.");await u.Callstack.utils.createEarlyPeer();const E=await r.managers.devices.checkDevices();E.microphone&&E.camera&&E.speaker&&(_.debug("Updating available media devices based on proxy mode change.",E),o((0,s.devicesChanged)(E)),n(l.DEVICES_CHANGED,{}))},initializeRemote:async function(e){const{dispatch:n}=t;_.info("Initializing the Remote SDK for proxy mode."),n(c.initializeRemote(e));const o={WEBRTC:(0,u.getLevel)(t.getState(),"WEBRTC"),PROXY:(0,u.getLevel)(t.getState(),"PROXY"),CHANNEL:(0,u.getLevel)(t.getState(),"CHANNEL")},a=await r.initialize(e,o);if(a.error)throw _.info("Failed to initialize the Remote SDK."),n(c.initializeRemoteFinish({error:a.error.message})),a.error;return _.info("Finished initializing the Remote SDK."),n(c.initializeRemoteFinish({browser:a.browser})),{browser:a.browser}},setChannel:async function(n){const{dispatch:s}=t;if(_.info("Setting channel for use in proxy mode."),s(c.setChannel(n)),!n||(0,o.default)(n)){_.info("Could not set channel; Invalid input.");const e=new i.default({code:i.proxyCodes.INVALID_PARAM,message:"Could not set channel; Invalid input."});throw s(c.setChannelFinish({error:e})),e}if((0,a.getActiveCalls)(t.getState()).length>0){_.info("Cannot set channel while there are on-going calls.");const e=new i.default({code:i.proxyCodes.IN_ACTIVE_CALL,message:"Cannot set channel while there are on-going calls."});throw s(c.setChannelFinish({error:e})),e}const l={};if(!await r.setChannel(n,g)){_.info("Failed to set channel for proxy mode.");const e=new i.default({code:i.proxyCodes.SET_PROXY_CHANNEL_FAIL,message:"Failed to set proxy channel."});throw l.error=e,s(c.setChannelFinish(l)),e}return _.info("Finished setting channel for proxy mode."),function(n){const r=(0,f.createHandler)(e);n.onMessage((e,n)=>{(0,d.getProxyState)(t.getState()).proxyMode?n&&(n.action||n.event)?(_.debug(`Received event from remote webrtc stack (${n.action.type}).`),r(n.action,n.event)):_.debug(`Received unknown message type; ignoring message (${e}).`,n):_.debug(`Not in Proxy mode, ignoring previous message (${e}).`)})}(r),s(c.setChannelFinish(l)),l}}};var r,o=(r=n(3514))&&r.__esModule?r:{default:r},a=n(40481),i=p(n(75412)),s=n(93269),c=p(n(12825)),l=p(n(51709)),u=n(98530),d=n(96448),f=n(76207);function p(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(p=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},4448:(e,t,n)=>{"use strict";var r=n(5613),o=n(97528);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("isSupersetOf",function(e){return!e})},{isSupersetOf:o})},4564:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(16635))&&r.__esModule?r:{default:r};t.default=function(e){return"string"==typeof e&&o.default.test(e)}},4578:(e,t,n)=>{"use strict";var r=n(16881);e.exports=r({}.isPrototypeOf)},4899:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.consultativeTransfer",()=>{const t=e.container.Callstack.models.MultiCall;return{local:function(n,l){return t.instance({type:c.OPERATIONS.CONSULTATIVE_TRANSFER,isNegotiation:!0,stages:{validate:i.default,signalling:(0,r.default)(e.container),remoteSuccess:(0,o.default)(e.container),remoteFailure:(0,a.default)(e.container)},createFlow:s.default},{callInfo:n,deferred:l})}}})};var r=l(n(2893)),o=l(n(18666)),a=l(n(99475)),i=l(n(11257)),s=l(n(53229)),c=n(59090);function l(e){return e&&e.__esModule?e:{default:e}}},4943:(e,t,n)=>{var r=n(22053),o=n(46065),a=o?function(e,t){return o.set(e,t),e}:r;e.exports=a},4977:e=>{var t=Math.max;e.exports=function(e,n,r,o){for(var a=-1,i=e.length,s=r.length,c=-1,l=n.length,u=t(i-s,0),d=Array(l+u),f=!o;++c<l;)d[c]=n[c];for(;++a<s;)(f||a<i)&&(d[r[a]]=e[a]);for(;u--;)d[c++]=e[a++];return d}},5007:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(93117)),o=u(n(5902)),a=u(n(98953)),i=u(n(8786)),s=u(n(26662)),c=u(n(5168)),l=u(n(97002));function u(e){return e&&e.__esModule?e:{default:e}}const d=[{name:"logs",fn:a.default},{name:"config",fn:r.default},{name:"events",fn:o.default}],f=[{name:"webrtc",fn:l.default},{name:"notifications",fn:s.default},{name:"connectivity",fn:i.default},{name:"request",fn:c.default}];t.default={corePlugins:d,commonPlugins:f}},5054:(e,t,n)=>{"use strict";var r=n(71025),o=n(80831),a=n(39509),i=n(74121);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.prototype,"__proto__","set"))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return a(n),i(r),o(n)?(t?e(n,r):n.__proto__=r,n):n}}():void 0)},5075:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:t=>s(e,t),signalling:(t,n)=>c(e,t,n)}},t.localChanges=s,t.signalling=c,n(81045),n(84915),n(9925);var r=n(35),o=n(40481),a=n(37654),i=n(69260);async function s(e,t){const{context:n,CallstackWebrtc:r,logManager:a}=e,s=a.getLogger("CALL",t);s.info("Unholding call.");const c=(0,o.getCallById)(n.getState(),t),{webrtcSessionId:l}=c,u=(0,i.getSessionById)(n.getState(),l).localTracks.map(e=>(0,i.getTrackById)(n.getState(),e)),d={audio:u.some(e=>"audio"===e.kind)?"sendrecv":"recvonly",video:u.some(e=>"video"===e.kind)?"sendrecv":"recvonly"};let f;try{f=await r.generateOffer(l,d,c.bandwidth)}catch(e){throw s.debug("Invalid SDP offer or SDP offer not received."),e}return{offer:f}}async function c(e,t,n){const{context:i,CallRequests:s,Callstack:c,CallstackWebrtc:l,logManager:u}=e,{offer:d}=n,f=(0,o.getCallById)(i.getState(),t),p=u.getLogger("CALL",f.id),g={wrtcsSessionId:f.wrtcsSessionId,id:f.id,offer:d.sdp,isAnonymous:f.isAnonymous,account:f.account,customParameters:f.customParameters,customBodies:f.customBodies};try{await s.updateSession(g)}catch(e){let t;p.info("Failed to unhold call.");try{await c.utils.rollbackUnhold(f.webrtcSessionId)}catch(e){p.debug("Automatic unhold rollback failed:",e),t=e}const n=(0,a.getBrowserDetails)().browser;if(t){if("safari"===n)throw p.info("Ending call due to unrecoverable state after call unhold failure."),await l.closeCall(f.webrtcSessionId),i.dispatch(r.callActions.endCallFinish(f.id,{isLocal:!0,transition:{reasonText:"Call has ended due to call unhold failure."}})),e;p.info("Unable to reset state after unhold operation failure, future operations may not work as intended.")}throw e}p.info("Finished local portion of unholding call. Waiting on remote response.")}},5094:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{proxyPeer:t,nativePeer:n,trackManager:r,log:o}=this;return n.ontrack=async n=>{const{track:a,streams:i,transceiver:s}=n;let c;o.debug(`Peer received ${a.kind} Track ${a.id}.`),t.transceivers.find(e=>e.mid===s.mid)||t.transceivers.push(s),0===i.length?(c=await new MediaStream([a]),o.debug("New Track is not associated with remote Stream.")):(c=i[0],o.debug(`New Track is associated with remote Stream ${c.id}.`));const l=r.add(a,a.kind,c,!1);e(l)},!0},n(69375),n(81045),n(45950)},5146:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:u,CallstackWebrtc:d,CallReporter:f,WebRTC:p}=e;return async function(e,g){const _=n.getLogger("CALL",e.id),E=f.getReport(e.id),y=e.currentOperations.find(e=>e.isLocal&&e.type===a.OPERATIONS.ANSWER),S=E.getEvent(y.eventId).addEvent(c.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);S.addData("operation",c.REPORTER_OPERATION_EVENTS_MAP.ANSWER),S.addData("isSlowStart",e.isSlowStart);try{const t={sessionId:e.webrtcSessionId,answerSdp:g.sdp};await d.receivedAnswer(t,e)}catch(n){throw t.dispatch(r.callActions.endCallFinish(e.id,{error:n})),S.setError(n),S.endEvent(),n}_.info(`Finished processing remote response to local ${y.type}. Changing state based on operation.`);const v=await p.sessionManager.get(e.webrtcSessionId),h=await(0,s.getAllRemoteTracks)(v),T=(0,l.getSessionById)(t.getState(),e.webrtcSessionId).localTracks;t.dispatch(r.callActions.callAccepted(e.id,{state:i.CALL_STATES.CONNECTED,startTime:Date.now(),remoteParticipant:{displayNumber:g.remoteNumber,displayName:g.remoteName},remoteTracks:h,localTracks:T})),u(o.CALL_TRACKS_ADDED,{callId:e.id,trackIds:[...h,...T]}),u(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}),S.endEvent()}},n(81045),n(45950);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090),i=n(77126),s=n(48151),c=n(84581),l=n(69260)},5168:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=(0,r.default)(t),e.factory("sendRequest",o.default),e.defer(function(e){const{context:n}=e;n.dispatch((0,i.update)(t,a.default.name))}),{api:a.default.createAPI,capabilities:["restAuthorization"],name:a.default.name}};var r=s(n(59195)),o=s(n(87937)),a=s(n(19528));n(89077);var i=n(87310);function s(e){return e&&e.__esModule?e:{default:e}}},5174:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"api",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(11918)),o=a(n(95449));function a(e){return e&&e.__esModule?e:{default:e}}t.name="mwi"},5179:e=>{"use strict";e.exports={stringReplaceAll:(e,t,n)=>{let r=e.indexOf(t);if(-1===r)return e;const o=t.length;let a=0,i="";do{i+=e.substr(a,r-a)+t+n,a=r+o,r=e.indexOf(t,a)}while(-1!==r);return i+=e.substr(a),i},stringEncaseCRLFWithFirstIndex:(e,t,n,r)=>{let o=0,a="";do{const i="\r"===e[r-1];a+=e.substr(o,(i?r-1:r)-o)+t+(i?"\r\n":"\n")+n,o=r+1,r=e.indexOf("\n",o)}while(-1!==r);return a+=e.substr(o),a}}},5215:(e,t,n)=>{var r=n(92673)("find",n(81936));r.placeholder=n(22991),e.exports=r},5234:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},5349:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,proxyPeer:n,config:r,id:i,emitter:s,iceTimer:c,log:l}=this;if(l.info(`Setting local description ${e.type} in ${n.signalingState} state.`),!this.dtlsRole&&"answer"===e.type){const t=e.sdp.match(/a=setup:(\w*?)[\r\n]/);t&&(l.debug(`Selecting DTLS role ${t[1]}.`),this.dtlsRole=t[1])}return new Promise((u,d)=>{s.once("onnegotiationready",()=>{c.isStarted()&&l.debug(`Took ${c.timeFromStart()}ms to collect ICE candidates before negotiation.`),u()}),t.setLocalDescription(e).then(()=>{l.info(`Finished setting local description. State is now ${n.signalingState}.`),r.trickleIceMode===o.PEER.TRICKLE_ICE.FULL?(l.debug("Ready for negotiation (full trickleICE)."),s.emit("onnegotiationready")):setTimeout(()=>{"complete"===n.iceGatheringState?(l.debug("Ready for negotiation; ICE candidate collection not needed."),s.emit("onnegotiationready")):(l.debug(`Waiting for ICE collection process (${r.trickleIceMode}).`),n.isIceCollectionCheckOngoing=!0,(0,a.default)(this))},25)}).catch(e=>{l.info("Failed to set local description."),l.debug(`Peer ${i}: ${e}`),d(e)})})};var r,o=n(54507),a=(r=n(74839))&&r.__esModule?r:{default:r}},5350:(e,t,n)=>{"use strict";n(57327)},5604:(e,t,n)=>{"use strict";var r=n(79117),o=n(14188);e.exports=function(e,t){return arguments.length<2?(n=r[e],o(n)?n:void 0):r[e]&&r[e][t];var n}},5613:(e,t,n)=>{"use strict";var r=n(79117),o=n(9304).f,a=n(88088),i=n(97509),s=n(14798),c=n(98657),l=n(68489);e.exports=function(e,t){var n,u,d,f,p,g=e.target,_=e.global,E=e.stat;if(n=_?r:E?r[g]||s(g,{}):r[g]&&r[g].prototype)for(u in t){if(f=t[u],d=e.dontCallGetSet?(p=o(n,u))&&p.value:n[u],!l(_?u:g+(E?".":"#")+u,e.forced)&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&a(f,"sham",!0),i(n,u,f,e)}}},5620:(e,t,n)=>{var r=n(98788),o=n(49141),a=n(80796),i=n(60033);e.exports=function(e,t,n){var s=t+"";return a(e,o(s,i(r(s),n)))}},5681:(e,t,n)=>{var r=n(44700);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},5683:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n}=e;return async function(e){const r=t.getLogger("CALLSTACK"),a=await n.sessionManager.get(e);if(!a){const t=`WebRTC session ${e} not found.`;throw new o.default({message:t})}try{await a.setTransceiversDirection({audio:"inactive",video:"inactive"})}catch(e){}let i;try{i=await a.rollbackLocalDescription()}catch(e){throw r.debug("Failed to rollback local description offer SDP:",e),e}return{offer:i}}};var r,o=(r=n(75412))&&r.__esModule?r:{default:r}},5703:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{...(0,r.default)(e),...(0,o.default)(e),...(0,a.default)(e),...(0,i.default)(e)}};var r=s(n(10839)),o=s(n(73504)),a=s(n(70475)),i=s(n(19742));function s(e){return e&&e.__esModule?e:{default:e}}},5775:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:function(t,n,r){return l(e,t,n,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})},signalling:(t,n)=>u(e,t,n)}},t.localChanges=l,t.signalling=u;var r=n(35),o=n(51918),a=n(40481),i=n(69752),s=n(77126),c=n(69260);async function l(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{context:c,Callstack:l,logManager:u}=e,{setupOutgoingSession:d}=l.utils,f=u.getLogger("CALL",t);f.info("Initiating new outgoing call.");const p=(0,a.getTurnInfo)(c.getState()),g=(0,a.getOptions)(c.getState()),_=(0,i.checkBandwidthControls)(o.bandwidth);let E;try{const e={defaultPeerConfig:g.defaultPeerConfig,turnInfo:p,bandwidth:_,dscpControls:o.dscpControls,callId:t,trickleIceMode:g.trickleIceMode,removeBundling:g.removeBundling};E=await d(r,e)}catch(e){throw f.info(`Failed to initiate call. Changing to ${s.CALL_STATES.ENDED}.`),e}return{participants:n,callInfo:E,options:o,bandwidth:_}}async function u(e,t,n){const{context:a,CallRequests:i,CallstackWebrtc:l,emitEvent:u,logManager:d}=e,{participants:f,callInfo:p,options:g,bandwidth:_}=n,E=d.getLogger("CALL",t);let y;try{const e={id:t,to:f.to,offer:p.offerSdp,isAnonymous:g.isAnonymous,account:g.account,from:f.from},n={displayName:g.displayName?g.displayName:"",customParameters:g.customParameters,customBodies:g.customBodies};y=await i.createSession(e,n)}catch(e){throw E.info("Failed to initiate call. Ending call and cleaning up WebRTC portions."),await l.closeCall(p.sessionId),e}E.info(`Finished initiating call. Changing to ${s.CALL_STATES.INITIATED} and waiting on remote answer.`);const S=(0,c.getSessionById)(a.getState(),p.sessionId);a.dispatch(r.callActions.pendingMakeCall(t,{wrtcsSessionId:y,webrtcSessionId:p.sessionId,mediaIds:p.mediaIds,bandwidth:_,displayName:g.displayName,customParameters:g.customParameters,customBodies:g.customBodies,localTracks:S.localTracks,state:s.CALL_STATES.INITIATED})),u(o.CALL_TRACKS_ADDED,{callId:t,trackIds:S.localTracks})}},5844:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(70506)),o=n(9719),a=n(45775);const i={};i[r.ENABLE_NOTIFICATION_CHANNEL_FINISH]={next(e,t){const n=t.meta.channel;let r;return r=t.payload.channelEnabled?{...e[n],...t.payload}:{...t.payload},{...e,[n]:r}}},i[o.WS_CONNECT_FINISHED]={next:e=>({...e,WEBSOCKET:{...e.WEBSOCKET,channelEnabled:!0}})},i[o.WS_DISCONNECT_FINISHED]={next:e=>({...e,WEBSOCKET:{...e.WEBSOCKET,channelEnabled:!1}})};const s=(0,a.handleActions)(i,{WEBSOCKET:{channelEnabled:!1},PUSH:{channelEnabled:!0}});t.default=s},5902:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,a.default)();e.factory("emitEvent",()=>{const n=e.container.logManager.getLogger("EVENTS");return function(r,o){e.container.isDestroyed?n.debug("emitEvent called after SDK has been destroyed, ignoring event:",r):(n.info(`Emitting event: ${r}`,o),t.emit(r,o))}});const n={on:(e,n)=>{t.on(e,n)},off:(e,n)=>{t.off(e,n)},subscribe:e=>{t.subscribe(e)},unsubscribe:e=>{t.unsubscribe(e)}};return e.value("Events",n),{api:r.default.createAPI,name:r.default.name,cleanup:o.default}};var r=i(n(29834)),o=i(n(35890)),a=i(n(19353));function i(e){return e&&e.__esModule?e:{default:e}}},5968:(e,t,n)=>{var r=n(92673)("map",n(40105));r.placeholder=n(22991),e.exports=r},6022:(e,t,n)=>{var r=n(92673)("without",n(30795));r.placeholder=n(22991),e.exports=r},6032:(e,t,n)=>{"use strict";var r=n(5604),o=n(14188),a=n(4578),i=n(89809),s=Object;e.exports=i?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return o(t)&&a(t.prototype,s(e))}},6131:(e,t,n)=>{var r=n(86403),o=n(41580),a=n(51187),i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(a(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):i.test(e)?NaN:+e}},6231:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.normalizeIceFailure",()=>(0,o.default)(e.container))};var r,o=(r=n(11935))&&r.__esModule?r:{default:r}},6521:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.container);e.factory("Callstack.operations.directTransfer",()=>{const n=e.container.Callstack.models.Negotiation;return{local:function(r,l){return n.instance({type:c.OPERATIONS.DIRECT_TRANSFER,isLocal:!0,stages:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling,remoteSuccess:(0,a.default)(e.container),remoteFailure:(0,i.default)(e.container)},createFlow:s.default},{callId:r,deferred:l})}}})};var r=l(n(47575)),o=l(n(26387)),a=l(n(75976)),i=l(n(50933)),s=l(n(41534)),c=n(59090);function l(e){return e&&e.__esModule?e:{default:e}}},6609:e=>{var t=Array.prototype.reverse;e.exports=function(e){return null==e?e:t.call(e)}},6836:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{call:{...(0,r.default)(e),...(0,o.default)(e),...(0,a.default)(e),...(0,i.default)(e),...(0,s.default)(e)}}};var r=c(n(68343)),o=c(n(66342)),a=c(n(10776)),i=c(n(3478)),s=c(n(14649));function c(e){return e&&e.__esModule?e:{default:e}}},7144:(e,t,n)=>{var r=n(97034);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},7249:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997)),o=n(45775);const a={};a[r.DEVICES_CHANGE]={next:(e,t)=>t.payload},a[r.INITIALIZE_DEVICES_FINISH]={next:(e,t)=>t.payload};const i=(0,o.handleActions)(a,{camera:[],microphone:[],speaker:[]});t.default=i},7269:e=>{"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},7276:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,WebRTC:a}=e;return async function(i){const{CallstackWebrtc:s}=e,{sessionId:c,trackId:l,mediaConstraints:u}=i,d=n.getLogger("CALLSTACK");let f,p,g=0;if(Object.entries(u).forEach(e=>{let[t,n]=e;n&&(g++,f="medias"===t?u.medias[0].type:t)}),1!==g)throw new o.default({code:o.callCodes.INVALID_PARAM,message:`Require exactly one new track type to be specified. Found ${g} track types.`});try{p=await a.sessionManager.get(c)}catch(e){throw d.debug(e.message),e}const _=p.allLocalTracks.find(e=>e.id===l);if(!_)throw new o.default({code:o.callCodes.INVALID_PARAM,message:`Old track ${l} not found.`});const E=await _.getState(),y=E.kind;if(!("audio"===y&&"audio"===f||"video"===y&&["video","screen"].includes(f)))throw new o.default({code:o.callCodes.INVALID_PARAM,message:`Media constraints incompatible for old track kind: ${y}.`});let S=[];if(u.medias)for(const e of u.medias)S.push({type:e.type,media:await a.media.get(e.media.id)});else try{const e=(0,r.getCallByWebrtcSessionId)(t.getState(),c);S=await s.createLocal(u,e.id)}catch(e){throw d.debug("Failed to create local media."),e}let v,h=[];for(const e of S){const t=await e.media.getTracks();h=[...h,...t]}for(const e of h)if((await e.getState()).kind===y){v=e;break}if(!v)throw new o.default({code:o.callCodes.USER_MEDIA_ERROR,message:`${y} track not found`});const T=await p.replaceTrack(v,{trackId:l});if(T)throw d.debug("Failed to replace track."),await v.stop(),new o.default({code:o.callCodes.GENERIC_ERROR,message:T.message});return await _.stop(),{newTrackId:v.id,oldTrackState:E}}},n(62234),n(69375),n(81045),n(45950),n(5350);var r=n(40481),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},7452:(e,t,n)=>{var r=n(97034);e.exports=function(e){return r(this.__data__,e)>-1}},7462:e=>{e.exports=function(e){return this.__data__.has(e)}},7485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,o.default)((e,t)=>{if((0,r.default)(e))return t},t)};var r=a(n(90283)),o=a(n(81175));function a(e){return e&&e.__esModule?e:{default:e}}},7604:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.turnChanged=function(e){let{credentials:t}=e;return{type:r.TURN_CHANGED,payload:{credentials:t}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(21836))},7664:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"fetch",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"removeCallLogs",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"setCache",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"storeCallLog",{enumerable:!0,get:function(){return i.default}});var r=s(n(3727)),o=s(n(70229)),a=s(n(48963)),i=s(n(68580));function s(e){return e&&e.__esModule?e:{default:e}}},7977:(e,t,n)=>{var r=n(92673)("isNil",n(3668),n(76648));r.placeholder=n(22991),e.exports=r},8006:e=>{e.exports=function(e){return this.__data__.has(e)}},8138:(e,t,n)=>{var r=n(87379),o=n(53142),a=n(80547);e.exports=function(e){return"string"==typeof e||!o(e)&&a(e)&&"[object String]"==r(e)}},8506:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n,CallstackWebrtc:r,emitEvent:l,context:u}=e;return async function(e){const d=t.getLogger("CALLSTACK"),f=await n.sessionManager.get(e);if(!f){const t=`WebRTC session ${e} not found.`;throw new s.default({message:t})}try{await f.setTransceiversDirection({audio:"sendrecv",video:"sendrecv"})}catch(e){}let p,g;try{p=await f.rollbackLocalDescription()}catch(e){d.debug("Failed to rollback local description offer SDP:",e),g=e}const _=(0,c.getBrowserDetails)().browser;if((g||"chrome"===_)&&await async function(e,n){const s=(0,o.getCallByWebrtcSessionId)(u.getState(),e),c=t.getLogger("CALL",s.id);if("safari"===n||"chrome"===n){c.info("Ending call due to unrecoverable state after call hold failure."),await r.closeCall(s.webrtcSessionId);const e="Call has ended due to call hold failure.";u.dispatch(a.callActions.endCallFinish(s.id,{isLocal:!0,transition:{reasonText:e}})),l(i.CALL_TRACKS_REMOVED,{callId:s.id,trackIds:[...s.localTracks,...s.remoteTracks]})}}(e,_),g)throw g;return{offer:p}}};var r,o=n(40481),a=n(35),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),s=(r=n(75412))&&r.__esModule?r:{default:r},c=n(37654)},8568:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,Connectivity:s,SubManager:c}=e;return async function(e){(0,i.getConnectionState)(t.getState()).connected&&s.disconnect();const l=(0,o.getPendingOperation)(t.getState());l&&l.operation===a.OPERATIONS.UNSUBSCRIBE||(c.clear(a.CHANGE_REASONS.GONE),n(r.SUB_CHANGE,{reason:a.CHANGE_REASONS.GONE}))}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(34889)),o=n(56512),a=n(22191),i=n(94482)},8588:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n}=e;return{localChanges:(t,n,r)=>f(e,t,n,r),signalling:async(r,o,a)=>{try{const{remoteTracks:i}=await p(e,r,a);t.dispatch(c.callActions.remoteRemoveMediaFinish(r.id,{remote:!0,remoteParticipant:{displayNumber:o.remoteNumber,displayName:o.remoteName},localTracks:void 0,remoteTracks:i})),n(l.CALL_TRACKS_REMOVED,{callId:r.id,trackIds:i})}catch(e){throw t.dispatch(c.callActions.remoteRemoveMediaFinish(r.id,{remote:!0,error:e})),e}}}},t.localChanges=f,t.signalling=p,n(97107),n(62234);var r=n(73520),o=d(n(48151)),a=d(n(11876)),i=d(n(29819)),s=n(77126),c=n(35),l=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),u=n(59090);function d(e){return e&&e.__esModule?e:{default:e}}async function f(e,t,n,o){const{WebRTC:c,CallstackWebrtc:l,CallstackSDP:u,logManager:d}=e,f=d.getLogger("CALL",t.id),p=await c.sessionManager.get(t.webrtcSessionId);if(!p)throw f.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);const g=(0,r.getMediaState)(t);if((0,a.default)(n.sdp)&&[s.CALL_MEDIA_STATES.DUAL_HOLD,s.CALL_MEDIA_STATES.LOCAL_HOLD].includes(g)){if(f.debug("Modifying remote offer to prevent resetting media while in local hold."),n.sdp=(0,i.default)(n.sdp),!n.sdp)return void f.debug("SDP is either undefined or not a string.");o.mediaDiff=u.compareMedia(o.remoteDesc.sdp,n.sdp,!0)}let _;try{_=await l.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth)}catch(e){throw f.debug("Failed to receive offer SDP.",e),e}return{answer:_,opInfo:o,session:p}}async function p(e,t,n){const{CallRequests:r,logManager:a}=e,{answer:i,opInfo:s,session:c}=n,l=a.getLogger("CALL",t.id);try{return await r.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:i.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),l.info("Finished responding to remote update. Changing state based on the remote operation."),{remoteTracks:await(0,o.default)(u.OPERATIONS.REMOVE_MEDIA,s.mediaDiff,c)}}catch(e){throw l.info("Failed to respond to remote offer with an answer."),e}}},8637:(e,t,n)=>{var r=n(92673)("flatMap",n(66652));r.placeholder=n(22991),e.exports=r},8666:(e,t,n)=>{var r=n(70674),o=n(49460),a=n(2306),i=a&&a.isTypedArray,s=i?o(i):r;e.exports=s},8703:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,API_LOG_TAG:n,context:l,emitEvent:u,MessagingOperations:d}=e,f=t.getLogger("MESSAGING"),p=function(e){let t,{destination:r,part:o,messageContext:i,type:s="im"}=e;return"string"!=typeof o&&"text"!==o.type||(t={type:"text",text:o.text}),{destination:Array.isArray(r)?r:[r],messageContext:i,type:s,parts:[t],send:async function(){f.debug(`${n}conversation.Message.send`,this);const e=Date.now();l.dispatch(a.messageActions.sendMessage(this.destination,this.parts,e,this.type,this.messageContext.id));try{await d.sendMessage(this.destination[0],e,this.parts)}catch(e){f.debug(`${n}conversation.Message.send: Encountered an error: ${e}`),u(c.MESSAGES_CHANGE,{error:e})}}}};return{Conversation:function(e){let{destination:t,type:g="im",id:_,description:E="",messages:y=[],isTypingList:S=[],lastReceived:v,lastPull:h,lastMessage:T=""}=e;return{destination:t,type:g,description:E,messages:y,lastMessage:T,isTypingList:S,id:_,features:(0,i.getMessagingConfig)(l.getState()).features,lastReceived:v,lastPull:h,isPending:!1,createMessage:function(e){f.debug(`${n}conversation.Conversation.getMessages`);const t={features:this.features,id:this.id,type:this.type};return p({destination:this.destination,part:e,messageContext:t,type:this.type})},clearMessages:function(){f.debug(`${n}conversation.Conversation.clearMessages`),l.dispatch(a.messageActions.clearMessages(this.destination,this.type)),u(c.MESSAGES_CHANGE,{destination:this.destination,type:this.type})},getMessages:function(){return f.debug(`${n}conversation.Conversation.getMessages`),(0,i.findConversation)(l.getState(),this.destination,this.type).messages.map(e=>{e.forward=async t=>{const r=Date.now();l.dispatch(a.messageActions.sendMessage(t,e.parts,r,this.type,this.id));try{await d.sendMessage(t,r,e.parts)}catch(e){f.debug(`${n}conversation.Message.forward: Encountered an error: ${e}`),u(c.MESSAGES_CHANGE,{error:e})}};const t=(0,s.getUserInfo)(l.getState());return e.sender!==t.username&&(e.markRead=()=>{l.dispatch(a.messageActions.sendMessageRead(e.messageId,this.destination))}),e})},getMessage:function(e){f.debug(`${n}conversation.Conversation.getMessage`);const t=(0,i.findConversation)(l.getState(),this.destination,this.type),r=(0,o.default)(t=>t.messageId===e)(t.messages);if(!r)return void f.debug(`Message (${e}) not found in conversation (${this.destination}).`);r.forward=async e=>{const t=Date.now();l.dispatch(a.messageActions.sendMessage(e,r.parts,t,this.type,this.id));try{await d.sendMessage(e,t,r.parts)}catch(e){f.debug(`${n}conversation.Message.forward: Encountered an error: ${e}`),u(c.MESSAGES_CHANGE,{error:e})}};const p=(0,s.getUserInfo)(l.getState());return r.sender!==p.username&&(r.markRead=()=>{l.dispatch(a.messageActions.sendMessageRead(r.messageId,this.destination))}),r},subscribe:function(e){if(f.debug(`${n}conversation.Conversation.subscribe`),e){const t=t=>{let{destination:n,messageId:o}=t;(0,r.default)(n,this.destination)&&e({destination:n,messageId:o})};return l.api.on("messages:change",t),()=>{l.api.off("messages:change",t)}}}}},Message:p}},n(81045),n(84915);var r=l(n(36582)),o=l(n(5215)),a=n(29889),i=n(33603),s=n(87075),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(35180));function l(e){return e&&e.__esModule?e:{default:e}}},8753:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,sendRequest:i}=e,s=n.getLogger("MWI");return{fetchVoicemails:async function(){const{baseURL:e,username:n,version:c}=(0,r.getRequestInfo)(t.getState()),{body:l,error:u,result:d={}}=await i({method:"GET",url:`${e}/rest/version/${c}/user/${n}/voicemail`,responseType:"json",body:void 0}),{mwiresponse:f}=l||{};if(u){let e;f&&({statusCode:e}=f);const t="number"==typeof e?`Failed to fetch voicemail(s). Status Code: ${e}`:`Voicemail fetch request failed. ${d.message}`;throw s.info(t),new o.default({code:o.mwiCodes.FETCH_MWI_FAIL,message:t})}return(0,a.processMwi)({data:f})}}};var r=n(87075),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),a=n(27470)},8786:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=(0,o.default)(t),e.value("Connectivity",{...(0,a.default)(e.container,(0,s.default)()),constants:{WS_STATUS:c.WS_STATUS}}),e.defer(e=>{e.context.dispatch((0,l.update)(t,r.default.name))}),{api:r.default.api,name:r.default.name,reducer:r.default.reducer,cleanup:i.default}};var r=u(n(2852)),o=u(n(77769)),a=u(n(13418)),i=u(n(91822)),s=u(n(85222)),c=n(78039);n(43249);var l=n(87310);function u(e){return e&&e.__esModule?e:{default:e}}},8813:e=>{var t="__lodash_placeholder__";e.exports=function(e,n){for(var r=-1,o=e.length,a=0,i=[];++r<o;){var s=e[r];s!==n&&s!==t||(e[r]=t,i[a++]=r)}return i}},8870:(e,t,n)=>{var r=n(65650),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[s]=n:delete e[s]),o}},8882:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playInBand=async function(e,t){let{tone:n,duration:o,intertoneGap:a}=t;o=Number(o)>0?Number(o):100,a=Number(a)>-1?Number(a):70;const i=e.localTracks.find(e=>"audio"===e.getState().kind),s=i.getStream(),c=new AudioContext,l=c.createMediaStreamSource(s),u=c.createMediaStreamDestination();l.connect(u);const d=u.stream.getAudioTracks()[0];return await e.peer.replaceTrack(d,{trackId:i.id}),await(0,r.addTones)(c,u,n,{duration:o,gap:a}),await e.peer.replaceTrack(i.track,{trackId:d.id}),c.close(),!0},t.playOutBand=async function(e,t){return await e.sendDTMF(t)},n(81045),n(45950);var r=n(44991)},8889:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container;return async function(o){if(!a(o))return;const i=o.payload.notificationMessage,{sessionData:s}=i.sessionParams;if(!(0,r.getCallByWrtcsSessionId)(e.getState(),s))return void n.getLogger("CALL").info(`Received ${i.eventType} notification for unknown call; ignoring.`);const c=i.callNotificationParams||{},l={eventType:i.eventType,sdp:i.sessionParams.sdp,remoteName:c.remoteName,remoteNumber:c.remoteDisplayNumber,customParameters:i.customParameters};await t.receiveEarlyMedia(s,l)}},t.shouldHandlePattern=a;var r=n(40481),o=n(70506);function a(e){return e.type===o.NOTIFICATION_RECEIVED&&"sessionProgress"===e.payload.notificationMessage.eventType}},8922:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const{context:r,Callstack:c,emitEvent:l,logManager:u}=e;return{start:async function(e,d,f){const p=u.getLogger("CALL",d.callId);if(p.info("Received new incoming call; initiating.",{wrtcsSessionId:e}),(0,o.getCallByWrtcsSessionId)(r.getState(),e))return void p.warn("Local call already exists; ignoring incoming call.");const g=!d.sdp;let _=null;if(g||(_={audio:!1,video:!1},s.default.parse(d.sdp).media.forEach(e=>{_[e.type]=!0})),r.dispatch(a.callActions.callIncoming(d.callId,{remoteParticipant:{displayName:d.remoteName,displayNumber:d.remoteNumber},to:d.calleeNumber,from:d.remoteNumber,wrtcsSessionId:e,isSlowStart:g,mediaOffered:_})),t.tracker.start(),l(i.CALL_INCOMING,{callId:d.callId,mediaOffered:_}),d.customParameters){const e=d.customParameters,t=e.map(e=>e.name);p.debug(`Received custom parameters as part of the Call: ${t}.`),r.dispatch(a.callActions.customParametersReceived(d.callId,{customParameters:e})),l(i.CUSTOM_PARAMETERS,{callId:d.callId,customParameters:e})}try{await n.remoteOffer(e,d)}catch(e){return t.tracker.finish(e),void t.reportEvent.endEvent(e)}if(f&&"push"===f.toLowerCase())try{await c.operations.resyncCallState.stages.signalling(d.callId)}catch(e){}t.tracker.finish(),t.reportEvent.endEvent()}}},n(81045),n(5350),n(84915);var r,o=n(40481),a=n(35),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),s=(r=n(54722))&&r.__esModule?r:{default:r}},8997:(e,t,n)=>{"use strict";var r;n.r(t),n.d(t,{default:()=>N});var o=".",a="function",i="string",s="__global__",c="Provider",l=0,u=Array.prototype.slice,d=function(e,t){var n=e[t];if(void 0===n&&r.config.strict)throw new Error("Bottle was unable to resolve a service.  `"+t+"` is undefined.");return n},f=function(e){var t;return this.nested[e]||(t=r.pop(),this.nested[e]=t,this.factory(e,function(){return t.container})),this.nested[e]},p=function(e){return e.split(o).reduce(d,this)},g=function(e,t){return t(e)},_=function(e,t){return(e[t]||[]).concat(e.__global__||[])},E=function(e,t){var n,r,o,a,i;return this.id,o=this.container,a=this.decorators,i=this.middlewares,n=e+c,(r=Object.create(null))[n]={configurable:!0,enumerable:!0,get:function(){var e=new t;return delete o[n],o[n]=e,e}},r[e]={configurable:!0,enumerable:!0,get:function(){var t,r=o[n];return r&&(t=_(a,e).reduce(g,r.$get(o)),delete o[n],delete o[e]),void 0===t?t:function(e,t,n,r){var o={configurable:!0,enumerable:!0};return e.length?o.get=function(){var t=0,r=function(o){if(o)throw o;e[t]&&e[t++](n,r)};return r(),n}:(o.value=n,o.writable=!0),Object.defineProperty(r,t,o),r[t]}(_(i,e),e,t,o)}},Object.defineProperties(o,r),this},y=function(e,t){var n,r;return n=e.split(o),this.providerMap[e]&&1===n.length&&!this.container[e+c]?console.error(e+" provider already instantiated."):(this.originalProviders[e]=t,this.providerMap[e]=!0,r=n.shift(),n.length?(f.call(this,r).provider(n.join(o),t),this):E.call(this,r,t))},S=function(e,t){return y.call(this,e,function(){this.$get=t})},v=function(e,t,n){var r=arguments.length>3?u.call(arguments,3):[],o=this;return S.call(this,e,function(){var e=t,a=r.map(p,o.container);return n?new(t.bind.apply(t,[null].concat(a))):e.apply(null,a)})},h=function(e,t){Object.defineProperty(this,e,{configurable:!0,enumerable:!0,value:t,writable:!0})},T=function(e,t){var n=e[t];return n||h.call(e,t,n={}),n},C=function(e,t){Object.defineProperty(this,e,{configurable:!1,enumerable:!0,value:t,writable:!1})},I=function(e,t){var n,r;return typeof e===a&&(t=e,e=s),r=(n=e.split(o)).shift(),n.length?f.call(this,r).decorator(n.join(o),t):(this.decorators[r]||(this.decorators[r]=[]),this.decorators[r].push(t)),this},m=function(e){return!/^\$(?:decorator|register|list)$|Provider$/.test(e)},O=function(e){return Object.keys(e||this.container||{}).filter(m)},A={},R=function(e){var t=void 0===e.$value?e:e.$value;return this[e.$type||"service"].apply(this,[e.$name,t].concat(e.$inject||[]))},b=function(e){delete this.providerMap[e],delete this.container[e],delete this.container[e+c]};(r=function e(t){if(!(this instanceof e))return e.pop(t);this.id=l++,this.decorators={},this.middlewares={},this.nested={},this.providerMap={},this.originalProviders={},this.deferred=[],this.container={$decorator:I.bind(this),$register:R.bind(this),$list:O.bind(this)}}).prototype={constant:function(e,t){var n=e.split(o);return e=n.pop(),C.call(n.reduce(T,this.container),e,t),this},decorator:I,defer:function(e){return this.deferred.push(e),this},digest:function(e){return(e||[]).map(p,this.container)},factory:S,instanceFactory:function(e,t){return S.call(this,e,function(e){return{instance:t.bind(t,e)}})},list:O,middleware:function(e,t){var n,r;return typeof e===a&&(t=e,e=s),r=(n=e.split(o)).shift(),n.length?f.call(this,r).middleware(n.join(o),t):(this.middlewares[r]||(this.middlewares[r]=[]),this.middlewares[r].push(t)),this},provider:y,resetProviders:function(e){var t=this.originalProviders,n=Array.isArray(e);Object.keys(this.originalProviders).forEach(function(r){if(!n||-1!==e.indexOf(r)){var a=r.split(o);a.length>1&&a.forEach(b,f.call(this,a[0])),b.call(this,r),this.provider(r,t[r])}},this)},register:R,resolve:function(e){return this.deferred.forEach(function(t){t(e)}),this},service:function(e,t){return v.apply(this,[e,t,!0].concat(u.call(arguments,2)))},serviceFactory:function(e,t){return v.apply(this,[e,t,!1].concat(u.call(arguments,2)))},value:function(e,t){var n;return n=e.split(o),e=n.pop(),h.call(n.reduce(T,this.container),e,t),this}},r.pop=function(e){var t;return typeof e===i?((t=A[e])||(A[e]=t=new r,t.constant("BOTTLE_NAME",e)),t):new r},r.clear=function(e){typeof e===i?delete A[e]:A={}},r.list=O,r.config={strict:!1};const N=r},9016:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(6022)),o=l(n(43813)),a=l(n(14017)),i=l(n(35968)),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(32335)),c=n(45775);function l(e){return e&&e.__esModule?e:{default:e}}const u={};u[s.SIP_EVENT_SUBSCRIBE_FINISH]={next:(e,t)=>({...e,[t.payload.eventType]:{sessionData:t.payload.sessionData,subscribedUsers:t.payload.subscribedUsers}})},u[s.SIP_EVENT_UPDATE_FINISH]={next(e,t){let n=e[t.payload.eventType].subscribedUsers;if(n=(0,o.default)(t.payload.subscribeUserList,n),n=(0,r.default)(t.payload.unsubscribeUserList,n),0===n.length){const n={...e};return delete n[t.payload.eventType],n}return{...e,[t.payload.eventType]:{...e[t.payload.eventType],subscribedUsers:n}}}},u[s.SIP_EVENT_UNSUBSCRIBE_FINISH]={next:(e,t)=>(0,a.default)(t.payload.eventType,e)},u[s.SIP_EVENT_RECEIVED]=function(e,t){const n=(e[t.payload.eventType]||{}).notifications||[];return{...e,[t.payload.eventType]:{...e[t.payload.eventType],notifications:(0,i.default)(n,t.payload)}}};const d=(0,c.handleActions)(u,{});t.default=d},9066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatMediaConstraints=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{audio:e.audio&&!(0,o.default)(e.audioOptions)?e.audioOptions:e.audio,video:e.video&&!(0,o.default)(e.videoOptions)?e.videoOptions:e.video,screen:e.screen&&!(0,o.default)(e.screenOptions)?e.screenOptions:e.screen,medias:e.medias}},t.isValidateNativeConstraints=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object.keys(e).some(e=>["audioOptions","videoOptions","screenOptions"].includes(e)))throw new Error("Cannot validate SDK media constraints format. Format constraints before validating.");return Object.keys(e).some(t=>["audio","video","screen"].includes(t)&&Boolean(e[t]))},t.validateDetachedMedia=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];for(const t of e){if(!t.media.detached)throw new a.default({message:`Media: ${t.media.id} is not detached.`,code:a.callCodes.GENERIC_ERROR});if(!t.media.local)throw new a.default({message:`Media: ${t.media.id} is not local. Only local media may be used when adding detached media to a call.`,code:a.callCodes.GENERIC_ERROR})}},t.validateMediaConstraints=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{medias:t}=e;if(!t)return;if(!Array.isArray(t))throw new a.default({message:"Incorrect type for mediaConstraints.medias. Must be an array of media objects.",code:a.callCodes.GENERIC_ERROR});if(!t.every(e=>{let{type:t,media:n}=e;return Boolean(t)&&Boolean(n)}))throw new a.default({message:"Incorrect media objects.",code:a.callCodes.GENERIC_ERROR});const n=[];e.audio&&n.push("audio"),e.video&&n.push("video"),e.screen&&n.push("screen");const r=[];t.forEach(e=>{r.push(e.type)});const o=n.filter(e=>r.includes(e));if(o.length>0)throw new a.default({message:`Both detached media tracks and media options provided for ${o}`,code:a.callCodes.GENERIC_ERROR})},n(97107),n(62234),n(69375),n(81045),n(42042),n(5350),n(9925);var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},9077:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,WebRTC:n}=e;return async function(){const{serverTurnCredentials:e,defaultPeerConfig:a,removeBundling:i,trickleIceMode:s}=(0,r.getOptions)(t.getState()),c={trickleIceMode:s,removeBundling:i,rtcConfig:a};if(e){const e=(0,o.getSubscriptionInfo)(t.getState());if(e.length>0){const t=e[0].turnCredentials;c.rtcConfig.iceServers=a.iceServers.map(e=>({...e,username:t.username,credential:t.password})),await n.peerManager.createEarly(c)}}else await n.peerManager.createEarly(c)}},n(81045),n(84915);var r=n(40481),o=n(56512)},9101:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForReconnect=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4;const{context:n,Notifications:s}=e,{connected:c}=(0,r.getConnectionState)(n.getState());if(c)return!0;const l=await Promise.race([s.takeAction(o.WS_CONNECT_FINISHED),s.takeAction(i.UNSUBSCRIBE_FINISHED),(0,a.delay)(t)]);return!(!l||!l.type||l.type!==o.WS_CONNECT_FINISHED)};var r=n(94482),o=n(9719),a=n(1011),i=n(34721)},9304:(e,t,n)=>{"use strict";var r=n(96893),o=n(39944),a=n(74416),i=n(39123),s=n(10380),c=n(42344),l=n(74418),u=n(39622),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=s(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return i(!o(a.f,e,t),e[t])}},9323:e=>{var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",(t+=null!=e.rateNumerator?" rate=%s":"")+(null!=e.rateDenominator?"/%s":"")}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach(function(e){t[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},9516:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUTH_ERROR=t.AUTH_CHANGE=void 0,t.AUTH_CHANGE="auth:change",t.AUTH_ERROR="auth:error"},9617:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return o.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return r.default}});var r=a(n(5844)),o=a(n(41369));function a(e){return e&&e.__esModule?e:{default:e}}t.name="notifications"},9638:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.genericRemote",()=>{const t=(0,o.default)(e.container);return{remote:{remoteOffer:t.localChanges,signalling:t.signalling}}}),e.factory("Callstack.operations.genericRemote",()=>{const t=e.container.Callstack.models.Negotiation;return{remote:function(n){return t.instance({type:a.OPERATIONS.GENERIC_REMOTE,isLocal:!1,stages:e.container.Callstack.stages.genericRemote.remote},{callId:n})}}})};var r,o=(r=n(26909))&&r.__esModule?r:{default:r},a=n(59090)},9647:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(6836)),o=a(n(88401));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"call",createAPI:r.default,reducer:o.default}},9719:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WS_RECONNECT_FAILED=t.WS_ERROR=t.WS_DISCONNECT_FINISHED=t.WS_DISCONNECT=t.WS_CONNECT_FINISHED=t.WS_CLOSED=t.WS_ATTEMPT_CONNECT=t.LOST_CONNECTION=t.CHANGE_CONNECTIVITY_CHECKING=void 0;const n="@@KANDY/CONN/";t.WS_ATTEMPT_CONNECT=n+"WS_ATTEMPT_CONNECT",t.WS_CONNECT_FINISHED=n+"WS_CONNECT_FINISHED",t.WS_DISCONNECT=n+"WS_DISCONNECT",t.WS_DISCONNECT_FINISHED=n+"WS_DISCONNECT_FINISHED",t.WS_RECONNECT_FAILED=n+"WS_RECONNECT_FAILED",t.WS_CLOSED=n+"WS_CLOSED",t.WS_ERROR=n+"WS_ERROR",t.LOST_CONNECTION=n+"LOST_CONNECTION",t.CHANGE_CONNECTIVITY_CHECKING=n+"CHANGE_CONNECTIVITY_CHECKING"},9925:(e,t,n)=>{"use strict";n(34840)},9991:e=>{var t=Array.prototype.join;e.exports=function(e,n){return null==e?"":t.call(e,n)}},10358:(e,t,n)=>{var r=n(26137),o=n(3283),a=n(53142),i=n(75853),s=n(69632),c=n(8666),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=a(e),u=!n&&o(e),d=!n&&!u&&i(e),f=!n&&!u&&!d&&c(e),p=n||u||d||f,g=p?r(e.length,String):[],_=g.length;for(var E in e)!t&&!l.call(e,E)||p&&("length"==E||d&&("offset"==E||"parent"==E)||f&&("buffer"==E||"byteLength"==E||"byteOffset"==E)||s(E,_))||g.push(E);return g}},10380:(e,t,n)=>{"use strict";var r=n(47568),o=n(39509);e.exports=function(e){return r(o(e))}},10503:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,proxyPeer:n,log:r}=this;return r.info("Getting stats "+(e?"for track.":".")),e?new Promise((t,o)=>{const a=n.getSenders().find(t=>t.track.id===e);if(a)a.getStats().then(t).catch(o);else{const t=`Cannot find sender with trackId: ${e}`;r.info(t),o(new Error(t))}}):t.getStats()},n(97107),n(81045),n(45950)},10680:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n}=e;return async function(e){const r=t.getLogger("CALLSTACK"),o=await n.sessionManager.get(e);o?(await Promise.all(o.localTracks.map(async e=>{await e.isDetached()||await e.stop()})),await o.end()):r.debug(`webRTC session ${e} not found.`)}},n(81045),n(84915)},10746:(e,t,n)=>{"use strict";var r=n(62694);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},10776:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,context:n,logManager:l,API_LOG_TAG:u,emitEvent:d}=e,f=l.getLogger("CALL");async function p(e,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||f.debug(u+"call.directTransferAsync: ",e,a),(0,o.getOptions)(n.getState()).normalizeDestination&&(a=(0,s.normalizeSipUri)(a,(0,i.getDomain)(n.getState())),f.info("Address normalized to: ",a)),n.dispatch(r.callActions.directTransfer(e,{destination:a}));try{await t.directTransfer(e,a)}catch(t){throw n.dispatch(r.callActions.directTransferFinish(e,{error:t})),t}}async function g(e,o){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||f.debug(u+"call.consultativeTransferAsync: ",e,o),n.dispatch(r.callActions.consultativeTransfer(e,{otherCallId:o}));try{const n=[{id:e,role:"primary"},{id:o,role:"secondary"}];await t.consultativeTransfer(n)}catch(t){throw n.dispatch(r.callActions.consultativeTransferFinish(e,{otherCallId:o,error:t})),t}}async function _(e,o){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||f.debug(u+"call.joinAsync: ",e,o);const a=(0,c.v4)(),s=(0,i.getUserInfo)(n.getState()).username;n.dispatch(r.callActions.join(e,{otherCallId:o,newCallId:a,from:s}));try{await t.join([{id:e,role:"primary"},{id:o,role:"secondary"},{id:a,role:"joined"}],s)}catch(t){throw n.dispatch(r.callActions.joinFinish(e,{usedCallIds:[e,o],error:t})),t}}return{directTransfer:async function(e,t){f.debug(u+"call.directTransfer: ",e,t);const r=(0,o.getCallById)(n.getState(),e);try{await p(e,t,!0)}catch(t){d(a.CALL_STATE_CHANGE,{callId:e,previous:{state:r?r.state:void 0,localHold:r?r.localHold:void 0,remoteHold:r?r.remoteHold:void 0},error:t})}},directTransferAsync:p,consultativeTransfer:async function(e,t){f.debug(u+"call.consultativeTransfer: ",e,t);try{await g(e,t,!0)}catch(t){const r=(0,o.getCallById)(n.getState(),e);d(a.CALL_STATE_CHANGE,{callId:e,previous:{state:r?r.state:void 0,localHold:r?r.localHold:void 0,remoteHold:r?r.remoteHold:void 0},error:t})}},consultativeTransferAsync:g,join:async function(e,t){f.debug(u+"call.join: ",e,t);try{await _(e,t,!0)}catch(t){const r=(0,o.getCallById)(n.getState(),e);d(a.CALL_STATE_CHANGE,{callId:e,previous:{state:r?r.state:void 0,localHold:r?r.localHold:void 0,remoteHold:r?r.remoteHold:void 0},error:t})}},joinAsync:_}};var r=n(35),o=n(40481),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),i=n(87075),s=n(89968),c=n(84596)},10839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,sendRequest:n,CallReporter:s}=e;return{directTransferSession:async function(e){const c={method:"PUT"};c.body=JSON.stringify({callControlRequest:{type:"transfer",address:e.address}});const l=s.getReport(e.id),u=(0,r.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.type===o.OPERATIONS.DIRECT_TRANSFER),d=l.getEvent(u.eventId).addEvent(a.REPORT_EVENTS.REST_REQUEST),f=await i.linkCallRequest(n,{...c,...e});if(f.error)throw d.setError(f.error),d.endEvent(),f.error;d.endEvent()},consultativeTransferSessions:async function(e){const c={method:"PUT"};c.body=JSON.stringify({callControlRequest:{type:"transfer",sessionData:e.otherWrtcsSessionId,address:e.destination}});const l=s.getReport(e.id),u=(0,r.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.type===o.OPERATIONS.CONSULTATIVE_TRANSFER),d=l.getEvent(u.eventId).addEvent(a.REPORT_EVENTS.REST_REQUEST),f=await i.linkCallRequest(n,{...c,...e});if(f.error)throw d.setError(f.error),d.endEvent(),f.error;d.endEvent()},joinSessions:async function(e){const c={method:"POST"};c.body=JSON.stringify({callControlRequest:{type:"join",firstSessionData:e.wrtcsSessionId,secondSessionData:e.otherWrtcsSessionId,sdp:e.sdp,customParameters:e.customParameters}});const l=s.getReport(e.id),u=(0,r.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.type===o.OPERATIONS.JOIN),d=l.getEvent(u.eventId).addEvent(a.REPORT_EVENTS.REST_REQUEST),f=await i.linkCallRequest(n,c);if(f.error)throw d.setError(f.error),d.endEvent(),f.error;return d.endEvent(),f.callControlResponse.sessionData}}},n(81045),n(45950);var r=n(40481),o=n(59090),a=n(84581),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(47378))},10975:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=n=>{let{local:o,trackId:a}=n;const i=r.sessionActions.sessionNewTrack(e.id,{local:o,trackId:a});t(i)},o=n=>{let{local:o,trackId:a,isUnsolicited:i}=n;t(r.sessionActions.sessionTrackEnded(e.id,{local:o,trackId:a,isUnsolicited:i}))},a=n=>{let{oldTrackId:o,trackId:a}=n;const i=r.sessionActions.sessionTrackReplaced(e.id,{oldTrackId:o,trackId:a});t(i)},i=n=>{const o=r.sessionActions.sessionIceConnectionStateChange(e.id,{iceConnectionState:n.iceConnectionState});t(o)},s=n=>{const o=r.sessionActions.sessionIceCandidateCollected(e.id,n);t(o)},c=n=>{const o=r.sessionActions.sessionIceGatheringStateChange(e.id,n);t(o)},l=n=>{const o=r.sessionActions.sessionIceCollectionScheduledCheck(e.id,n);t(o)},u=n=>{t(r.sessionActions.sessionAudioEnded(e.id,{error:!n}))};return e.on("new:track",n),e.on("track:ended",o),e.on("track:replaced",a),e.on("peer:iceConnectionStateChange",i),e.on("peer:iceGatheringStateChange",c),e.on("peer:iceCandidateCollected",s),e.on("peer:iceCollectionScheduledCheck",l),e.on("audioFileEnded",u),()=>{e.off("new:track",n),e.off("track:ended",o),e.off("track:replaced",a),e.off("peer:iceConnectionStateChange",i),e.off("peer:iceGatheringStateChange",c),e.off("peer:iceCandidateCollected",s),e.off("peer:iceCollectionScheduledCheck",l),e.off("audioFileEnded",u)}};var r=n(66446)},10997:(e,t,n)=>{"use strict";var r=n(74530),o=n(64466);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),o.f(e,t,n)}},11102:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!(0,r.getCallById)(e,t))return new o.default({code:o.callCodes.INVALID_PARAM,message:"Call not found; invalid call ID."})};var r=n(40481),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},11112:(e,t,n)=>{var r=n(94497),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},11129:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},11228:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.callIceCollectionCheck",()=>(0,o.default)(e.container))};var r,o=(r=n(90103))&&r.__esModule?r:{default:r}},11257:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t[0].id),i=(0,r.getCallById)(e,t[1].id);return n&&i?n.state!==o.CALL_STATES.ON_HOLD?new a.default({code:a.callCodes.INVALID_STATE,message:`Call is in an invalid state: state=${n.state}. It should be: state=${o.CALL_STATES.ON_HOLD}.`}):i.state!==o.CALL_STATES.ON_HOLD?new a.default({code:a.callCodes.INVALID_STATE,message:`Call is in an invalid state: state=${i.state}. It should be: state=${o.CALL_STATES.ON_HOLD}.`}):void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},11352:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callManager=E,t.default=function(e){(0,c.default)(e),(0,l.default)(e),(0,u.default)(e),e.factory("CallManager",()=>E(e.container))},n(97107),n(62234),n(81045),n(30163),n(45950),n(5350),n(84915),n(9925);var r=n(77126),o=n(59090),a=n(40481),i=n(29127),s=g(n(73313)),c=g(n(67230)),l=g(n(24638)),u=g(n(82998)),d=n(45590),f=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),p=n(84596);function g(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(0,a.getCallById)(e,t)&&!(0,a.getCallByWrtcsSessionId)(e,t))throw new f.default({code:f.callCodes.INVALID_PARAM,message:`Call does not exist: ${t}`})}function E(e){const{context:t,Callstack:n,CallReporter:c,logManager:l,CallRequests:u,TimerTracker:g}=e,E={},y={getTracker:e=>E[e],getCallIds:()=>Object.keys(E)};async function S(e,n){const r=(0,a.getCallByWrtcsSessionId)(t.getState(),e),i=l.getLogger("CALL",r?r.id:void 0);if(!r)return void i.info("Update response for unknown wrtcsSession. Ignoring.",{wrtcsSessionId:e});i.info("Received new update call response; handling.",{wrtcsSessionId:e});const s=await async function(e){return(0,a.getCallById)(t.getState(),e).currentOperations.find((e,t,n)=>e.isLocal&&e.isBlocking||!e.isLocal&&e.type===o.OPERATIONS.SLOW_START&&e.isBlocking||e.isLocal&&e.type===o.OPERATIONS.JOIN&&1===n.length)}(r.id);if(!s)return void i.warn("Received negotiation answer without a matching offer; ignoring.");const c=E[r.id].getByType(s.type);if(!c)return void i.warn("Received negotiation answer without a matching offer; ignoring.");let u;try{u=await c.receiveResponse(r,n)}catch(e){i.info(`Failed handling ${c.type} response.`,e.message),c.deferred.reject(e)}finally{E[r.id].remove(c),(c.type!==o.OPERATIONS.JOIN||c.type===o.OPERATIONS.JOIN&&c.status===o.OP_STATUS.FINISHED)&&c.deferred.resolve(u)}}async function v(e,n){const r=t.getState(),i=(0,a.getCallByWrtcsSessionId)(r,e);_(r,i.id);const s=E[i.id].getAll().find(e=>e.isLocal&&[o.OPERATIONS.JOIN,o.OPERATIONS.CONSULTATIVE_TRANSFER,o.OPERATIONS.DIRECT_TRANSFER].includes(e.type));if(!s)throw new Error(`Complex response entry cannot be used for notification ${n.eventType}`);try{await s.receiveResponse(i,n)}catch(e){s.deferred.reject(e)}E[i.id].remove(s),s.type===o.OPERATIONS.JOIN&&i.id===s.data.priCallId&&E[s.data.joinedCallId].getById(s.id)&&E[s.data.joinedCallId].remove(s),s.status===o.OP_STATUS.FINISHED&&s.deferred.resolve()}var h;return y.make=function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return new Promise((r,a)=>{e.CallReporter.createReport("CALL",t);const i=n.operations.make.local(t,{resolve:r,reject:a});E[t]=(0,s.default)(l.getLogger("CALL",t)),E[t].add(i),i.start(t,o).then(r).catch(a)})},y.establishOffer=async function(t,r,o){const a=(0,p.v4)();e.CallReporter.createReport("CALL",a),E[a]=(0,s.default)(l.getLogger("CALL",a));const i=n.operations.make.remote(a);E[a].add(i),r.callId=a,await i.start(t,r,o),E[a].remove(i)},y.negotiationOffer=async function(e,s){let c=(0,a.getCallByWrtcsSessionId)(t.getState(),e);const d=l.getLogger("CALL",c?c.id:void 0);if(d.info("Received new update call request; handling.",{wrtcsSessionId:e}),!c)throw d.info("Update request is for unknown wrtcsSession. Ignoring.",{wrtcsSessionId:e}),new f.default({code:f.callCodes.INVALID_STATE,message:"Cannot process new remote operation for call that does not exist."});if(c.state===r.CALL_STATES.ENDED)throw d.info("Update request is for ended call. Ignoring.",{wrtcsSessionId:e}),new f.default({code:f.callCodes.INVALID_STATE,message:"Cannot process new remote operation for Ended call."});let p;const g=!s.sdp;p=g?{remoteOp:o.OPERATIONS.SLOW_START}:await n.utils.getRemoteOperationInfo(c,s.sdp);const _=i.operationMap[p.remoteOp],y=n.operations[_].remote(c.id);if(await async function e(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!E[n.id].isBlocked)return!1;if(r>=3e3)return!0;const{isLocal:i,type:s}=E[n.id].getBlocking();return d.debug(`Received new remote operation during ${i?"local":"remote"} ${s} operation. Delaying handling.`),!(!i&&s!==o.OPERATIONS.END)||(await new Promise(e=>setTimeout(e,250)),e((0,a.getCallById)(t.getState(),n.id),r+250))}(c)){y.tracker.start(),d.warn("Received new remote operation during on-going operation; cannot process."),u.updateSessionResponse({statusCode:491,wrtcsSessionId:e}).then(()=>{}).catch(e=>{d.warn(`Failed to reply for a remote session update. Error: ${e.message}`)});const t=new f.default({code:f.callCodes.GLARE,message:`Cannot process new remote ${p.remoteOp} negotiation due to glare scenario.`});throw y.reportEvent.setError(t),y.reportEvent.endEvent(),y.tracker.finish(t),t}E[c.id].add(y);try{c=(0,a.getCallByWrtcsSessionId)(t.getState(),e),await y.start(c,p,s)}catch(e){throw E[c.id].remove(y),e}g||E[c.id].remove(y)},y.negotiationAnswer=S,[o.OPERATIONS.SLOW_ANSWER,o.OPERATIONS.HOLD,o.OPERATIONS.UNHOLD,o.OPERATIONS.ADD_MEDIA,o.OPERATIONS.REMOVE_MEDIA,o.OPERATIONS.ADD_BASIC_MEDIA,o.OPERATIONS.REMOVE_BASIC_MEDIA,o.OPERATIONS.MEDIA_RESTART,o.OPERATIONS.DIRECT_TRANSFER,o.OPERATIONS.ANSWER,o.OPERATIONS.REJECT,o.OPERATIONS.IGNORE,o.OPERATIONS.FORWARD_CALL,o.OPERATIONS.END,o.OPERATIONS.REPLACE_TRACK,o.OPERATIONS.RESYNC,o.OPERATIONS.PLAY_AUDIO,o.OPERATIONS.SEND_RINGING_FEEDBACK,o.OPERATIONS.SEND_CUSTOM_PARAMETERS,o.OPERATIONS.SEND_DTMF,o.OPERATIONS.GET_STATS].forEach(e=>{const r=i.operationMap[e];y[r]=function(e){return function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];return new Promise((i,c)=>{_(t.getState(),r);const l=n.operations[e].local(r,{resolve:i,reject:c});if(E[r].getByType(o.OPERATIONS.END))throw new f.default({code:f.callCodes.GLARE,message:`Cannot start new local ${l.type} operation while call is ending.`});if(l.isNegotiation&&(E[r].isBlocked||E[r].getByType(o.OPERATIONS.ANSWER)||E[r].getByType(o.OPERATIONS.SLOW_ANSWER)))throw new f.default({code:f.callCodes.GLARE,message:`Cannot start new local ${l.type} negotiation due to glare scenario.`});E[r].add(l),l.start(r,s).then(e=>{if(l.isNegotiation){const e=(0,d.getRESTTimeout)(t.getState())+15e3,n=(e,n)=>{const r=(0,a.getCallById)(t.getState(),e),i=r.currentOperations.find(e=>e.id===n);i&&i.status===o.OP_STATUS.PENDING&&S(r.wrtcsSessionId,{code:49,retryAfter:1e4})};g.create("callNegotiation",n,e,{id:r,params:[r,l.id]})}else E[r].remove(l),i(e)}).catch(e=>{E[r].remove(l),c(e)})})}}(r)}),["CALL_STATUS_RINGING","RECEIVE_EARLY_MEDIA"].forEach(e=>{const n=i.notificationMap[e];y[n]=function(e){return async function(n){_(t.getState(),n);const r=(0,a.getCallByWrtcsSessionId)(t.getState(),n),i=l.getLogger("CALL",r?r.id:void 0),s=E[r.id].getPending().find(e=>e.isLocal&&[o.OPERATIONS.MAKE,o.OPERATIONS.MAKE_ANONYMOUS].includes(e.type));if(s){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];await s.receiveUpdate(r,e,u)}else i.debug(`Received ${e} notification for non-make operation; ignoring.`)}}(n)}),y[i.notificationMap.CALL_CANCELLED]=(h=i.notificationMap.CALL_CANCELLED,async function(e,r){const o=t.getState();_(o,e);const i=(0,a.getCallByWrtcsSessionId)(o,e),s=n.operations[h](i.id);E[i.id].add(s),await s.start(i,r),E[i.id].remove(s)}),y[i.notificationMap.CALL_STATUS_ENDED]=async function(e,r){const i=t.getState();_(i,e);const s=(0,a.getCallByWrtcsSessionId)(i,e),c=E[s.id].getAll().filter(e=>[o.OPERATIONS.CONSULTATIVE_TRANSFER,o.OPERATIONS.JOIN].includes(e.type))[0];if(c){const{type:e,calls:t}=c;if(e===o.OPERATIONS.CONSULTATIVE_TRANSFER&&t.some(e=>{let{role:t}=e;return"secondary"===t}))await c.receiveResponse(s,r),E[s.id].remove(c);else if(e===o.OPERATIONS.JOIN&&t.find(e=>"joined"===e.role&&e.callId===s.id)){let e;try{await c.receiveResponse(s,r)}catch(t){e=t}t.forEach(e=>{E[e.callId].remove(c)}),e?c.deferred.reject(e):c.deferred.resolve()}}else{const e=n.operations.end.remote(s.id);E[s.id].add(e);const t=E[s.id].getPending()[0];await e.start(s,r,t),E[s.id].remove(e)}},["CALL_STATUS_FAILED","SESSION_STATUS_ENDED"].forEach(e=>{const t=i.notificationMap[e];y[t]=v}),[o.OPERATIONS.CONSULTATIVE_TRANSFER,o.OPERATIONS.JOIN].forEach(e=>{const r=i.operationMap[e];y[r]=function(e){return function(r){for(var a=arguments.length,i=new Array(a>1?a-1:0),u=1;u<a;u++)i[u-1]=arguments[u];return new Promise((a,u)=>{const d=r.map(e=>e.id),[p,g,y]=d;_(t.getState(),p),_(t.getState(),g),y&&c.createReport("CALL",y);const S=n.operations[e].local(r,{resolve:a,reject:u});if(E[p].isBlocked||E[g].isBlocked){const e=E[p].isBlocked?p:g;u(new f.default({code:f.callCodes.GLARE,message:`Cannot start new local ${S.type} operation due to glare scenario for call ${e}.`}))}else if(E[p].add(S),E[g].add(S),S.type===o.OPERATIONS.JOIN){const e=(0,s.default)(l.getLogger("CALL",y));E[y]=e,E[y].add(S),S.start(r,i).catch(u)}else S.type===o.OPERATIONS.CONSULTATIVE_TRANSFER?S.start(r).catch(u):u(new Error(`Dual-call entry cannot be used for ${S.type}`))})}}(r)}),y}},11655:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const d=s.logManager.getLogger("Peer",e);t=(0,c.default)(i.default,t),d.info("Creating new Peer.");const p=(0,u.createTimer)(),g=new l.default;d.debug("Creating native PeerConnection.",t.rtcConfig);const _=new RTCPeerConnection(t.rtcConfig,{optional:[{googDscp:!0}]}),E={...o.default,...f.methods,on:g.on.bind(g),off:g.off.bind(g),once:g.once.bind(g)},y={...r.default,...f.events},S={nativePeer:_,proxyPeer:void 0,id:e,dtlsRole:null,config:t,trackManager:n,log:d,iceTimer:p,emitter:g,iceCandidates:[],iceLoop:void 0,transceivers:[]};S.proxyPeer=new Proxy(S,{get:function(e,t,n){return"function"==typeof S.nativePeer[t]?Object.keys(E).includes(t)?E[t].bind(S):S.nativePeer[t].bind(S.nativePeer):E[t]&&"function"==typeof E[t]?E[t].bind(S):a.default[t]?"function"==typeof a.default[t]?a.default[t].bind(S)():S.nativePeer[t]:"nativePeer"!==t&&S[t]?S[t]:S.nativePeer[t]},set:function(e,t,n,r){return y[t]?y[t].bind(S)(n):"dtlsRole"===t?(S.dtlsRole=n,!0):Reflect.set(S.nativePeer,t,n)}});for(const e in y)S.proxyPeer[e]=()=>{};return S.proxyPeer},t.setPeerProxies=function(){f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{methods:{},events:{}}},n(62234);var r=d(n(21725)),o=d(n(82254)),a=d(n(50217)),i=d(n(53453)),s=n(40271),c=d(n(7485)),l=d(n(19353)),u=n(67208);function d(e){return e&&e.__esModule?e:{default:e}}let f={methods:{},events:{}}},11876:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=o.default.parse(e),n=t.media.filter(e=>"video"===e.type).every(e=>e&&"inactive"===e.direction),r=t.media.filter(e=>"audio"===e.type).every(e=>e&&["inactive","sendonly"].includes(e.direction));return!n||!r},n(62234),n(81045),n(42042),n(30163);var r,o=(r=n(54722))&&r.__esModule?r:{default:r}},11918:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,MWIOperations:a,logManager:i,API_LOG_TAG:s}=e,c=i.getLogger("MWI");return{voicemail:{async fetch(){let e;c.debug(s+"voicemail.fetch");try{e=await a.fetchMwi()}catch(e){return void n(o.MWI_ERROR,{error:e})}n(o.MWI_CHANGE,e)},get:()=>(c.debug(s+"voicemail.get"),(0,r.getMwi)(t.getState()))}}};var r=n(2556),o=n(44717)},11935:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:l,Notifications:u}=e;return async function(e,d){const f=(0,r.getCallByWebrtcSessionId)(t.getState(),e);var p;if((p=f)&&![o.CALL_STATES.ENDED,o.CALL_STATES.CANCELLED].includes(p.state)&&d===o.CALL_MEDIA_CONNECTION_STATES.DISCONNECTED)try{await u.takeAction(t=>t.type===a.SESSION_ICE_CONNECTION_STATE_CHANGE&&t.payload.id===e&&t.payload.iceConnectionState!==o.CALL_MEDIA_CONNECTION_STATES.DISCONNECTED||t.type===i.END_CALL_FINISH&&t.payload.id===f.id,1e4)}catch(a){const i=(0,r.getCallByWebrtcSessionId)(t.getState(),e);l.getLogger("CALL",i.id).debug("Call has remained in disconnected media connection state too long. Manually transitioning to failed state."),t.dispatch(s.sessionIceConnectionStateChange(i.webrtcSessionId,{iceConnectionState:o.CALL_MEDIA_CONNECTION_STATES.FAILED})),n(c.MEDIA_CONNECTION_CHANGE,{callId:i.id,previous:{state:i.mediaConnectionState}})}}},n(62234);var r=n(40481),o=n(77126),a=n(81997),i=n(21836),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(48377)),c=n(51918)},12266:(e,t,n)=>{"use strict";var r=n(5613),o=n(39944),a=n(44977),i=n(3770),s=n(96002),c=n(32331),l=n(34412),u=n(1942),d=n(88500),f=n(59475),p=n(20850),g=!u&&!f("filter",function(){}),_=!u&&!g&&p("filter",TypeError),E=u||g||_,y=c(function(){for(var e,t,n=this.iterator,r=this.predicate,a=this.next;;){if(e=i(o(a,n)),this.done=!!e.done)return;if(t=e.value,l(n,r,[t,this.counter++],!0))return t}});r({target:"Iterator",proto:!0,real:!0,forced:E},{filter:function(e){i(this);try{a(e)}catch(e){d(this,"throw",e)}return _?o(_,this,e):new y(s(this),{predicate:e})}})},12291:()=>{},12343:(e,t,n)=>{var r=n(94687),o=n(46123),a=n(27276),i=n(65187),s=n(67267),c=n(23904),l=n(66040);e.exports=function(e,t){return i(e)&&s(t)?c(l(e),t):function(n){var i=o(n,e);return void 0===i&&i===t?a(n,e):r(t,i,3)}}},12393:e=>{e.exports=function(){this.__data__=[],this.size=0}},12509:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.join",()=>{const t=e.container.Callstack.models.MultiCall;return{local:function(n,d){const f=(0,r.default)(e.container);return t.instance({type:u.OPERATIONS.JOIN,isNegotiation:!1,stages:{validate:o.default,localOffer:f.localChanges,signalling:f.signalling,remoteAnswer:(0,a.default)(e.container),remoteSuccess:(0,i.default)(e.container),remoteFailure:(0,s.default)(e.container),joinedFailure:(0,c.default)(e.container)},createFlow:l.default},{callInfo:n,deferred:d})}}})};var r=d(n(61397)),o=d(n(61727)),a=d(n(51185)),i=d(n(50332)),s=d(n(76857)),c=d(n(69584)),l=d(n(52068)),u=n(59090);function d(e){return e&&e.__esModule?e:{default:e}}},12540:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:c,CallstackWebrtc:l,CallReporter:u}=e;return async function(e,d){const f=n.getLogger("CALL",e.id),p=u.getReport(e.id),g=e.currentOperations.find(e=>e.isLocal&&[a.OPERATIONS.ADD_MEDIA,a.OPERATIONS.ADD_BASIC_MEDIA].includes(e.type)),_=p.getEvent(g.eventId).addEvent(i.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);_.addData("operation",i.REPORTER_OPERATION_EVENTS_MAP.ADD_MEDIA);try{const t={sessionId:e.webrtcSessionId,answerSdp:d.sdp};await l.receivedAnswer(t,e)}catch(n){throw t.dispatch(r.callActions.endCallFinish(e.id,{error:n})),c(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),c(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold},error:n}),_.setError(n),_.endEvent(),n}f.info(`Finished processing remote response to local ${g.type}. Changing state based on operation.`);const E=g.operationData.mediaIds.map(e=>(0,s.getMediaById)(t.getState(),e));let y=[];return E.forEach(e=>{y=y.concat(e.tracks)}),t.dispatch(r.callActions.addMediaFinish(e.id,{bandwidth:g.operationData.bandwidth,localTracks:y})),c(o.CALL_TRACKS_ADDED,{callId:e.id,trackIds:y}),_.endEvent(),{affectedLocalTracks:y,mediaIds:g.operationData.mediaIds}}},n(62234),n(81045),n(45950),n(5350),n(84915);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090),i=n(84581),s=n(69260)},12585:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchUser=function(e){return{type:r.FETCH_USER,payload:e}},t.fetchUserFinish=function(e,t){return{type:r.FETCH_USER_FINISH,payload:t||e,error:Boolean(t)}},t.searchDirectory=function(e,t){return{type:r.SEARCH_DIRECTORY,payload:{filters:e,options:t}}},t.searchDirectoryFinish=function(e){let{users:t,error:n}=e;return{type:r.SEARCH_DIRECTORY_FINISH,payload:n||t,error:Boolean(n)}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(28686))},12637:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n}=e;return{localChanges:(t,n,r)=>p(e,t,n,r),signalling:async(r,o,a)=>{try{const{remoteTracks:i}=await g(e,r,a);t.dispatch(l.callActions.remoteStartMohFinish(r.id,{remote:!0,remoteParticipant:{displayNumber:o.remoteNumber,displayName:o.remoteName},remoteTracks:i})),n(u.CALL_TRACKS_ADDED,{callId:r.id,trackIds:i})}catch(e){throw t.dispatch(l.callActions.remoteStartMohFinish(r.id,{remote:!0,error:e})),e}}}},t.localChanges=p,t.signalling=g,n(97107),n(62234);var r=n(73520),o=f(n(48151)),a=f(n(11876)),i=f(n(29819)),s=n(70949),c=n(77126),l=n(35),u=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),d=n(59090);function f(e){return e&&e.__esModule?e:{default:e}}async function p(e,t,n,o){const{CallstackWebrtc:l,CallstackSDP:u,WebRTC:d,logManager:f}=e,p=f.getLogger("CALL",t.id),g=await d.sessionManager.get(t.webrtcSessionId);if(!g)throw p.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);const _=(0,r.getMediaState)(t);if((0,a.default)(n.sdp)&&[c.CALL_MEDIA_STATES.DUAL_HOLD,c.CALL_MEDIA_STATES.LOCAL_HOLD].includes(_)){if(p.debug("Modifying remote offer to prevent resetting media while in local hold."),n.sdp=(0,i.default)(n.sdp),!n.sdp)return void p.debug("SDP is either undefined or not a string.");o.mediaDiff=u.compareMedia(o.remoteDesc.sdp,n.sdp,!0)}let E,y=!1;await(0,s.isSameSdpSessionId)(d,t.webrtcSessionId,n.sdp)||(p.debug(`Received offer SDP is from a different session. Recreating Peer for call ${t.id}.`),y=!0);try{E=await l.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth,y)}catch(e){throw p.debug("Failed to receive offer SDP.",e),e}return{answer:E,opInfo:o,session:g}}async function g(e,t,n){const{CallRequests:r,logManager:a}=e,{answer:i,opInfo:s,session:c}=n,l=a.getLogger("CALL",t.id);try{return await r.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:i.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),l.info("Finished responding to remote update. Changing state based on the remote operation."),{remoteTracks:await(0,o.default)(d.OPERATIONS.START_MOH,s.mediaDiff,c)}}catch(e){throw l.info("Failed to respond to remote offer with an answer."),e}}},12661:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=_.map(t=>t(e));return e=>n=>(t.forEach(e=>e(n)),e(n))},n(81045),n(5350);var r=g(n(54049)),o=g(n(43427)),a=g(n(87096)),i=g(n(21769)),s=g(n(17347)),c=g(n(57082)),l=g(n(15966)),u=g(n(66890)),d=g(n(8889)),f=g(n(79130)),p=g(n(54493));function g(e){return e&&e.__esModule?e:{default:e}}const _=[r.default,o.default,a.default,i.default,s.default,c.default,l.default,u.default,d.default,f.default,...p.default]},12762:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},12784:(e,t,n)=>{var r=n(41580),o=n(94495),a=n(6131),i=Math.max,s=Math.min;e.exports=function(e,t,n){var c,l,u,d,f,p,g=0,_=!1,E=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function S(t){var n=c,r=l;return c=l=void 0,g=t,d=e.apply(r,n)}function v(e){var n=e-p;return void 0===p||n>=t||n<0||E&&e-g>=u}function h(){var e=o();if(v(e))return T(e);f=setTimeout(h,function(e){var n=t-(e-p);return E?s(n,u-(e-g)):n}(e))}function T(e){return f=void 0,y&&c?S(e):(c=l=void 0,d)}function C(){var e=o(),n=v(e);if(c=arguments,l=this,p=e,n){if(void 0===f)return function(e){return g=e,f=setTimeout(h,t),_?S(e):d}(p);if(E)return clearTimeout(f),f=setTimeout(h,t),S(p)}return void 0===f&&(f=setTimeout(h,t)),d}return t=a(t)||0,r(n)&&(_=!!n.leading,u=(E="maxWait"in n)?i(a(n.maxWait)||0,t):u,y="trailing"in n?!!n.trailing:y),C.cancel=function(){void 0!==f&&clearTimeout(f),g=0,c=p=l=f=void 0},C.flush=function(){return void 0===f?d:T(o())},C}},12825:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeRemote=function(e){return o(r.INITIALIZE,{config:e})},t.initializeRemoteFinish=function(e){let{error:t,browser:n}=e;return o(r.INITIALIZE_FINISH,{error:t,browser:n})},t.setChannel=function(e){return o(r.SET_CHANNEL,{channel:e})},t.setChannelFinish=function(e){let{error:t}=e;return o(r.SET_CHANNEL_FINISH,{error:t})},t.setProxyMode=function(e){return o(r.SET_MODE,{value:e})},t.setProxyModeFinish=function(e){let{error:t,value:n}=e;return o(r.SET_MODE_FINISH,{error:t,value:n})};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(13377));function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={type:e,payload:{...t}};return t.error&&(n.error=!0),n}},12913:(e,t,n)=>{"use strict";var r=n(44977),o=n(44318);e.exports=function(e,t){var n=e[t];return o(n)?void 0:r(n)}},13029:(e,t,n)=>{"use strict";var r=n(16881),o=n(14188),a=n(62694),i=r(Function.toString);o(a.inspectSource)||(a.inspectSource=function(e){return i(e)}),e.exports=a.inspectSource},13126:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVersion=function(){return"7.11.0-beta.1836"}},13174:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},13377:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET_MODE_FINISH=t.SET_MODE=t.SET_CHANNEL_FINISH=t.SET_CHANNEL=t.INITIALIZE_FINISH=t.INITIALIZE=void 0;const n="@@KANDY/PROXY/";t.SET_MODE=n+"SET_MODE",t.SET_MODE_FINISH=n+"SET_MODE_FINISH",t.SET_CHANNEL=n+"SET_CHANNEL",t.SET_CHANNEL_FINISH=n+"SET_CHANNEL_FINISH",t.INITIALIZE=n+"INITIALIZE",t.INITIALIZE_FINISH=n+"INITIALIZE_FINISH"},13398:(e,t,n)=>{var r=n(57923),o=n(73501);e.exports=function(e,t){return t.length<2?e:r(e,o(t,0,-1))}},13418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const{context:n,emitEvent:u,logManager:d,SubscriptionOperations:f,NotificationsOperations:p,TimerTracker:g}=e,_=d.getLogger("CONNECTIVITY");async function E(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];_.info((s?"Re-":"")+"Connecting to websocket."),n.dispatch(r.wsAttemptConnect(e)),u(o.WS_CHANGE,{});const c=(0,a.getConnectivityConfig)(n.getState());let d=(0,a.getCheckConnectivity)(n.getState());void 0===d&&(d=c.checkConnectivity);try{const n=c.reconnectDelay>2e3?c.reconnectDelay:2e3;_.debug(`Attempting ${c.reconnectLimit} connections (delay: ${n}ms, mult.: ${c.reconnectTimeMultiplier}).`),await(0,i.startTebAttempts)({taskTimeout:n,attemptDelay:n,delayMultiplier:c.reconnectTimeMultiplier,maxDelay:c.reconnectTimeLimit,maxAttempts:c.reconnectLimit},t.connect,g,e),d&&(_.info(`Sending websocket pings every ${c.pingInterval}ms.`),t.setPinging({message:JSON.stringify({message_type:"ping"}),interval:c.pingInterval}))}catch(e){if(_.info(`Failed to ${s?"re-":""}connect websocket after ${c.reconnectLimit} attempts.`),s)throw e;{const t=new l.default({message:e.message,code:l.subscriptionCodes.WS_CONNECTION_ERROR});throw n.dispatch(r.wsConnectFinished(t)),u(o.WS_CHANGE,{}),t}}n.dispatch(r.wsConnectFinished({kandy:{...c,wsInfo:e},pinging:d})),u(o.WS_CHANGE,{})}async function y(){const{wsInfo:e,autoReconnect:t}=(0,a.getConnectionState)(n.getState());if(_.info(`Websocket disconnected. (autoReconnect?: ${t})`),n.dispatch(r.lostConnection()),u(o.WS_CHANGE,{}),t){const{bearerAccessToken:t}=(0,c.getConnectionInfo)(n.getState()),o=(0,a.getConnectivityConfig)(n.getState());t&&"query"===o.webSocketOAuthMode&&(e.params={access_token:t});try{await E(e,!0)}catch(e){n.dispatch(r.wsReconnectFailed()),f.onConnectionLost()}}else n.dispatch(r.wsReconnectFailed()),f.onConnectionLost()}return t.on("message",e=>{_.debug("Received message on websocket.",e),function(e){p.processNotification(e,"WEBSOCKET").catch(()=>{})}(e)}),t.on("close",e=>{_.debug(`Websocket closed (wasClean?: ${e.wasClean}; code ${e.code}).`),1e3===e.code?(_.info("Websocket closed normally."),n.dispatch(r.wsReconnectFailed()),f.onConnectionLost()):y()}),t.on("disconnected",e=>{_.debug(`Websocket disconnected due to ping error: ${e.message}`),y()}),t.on("error",()=>{_.debug("Websocket disconnected due to error."),y()}),{connect:E,disconnect:function(){_.info("Disconnecting websocket connection.");try{t.disconnect()}catch(e){}n.dispatch(r.wsDisconnectFinished()),u(o.WS_CHANGE,{})},setPinging:function(e){if(t.status===s.WS_STATUS.CONNECTED)if(t.isPinging&&!e)_.info("Stopping to send websocket pings."),t.setPinging(void 0);else if(!t.isPinging&&e){const e=(0,a.getConnectivityConfig)(n.getState()).pingInterval;_.info(`Starting to send websocket pings every ${e}ms.`),t.setPinging({message:JSON.stringify({message_type:"ping"}),interval:e})}}}};var r=u(n(47183)),o=u(n(91463)),a=n(94482),i=n(70867),s=n(78039),c=n(87075),l=u(n(75412));function u(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},13504:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n={sending:void 0,receiving:void 0};return e.willSend!==t.willSend?t.willSend?n.sending=r.MEDIA_TRANSITIONS.START:n.sending=r.MEDIA_TRANSITIONS.STOP:n.sending=r.MEDIA_TRANSITIONS.SAME,e.willReceive!==t.willReceive?t.willReceive?n.receiving=r.MEDIA_TRANSITIONS.START:n.receiving=r.MEDIA_TRANSITIONS.STOP:n.receiving=r.MEDIA_TRANSITIONS.SAME,n};var r=n(69540)},13721:(e,t,n)=>{"use strict";var r=n(42937),o=n(33243),a=n(87173),i=n(55558),s=n(29800),c=n(37032),l=o.Set,u=o.add,d=o.has;e.exports=function(e){var t=r(this),n=i(e),o=new l;return a(t)>n.size?c(n.getIterator(),function(e){d(t,e)&&u(o,e)}):s(t,function(e){n.includes(e)&&u(o,e)}),o}},13964:(e,t,n)=>{var r=n(97034);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},13995:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(28686));const o={};o[r.FETCH_USER_FINISH]={next(e,t){const n=t.payload;return{...e,users:{...e.users,[n.primaryContact]:n},isPending:!1}},throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},o[r.SEARCH_DIRECTORY_FINISH]={next(e,t){const n={};for(const e of t.payload)n[e.primaryContact]=e;return{...e,users:{...e.users,...n},isPending:!1}},throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},t.default=o},14017:(e,t,n)=>{var r=n(92673)("omit",n(3326));r.placeholder=n(22991),e.exports=r},14102:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.Callstack.operations;return async function(e){if(!a(e))return!1;t.sendCallAudit(e.payload.id,{wrtcsSessionId:e.payload.wrtcsSessionId})}},t.shouldHandlePattern=a;var r=n(21836),o=n(77126);function a(e){const t=[r.UPDATE_CALL,r.PENDING_JOIN,r.PENDING_MAKE_CALL];return!e.error&&-1!==t.indexOf(e.type)&&(e.payload.state===o.CALL_STATES.INITIATED||e.payload.state===o.CALL_STATES.RINGING)}},14132:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(65275))&&r.__esModule?r:{default:r};t.default=o.default},14188:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},14224:(e,t,n)=>{"use strict";var r=n(96893),o=n(26719),a=TypeError,i=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=s?function(e,t){if(o(e)&&!i(e,"length").writable)throw new a("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},14578:e=>{"use strict";var t=TypeError;e.exports=function(e){if(e>9007199254740991)throw t("Maximum allowed index exceeded");return e}},14582:(e,t,n)=>{"use strict";var r=n(5234),o=n(39123);e.exports=!r(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",o(1,7)),7!==e.stack)})},14613:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallstackSDP:s,WebRTC:c,CallReporter:l}=e;return async function(e,u,d){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const p=n.getLogger("CALLSTACK"),g=await c.sessionManager.get(e);if(!g){const t=`WebRTC session ${e} not found.`;throw p.debug(t),new a.default({message:t,code:a.callCodes.GENERIC_ERROR})}const _=(0,r.getCallByWebrtcSessionId)(t.getState(),e),E=l.getReport(_.id),y=_.currentOperations.find(e=>e.isLocal&&e.isBlocking&&e.status===o.OP_STATUS.ONGOING||!e.isLocal&&e.type===o.OPERATIONS.SLOW_START),S=E.getEvent(y.eventId);let v,h,T,C;try{T=S.addEvent(i.REPORT_EVENTS.CREATE_OFFER),v=await g.createOffer({mediaDirections:u,...f}),T.endEvent()}catch(e){const t=new a.default({message:e.message,code:a.callCodes.GENERIC_ERROR});throw T.endEvent(t),t}try{h=(0,r.getOptions)(t.getState()),v.sdp=s.runPipeline(h.sdpHandlers,v.sdp,{callId:_.id,type:v.type,step:"set",endpoint:"local",bandwidth:d},p),C=S.addEvent(i.REPORT_EVENTS.PROCESS_MEDIA_LOCAL),C.addData("operation",S.type),v=await g.setLocalDescription(v),C.endEvent()}catch(e){const t=new a.default({message:e.message,code:a.callCodes.GENERIC_ERROR});throw C.endEvent(t),t}const I=s.runPipeline(h.sdpHandlers,v.sdp,{callId:_.id,type:v.type,step:"send",endpoint:"local",bandwidth:d},p);return{type:v.type,sdp:I}}},n(81045),n(45950);var r=n(40481),o=n(59090),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),i=n(84581)},14649:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{states:o.CALL_STATES,mediaConnectionStates:o.CALL_MEDIA_CONNECTION_STATES,reportEvents:r.REPORT_EVENTS,metrics:r.REPORT_METRICS}};var r=n(84581),o=n(77126)},14782:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function r(e,r,i,s){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=(0,a.default)(r)),16!==(null===(c=r)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let l=new Uint8Array(16+e.length);if(l.set(r),l.set(e,r.length),l=n(l),l[6]=15&l[6]|t,l[8]=63&l[8]|128,i){s=s||0;for(let e=0;e<16;++e)i[s+e]=l[e];return i}return(0,o.unsafeStringify)(l)}try{r.name=e}catch(e){}return r.DNS=i,r.URL=s,r};var r,o=n(46585),a=(r=n(29975))&&r.__esModule?r:{default:r};const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=i;const s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=s},14798:(e,t,n)=>{"use strict";var r=n(79117),o=Object.defineProperty;e.exports=function(e,t){try{o(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},14816:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={proxyMode:!1,channel:void 0,clientReady:!1,managers:{}};for(const n in e.managers)t.managers[n]=(0,o.default)({modelType:n,proxyMode:t.proxyMode,channel:t.channel},e.managers[n]);return{setProxyMode:n=>{if("boolean"!=typeof n)return u.debug("Provided value is not a boolean; cannot set proxy mode."),!1;u.debug("Setting proxyMode for managers to "+n),t.proxyMode=n;for(const e in t.managers)t.managers[e].proxyMode=n;return e.managers.devices.setListening(!n),!0},getProxyMode:()=>t.proxyMode,setChannel:(e,n)=>{if(!e||!e.send)return u.debug("Provided channel does not support the expected interface."),!1;const r=(0,a.replyChannel)((0,a.jsonChannel)(e),n);t.channel=r,t.clientReady=!1;for(const e in t.managers)t.managers[e].channel=r;return!0},getChannel:()=>t.channel,onMessage:e=>{t.channel.receive=e},initialize:(e,n)=>{const r=(0,s.getVersion)();return new Promise(o=>{if(t.clientReady)u.debug("Cannot initialize remote: Already initialized."),o({error:new c.default({message:"Remote SDK has already been initialized.",code:c.proxyCodes.INVALID_STATE})});else if(t.channel){const a=(e,n)=>{if(u.debug("Received initialize response.",e),n){const e=n.message.includes("timed-out");o({error:new c.default({message:n.message,code:e?c.proxyCodes.TIMEOUT:c.proxyCodes.UNKNOWN})})}else if(e.error){const t=new c.default(e.error);t.code===c.proxyCodes.INVALID_STATE&&e.initialized?(u.warn("Remote SDK responded as already initialized."),o({error:t})):t.code===c.proxyCodes.VERSION_MISMATCH?(u.error(`Remote SDK responded with a version mismatch error. Remote SDK version: ${e.remoteVersion}`),o({error:t})):(u.info("Remote SDK responded with an error."),o({error:t}))}else e.remoteVersion!==r?(u.error(`Remote SDK responded with a version mismatch error. Remote SDK version: ${e.remoteVersion}`),o({error:new c.default({code:c.proxyCodes.VERSION_MISMATCH,message:"Remote SDK version does not match; initialization failed."})})):e.initialized?(t.clientReady=!0,o({browser:e.browser})):(u.debug("Remote SDK responded with an unhandled message."),o({error:new c.default({message:"Unknown error; could not process response.",code:c.proxyCodes.INVALID_STATE})}))},i=(0,l.v4)();t.channel.send(i,{initialize:!0,version:r,config:e,logLevels:n},a)}else u.debug("Cannot initialize remote: Proxy channel not found."),o({error:new c.default({message:"Proxy channel not found.",code:c.proxyCodes.INVALID_STATE})})})},sdp:{pipeline:{setHandlers:function(t){e.sdp.pipeline.setHandlers(t)}}},managers:t.managers,getBrowserDetails:function(){if(!t.proxyMode)return e.getBrowserDetails()}}},n(62234);var r,o=(r=n(95398))&&r.__esModule?r:{default:r},a=n(46937),i=n(69932),s=n(13126),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),l=n(84596);const u=i.logManager.getLogger("PROXY")},14848:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}n.r(t),n.d(t,{__DO_NOT_USE__ActionTypes:()=>u,applyMiddleware:()=>y,bindActionCreators:()=>_,combineReducers:()=>p,compose:()=>E,createStore:()=>d,legacy_createStore:()=>f});var c="function"==typeof Symbol&&Symbol.observable||"@@observable",l=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+l(),REPLACE:"@@redux/REPLACE"+l(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+l()}};function d(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(s(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(s(1));return n(d)(e,t)}if("function"!=typeof e)throw new Error(s(2));var o=e,a=t,i=[],l=i,f=!1;function p(){l===i&&(l=i.slice())}function g(){if(f)throw new Error(s(3));return a}function _(e){if("function"!=typeof e)throw new Error(s(4));if(f)throw new Error(s(5));var t=!0;return p(),l.push(e),function(){if(t){if(f)throw new Error(s(6));t=!1,p();var n=l.indexOf(e);l.splice(n,1),i=null}}}function E(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(s(7));if(void 0===e.type)throw new Error(s(8));if(f)throw new Error(s(9));try{f=!0,a=o(a,e)}finally{f=!1}for(var t=i=l,n=0;n<t.length;n++)(0,t[n])();return e}return E({type:u.INIT}),(r={dispatch:E,subscribe:_,getState:g,replaceReducer:function(e){if("function"!=typeof e)throw new Error(s(10));o=e,E({type:u.REPLACE})}})[c]=function(){var e,t=_;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(s(11));function n(){e.next&&e.next(g())}return n(),{unsubscribe:t(n)}}})[c]=function(){return this},e},r}var f=d;function p(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];"function"==typeof e[o]&&(n[o]=e[o])}var a,i=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:u.INIT}))throw new Error(s(12));if(void 0===n(void 0,{type:u.PROBE_UNKNOWN_ACTION()}))throw new Error(s(13))})}(n)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,o={},c=0;c<i.length;c++){var l=i[c],u=n[l],d=e[l],f=u(d,t);if(void 0===f)throw t&&t.type,new Error(s(14));o[l]=f,r=r||f!==d}return(r=r||i.length!==Object.keys(e).length)?o:e}}function g(e,t){return function(){return t(e.apply(this,arguments))}}function _(e,t){if("function"==typeof e)return g(e,t);if("object"!=typeof e||null===e)throw new Error(s(16));var n={};for(var r in e){var o=e[r];"function"==typeof o&&(n[r]=g(o,t))}return n}function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(s(15))},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map(function(e){return e(o)});return r=E.apply(void 0,a)(n.dispatch),i(i({},n),{},{dispatch:r})}}}},14849:()=>{},14990:()=>{},15156:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallstackWebrtc.closeCall",()=>(0,r.default)(e.container)),e.factory("CallstackWebrtc.createLocal",()=>(0,o.default)(e.container)),e.factory("CallstackWebrtc.generateOffer",()=>(0,a.default)(e.container)),e.factory("CallstackWebrtc.handleOffer",()=>(0,i.default)(e.container)),e.factory("CallstackWebrtc.receivedAnswer",()=>(0,s.default)(e.container))};var r=c(n(10680)),o=c(n(57188)),a=c(n(14613)),i=c(n(92742)),s=c(n(35497));function c(e){return e&&e.__esModule?e:{default:e}}},15353:(e,t,n)=>{var r=n(92673)("sortBy",n(40074));r.placeholder=n(22991),e.exports=r},15375:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.handler&&"function"!=typeof e.handler&&(delete e.handler,t.warn("Invalid log handler configuration provided; using default instead.")),e.logLevel&&!Object.keys(a.logLevels).includes(e.logLevel.toUpperCase())&&(delete e.logLevel,t.warn("Invalid log level configuration provided; using default instead."));const n=(0,o.default)(s,e);return!1!==n.logActions&&(n.logActions instanceof Object?n.logActions=(0,o.default)(c,n.logActions):n.logActions=c),n.logLevel=n.logLevel.toUpperCase(),n},t.partialDefaultLogActions=t.defaultOptions=void 0,n(62234);var r=i(n(97186)),o=i(n(7485)),a=n(44413);function i(e){return e&&e.__esModule?e:{default:e}}const s=t.defaultOptions={logLevel:"debug",handler:void 0,logActions:!1},c=t.partialDefaultLogActions={handler:r.default,actionOnly:!1,collapsed:!1,diff:!1,level:"debug",exposePayloads:!0}},15549:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:r,CallstackWebrtc:f,CallReporter:p,WebRTC:g}=e;return async function(e,_){const E=n.getLogger("CALL",e.id),y=p.getReport(e.id),S=e.currentOperations.find(e=>e.isLocal&&e.type===i.OPERATIONS.UNHOLD),v=y.getEvent(S.eventId).addEvent(c.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);v.addData("operation",i.OPERATIONS.UNHOLD);try{const t={sessionId:e.webrtcSessionId,answerSdp:_.sdp};await f.receivedAnswer(t,e)}catch(n){throw t.dispatch(o.callActions.endCallFinish(e.id,{error:n})),v.setError(n),v.endEvent(),n}const h=d.default.parse(_.sdp);h.media.every(e=>"inactive"===e.direction||"sendonly"===e.direction)?t.dispatch(o.callActions.updateCall(e.id,{remoteHold:!0})):e.remoteHold&&h.media.some(e=>"sendrecv"===e.direction)&&t.dispatch(o.callActions.updateCall(e.id,{remoteHold:!1})),E.info(`Finished processing remote response to local ${S.type}. Changing state based on operation.`);const T=await g.sessionManager.get(e.webrtcSessionId),C=await(0,s.getAllRemoteTracks)(T);let I=[];(e=(0,l.getCallById)(t.getState(),e.id)).remoteHold||(I=(0,u.getSessionById)(t.getState(),e.webrtcSessionId).localTracks),t.dispatch(o.callActions.unholdCallFinish(e.id,{...S.operationData,localTracks:I,remoteTracks:C})),[...I,...C].length>0&&r(a.CALL_TRACKS_ADDED,{callId:e.id,trackIds:[...I,...C]}),r(a.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}),v.endEvent()}},n(81045),n(42042),n(45950),n(9925);var r,o=n(35),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),i=n(59090),s=n(48151),c=n(84581),l=n(40481),u=n(69260),d=(r=n(54722))&&r.__esModule?r:{default:r}},15626:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=o.logManager.getLogger("Track",e.id);n.info(`Creating new ${e.kind} Track.`);const r=e.id,i=e;let s,c,l,u=t,d={};const f=new a.default;function p(){return l}return i.onended=e=>{const t=e instanceof Event,r=c?"local":"remote",o=t?"unsolicited":"solicited";n.debug(`Track ended (${r}, ${o}).`,e),f.emit("ended",{trackId:i.id,isUnsolicited:t,isDetached:p()})},i.onmute=e=>{n.debug("Event emitted: ",e),f.emit("muted",{trackId:i.id,mediaId:u.id,isLocal:c})},i.onunmute=e=>{n.debug("Event emitted: ",e),f.emit("unmuted",{trackId:i.id,mediaId:u.id,isLocal:c})},{id:r,getState:function(){return{id:r,streamId:u.id,kind:i.kind,type:s,isLocal:c,label:i.label,muted:i.muted,enabled:i.enabled,state:i.readyState,detached:l}},mute:function(){i.enabled=!1},unmute:function(){i.enabled=!0},stop:function(){"ended"!==i.readyState?(i.stop(),i.onended()):n.debug("Track already ended.")},getConstraints:function(){return d},setConstraints:function(e){d=e},on:function(){return f.on(...arguments)},off:function(){return f.off(...arguments)},once:function(){return f.once(...arguments)},track:i,setStream:function(e){u=e},getStream:function(){return u},setType:function(e){s=e},getType:function(){return s},setIsLocal:function(e){c=e},isLocal:function(){return c},setIsDetached:function(e){l=e},isDetached:p}};var r,o=n(40271),a=(r=n(19353))&&r.__esModule?r:{default:r}},15630:(e,t,n)=>{var r=n(23212),o=n(59756),a=n(43316),i=n(65568),s=n(36208),c=n(49828);e.exports=function(e,t,n){var l=-1,u=o,d=e.length,f=!0,p=[],g=p;if(n)f=!1,u=a;else if(d>=200){var _=t?null:s(e);if(_)return c(_);f=!1,u=i,g=new r}else g=t?[]:p;e:for(;++l<d;){var E=e[l],y=t?t(E):E;if(E=n||0!==E?E:0,f&&y==y){for(var S=g.length;S--;)if(g[S]===y)continue e;t&&g.push(y),p.push(E)}else u(g,y,n)||(g!==p&&g.push(y),p.push(E))}return p}},15838:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:s}=e;return function(e){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const l=(0,a.getCallByWrtcsSessionId)(t.getState(),e),u=s.getLogger("CALL",(l||{}).id);if(u.info("Received call status ringing notice; handling.",{wrtcsSessionId:e}),l)if(l.state===i.CALL_STATES.INITIATED){if(c.customParameters){const e=c.customParameters.map(e=>e.name);u.debug(`Received custom parameters as part of the Call: ${e}.`),t.dispatch(r.callActions.customParametersReceived(l.id,{customParameters:c.customParameters})),n(o.CUSTOM_PARAMETERS,{callId:l.id,customParameters:c.customParameters})}u.info(`Finished handling call ringing notice. Changing to ${i.CALL_STATES.RINGING}.`),t.dispatch(r.callActions.callRinging(l.id,{remoteParticipant:{displayNumber:c.remoteNumber,displayName:c.remoteName}})),n(o.CALL_STATE_CHANGE,{callId:l.id,previous:{state:l.state,localHold:l.localHold,remoteHold:l.remoteHold}})}else u.info(`Call ringing notice for Call in an invalid state: ${l.state}. Ignoring.`);else u.info("Call ringing notice for unknown wrtcsSession. Ignoring.",{wrtcsSessionId:e})}},n(81045),n(84915);var r=n(35),o=n(51918),a=n(40481),i=n(77126)},15966:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.CallManager,n=e.container.logManager.getLogger("CALL");return async function(r){if(!s(r))return;const c=r.payload.notificationMessage,{sessionData:l}=c.sessionParams,u=(0,o.getCallByWrtcsSessionId)(e.getState(),l);if(!u)return void n.info(`Received ${c.eventType} notification for unknown call; ignoring.`);const d=(0,i.getDomain)(e.getState()),f=(0,a.getRemoteParticipant)(u,c,d),p={eventType:c.eventType,wrtcsSessionId:c.sessionParams.sessionData,sdp:c.sessionParams.sdp,retryAfter:c.sessionParams.retryAfter,message:c.sessionParams.reasonText,code:c.statusCode,...f,customParameters:c.customParameters};await t.negotiationAnswer(l,p)}},t.shouldHandlePattern=s;var r=n(70506),o=n(40481),a=n(82481),i=n(87075);function s(e){return e.type===r.NOTIFICATION_RECEIVED&&"respondCallUpdate"===e.payload.notificationMessage.eventType}},16106:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTransceiverDirection=function(e,t){return(0,r.default)(t,(0,o.default)(a.MEDIA_DIR))?(e.setDirection?e.setDirection(t):e.direction=t,!0):(s.info(`Invalid direction "${t}"`),!1)};var r=i(n(50593)),o=i(n(30186)),a=n(54507);function i(e){return e&&e.__esModule?e:{default:e}}const s=n(40271).logManager.getLogger("SdpPipeline")},16128:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){const a=r.logManager.getLogger("PROXY",`${t.modelType}/${t.id}`);return a.debug(`Creating model proxy for ${t.modelType}/${t.id}.`),new Proxy(t,{get:function(t,r,i){if(t[r]||"then"!==r)return"toJSON"===r?()=>t:["localTracks","allLocalTracks","remoteTracks","tracks"].includes(r)?t[r].map(t=>e(t,n)):t[r]?t[r]:new Proxy(()=>{},{apply:function(t,i,s){const c={modelType:i.modelType,id:i.id,operation:r,params:s};return new Promise((t,r)=>{const i=Date.now();const s=(0,o.v4)().substring(0,8);a.debug(`Sending model ${c.operation} operation (${s}).`,c),n.send(s,c,function(o,l){if(o){const{opTiming:e}=o;if(o=o.result,e){const t=Date.now();a.debug(`Received model ${c.operation} response (${s}).`,o),e&&a.debug(`Remote operation ${c.operation} timing sent: ${i}, receivedRemote: ${e.start}, remoteReplied: ${e.end}, receivedLocal: ${t}`)}}function u(t){if(t&&t.modelType&&"getTracks"===c.operation)return e(t,n);if(null!==t){if(!(t&&t.error&&t.name))return t;{const e=new Error;for(const[n,r]of Object.entries(t))e[n]=r;r(e)}}}if("getStats"===c.operation&&(o=new Map(o)),a.debug(`Received model response for ${s}.`,o),l)r(l);else if(Array.isArray(o)){const e=o.map(u);t(e)}else t(u(o));t(o)})})}})}})},n(97107),n(62234),n(81045),n(84915);var r=n(69932),o=n(84596)},16469:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={target:e,level:(0,a.checkLevel)(t.level),handler:(0,a.checkHandler)(t.handler)};function r(e,t,r){return function(){if(!(o.levelValues[t]>=o.levelValues[n.level]))return;for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];const c={...r,method:e,timestamp:Date.now(),level:t,target:n.target,messages:[...i]};n.handler(c)}}const s={getHandler:function(){return n.handler},setHandler:function(e){n.handler=(0,a.checkHandler)(e)},getLevel:function(){return n.level},setLevel:function(e){n.level=(0,a.checkLevel)(e)},get type(){return n.target.type},get id(){return n.target.id},get name(){return n.target.name}};for(const e in o.logMethods)s[e]=r(e,o.logMethods[e]);const c=(0,i.default)((e,t)=>r(t.event,o.timeLevel,{timer:t})(e),(e,t)=>r("warn",o.logLevels.WARN,{timer:t})(e));return{...s,...c}};var r,o=n(75188),a=n(87398),i=(r=n(1140))&&r.__esModule?r:{default:r}},16556:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,i.getVersion)()[0]<4||(e.ringingFeedbackMode&&!["auto","manual"].includes(e.ringingFeedbackMode)&&(l.warn("Call configuration `ringingFeedbackMode` invalid. Switching to `auto`."),e.ringingFeedbackMode="auto"),e.mediaBrokerOnly&&l.warn("Call configuration `mediaBrokerOnly` was removed in v7.10.0. SDK will behave as if it were `false`."),e.iceCollectionDelay&&(e.iceCollectionIdealTimeout||(e.iceCollectionIdealTimeout=e.iceCollectionDelay),delete e.iceCollectionDelay),e.maxIceTimeout&&!e.iceCollectionMaxTimeout&&(e.iceCollectionMaxTimeout||(e.iceCollectionMaxTimeout=e.maxIceTimeout),delete e.maxIceTimeout),e.skipIceCollection&&(e.trickleIceMode&&["NONE","HALF"].includes(e.trickleIceMode)&&(l.warn("Conflicting `skipIceCollection` and `trickleIceMode` options specified. Proceeding with `skipIceCollection: true` only."),delete e.trickleIceMode),e.trickleIceMode="FULL")),e},t.fixIceServerUrls=function(e){let t;try{t=new URL(e)}catch(t){return l.warn(`Invalid URL specified for ice server: ${e}`),e}const n=t.protocol,r=t.search;if(!r)return e;let o;o=n&&n.toLowerCase().startsWith("turn")?e=>"transport"!==e:()=>!0;const a=new URLSearchParams(r);Array.from(a.keys()).filter(o).forEach(e=>a.delete(e));const i=a.toString();return t.search=i,t.search.length!==r.length&&l.warn(`Invalid STUN/TURN server URL provided: ${e}`),t.toString()},t.mergeDefaults=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=(0,a.default)(u,e),e.iceCollectionCheckFunction||(e.iceCollectionCheckFunction=s.iceCollectionCheckFunction),f(e),e},n(62234),n(81045),n(42042),n(30163),n(5350),n(61412),n(91883),n(70286);var r,o=n(69932),a=(r=n(7485))&&r.__esModule?r:{default:r},i=n(13126),s=n(24679),c=n(52932);const l=o.logManager.getLogger("CALL"),u={defaultPeerConfig:{sdpSemantics:"unified-plan",iceServers:[],iceCandidatePoolSize:1},iceCollectionIdealTimeout:1e3,iceCollectionMaxTimeout:3e3,serverTurnCredentials:!0,sdpHandlers:[],removeBundling:!1,earlyMedia:!1,resyncOnConnect:!1,trickleIceMode:"NONE",skipIceCollection:!1,normalizeDestination:!0,ringingFeedbackMode:"auto",callAuditTimer:25e3,mediaConnectionRetryDelay:3e3},d=c.validation.schema({defaultPeerConfig:c.validation.schema({sdpSemantics:(0,c.enums)(["unified-plan"]),iceServers:c.validation.array(),iceCandidatePoolSize:c.validation.optional(c.validation.positive()),iceTransportPolicy:c.validation.optional((0,c.enums)(["all","public","relay"])),bundlePolicy:c.validation.optional((0,c.enums)(["balanced","max-compat","max-bundle"])),certificates:c.validation.optional(c.validation.array().every.schema({expires:c.validation.string()})),peerIdentity:c.validation.optional(c.validation.string()),rtcpMuxPolicy:c.validation.optional((0,c.enums)(["negotiate","require"]))}),iceCollectionIdealTimeout:c.validation.positive(),iceCollectionMaxTimeout:c.validation.positive(),iceCollectionCheckFunction:c.validation.optional(c.validation.function()),serverTurnCredentials:c.validation.boolean(),sdpHandlers:c.validation.array(),removeBundling:c.validation.boolean(),earlyMedia:c.validation.boolean(),resyncOnConnect:c.validation.boolean(),trickleIceMode:c.validation.string(),skipIceCollection:c.validation.boolean(),normalizeDestination:c.validation.boolean(),ringingFeedbackMode:(0,c.enums)(["auto","manual"]),callAuditTimer:c.validation.positive(),mediaConnectionRetryDelay:c.validation.positive()}),f=(0,c.parse)("call",d)},16635:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},16653:(e,t,n)=>{var r=n(81586),o=n(69632),a=Array.prototype.splice;e.exports=function(e,t){for(var n=e?t.length:0,i=n-1;n--;){var s=t[n];if(n==i||s!==c){var c=s;o(s)?a.call(e,s,1):r(e,s)}}return e}},16712:(e,t,n)=>{"use strict";var r=n(80831);e.exports=function(e){return r(e)||null===e}},16881:(e,t,n)=>{"use strict";var r=n(89055),o=Function.prototype,a=o.call,i=r&&o.bind.bind(a,a);e.exports=r?i:function(e){return function(){return a.apply(e,arguments)}}},16983:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{mwiReceived:t}=e.container.MWIOperations;return e=>n=>{const{type:o,payload:a={}}=n;return o===r.NOTIFICATION_RECEIVED&&a.notificationMessage&&"mwi"===a.notificationMessage.eventType&&t(a.notificationMessage),e(n)}};var r=n(70506)},17077:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n}=e;return async function(e,i){const s=t.getLogger("CALLSTACK"),c=await n.sessionManager.get(e),{tracks:l}=i;if(!c){const t=`WebRTC session ${e} not found.`;throw s.debug(t),new a.default({message:t})}const u=await n.track.getTracks(l),d=u.reduce((e,t,n)=>(0,r.default)(t)?e.concat(n):e,[]).map(e=>l[e]);if(!(0,o.default)(d)){const e=`The following tracks could not be found for rollback: ${d.join(", ")}`;s.debug(e)}let f;await c.removeTracks(l),await Promise.all(u.map(e=>e.stop()));try{f=await c.rollbackLocalDescription()}catch(e){throw s.debug("Failed to rollback local description offer SDP:",e),e}return{offer:f}}},n(81045),n(84915),n(55367);var r=i(n(54502)),o=i(n(84499)),a=i(n(75412));function i(e){return e&&e.__esModule?e:{default:e}}},17099:(e,t,n)=>{e=n.nmd(e);var r=n(78942),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,i=a&&a.exports===o?r.Buffer:void 0,s=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}},17111:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const{proxyPeer:n,log:r}=this;return r.info(`Replacing track ${t.trackId} with new ${e.kind} track.`),new Promise((o,a)=>{const i=n.getTransceivers().find(e=>e.sender.track&&e.sender.track.id===t.trackId),s=i?i.sender:void 0;s?s.replaceTrack(e).then(o).catch(e=>{r.info(`Failed to replace track; ${e.message}`),a(e)}):(r.info(`Failed to replace track; could not find track ${t.trackId}.`),a(new Error(`Sender for track ${t.trackId} not found.`)))})},n(97107),n(81045),n(45950)},17174:(e,t,n)=>{var r=n(92673)("isNumber",n(60986),n(76648));r.placeholder=n(22991),e.exports=r},17249:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"timerFactory",{enumerable:!0,get:function(){return o.default}});var r,o=(r=n(82108))&&r.__esModule?r:{default:r}},17347:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container;return async function(a){if(!s(a))return;const c=a.payload.notificationMessage,{sessionData:l,reasonText:u,statusCode:d}=c.sessionParams,f=(0,r.getCallByWrtcsSessionId)(e.getState(),l);if(!f)return void n.getLogger("CALL").info(`Received ${c.eventType} notification for unknown call; ignoring.`);const p=(0,i.getDomain)(e.getState()),g=(0,o.getRemoteParticipant)(f,c,p),_={eventType:c.eventType,reasonText:u,statusCode:d,...g};await t.sessionStatusUpdateEnded(l,_)}},t.shouldHandlePattern=s;var r=n(40481),o=n(82481),a=n(70506),i=n(87075);function s(e){return e.type===a.NOTIFICATION_RECEIVED&&"sessionComplete"===e.payload.notificationMessage.eventType}},17426:(e,t,n)=>{var r=n(52291),o=n(28931),a=n(28774),i=n(82237),s=n(95243),c=n(62945);e.exports=function(e,t,n){if((e=s(e))&&(n||void 0===t))return e.slice(0,c(e)+1);if(!e||!(t=r(t)))return e;var l=i(e),u=a(l,i(t))+1;return o(l,0,u).join("")}},17524:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.muteTracks=function(e){return a(r.MUTE_TRACKS,e)},t.muteTracksFinish=function(e,t){return a(r.MUTE_TRACKS_FINISH,{trackIds:e,...t})},t.removeTracks=function(e,t){return a(r.REMOVE_TRACKS,{trackIds:e,...t})},t.removeTracksFinish=function(e,t){return a(r.REMOVE_TRACKS_FINISH,{trackIds:e,...t})},t.renderTracks=function(e,t){return a(r.RENDER_TRACKS,{trackIds:e,...t})},t.renderTracksFinish=function(e,t){return a(r.RENDER_TRACKS_FINISH,{trackIds:e,...t})},t.trackAdded=function(e,t){return o(r.TRACK_ADDED,e,t)},t.trackRemoved=function(e,t){return o(r.TRACK_REMOVED,e,t)},t.trackSourceMuted=function(e,t){return a(r.TRACK_SOURCE_MUTED,{trackIds:e,...t})},t.trackSourceUnmuted=function(e,t){return a(r.TRACK_SOURCE_UNMUTED,{trackIds:e,...t})},t.unmuteTracks=function(e){return a(r.UNMUTE_TRACKS,e)},t.unmuteTracksFinish=function(e,t){return a(r.UNMUTE_TRACKS_FINISH,{trackIds:e,...t})};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997));function o(e,t){return{type:e,payload:{...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},trackId:t},meta:arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}}}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={type:e,payload:t,meta:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}};return t.error&&(n.error=!0),n}},17783:function(e,t,n){!function(e){"use strict";function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function r(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function o(e,t,n){o.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function a(e,t){a.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function i(e,t){i.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,n){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function c(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function l(e){var t=void 0===e?"undefined":O(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function u(e,t,n,r,d,f,p){p=p||[];var g=(d=d||[]).slice(0);if(void 0!==f){if(r){if("function"==typeof r&&r(g,f))return;if("object"===(void 0===r?"undefined":O(r))){if(r.prefilter&&r.prefilter(g,f))return;if(r.normalize){var _=r.normalize(g,f,e,t);_&&(e=_[0],t=_[1])}}}g.push(f)}"regexp"===l(e)&&"regexp"===l(t)&&(e=e.toString(),t=t.toString());var E=void 0===e?"undefined":O(e),y=void 0===t?"undefined":O(t),S="undefined"!==E||p&&p[p.length-1].lhs&&p[p.length-1].lhs.hasOwnProperty(f),v="undefined"!==y||p&&p[p.length-1].rhs&&p[p.length-1].rhs.hasOwnProperty(f);if(!S&&v)n(new a(g,t));else if(!v&&S)n(new i(g,e));else if(l(e)!==l(t))n(new o(g,e,t));else if("date"===l(e)&&e-t!==0)n(new o(g,e,t));else if("object"===E&&null!==e&&null!==t)if(p.filter(function(t){return t.lhs===e}).length)e!==t&&n(new o(g,e,t));else{if(p.push({lhs:e,rhs:t}),Array.isArray(e)){var h;for(e.length,h=0;h<e.length;h++)h>=t.length?n(new s(g,h,new i(void 0,e[h]))):u(e[h],t[h],n,r,g,h,p);for(;h<t.length;)n(new s(g,h,new a(void 0,t[h++])))}else{var T=Object.keys(e),C=Object.keys(t);T.forEach(function(o,a){var i=C.indexOf(o);i>=0?(u(e[o],t[o],n,r,g,o,p),C=c(C,i)):u(e[o],void 0,n,r,g,o,p)}),C.forEach(function(e){u(void 0,t[e],n,r,g,e,p)})}p.length=p.length-1}else e!==t&&("number"===E&&isNaN(e)&&isNaN(t)||n(new o(g,e,t)))}function d(e,t,n,r){return r=r||[],u(e,t,function(e){e&&r.push(e)},n),r.length?r:void 0}function f(e,t,n){if(n.path&&n.path.length){var r,o=e[t],a=n.path.length-1;for(r=0;r<a;r++)o=o[n.path[r]];switch(n.kind){case"A":f(o[n.path[r]],n.index,n.item);break;case"D":delete o[n.path[r]];break;case"E":case"N":o[n.path[r]]=n.rhs}}else switch(n.kind){case"A":f(e[t],n.index,n.item);break;case"D":e=c(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function p(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,o=-1,a=n.path?n.path.length-1:0;++o<a;)void 0===r[n.path[o]]&&(r[n.path[o]]="number"==typeof n.path[o]?[]:{}),r=r[n.path[o]];switch(n.kind){case"A":f(n.path?r[n.path[o]]:r,n.index,n.item);break;case"D":delete r[n.path[o]];break;case"E":case"N":r[n.path[o]]=n.rhs}}}function g(e,t,n){if(n.path&&n.path.length){var r,o=e[t],a=n.path.length-1;for(r=0;r<a;r++)o=o[n.path[r]];switch(n.kind){case"A":g(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}else switch(n.kind){case"A":g(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=c(e,t)}return e}function _(e){return"color: "+b[e].color+"; font-weight: bold"}function E(e,t,n,r){var o=d(e,t);try{r?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}o?o.forEach(function(e){var t=e.kind,r=function(e){var t=e.kind,n=e.path,r=e.lhs,o=e.rhs,a=e.index,i=e.item;switch(t){case"E":return[n.join("."),r,"→",o];case"N":return[n.join("."),o];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+a+"]",i];default:return[]}}(e);n.log.apply(n,["%c "+b[t].text,_(t)].concat(A(r)))}):n.log("—— no diff ——");try{n.groupEnd()}catch(e){n.log("—— diff end —— ")}}function y(e,t,n,r){switch(void 0===e?"undefined":O(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,A(n)):e[r];case"function":return e(t);default:return e}}function S(e,t){var n=t.logger,r=t.actionTransformer,o=t.titleFormatter,a=void 0===o?function(e){var t=e.timestamp,n=e.duration;return function(e,r,o){var a=["action"];return a.push("%c"+String(e.type)),t&&a.push("%c@ "+r),n&&a.push("%c(in "+o.toFixed(2)+" ms)"),a.join(" ")}}(t):o,i=t.collapsed,s=t.colors,c=t.level,l=t.diff,u=void 0===t.titleFormatter;e.forEach(function(o,d){var f=o.started,p=o.startedTime,g=o.action,_=o.prevState,S=o.error,v=o.took,h=o.nextState,T=e[d+1];T&&(h=T.prevState,v=T.started-f);var C=r(g),m="function"==typeof i?i(function(){return h},g,o):i,O=I(p),A=s.title?"color: "+s.title(C)+";":"",R=["color: gray; font-weight: lighter;"];R.push(A),t.timestamp&&R.push("color: gray; font-weight: lighter;"),t.duration&&R.push("color: gray; font-weight: lighter;");var b=a(C,O,v);try{m?s.title&&u?n.groupCollapsed.apply(n,["%c "+b].concat(R)):n.groupCollapsed(b):s.title&&u?n.group.apply(n,["%c "+b].concat(R)):n.group(b)}catch(e){n.log(b)}var N=y(c,C,[_],"prevState"),M=y(c,C,[C],"action"),w=y(c,C,[S,_],"error"),P=y(c,C,[h],"nextState");if(N)if(s.prevState){var L="color: "+s.prevState(_)+"; font-weight: bold";n[N]("%c prev state",L,_)}else n[N]("prev state",_);if(M)if(s.action){var D="color: "+s.action(C)+"; font-weight: bold";n[M]("%c action    ",D,C)}else n[M]("action    ",C);if(S&&w)if(s.error){var k="color: "+s.error(S,_)+"; font-weight: bold;";n[w]("%c error     ",k,S)}else n[w]("error     ",S);if(P)if(s.nextState){var j="color: "+s.nextState(h)+"; font-weight: bold";n[P]("%c next state",j,h)}else n[P]("next state",h);l&&E(_,h,n,m);try{n.groupEnd()}catch(e){n.log("—— log end ——")}})}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},N,e),n=t.logger,r=t.stateTransformer,o=t.errorTransformer,a=t.predicate,i=t.logErrors,s=t.diffPredicate;if(void 0===n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(e){return function(t){return e(t)}}};var c=[];return function(e){var n=e.getState;return function(e){return function(l){if("function"==typeof a&&!a(n,l))return e(l);var u={};c.push(u),u.started=m.now(),u.startedTime=new Date,u.prevState=r(n()),u.action=l;var d=void 0;if(i)try{d=e(l)}catch(e){u.error=o(e)}else d=e(l);u.took=m.now()-u.started,u.nextState=r(n());var f=t.diff&&"function"==typeof s?s(n,l):t.diff;if(S(c,Object.assign({},t,{diff:f})),c.length=0,u.error)throw u.error;return d}}}}var h,T,C=function(e,t){return function(e,t){return new Array(t+1).join(e)}("0",t-e.toString().length)+e},I=function(e){return C(e.getHours(),2)+":"+C(e.getMinutes(),2)+":"+C(e.getSeconds(),2)+"."+C(e.getMilliseconds(),3)},m="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},R=[];h="object"===(void 0===n.g?"undefined":O(n.g))&&n.g?n.g:"undefined"!=typeof window?window:{},(T=h.DeepDiff)&&R.push(function(){void 0!==T&&h.DeepDiff===d&&(h.DeepDiff=T,T=void 0)}),t(o,r),t(a,r),t(i,r),t(s,r),Object.defineProperties(d,{diff:{value:d,enumerable:!0},observableDiff:{value:u,enumerable:!0},applyDiff:{value:function(e,t,n){e&&t&&u(e,t,function(r){n&&!n(e,t,r)||p(e,t,r)})},enumerable:!0},applyChange:{value:p,enumerable:!0},revertChange:{value:function(e,t,n){if(e&&t&&n&&n.kind){var r,o,a=e;for(o=n.path.length-1,r=0;r<o;r++)void 0===a[n.path[r]]&&(a[n.path[r]]={}),a=a[n.path[r]];switch(n.kind){case"A":g(a[n.path[r]],n.index,n.item);break;case"D":case"E":a[n.path[r]]=n.lhs;break;case"N":delete a[n.path[r]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==T},enumerable:!0},noConflict:{value:function(){return R&&(R.forEach(function(e){e()}),R=null),d},enumerable:!0}});var b={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},N={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;return"function"==typeof t||"function"==typeof n?v()({dispatch:t,getState:n}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};e.defaults=N,e.createLogger=v,e.logger=M,e.default=M,Object.defineProperty(e,"__esModule",{value:!0})}(t)},17905:(e,t,n)=>{var r=n(2478);e.exports=function(e,t){for(var n=-1,o=e.length;++n<o&&r(t,e[n],0)>-1;);return n}},17918:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallstackSDP:t,logManager:n,WebRTC:c}=e;return async function(e,l){const u=n.getLogger("CALL",e.id),d=await c.sessionManager.get(e.webrtcSessionId),f=(0,a.getMediaState)(e);u.debug(`Current call info; State: ${e.state}, MediaState: ${f}.`);const p=await d.getLatestRemoteDesc();let g=t.compareMedia(p.sdp,l),_=(0,r.default)(g);u.debug(`Interpreted update request as a ${_} operation.`);const E=(0,o.default)(l);return"UNKNOWN"===_?f===i.CALL_MEDIA_STATES.REMOTE_HOLD&&E?_=s.OPERATIONS.UNHOLD:(g=t.compareMedia(p.sdp,l,!0),_=(0,r.default)(g),u.debug(`Re-interpreted update request as a ${_} operation.`)):"NO_CHANGE"===_&&(E||f!==i.CALL_MEDIA_STATES.LOCAL_HOLD||(_=s.OPERATIONS.HOLD,u.debug(`Interpreting NO_CHANGE operation as ${_} due to ${f} state.`))),{remoteOp:_,mediaDiff:g,remoteDesc:p}}};var r=c(n(77839)),o=c(n(11876)),a=n(73520),i=n(77126),s=n(59090);function c(e){return e&&e.__esModule?e:{default:e}}},18069:(e,t,n)=>{var r=n(65650),o=r?r.prototype:void 0,a=o?o.valueOf:void 0;e.exports=function(e){return a?Object(a.call(e)):{}}},18129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,WebRTC:r}=e;return async function(e,c){const l=n.getLogger("CALL",e);l.info("Getting call statistics.");const u=(0,o.getCallById)(t.getState(),e),d=new Map,f=await r.sessionManager.get(u.webrtcSessionId),p=await f.getStats(c);l.info("Finished getting call statistics.");const g="ribbon-sdk-info_"+s.default,_=(0,i.getVersion)(),E="@rbbn/"+(u.isAnonymous?"webrtc-anonymous-js-sdk":"webrtc-js-sdk"),y=(0,a.getBrowserDetails)(),S={id:g,type:"ribbon_sdk_info",sdk:E,version:_,callId:e};y&&(S.platform=y.browser+"/"+y.version);const v=p.keys(),h=p.get(v.next().value);return h&&(S.timestamp=h.timestamp),d.set(g,S),p.forEach(e=>{d.set(e.id,e)}),d}},n(81045),n(5350);var r,o=n(40481),a=n(37654),i=n(13126),s=(r=n(20855))&&r.__esModule?r:{default:r}},18133:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(62234),n(69375),n(81045),n(84915);var r=s(n(90636)),o=s(n(35968)),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997)),i=n(45775);function s(e){return e&&e.__esModule?e:{default:e}}const c={};c[a.SESSION_ADDED]={next:(e,t)=>(0,o.default)(e,t.payload)},c[a.SESSION_REMOVED]={next:(e,t)=>(0,r.default)(e=>e.id===t.payload.id)(e)};const l={};l[a.SESSION_NEW_TRACK]={next:(e,t)=>t.payload.local?{...e,localTracks:e.localTracks.includes(t.payload.trackId)?e.localTracks:(0,o.default)(e.localTracks,[t.payload.trackId])}:{...e,remoteTracks:e.remoteTracks.includes(t.payload.trackId)?e.remoteTracks:(0,o.default)(e.remoteTracks,[t.payload.trackId])}},l[a.SESSION_TRACK_ENDED]={next(e,t){const n=e=>e===t.payload.trackId;return t.payload.local?{...e,localTracks:(0,r.default)(n,e.localTracks)}:{...e,remoteTracks:(0,r.default)(n,e.remoteTracks)}}},l[a.SESSION_TRACK_REPLACED]={next(e,t){const n=(0,r.default)(e=>e===t.payload.oldTrackId,e.localTracks);return-1===n.indexOf(t.payload.trackId)&&n.push(t.payload.trackId),{...e,localTracks:n}}};const u=(0,i.handleActions)(l,{});c[(0,i.combineActions)(a.SESSION_NEW_TRACK,a.SESSION_TRACK_ENDED,a.SESSION_TRACK_REPLACED)]=(e,t)=>e.map(e=>e.id===t.payload.id?u(e,t):e);const d=(0,i.handleActions)(c,[]);t.default=d},18284:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.replaceTrack",()=>({local:{validate:o.default,localOffer:(0,r.default)(e.container)}})),e.factory("Callstack.operations.replaceTrack",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:i.OPERATIONS.REPLACE_TRACK,isLocal:!0,stages:e.container.Callstack.stages.replaceTrack.local},{callId:n})}}}),e.factory("Callstack.utils.webRtcReplaceTrack",()=>(0,a.default)(e.container))};var r=s(n(34545)),o=s(n(92140)),a=s(n(7276)),i=n(59090);function s(e){return e&&e.__esModule?e:{default:e}}},18324:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionOperations.onWebsocketOverridden",t=>(0,o.default)(e.container)),e.defer(e=>{e.Notifications.takeEveryAction(function(e){return e.type===a.NOTIFICATION_RECEIVED&&e.payload.notificationMessage&&"websocketOverridden"===e.payload.notificationMessage.eventType},t=>{e.SubscriptionOperations.onWebsocketOverridden()})})};var r,o=(r=n(35096))&&r.__esModule?r:{default:r},a=n(70506)},18439:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=async function(e,t,n){const r=o.logManager.getLogger("REQUEST",t),u=function(e){const{url:t,responseType:n}=e;return t&&"string"==typeof t?n&&!c.hasOwnProperty(n)?l({error:"RESPONSE_TYPE",message:"Cannot make request; responseType value was invalid."}):void 0:l({error:"REQUEST_URL",message:`Invalid request url; expected url of type string but received ${t} instead`})}(e);if(u)return r.info(u.result.message),u;const{url:d,queryParams:f,responseType:p="json",...g}=e;let _=d.match(/([^/]*)$/)[0];_=_.length>15?_.substring(0,15)+"...":_,r.info(`Making ${g.method} ${_} request.`);const E=new AbortController;let y;g.signal=E.signal;try{if(y=await Promise.race([fetch(d+(0,a.default)(f),g),(0,i.delay)((0,s.getRESTTimeout)(n.getState()))]),!y){const e=new DOMException("Request timed out","TimeoutError");throw E.abort(e),e}}catch(e){return r.info(`Failed to make request, caused by ${e.message}`),l({error:"FETCH"},{code:e.name,message:e.message})}const S={ok:y.ok,code:y.status,message:y.statusText};if(y.ok){if(204===y.status)return r.info(`Finished request with successful response (status ${y.status}).`),l(void 0,{body:{},...S});const e=await async function(e,t){let n={};try{switch(t){case c.json:n=await e.json();break;case c.blob:n=await e.blob();break;case c.text:n=await e.text();break;case c.none:break;default:throw Error("Assertion failed")}}catch(e){return e}return n}(y,p);return e instanceof Error?(r.error(`Failed to parse with response type: ${p}. Error: ${e}`),l({error:"REQUEST"},{code:e.name,message:e.message})):(r.info(`Finished request with successful response (status ${y.status}).`),l(void 0,{body:e,...S}))}{let e,t;try{e=await y.headers.get("content-type")}catch(e){r.debug(`Failed to get content-type:${e.message}.`)}if(403===y.status&&e.includes("html"))return l({error:"REQUEST"},S);try{if(t=await y.json(),503===y.status){let e,n;if(t&&t.subscribeResponse?e=t.subscribeResponse.retryAfter:t&&t.authorizationResponse&&(e=t.authorizationResponse.retryAfter),e)n=e;else{try{e=await y.headers.get("retry-after")}catch(e){r.debug(`Failed to get retry-after:${e.message}.`)}e&&(n=e.endsWith(" GMT")?new Date(e).getTime()-Date.now():1e3*e)}t=n&&n>0?{subscribeResponse:{statusCode:503,retryAfter:n}}:{subscribeResponse:{statusCode:500}}}}catch(e){t={},r.debug("Failed to parse response:",e.message)}return l({error:"REQUEST"},{body:t,...S})}},n(97107),n(62234),n(57182);var r,o=n(69932),a=(r=n(2633))&&r.__esModule?r:{default:r},i=n(1011),s=n(45590);const c=Object.freeze({json:"json",blob:"blob",text:"text",none:"none"});function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{body:t.body,error:e.error,result:{ok:Boolean(t.ok),code:t.code,message:e.message||t.message}}}},18470:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET_SDP_HANDLERS=t.CONFIG_UPDATE=void 0;const n="@@KANDY/";t.CONFIG_UPDATE=n+"CONFIG_UPDATE",t.SET_SDP_HANDLERS=n+"SET_SDP_HANDLERS"},18478:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{nativePeer:e,id:t,emitter:n,iceLoop:r,log:o}=this;o.info("Closing Peer."),r&&clearTimeout(r),e.close(),n.emit("peer:closed",t)}},18487:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=e=>{let{mediaId:n,trackId:o}=e;const a=r.mediaActions.mediaNewTrack(n,{trackId:o});t(a)},o=e=>{let{mediaId:n,trackId:o}=e;const a=r.mediaActions.mediaTrackEnded(n,{trackId:o});t(a)},a=()=>{e.off("media:stopped",a),e.off("track:new",n),e.off("track:ended",o)};return e.on("media:stopped",a),e.on("track:new",n),e.on("track:ended",o),a};var r=n(66446)},18666:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallRequests:n,CallstackWebrtc:s,emitEvent:c,logManager:l}=e;return async function(e,u){const d=l.getLogger("CALL",e.id);d.info("Received session status completed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId});const{reasonText:f,statusCode:p}=u;if(f){let e;e=p||0===p?p:a.STATUS_CODES.CONSULTATIVE_TRANSFER_SUCCESS,d.debug(`Session completed notice caused by ${f} (${e}).`)}d.info(`Ending webRTC session with id: ${e.webrtcSessionId}, locally ...`),await s.closeCall(e.webrtcSessionId),t.dispatch(r.callActions.consultativeTransferFinish(e.id,{transition:{reasonText:a.COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_SUCCESS,statusCode:a.STATUS_CODES.CONSULTATIVE_TRANSFER_SUCCESS}}));try{d.debug("Ending call session on server-side."),await n.endSession({callId:e.id,wrtcsSessionId:e.wrtcsSessionId,isAnonymous:e.isAnonymous,account:e.account})}catch(e){d.debug(`Error received when attempting to end the session: ${e}.`)}finally{d.info(`Finished ending call. Changing call state to ${a.CALL_STATES.ENDED}.`),t.dispatch(r.callActions.endCallFinish(e.id,(0,i.generateEndParams)(e.state,!0,u))),c(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),c(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}})}}};var r=n(35),o=n(51918),a=n(77126),i=n(69752)},18669:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,o.default)(s,e);return(0,a.parse)("subscription",c)(t),t.expires<i&&(t.expires=i),t};var r,o=(r=n(7485))&&r.__esModule?r:{default:r},a=n(52932);const i=n(22191).MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL/1e3,s={expires:3600,serviceUnavailableMaxRetries:3,websocket:{protocol:"wss",port:443}},c=a.validation.schema({expires:a.validation.positive().greaterThanOrEqual(i),serviceUnavailableMaxRetries:a.validation.positive(),websocket:a.validation.schema({server:a.validation.string(),protocol:a.validation.string(),port:a.validation.positive()})})},18717:()=>{},18893:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n}=e;return{localChanges:(t,n,o)=>async function(e,t,n,o){const{WebRTC:a,CallstackWebrtc:i,logManager:s}=e,c=s.getLogger("CALL",t.id),l=await a.sessionManager.get(t.webrtcSessionId);if(!l)throw c.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);let u=!1;const d=await(0,r.isSameSdpSessionId)(a,t.webrtcSessionId,n.sdp);let f;d||(c.debug(`Received offer SDP is from a different session. Recreating Peer for call ${t.id}.`),u=!0);try{f=await i.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth,u)}catch(e){throw c.debug("Failed to receive offer SDP.",e),e}return{answer:f,sameSession:d,session:l,opInfo:o}}(e,t,n,o),signalling:async(r,c,l)=>{try{const{localTracks:u,remoteTracks:d}=await async function(e,t,n){const{CallRequests:r,logManager:a}=e,{answer:i,sameSession:c,session:l,opInfo:u}=n,d=a.getLogger("CALL",t.id);try{await r.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:i.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),d.info("Finished responding to remote update. Changing state based on the remote operation.");let e=[];return e=c?await(0,o.default)(s.OPERATIONS.HOLD,u.mediaDiff,l):await(0,o.getAllRemoteTracks)(l),{remoteTracks:e,localTracks:t.localTracks}}catch(e){throw d.info("Failed to respond to remote offer with an answer."),e}}(e,r,l);t.dispatch(a.callActions.remoteHoldFinish(r.id,{remote:!0,remoteParticipant:{displayNumber:c.remoteNumber,displayName:c.remoteName},localTracks:u,remoteTracks:d})),n(i.CALL_STATE_CHANGE,{callId:r.id,previous:{state:r.state,localHold:r.localHold,remoteHold:r.remoteHold}}),n(i.CALL_TRACKS_REMOVED,{callId:r.id,trackIds:[...u,...d]})}catch(e){throw t.dispatch(a.callActions.remoteHoldFinish(r.id,{remote:!0,error:e})),n(i.CALL_STATE_CHANGE,{callId:r.id,previous:{state:r.state,localHold:r.localHold,remoteHold:r.remoteHold},error:e}),e}}}},n(97107);var r=n(70949),o=c(n(48151)),a=n(35),i=c(n(51918)),s=n(59090);function c(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(c=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},18995:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLICK_TO_CALL_FINISH=t.CLICK_TO_CALL_ERROR=t.CLICK_TO_CALL=void 0;const n="@@KANDY/";t.CLICK_TO_CALL=n+"CLICK_TO_CALL",t.CLICK_TO_CALL_FINISH=n+"CLICK_TO_CALL_FINISH",t.CLICK_TO_CALL_ERROR=n+"CLICK_TO_CALL_ERROR"},19054:()=>{},19083:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(45775);const o={};o[function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(18995)).CLICK_TO_CALL_FINISH]={next:(e,t)=>e.concat({callId:t.payload.callId,caller:t.payload.caller,callee:t.payload.callee,requestTime:t.payload.requestTime})};const a=(0,r.handleActions)(o,[]);t.default=a},19251:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REQUEST_ERROR=void 0,t.REQUEST_ERROR="request:error"},19270:(e,t,n)=>{var r=n(94715)(n(78942),"WeakMap");e.exports=r},19283:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,o.getCallById)(e,t);return n?[r.CALL_STATES.INITIATED,r.CALL_STATES.RINGING].includes(n.state)?n.direction!==r.CALL_DIRECTION.INCOMING?new a.default({message:"Failed to ignore call. Call must be incoming.",code:a.callCodes.INVALID_STATE}):void 0:new a.default({message:`Failed to ignore call. Call must be in ${r.CALL_STATES.INITIATED} or ${r.CALL_STATES.RINGING} state.`,code:a.callCodes.INVALID_STATE}):new a.default({message:`Failed to ignore call. Call ${t} not found.`,code:a.callCodes.INVALID_PARAM})},n(62234);var r=n(77126),o=n(40481),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},19353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=[],n=[],r=!1;function o(e){if(r&&!t[e])throw new Error("Invalid event type: "+e)}function a(e,t){for(var n=e.length;n--;)t===e[n]&&e.splice(n,1)}return Object.assign(e,{define:function(e){t[e]=t[e]||[]},alias:function(e,n){o(e),t[n]=t[e]=t[e]||[]},on:function(e,n){o(e),(t[e]=t[e]||[]).push(n)},off:function(e,n){o(e),a(t[e]||[],n)},once:function(e,n){o(e),n.once=!0,(t[e]=t[e]||[]).push(n)},emit:function(e){o(e);for(var r=Array.prototype.slice.call(arguments,1),i=t[e]||[],s=0,c=function(){},l=i.slice();s<l.length;s++){var u=l[s];u.once&&(i[s]=c),u.apply(void 0,r)}a(i,c);for(var d=0;d<n.length;d++)n[d].call(void 0,e,r)},subscribe:function(e){if("function"!=typeof e)throw new Error("Listener not a function");n.push(e)},unsubscribe:function(e){if("function"!=typeof e)throw new Error("Listener not a function");a(n,e)},setStrictMode:function(e){r=e}})},n(97107),n(69375)},19528:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(70321)),o=a(n(37892));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:r.default,createAPI:o.default}},19556:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSdpSessionId=function(e){const t=e.match(/o=.*/gm);if(t&&t[0])return t[0].split(" ")[1]}},19742:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,sendRequest:n,CallReporter:s}=e;return{updateSession:async function(e){const c={method:"PUT"},l=e.isAnonymous?"callMeRequest":"callControlRequest";c.body=JSON.stringify({[l]:{type:"startCallUpdate",sdp:e.offer,customParameters:e.customParameters,customBodies:e.customBodies}});const u=(0,r.getCallById)(t.getState(),e.id),d=s.getReport(u.id),f=u.currentOperations.find(e=>e.isLocal&&e.status===o.OP_STATUS.PENDING),p=d.getEvent(f.eventId).addEvent(a.REPORT_EVENTS.REST_REQUEST);p.addData("requestType",a.REPORTER_REQUESTS.UPDATE_SESSION);const g=await i.linkCallRequest(n,{...c,...e});if(g.error)throw p.endEvent(g.error),g.error;p.endEvent()},updateSessionResponse:async function(e){const o={method:"PUT"},c=e.isAnonymous&&e.account?"callMeRequest":"callControlRequest",l={[c]:{type:"respondCallUpdate"}};e.statusCode?l[c].statusCode=`${e.statusCode}`:(l[c].sdp=e.answer,l[c].customParameters=e.customParameters,l[c].customBodies=e.customBodies),o.body=JSON.stringify(l);const u=(0,r.getCallByWrtcsSessionId)(t.getState(),e.wrtcsSessionId),d=s.getReport(u.id),f=u.currentOperations.find(e=>!e.isLocal),p=d.getEvent(f.eventId).addEvent(a.REPORT_EVENTS.REST_REQUEST);p.addData("requestType",a.REPORTER_REQUESTS.UPDATE_SESSION);const g=await i.linkCallRequest(n,{...o,...e});if(g.error)throw p.endEvent(g.error),g.error;p.endEvent()}}},n(81045),n(45950);var r=n(40481),o=n(59090),a=n(84581),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(47378))},19770:(e,t,n)=>{var r=n(94715)(n(78942),"Map");e.exports=r},19957:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,proxyPeer:n,config:o,iceTimer:a,emitter:i,iceCandidates:s,log:c}=this;return t.onicecandidate=t=>{c.debug(`ICE candidate received (trickling?: ${o.trickleIceMode===r.PEER.TRICKLE_ICE.FULL}): `,t.candidate),null!==t.candidate&&s.push(t.candidate);const l=a.timeFromStart();i.emit("iceCandidateCollected",{iceCollectionDuration:l,iceCandidates:s,iceGatheringState:n.iceGatheringState,rtcPeerConnectionConfig:o,rtcLocalSessionDescription:n.localDescription}),o.trickleIceMode===r.PEER.TRICKLE_ICE.FULL?t.candidate&&e(t):o.trickleIceMode===r.PEER.TRICKLE_ICE.HALF&&(o.halfTrickleThreshold({sdp:n.localDescription.sdp,iceCandidate:t.candidate,time:l})?(c.debug("Half ICE collection process complete; ready for negotiation."),o.trickleIceMode=r.PEER.TRICKLE_ICE.FULL,i.emit("onnegotiationready")):c.debug("Peer's half trickle threshold not reached."))},!0},n(69375);var r=n(54507)},20155:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},20223:e=>{"use strict";e.exports={stdout:!1,stderr:!1}},20714:(e,t,n)=>{var r=n(65650),o=n(3283),a=n(53142),i=r?r.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||o(e)||!!(i&&e&&e[i])}},20850:(e,t,n)=>{"use strict";var r=n(79117);e.exports=function(e,t){var n=r.Iterator,o=n&&n.prototype,a=o&&o[e],i=!1;if(a)try{a.call({next:function(){return{done:!0}},return:function(){i=!0}},-1)}catch(e){e instanceof t||(i=!1)}if(!i)return a}},20855:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const r=(0,n(84596).v4)();t.default=r},20939:()=>{},21018:(e,t,n)=>{"use strict";var r=n(5613),o=n(99978);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("isDisjointFrom",function(e){return!e})},{isDisjointFrom:o})},21203:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{proxyPeer:e,trackManager:t}=this;return e.getReceivers().filter(e=>Boolean(e.track)).map(e=>t.get(e.track.id)).filter(e=>e&&"live"===e.getState().state)},n(81045),n(30163),n(84915)},21471:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUB_STATUS=void 0,t.SUB_STATUS={SUBSCRIBED:"SUBSCRIBED",SUBSCRIBING:"SUBSCRIBING",UNSUBSCRIBING:"UNSUBSCRIBING",NO_SUB:"NO_SUB"}},21506:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.sendCustomParameters",()=>({local:{validate:o.default,localOffer:()=>{},signalling:(0,r.default)(e.container)}})),e.factory("Callstack.operations.sendCustomParameters",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.SEND_CUSTOM_PARAMETERS,isLocal:!0,stages:e.container.Callstack.stages.sendCustomParameters.local},{callId:n})}}})};var r=i(n(63361)),o=i(n(82966)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},21725:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(19957)),o=l(n(27137)),a=l(n(2988)),i=l(n(57989)),s=l(n(71280)),c=l(n(5094));function l(e){return e&&e.__esModule?e:{default:e}}t.default={onicecandidate:r.default,oniceconnectionstatechange:o.default,onicegatheringstatechange:a.default,onnegotiationneeded:i.default,onsignalingstatechange:s.default,ontrack:c.default}},21769:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container;return async function(a){if(!s(a))return;const c=a.payload.notificationMessage,{sessionData:l}=c.sessionParams,u=(0,r.getCallByWrtcsSessionId)(e.getState(),l);if(!u)return void n.getLogger("CALL").info(`Received ${c.eventType} notification for unknown call; ignoring.`);const d=(0,i.getDomain)(e.getState()),f=(0,o.getRemoteParticipant)(u,c,d),p={eventType:c.eventType,...f,customParameters:c.customParameters};t.callStatusUpdateRinging(l,p)}},t.shouldHandlePattern=s;var r=n(40481),o=n(82481),a=n(70506),i=n(87075);function s(e){return e.type===a.NOTIFICATION_RECEIVED&&"ringing"===e.payload.notificationMessage.eventType}},21779:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},21836:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_CALL=t.TURN_CHANGED=t.TRACK_REMOVED=t.TRACK_ADDED=t.SET_CUSTOM_PARAMETERS=t.SESSION_PROGRESS=t.SESSION_CREATED=t.SEND_RINGING_FEEDBACK_FINISH=t.SEND_RINGING_FEEDBACK=t.SEND_DTMF_FINISH=t.SEND_DTMF=t.SEND_CUSTOM_PARAMETERS_FINISH=t.SEND_CUSTOM_PARAMETERS=t.RESYNC_FINISH=t.RESYNC=t.REPLACE_TRACK_FINISH=t.REPLACE_TRACK=t.REMOVE_MEDIA_FINISH=t.REMOVE_MEDIA=t.REMOVE_BASIC_MEDIA=t.REMOTE_STOP_MOH_FINISH=t.REMOTE_START_MOH_FINISH=t.REMOTE_SLOW_START=t.REMOTE_REMOVE_MEDIA_FINISH=t.REMOTE_ADD_MEDIA_FINISH=t.REJECT_CALL_FINISH=t.REJECT_CALL=t.PLAY_AUDIO_FINISH=t.PLAY_AUDIO=t.PENDING_PLAY_AUDIO=t.PENDING_OPERATION=t.PENDING_MAKE_CALL=t.PENDING_JOIN=t.PENDING_CONSULTATIVE_TRANSFER=t.OPERATION_UPDATE=t.MUSIC_ON_HOLD=t.MEDIA_RESTART_FINISH=t.MEDIA_RESTART=t.MAKE_CALL_FINISH=t.MAKE_CALL=t.MAKE_ANONYMOUS_CALL_FINISH=t.MAKE_ANONYMOUS_CALL=t.JOIN_START=t.JOIN_FINISH=t.JOIN=t.IGNORE_CALL_FINISH=t.IGNORE_CALL=t.GET_STATS_FINISH=t.GET_STATS=t.GET_AVAILABLE_CODECS=t.FORWARD_CALL_FINISH=t.FORWARD_CALL=t.END_CALL_FINISH=t.END_CALL=t.DIRECT_TRANSFER_FINISH=t.DIRECT_TRANSFER=t.CUSTOM_PARAMETERS_RECEIVED=t.CONSULTATIVE_TRANSFER_FINISH=t.CONSULTATIVE_TRANSFER=t.CALL_UNHOLD_FINISH=t.CALL_UNHOLD=t.CALL_RINGING=t.CALL_REMOTE_UNHOLD_FINISH=t.CALL_REMOTE_HOLD_FINISH=t.CALL_INCOMING=t.CALL_HOLD_FINISH=t.CALL_HOLD=t.CALL_CANCELLED=t.CALL_ACCEPTED=t.AVAILABLE_CODECS_RETRIEVED=t.ANSWER_CALL_FINISH=t.ANSWER_CALL=t.ADD_MEDIA_FINISH=t.ADD_MEDIA=t.ADD_BASIC_MEDIA=void 0;const n="@@KANDY/CALL/",r=(t.MAKE_CALL=n+"MAKE",t.PENDING_MAKE_CALL=n+"PENDING_MAKE",t.SESSION_CREATED=n+"SESSION_CREATED",t.MAKE_CALL_FINISH=n+"MAKE_FINISH",t.MAKE_ANONYMOUS_CALL=n+"MAKE_ANONYMOUS_CALL",t.MAKE_ANONYMOUS_CALL_FINISH=n+"MAKE_ANONYMOUS_CALL_FINISH",t.CALL_INCOMING=n+"INCOMING",t.SEND_RINGING_FEEDBACK=n+"SEND_RINGING_FEEDBACK",t.SEND_RINGING_FEEDBACK_FINISH=n+"SEND_RINGING_FEEDBACK_FINISH",t.CALL_RINGING=n+"RINGING",t.SESSION_PROGRESS=n+"SESSION_PROGRESS",t.CALL_CANCELLED=n+"CANCELLED",t.ANSWER_CALL=n+"ANSWER",t.ANSWER_CALL_FINISH=n+"ANSWER_FINISH",t.REJECT_CALL=n+"REJECT",t.REJECT_CALL_FINISH=n+"REJECT_FINISH",t.IGNORE_CALL=n+"IGNORE",t.IGNORE_CALL_FINISH=n+"IGNORE_FINISH",t.CALL_ACCEPTED=n+"ACCEPTED",t.END_CALL=n+"END",t.END_CALL_FINISH=n+"END_FINISH",t.FORWARD_CALL=n+"FORWARD_CALL",t.FORWARD_CALL_FINISH=n+"FORWARD_CALL_FINISH",t.PENDING_OPERATION=n+"PENDING_OPERATION",t.UPDATE_CALL=n+"UPDATE_CALL",t.CALL_HOLD=n+"HOLD",t.CALL_HOLD_FINISH=n+"HOLD_FINISH",t.CALL_UNHOLD=n+"UNHOLD",t.CALL_UNHOLD_FINISH=n+"UNHOLD_FINISH",t.SET_CUSTOM_PARAMETERS=n+"SET_CUSTOM_PARAMETERS",t.SEND_CUSTOM_PARAMETERS=n+"SEND_CUSTOM_PARAMETERS",t.SEND_CUSTOM_PARAMETERS_FINISH=n+"SEND_CUSTOM_PARAMETERS_FINISH",t.ADD_MEDIA=n+"ADD_MEDIA",t.ADD_MEDIA_FINISH=n+"ADD_MEDIA_FINISH",t.ADD_BASIC_MEDIA=n+"ADD_BASIC_MEDIA",t.REMOVE_MEDIA=n+"REMOVE_MEDIA",t.REMOVE_MEDIA_FINISH=n+"REMOVE_MEDIA_FINISH",t.REMOVE_BASIC_MEDIA=n+"REMOVE_BASIC_MEDIA",t.MUSIC_ON_HOLD=n+"MUSIC_ON_HOLD",t.SEND_DTMF=n+"SEND_DTMF",t.SEND_DTMF_FINISH=n+"SEND_DTMF_FINISH",t.GET_STATS=n+"GET_STATS",t.GET_STATS_FINISH=n+"GET_STATS_FINISH",t.CONSULTATIVE_TRANSFER=n+"CONSULTATIVE_TRANSFER",t.PENDING_CONSULTATIVE_TRANSFER=n+"PENDING_CONSULTATIVE_TRANSFER",t.CONSULTATIVE_TRANSFER_FINISH=n+"CONSULTATIVE_TRANSFER_FINISH",t.DIRECT_TRANSFER=n+"DIRECT_TRANSFER",t.DIRECT_TRANSFER_FINISH=n+"DIRECT_TRANSFER_FINISH",t.JOIN=n+"JOIN",t.JOIN_START=n+"JOIN_START",t.PENDING_JOIN=n+"PENDING_JOIN",t.JOIN_FINISH=n+"JOIN_FINISH",t.REPLACE_TRACK=n+"REPLACE_TRACK",t.REPLACE_TRACK_FINISH=n+"REPLACE_TRACK_FINISH",t.MEDIA_RESTART=n+"MEDIA_RESTART",t.MEDIA_RESTART_FINISH=n+"MEDIA_RESTART_FINISH",t.RESYNC=n+"RESYNC",t.RESYNC_FINISH=n+"RESYNC_FINISH",t.PLAY_AUDIO=n+"PLAY_AUDIO",t.PENDING_PLAY_AUDIO=n+"PENDING_PLAY_AUDIO",t.PLAY_AUDIO_FINISH=n+"PLAY_AUDIO_FINISH",t.CUSTOM_PARAMETERS_RECEIVED=n+"CUSTOM_PARAMETERS_RECEIVED",t.GET_AVAILABLE_CODECS=n+"GET_AVAILABLE_CODECS",t.AVAILABLE_CODECS_RETRIEVED=n+"AVAILABLE_CODECS_RETRIEVED",t.OPERATION_UPDATE=n+"OPERATION_UPDATE",t.CALL_REMOTE_HOLD_FINISH=n+"REMOTE_HOLD_FINISH",t.CALL_REMOTE_UNHOLD_FINISH=n+"REMOTE_UNHOLD_FINISH",t.REMOTE_ADD_MEDIA_FINISH=n+"REMOTE_ADD_MEDIA_FINISH",t.REMOTE_REMOVE_MEDIA_FINISH=n+"REMOTE_REMOVE_MEDIA_FINISH",t.REMOTE_START_MOH_FINISH=n+"REMOTE_START_MOH_FINISH",t.REMOTE_STOP_MOH_FINISH=n+"REMOTE_STOP_MOH_FINISH",t.REMOTE_SLOW_START=n+"REMOTE_SLOW_START",n+"TURN/"),o=(t.TURN_CHANGED=r+"CHANGED",n+"TRACK/");t.TRACK_ADDED=o+"ADDED",t.TRACK_REMOVED=o+"REMOVED"},21843:(e,t,n)=>{"use strict";var r=n(16881),o=n(74418),a=n(10380),i=n(81458).indexOf,s=n(67588),c=r([].push);e.exports=function(e,t){var n,r=a(e),l=0,u=[];for(n in r)!o(s,n)&&o(r,n)&&c(u,n);for(;t.length>l;)o(r,n=t[l++])&&(~i(u,n)||c(u,n));return u}},21981:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const i=(0,a.getCallById)(e,t);return i?i.state!==o.CALL_STATES.CONNECTED?new r.default({code:r.callCodes.INVALID_STATE,message:`Invalid call state: ${i.state}. It should be: ${o.CALL_STATES.CONNECTED}.`}):1!==n.length?new r.default({code:r.callCodes.INVALID_PARAM,message:"Must have only one track for basic scenario!"}):void 0:new r.default({code:r.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),o=n(77126),a=n(40481)},22053:e=>{e.exports=function(e){return e}},22191:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notificationTypes=t.SUBSCRIPTION_STATE=t.OPERATIONS=t.MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL=t.CHANGE_REASONS=void 0,t.SUBSCRIPTION_STATE={FULL:"FULL",PARTIAL:"PARTIAL",NONE:"NONE"},t.CHANGE_REASONS={GONE:"GONE",LOST_CONNECTION:"LOST_CONNECTION",WS_OVERRIDDEN:"WS_OVERRIDDEN"},t.OPERATIONS={SUBSCRIBE:"SUBSCRIBE",UNSUBSCRIBE:"UNSUBSCRIBE"},t.notificationTypes={WEBSOCKET:"websocket",PUSH:"push"},t.MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL=6e4},22202:(e,t,n)=>{var r=n(92673)("isElement",n(59191),n(76648));r.placeholder=n(22991),e.exports=r},22507:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpidrServices=function(e,t){const n=t.map(e=>e.toUpperCase()),o=e.filter(function(e){return-1===n.indexOf(e.toUpperCase())}),a={requested:e,received:t,missing:o,status:"UNKNOWN",services:{}};return 0===t.length?a.status=r.SUBSCRIPTION_STATE.NONE:t.length>0&&o.length>0?a.status=r.SUBSCRIPTION_STATE.PARTIAL:t.length>0&&e.length===t.length&&(a.status=r.SUBSCRIPTION_STATE.FULL),t.forEach(function(e){a.services[e]=!0}),o.forEach(function(e){a.services[e]=!1}),a},n(81045),n(30163),n(5350),n(84915);var r=n(22191)},22612:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllPresence=function(e){return Object.values(e.presence.users)},t.getPresence=function(e,t){return t?Object.values(e.presence.users).filter(e=>-1!==t.indexOf(e.userId)):e.presence.users},t.getSelfPresence=function(e){return e.presence.self},n(81045),n(30163)},22966:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,o.default)(i,e);return(0,a.parse)("notifications",s)(t),t};var r,o=(r=n(1036))&&r.__esModule?r:{default:r},a=n(52932);const i={idCacheLength:100,incomingCallNotificationMode:"any-channel"},s=a.validation.schema({idCacheLength:a.validation.positive(),incomingCallNotificationMode:(0,a.enums)(["any-channel","push-channel-only"]),pushRegistration:a.validation.optional(a.validation.schema({server:a.validation.string(),port:a.validation.string(),protocol:a.validation.string(),version:a.validation.string()}))})},22991:e=>{e.exports={}},23212:(e,t,n)=>{var r=n(68250),o=n(1877),a=n(8006);function i(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}i.prototype.add=i.prototype.push=o,i.prototype.has=a,e.exports=i},23305:(e,t,n)=>{var r=n(94497);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},23315:(e,t,n)=>{"use strict";var r=n(96893),o=n(5234);e.exports=r&&o(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},23504:(e,t,n)=>{var r=n(4977),o=n(85755),a=n(3816),i=n(64364),s=n(34216),c=n(36850),l=n(26591),u=n(8813),d=n(78942);e.exports=function e(t,n,f,p,g,_,E,y,S,v){var h=128&n,T=1&n,C=2&n,I=24&n,m=512&n,O=C?void 0:i(t);return function A(){for(var R=arguments.length,b=Array(R),N=R;N--;)b[N]=arguments[N];if(I)var M=c(A),w=a(b,M);if(p&&(b=r(b,p,g,I)),_&&(b=o(b,_,E,I)),R-=w,I&&R<v){var P=u(b,M);return s(t,n,e,A.placeholder,f,b,P,y,S,v-R)}var L=T?f:this,D=C?L[t]:t;return R=b.length,y?b=l(b,y):m&&R>1&&b.reverse(),h&&S<R&&(b.length=S),this&&this!==d&&this instanceof A&&(D=O||i(D)),D.apply(L,b)}}},23727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionRequests.subscribe",t=>(0,r.default)(e.container)),e.factory("SubscriptionOperations.subscribe",t=>(0,o.default)(e.container))};var r=a(n(78641)),o=a(n(34189));function a(e){return e&&e.__esModule?e:{default:e}}},23904:e=>{e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},23945:(e,t,n)=>{var r=n(22053),o=n(75234),a=n(80796);e.exports=function(e,t){return a(o(e,t,r),e+"")}},24011:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.factory("PresenceOperations",i.default),e.factory("PresenceRequests",s.default),{api:function(e){const t=(0,o.default)(e);return t.presence.statuses=c.STATUS,t.presence.activities=c.ACTIVITY,t},capabilities:["presence"],middleware:a.default,name:r.name,reducer:r.reducer}};var r=n(54974),o=l(n(52502)),a=l(n(44511)),i=l(n(93449)),s=l(n(73129)),c=n(86606);function l(e){return e&&e.__esModule?e:{default:e}}n(12291)},24072:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(4564))&&r.__esModule?r:{default:r};t.default=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},24367:(e,t,n)=>{var r=n(67267),o=n(81211);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var a=t[n],i=e[a];t[n]=[a,i,r(i)]}return t}},24638:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.instanceFactory("Callstack.models.Update",(t,n,c)=>{!function(e,t){const{validate:n,localOffer:r,remoteOffer:o}=t;if(e&&!Boolean(n)&&!Boolean(r))throw new Error("Missing local stage for Update operation.");if(!e&&!o)throw new Error("Missing remote stage for Update operation.")}(n.isLocal,n.stages);const l=n.createFlow??(n.isLocal?o.default:a.createGeneric),{type:u,isLocal:d,stages:f}=n,p=(0,s.v4)(),{callId:g,data:_}=c,E=i.REPORTER_OPERATION_EVENTS_MAP[u+(d?"_LOCAL":"_REMOTE")]||i.REPORTER_OPERATION_EVENTS_MAP[u],y=e.container.CallReporter.getReport(g).addEvent(E);n.isNegotiation=!1;const S=(0,r.default)(e.container,g,p,y.id,n),v={type:u,isNegotiation:!1,isLocal:d,start:void 0,callId:g,id:p,data:{..._},tracker:S,get status(){return S.status},reportEvent:y},h=l(e.container,v,f);return Object.assign(v,h),v})},n(97107);var r=c(n(3226)),o=c(n(89536)),a=n(46883),i=n(84581),s=n(84596);function c(e){return e&&e.__esModule?e:{default:e}}},24642:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,TimerTracker:n}=e;t.getLogger("PROXY").info("Cleaning up webrtcProxy plugin"),n.clearAllByType("webrtcProxy")}},24679:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iceCollectionCheckFunction=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;const{iceCollectionDuration:n,iceCandidates:r,iceGatheringState:i,rtcPeerConnectionConfig:s,rtcLocalSessionDescription:c}=e,{iceCollectionIdealTimeout:l,iceCollectionMaxTimeout:u}=t;if("complete"===i)return 0===r.length?{type:o.ICE_COLLECTION_RESULT_TYPES.ERROR,error:"No ICE candidates available for call to proceed."}:{type:o.ICE_COLLECTION_RESULT_TYPES.START_CALL};if(n<l){let e=0;(s.rtcConfig.iceServers||[]).forEach(t=>{Array.isArray(t.urls)?e+=t.urls.filter(e=>e.startsWith("turn")).length:"string"==typeof t.urls&&t.urls.startsWith("turn")&&(e+=1)});const t=r.filter(e=>"rtp"===e.component&&"relay"===e.type);return a.default.parse(c.sdp).media.every(n=>t.filter(e=>parseInt(e.sdpMid)===n.mid||e.sdpMid===n.mid).length>=e)&&e?{type:o.ICE_COLLECTION_RESULT_TYPES.START_CALL}:{type:o.ICE_COLLECTION_RESULT_TYPES.WAIT,wait:l-n}}if(n<u){const e=r.filter(e=>"rtp"===e.component&&"relay"===e.type);return a.default.parse(c.sdp).media.every(t=>e.filter(e=>parseInt(e.sdpMid)===t.mid||e.sdpMid===t.mid).length>=1)?{type:o.ICE_COLLECTION_RESULT_TYPES.START_CALL}:{type:o.ICE_COLLECTION_RESULT_TYPES.WAIT,wait:u-n}}return 0===r.length?{type:o.ICE_COLLECTION_RESULT_TYPES.ERROR,error:"No ICE candidates available for call to proceed."}:{type:o.ICE_COLLECTION_RESULT_TYPES.START_CALL}},n(81045),n(42042),n(30163),n(5350);var r,o=n(77126),a=(r=n(54722))&&r.__esModule?r:{default:r}},24733:(e,t,n)=>{var r=n(39032),o=n(85832);e.exports=function(e,t){return r(e,o(e),t)}},24810:(e,t,n)=>{var r=n(57073),o=n(46285);e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},25098:(e,t,n)=>{var r=n(23305),o=n(39361),a=n(11112),i=n(25276),s=n(57452);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=i,c.prototype.set=s,e.exports=c},25276:(e,t,n)=>{var r=n(94497),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},25288:(e,t,n)=>{var r=n(10358),o=n(57200),a=n(36529);e.exports=function(e){return a(e)?r(e,!0):o(e)}},25629:(e,t,n)=>{"use strict";var r=n(21843),o=n(61274).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},25654:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.sendDtmf",()=>({local:{validate:o.default,localOffer:(0,r.default)(e.container)}})),e.factory("Callstack.operations.sendDtmf",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.SEND_DTMF,isLocal:!0,stages:e.container.Callstack.stages.sendDtmf.local},{callId:n})}}})};var r=i(n(51025)),o=i(n(72802)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},25666:(e,t,n)=>{e.exports=n(22991)},25939:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateDestination=function(e){return e?"string"!=typeof e?new r.default({message:"Incorrect destination type.",code:r.callCodes.INVALID_PARAM}):void 0:new r.default({message:"No destination provided.",code:r.callCodes.INVALID_PARAM})};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},26021:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t){await a(e,t)}},t.signalling=a;var r=n(40481),o=n(77126);async function a(e,t){const{context:n,CallRequests:a,logManager:i}=e,s=i.getLogger("CALL",t);s.info("Sending ringing feedback for incoming call.");const c=(0,r.getCallById)(n.getState(),t),l={wrtcsSessionId:c.wrtcsSessionId,id:c.id};try{await a.updateCallRinging(l)}catch(e){throw s.info(`Failed to send ringing feedback: ${e.code}: ${e.message}`),e}s.info(`Ringing feedback sent. Changing call to ${o.CALL_STATES.RINGING} state.`)}},26137:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},26387:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const i=(0,r.getCallById)(e,t);return i?i.state!==o.CALL_STATES.ON_HOLD?new a.default({code:a.callCodes.INVALID_STATE,message:`Call is in an invalid state: state=${i.state}. It should be: state=${o.CALL_STATES.ON_HOLD}.`}):void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"Cannot direct transfer call: Invalid call ID."})};var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},26591:(e,t,n)=>{var r=n(84354),o=n(69632),a=Math.min;e.exports=function(e,t){for(var n=e.length,i=a(t.length,n),s=r(e);i--;){var c=t[i];e[i]=o(c,n)?s[c]:void 0}return e}},26662:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,a.default)(t);e.defer(function(e){const{context:t}=e;t.dispatch((0,c.update)(n,r.name))});for(const t in i)i[t](e);return e.factory("NotificationRequests",s.default),{api:r.createAPI,capabilities:["push","registerPushNotifications","externalNotifications"],middleware:(0,o.default)(e),name:r.name,reducer:r.reducer}};var r=n(9617),o=l(n(76765)),a=l(n(22966));n(14990);var i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(325)),s=l(n(60530)),c=n(87310);function l(e){return e&&e.__esModule?e:{default:e}}},26672:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=o.logManager.getLogger("ACTION");t.setHandler(e.logActions.handler),t.setLevel(e.logActions.level);let n={};var r;a.logLevels[e.logLevel]===a.logLevels.INFO?(n.level=!1,n.diff=!1):n={...e.logActions},e.logActions.actionOnly&&(n.level={prevState:!1,action:"info",error:"info",nextState:!1}),e.logActions.excludeActions&&(n.predicate=(r=e.logActions.excludeActions,(e,t)=>!r.includes(t.type))),n.logger=t,n.titleFormatter=s.titleFormatter,n.colors=!1;const l=(0,i.default)(e.logActions);return(0,c.createLogger)({...n,...l})},n(62234);var r,o=n(69932),a=n(75188),i=(r=n(30106))&&r.__esModule?r:{default:r},s=n(28009),c=n(17783)},26719:(e,t,n)=>{"use strict";var r=n(38689);e.exports=Array.isArray||function(e){return"Array"===r(e)}},26885:(e,t,n)=>{var r=n(24810),o=n(17099),a=n(92264),i=n(84354),s=n(75964),c=n(3283),l=n(53142),u=n(65406),d=n(75853),f=n(93655),p=n(41580),g=n(48360),_=n(8666),E=n(78763),y=n(64207);e.exports=function(e,t,n,S,v,h,T){var C=E(e,n),I=E(t,n),m=T.get(I);if(m)r(e,n,m);else{var O=h?h(C,I,n+"",e,t,T):void 0,A=void 0===O;if(A){var R=l(I),b=!R&&d(I),N=!R&&!b&&_(I);O=I,R||b||N?l(C)?O=C:u(C)?O=i(C):b?(A=!1,O=o(I,!0)):N?(A=!1,O=a(I,!0)):O=[]:g(I)||c(I)?(O=C,c(C)?O=y(C):p(C)&&!f(C)||(O=s(I))):A=!1}A&&(T.set(I,O),v(O,I,S,h,T),T.delete(I)),r(e,n,O)}}},26909:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t}=e;return{localChanges:(t,n,r)=>d(e,t,n,r),signalling:async(n,r,o)=>{try{const{remoteTracks:a}=await f(e,n,o);t.dispatch(l.callActions.updateCall(n.id,{remote:!0,remoteParticipant:{displayNumber:r.remoteNumber,displayName:r.remoteName},remoteTracks:a}))}catch(e){throw t.dispatch(l.callActions.updateCall(n.id,{remote:!0,error:e})),e}}}},t.localChanges=d,t.signalling=f,n(97107),n(62234);var r=n(48151),o=u(n(29819)),a=u(n(11876)),i=n(70949),s=n(73520),c=n(77126),l=n(35);function u(e){return e&&e.__esModule?e:{default:e}}async function d(e,t,n,r){const{WebRTC:l,CallstackWebrtc:u,CallstackSDP:d,logManager:f}=e,p=f.getLogger("CALL",t.id),g=await l.sessionManager.get(t.webrtcSessionId);if(!g)throw p.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);const _=(0,s.getMediaState)(t);if((0,a.default)(n.sdp)&&[c.CALL_MEDIA_STATES.DUAL_HOLD,c.CALL_MEDIA_STATES.LOCAL_HOLD].includes(_)){if(p.debug("Modifying remote offer to prevent resetting media while in local hold."),n.sdp=(0,o.default)(n.sdp),!n.sdp)return void p.debug("SDP is either undefined or not a string.");r.mediaDiff=d.compareMedia(r.remoteDesc.sdp,n.sdp,!0)}let E=!1;const y=await(0,i.isSameSdpSessionId)(l,t.webrtcSessionId,n.sdp);let S;y||(p.debug(`Received offer SDP is from a different session. Recreating Peer for call ${t.id}.`),E=!0),n.sdp.includes("setup:active")&&(p.debug(`Received offer SDP with active role for call ${t.id}. Changing.`),n.sdp=n.sdp.replace(/setup:active/g,"setup:actpass"));try{S=await u.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth,E)}catch(e){throw p.debug("Failed to receive offer SDP.",e),e}return{answer:S,sameSession:y,session:g}}async function f(e,t,n){const{CallRequests:o,logManager:a}=e,{answer:i,sameSession:s,session:c}=n,l=a.getLogger("CALL",t.id);try{await o.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:i.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies});let e=[];return s||(e=await(0,r.getAllRemoteTracks)(c)),{remoteTracks:e}}catch(e){throw l.info("Failed to respond to remote offer with an answer."),e}}},27003:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:i}=e,s=n.getLogger("NOTIFICATIONS");var c=[];return async function(e,n){const l=(0,r.getNotificationConfig)(t.getState()),u=e.notificationMessage,d=u.eventId,f=(0,r.getNotificationsInfo)(t.getState(),n);if(f.channelEnabled)if(s.info(`Received notification of type ${u.eventType}.`),"call"===e.notificationMessage.eventType&&"push-channel-only"===l.incomingCallNotificationMode&&"PUSH"!==f)s.warn("Dropped incoming call notification with id: "+d+" received through channel: "+f+" because current mode for handling notifications is set to: push-channel-only.");else{if((0===l.idCacheLength?[]:c.slice(-1*l.idCacheLength)).includes(d)){s.info("Notification was a duplicate; ignoring.");const e=new Error(`Notification id ${d} is duplicate.`);throw t.dispatch(o.processNotificationFinish(e)),e}for(c.push(d);c.length>l.idCacheLength;)c.shift();t.dispatch(o.notificationReceived(e,n)),i(a.NOTI_RECEIVED,{payload:{...e}})}else s.info(`Received notification of type ${u.eventType} on disabled channel: ${n}. Ignoring it.`)}},n(97107),n(62234),n(69375);var r=n(82803),o=i(n(50130)),a=i(n(99644));function i(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(i=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},27030:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n,r){await l(e,t,n)}},t.localChanges=l;var r=n(35),o=n(40481),a=n(51918),i=n(59090),s=n(77126),c=n(84581);async function l(e,t,n,l){const{context:u,CallRequests:d,Callstack:f,emitEvent:p,CallReporter:g,logManager:_}=e,{setupIncomingCall:E}=f.utils,{sdp:y,callId:S}=n,v=(0,o.getOptions)(u.getState()),h=g.getReport(S).findLastOngoingEvent(c.REPORT_EVENTS.RECEIVE_CALL),T=_.getLogger("CALL",S);if(y){h.addData("isSlowStart",!1);const e=(0,o.getTurnInfo)(u.getState());try{await E({offer:{sdp:y,type:"offer"},trickleIceMode:v.trickleIceMode,defaultPeerConfig:v.defaultPeerConfig,turnInfo:e,callId:S,removeBundling:v.removeBundling,serverTurnCredentials:v.serverTurnCredentials})}catch(e){throw T.info(`Failed to initiate incoming call. Changing to ${s.CALL_STATES.ENDED}.`),u.dispatch(r.callActions.endCallFinish(S,{isLocal:!0,error:{error:e}})),p(a.CALL_OPERATION,{callId:S,isLocal:!0,operation:i.OPERATIONS.END,transition:i.OP_TRANSITIONS.FINISH,error:{error:e}}),p(a.CALL_STATE_CHANGE,{callId:S,previous:{state:s.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1},error:{error:e}}),e}}else T.debug("Incoming call is a slow-start call."),h.addData("isSlowStart",!0);let C=s.CALL_STATES.INITIATED;if("auto"===v.ringingFeedbackMode){T.info("Sending ringing feedback automatically for incoming call.");const e={wrtcsSessionId:t,id:S};try{await d.updateCallRinging(e),T.debug("Successfully sent ringing feedback."),C=s.CALL_STATES.RINGING}catch(e){T.info(`Failed to send ringing feedback - ${e.code}: ${e.message} `)}}T.info(`Finished initiating incoming call. Changing to ${C} and waiting on local answer.`),u.dispatch(r.callActions.updateCall(S,{state:C})),p(a.CALL_STATE_CHANGE,{callId:S,previous:{state:s.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1}})}},27137:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,log:n}=this;return t.oniceconnectionstatechange=function(r){n.debug(`Peer received iceconnectionstatechange event: ${t.iceConnectionState}`),e(r)},!0}},27177:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,emitEvent:n,context:i,AuthenticationOperations:s,API_LOG_TAG:c}=e,l=t.getLogger("AUTH");return{getUserInfo:function(){return l.debug(c+"getUserInfo"),(0,o.getUserInfo)(i.getState())},disconnectReasons:a.CHANGE_REASONS,setCredentials:function(e){let{username:t,password:o,authname:a,hmacToken:i,bearerAccessToken:u}=e;l.debug(c+"setCredentials: ",t);try{s.setCredentials({username:t,password:o,authname:a,hmacToken:i,bearerAccessToken:u})}catch(e){return void n(r.AUTH_ERROR,{error:e})}n(r.AUTH_CHANGE,{})},setCredentialsAsync:function(e){let{username:t,password:n,authname:r,hmacToken:o,bearerAccessToken:a}=e;l.debug(c+"setCredentialsAsync: ",t),s.setCredentials({username:t,password:n,authname:r,hmacToken:o,bearerAccessToken:a})}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(9516)),o=n(87075),a=n(22191)},27276:(e,t,n)=>{var r=n(43636),o=n(85899);e.exports=function(e,t){return null!=e&&o(e,t,r)}},27388:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,r=t.getLogger("SUBSCRIPTION");return async function(e){const t={method:"DELETE"};t.endpoint=`subscription/${e.split("/subscription/")[1]}`;const a=await n(t),{body:i,error:s,result:c}=a;if(s){if(i&&i.subscribeResponse){const{statusCode:e}=i.subscribeResponse;throw r.debug(`Encountered error unsubscribing user with status code ${e}.`),new o.default({message:`Failed to unsubscribe. Status Code: ${e}`,code:e})}{const{message:e,code:t}=c;throw r.debug("Encountered error unsubscribing user.",e),new o.default({message:e,code:t})}}r.debug("User unsubscribed successfully.")}};var r,o=(r=n(75412))&&r.__esModule?r:{default:r}},27420:e=>{"use strict";e.exports=function(e){try{var t=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}},r=t[e](n);return 1===r.size&&4===r.values().next().value}catch(e){return!1}}},27470:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processMwi=function(e){let{time:t=Date.now(),data:n={}}=e;const{mwi:r,totalVoice:o="0",unheardVoice:a="0"}=n;return delete n.mwi,delete n.statusCode,{...n,newMessagesWaiting:"yes"===r,lastUpdated:t,totalVoice:o,unheardVoice:a}}},27748:(e,t,n)=>{var r=n(92673)("reverse",n(6609));r.placeholder=n(22991),e.exports=r},28009:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.titleFormatter=function(e,t,n){var r=["action"];return r.push(e.type),r.push("@ "+t),r.push("(in "+n.toFixed(2)+" ms)"),r.join(" ")},n(69375)},28088:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n}=e,a="DEFAULT";return{setLogLevel:function(e,i){i&&i!==a?(n.setLevel(i,e),n.getLoggers(i).forEach(t=>{t.setLevel(e)}),t.dispatch(r.levelsChanged({[i]:e}))):(n.setLevel(e),n.getLoggers().forEach(t=>{t.setLevel(e)}),t.dispatch(r.levelsChanged((0,o.getLevelMap)(n))))},setLogHandler:function(e,i){i&&i!==a?(n.setHandler(i,e),n.getLoggers(i).forEach(t=>{t.setHandler(e)}),t.dispatch(r.handlersChanged({[i]:e}))):(n.setHandler(e),n.getLoggers().forEach(t=>{t.setHandler(e)}),t.dispatch(r.handlersChanged((0,o.getHandlerMap)(n))))}}},n(81045),n(5350);var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(45183)),o=n(28445)},28146:(e,t,n)=>{"use strict";var r=n(4282),o=n(49164),a=r("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||i[a]===e)}},28445:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandlerMap=function(e){const t=e.getLoggers(),n=[...new Set(t.map(e=>e.type))],o={};return o[r]=e.getHandler(),n.forEach(t=>{o[t]=e.getHandler(t)}),o},t.getLevelMap=function(e){const t=e.getLoggers(),n=[...new Set(t.map(e=>e.type))],o={};return o[r]=e.getLevel(),n.forEach(t=>{o[t]=e.getLevel(t)}),o},n(69033),n(68903),n(21018),n(1415),n(4448),n(58871),n(56539),n(81045),n(84915);const r="DEFAULT"},28450:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.sendCallAudit",()=>(0,o.default)(e.container).sendCallAudit)};var r,o=(r=n(99051))&&r.__esModule?r:{default:r}},28486:(e,t,n)=>{var r=n(33103),o=n(19770),a=n(89413),i=n(64512),s=n(19270),c=n(87379),l=n(64066),u="[object Map]",d="[object Promise]",f="[object Set]",p="[object WeakMap]",g="[object DataView]",_=l(r),E=l(o),y=l(a),S=l(i),v=l(s),h=c;(r&&h(new r(new ArrayBuffer(1)))!=g||o&&h(new o)!=u||a&&h(a.resolve())!=d||i&&h(new i)!=f||s&&h(new s)!=p)&&(h=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case _:return g;case E:return u;case y:return d;case S:return f;case v:return p}return t}),e.exports=h},28605:e=>{"use strict";var t="%[a-f0-9]{2}",n=new RegExp("("+t+")|([^%]+?)","gi"),r=new RegExp("("+t+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],o(n),o(r))}function a(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(n)||[],r=1;r<t.length;r++)t=(e=o(t,r).join("")).match(n)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var o=a(n[0]);o!==n[0]&&(t[n[0]]=o)}n=r.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),s=0;s<i.length;s++){var c=i[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},28686:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_CONTACT_FINISH=t.UPDATE_CONTACT=t.SEARCH_DIRECTORY_FINISH=t.SEARCH_DIRECTORY=t.REMOVE_CONTACT_FINISH=t.REMOVE_CONTACT=t.REFRESH_CONTACTS_FINISH=t.REFRESH_CONTACTS=t.FETCH_USER_FINISH=t.FETCH_USER=t.FETCH_CONTACT_FINISH=t.FETCH_CONTACT=t.ADD_CONTACT_FINISH=t.ADD_CONTACT=void 0;const n="@@KANDY/";t.ADD_CONTACT=n+"ADD_CONTACT",t.ADD_CONTACT_FINISH=n+"ADD_CONTACT_FINISH",t.REFRESH_CONTACTS=n+"REFRESH_CONTACTS",t.REFRESH_CONTACTS_FINISH=n+"REFRESH_CONTACTS_FINISH",t.REMOVE_CONTACT=n+"REMOVE_CONTACT",t.REMOVE_CONTACT_FINISH=n+"REMOVE_CONTACT_FINISH",t.UPDATE_CONTACT=n+"UPDATE_CONTACT",t.UPDATE_CONTACT_FINISH=n+"UPDATE_CONTACT_FINISH",t.FETCH_CONTACT=n+"FETCH_CONTACT",t.FETCH_CONTACT_FINISH=n+"FETCH_CONTACT_FINISH",t.FETCH_USER=n+"FETCH_USER",t.FETCH_USER_FINISH=n+"FETCH_USER_FINISH",t.SEARCH_DIRECTORY=n+"SEARCH_DIRECTORY",t.SEARCH_DIRECTORY_FINISH=n+"SEARCH_DIRECTORY_FINISH"},28774:(e,t,n)=>{var r=n(2478);e.exports=function(e,t){for(var n=e.length;n--&&r(t,e[n],0)>-1;);return n}},28851:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.runPipeline=l,n(81045),n(5350);var r=s(n(30524)),o=s(n(90283)),a=s(n(89321)),i=s(n(54722));function s(e){return e&&e.__esModule?e:{default:e}}const c=n(40271).logManager.getLogger("SdpPipeline");function l(e,t,n){const s=i.default.parse(t),l=Object.freeze(s);let u=(0,a.default)(l);return(0,o.default)(e)&&e.forEach(e=>{(0,r.default)(e)?u=e(u,n,l):c.error("SDP handler not a function; skipping.")}),i.default.write(u)}t.default=function(){let e=[];return{run:function(){let t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return l((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).concat(e),t,n)},setHandlers:function(t){(0,o.default)(t)&&(e=e.concat(t))},getHandlers:function(){return e}}}()},28931:(e,t,n)=>{var r=n(73501);e.exports=function(e,t,n){var o=e.length;return n=void 0===n?o:n,!t&&n>=o?e:r(e,t,n)}},29005:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},29072:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.reject",()=>({local:{validate:o.default,localOffer:()=>{},signalling:(0,r.default)(e.container)}})),e.factory("Callstack.operations.reject",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.REJECT,isLocal:!0,stages:e.container.Callstack.stages.reject.local},{callId:n})}}})};var r=i(n(97769)),o=i(n(54728)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},29127:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operationMap=t.notificationMap=void 0;var r=n(59090);t.operationMap={[r.OPERATIONS.MAKE]:"make",[r.OPERATIONS.MAKE_ANONYMOUS]:"makeAnonymousCall",[r.OPERATIONS.ANSWER]:"answer",SLOW_ANSWER:"answerSlow",[r.OPERATIONS.REJECT]:"reject",[r.OPERATIONS.IGNORE]:"ignore",[r.OPERATIONS.FORWARD_CALL]:"forward",[r.OPERATIONS.END]:"end",[r.OPERATIONS.DIRECT_TRANSFER]:"directTransfer",[r.OPERATIONS.CONSULTATIVE_TRANSFER]:"consultativeTransfer",[r.OPERATIONS.JOIN]:"join",[r.OPERATIONS.HOLD]:"hold",[r.OPERATIONS.UNHOLD]:"unhold",[r.OPERATIONS.ADD_MEDIA]:"addMedia",[r.OPERATIONS.REMOVE_MEDIA]:"removeMedia",[r.OPERATIONS.ADD_BASIC_MEDIA]:"addBasicMedia",[r.OPERATIONS.REMOVE_BASIC_MEDIA]:"removeBasicMedia",[r.OPERATIONS.REPLACE_TRACK]:"replaceTrack",[r.OPERATIONS.MEDIA_RESTART]:"iceRestart",[r.OPERATIONS.RESYNC]:"resyncCallState",[r.OPERATIONS.PLAY_AUDIO]:"playAudioFile",[r.OPERATIONS.SEND_RINGING_FEEDBACK]:"sendRingingFeedback",[r.OPERATIONS.SEND_CUSTOM_PARAMETERS]:"sendCustomParameters",[r.OPERATIONS.SEND_DTMF]:"sendDtmf",[r.OPERATIONS.GET_STATS]:"getStats",[r.OPERATIONS.GET_AVAILABLE_CODECS]:"getAvailableCodecs",[r.OPERATIONS.START_MOH]:"startMOH",[r.OPERATIONS.STOP_MOH]:"stopMOH",[r.OPERATIONS.SLOW_START]:"slowStart",UNKNOWN:"genericRemote",NO_CHANGE:"genericRemote",[r.OPERATIONS.GENERIC_REMOTE]:"genericRemote"},t.notificationMap={CALL_STATUS_ENDED:"callStatusUpdateEnded",CALL_CANCELLED:"callCancelled",CALL_STATUS_RINGING:"callStatusUpdateRinging",CALL_STATUS_FAILED:"callStatusUpdateFailed",RECEIVE_EARLY_MEDIA:"receiveEarlyMedia",SESSION_STATUS_ENDED:"sessionStatusUpdateEnded"}},29259:(e,t,n)=>{var r=n(48360);e.exports=function(e){return r(e)?void 0:e}},29749:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const{context:s,emitEvent:c,logManager:l}=e;return{start:async function(e,u,d){const f=l.getLogger("CALL",e?e.id:void 0);if(f.info("Received new update call request; handling.",{wrtcsSessionId:e.wrtcsSessionId}),d.customParameters){const t=d.customParameters,n=t.map(e=>e.name);f.debug(`Received custom parameters as part of the Call: ${n}.`),s.dispatch(o.callActions.customParametersReceived(e.id,{customParameters:t})),c(r.CUSTOM_PARAMETERS,{callId:e.id,customParameters:t})}return await async function(e,r,o){const c=l.getLogger("CALL",e.id);t.tracker.start(),e=(0,a.getCallById)(s.getState(),e.id);try{const a=(0,i.getMediaState)(e);c.info(`Processing update request as remote ${r.remoteOp} operation in ${a} scenario.`);const s=await n.remoteOffer(e,o,r);t.tracker.update(s),await n.signalling(e,o,s)}catch(e){throw t.reportEvent.setError(e),t.reportEvent.endEvent(),t.tracker.finish(e),e}t.reportEvent.endEvent(),t.tracker.finish()}(e,u,d)}}},n(81045),n(84915);var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),o=n(35),a=n(40481),i=n(73520)},29799:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=(0,o.default)(t);for(const t in a)a[t](e);for(const t in i)i[t](e);return e.factory("SubManager",()=>(0,s.default)(e.container)),e.defer(function(e){e.context.dispatch((0,c.update)(t,r.name))}),{api:r.createAPI,capabilities:["subscription"],reducer:r.reducer,name:r.name}};var r=n(57946),o=u(n(18669)),a=l(n(32255)),i=l(n(52118)),s=u(n(38254));n(60431);var c=n(87310);function l(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}function u(e){return e&&e.__esModule?e:{default:e}}},29800:(e,t,n)=>{"use strict";var r=n(16881),o=n(37032),a=n(33243),i=a.Set,s=a.proto,c=r(s.forEach),l=r(s.keys),u=l(new i).next;e.exports=function(e,t,n){return n?o({iterator:l(e),next:u},t):c(e,t)}},29819:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e&&"string"==typeof e)return e.replace(/sendrecv|sendonly|recvonly/gi,"inactive")}},29834:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(38010))&&r.__esModule?r:{default:r};t.default={createAPI:o.default,name:"events"}},29889:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messageActions=t.convoActions=void 0;var r=a(n(89129)),o=a(n(40593));function a(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(a=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}t.messageActions=r,t.convoActions=o},29962:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSipEventInfo=function(e,t){return t?(0,o.default)(e.sipEvents[t]):(0,o.default)(e.sipEvents)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},29975:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(4564))&&r.__esModule?r:{default:r};t.default=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}},3e4:(e,t,n)=>{var r=n(92673)("unionBy",n(74133));r.placeholder=n(22991),e.exports=r},30106:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t={},n=[];return e.exposePayloads?n.push(a):n.push(i),t.actionTransformer=function(e){return function(t){return e.forEach(function(e){t=e(t)}),t}}(n),t},n(69375),n(81045),n(5350);var r,o=(r=n(14017))&&r.__esModule?r:{default:r};function a(e){return e.meta&&e.meta.isSensitive?(0,o.default)("payload",e):e}function i(e){return e.meta&&e.meta.isSafe?e:(0,o.default)("payload",e)}},30125:(e,t,n)=>{var r=n(39032),o=n(25288);e.exports=function(e,t){return e&&r(t,o(t),e)}},30156:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},30163:(e,t,n)=>{"use strict";n(12266)},30186:(e,t,n)=>{var r=n(92673)("values",n(39817),n(76648));r.placeholder=n(22991),e.exports=r},30290:(e,t,n)=>{"use strict";var r=n(39944),o=n(80831),a=n(6032),i=n(12913),s=n(2287),c=n(4282),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!o(e)||a(e))return e;var n,c=i(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!o(n)||a(n))return n;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},30373:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.answer",()=>{const t=(0,r.default)(e.container);return{local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling}}}),e.factory("Callstack.stages.answerSlow",()=>{const t=(0,a.default)(e.container);return{local:{validate:i.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,s.default)(e.container),rollback:t.rollback}}}),e.factory("Callstack.operations.answer",()=>{const t=e.container.Callstack,n=t.models.Update;return{local:function(e){return n.instance({type:l.OPERATIONS.ANSWER,isLocal:!0,stages:t.stages.answer.local},{callId:e})}}}),e.factory("Callstack.operations.answerSlow",()=>{const t=e.container.Callstack,n=t.models.Negotiation;return{local:function(e,r){return n.instance({type:l.OPERATIONS.ANSWER,isLocal:!0,stages:t.stages.answerSlow.local},{callId:e,deferred:r})}}}),e.factory("Callstack.utils.answerWebrtcSession",()=>(0,c.default)(e.container))};var r=u(n(51471)),o=u(n(40839)),a=u(n(48444)),i=u(n(87481)),s=u(n(5146)),c=u(n(35680)),l=n(59090);function u(e){return e&&e.__esModule?e:{default:e}}},30524:(e,t,n)=>{var r=n(92673)("isFunction",n(93655),n(76648));r.placeholder=n(22991),e.exports=r},30744:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,r.factory)(t,e)};var r=n(37984)},30795:(e,t,n)=>{var r=n(96576),o=n(23945),a=n(65406),i=o(function(e,t){return a(e)?r(e,t):[]});e.exports=i},30802:(e,t,n)=>{const r=n(59246);function o(e,t){return function(n){return t(e(n))}}function a(e,t){const n=[t[e].parent,e];let a=r[t[e].parent][e],i=t[e].parent;for(;t[i].parent;)n.unshift(t[i].parent),a=o(r[t[i].parent][i],a),i=t[i].parent;return a.conversion=n,a}e.exports=function(e){const t=function(e){const t=function(){const e={},t=Object.keys(r);for(let n=t.length,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;){const e=n.pop(),o=Object.keys(r[e]);for(let r=o.length,a=0;a<r;a++){const r=o[a],i=t[r];-1===i.distance&&(i.distance=t[e].distance+1,i.parent=e,n.unshift(r))}}return t}(e),n={},o=Object.keys(t);for(let e=o.length,r=0;r<e;r++){const e=o[r];null!==t[e].parent&&(n[e]=a(e,t))}return n}},31122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addCallLogEntry=function(e){return{type:r.ADD_CALL_HISTORY_ENTRY,payload:e}},t.removeCallLogs=function(e){return{type:r.DELETE_CALL_HISTORY,payload:e}},t.removeCallLogsFinish=function(e){let{recordId:t,error:n}=e;return{type:r.DELETE_CALL_HISTORY_FINISH,error:!!n,payload:n||t}},t.retrieveCallLogs=function(e,t){return{type:r.FETCH_CALL_HISTORY,payload:{amount:e,offset:t}}},t.retrieveCallLogsFinish=function(e){let{logs:t,error:n}=e;return{type:r.FETCH_CALL_HISTORY_FINISH,error:!!n,payload:n||t}},t.setCache=function(e){return{type:r.SET_CACHE,payload:e}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81322))},31182:(e,t,n)=>{var r=n(80393),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,a,i,s){var c=1&n,l=r(e),u=l.length;if(u!=r(t).length&&!c)return!1;for(var d=u;d--;){var f=l[d];if(!(c?f in t:o.call(t,f)))return!1}var p=s.get(e),g=s.get(t);if(p&&g)return p==t&&g==e;var _=!0;s.set(e,t),s.set(t,e);for(var E=c;++d<u;){var y=e[f=l[d]],S=t[f];if(a)var v=c?a(S,y,f,t,e,s):a(y,S,f,e,t,s);if(!(void 0===v?y===S||i(y,S,n,a,s):v)){_=!1;break}E||(E="constructor"==f)}if(_&&!E){var h=e.constructor,T=t.constructor;h==T||!("constructor"in e)||!("constructor"in t)||"function"==typeof h&&h instanceof h&&"function"==typeof T&&T instanceof T||(_=!1)}return s.delete(e),s.delete(t),_}},31270:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(const t in i)i[t](e);return{api:o.createAPI,capabilities:["callHistory"],middleware:a.default,name:o.name,reducer:o.reducer}};var r,o=n(97969),a=(r=n(41516))&&r.__esModule?r:{default:r},i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(7664));n(19054)},31486:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{mediaDevices:t,peerConnection:n}=(0,c.getWebRTCSupportCapabilities)();if(!t||!n)return void f.warn("Calls are not supported on this platform due to lack of WebRTC support. Proxy APIs will not be available.");e.factory("ProxyOperations",l.default),e.decorator("WebRTC",function(e){return e.devices.setListening(!1),e.devices.cleanup(),d.managers}),e.defer(p);const s=(0,c.default)(),d=(0,a.default)(s);function p(e){const{ProxyStack:t,logManager:n}=e,o=n.getLogger("PROXY");t.setProxyMode&&(0,r.default)(t.setProxyMode)||o.error("Cannot setup Proxy Plugin: Proxy Stack not found.")}return e.value("ProxyStack",d),{api:u.default,capabilities:["mediaProxy"],initProxy:p,name:o.default.name,reducer:o.default.reducer,cleanup:i.default}};var r=d(n(30524)),o=d(n(93722)),a=d(n(14816)),i=d(n(24642));n(91375);var s=n(69932),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(37654)),l=d(n(4398)),u=d(n(94922));function d(e){return e&&e.__esModule?e:{default:e}}const f=s.logManager.getLogger("PROXY")},31623:(e,t,n)=>{var r=n(78942).Uint8Array;e.exports=r},31657:(e,t,n)=>{"use strict";var r=n(42937),o=n(33243),a=n(679),i=n(55558),s=n(37032),c=o.add,l=o.has,u=o.remove;e.exports=function(e){var t=r(this),n=i(e).getIterator(),o=a(t);return s(n,function(e){l(t,e)?u(o,e):c(o,e)}),o}},32255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"connectionLost",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"subscribe",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"subscriptionGone",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"unsubscribe",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"updateSubscription",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"websocketOverridden",{enumerable:!0,get:function(){return c.default}});var r=l(n(23727)),o=l(n(63657)),a=l(n(32965)),i=l(n(52899)),s=l(n(35063)),c=l(n(18324));function l(e){return e&&e.__esModule?e:{default:e}}},32293:(e,t,n)=>{var r=n(23945),o=n(46285),a=n(74535),i=n(25288),s=Object.prototype,c=s.hasOwnProperty,l=r(function(e,t){e=Object(e);var n=-1,r=t.length,l=r>2?t[2]:void 0;for(l&&a(t[0],t[1],l)&&(r=1);++n<r;)for(var u=t[n],d=i(u),f=-1,p=d.length;++f<p;){var g=d[f],_=e[g];(void 0===_||o(_,s[g])&&!c.call(e,g))&&(e[g]=u[g])}return e});e.exports=l},32331:(e,t,n)=>{"use strict";var r=n(39944),o=n(77065),a=n(88088),i=n(74320),s=n(4282),c=n(43086),l=n(12913),u=n(52037).IteratorPrototype,d=n(76224),f=n(88500),p=n(75366),g=s("toStringTag"),_="IteratorHelper",E="WrapForValidIterator",y="normal",S="throw",v=c.set,h=function(e){var t=c.getterFor(e?E:_);return i(o(u),{next:function(){var n=t(this);if(e)return n.nextHandler();if(n.done)return d(void 0,!0);try{var r=n.nextHandler();return n.returnHandlerResult?r:d(r,n.done)}catch(e){throw n.done=!0,e}},return:function(){var n=t(this),o=n.iterator;if(n.done=!0,e){var a=l(o,"return");return a?r(a,o):d(void 0,!0)}if(n.inner)try{f(n.inner.iterator,y)}catch(e){return f(o,S,e)}if(n.openIters)try{p(n.openIters,y)}catch(e){return f(o,S,e)}return o&&f(o,y),d(void 0,!0)}})},T=h(!0),C=h(!1);a(C,g,"Iterator Helper"),e.exports=function(e,t,n){var r=function(r,o){o?(o.iterator=r.iterator,o.next=r.next):o=r,o.type=t?E:_,o.returnHandlerResult=!!n,o.nextHandler=e,o.counter=0,o.done=!1,v(this,o)};return r.prototype=t?T:C,r}},32335:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SIP_EVENT_UPDATE_FINISH=t.SIP_EVENT_UPDATE=t.SIP_EVENT_UNSUBSCRIBE_FINISH=t.SIP_EVENT_UNSUBSCRIBE=t.SIP_EVENT_SUBSCRIBE_FINISH=t.SIP_EVENT_SUBSCRIBE=t.SIP_EVENT_RECEIVED=void 0;const n="@@KANDY/";t.SIP_EVENT_SUBSCRIBE=n+"SIP_EVENT_SUBSCRIBE",t.SIP_EVENT_SUBSCRIBE_FINISH=n+"SIP_EVENT_SUBSCRIBE_FINISH",t.SIP_EVENT_UPDATE=n+"SIP_EVENT_UPDATE",t.SIP_EVENT_UPDATE_FINISH=n+"SIP_EVENT_UPDATE_FINISH",t.SIP_EVENT_UNSUBSCRIBE=n+"SIP_EVENT_UNSUBSCRIBE",t.SIP_EVENT_UNSUBSCRIBE_FINISH=n+"SIP_EVENT_UNSUBSCRIBE_FINISH",t.SIP_EVENT_RECEIVED=n+"SIP_EVENT_RECEIVED"},32466:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.container);e.factory("Callstack.stages.startMOH",()=>({remote:{remoteOffer:t.localChanges,signalling:t.signalling}})),e.factory("Callstack.stages.stopMOH",()=>{const t=(0,o.default)(e.container);return{remote:{remoteOffer:t.localChanges,signalling:t.signalling}}}),e.factory("Callstack.operations.startMOH",()=>{const t=e.container.Callstack.models.Negotiation;return{remote:function(n){return t.instance({type:a.OPERATIONS.START_MOH,isLocal:!1,stages:e.container.Callstack.stages.startMOH.remote},{callId:n})}}}),e.factory("Callstack.operations.stopMOH",()=>{const t=e.container.Callstack.models.Negotiation;return{remote:function(n){return t.instance({type:a.OPERATIONS.STOP_MOH,isLocal:!1,stages:e.container.Callstack.stages.stopMOH.remote},{callId:n})}}})};var r=i(n(12637)),o=i(n(34597)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},32590:(e,t,n)=>{var r=n(69334),o=n(3334);e.exports=function(e){return o("function"==typeof e?e:r(e,1))}},32774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,r=t.getLogger("CALLHISTORY");return async function(e){const t={method:"GET",endpoint:"logHistory",queryParams:{startIndex:e.offset,count:e.amount},responseType:"json",body:void 0},i={4:a.callHistoryCodes.NOT_AUTHENTICATED,27:a.callHistoryCodes.FORBIDDEN,35:a.callHistoryCodes.FORBIDDEN},s=await n(t),{body:c,error:l,result:u}=s;if(!l){r.info(`Call log(s) fetched; Status code: ${c.logHistory.statusCode}`);let e=c.logHistory.logItems;return e=e.map(function(e){if("CallLog"===e.type)return e.params}),e=e.map(function(e){return"outgoing"!==e.direction||e.calleeDisplayNumber||e.calleeName||(e.calleeDisplayNumber=e.callerDisplayNumber,e.calleeName=e.callerName),"outgoing"===e.direction?e.remoteParticipant={displayName:e.calleeName,displayNumber:e.calleeDisplayNumber}:e.remoteParticipant={displayName:e.callerName,displayNumber:e.callerDisplayNumber},e}),e}let d="",f="";if((0,o.default)(c)){const{code:e,message:t}=u;f=`Failed to fetch call log(s); ${t}.`,d=403===e?a.callHistoryCodes.FORBIDDEN:a.callHistoryCodes.UNKNOWN_ERROR}else{const{statusCode:e}=c.logHistory;f=`Failed to fetch call log(s); Status code: ${e}`,d=i[e]||a.callHistoryCodes.UNKNOWN_ERROR}throw r.info(f),new a.default({code:d,message:f})}},n(81045),n(84915);var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},32965:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionRequests.resubscribe",t=>(0,r.default)(e.container)),e.factory("SubscriptionOperations.updateSubscription",t=>(0,o.default)(e.container))};var r=a(n(82912)),o=a(n(55608));function a(e){return e&&e.__esModule?e:{default:e}}},33103:(e,t,n)=>{var r=n(94715)(n(78942),"DataView");e.exports=r},33243:(e,t,n)=>{"use strict";var r=n(16881),o=Set.prototype;e.exports={Set,add:r(o.add),has:r(o.has),remove:r(o.delete),proto:o}},33558:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,r=t.getLogger("USERS");return{getDirectory:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};e.searchType?(t.criteria=e.searchCriteria,t.criteriaType=e.searchType):e.searchCriteria&&(t.criteria=e.searchCriteria);const o=await n({endpoint:"directory",queryParams:t,method:"GET"}),{error:i,result:s,body:c}=o;if(i){if(c){const{statusCode:e}=c.directory;throw r.debug(`Failed to search directory with status code ${e}.`),new a.default({code:e,message:`Failed to search directory; status ${e}.`})}{const{message:e}=s;throw r.debug(`Directory search request failed: ${e}`),new a.default({message:`Directory search request failed: ${e}`})}}if(c&&0===c.directory.statusCode)return c.directory.directoryItems||[];throw r.debug("Unknown error case for directory search."),new a.default({message:"Unknown error."})},contactRequest:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{extraURL:t,method:i}=e;let s;s=t?`addressbook/${t}`:"addressbook";const c={method:i,endpoint:s,body:e.body},l={4:a.usersCodes.REFRESH_CONTACTS_FAIL,27:a.usersCodes.REFRESH_CONTACTS_FAIL,35:a.usersCodes.REFRESH_CONTACTS_FAIL},u=await n(c),{body:d,error:f,result:p}=u;if(!f){const{addressBookResponse:e}=d;return r.info(`${i} contact(s) performed successfully; Status code: ${e.statusCode}`),{result:e||{}}}let g="",_="";if((0,o.default)(d)){const{code:e,message:t}=p;_=`Failed to ${i} contact(s); ${t}.`,g=403===e?a.usersCodes.REFRESH_CONTACTS_FAIL:a.usersCodes.UNKNOWN}else{const{statusCode:e}=d.addressBookResponse;_=`Failed to ${i} contact(s). Status Code ${e}`,g=l[e]||a.usersCodes.UNKNOWN}throw r.info(_),new a.default({code:g,message:_})}}};var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},33603:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findConversation=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"im";return(0,o.default)(e.messaging.conversations.find(e=>(0,r.default)(e.destination,t)&&e.type===n))},t.findMember=function(e,t,n){const r=e.messaging.conversations.find(e=>e.destination===t);if(r)return(0,o.default)(r.members.find(e=>e.id===n))},t.getConversations=function(e){return(0,o.default)(e.messaging.conversations)},t.getMessages=function(e,t){return(0,o.default)(e.messaging.conversations[t].messages)},t.getMessagingConfig=function(e){return(0,o.default)(e.config.messaging)},n(81045),n(45950);var r=a(n(36582)),o=a(n(89321));function a(e){return e&&e.__esModule?e:{default:e}}},33789:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("NotificationsOperations.enableWebsocketChannel",()=>(0,o.default)(e.container)),e.factory("NotificationsOperations.processNotification",()=>(0,r.default)(e.container))};var r=a(n(27003)),o=a(n(73176));function a(e){return e&&e.__esModule?e:{default:e}}},33839:(e,t,n)=>{"use strict";e=n.nmd(e);const r=(e,t)=>(...n)=>`[${e(...n)+t}m`,o=(e,t)=>(...n)=>{const r=e(...n);return`[${38+t};5;${r}m`},a=(e,t)=>(...n)=>{const r=e(...n);return`[${38+t};2;${r[0]};${r[1]};${r[2]}m`},i=e=>e,s=(e,t,n)=>[e,t,n],c=(e,t,n)=>{Object.defineProperty(e,t,{get:()=>{const r=n();return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0}),r},enumerable:!0,configurable:!0})};let l;const u=(e,t,r,o)=>{void 0===l&&(l=n(99047));const a=o?10:0,i={};for(const[n,o]of Object.entries(l)){const s="ansi16"===n?"ansi":n;n===t?i[s]=e(r,a):"object"==typeof o&&(i[s]=e(o[t],a))}return i};Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(const[n,r]of Object.entries(t)){for(const[n,o]of Object.entries(r))t[n]={open:`[${o[0]}m`,close:`[${o[1]}m`},r[n]=t[n],e.set(o[0],o[1]);Object.defineProperty(t,n,{value:r,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="[39m",t.bgColor.close="[49m",c(t.color,"ansi",()=>u(r,"ansi16",i,!1)),c(t.color,"ansi256",()=>u(o,"ansi256",i,!1)),c(t.color,"ansi16m",()=>u(a,"rgb",s,!1)),c(t.bgColor,"ansi",()=>u(r,"ansi16",i,!0)),c(t.bgColor,"ansi256",()=>u(o,"ansi256",i,!0)),c(t.bgColor,"ansi16m",()=>u(a,"rgb",s,!0)),t}})},33841:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.removeMedia",()=>{const t=(0,r.default)(e.container),n=(0,c.default)(e.container);return{local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,l.default)(e.container),rollback:(0,i.default)(e.container)},remote:{remoteOffer:n.localChanges,signalling:n.signalling}}}),e.factory("Callstack.stages.removeBasicMedia",()=>{const t=(0,r.default)(e.container);return{local:{validate:s.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,l.default)(e.container),rollback:(0,i.default)(e.container)}}}),e.factory("Callstack.operations.removeMedia",()=>{const t=e.container.Callstack,n=t.models.Negotiation;function r(e){return(r,o)=>{const a=t.stages.removeMedia[e?"local":"remote"];return n.instance({type:u.OPERATIONS.REMOVE_MEDIA,isLocal:e,stages:a},{callId:r,deferred:o})}}return{local:r(!0),remote:r(!1)}}),e.factory("Callstack.operations.removeBasicMedia",()=>{const t=e.container.Callstack.models.Negotiation;return{local:function(n,r){return t.instance({type:u.OPERATIONS.REMOVE_BASIC_MEDIA,isLocal:!0,stages:e.container.Callstack.stages.removeBasicMedia.local},{callId:n,deferred:r})}}}),e.factory("Callstack.utils.webrtcRemoveMedia",()=>(0,a.default)(e.container)),e.factory("Callstack.utils.rollbackRemoveMedia",()=>(0,i.default)(e.container))};var r=d(n(73817)),o=d(n(87851)),a=d(n(45370)),i=d(n(50361)),s=d(n(21981)),c=d(n(8588)),l=d(n(83557)),u=n(59090);function d(e){return e&&e.__esModule?e:{default:e}}},33907:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCachedHistory=function(e){return(0,o.default)(e.callHistory)},t.getCallHistory=function(e,t){if(!t)return(0,o.default)(e.callHistory);const n=t.amount,r=t.offset;return r+n>=e.callHistory.length?(0,o.default)(e.callHistory.slice(r)):(0,o.default)(e.callHistory.slice(r,r+n))};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},33934:(e,t,n)=>{var r=n(23212),o=n(36465),a=n(65568);e.exports=function(e,t,n,i,s,c){var l=1&n,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var f=c.get(e),p=c.get(t);if(f&&p)return f==t&&p==e;var g=-1,_=!0,E=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++g<u;){var y=e[g],S=t[g];if(i)var v=l?i(S,y,g,t,e,c):i(y,S,g,e,t,c);if(void 0!==v){if(v)continue;_=!1;break}if(E){if(!o(t,function(e,t){if(!a(E,t)&&(y===e||s(y,e,n,i,c)))return E.push(t)})){_=!1;break}}else if(y!==S&&!s(y,S,n,i,c)){_=!1;break}}return c.delete(e),c.delete(t),_}},34162:e=>{e.exports=function(e){return this.__data__.get(e)}},34189:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,SubscriptionOperations:u,SubscriptionRequests:d,Notifications:f,Connectivity:p}=e,g=n.getLogger("SUBSCRIPTION");return async function(e,n){if(g.info(`Initiating subscription for services: ${e}`),!e||0===e.length)throw new c.default({code:c.subscriptionCodes.NO_SERVICE_PROVIDED,message:"No service provided"});const _=(0,o.getConnectionInfo)(t.getState()),E=(0,l.getSubscriptionExpiry)(t.getState());let y;e=e.map(e=>e.service);let S=1;const v=(0,l.getServiceUnavailableMaxRetries)(t.getState());for(;S<=1+v&&(y=await d.subscribe(E,e,n),y.error);){if(y.error.code!==c.authCodes.SUBSCRIBE_UNAVAILABLE||!y.retryAfter){let e=S>1?`Subscription subsequently failed: ${y.error} (after getting an initial 503 response).`:`Subscription failed: ${y.error}`;throw g.debug(e),y.error}{if(S===1+v)throw g.debug(`Subscription failed: ${y.error} after ${S-1} re-attempts.`),y.error;const e=await Promise.race([(0,s.delay)(y.retryAfter),f.takeAction(r.UNSUBSCRIBE_FINISHED)]);if(e&&e.actionType&&e.actionType===r.UNSUBSCRIBE_FINISHED)return;S++}}if(_.requestOptions.headers["x-token"]){if(!y.subscriptionParams)throw new c.default({message:"Failed user subscription using HMAC-based token.",code:c.authCodes.SUBSCRIBE_FAIL});t.dispatch((0,a.updateHmacToken)(y.subscriptionParams.sessionId))}const h={...y.subscriptionParams,servicesInfo:y.servicesInfo,url:y.subscription},{webSocketOAuthMode:T}=(0,i.getConnectivityConfig)(t.getState()),C={},I=_.bearerAccessToken;I&&"query"===T&&(C.access_token=I);const m=(0,l.getWebsocketConfig)(t.getState()),O={protocol:"wss",server:m.server,port:m.port,url:h.notificationChannel,params:C};try{await p.connect(O)}catch(e){throw await u.unsubscribe([h]),e}return g.info(`Subscribed to the following services: ${h.service}`),{subscriptions:[h]}}},n(81045),n(84915);var r=u(n(34721)),o=n(87075),a=n(44130),i=n(94482),s=n(1011),c=u(n(75412)),l=n(56512);function u(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},34216:(e,t,n)=>{var r=n(46648),o=n(65512),a=n(5620);e.exports=function(e,t,n,i,s,c,l,u,d,f){var p=8&t;t|=p?32:64,4&(t&=~(p?64:32))||(t&=-4);var g=[e,t,s,p?c:void 0,p?l:void 0,p?void 0:c,p?void 0:l,u,d,f],_=n.apply(void 0,g);return r(e)&&o(_,g),_.placeholder=i,a(_,e,t)}},34271:(e,t)=>{"use strict";function n(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function r(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const a=e.length/4+2,i=Math.ceil(a/16),s=new Array(i);for(let t=0;t<i;++t){const n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];s[t]=n}s[i-1][14]=8*(e.length-1)/Math.pow(2,32),s[i-1][14]=Math.floor(s[i-1][14]),s[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const a=new Uint32Array(80);for(let t=0;t<16;++t)a[t]=s[e][t];for(let e=16;e<80;++e)a[e]=r(a[e-3]^a[e-8]^a[e-14]^a[e-16],1);let i=o[0],c=o[1],l=o[2],u=o[3],d=o[4];for(let e=0;e<80;++e){const o=Math.floor(e/20),s=r(i,5)+n(o,c,l,u)+d+t[o]+a[e]>>>0;d=u,u=l,l=r(c,30)>>>0,c=i,i=s}o[0]=o[0]+i>>>0,o[1]=o[1]+c>>>0,o[2]=o[2]+l>>>0,o[3]=o[3]+u>>>0,o[4]=o[4]+d>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]}},34412:(e,t,n)=>{"use strict";var r=n(3770),o=n(88500);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){o(e,"throw",t)}}},34460:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,o=t.getLogger("SIPEVENTS");return{subscribe:async function(e,t,a,i,s){const c={method:"POST",endpoint:"eventSubscription"};c.body={eventSubscriptionRequest:{subscribeUserList:t,clientCorrelator:a,eventType:e,expires:s}},i.length&&(c.body.eventSubscriptionRequest.customParameters=i),c.body=JSON.stringify(c.body);const l=await n(c),{body:u,error:d,result:f}=l;if(d){if(u){const{statusCode:t}=u.eventSubscriptionResponse,n=`Failed to subscribe to sip event ${e}, status code ${t}`;throw o.info(n),new r.default({code:r.sipEventCodes.UNKNOWN_ERROR,message:n})}{const{message:e}=f,t=`SIP event subscription request failed: ${e}.`;throw o.info(t),new r.default({code:r.sipEventCodes.UNKNOWN_ERROR,message:t})}}return l},unsubscribe:async function(e,t){const a={method:"DELETE",responseType:"none"};a.endpoint=`eventSubscription/${t.sessionData}`;const i=await n(a),{body:s,error:c,result:l}=i;if(c){if(s){const{statusCode:t}=s.eventSubscriptionResponse,n=`Failed to unsubscribe from sip event ${e}, status code ${t}`;throw o.info(n),new r.default({code:r.sipEventCodes.UNKNOWN_ERROR,message:n})}{const{message:e}=l,t=`SIP event unsubscription request failed: ${e}.`;throw o.info(t),new r.default({code:r.sipEventCodes.UNKNOWN_ERROR,message:t})}}return i},update:async function(e,t,a,i){const s={method:"PUT"};s.endpoint=`eventSubscription/${t.sessionData}`,s.body=JSON.stringify({eventSubscriptionRequest:{...a,eventType:e,customParameters:i,expires:t.expires}});const c=await n(s),{body:l,error:u,result:d}=c;if(u){let t;if(l){const{statusCode:n}=l.eventSubscriptionResponse;o.info(`Failed to update sip event subscription; ${e}, status code ${n}`),t=new r.default({code:r.sipEventCodes.UNKNOWN_ERROR,message:`Failed to update to sip event subscription; ${e}, status code ${n}`})}else{const{message:e}=d;o.info(`SIP event update subscription request failed: ${e}.`),t=new r.default({code:r.sipEventCodes.UNKNOWN_ERROR,message:`SIP event update subscription request failed: ${e}.`})}throw t}return l.eventSubscriptionResponse}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},34545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n,r){return o(e,t,n,r)}},t.localChanges=o;var r=n(40481);async function o(e,t,n,o){const{context:a,Callstack:i,logManager:s}=e,c=s.getLogger("CALL",t);c.info("Replacing track on call.");const l=(0,r.getCallById)(a.getState(),t);let u;try{u=await i.utils.webRtcReplaceTrack({sessionId:l.webrtcSessionId,trackId:n,mediaConstraints:o})}catch(e){throw c.info("Failed to replace track on call."),e}const{newTrackId:d,oldTrackState:f}=u;return{newTrackId:d,oldTrackState:f}}},34597:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n}=e;return{localChanges:(t,n,r)=>p(e,t,n,r),signalling:async(r,o,a)=>{try{const{remoteTracks:i}=await g(e,r,a);t.dispatch(l.callActions.remoteStopMohFinish(r.id,{remote:!0,remoteParticipant:{displayNumber:o.remoteNumber,displayName:o.remoteName},remoteTracks:i})),n(u.CALL_TRACKS_REMOVED,{callId:r.id,trackIds:i})}catch(e){throw t.dispatch(l.callActions.remoteStopMohFinish(r.id,{remote:!0,error:e})),e}}}},t.localChanges=p,t.signalling=g,n(97107),n(62234);var r=n(73520),o=f(n(48151)),a=f(n(11876)),i=f(n(29819)),s=n(70949),c=n(77126),l=n(35),u=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),d=n(59090);function f(e){return e&&e.__esModule?e:{default:e}}async function p(e,t,n,o){const{CallstackWebrtc:l,CallstackSDP:u,WebRTC:d,logManager:f}=e,p=f.getLogger("CALL",t.id),g=await d.sessionManager.get(t.webrtcSessionId);if(!g)throw p.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);const _=(0,r.getMediaState)(t);if((0,a.default)(n.sdp)&&[c.CALL_MEDIA_STATES.DUAL_HOLD,c.CALL_MEDIA_STATES.LOCAL_HOLD].includes(_)){if(p.debug("Modifying remote offer to prevent resetting media while in local hold."),n.sdp=(0,i.default)(n.sdp),!n.sdp)return void p.debug("SDP is either undefined or not a string.");o.mediaDiff=u.compareMedia(o.remoteDesc.sdp,n.sdp,!0)}let E,y=!1;await(0,s.isSameSdpSessionId)(d,t.webrtcSessionId,n.sdp)||(p.debug(`Received offer SDP is from a different session. Recreating Peer for call ${t.id}.`),y=!0);try{E=await l.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth,y)}catch(e){throw p.debug("Failed to receive offer SDP.",e),e}return{answer:E,session:g,opInfo:o}}async function g(e,t,n){const{CallRequests:r,logManager:a}=e,{answer:i,opInfo:s,session:c}=n,l=a.getLogger("CALL",t.id);try{return await r.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:i.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),l.info("Finished responding to remote update. Changing state based on the remote operation."),{remoteTracks:await(0,o.default)(d.OPERATIONS.STOP_MOH,s.mediaDiff,c)}}catch(e){throw l.info("Failed to respond to remote offer with an answer."),e}}},34621:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(13377)),o=n(45775);const a={};a[r.SET_MODE_FINISH]={next:(e,t)=>({...e,proxyMode:t.payload.value})},a[r.SET_CHANNEL_FINISH]={next:(e,t)=>({...e,hasChannel:!0,remoteInitialized:!1})},a[r.INITIALIZE_FINISH]={next:(e,t)=>({...e,browser:t.payload.browser,remoteInitialized:!0})};const i=(0,o.handleActions)(a,{proxyMode:!1,hasChannel:!1,remoteInitialized:!1,browser:{}});t.default=i},34705:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n}=e;return{localChanges:(t,n,r)=>d(e,t,n,r),signalling:async(r,o,a)=>{try{const{remoteTracks:i}=await f(e,r,a);t.dispatch(s.callActions.remoteAddMediaFinish(r.id,{remote:!0,remoteParticipant:{displayNumber:o.remoteNumber,displayName:o.remoteName},remoteTracks:i})),n(c.CALL_TRACKS_ADDED,{callId:r.id,trackIds:i})}catch(e){throw t.dispatch(s.callActions.remoteAddMediaFinish(r.id,{remote:!0,error:e})),e}}}},t.localChanges=d,t.signalling=f,n(97107),n(62234);var r=n(73520),o=u(n(48151)),a=u(n(29819)),i=n(77126),s=n(35),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),l=n(59090);function u(e){return e&&e.__esModule?e:{default:e}}async function d(e,t,n,o){const{WebRTC:s,CallstackWebrtc:c,CallstackSDP:l,logManager:u}=e,d=u.getLogger("CALL",t.id),f=await s.sessionManager.get(t.webrtcSessionId);if(!f)throw d.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);const p=(0,r.getMediaState)(t);if([i.CALL_MEDIA_STATES.DUAL_HOLD,i.CALL_MEDIA_STATES.LOCAL_HOLD].includes(p)){if(d.debug("Modifying remote offer to prevent resetting media while in local hold."),n.sdp=(0,a.default)(n.sdp),!n.sdp)return void d.debug("SDP is either undefined or not a string.");o.mediaDiff=l.compareMedia(o.remoteDesc.sdp,n.sdp,!0)}let g;try{g=await c.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth)}catch(e){throw d.debug("Failed to receive offer SDP.",e),e}return{answer:g,session:f,opInfo:o}}async function f(e,t,n){const{CallRequests:r,logManager:a}=e,{answer:i,session:s,opInfo:c}=n,u=a.getLogger("CALL",t.id);try{return await r.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:i.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),u.info("Finished responding to remote update. Changing state based on the remote operation."),{remoteTracks:await(0,o.default)(l.OPERATIONS.ADD_MEDIA,c.mediaDiff,s)}}catch(e){throw u.info("Failed to respond to remote offer with an answer."),e}}},34721:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UNSUBSCRIBE_FINISHED=t.UNSUBSCRIBE=t.SUBSCRIBE_FINISHED=t.SUBSCRIBE=t.RESUBSCRIPTION_FINISHED=t.PLUGIN_UNSUBSCRIPTION_FINISHED=t.PLUGIN_UNSUBSCRIPTION=t.PLUGIN_SUBSCRIPTION_FINISHED=t.PLUGIN_SUBSCRIPTION=t.CHANNEL_OPENED=t.CHANNEL_CLOSED=void 0;const n="@@KANDY/SUBSCRIPTION/";t.SUBSCRIBE=n+"SUBSCRIBE",t.SUBSCRIBE_FINISHED=n+"SUBSCRIBE_FINISHED",t.UNSUBSCRIBE=n+"UNSUBSCRIBE",t.UNSUBSCRIBE_FINISHED=n+"UNSUBSCRIBE_FINISHED",t.RESUBSCRIPTION_FINISHED=n+"RESUBSCRIPTION_FINISHED",t.PLUGIN_SUBSCRIPTION=n+"PLUGIN_SUBSCRIPTION",t.PLUGIN_SUBSCRIPTION_FINISHED=n+"PLUGIN_SUBSCRIPTION_FINISHED",t.PLUGIN_UNSUBSCRIPTION=n+"PLUGIN_UNSUBSCRIPTION",t.PLUGIN_UNSUBSCRIPTION_FINISHED=n+"PLUGIN_UNSUBSCRIPTION_FINISHED",t.CHANNEL_OPENED=n+"CHANNEL_OPENED",t.CHANNEL_CLOSED=n+"CHANNEL_CLOSED"},34772:e=>{e.exports=function(){return!1}},34840:(e,t,n)=>{"use strict";var r=n(5613),o=n(39944),a=n(38873),i=n(44977),s=n(3770),c=n(96002),l=n(88500),u=n(20850)("some",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(e){s(this);try{i(e)}catch(e){l(this,"throw",e)}if(u)return o(u,this,e);var t=c(this),n=0;return a(t,function(t,r){if(e(t,n++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},34889:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUB_RESUB=t.SUB_ERROR=t.SUB_CHANGE=void 0,t.SUB_CHANGE="subscription:change",t.SUB_ERROR="subscription:error",t.SUB_RESUB="subscription:resub"},35063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionOperations.onSubscriptionGone",t=>(0,o.default)(e.container)),e.defer(e=>{e.Notifications.takeEveryAction(function(e){return e.type===a.NOTIFICATION_RECEIVED&&e.payload.notificationMessage&&"gone"===e.payload.notificationMessage.eventType},t=>{e.SubscriptionOperations.onSubscriptionGone(t.payload.notificationMessage)})})};var r,o=(r=n(8568))&&r.__esModule?r:{default:r},a=n(70506)},35096:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,Connectivity:i,SubManager:s}=e;return async function(){(0,a.getConnectionState)(t.getState()).connected&&i.disconnect(),s.clear(o.CHANGE_REASONS.WS_OVERRIDDEN),n(r.SUB_CHANGE,{reason:o.CHANGE_REASONS.WS_OVERRIDDEN})}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(34889)),o=n(22191),a=n(94482)},35180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGES_ERROR=t.MESSAGES_CHANGE=t.CONVERSATIONS_NEW=t.CONVERSATIONS_CHANGE=void 0,t.CONVERSATIONS_NEW="conversations:new",t.CONVERSATIONS_CHANGE="conversations:change",t.MESSAGES_CHANGE="messages:change",t.MESSAGES_ERROR="messages:error"},35497:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallstackSDP:r,WebRTC:s}=e;return async function(e,c){const l=n.getLogger("CALL",c.id);l.debug(`Processing SDP answer for session ${e.sessionId}.`);const u=await s.sessionManager.get(e.sessionId);if(!u)throw l.debug(`webRTC session ${e.sessionId} not found.`),new i.default({code:i.callCodes.INVALID_PARAM,message:`WebRTC session for Call ${c.id} does not exist.`});let d=(0,o.getOptions)(t.getState()).sdpHandlers,f=e.answerSdp;if(f.includes("a=setup:actpass")){const e=c.isCaller?"passive":"active";l.debug(`Received answer SDP has role of actpass. Changing to ${e}.`),d=[...d,(0,a.default)(e,l)]}try{f=r.runPipeline(d,f,{callId:c.id,type:"answer",step:"set",endpoint:"remote"}),await u.processAnswer({type:"answer",sdp:f})}catch(e){let t;throw l.debug(`Failed to process answer: ${e.message}`),t=e.message.includes("The order of m-lines")?{code:i.callCodes.SESSION_MISMATCH,message:"Failed to receive answer due to media negotiation mismatch."}:{code:i.callCodes.GENERIC_ERROR,message:`Failed to receive answer: ${e.message}`},new i.default(t)}}},n(62234);var r,o=n(40481),a=(r=n(94236))&&r.__esModule?r:{default:r},i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},35590:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t);return n?!1!==n.localHold?new o.default({code:o.callCodes.INVALID_STATE,message:"Call is in an invalid state: localHold=true. It should be: localHold=false."}):void 0:new o.default({code:o.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(40481),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},35636:(e,t,n)=>{var r=n(86596)();e.exports=r},35680:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallstackSDP:r,WebRTC:l}=e;return async function(u,d){const{CallReporter:f}=e,{sessionId:p,bandwidth:g,callId:_,dscpControls:E}=d,y=n.getLogger("CALL",_);y.info("Setting up local WebRTC portions of call.");const S=(0,a.getCallById)(t.getState(),_),v=f.getReport(_),h=S.currentOperations.find(e=>e.isLocal&&e.type===i.OPERATIONS.ANSWER),T=v.getEvent(h.eventId),C=T.addEvent(s.REPORT_EVENTS.GET_USER_MEDIA);let I,m,O,A,R,b;C.addData("mediaConstraints",(0,o.default)(u));try{const e=await l.sessionManager.getWithMedia(p,u,E);I=e.session,m=e.medias,C.endEvent()}catch(e){y.debug("Failed to get and add new media to call.");const t=new c.default({message:e.message,code:c.callCodes.USER_MEDIA_ERROR});throw C.endEvent(t),t}try{b=T.addEvent(s.REPORT_EVENTS.CREATE_ANSWER),O=await I.createAnswer(),b.endEvent()}catch(e){const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw b.endEvent(t),t}try{A=(0,a.getOptions)(t.getState()),O.sdp=r.runPipeline(A.sdpHandlers,O.sdp,{callId:_,type:O.type,step:"set",endpoint:"local",bandwidth:g}),R=T.addEvent(s.REPORT_EVENTS.PROCESS_MEDIA_LOCAL),R.addData("operation",s.REPORTER_OPERATION_EVENTS_MAP.ANSWER),O=await I.setLocalDescription(O),R.endEvent()}catch(e){const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw R.endEvent(t),t}const N=r.runPipeline(A.sdpHandlers,O.sdp,{callId:_,type:O.type,step:"send",endpoint:"local",bandwidth:g});return y.info("Finished setting up local WebRTC portions of call."),{error:!1,answerSDP:N,mediaIds:m.map(e=>e.id),session:I}}},n(81045),n(45950),n(84915);var r,o=(r=n(89321))&&r.__esModule?r:{default:r},a=n(40481),i=n(59090),s=n(84581),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},35730:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,c){const l=(0,a.getCallById)(e,t),u=l?l.localTracks.map(t=>(0,s.getTrackById)(e,t)).filter(e=>e.kind===n):void 0,d=(0,o.default)(e,t,r,c);return d||(u.length>=1?new i.default({code:i.callCodes.INVALID_PARAM,message:`Too many ${n} tracks for basic scenario!`}):void 0)},n(81045),n(30163),n(84915);var r,o=(r=n(1306))&&r.__esModule?r:{default:r},a=n(40481),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),s=n(69260)},35890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t}=e;t.getLogger("EVENTS").info("Cleaning up events plugin")}},35911:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},35916:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"api",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(56176)),o=a(n(9016));function a(e){return e&&e.__esModule?e:{default:e}}t.name="sipEvents"},35968:(e,t,n)=>{var r=n(92673)("concat",n(64871));r.placeholder=n(22991),e.exports=r},36208:(e,t,n)=>{var r=n(64512),o=n(79071),a=n(49828),i=r&&1/a(new r([,-0]))[1]==1/0?function(e){return new r(e)}:o;e.exports=i},36465:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},36526:(e,t,n)=>{var r=n(38330),o=n(24367),a=n(23904);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},36529:(e,t,n)=>{var r=n(93655),o=n(65387);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},36582:(e,t,n)=>{var r=n(92673)("isEqual",n(46343));r.placeholder=n(22991),e.exports=r},36705:(e,t,n)=>{var r=n(92673)("isPlainObject",n(48360),n(76648));r.placeholder=n(22991),e.exports=r},36786:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,UsersRequests:r}=e,c=n.getLogger("USERS");function l(e){switch(e){case"first_name":case"firstName":case"FIRSTNAME":return 1;case"last_name":case"lastName":case"LASTNAME":return 2;case"name":case"NAME":return 3;case"phone_number":case"phoneNumber":case"PHONENUMBER":return 4;case"user_id":case"userId":case"USERID":case"user_name":case"userName":case"USERNAME":return 5}}function u(e){"contactId"in e&&(e.nickname=e.contactId,delete e.contactId);for(const t in e)e[t]&&0!==e[t].length||delete e[t];return e}function d(e){return"nickname"in e&&(e.contactId=e.nickname,delete e.nickname),e}function f(e){return{...e,userId:e.primaryContact||e.userId}}return{fetchUser:async function(e){const{dispatch:n}=t;n(a.fetchUser(e));const o={searchCriteria:e,searchType:l("user_id")};try{const e=await r.getDirectory(o);if(e.length>0)return n(a.fetchUserFinish(e[0])),e[0];c.debug("Fetch user request was successful, but result was empty")}catch(e){throw n(a.fetchUserFinish(e)),e}},addContact:async function(e){const{dispatch:n}=t;if(n(i.addContact(e)),c.info("Attempting to add contact(s):",e),!e||(0,o.default)(e)){c.info("Could not add contact(s); invalid input.");const e=new s.default({code:s.usersCodes.INVALID_PARAM,message:"Could not add contact(s); invalid input."});throw n(i.addContactFinish({error:e})),e}try{const t={addressBookRequest:{addressBookEntries:[u({...e})]}},o=await r.contactRequest({extraURL:"contacts/",body:JSON.stringify(t),method:"POST"});let a={};return o&&(a=d(o),n(i.addContactFinish({contact:a}))),a}catch(e){throw n(i.addContactFinish({error:e})),e}},removeContact:async function(e){const{dispatch:n}=t;if(n(i.removeContact(e)),c.info("Attempting to remove the contact: ",e),!e){c.info("Could not remove contact; invalid id.");const e=new s.default({code:s.usersCodes.INVALID_PARAM,message:"Could not remove contact; invalid id."});throw n(i.removeContactFinish({error:e})),e}try{const t=await r.contactRequest({extraURL:"contacts/"+encodeURIComponent(e),method:"DELETE"});let o="";return t&&(n(i.removeContactFinish({contactId:e})),o=e),o}catch(e){throw n(i.removeContactFinish({error:e})),e}},updateContact:async function(e){const{dispatch:n}=t;if(n(i.updateContact(e)),!e||(0,o.default)(e)){c.info("Could not update contact; invalid input.");const e=new s.default({code:s.usersCodes.INVALID_PARAM,message:"Could not update contact(s); invalid input."});throw n(i.updateContactFinish({error:e})),e}try{const t={addressBookRequest:{addressBookEntries:[u({...e})]}};if(await r.contactRequest({extraURL:"contacts/"+e.contactId,body:JSON.stringify(t),method:"PUT"}))return n(i.updateContactFinish({contact:e})),e}catch(e){throw n(i.updateContactFinish({error:e})),e}},fetchContact:async function(e){const{dispatch:n}=t;if(n(i.fetchContact(e)),c.info("Attempting to fetch the contact: ",e),!e){c.info("Could not fetch contact; invalid id.");const e=new s.default({code:s.usersCodes.INVALID_PARAM,message:"Could not fetch contact; invalid id."});throw n(i.fetchContactFinish({error:e})),e}try{const t=await r.contactRequest({extraURL:`contacts/${e}`,method:"GET"});if(t){const e=d(t.result.addressBookEntries[0]);return n(i.fetchContactFinish({contact:e})),e}}catch(e){throw n(i.fetchContactFinish({error:e})),e}},searchDirectory:async function(e,n){const{dispatch:o}=t;let i;o(a.searchDirectory(e,n));for(const t in e)if(e.hasOwnProperty(t)&&e[t]){i=t;break}c.debug(`Using criteria '${i}' with value '${e[i]}' to search directory.`);const s={searchCriteria:e[i],searchType:l(i)};try{const e=(await r.getDirectory(s)).map(f);return o(a.searchDirectoryFinish({users:e})),e}catch(e){throw o(a.searchDirectoryFinish({error:e})),e}},refreshContacts:async function(){const{dispatch:e}=t;try{e(i.refreshContacts());const t=await r.contactRequest({method:"GET"});let n=[];return t&&(n=t.result.addressBookEntries?t.result.addressBookEntries.map(d):[],e(i.refreshContactsFinish({contacts:n}))),n}catch(t){throw e(i.refreshContactsFinish({error:t})),t}}}},n(81045),n(84915);var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=c(n(12585)),i=c(n(42340)),s=c(n(75412));function c(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(c=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},36795:()=>{},36850:e=>{e.exports=function(e){return e.placeholder}},37032:(e,t,n)=>{"use strict";var r=n(39944);e.exports=function(e,t,n){for(var o,a,i=n?e:e.iterator,s=e.next;!(o=r(s,i)).done;)if(void 0!==(a=t(o.value)))return a}},37059:(e,t,n)=>{"use strict";var r=n(42937),o=n(33243),a=n(679),i=n(87173),s=n(55558),c=n(29800),l=n(37032),u=o.has,d=o.remove;e.exports=function(e){var t=r(this),n=s(e),o=a(t);return i(t)<=n.size?c(t,function(e){n.includes(e)&&d(o,e)}):l(n.getIterator(),function(e){u(o,e)&&d(o,e)}),o}},37250:e=>{e.exports=function(e,t,n,r){for(var o=e.length,a=n+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1}},37273:(e,t,n)=>{var r=n(92673)("unionWith",n(77484));r.placeholder=n(22991),e.exports=r},37336:(e,t,n)=>{var r=n(58638);function o(e,t,n){var a=r(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return a.placeholder=o.placeholder,a}o.placeholder={},e.exports=o},37601:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(81045),n(5350);var r,o=(r=n(14017))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(60437)),i=n(45775);const s={};s[a.UPDATE]={next:e=>({...e,self:{...e.self,loading:!0,error:!1}})},s[a.UPDATE_FINISH]={next(e,t){const n={...e,self:{loading:!1,error:!1,status:t.payload.status,activity:t.payload.activity}};return t.payload.note&&(n.self.note=t.payload.note),n},throw:(e,t)=>({...e,self:{...e.self,loading:!1,error:t.payload}})},s[a.GET]={next(e,t){let{payload:n}=t;const r={...e.users};for(const e of n)r[e]={userId:e,loading:!0};return{...e,users:r}}},s[a.GET_FINISH]={next(e,t){let{payload:n}=t;const r={};for(const e of n)e.userId&&(e.loading=!1,r[e.userId]=e);return{...e,users:{...e.users,...r}}},throw:(e,t)=>({...e})},s[a.RECEIVED]={next(e,t){let{payload:n}=t;return{...e,users:{...e.users,[n.userId]:{userId:n.userId,status:n.status,activity:n.activity,note:n.note,loading:!1}}}}},s[a.SUBSCRIBE]={next(e,t){let{payload:n}=t;Array.isArray(n)||(n=[n]);const r=Object.assign({},e.users);return n.forEach(e=>{r[e]={userId:e,loading:!1,isPending:!0}}),{...e,users:r}}},s[a.SUBSCRIBE_FINISH]={next(e,t){let{payload:n}=t;const r=Object.assign({},e.users);return n.presentityUserId.forEach(e=>{r[e]={userId:e,loading:!1,isPending:!1}}),{...e,users:r}},throw(e,t){let{payload:n}=t;const r=Object.assign({},e.users);return n.presentityUserId.forEach(e=>{delete r[e]}),{...e,users:r}}},s[a.UNSUBSCRIBE]={next(e,t){let{payload:n}=t;Array.isArray(n)||(n=[n]);const r=Object.assign({},e.users);return n.forEach(e=>{r[e]={userId:e,loading:!1,isPending:!0}}),{...e,users:r}}},s[a.UNSUBSCRIBE_FINISH]={next(e,t){let{payload:n}=t;return{...e,users:(0,o.default)(n.presentityUserId,e.users)}},throw(e,t){let{payload:n}=t;const r=Object.assign({},e.users);return n.presentityUserId&&n.presentityUserId.length>0&&n.presentityUserId.forEach(e=>{r[e]={userId:e,loading:!1,isPending:!1}}),{...e,users:r}}};const c=(0,i.handleActions)(s,{self:{},users:{}});t.default=c},37654:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=p.logManager.getLogger("WebRTC"),t=S();t.version?e.debug(`Browser details: ${t.browser}, version ${t.version}.`):e.debug("Browser details: Not supported by webRTC adapter.");const n=new f.default,E=new l.default,y=new u.default,v=new i.default({trackManager:y}),h=new s.default({trackManager:y}),T=new c.default({peerManager:h,mediaManager:v,trackManager:y,deviceManager:E}),C=new d.default;return{models:{Track:r.default,Media:o.default,Peer:a.default},managers:{devices:E,media:v,peerManager:h,sessionManager:T,track:y,logs:p.logManager,webrtcManager:C,renderer:n},sdp:{pipeline:g.default,handlers:_},getBrowserDetails:S}},t.getBrowserDetails=void 0,t.getWebRTCSupportCapabilities=function(){return{mediaDevices:Boolean(navigator.mediaDevices),peerConnection:Boolean(window.RTCPeerConnection)}};var r=y(n(15626)),o=y(n(87237)),a=y(n(11655)),i=y(n(40276)),s=y(n(79908)),c=y(n(98876)),l=y(n(45902)),u=y(n(95469)),d=y(n(46371)),f=y(n(60088)),p=n(40271),g=y(n(28851)),_=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75424)),E=n(76555);function y(e){return e&&e.__esModule?e:{default:e}}const S=t.getBrowserDetails=E.getBrowserDetails},37681:(e,t,n)=>{var r=n(80777),o=n(49460),a=n(2306),i=a&&a.isMap,s=i?o(i):r;e.exports=s},37892:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,context:n,API_LOG_TAG:r}=e,s=t.getLogger("REQUEST");return{request:{fetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s.debug(r+"fetch: ",e);const c=n.getState(),l=(0,a.getRequestInfo)(c),u=l.requestOptions;return l.requestOptions=(0,o.default)(t,u),(0,i.fetchResource)(e,l)}}}};var r,o=(r=n(96042))&&r.__esModule?r:{default:r},a=n(87075),i=n(67426)},37930:(e,t,n)=>{var r=n(39032),o=n(81211);e.exports=function(e,t){return e&&r(t,o(t),e)}},37984:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.factory=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,l.getVersion)(),d=(0,o.default)(t);let{common:f,...g}=d;f=(0,c.default)(p,f),_(f);const E=new s.default;let y;E.defer(e=>{if(e.logManager&&e.logManager.getLogger){const t=e.logManager.getLogger("FACTORY");t&&t.info&&t.info(`SDK version: ${n}`)}});const S=[],v=[],h=[],T={},C={container:E.container,capabilities:[],api:{},getState(){if(!y)throw Error("Store is not available during factory creation");if(I)throw Error("State is not available if the SDK has been destroyed");return y.getState()},dispatch(){if(!y)throw Error("Store is not available during factory creation");return y.dispatch(...arguments)},subscribe(e){if(!y)throw Error("Store is not available during factory creation");return y.subscribe(e)}};E.value("context",C),E.factory("TimerTracker",u.timerFactory);let I=!1;e.filter(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return("proxy"!==e.name||!f.disableProxy)&&"function"==typeof e.fn}).map(e=>e.fn(E,g[e.name])).filter(e=>Boolean(e)).forEach(e=>{if(e.capabilities&&(C.capabilities=C.capabilities.concat(e.capabilities)),e.reducer&&(T[e.name]=e.reducer),e.middleware){const t="logs"===e.name?0:1;h.splice(h.length-t,0,()=>e.middleware(C))}"function"==typeof e.api&&v.push(e.api),"function"==typeof e.cleanup&&S.push(e.cleanup)});const m=f.enableReduxDevTools?(0,i.composeWithDevTools)({name:f.reduxDevToolsName}):a.compose;return y=(0,a.createStore)((0,a.combineReducers)(T),m((0,a.applyMiddleware)(e=>e=>t=>I?null:e(t),...h))),v.forEach(e=>{C.api=(0,r.default)(C.api,e(E.container))}),E.resolve(E.container),{...C.api,state:{get:function(){return y.getState()},subscribe:function(){return y.subscribe(...arguments)}},getCapabilities:()=>C.capabilities,getVersion:()=>n,destroy(){E.value("isDestroyed",!0),setTimeout(()=>{I||(S.forEach(e=>e(E.container)),y.replaceReducer(function(e,t){return{}}),I=!0)},0)}}},n(97107),n(69375),n(81045),n(30163),n(5350),n(84915);var r=f(n(96042)),o=f(n(89321)),a=n(14848),i=n(88185),s=f(n(8997)),c=f(n(7485)),l=n(13126),u=n(17249),d=n(52932);function f(e){return e&&e.__esModule?e:{default:e}}const p={enableReduxDevTools:!1,reduxDevToolsName:"WebRTC SDK",disableProxy:!1},g=d.validation.schema({enableReduxDevTools:d.validation.boolean(),reduxDevToolsName:d.validation.string(),disableProxy:d.validation.boolean()}),_=(0,d.parse)("common",g)},38010:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,Events:n,API_LOG_TAG:r}=e,o=t.getLogger("EVENTS");return{on:function(e,t){o.debug(r+"on: ",e),n.on(e,t)},off:function(e,t){o.debug(r+"off: ",e),n.off(e,t)},subscribe:function(e){o.debug(r+"subscribe"),n.subscribe(e)},unsubscribe:function(e){o.debug(r+"unsubscribe"),n.unsubscribe(e)}}}},38015:e=>{"use strict";e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},38142:(e,t,n)=>{var r=n(92673)("defaults",n(32293));r.placeholder=n(22991),e.exports=r},38254:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,SubscriptionOperations:n,SubscriptionIntervals:s}=e,c={get subscription(){return(0,o.getSubscriptionInfo)(t.getState())[0]},subInterrupt:!1,subStatus:a.SUB_STATUS.NO_SUB},l=s.resubInterval;async function u(e,o){if(void 0===c.subscription){const e=new i.default({code:i.subscriptionCodes.INVALID_STATE,message:"No active subscription found."});throw t.dispatch(r.subscribeFinished({error:e})),e}let a;try{a=await n.updateSubscription(e,o),t.dispatch(r.subscribeFinished({subscriptions:a.subscriptions}))}catch(e){throw t.dispatch(r.subscribeFinished({error:e})),e}return a.subscriptions}return{subscribe:async function(e,o){if(c.subStatus===a.SUB_STATUS.SUBSCRIBED)return u(e,!0);if([a.SUB_STATUS.SUBSCRIBING,a.SUB_STATUS.UNSUBSCRIBING].includes(c.subStatus)){const e=new i.default({code:i.subscriptionCodes.INVALID_STATE,message:"Operation already pending."});throw t.dispatch(r.subscribeFinished({error:e})),e}let s;c.subStatus=a.SUB_STATUS.SUBSCRIBING;try{if(s=(await n.subscribe(e,o)).subscriptions,c.subInterrupt)throw c.subInterrupt=!1,n.unsubscribe(s),new i.default({code:i.subscriptionCodes.GENERIC_ERROR,message:"Subscription interrupted by unsubscribe operation."});t.dispatch(r.subscribeFinished({subscriptions:s})),await l.startResubInterval()}catch(e){throw c.subStatus=a.SUB_STATUS.NO_SUB,t.dispatch(r.subscribeFinished({error:e})),e}return c.subStatus=a.SUB_STATUS.SUBSCRIBED,s},unsubscribe:async function(e){if(!e||0===e.length)throw new i.default({code:i.subscriptionCodes.NO_SERVICE_PROVIDED,message:"No service provided"});if(c.subStatus===a.SUB_STATUS.NO_SUB)throw new i.default({message:"No subscription found, can't unsubscribe.",code:i.authCodes.UNSUBSCRIBE_FAIL});if(c.subStatus===a.SUB_STATUS.UNSUBSCRIBING)throw new i.default({message:"Unsubscribe operation already pending.",code:i.subscriptionCodes.INVALID_STATE});if(c.subStatus===a.SUB_STATUS.SUBSCRIBING)return void(c.subInterrupt=!0);const o=c.subscription,s=o.service.filter(t=>!e.includes(t));if(0===s.length)return c.subStatus=a.SUB_STATUS.UNSUBSCRIBING,await n.unsubscribe([o]),c.subStatus=a.SUB_STATUS.NO_SUB,t.dispatch(r.unsubscribeFinished({})),void l.stopResubInterval();if(s.length===o.service.length){const n=new i.default({message:`No subscription found for ${JSON.stringify(e)}, can't unsubscribe.`,code:i.authCodes.UNSUBSCRIBE_FAIL});throw t.dispatch(r.unsubscribeFinished({error:n})),n}{c.subStatus=a.SUB_STATUS.UNSUBSCRIBING;const e=await u(s.map(e=>({service:e})),!1);return c.subStatus=a.SUB_STATUS.SUBSCRIBED,e}},clear:function(e){l.stopResubInterval(),c.subStatus=a.SUB_STATUS.NO_SUB,t.dispatch(r.unsubscribeFinished({reason:e}))},get status(){return c.subStatus}}},n(62234),n(81045),n(30163),n(84915);var r=s(n(49561)),o=n(56512),a=n(21471),i=s(n(75412));function s(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(s=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},38330:(e,t,n)=>{var r=n(51340),o=n(94687);e.exports=function(e,t,n,a){var i=n.length,s=i,c=!a;if(null==e)return!s;for(e=Object(e);i--;){var l=n[i];if(c&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<s;){var u=(l=n[i])[0],d=e[u],f=l[1];if(c&&l[2]){if(void 0===d&&!(u in e))return!1}else{var p=new r;if(a)var g=a(d,f,u,e,t,p);if(!(void 0===g?o(f,d,3,a,p):g))return!1}}return!0}},38546:e=>{e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},38577:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkAuthorization=function(e){if(!e.error)return;const t=function(e){let t;return e.body&&(e.body.statusCode?t=e.body.statusCode:Object.values(e.body).forEach(e=>{e.statusCode&&(t=e.statusCode)})),t}(e);if(401===e.result.code)return new r.default({code:r.authCodes.INVALID_CREDENTIALS,message:"Authorization failed with server. Please check credentials."});if(403===e.result.code&&(void 0===e.body||[4,27,61,65].includes(t))){let e="Authorization failed with server. Please check credentials.";return t&&(e+=` Status code: ${t}`),new r.default({code:r.authCodes.INVALID_CREDENTIALS,message:e})}},n(62234),n(81045),n(5350);var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},38689:(e,t,n)=>{"use strict";var r=n(16881),o=r({}.toString),a=r("".slice);e.exports=function(e){return a(o(e),8,-1)}},38724:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n="API invoked: ",a=[],i={},s=[],c={};function l(e,t){if(!e||!(0,r.default)(e))throw new Error(`${n}report.addEventIdToMetric: Invalid type (${typeof e}), must be of type string.`);if(!t||!(0,r.default)(t))throw new Error(`${n}report.addEventIdToMetric: Invalid eventId (${typeof t}), must be of type string.`);const o=s.find(t=>t.type===e);o&&(o.eventIds||(o.eventIds=[]),o.eventIds.push(t))}function u(e){if(!e.error)for(const t in c)c[t].events.includes(e.type)&&(c[t].handler(d,e),l(t,e.id))}const d={type:e,id:t,timeline:a,metrics:s,addEvent:function(e){if(!e||!(0,r.default)(e))throw new Error(`${n}report.addEvent: Invalid type (${typeof e}), must be of type string.`);const t=(0,o.default)(e,u);return a.push(t),t},getEvent:function(e){for(let t=0;t<a.length;t++){if(a[t].id===e)return a[t];{const n=a[t].getEvent(e);if(n)return n}}},findLastOngoingEvent:function(e){return[...a].reverse().find(t=>e||t.isEnded()?Array.isArray(e)&&e.includes(t.type)&&!t.isEnded()?t:t.type!==e||t.isEnded()?void 0:t:t)},addData:function(e,t){if(!e||!(0,r.default)(e))throw new Error(`${n}report.addData: Invalid type (${typeof e}), must be of type string.`);if(void 0===t)throw new Error(`${n}report.addData: No data provided.`);i[e]=t},getData:function(e){return e?i[e]:i},addMetric:function(e,t){if(!e||!(0,r.default)(e))throw new Error(`${n}report.addMetric: Invalid type (${typeof e}), must be of type string.`);if(void 0===t)throw new Error(`${n}report.addMetric: No data provided.`);s.push({type:e,data:t})},getMetric:function(e){if(!e||!(0,r.default)(e))throw new Error(`${n}report.getMetric: Invalid type (${typeof e}), must be of type string.`);return s.filter(t=>t.type===e).map(e=>e.data)},registerMetricHandler:function(e,t,o){if(!e||!(0,r.default)(e))throw new Error(`${n}report.registerMetricHandler: Invalid type (${typeof e}), must be of type string.`);if(!t)throw new Error(`${n}report.registerMetricHandler: Invalid events (${typeof e}), must be a string or an array with at least one event type.`);if(!o||"function"!=typeof o)throw new Error(`${n}report.registerMetricHandler: Invalid handler (${typeof o}, must be a function.)`);(0,r.default)(t)&&(t=[t]),c[e]={events:t,handler:o}},unregisterMetricHandler:function(e){e&&delete c[e]},getSerializable:function(){return{type:e,id:t,timeline:a.map(e=>e.getSerializable()),data:i,metrics:s}}};return d},n(97107),n(62234),n(69375),n(81045),n(45950),n(84915);var r=a(n(73173)),o=a(n(68809));function a(e){return e&&e.__esModule?e:{default:e}}},38773:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t}=e,n=t.getLogger("SDP");return function(e,t,i){const s=n.getLevel();return(s===a.logLevels.DEBUG||s===a.logLevels.TRACE?o.default:r.default)(e,t,i,n)}};var r=i(n(41743)),o=i(n(88351)),a=n(44413);function i(e){return e&&e.__esModule?e:{default:e}}},38873:(e,t,n)=>{"use strict";var r=n(85821),o=n(39944),a=n(3770),i=n(13174),s=n(28146),c=n(69389),l=n(4578),u=n(62350),d=n(69874),f=n(88500),p=TypeError,g=function(e,t){this.stopped=e,this.result=t},_=g.prototype;e.exports=function(e,t,n){var E,y,S,v,h,T,C,I=n&&n.that,m=!(!n||!n.AS_ENTRIES),O=!(!n||!n.IS_RECORD),A=!(!n||!n.IS_ITERATOR),R=!(!n||!n.INTERRUPTED),b=r(t,I),N=function(e){return E&&f(E,"normal"),new g(!0,e)},M=function(e){return m?(a(e),R?b(e[0],e[1],N):b(e[0],e[1])):R?b(e,N):b(e)};if(O)E=e.iterator;else if(A)E=e;else{if(!(y=d(e)))throw new p(i(e)+" is not iterable");if(s(y)){for(S=0,v=c(e);v>S;S++)if((h=M(e[S]))&&l(_,h))return h;return new g(!1)}E=u(e,y)}for(T=O?e.next:E.next;!(C=o(T,E)).done;){try{h=M(C.value)}catch(e){f(E,"throw",e)}if("object"==typeof h&&h&&l(_,h))return h}return new g(!1)}},38877:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:t=>i(e,t),signalling:(t,n)=>s(e,t,n)}},t.localChanges=i,t.signalling=s;var r=n(35),o=n(40481),a=n(37654);async function i(e,t){const{context:n,CallstackWebrtc:r,logManager:a}=e,i=a.getLogger("CALL",t);i.info("Holding call.");const s=(0,o.getCallById)(n.getState(),t);let c;try{c=await r.generateOffer(s.webrtcSessionId,{audio:"inactive",video:"inactive"},s.bandwidth)}catch(e){throw i.debug("Failed to generate SDP offer"),e}return{offer:c}}async function s(e,t,n){const{context:i,CallRequests:s,Callstack:c,CallstackWebrtc:l,logManager:u}=e,{offer:d}=n,f=(0,o.getCallById)(i.getState(),t),p=u.getLogger("CALL",f.id);try{await s.updateSession({wrtcsSessionId:f.wrtcsSessionId,id:f.id,offer:d.sdp,isAnonymous:f.isAnonymous,account:f.account,customParameters:f.customParameters,customBodies:f.customBodies})}catch(e){let t;p.info("Failed to hold call.");try{await c.utils.rollbackHold(f.webrtcSessionId)}catch(e){p.debug("Automatic hold rollback failed:",e),t=e}const n=(0,a.getBrowserDetails)().browser;if(t||"chrome"===n){if("safari"===n||"chrome"===n)throw p.info("Ending call due to unrecoverable state after call hold failure."),await l.closeCall(f.webrtcSessionId),i.dispatch(r.callActions.endCallFinish(f.id,{isLocal:!0,transition:{reasonText:"Call has ended due to call hold failure."}})),e;p.info("Unable to reset state after hold operation failure, future operations may not work as intended.")}throw e}p.info("Finished local portion of holding call. Waiting on remote response.")}},39032:(e,t,n)=>{var r=n(3422),o=n(57073);e.exports=function(e,t,n,a){var i=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var l=t[s],u=a?a(n[l],e[l],l,n,e):void 0;void 0===u&&(u=e[l]),i?o(n,l,u):r(n,l,u)}return n}},39123:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},39174:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,a.parse)("messaging",s)(e=(0,o.default)(i,e)),(e.features.length>1||e.features[0]!==i.features[0])&&(t.warn("WebRTC Gateway's messaging is not compatible with add-on features. Reverting to base messaging."),e.features=i.features),e},n(81045),n(42042);var r,o=(r=n(38142))&&r.__esModule?r:{default:r},a=n(52932);const i={features:["base"]},s=a.validation.schema({features:a.validation.array().every.string()})},39266:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,o=t.getLogger("MESSAGING");return{sendMessage:async function(e,t){const a={imRequest:{charset:"UTF-8",toUrl:e,message:t[0].text,type:"A2"}},i={endpoint:"instantmessage",method:"POST",body:JSON.stringify(a)},s=await n(i),{error:c,result:l,body:u}=s;if(c){if(u){const{statusCode:e}=u.imResponse;throw o.debug(`Failed to send message with status code ${e}.`),new r.default({code:r.messagingCodes.SEND_MESSAGE_FAIL,message:`Failed to send message. Code: ${e}.`})}{const{message:e}=l;throw o.debug("Send message request failed",e),new r.default({code:r.messagingCodes.SEND_MESSAGE_FAIL,message:`Send message request failed: ${e}.`})}}if(u.imResponse&&u.imResponse.messageId)return{messageId:u.imResponse.messageId};throw new r.default({code:r.messagingCodes.SEND_MESSAGE_FAIL,message:"Failed to send message: Unexpected error"})}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},39361:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},39509:(e,t,n)=>{"use strict";var r=n(44318),o=TypeError;e.exports=function(e){if(r(e))throw new o("Can't call method on "+e);return e}},39622:(e,t,n)=>{"use strict";var r=n(96893),o=n(5234),a=n(65926);e.exports=!r&&!o(function(){return 7!==Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a})},39747:(e,t,n)=>{var r=n(41580),o=Object.create,a=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=a},39781:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{WebRTC:t,context:n,logManager:c}=e,l=c.getLogger("MEDIA");return{createLocal:async function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(l.debug("Getting media with constraints: ",e),!e||!Object.keys(e).every(e=>["audio","video","screen","medias"].includes(e)))throw new i.default({code:i.callCodes.USER_MEDIA_ERROR,message:"mediaConstraints must be an object containing at least one of the following media types (and only these types): 'audio', 'video', and 'screen'"});const r=[];try{if(e.screen){const o={video:e.screen},a=await t.media.createLocalScreen(o,n);r.push({type:"screen",media:a})}if(e.audio){const o={audio:e.audio},a=await t.media.createLocal(o,n);r.push({type:"audio",media:a})}if(e.video){const o={video:e.video},a=await t.media.createLocal(o,n);r.push({type:"video",media:a})}}catch(e){let t;t="OverconstrainedError"===e.name?`Failed to get media due to constraint: ${e.constraint}.`:`Failed to get media => Name: ${e.name}; Error Message :${e.message}.`,l.info(t);for(const e of r)await e.media.stop();throw new i.default({message:t,code:i.callCodes.USER_MEDIA_ERROR})}return r},disposeLocalMedia:async function(e){const{dispatch:r}=n;if(!e)throw new i.default({message:"Track id is `undefined`. You must pass an existing track id to dispose of the associated track.",code:i.webrtcCodes.INVALID_PARAM});let o=await t.track.get(e);if(!o)throw new i.default({message:`Either ${e} is not a valid track id type or track does not exist.`,code:i.webrtcCodes.INVALID_TRACK_ID});if((await t.sessionManager.getAll()).forEach(t=>{if(t.localTracks.find(t=>t.id===e))throw new i.default({message:`Can't dispose track: ${e}. It's in use by session: ${t.id}`,code:i.webrtcCodes.TRACK_IN_USE})}),o){if(!await o.isDetached())throw new i.default({message:`Can't dispose track: ${e}. Track was not created locally.`,code:i.webrtcCodes.TRACK_NOT_LOCAL});await o.stop()}r(a.trackActions.trackRemoved(e))},renderTracks:async function(e,c,u){const{dispatch:d}=n;d(a.trackActions.renderTracks(e,{selector:c,...u}));const f=(await t.track.getTracks(e)).filter(e=>!(0,o.default)(e));let p={};if(!(e&&e instanceof Array&&e.length>0&&c&&((0,r.default)(c)||"tagName"in c))){const e="Failed to render tracks. One of trackIds or cssSelector is missing from request.";l.info(e,f.map(e=>e.id)),p.error=new i.default({message:e,code:i.webrtcCodes.INVALID_PARAM});const t={basicError:p.error,filteredTrackIds:f.map(e=>e.id)};throw d(a.trackActions.renderTracksFinish(f.map(e=>e.id),p)),t}return l.info(`Rendering track(s) in element ${(0,s.logCssSelector)(c)}.`,e),await Promise.all(f.map(async e=>{await t.renderer.renderTrack(e,c,u.speakerId)})),l.info("Finished rendering track(s).",f.map(e=>e.id)),p={selector:c},d(a.trackActions.renderTracksFinish(f.map(e=>e.id),p)),{trackIds:f.map(e=>e.id),selector:c}},removeTracks:async function(e,r){const{dispatch:o}=n;o(a.trackActions.removeTracks(e,{selector:r})),l.info(`Removing track(s) from element ${(0,s.logCssSelector)(r)}.`,e),await Promise.all(e.map(async e=>{await t.renderer.unrenderTrack(e,r)})),l.info("Finished removing track(s).",e),o(a.trackActions.removeTracksFinish(e,{selector:r}))},muteTracks:async function(e){const{dispatch:r}=n;if(r(a.trackActions.muteTracks(e)),l.info("Muting track(s).",e),e&&e instanceof Array&&e.length>0){const n=(await t.track.getTracks()).filter(t=>e.includes(t.id));Promise.all(n.map(e=>e.mute()));const o=n.map(e=>e.id);return l.info("Finished muting track(s).",o),r(a.trackActions.muteTracksFinish(o)),o}{const t="Failed to mute tracks. trackIds is missing (or empty) from request.";l.info(t,e);const n={};throw n.error=new i.default({message:t,code:i.webrtcCodes.INVALID_PARAM}),r(a.trackActions.muteTracksFinish(e,n)),{basicError:n.error,trackIds:e}}},unmuteTracks:async function(e){const{dispatch:r}=n;if(r(a.trackActions.unmuteTracks(e)),l.info("Unmuting track(s).",e),e&&e instanceof Array&&e.length>0){const n=(await t.track.getTracks()).filter(t=>e.includes(t.id));Promise.all(n.map(e=>e.unmute()));const o=n.map(e=>e.id);return l.info("Finished unmuting track(s).",o),r(a.trackActions.unmuteTracksFinish(o)),o}{const t="Failed to unmute tracks. trackIds is missing (or empty) from request.";l.info(t,e);const n={};throw n.error=new i.default({message:t,code:i.webrtcCodes.INVALID_PARAM}),r(a.trackActions.unmuteTracksFinish(e,n)),{basicError:n.error,trackIds:e}}},initializeDevices:async function(e){const{dispatch:r}=n;r(a.deviceActions.initializeDevice(e));try{const n=await t.devices.setupDeviceInitialization(e);if(n.error)throw n;l.info("Successfully initialized devices.",n),r(a.deviceActions.initializeDeviceFinish({devices:n}))}catch(e){throw l.info(`Encountered error while initializing devices: ${e.message}.`),r(a.deviceActions.initializeDeviceFinish({error:e})),e}}}},n(62234),n(69375),n(81045),n(42042),n(30163),n(45950),n(5350),n(84915);var r=c(n(73173)),o=c(n(54502)),a=n(66446),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),s=n(1011);function c(e){return e&&e.__esModule?e:{default:e}}},39817:(e,t,n)=>{var r=n(3905),o=n(81211);e.exports=function(e){return null==e?[]:r(e,o(e))}},39944:(e,t,n)=>{"use strict";var r=n(89055),o=Function.prototype.call;e.exports=r?o.bind(o):function(){return o.apply(o,arguments)}},39986:e=>{"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},t.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(e=>0===e.indexOf(n))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const r=e.substring(e.indexOf(" ")+1).split(";");for(let e=0;e<r.length;e++)n=r[e].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substring(t+1,r),n.value=e.substring(r+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],o=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&o?{usernameFragment:r.substring(12),password:o.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" ");n.profile=r[2];for(let o=3;o<r.length;o++){const a=r[o],i=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(i){const r=t.parseRtpMap(i),o=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(r.parameters=o.length?t.parseFmtp(o[0]):{},r.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),n.codecs.push(r),r.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(r.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach(e=>{n.headerExtensions.push(t.parseExtmap(e))});const o=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(e=>{o.forEach(t=>{e.rtcpFeedback.find(e=>e.type===t.type&&e.parameter===t.parameter)||e.rtcpFeedback.push(t)})}),n},t.writeRtpDescription=function(e,n){let r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=n.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(e=>{r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)});let o=0;return n.codecs.forEach(e=>{e.maxptime>o&&(o=e.maxptime)}),o>0&&(r+="a=maxptime:"+o+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(e=>{r+=t.writeExtmap(e)}),r},t.parseRtpEncodingParameters=function(e){const n=[],r=t.parseRtpParameters(e),o=-1!==r.fecMechanisms.indexOf("RED"),a=-1!==r.fecMechanisms.indexOf("ULPFEC"),i=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),s=i.length>0&&i[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substring(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),r.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),o&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach(e=>{e.maxBitrate=u})),n},t.parseRtcpParameters=function(e){const n={},r=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);const o=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=o.length>0,n.compound=0===o.length;const a=t.matchPrefix(e,"a=rtcp-mux");return n.mux=a.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const r=t.matchPrefix(e,"a=msid:");if(1===r.length)return n=r[0].substring(7).split(" "),{stream:n[0],track:n[1]};const o=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return o.length>0?(n=o[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),r=t.matchPrefix(e,"a=max-message-size:");let o;r.length>0&&(o=parseInt(r[0].substring(19),10)),isNaN(o)&&(o=65536);const a=t.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:n.fmt,maxMessageSize:o};const i=t.matchPrefix(e,"a=sctpmap:");if(i.length>0){const e=i[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:o}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,r){let o;const a=void 0!==n?n:2;return o=e||t.generateSessionId(),"v=0\r\no="+(r||"thisisadapterortc")+" "+o+" "+a+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const r=t.splitLines(e);for(let e=0;e<r.length;e++)switch(r[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[e].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let e=0;e<n.length;e++)if(n[e].length<2||"="!==n[e].charAt(1))return!1;return!0},e.exports=t},40074:(e,t,n)=>{var r=n(90313),o=n(70310),a=n(23945),i=n(74535),s=a(function(e,t){if(null==e)return[];var n=t.length;return n>1&&i(e,t[0],t[1])?t=[]:n>2&&i(t[0],t[1],t[2])&&(t=[t[0]]),o(e,r(t,1),[])});e.exports=s},40091:(e,t,n)=>{var r=n(51340),o=n(24810),a=n(35636),i=n(26885),s=n(41580),c=n(25288),l=n(78763);e.exports=function e(t,n,u,d,f){t!==n&&a(n,function(a,c){if(f||(f=new r),s(a))i(t,n,c,u,e,d,f);else{var p=d?d(l(t,c),a,c+"",t,n,f):void 0;void 0===p&&(p=a),o(t,c,p)}},c)}},40105:(e,t,n)=>{var r=n(65111),o=n(3334),a=n(41393),i=n(53142);e.exports=function(e,t){return(i(e)?r:a)(e,o(t,3))}},40168:(e,t,n)=>{"use strict";var r=n(10746),o=n(66209),a=r("keys");e.exports=function(e){return a[e]||(a[e]=o(e))}},40193:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=n},40271:(e,t,n)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.logManager=void 0;const o=(0,((r=n(44413))&&r.__esModule?r:{default:r}).default)({level:"DEBUG"});t.logManager=o},40276:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=r.logManager.getLogger("Manager","Media"),n=e.trackManager,i=new Map,s=new a.default;function c(e){for(const t in e)if(e[t]&&"object"==typeof e[t]&&"string"==typeof e[t].deviceId){const n=e[t].deviceId;e[t].deviceId={exact:n}}return e}function l(e,r,a){const i=new o.default(e,!0);return t.debug(`Creating Media with ID: ${i.id}.`),e.getTracks().forEach(t=>{const o=n.add(t,r||t.kind,e,!0,a);i.addTrack(o)}),i.once("media:stopped",e=>{u(e)}),i.on("track:ended",e=>{let{mediaId:t,trackId:n}=e;0===i.getTracks().length&&u(t)}),i.on("track:muted",e=>{let{mediaId:t,trackId:n}=e}),i}function u(e){d(e)&&(i.delete(e),s.emit("media:removed",e))}function d(e){const n=i.get(e);return n||t.debug(`No media found with ID: ${e}.`),n}function f(){return Array.from(i.keys())}return{get:d,getAll:f,getState:function(){return f().map(e=>d(e).getState())},findTrack:function(e){const n=Array.from(i.values()).find(t=>t.getTrack(e));if(n)return t.debug(`Found Media (${n.id}) with Track ${e}.`),n.id;t.debug(`Found no Media with Track ${e}.`)},createLocal:function(e,t){const n=c(e);return new Promise((e,r)=>{navigator.mediaDevices.getUserMedia(n).then(n=>{const r=l(n,void 0,t);i.set(r.id,r),s.emit("media:new",r.id),e(r)}).catch(r)})},createLocalScreen:function(e,t){const n=c(e);return new Promise((e,r)=>{navigator.mediaDevices.getDisplayMedia(n).then(n=>{const r=l(n,"screen",t);i.set(r.id,r),s.emit("media:new",r.id),e(r)}).catch(r)})},createRemote:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=new o.default(e,!1);return t.forEach(e=>{n.addTrack(e)}),n.once("media:stopped",e=>{u(e)}),n.on("track:ended",e=>{let{mediaId:t,trackId:r}=e;0===n.getTracks().length&&u(t)}),i.set(n.id,n),s.emit("media:new",n.id),n},on:function(){return s.on(...arguments)},once:function(){return s.once(...arguments)},off:function(){return s.off(...arguments)}}},n(81045),n(45950),n(5350),n(84915);var r=n(40271),o=i(n(87237)),a=i(n(19353));function i(e){return e&&e.__esModule?e:{default:e}}},40286:(e,t,n)=>{"use strict";var r=n(4578),o=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new o("Incorrect invocation")}},40347:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLICK_TO_CALL_STARTED=t.CLICK_TO_CALL_ERROR=void 0,t.CLICK_TO_CALL_STARTED="clickToCall:start",t.CLICK_TO_CALL_ERROR="clickToCall:error"},40449:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCodecRemover=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e=e.map(e=>"string"==typeof e?{name:e}:e),function(t,n,r){const o=e.map(e=>e.name);return t.media.forEach(t=>{const n=[];let r=[];r=t.rtp.filter(e=>o.includes(e.codec)),r.forEach(r=>{e.filter(e=>e.name===r.codec).forEach(e=>{!e.fmtpParams||e.fmtpParams&&0===e.fmtpParams.length?n.push(r.payload):t.fmtp.forEach(t=>{t.payload===r.payload&&e.fmtpParams.every(e=>t.config.includes(e))&&n.push(r.payload)})})}),t.fmtp.forEach(e=>{if(e.config.includes("apt=")){var t=parseInt(e.config.replace("apt=",""));n.includes(t)&&n.push(e.payload)}});let a=!1;if("number"==typeof t.payloads&&(t.payloads=t.payloads.toString(),a=!0),t.payloads){const e=t.payloads.split(" ").length;n.length>=e&&n.splice(e-1,n.length-e+1),t.payloads=t.payloads.split(" ").filter(e=>!n.includes(parseInt(e))).join(" ")}t.payloads&&a&&(t.payloads=parseInt(t.payloads)),t.rtp=t.rtp.filter(e=>!n.includes(e.payload)),t.fmtp=t.fmtp.filter(e=>!n.includes(e.payload)),t.rtcpFb&&(t.rtcpFb=t.rtcpFb.filter(e=>!n.includes(e.payload)))}),t}},n(62234),n(69375),n(81045),n(42042),n(30163),n(5350),n(84915)},40481:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveCalls=function(e){const t=[r.CALL_STATES.ENDED,r.CALL_STATES.CANCELLED];return o(e).filter(e=>!t.includes(e.state))},t.getCallById=function(e,t){return o(e).find(e=>e.id===t)},t.getCallByWebrtcSessionId=function(e,t){return o(e).find(e=>e.webrtcSessionId===t)},t.getCallByWrtcsSessionId=function(e,t){return o(e).find(e=>e.wrtcsSessionId===t)},t.getCalls=o,t.getOptions=function(e){return e.config.call},t.getTurnInfo=function(e){return e.call.turn},n(62234),n(81045),n(30163),n(45950);var r=n(77126);function o(e){return e.call.calls}},40593:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createConversation=function(e,t){return{type:r.CREATE_CONVERSATION,payload:{destination:e,messages:[],isTypingList:[],...t}}},t.deleteConversation=function(e,t){return{type:r.DELETE_CONVERSATION,payload:{destination:e,type:t}}},t.deleteConversationFinish=function(e){let{destination:t,type:n,error:o}=e;return{type:r.DELETE_CONVERSATION_FINISH,payload:o||{destination:t,type:n},error:!!o}},t.fetchConversations=function(e){return{type:r.FETCH_CONVERSATIONS,payload:{...e}}},t.fetchConversationsFinished=function(e){let{conversations:t,error:n}=e;return{type:r.FETCH_CONVERSATIONS_FINISHED,payload:n||{conversations:t},error:Boolean(n)}},t.updateConversation=function(e){return{type:r.UPDATE_CONVERSATION,payload:e}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(87834))},40603:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESPONSE=t.REQUEST=t.AUTHORIZATION_ERROR=void 0;const n="@@KANDY/";t.REQUEST=n+"REQUEST",t.RESPONSE=n+"RESPONSE",t.AUTHORIZATION_ERROR=n+"AUTHORIZATION_ERROR"},40646:(e,t,n)=>{"use strict";var r=n(89055),o=Function.prototype,a=o.apply,i=o.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?i.bind(a):function(){return i.apply(a,arguments)})},40751:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanupWebSocket=function(e){e.close&&e.close(),e.onclose=null,e.onmessage=null,e.onopen=null,e.onerror=null},t.openWebsocket=function(e){const t=`${e.protocol}://${e.server}:${e.port}${e.url}`+(0,o.default)(e.params);a.debug(`Opening socket at: ${t}`);const n=new WebSocket(t);return new Promise((e,t)=>{n.onopen=function(){n.onopen=null,n.onerror=null,e(n)},n.onerror=function(){n.onopen=null,n.onerror=null,t({error:!0,message:"Could not connect to websocket. Received error on open."})}})};var r,o=(r=n(2633))&&r.__esModule?r:{default:r};const a=n(69932).logManager.getLogger("CONNECTIVITY")},40839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s){const c=(0,r.getCallById)(e,t);if(!c)return new i.default({message:`Failed to answer call. Call ${t} not found.`,code:i.callCodes.INVALID_PARAM});if(![o.CALL_STATES.INITIATED,o.CALL_STATES.RINGING].includes(c.state))return new i.default({message:`Failed to answer call. Call must be in ${o.CALL_STATES.INITIATED} or ${o.CALL_STATES.RINGING} state.`,code:i.callCodes.INVALID_STATE});if(c.direction!==o.CALL_DIRECTION.INCOMING)return new i.default({message:"Failed to answer call. Call must be incoming.",code:i.callCodes.INVALID_STATE});if(c.isSlowStart)return new i.default({message:"Failed to answer call. Call is slow-start.",code:i.callCodes.INVALID_STATE});for(const[e,t]of Object.entries(n))if(t&&"medias"!==e){const t="screen"===e?"video":e;if(!(t in c.mediaOffered)||!c.mediaOffered[t])return new i.default({message:`Failed to answer call by offering '${e}': Incoming call did not offer this media.`,code:i.callCodes.INVALID_PARAM})}try{(0,a.validateMediaConstraints)(n)}catch(e){return e}if(n.medias)try{(0,a.validateDetachedMedia)(n.medias)}catch(e){return e}},n(62234);var r=n(40481),o=n(77126),a=n(9066),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},40943:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_SUBSCRIPTION_CHANGED=t.EVENT_RECEIVED=t.EVENT_ERROR=void 0,t.EVENT_SUBSCRIPTION_CHANGED="sip:subscriptionChange",t.EVENT_ERROR="sip:error",t.EVENT_RECEIVED="sip:eventsChange"},41100:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,ClickToCallOperations:i,logManager:s,API_LOG_TAG:c}=e,l=s.getLogger("CLICKTOCALL");return{clickToCall:{make:function(e,t){l.debug(c+"clickToCall.make: ",e,t);const o=(0,a.v4)();return i.clickToCall(o,e,t).then(()=>{n(r.CLICK_TO_CALL_STARTED,{callId:o})}).catch(e=>{n(r.CLICK_TO_CALL_ERROR,{callId:o,error:e})}),o},get:function(){return l.debug(c+"clickToCall.get"),(0,o.getAll)(t.getState())}}}};var r=n(40347),o=n(59534),a=n(84596)},41181:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MWI_UPDATE=void 0,t.MWI_UPDATE="@@KANDY/MWI_UPDATE"},41369:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,context:n,NotificationsOperations:a,emitEvent:i,API_LOG_TAG:s}=e,c=t.getLogger("NOTIFICATIONS");return{notification:{process:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PUSH";c.debug(s+"notification.process: ",e,t),n.dispatch(r.externalNotification(e,t)),a.processNotification(e,t).catch(()=>{})},processAsync:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PUSH";c.debug(s+"notification.processAsync: ",e,t),n.dispatch(r.externalNotification(e,t)),await a.processNotification(e,t)},registerApplePush:function(e){let{services:t,voipDeviceToken:o,standardDeviceToken:i,bundleId:l,clientCorrelator:u,realm:d,isProduction:f}=e;return c.debug(s+"notification.registerApplePush",arguments),n.dispatch(r.registerApplePushNotification({services:t,voipDeviceToken:o,standardDeviceToken:i,bundleId:l,clientCorrelator:u,realm:d,isProduction:f})),a.registerPushDeviceToken({services:t,voipDeviceToken:o,standardDeviceToken:i,bundleId:l,clientCorrelator:u,realm:d,isProduction:f,pushProvider:"apple"})},registerAndroidPush:function(e){let{services:t,deviceToken:o,bundleId:i,clientCorrelator:l,realm:u}=e;return c.debug(s+"notification.registerAndroidPush",arguments),n.dispatch(r.registerAndroidPushNotification({services:t,deviceToken:o,bundleId:i,clientCorrelator:l,realm:u})),a.registerPushDeviceToken({services:t,deviceToken:o,bundleId:i,clientCorrelator:l,realm:u,pushProvider:"google"})},unregisterApplePush:function(e){return c.debug(s+"notification.unregisterPush"),n.dispatch(r.unregisterApplePushNotification(e)),a.unregisterPushDeviceToken(e)},unregisterAndroidPush:function(e){return c.debug(s+"notification.unregisterPush"),n.dispatch(r.unregisterAndroidPushNotification(e)),a.unregisterPushDeviceToken(e)},enableWebsocket:async function(e){c.debug(s+"notification.enableWebsocket: ",e),n.dispatch(r.enableNotificationChannel("WEBSOCKET",{channelEnabled:e}));try{await a.enableWebsocketChannel(e,"WEBSOCKET"),i(o.NOTI_CHANGE,{channel:"WEBSOCKET"})}catch(e){i(o.NOTI_ERROR,{channel:"WEBSOCKET",error:e})}}}}};var r=a(n(50130)),o=a(n(99644));function a(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(a=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},41393:(e,t,n)=>{var r=n(84570),o=n(36529);e.exports=function(e,t){var n=-1,a=o(e)?Array(e.length):[];return r(e,function(e,r,o){a[++n]=t(e,r,o)}),a}},41439:(e,t,n)=>{var r=n(75857),o=n(75234),a=n(80796);e.exports=function(e){return a(o(e,void 0,r),e+"")}},41516:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.CallHistoryOperations;return e=>n=>{const o=e(n);switch(n.type){case r.END_CALL_FINISH:case r.REJECT_CALL_FINISH:n.payload.id&&t.storeCallLog(n.payload.id,n.payload.transition)}return o}};var r=n(21836)},41534:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){async function r(e,r){await n.remoteSuccess(e,r),t.reportEvent.endEvent(),t.tracker.finish()}async function a(e,r){const o=await n.remoteFailure(e,r);throw t.reportEvent.endEvent(o),t.tracker.finish(o),o}return{start:(0,o.default)(e,t,n).start,receiveResponse:async function(e,t){return("sessionComplete"===t.eventType?r:a)(e,t)}}};var r,o=(r=n(98307))&&r.__esModule?r:{default:r}},41580:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},41600:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(const t in r)r[t](e);(0,s.default)(e),(0,o.default)(e),(0,a.default)(e),(0,c.default)(e),(0,i.default)(e)};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(74043)),o=l(n(52410)),a=l(n(15156)),i=l(n(11352)),s=l(n(58384)),c=l(n(63858));function l(e){return e&&e.__esModule?e:{default:e}}},41743:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s){const c=i.default.parse(t),l=Object.freeze(c);let u=(0,a.default)(l);if((0,o.default)(e)){const t=e.map((e,t)=>e.name||`<anonymous> at index ${t}`);s.debug(`Running SDP handlers: ${t}`),e.forEach((e,o)=>{const a=t[o];if((0,r.default)(e))try{u=e(u,n,l)}catch(e){s.info(`Currently running pipeline to ${n.step} ${n.endpoint} ${n.type} for callId: ${n.callId}`),s.error(`Error running SDP handler: ${a}`,e)}else s.error("SDP handler not a function; skipping.")})}return i.default.write(u)},n(81045),n(5350),n(84915);var r=s(n(30524)),o=s(n(90283)),a=s(n(89321)),i=s(n(54722));function s(e){return e&&e.__esModule?e:{default:e}}},41753:()=>{},41768:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,l.default)(e);for(const t in c)c[t](e);return e.factory("CallRequests",a.default),e.defer(function(e){const{context:n,logManager:o}=e,a=o.getLogger("CALL"),{mediaDevices:s,peerConnection:c}=(0,d.getWebRTCSupportCapabilities)();s&&c||a.warn("Calls are not supported on this platform due to lack of WebRTC support. Call APIs will not be available."),t=(0,i.default)(t),t=(0,i.mergeDefaults)(t);const l=(0,d.getBrowserDetails)();"unified-plan"!==t.defaultPeerConfig.sdpSemantics&&(a.warn("Only `unified-plan` is supported as sdpSemantics. Switching to `unified-plan`."),t.defaultPeerConfig.sdpSemantics="unified-plan"),"firefox"===l.browser&&!0===t.earlyMedia&&(a.warn("Firefox does not support pranswer for Early Media. Disabling early media configuration."),t.earlyMedia=!1),"chrome"===l.browser&&l.version>=110&&t.defaultPeerConfig.iceServers&&t.defaultPeerConfig.iceServers.forEach(e=>{Array.isArray(e.urls)?e.urls=e.urls.map(i.fixIceServerUrls):e.urls&&(e.urls=(0,i.fixIceServerUrls)(e.urls))}),n.dispatch((0,u.update)(t,r.default.name)),void 0!==t.removeH264Codecs&&a.warn("The `call.removeH264Codecs` configuration has been removed. Please see the documentation for the `sdpHandlers` configuration for how to implement similar behaviour."),n.dispatch((0,u.setSdpHandlers)(t.sdpHandlers))}),{api:r.default.createAPI,name:r.default.name,reducer:r.default.reducer,middleware:o.default,capabilities:["call","link_call","link_user_id","link_pstn"],cleanup:s.default}},n(81045),n(5350),n(84915);var r=p(n(9647)),o=p(n(12661)),a=p(n(5703)),i=f(n(16556));n(54628);var s=p(n(73640)),c=f(n(88131)),l=p(n(41600)),u=n(87310),d=n(37654);function f(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(f=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}function p(e){return e&&e.__esModule?e:{default:e}}},41905:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(62234),n(81045),n(30163),n(45950),n(84915);var r=f(n(43813)),o=f(n(35968)),a=d(n(21836)),i=d(n(81997)),s=n(77126),c=n(59090),l=f(n(48475)),u=n(45775);function d(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(d=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}function f(e){return e&&e.__esModule?e:{default:e}}const p=(e,t)=>e,g=(e,t)=>{const n=Date.now();return{...e,state:s.CALL_STATES.ENDED,startTime:e.startTime||n,endTime:n,remoteParticipant:{...e.remoteParticipant,...t.payload.remoteParticipant},mediaConnectionState:"closed",isPending:void 0,localTracks:[],remoteTracks:[]}},_={},E={};_[a.MAKE_CALL]={next(e,t){const n={id:t.payload.id,remoteParticipant:{displayNumber:t.payload.participantAddress,displayName:t.payload.participantName},to:t.payload.participantAddress,from:t.payload.from,mediaConstraints:t.payload.mediaConstraints,dscpControls:t.payload.dscpControls,state:s.CALL_STATES.INITIATING,direction:s.CALL_DIRECTION.OUTGOING,localHold:!1,remoteHold:!1,isCaller:!0,isAnonymous:t.payload.isAnonymous,account:t.payload.account,localTracks:[],remoteTracks:[],currentOperations:[]};return(0,o.default)(e,n)}},_[a.CALL_INCOMING]={next:(e,t)=>(0,o.default)(e,{...t.payload,direction:"incoming",isCaller:!1,state:s.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1,localTracks:[],remoteTracks:[],currentOperations:[]})},E[a.SEND_RINGING_FEEDBACK_FINISH]={next:(e,t)=>({...e,state:s.CALL_STATES.RINGING})},E[a.CALL_RINGING]={next:(e,t)=>t.payload.remoteParticipant?{...e,state:s.CALL_STATES.RINGING,remoteParticipant:t.payload.remoteParticipant}:{...e,state:s.CALL_STATES.RINGING}},E[a.SESSION_PROGRESS]={next:(e,t)=>({...e,state:s.CALL_STATES.EARLY_MEDIA,remoteParticipant:t.payload.remoteParticipant,remoteTracks:t.payload.remoteTracks})},E[a.PENDING_OPERATION]=p,E[a.REMOTE_SLOW_START]=p;const y=(e,t)=>({...e,isHandling:!0});E[a.ANSWER_CALL]=y,E[a.REJECT_CALL]=y,E[a.FORWARD_CALL]=y,E[a.CALL_CANCELLED]={next:(e,t)=>({...e,state:s.CALL_STATES.CANCELLED})},E[a.IGNORE_CALL_FINISH]={next:(e,t)=>{const n=Date.now();return{...e,startTime:n,endTime:n,state:s.CALL_STATES.ENDED}},throw:(e,t)=>e},E[a.REJECT_CALL_FINISH]={next:(e,t)=>{const n=Date.now(),r={...e,startTime:n,endTime:n,state:s.CALL_STATES.ENDED};return delete r.isHandling,r},throw:(e,t)=>e},E[a.SESSION_CREATED]={next:(e,t)=>({...e,webrtcSessionId:t.payload.webrtcSessionId})},E[a.PENDING_MAKE_CALL]={next:(e,t)=>({...e,state:s.CALL_STATES.INITIATED,wrtcsSessionId:t.payload.wrtcsSessionId,webrtcSessionId:t.payload.webrtcSessionId,bandwidth:t.payload.bandwidth,displayName:t.payload.displayName,customParameters:t.payload.customParameters,customBodies:t.payload.customBodies,localTracks:t.payload.localTracks})},E[a.MAKE_CALL_FINISH]={next:(e,t)=>({...e,...t.payload}),throw:(e,t)=>({...e,...t.payload})},E[a.MAKE_ANONYMOUS_CALL_FINISH]={next:(e,t)=>e,throw:g},E[a.ANSWER_CALL_FINISH]={next(e,t){const n=t.payload.webrtcSessionId||e.webrtcSessionId,r={...e,state:t.payload.state,mediaConstraints:t.payload.mediaConstraints,dscpControls:t.payload.dscpControls,webrtcSessionId:n,localHold:!1,remoteHold:!1,bandwidth:t.payload.bandwidth,customParameters:t.payload.customParameters,customBodies:t.payload.customBodies,localTracks:t.payload.localTracks,remoteTracks:t.payload.remoteTracks};return t.meta&&!t.meta.isSlowStart&&(r.startTime=t.payload.startTime),r.state===s.CALL_STATES.CONNECTED&&delete r.isHandling,r},throw(e,t){const n={...e,...t.payload};return delete n.isHandling,n}},E[a.CALL_ACCEPTED]={next(e,t){const n={...e,...t.payload};return n.isHandling&&n.state===s.CALL_STATES.CONNECTED&&delete n.isHandling,n},throw(e,t){const n=t.payload.state||e.state;return{...e,state:n}}},E[a.END_CALL_FINISH]=g,E[a.UPDATE_CALL]={next(e,t){const{transition:n,localTracks:r,remoteTracks:o,...a}=t.payload,i={...e,...a};if(o&&o.length>0&&(i.remoteTracks=o),t.meta&&!0===t.meta.isRemote){const e=i.currentOperations.find(e=>!e.isLocal&&e.type===c.OPERATIONS.SLOW_START&&e.status===c.OP_STATUS.ONGOING);e&&(i.currentOperations=i.currentOperations.filter(t=>t.id!==e.id))}return i}},E[a.CALL_HOLD_FINISH]={next(e,t){const n=t.payload.remoteTracks,r=e.remoteTracks.filter(e=>!n.includes(e)),{localTracks:o}=t.payload,a=e.localTracks.filter(e=>!o.includes(e));return{...e,localHold:!0,state:s.CALL_STATES.ON_HOLD,localTracks:a,remoteTracks:r}}},E[a.CALL_UNHOLD_FINISH]={next(e,t){const n=t.payload.remoteTracks,o=(0,r.default)(e.remoteTracks,n),{localTracks:a}=t.payload,i=(0,r.default)(e.localTracks,a),c=e.remoteHold?s.CALL_STATES.ON_HOLD:s.CALL_STATES.CONNECTED;return{...e,localHold:!1,state:c,localTracks:i,remoteTracks:o}}},E[a.SET_CUSTOM_PARAMETERS]={next:(e,t)=>({...e,customParameters:t.payload.customParameters,customBodies:t.payload.customBodies})},E[a.SEND_CUSTOM_PARAMETERS_FINISH]={next:(e,t)=>({...e,...t.payload})},E[a.CALL_REMOTE_HOLD_FINISH]={next(e,t){const n=t.payload.remoteTracks,r=e.remoteTracks.filter(e=>!n.includes(e)),o=t.payload.localTracks,a=e.localTracks.filter(e=>!o.includes(e));return{...e,remoteHold:!0,state:s.CALL_STATES.ON_HOLD,remoteParticipant:{...e.remoteParticipant,...t.payload.remoteParticipant},localTracks:a,remoteTracks:r}}},E[a.CALL_REMOTE_UNHOLD_FINISH]={next(e,t){const n=t.payload.remoteTracks,o=t.payload.localTracks,a=(0,r.default)(e.localTracks,o),i=e.localHold?s.CALL_STATES.ON_HOLD:s.CALL_STATES.CONNECTED,c={...e,remoteHold:!1,state:i,remoteParticipant:{...e.remoteParticipant,...t.payload.remoteParticipant},localTracks:a,remoteTracks:n};return!0===c.hasMOH&&(c.hasMOH=!1),c}},E[a.REMOTE_ADD_MEDIA_FINISH]={next(e,t){const n=t.payload.remoteTracks,o=(0,r.default)(e.remoteTracks,n);return{...e,remoteTracks:o}}},E[a.REMOTE_REMOVE_MEDIA_FINISH]={next(e,t){const n=t.payload.remoteTracks,r=e.remoteTracks.filter(e=>!n.includes(e));return{...e,remoteTracks:r}}},E[a.REMOTE_START_MOH_FINISH]={next(e,t){const n=t.payload.remoteTracks,o=(0,r.default)(e.remoteTracks,n);return{...e,hasMOH:!0,remoteTracks:o}}},E[a.REMOTE_STOP_MOH_FINISH]={next(e,t){const n=t.payload.remoteTracks,r=e.remoteTracks.filter(e=>!n.includes(e));return{...e,hasMOH:!1,remoteTracks:r}}},E[a.FORWARD_CALL_FINISH]={next(e,t){const n={...e,state:s.CALL_STATES.ENDED};return delete n.isHandling,n}},E[a.DIRECT_TRANSFER_FINISH]={next:g},_[a.CONSULTATIVE_TRANSFER_FINISH]={next:(e,t)=>e.map(e=>e.id===t.payload.id||e.id===t.payload.otherCallId?g(e,t):e),throw:(e,t)=>e},_[a.JOIN_START]={next(e,t){const n={id:t.payload.id,remoteParticipant:{displayNumber:t.payload.participantAddress,displayName:t.payload.participantName},to:t.payload.participantAddress,from:t.payload.from,mediaConstraints:t.payload.mediaConstraints,state:s.CALL_STATES.INITIATING,direction:s.CALL_DIRECTION.OUTGOING,localHold:!1,remoteHold:!1,isCaller:!0,isJoinedCall:!0,customParameters:t.payload.customParameters,bandwidth:t.payload.bandwidth,dscpControls:t.payload.dscpControls,localTracks:[],remoteTracks:[],currentOperations:[{isLocal:!0,id:t.payload.operationId,type:c.OPERATIONS.JOIN,status:c.OP_STATUS.ONGOING,eventId:t.payload.eventId}]};return(0,o.default)(e,n)}},_[a.PENDING_JOIN]={next:(e,t)=>e.map(e=>e.id===t.payload.id?{...e,wrtcsSessionId:t.payload.wrtcsSessionId,webrtcSessionId:t.payload.webrtcSessionId,localTracks:t.payload.localTracks,state:t.payload.state}:e)},_[a.JOIN_FINISH]={next:(e,t)=>e.map(e=>e.id===t.payload.id||t.payload.usedCallIds&&t.payload.usedCallIds.includes(e.id)?g(e,t):e),throw:(e,t)=>e.map(e=>e.id===t.payload.id&&t.payload.usedCallIds&&!t.payload.usedCallIds.includes(e.id)?g(e,t):e)},E[a.ADD_MEDIA_FINISH]={next(e,t){const n=t.payload.localTracks;return{...e,bandwidth:t.payload.bandwidth,localTracks:e.localTracks.concat(n)}}},E[a.REMOVE_MEDIA_FINISH]={next(e,t){const n=t.payload.localTracks,r=e.localTracks.filter(e=>!n.includes(e));return{...e,bandwidth:t.payload.bandwidth,localTracks:r}}},E[a.REPLACE_TRACK_FINISH]={next(e,t){const n=t.payload.oldTrackState.id,r=t.payload.newTrackId,o=e.localTracks.filter(e=>e!==n).concat(r);return{...e,localTracks:o}}},E[i.SESSION_ICE_CONNECTION_STATE_CHANGE]={next:(e,t)=>({...e,mediaConnectionState:t.payload.iceConnectionState})};const S=(0,u.handleActions)(E,{}),v=(0,u.combineActions)(a.PENDING_OPERATION,a.PENDING_MAKE_CALL,a.MAKE_CALL_FINISH,a.MAKE_ANONYMOUS_CALL_FINISH,a.ANSWER_CALL,a.ANSWER_CALL_FINISH,a.REJECT_CALL,a.REJECT_CALL_FINISH,a.CALL_ACCEPTED,a.SEND_RINGING_FEEDBACK_FINISH,a.CALL_RINGING,a.SESSION_PROGRESS,a.CALL_CANCELLED,a.IGNORE_CALL_FINISH,a.END_CALL_FINISH,a.CALL_HOLD_FINISH,a.CALL_UNHOLD_FINISH,a.SET_CUSTOM_PARAMETERS,a.SEND_CUSTOM_PARAMETERS_FINISH,a.CALL_REMOTE_HOLD_FINISH,a.CALL_REMOTE_UNHOLD_FINISH,a.REMOTE_ADD_MEDIA_FINISH,a.REMOTE_REMOVE_MEDIA_FINISH,a.ADD_MEDIA_FINISH,a.REMOVE_MEDIA_FINISH,a.UPDATE_CALL,a.FORWARD_CALL,a.FORWARD_CALL_FINISH,a.DIRECT_TRANSFER_FINISH,a.REPLACE_TRACK_FINISH,a.MEDIA_RESTART,a.MEDIA_RESTART_FINISH,a.REMOTE_SLOW_START,a.REMOTE_START_MOH_FINISH,a.REMOTE_STOP_MOH_FINISH,a.SESSION_CREATED,a.OPERATION_UPDATE),h=(0,u.combineActions)(i.SESSION_ICE_CONNECTION_STATE_CHANGE);_[v]=(e,t)=>e.map(function(e){if(e.id===t.payload.id){let n=S(e,t);return n=(0,l.default)(n,t),n}return e}),_[h]=(e,t)=>e.map(function(e){return e.webrtcSessionId===t.payload.id?S(e,t):e});const T=(0,u.handleActions)(_,[]);t.default=T},41950:(e,t,n)=>{var r=n(78942)["__core-js_shared__"];e.exports=r},42042:(e,t,n)=>{"use strict";n(2989)},42140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=n=>{e.checkDevices().then(e=>{const a=r.deviceActions.devicesChanged(e),i=n?void 0:{type:o.DEVICES_CHANGED,args:{}};t(a,i)})};return e.on("change",n),()=>{e.off("change",n)}};var r=n(66446),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51709))},42340:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addContact=function(e){return{type:r.ADD_CONTACT,payload:e}},t.addContactFinish=function(e){let{contact:t,error:n}=e;return{payload:n||t,error:Boolean(n),type:r.ADD_CONTACT_FINISH}},t.fetchContact=function(e){return{type:r.FETCH_CONTACT,payload:e}},t.fetchContactFinish=function(e){let{contact:t,error:n}=e;return{type:r.FETCH_CONTACT_FINISH,payload:n||t,error:Boolean(n)}},t.refreshContacts=function(){return{type:r.REFRESH_CONTACTS,payload:null}},t.refreshContactsFinish=function(e){let{contacts:t,error:n}=e;return{type:r.REFRESH_CONTACTS_FINISH,payload:n||t,error:Boolean(n)}},t.removeContact=function(e){return{type:r.REMOVE_CONTACT,payload:e}},t.removeContactFinish=function(e){let{contactId:t,error:n}=e;return{type:r.REMOVE_CONTACT_FINISH,payload:t||n,error:!!n}},t.updateContact=function(e){return{type:r.UPDATE_CONTACT,payload:e}},t.updateContactFinish=function(e){let{contact:t,error:n}=e;return{type:r.UPDATE_CONTACT_FINISH,payload:n||t,error:!!n}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(28686))},42344:(e,t,n)=>{"use strict";var r=n(30290),o=n(6032);e.exports=function(e){var t=r(e,"string");return o(t)?t:t+""}},42443:(e,t,n)=>{var r=n(86912),o=n(64364),a=n(23504),i=n(34216),s=n(36850),c=n(8813),l=n(78942);e.exports=function(e,t,n){var u=o(e);return function o(){for(var d=arguments.length,f=Array(d),p=d,g=s(o);p--;)f[p]=arguments[p];var _=d<3&&f[0]!==g&&f[d-1]!==g?[]:c(f,g);return(d-=_.length)<n?i(e,t,a,o.placeholder,void 0,f,_,void 0,void 0,n-d):r(this&&this!==l&&this instanceof o?u:e,this,f)}}},42501:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{timestamp:t,level:n,target:r}=e,o=r.id&&r.id.length>8?r.id.substring(0,6):r.id;return`${`${t} - ${o?`${r.type}/${o}`:r.type} - ${n}`} - ${e.messages[0]}`}},42613:(e,t,n)=>{var r=n(65111),o=n(84354),a=n(53142),i=n(51187),s=n(96493),c=n(66040),l=n(95243);e.exports=function(e){return a(e)?r(e,c):i(e)?[e]:o(s(l(e)))}},42712:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(40193)),o=i(n(74089)),a=n(46585);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const i=(e=e||{}).random||(e.rng||o.default)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return(0,a.unsafeStringify)(i)}},42791:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET_LEVEL=t.SET_HANDLER=t.LEVELS_CHANGE=t.HANDLERS_CHANGE=void 0;const n="@@KANDY/LOGS/";t.SET_LEVEL=n+"SET_LEVEL",t.LEVELS_CHANGE=n+"LEVELS_CHANGE",t.SET_HANDLER=n+"SET_HANDLER",t.HANDLERS_CHANGE=n+"HANDLERS_CHANGE"},42937:(e,t,n)=>{"use strict";var r=n(33243).has;e.exports=function(e){return r(e),e}},43086:(e,t,n)=>{"use strict";var r,o,a,i=n(45945),s=n(79117),c=n(80831),l=n(88088),u=n(74418),d=n(62694),f=n(40168),p=n(67588),g="Object already initialized",_=s.TypeError,E=s.WeakMap;if(i||d.state){var y=d.state||(d.state=new E);y.get=y.get,y.has=y.has,y.set=y.set,r=function(e,t){if(y.has(e))throw new _(g);return t.facade=e,y.set(e,t),t},o=function(e){return y.get(e)||{}},a=function(e){return y.has(e)}}else{var S=f("state");p[S]=!0,r=function(e,t){if(u(e,S))throw new _(g);return t.facade=e,l(e,S,t),t},o=function(e){return u(e,S)?e[S]:{}},a=function(e){return u(e,S)}}e.exports={set:r,get:o,has:a,enforce:function(e){return a(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw new _("Incompatible receiver, "+e+" required");return n}}}},43249:()=>{},43282:(e,t,n)=>{var r=n(12762),o=n(98880),a=n(65187),i=n(66040);e.exports=function(e){return a(e)?r(i(e)):o(e)}},43301:(e,t,n)=>{var r=n(6131),o=1/0;e.exports=function(e){return e?(e=r(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},43316:e=>{e.exports=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1}},43328:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(18470)),a=n(45775),i=(r=n(7485))&&r.__esModule?r:{default:r};const s={};s[o.CONFIG_UPDATE]={next:(e,t)=>(0,i.default)(e,t.payload)},s[o.SET_SDP_HANDLERS]={next:(e,t)=>({...e,call:{...e.call,sdpHandlers:t.payload.sdpHandlers}})};const c=(0,a.handleActions)(s,{});t.default=c},43375:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(42791)),o=n(45775);const a={};a[r.LEVELS_CHANGE]={next:(e,t)=>({...e,...t.payload})};const i=(0,o.handleActions)(a,{});t.default=i},43427:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container;return async function(a){if(!s(a))return;const c=a.payload.notificationMessage,{sessionData:l,reasonText:u,statusCode:d}=c.sessionParams,f=(0,r.getCallByWrtcsSessionId)(e.getState(),l);if(!f)return void n.getLogger("CALL").info(`Received ${c.eventType} notification for unknown call; ignoring.`);const p=(0,i.getDomain)(e.getState()),g=(0,o.getRemoteParticipant)(f,c,p),_={eventType:c.eventType,reasonText:u,statusCode:d,...g};await t.callStatusUpdateEnded(l,_)}},t.shouldHandlePattern=s;var r=n(40481),o=n(82481),a=n(70506),i=n(87075);function s(e){return e.type===a.NOTIFICATION_RECEIVED&&"callEnd"===e.payload.notificationMessage.eventType}},43565:(e,t)=>{t.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},t.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},t.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},t.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},t.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},t.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},t.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},t.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},t.realToAlias=function(){var e=Object.prototype.hasOwnProperty,n=t.aliasToReal,r={};for(var o in n){var a=n[o];e.call(r,a)?r[a].push(o):r[a]=[o]}return r}(),t.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},t.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},t.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}},43621:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.Callstack;return async function(e){a(e)&&t.operations.normalizeIceFailure(e.payload.id,e.payload.iceConnectionState)}},t.shouldHandlePattern=a;var r=n(81997),o=n(77126);function a(e){return e.type===r.SESSION_ICE_CONNECTION_STATE_CHANGE&&e.payload.iceConnectionState===o.CALL_MEDIA_CONNECTION_STATES.DISCONNECTED}},43636:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},43692:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{proxyPeer:e}=this;return e.getSenders().filter(e=>Boolean(e.track)).map(e=>e.track)},n(81045),n(30163),n(84915)},43813:(e,t,n)=>{var r=n(92673)("union",n(55620));r.placeholder=n(22991),e.exports=r},44130:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCredentialsError=function(e){return{type:r.SET_CREDENTIALS_ERROR,error:!0,payload:e}},t.setCredentialsFinished=function(e,t){return{type:r.SET_CREDENTIALS_FINISH,error:!1,payload:{userInfo:e,connection:t},meta:{isSensitive:!0}}},t.updateHmacToken=function(e){return{type:r.UPDATE_HMAC_TOKEN,payload:e,meta:{isSensitive:!0}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(97082))},44139:(e,t,n)=>{var r=n(46536);e.exports=function(e){return r(e).replace(/[\W_]+(.|$)/g,function(e,t){return t?" "+t:""}).trim()}},44166:(e,t,n)=>{"use strict";var r=n(14188),o=n(80831),a=n(5054);e.exports=function(e,t,n){var i,s;return a&&r(i=t.constructor)&&i!==n&&o(s=i.prototype)&&s!==n.prototype&&a(e,s),e}},44318:e=>{"use strict";e.exports=function(e){return null==e}},44413:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLevels=t.logFormatter=t.default=void 0;var r=i(n(64400)),o=i(n(42501)),a=n(75188);function i(e){return e&&e.__esModule?e:{default:e}}t.default=r.default,t.logLevels=a.logLevels,t.logFormatter=o.default},44511:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.PresenceOperations;return e=>n=>(n.type===r.NOTIFICATION_RECEIVED&&n.payload.notificationMessage&&"presenceWatcher"===n.payload.notificationMessage.eventType&&t.presenceReceived(n),e(n))};var r=n(70506)},44700:(e,t,n)=>{var r=n(79067);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},44717:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MWI_ERROR=t.MWI_CHANGE=void 0,t.MWI_CHANGE="voicemail:change",t.MWI_ERROR="voicemail:error"},44977:(e,t,n)=>{"use strict";var r=n(14188),o=n(13174),a=TypeError;e.exports=function(e){if(r(e))return e;throw new a(o(e)+" is not a function")}},44991:(e,t,n)=>{"use strict";function r(e){if("string"!=typeof e||e.length>1||!/[\d*#]+/.test(e))throw new Error("Invalid input for DTMF tone.");switch(e){case"1":return["697","1209"];case"2":return["697","1336"];case"3":return["697","1477"];case"4":return["770","1209"];case"5":return["770","1336"];case"6":return["770","1477"];case"7":return["852","1209"];case"8":return["852","1336"];case"9":return["852","1477"];case"0":return["941","1336"];case"*":return["941","1209"];case"#":return["941","1477"]}}function o(e){const t=e.match(/[\d*#]+/);if(!t||t[0]!==e)throw new Error("Invalid characters in tone.");return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.addTones=async function(e,t,n,a){const i=[e.createOscillator(),e.createOscillator()];i[0].type="sine",i[1].type="sine";const s=e.createGain();function c(e,t,n){i[0].frequency.setValueAtTime(e[0],t),i[0].frequency.setValueAtTime(0,t+n),i[1].frequency.setValueAtTime(e[1],t),i[1].frequency.setValueAtTime(0,t+n)}i[0].connect(s),i[1].connect(s),s.gain.value=.1,s.connect(t),s.connect(e.destination);const l=o(n).map(r),u=a.duration/1e3,d=a.gap/1e3;let f=e.currentTime;for(let e=0;e<l.length;e++)c(l[e],f,u),f=f+u+d;i[0].start(),i[1].start();const p=l.length*(a.duration+a.gap);await new Promise(e=>{setTimeout(e,p)}),s.disconnect(),i[0].stop(),i[0].disconnect(),i[1].stop(),i[1].disconnect()},t.convertTone=r,t.splitTones=o,n(97107),n(81045),n(84915)},45183:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlersChanged=function(e){return{type:r.HANDLERS_CHANGE,payload:e}},t.levelsChanged=function(e){return{type:r.LEVELS_CHANGE,payload:e}},t.setHandler=function(e,t){return{type:r.SET_HANDLER,payload:{handler:e,type:t}}},t.setLevel=function(e,t){return{type:r.SET_LEVEL,payload:{level:e,type:t}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(42791))},45207:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(97082)),o=n(45775);const a={};a[r.SET_CREDENTIALS_FINISH]={next:(e,t)=>({...e,error:void 0,connection:{...e.connection,...t.payload.connection},userInfo:t.payload.userInfo})},a[r.SET_CREDENTIALS_ERROR]={throw:(e,t)=>({...e,error:t.payload})},a[r.UPDATE_HMAC_TOKEN]={next(e,t){const{"x-token":n,...r}=e.connection.requestOptions.headers,o={...r,"x-session":t.payload};return{...e,connection:{...e.connection,requestOptions:{...e.connection.requestOptions,headers:o}}}}};const i=(0,o.handleActions)(a,{isConnected:!1,isPending:!1});t.default=i},45353:(e,t,n)=>{var r=n(58638);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,r(e,128,void 0,void 0,void 0,void 0,t)}},45370:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallstackSDP:n,CallReporter:l,WebRTC:u}=e;return async function(e){const{sessionId:d,bandwidth:f,tracks:p}=e,g=await u.track.getTracks(p),_=g.reduce((e,t,n)=>(0,r.default)(t)?e.concat(n):e,[]).map(e=>p[e]);if(!(0,o.default)(_)){const e=`The following invalid track ids were provided: ${_.join(", ")}`;throw new c.default({code:c.callCodes.INVALID_PARAM,message:e})}const E=await u.sessionManager.get(d),y=(0,a.getCallByWebrtcSessionId)(t.getState(),d),S=y.id,v=l.getReport(S),h=y.currentOperations.find(e=>e.isLocal&&[i.OPERATIONS.REMOVE_MEDIA,i.OPERATIONS.REMOVE_BASIC_MEDIA].includes(e.type)),T=v.getEvent(h.eventId);await E.removeTracks(p);try{await Promise.all(g.map(async e=>{if(!await e.isDetached())return e.stop()}))}catch(e){}const C=(0,a.getOptions)(t.getState());let I,m,O,A;try{A=T.addEvent(s.REPORT_EVENTS.CREATE_OFFER),I=await E.createOffer(),A.endEvent()}catch(e){const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw A.endEvent(t),t}try{I.sdp=n.runPipeline(C.sdpHandlers,I.sdp,{callId:S,type:I.type,step:"set",endpoint:"local",bandwidth:f}),O=T.addEvent(s.REPORT_EVENTS.PROCESS_MEDIA_LOCAL),O.addData("operation",s.REPORTER_OPERATION_EVENTS_MAP.REMOVE_MEDIA),I=await E.setLocalDescription(I),O.endEvent(),m=n.runPipeline(C.sdpHandlers,I.sdp,{callId:S,type:I.type,step:"send",endpoint:"local",bandwidth:f})}catch(e){const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw O.endEvent(t),t}return m}},n(62234),n(81045),n(45950),n(84915),n(55367);var r=l(n(54502)),o=l(n(84499)),a=n(40481),i=n(59090),s=n(84581),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412));function l(e){return e&&e.__esModule?e:{default:e}}},45590:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRESTTimeout=function(e){return e.config.requests.restTimeout}},45770:(e,t,n)=>{var r=n(36529);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var a=n.length,i=t?a:-1,s=Object(n);(t?i--:++i<a)&&!1!==o(s[i],i,s););return n}}},45775:(e,t,n)=>{"use strict";n.r(t),n.d(t,{combineActions:()=>p,createAction:()=>E,createActions:()=>L,createCurriedAction:()=>H,handleAction:()=>U,handleActions:()=>G});var r=n(78958),o=n.n(r);const a=function(e){return"function"==typeof e},i=function(e){return"symbol"==typeof e||"object"==typeof e&&"[object Symbol]"===Object.prototype.toString.call(e)},s=function(e){return 0===e.length},c=function(e){return e.toString()},l=function(e){return"string"==typeof e};var u="/",d="||";function f(e){return l(e)||a(e)||i(e)}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;o()(!s(r=t)&&r.every(f),"Expected action types to be strings, symbols, or action creators");var a=t.map(c).join(d);return{toString:function(){return a}}}const g=function(e){return e},_=function(e){return null===e};function E(e,t,n){void 0===t&&(t=g),o()(a(t)||_(t),"Expected payloadCreator to be a function, undefined or null");var r=_(t)||t===g?g:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return e instanceof Error?e:t.apply(void 0,[e].concat(r))},i=a(n),s=e.toString(),c=function(){var t=r.apply(void 0,arguments),o={type:e};return t instanceof Error&&(o.error=!0),void 0!==t&&(o.payload=t),i&&(o.meta=n.apply(void 0,arguments)),o};return c.toString=function(){return s},c}const y=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},S=function(e){return Array.isArray(e)},v=function(e){return null==e},h=function(e){return e[e.length-1]};var T=n(97935),C=n.n(T);const I=function(e){return-1===e.indexOf("/")?C()(e):e.split("/").map(C()).join("/")},m=function(e,t){return e.reduce(function(e,n){return t(e,n)},{})},O=function(e){return"undefined"!=typeof Map&&e instanceof Map};function A(e){if(O(e))return Array.from(e.keys());if("undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t}function R(e,t){return O(t)?t.get(e):t[e]}const b=function(e){return function t(n,r,o,a){var i=void 0===r?{}:r,s=i.namespace,c=void 0===s?u:s,l=i.prefix;return void 0===o&&(o={}),void 0===a&&(a=""),A(n).forEach(function(r){var i=function(e){return a||!l||l&&new RegExp("^"+l+c).test(e)?e:""+l+c+e}(function(e){var t;if(!a)return e;var n=e.toString().split(d),r=a.split(d);return(t=[]).concat.apply(t,r.map(function(e){return n.map(function(t){return""+e+c+t})})).join(d)}(r)),s=R(r,n);e(s)?t(s,{namespace:c,prefix:l},o,i):o[i]=s}),o}},N=b(y);function M(e,t){var n=void 0===t?{}:t,r=n.namespace,o=void 0===r?u:r,a=n.prefix;function i(t,n,r){var o=I(r.shift());s(r)?n[o]=e[t]:(n[o]||(n[o]={}),i(t,n[o],r))}var c={};return Object.getOwnPropertyNames(e).forEach(function(e){var t=a?e.replace(""+a+o,""):e;return i(e,c,t.split(o))}),c}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){P(e,t,n[t])})}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=y(h(n))?n.pop():{};return o()(n.every(l)&&(l(e)||y(e)),"Expected optional object followed by string action types"),l(e)?k([e].concat(n),a):w({},function(e,t){return M(D(N(e,t)),t)}(e,a),k(n,a))}function D(e,t){var n=void 0===t?{}:t,r=n.prefix,i=n.namespace,s=void 0===i?u:i;return m(Object.keys(e),function(t,n){var i,c=e[n];o()(function(e){if(a(e)||v(e))return!0;if(S(e)){var t=e[0],n=void 0===t?g:t,r=e[1];return a(n)&&a(r)}return!1}(c),"Expected function, undefined, null, or array with payload and meta functions for "+n);var l=r?""+r+s+n:n,u=S(c)?E.apply(void 0,[l].concat(c)):E(l,c);return w({},t,((i={})[n]=u,i))})}function k(e,t){var n=D(m(e,function(e,t){var n;return w({},e,((n={})[t]=g,n))}),t);return m(Object.keys(n),function(e,t){var r;return w({},e,((r={})[I(t)]=n[t],r))})}var j=n(57224),F=n.n(j);const H=function(e,t){return F()(E(e,t),t.length)},x=function(e){return void 0===e};function U(e,t,n){void 0===t&&(t=g);var r=c(e).split(d);o()(!x(n),"defaultState for reducer handling "+r.join(", ")+" should be defined"),o()(a(t)||y(t),"Expected reducer to be a function or object with next and throw reducers");var i=a(t)?[t,t]:[t.next,t.throw].map(function(e){return v(e)?g:e}),s=i[0],l=i[1];return function(e,t){void 0===e&&(e=n);var o=t.type;return o&&-1!==r.indexOf(c(o))?(!0===t.error?l:s)(e,t):e}}const W=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="function"!=typeof t[t.length-1]&&t.pop(),o=t;if(void 0===r)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var n=arguments.length,a=Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];var s=void 0===e,c=void 0===t;return s&&c&&r?r:o.reduce(function(e,n){return n.apply(void 0,[e,t].concat(a))},s&&!c&&r?r:e)}},B=b(function(e){return(y(e)||O(e))&&(n=(t=A(e)).every(function(e){return"next"===e||"throw"===e}),!(t.length&&t.length<=2&&n));var t,n});function G(e,t,n){void 0===n&&(n={}),o()(y(e)||O(e),"Expected handlers to be a plain object.");var r=B(e,n),a=A(r).map(function(e){return U(e,R(e,r),t)}),i=W.apply(void 0,a.concat([t]));return function(e,n){return void 0===e&&(e=t),i(e,n)}}},45902:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WEBRTC_DEVICE_KINDS=void 0,t.default=function(){const e=o.logManager.getLogger("Manager","Device"),t=new a.default;let n=[],r=[],s=[],c=[];d().then(()=>{l?t.emit("change"):e.info("Initial media device discovery ignored.")});let l=!0,u=!1;function d(){return e.info("Checking media devices."),new Promise((e,t)=>{navigator.mediaDevices.enumerateDevices().then(t=>{n=[],r=[],s=[],t.forEach(e=>{switch(i[e.kind]){case"microphone":n.push(e);break;case"camera":r.push(e);break;case"speaker":s.push(e)}}),e(f())}).catch(t)})}function f(){return{microphone:n,camera:r,speaker:s}}return p="devicechange",g=()=>{!u&&l?(e.info("Media device change detected."),u=!0,setTimeout(()=>{u=!1,d().then(()=>{l?t.emit("change"):e.info("Media device change ignored after being detected.")})},50)):e.info(`Media device change detected, but ${l?"throttling":"ignoring"}.`)},navigator.mediaDevices.addEventListener(p,g),c.push({event:p,handler:g}),{setListening:function(t){e.debug(`Listening for device changes: ${t}`),l=t},checkDevices:d,setupDeviceInitialization:function(e){return new Promise((t,n)=>{navigator.mediaDevices.getUserMedia(e).then(e=>{e.getTracks().forEach(e=>{e.stop()});const n=d();t(n)}).catch(n)})},cleanup:function(){c.forEach(e=>{let{event:t,handler:n}=e;navigator.mediaDevices.removeEventListener(t,n)}),c=[]},get:f,on:function(){return t.on(...arguments)},once:function(){return t.once(...arguments)},off:function(){return t.off(...arguments)},emit:function(){return t.emit(...arguments)}};var p,g},n(69375),n(81045),n(5350);var r,o=n(40271),a=(r=n(19353))&&r.__esModule?r:{default:r};const i=t.WEBRTC_DEVICE_KINDS={audioinput:"microphone",videoinput:"camera",audiooutput:"speaker"}},45945:(e,t,n)=>{"use strict";var r=n(79117),o=n(14188),a=r.WeakMap;e.exports=o(a)&&/native code/.test(String(a))},45950:(e,t,n)=>{"use strict";n(99819)},46065:(e,t,n)=>{var r=n(19270),o=r&&new r;e.exports=o},46108:(e,t,n)=>{var r=n(69334);e.exports=function(e){return r(e,5)}},46123:(e,t,n)=>{var r=n(57923);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},46285:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},46343:(e,t,n)=>{var r=n(94687);e.exports=function(e,t){return r(e,t)}},46371:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=o.logManager.getLogger("Manager","WebRTC");return{getAvailableCodecs:function(e){const t=RTCRtpSender.getCapabilities(e);if(t&&t.codecs)return t.codecs},setProxies:function(e){void 0===e||void 0===e.peer?(t.debug("Peer functionality has been updated to remove proxies."),(0,r.setPeerProxies)()):(t.debug("Peer functionality has been updated with proxies."),(0,r.setPeerProxies)(e.peer))}}};var r=n(11655),o=n(40271)},46484:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modifySdpBandwidth=function(e,t,n){function r(e){return[{type:"AS",limit:e},{type:"TIAS",limit:1e3*e}]}return t.bandwidth&&(t.bandwidth.call&&(e.bandwidth=r(t.bandwidth.call)),t.bandwidth.audio&&e.media.filter(e=>"audio"===e.type).forEach(e=>{e.bandwidth=r(t.bandwidth.audio)}),t.bandwidth.video&&e.media.filter(e=>"video"===e.type).forEach(e=>{e.bandwidth=r(t.bandwidth.video)})),e},n(81045),n(30163),n(5350)},46536:e=>{e.exports=function(e){return t.test(e)?e.toLowerCase():n.test(e)?(function(e){return e.replace(o,function(e,t){return t?" "+t:""})}(e)||e).toLowerCase():r.test(e)?function(e){return e.replace(a,function(e,t,n){return t+" "+n.toLowerCase().split("").join(" ")})}(e).toLowerCase():e.toLowerCase()};var t=/\s/,n=/(_|-|\.|:)/,r=/([a-z][A-Z]|[A-Z][a-z])/,o=/[\W_]+(.|$)/g,a=/(.)([A-Z]+)/g},46585:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=i;var r,o=(r=n(4564))&&r.__esModule?r:{default:r};const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function i(e,t=0){return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}t.default=function(e,t=0){const n=i(e,t);if(!(0,o.default)(n))throw TypeError("Stringified UUID is invalid");return n}},46648:(e,t,n)=>{var r=n(57553),o=n(65196),a=n(50961),i=n(93321);e.exports=function(e){var t=a(e),n=i[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var s=o(n);return!!s&&e===s[0]}},46775:(e,t,n)=>{var r=n(63521);e.exports=function(e,t,n){for(var o=-1,a=e.criteria,i=t.criteria,s=a.length,c=n.length;++o<s;){var l=r(a[o],i[o]);if(l)return o>=c?l:l*("desc"==n[o]?-1:1)}return e.index-t.index}},46883:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEnded=function(e,t,n){const{start:o}=a(0,t,n);return{start:async function(e,t,n){await o(e,t),n&&(n.reportEvent.endEvent(),n.tracker.status!==r.OP_STATUS.FINISHED&&n.tracker.finish())}}},t.createGeneric=a,t.createPending=function(e,t,n){return{start:async function(e,r,a){const i=t.reportEvent.addEvent(o.REPORTER_OPERATION_EVENTS_MAP[r]);try{await n[r](e.wrtcsSessionId,...a),i.endEvent()}catch(e){i.endEvent(e)}}}};var r=n(59090),o=n(84581);function a(e,t,n){return{start:async function(e,r){t.tracker.start(),await n.remoteOffer(e.wrtcsSessionId,r),t.tracker.finish(),t.reportEvent.endEvent()}}}},46937:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsonChannel=function(e){const t={receive:void 0,send(t){try{e.send(JSON.stringify(t))}catch(e){r.error("Failed to send JSON message over channel: ",e)}}};return e.receive=function(e){try{t.receive&&t.receive(JSON.parse(e))}catch(e){r.error("Failed to receive JSON message on channel: ",e)}},t},t.replyChannel=function(e,t){const n={};e.receive=function(e){const{messageId:t,data:a}=e;t&&n[t]?n[t].isExpired?(r.debug(`Received reply from timed-out message ${t}. Ignoring.`),delete n[t]):(r.debug(`Received reply from message ${t}.`),n[t].resolve(a)):t&&!n[t]?o.receive?(r.debug(`Received new message ${t}.`),o.receive(t,a)):r.error("No listener set for handling received messages.",a):r.warn("Received message without an ID on the channel; ignoring.",e)};const o={send:(o,a,i)=>{if(n[o])return void i(null,new Error("Cannot send message; ID already used."));const s={data:a,messageId:o};i?new Promise(a=>{const c=t.create("webrtcProxy",()=>{r.debug(`Message ${o} timed-out. Failing operation.`),n[o].isExpired=!0,i(null,new Error("Operation timed-out; no reply from other side of channel."))},12e3,{id:"replyChannelSendTimeoutRacer"});n[o]={resolve:a,timeoutId:c,isExpired:!1},r.debug(`Sending new message ${o} with reply expected.`),e.send(s)}).then(e=>{t.clear(n[o].timeoutId),delete n[o],"function"==typeof i&&i(e)}):(r.debug(`Sending new message ${o}.`),e.send(s))},receive:void 0,reply:(t,n)=>{const o={data:n,messageId:t};r.debug(`Replying to message ${t}.`),e.send(o)}};return o},n(97107);const r=n(69932).logManager.getLogger("CHANNEL")},47028:(e,t,n)=>{var r=n(4977),o=n(85755),a=n(8813),i="__lodash_placeholder__",s=Math.min;e.exports=function(e,t){var n=e[1],c=t[1],l=n|c,u=l<131,d=128==c&&8==n||128==c&&256==n&&e[7].length<=t[8]||384==c&&t[7].length<=t[8]&&8==n;if(!u&&!d)return e;1&c&&(e[2]=t[2],l|=1&n?0:4);var f=t[3];if(f){var p=e[3];e[3]=p?r(p,f,t[4]):f,e[4]=p?a(e[3],i):t[4]}return(f=t[5])&&(p=e[5],e[5]=p?o(p,f,t[6]):f,e[6]=p?a(e[5],i):t[6]),(f=t[7])&&(e[7]=f),128&c&&(e[8]=null==e[8]?t[8]:s(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}},47170:(e,t,n)=>{var r=n(35636),o=n(81211);e.exports=function(e,t){return e&&r(e,t,o)}},47183:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wsReconnectFailed=t.wsError=t.wsDisconnectFinished=t.wsDisconnect=t.wsConnectFinished=t.wsClosed=t.wsAttemptConnect=t.lostConnection=t.changeConnectivityChecking=void 0,n(97107);var r,o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(9719)),a=(r=n(75412))&&r.__esModule?r:{default:r};function i(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:e,error:t instanceof Error||t instanceof a.default,payload:t,meta:{isReconnect:n}}}}t.wsAttemptConnect=i(o.WS_ATTEMPT_CONNECT),t.wsDisconnect=i(o.WS_DISCONNECT),t.wsConnectFinished=i(o.WS_CONNECT_FINISHED),t.wsDisconnectFinished=i(o.WS_DISCONNECT_FINISHED),t.wsReconnectFailed=i(o.WS_RECONNECT_FAILED),t.wsClosed=i(o.WS_CLOSED),t.wsError=i(o.WS_ERROR),t.lostConnection=i(o.LOST_CONNECTION),t.changeConnectivityChecking=i(o.CHANGE_CONNECTIVITY_CHECKING)},47336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const i=(0,r.getCallById)(e,t);return i?[o.CALL_STATES.INITIATED,o.CALL_STATES.RINGING].includes(i.state)?i.direction!==o.CALL_DIRECTION.INCOMING?new a.default({message:"Failed to forward call. Call must be incoming.",code:a.callCodes.INVALID_STATE}):void 0:new a.default({message:`Failed to forward call. Call must be in ${o.CALL_STATES.INITIATED} or ${o.CALL_STATES.RINGING} state.`,code:a.callCodes.INVALID_STATE}):new a.default({message:`Failed to forward call. Call ${t} not found.`,code:a.callCodes.INVALID_PARAM})},n(62234);var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},47378:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCallUrl=i,t.handleLinkCallRequestError=a,t.linkCallRequest=async function(e,t){t.endpoint=i(t);const n=await e(t);return n.error?{error:a(n)}:n.body};var r,o=(r=n(75412))&&r.__esModule?r:{default:r};function a(e){let t,n;if(e)if(e.body)if("callControlResponse"in e.body){const{callControlResponse:r}=e.body;t=function(e){switch(e){case 5:return"Request failed: Invalid or missing request body";case 26:return"Request failed: Internal Server Error";case 27:return"Request failed: Authorization failure";case 35:return"Request failed: Service is not authorized due to Call Control resources on the server being not enabled";case 37:return"Request failed: Detected invalid parameter value. Check Request content";case 42:return"Request failed: Resource does not exist";case 61:return"Request failed: Authentication failure due to credentials not provided or incorrect";case 62:return"Request failed: Authentication failure due to account being disabled";case 63:return"Request failed: Authentication failure due to account being locked";case 1004:return"Request failed: Bad request";default:return"Request failed: Unknown error"}}(r.statusCode),n=r.statusCode}else t=e.body.message,n=e.result.code;else e.result?(t=`Request failed: ${e.result.message}`,n=e.result.code):t="Request failed: Unknown error.";else t="Request failed: Unknown error.";return new o.default({message:t,code:n})}function i(e){const{isAnonymous:t,wrtcsSessionId:n,endUrl:r}=e;let o=r||(t?"callMe":"callControl");return n&&(o+=`/callSessions/${n}`),o}},47403:(e,t,n)=>{var r=n(82619),o=n(72532),a=n(22053),i=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:a;e.exports=i},47568:(e,t,n)=>{"use strict";var r=n(16881),o=n(5234),a=n(38689),i=Object,s=r("".split);e.exports=o(function(){return!i("z").propertyIsEnumerable(0)})?function(e){return"String"===a(e)?s(e,""):i(e)}:i},47575:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:(e,t)=>({destination:t}),signalling:(t,n)=>{let{destination:r}=n;return o(e,t,r)}}},t.signalling=o;var r=n(40481);async function o(e,t,n){const{context:o,CallRequests:a,logManager:i}=e,s=i.getLogger("CALL",t);s.info("Performing direct transfer on call.");const c={wrtcsSessionId:(0,r.getCallById)(o.getState(),t).wrtcsSessionId,address:n,id:t};try{await a.directTransferSession(c)}catch(e){throw s.info("Failed to direct transfer call."),e}s.info("Finished local portion of direct transfer. Waiting on remote response.")}},48055:(e,t,n)=>{e.exports={ary:n(45353),assign:n(37930),clone:n(72846),curry:n(37336),forEach:n(79968),isArray:n(53142),isError:n(60441),isFunction:n(93655),isWeakMap:n(67769),iteratee:n(32590),keys:n(195),rearg:n(864),toInteger:n(67642),toPath:n(42613)}},48151:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=async function(e,t,n){if(t.removed.length>0)return await a(n);let i;switch(e){case o.OPERATIONS.ADD_MEDIA:case o.OPERATIONS.START_MOH:i=function(e){let t=[];e.changed.forEach(e=>{const{media:n,changes:r}=e;if("START"===r.sending&&("SAME"===r.receiving||"START"===r.receiving)){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}});const n=e.added.filter(e=>e.willSend).map(e=>void 0===e.sectionId?e.sectionIndex:e.sectionId);return t=t.concat(n),t}(t);break;case o.OPERATIONS.REMOVE_MEDIA:case o.OPERATIONS.STOP_MOH:i=function(e){const t=[];return e.changed.forEach(e=>{const{media:n,changes:r}=e;if("STOP"===r.sending&&"STOP"!==r.receiving){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}}),t}(t);break;case o.OPERATIONS.HOLD:i=(0,r.was3xHold)(t)?function(e){const t=[];return e.changed.forEach(e=>{const{media:n,changes:r}=e;if("audio"===n.type){if("STOP"===r.receiving&&"SAME"===r.sending){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}}else if("STOP"===r.receiving||"SAME"===r.receiving&&!1===n.willReceive){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}}),e.unchanged.forEach(e=>{if("video"===e.type&&e.willSend&&!e.willReceive){const n=void 0===e.sectionId?e.sectionIndex:e.sectionId;t.push(n)}}),t}(t):function(e){const t=[];return e.changed.forEach(e=>{const{media:n,changes:r}=e;if("STOP"===r.sending){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}}),t}(t);break;case o.OPERATIONS.UNHOLD:i=(0,r.was3xUnhold)(t)?function(e){const t=[];return e.changed.forEach(e=>{let{media:n,changes:r}=e;if("SAME"===r.sending&&"START"===r.receiving||"video"===n.type&&"START"===r.sending&&"START"===r.receiving){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}}),t}(t):function(e){const t=[];return e.changed.forEach(e=>{const{media:n,changes:r}=e;if("START"===r.sending){const e=void 0===n.sectionId?n.sectionIndex:n.sectionId;t.push(e)}}),t}(t);break;default:i=[]}return await n.getRemoteTrackIdsFromTransceivers(i)},t.getAllRemoteTracks=a,t.getIncomingRemoteTracks=async function(e){return await e.getIncomingRemoteTrackIds()},n(69375),n(81045),n(30163),n(5350),n(84915);var r=n(77839),o=n(59090);async function a(e){return await e.getActiveRemoteTrackIds()}},48240:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=e=>{const n=r.trackActions.trackSourceMuted([e.trackId],{mediaId:e.mediaId,isLocal:e.isLocal}),a={type:o.TRACK_SOURCE_MUTED,args:{trackIds:[e.trackId],trackId:e.trackId,isLocal:e.isLocal,id:e.mediaId}};t(n,a)},a=e=>{const n=r.trackActions.trackSourceUnmuted([e.trackId],{mediaId:e.mediaId,isLocal:e.isLocal}),a={type:o.TRACK_SOURCE_UNMUTED,args:{trackIds:[e.trackId],trackId:e.trackId,isLocal:e.isLocal,id:e.mediaId}};t(n,a)},i=()=>{e.off("ended",i),e.off("muted",n),e.off("unmuted",a)};return e.on("ended",i),e.on("muted",n),e.on("unmuted",a),i};var r=n(66446),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51709))},48244:(e,t,n)=>{var r=n(11129),o=n(53142);e.exports=function(e,t,n){var a=t(e);return o(e)?a:r(a,n(e))}},48349:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:(t,n,r)=>s(e,t,n,r),signalling:(t,n)=>c(e,t,n)}},t.localChanges=s,t.signalling=c,n(81045),n(84915),n(55367);var r=n(35),o=n(51918),a=n(40481),i=n(37654);async function s(e,t,n,r){const{context:o,Callstack:i,logManager:s}=e,c=s.getLogger("CALL",t);c.info("Adding media to call.");const l=(0,a.getCallById)(o.getState(),t),{bandwidth:u,dscpControls:d}=r,{webrtcSessionId:f,bandwidth:p}=l,g={audio:u&&u.audio?u.audio:p.audio,video:u&&u.video?u.video:p.video},{sdp:_,medias:E}=await i.utils.webrtcAddMedia(n,{sessionId:f,bandwidth:g,dscpControls:d}),y={local:!0,mediaIds:E.map(e=>e.id),tracks:E.reduce((e,t)=>e.concat(t.tracks.map(e=>e.id)),[]),bandwidth:g};return c.info("Finished local portion of adding media. Waiting on remote response."),{operationData:y,sdp:_}}async function c(e,t,n){const{context:s,CallRequests:c,Callstack:l,CallstackWebrtc:u,emitEvent:d,logManager:f}=e,{operationData:p,sdp:g}=n,_=(0,a.getCallById)(e.context.getState(),t),E=f.getLogger("CALL",_.id);try{await c.updateSession({wrtcsSessionId:_.wrtcsSessionId,id:_.id,offer:g,isAnonymous:_.isAnonymous,account:_.account,customParameters:_.customParameters,customBodies:_.customBodies})}catch(e){let t;E.info("Failed to add media to call.");try{await l.utils.rollbackAddMedia(_.webrtcSessionId,p)}catch(e){E.debug("Automatic add media rollback failed:",e),t=e}const n=(0,i.getBrowserDetails)().browser;if(t||"chrome"===n){if("safari"===n||"chrome"===n)throw E.info("Ending call due to unrecoverable state after call add media failure."),await u.closeCall(_.webrtcSessionId),s.dispatch(r.callActions.endCallFinish(_.id,{isLocal:!0,transition:{reasonText:"Call has ended due to call add media failure."}})),d(o.CALL_TRACKS_REMOVED,{callId:_.id,trackIds:[..._.localTracks,..._.remoteTracks]}),d(o.CALL_STATE_CHANGE,{callId:_.id,previous:{state:_.state,localHold:_.localHold,remoteHold:_.remoteHold},error:e}),e;E.info("Unable to reset state after add media operation failure, future operations may not work as intended.")}throw e}}},48360:(e,t,n)=>{var r=n(87379),o=n(74784),a=n(80547),i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,u=c.call(Object);e.exports=function(e){if(!a(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==u}},48377:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sessionAdded=function(e,t){return i(a.SESSION_ADDED,e,t)},t.sessionAudioEnded=function(e,t){return{type:a.SESSION_AUDIO_ENDED,payload:{id:e,...t},error:Boolean(t.error)}},t.sessionIceCandidateCollected=function(e,t){return i(a.SESSION_ICE_CANDIDATE_COLLECTED,e,t)},t.sessionIceCollectionScheduledCheck=function(e,t){return i(a.SESSION_ICE_COLLECTION_SCHEDULED_CHECK,e,t)},t.sessionIceConnectionStateChange=function(e,t){return i(a.SESSION_ICE_CONNECTION_STATE_CHANGE,e,t)},t.sessionIceGatheringStateChange=function(e,t){return i(a.SESSION_ICE_GATHERING_STATE_CHANGE,e,t)},t.sessionNewTrack=function(e,t){return i(a.SESSION_NEW_TRACK,e,t)},t.sessionRemoved=function(e,t){return i(a.SESSION_REMOVED,e,t)},t.sessionTrackEnded=function(e,t){return i(a.SESSION_TRACK_ENDED,e,t)},t.sessionTrackReplaced=function(e,t){return i(a.SESSION_TRACK_REPLACED,e,t)};var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997));function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a={type:e,payload:{...n,id:t}};return(0,o.default)(r)||(a.meta=r),n.error&&(a.error=!0),a}},48444:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:(t,n,r)=>l(e,t,n,r),signalling:(t,n)=>u(e,t,n),rollback:t=>d(e,t)}},t.localChanges=l,t.rollbackSlowAnswer=d,t.signalling=u,n(81045),n(45950);var r=n(35),o=n(40481),a=n(59090),i=n(77126),s=n(69752),c=n(84581);async function l(e,t,n,r){const{context:a,Callstack:i,logManager:c}=e,{setupOutgoingSession:l}=i.utils,u=c.getLogger("CALL",t);u.info("Answering incoming call.");const d=(0,s.checkBandwidthControls)(r.bandwidth);u.debug("Answering call with slow start negotiation.");const f=(0,o.getTurnInfo)(a.getState()),p=(0,o.getOptions)(a.getState());let g;try{g=await l(n,{callId:t,defaultPeerConfig:p.defaultPeerConfig,turnInfo:f,bandwidth:d,dscpControls:r.dscpControls,trickleIceMode:p.trickleIceMode,removeBundling:p.removeBundling,serverTurnCredentials:p.serverTurnCredentials})}catch(e){throw u.info("Failed to answer incoming call."),e}return{webrtcInfo:g,media:n,bandwidth:d,options:r}}async function u(e,t,n){const{context:s,Callstack:l,CallstackWebrtc:u,CallRequests:d,CallReporter:f,logManager:p}=e,{webrtcInfo:g,media:_,bandwidth:E,options:y}=n,S=(0,o.getCallById)(s.getState(),t),v=p.getLogger("CALL",S.id);try{await d.answerSession({id:S.id,answer:g.offerSdp,wrtcsSessionId:S.wrtcsSessionId,customParameters:y.customParameters,customBodies:y.customBodies}),v.info(`Finished answering slow-start call. Changing to ${i.CALL_STATES.RINGING} and waiting for remote slow-start answer.`),s.dispatch(r.callActions.answerCallFinish(S.id,{state:i.CALL_STATES.RINGING,startTime:Date.now(),mediaIds:g.mediaIds,webrtcSessionId:g.sessionId,mediaConstraints:_,bandwidth:E,customParameters:y.customParameters,customBodies:y.customBodies,localTracks:[],remoteTracks:[]},{isSlowStart:S.isSlowStart}))}catch(t){if(v.info("Failed to answer call."),55===t.code){const t=f.getReport(S.id),n=S.currentOperations.find(e=>e.isLocal&&e.type===a.OPERATIONS.ANSWER),r=t.getEvent(n.eventId).addEvent(c.REPORT_EVENTS.RESYNC);await l.operations.resyncCallState.stages.signalling(e,S.id),r.endEvent()}throw await u.closeCall(g.sessionId),t}}async function d(e,t){await e.CallstackWebrtc.closeCall(t)}},48475:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(81045),n(30163),n(84915);var r=c(n(7977)),o=c(n(82549)),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(21836)),i=n(59090),s=n(45775);function c(e){return e&&e.__esModule?e:{default:e}}const l={};l[a.OPERATION_UPDATE]={next(e,t){e.currentOperations=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const{transition:n,operationId:r}=t.payload;if(n===i.OP_TRANSITIONS.START){const n={type:t.payload.operation,id:r,status:i.OP_STATUS.ONGOING,eventId:t.payload.eventId,isLocal:t.payload.isLocal,isBlocking:t.payload.isBlocking};return e.concat(n)}return n===i.OP_TRANSITIONS.UPDATE?e.map(e=>e.id===r?{...e,status:i.OP_STATUS.PENDING,operationData:t.payload.operationData}:e):n===i.OP_TRANSITIONS.RESUME?e.map(e=>e.id===r?{...e,status:i.OP_STATUS.RESOLVING}:e):n===i.OP_TRANSITIONS.FINISH?e.filter(e=>e.id!==r):e}(e.currentOperations,t);const n=t.payload.isLocal?"localOp":"remoteOp";if(t.payload.transition===i.OP_TRANSITIONS.START)return e[n]?e:{...e,[n]:{operation:t.payload.operation,status:i.OP_STATUS.ONGOING,eventId:t.payload.eventId}};if(t.payload.transition===i.OP_TRANSITIONS.UPDATE)return{...e,[n]:{...e[n],status:i.OP_STATUS.PENDING,operationData:t.payload.operationData}};if(t.payload.transition===i.OP_TRANSITIONS.FINISH){const a=!t.payload.isLocal,s={...e,[n]:void 0},c=e[n]&&e[n].operation;return(0,r.default)(c)?e:c===t.payload.operation||a&&c===i.OPERATIONS.SLOW_START||(0,o.default)(c)(i.NO_FINISH_OPS)||t.payload.operation===i.OPERATIONS.END?s:e}return e}},l[a.UPDATE_CALL]={next:(e,t)=>e};const u=(0,s.handleActions)(l,{});t.default=u},48545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{proxyPeer:e,trackManager:t}=this;return e.getReceivers().filter(e=>Boolean(e.track)).map(e=>t.get(e.track.id)).filter(e=>e&&"live"===e.getState().state&&e.getStream().active)},n(81045),n(30163),n(84915)},48687:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:t=>l(e,t),signalling:(t,n)=>u(e,t,n)}},t.localChanges=l,t.signalling=u,n(81045),n(9925);var r=n(40481),o=n(69752),a=n(94482),i=n(9101),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),c=n(1011);async function l(e,t){const{context:n,WebRTC:l,CallstackWebrtc:u,logManager:d}=e,f=(0,r.getCallById)(n.getState(),t),{webrtcSessionId:p,wrtcsSessionId:g,bandwidth:_,isAnonymous:E,account:y,localHold:S,customParameters:v,customBodies:h}=f,T=await l.sessionManager.get(p);if("passive"===await T.getDtlsRole()){const{mediaConnectionRetryDelay:e}=(0,r.getOptions)(n.getState());await(0,c.delay)(e)}const C=d.getLogger("CALL",t);try{await T.restartIce()}catch(e){C.debug("Peer restartIce function not available. Restarting ICE with createOffer instead.")}const{connected:I}=(0,a.getConnectionState)(n.getState());if(!I&&(C.debug("Websocket not connected; waiting for reconnect before performing media restart."),!await(0,i.waitForReconnect)(e)))throw C.info("Subscription lost; stopping media restart attempt."),new s.default({code:s.subscriptionCodes.WS_CONNECTION_ERROR,message:"No subscription for operation."});C.info("Performing call renegotiation to reconnect media connection.");const m={audio:S?"inactive":"sendrecv",video:S?"inactive":"sendrecv"};if(!S){const e=(0,o.getLocalTracks)(n,t);m.audio=e.some(e=>"audio"===e.kind)?"sendrecv":"recvonly",m.video=e.some(e=>"video"===e.kind)?"sendrecv":"recvonly"}const O={wrtcsSessionId:g,id:t,isAnonymous:E,account:y,customParameters:v,customBodies:h},A={iceRestart:!0};let R;try{R=await u.generateOffer(p,m,_,A),O.offer=R.sdp}catch(e){throw C.debug("Failed to generate offer."),new s.default({code:s.callCodes.INVALID_OFFER,message:"Failed to generate SDP offer"})}return{offer:R}}async function u(e,t,n){const{context:o,CallRequests:a,logManager:i}=e,{offer:s}=n,c=(0,r.getCallById)(o.getState(),t),l=i.getLogger("CALL",c.id);try{await a.updateSession({wrtcsSessionId:c.wrtcsSessionId,id:c.id,offer:s.sdp,isAnonymous:c.isAnonymous,account:c.account,customParameters:c.customParameters,customBodies:c.customBodies}),l.info("Finished local portion of media restart. Waiting on remote response.")}catch(e){throw l.info("Failed to renegotiate call."),e}}},48875:(e,t,n)=>{var r=n(40091),o=n(77848)(function(e,t,n,o){r(e,t,n,o)});e.exports=o},48944:(e,t,n)=>{"use strict";var r=n(63008),o=n(5234),a=n(79117).String;e.exports=!!Object.getOwnPropertySymbols&&!o(function(){var e=Symbol("symbol detection");return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},48963:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallHistoryOperations.setCache",t=>(0,o.default)(e.container))};var r,o=(r=n(72738))&&r.__esModule?r:{default:r}},49116:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n}=e,a=n.getLogger("CALL");return function(e){const{serverTurnCredentials:n,defaultPeerConfig:i}=(0,o.getOptions)(t.getState());if(0===i.iceServers.length)return void a.debug("No ICE servers provided during setup; not using TURN/STUN for calls.");if(!n)return void a.debug("Using application provided TURN credentials.");const s=e.payload.subscriptions[0].turnCredentials;t.dispatch(r.turnActions.turnChanged({credentials:s}))}};var r=n(35),o=n(40481)},49141:e=>{var t=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,n){var r=n.length;if(!r)return e;var o=r-1;return n[o]=(r>1?"& ":"")+n[o],n=n.join(r>2?", ":" "),e.replace(t,"{\n/* [wrapped with "+n+"] */\n")}},49164:e=>{"use strict";e.exports={}},49310:e=>{e.exports=function(e){return null===e}},49460:e=>{e.exports=function(e){return function(t){return e(t)}}},49528:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,LogsOperations:n,logManager:a,API_LOG_TAG:i}=e,s=a.getLogger("LOGS");return{logger:{levels:{SILENT:"silent",ERROR:"error",WARN:"warn",INFO:"info",DEBUG:"debug"},setLevel(e,o){s.debug(i+"logger.setLevel: ",e,o),t.dispatch(r.setLevel(e,o));try{n.setLogLevel(e,o)}catch(e){s.error(e.message)}},getLevel:e=>(s.debug(i+"logger.getLevel: ",e),(0,o.getLevel)(t.getState(),e)),setHandler(e,o){s.debug(i+"logger.setHandler: ",e,o),t.dispatch(r.setHandler(e,o));try{n.setLogHandler(e,o)}catch(e){s.error(e.message)}},getTypes:()=>(s.debug(i+"logger.getTypes"),(0,o.getTypes)(t.getState()))}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(45183)),o=n(98530)},49561:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.channelClosed=function(e){return o(r.CHANNEL_CLOSED,{},{type:e})},t.channelOpened=function(e,t){return o(r.CHANNEL_OPENED,{...e},{type:t})},t.doPluginSubscriptions=function(e,t){return o(r.PLUGIN_SUBSCRIPTION,{services:e,type:t})},t.doPluginUnsubscriptions=function(e,t){return o(r.PLUGIN_UNSUBSCRIPTION,{services:e,type:t})},t.reportSubscriptionFinished=function(e){let{service:t,type:n,subscription:a,error:i}=e;const s=a?a.resourceURL.split("/subscriptions/")[1]:null;return o(r.PLUGIN_SUBSCRIPTION_FINISHED,{...a,subscriptionId:s,service:t,channelType:n,error:i})},t.reportUnsubscriptionFinished=function(e){let{service:t,type:n,error:a}=e;return o(r.PLUGIN_UNSUBSCRIPTION_FINISHED,{service:t,channelType:n,error:a})},t.resubscribeFinished=function(e){let{error:t,attemptNum:n}=e;var o={type:r.RESUBSCRIPTION_FINISHED,meta:{}};return t?(o.error=!0,o.payload=t,o.payload.attemptNum=n):o.payload={attemptNum:n},o},t.subscribe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return o(r.SUBSCRIBE,{services:e,...t})},t.subscribeFinished=function(e){let{subscriptions:t,type:n,error:a}=e;return o(r.SUBSCRIBE_FINISHED,{subscriptions:t,type:n,error:a})},t.unsubscribe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return o(r.UNSUBSCRIBE,{services:e,type:t})},t.unsubscribeFinished=function(e){let{type:t,error:n,reason:a,retryAfter:i}=e;const s=i?{type:t,error:n,reason:a,retryAfter:i}:{type:t,error:n,reason:a};return o(r.UNSUBSCRIBE_FINISHED,s)};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(34721));function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:e,payload:{...t},error:!!t.error,meta:{...n}}}},49639:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContact=function(e,t){return(0,o.default)(e.users.contacts[t])},t.getContacts=function(e){return(0,o.default)(e.users.contacts)},t.getUser=function(e,t){return(0,o.default)(e.users.users[t])},t.getUsers=function(e){const t=(0,o.default)(e.users.users);return Object.values(t)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},49676:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallstackSDP:n,CallReporter:l,WebRTC:u}=e;return async function(d,f){const{CallstackWebrtc:p}=e,{sessionId:g,bandwidth:_,dscpControls:E}=f,y=(0,r.getCallByWebrtcSessionId)(t.getState(),g),S=y.id,v=l.getReport(S),h=y.currentOperations.find(e=>e.isLocal&&[o.OPERATIONS.ADD_MEDIA,o.OPERATIONS.ADD_BASIC_MEDIA].includes(e.type)),T=v.getEvent(h.eventId);let C=[];if(d.medias)for(const e of d.medias)C.push({type:e.type,media:await u.media.get(e.media.id)});const I=await p.createLocal(d,S);C=C.concat(I);const m=await u.sessionManager.get(g),O=await(0,s.organizeTracks)(C),A=(0,i.getTrackDscpMapping)(O,E);await m.addTracks(O.all,A);const R=(0,r.getOptions)(t.getState());let b,N,M,w;try{w=T.addEvent(a.REPORT_EVENTS.CREATE_OFFER),b=await m.createOffer(),w.endEvent()}catch(e){const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw w.endEvent(t),t}try{b.sdp=n.runPipeline(R.sdpHandlers,b.sdp,{callId:S,type:b.type,step:"set",endpoint:"local",bandwidth:_}),M=T.addEvent(a.REPORT_EVENTS.PROCESS_MEDIA_LOCAL),M.addData("operation",a.REPORTER_OPERATION_EVENTS_MAP.ADD_MEDIA),b=await m.setLocalDescription(b),M.endEvent(),N=n.runPipeline(R.sdpHandlers,b.sdp,{callId:S,type:b.type,step:"send",endpoint:"local",bandwidth:_})}catch(e){const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw M.endEvent(t),t}let P=[];for(const e of C){const t=await e.media.getState();P=[...P,t]}return{medias:P,sdp:N}}},n(62234),n(69375),n(81045),n(45950);var r=n(40481),o=n(59090),a=n(84581),i=n(69752),s=n(56294),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},49753:(e,t,n)=>{var r=n(25098),o=n(1386),a=n(19770);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(a||o),string:new r}}},49759:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(14017))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(9719)),i=n(45775);const s={};s[a.WS_ATTEMPT_CONNECT]={next:(e,t)=>({...e,connected:!1,pinging:!1})},s[a.WS_RECONNECT_FAILED]={next:(e,t)=>({...e,connected:!1,pinging:!1})},s[a.WS_CONNECT_FINISHED]={next:(e,t)=>({...e,connected:!0,pinging:t.payload.pinging,...(0,o.default)("checkConnectivity",t.payload.kandy)}),throw:(e,t)=>({connected:!1,pinging:!1})},s[a.LOST_CONNECTION]={next:(e,t)=>({...e,connected:!1,pinging:!1})},s[a.WS_DISCONNECT_FINISHED]={next:(e,t)=>({connected:!1,pinging:!1}),throw:(e,t)=>({connected:!1,pinging:!1})},s[a.WS_ERROR]={next:(e,t)=>({connected:!1,pinging:!1}),throw:(e,t)=>({connected:!1,pinging:!1})},s[a.CHANGE_CONNECTIVITY_CHECKING]={next:(e,t)=>({...e,checkConnectivity:t.payload})};const c=(0,i.handleActions)(s,{connected:!1,pinging:!1});t.default=c},49828:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},50020:(e,t,n)=>{"use strict";var r=n(5613),o=n(39944),a=n(44977),i=n(3770),s=n(96002),c=n(32331),l=n(34412),u=n(88500),d=n(59475),f=n(20850),p=n(1942),g=!p&&!d("map",function(){}),_=!p&&!g&&f("map",TypeError),E=p||g||_,y=c(function(){var e=this.iterator,t=i(o(this.next,e));if(!(this.done=!!t.done))return l(e,this.mapper,[t.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:E},{map:function(e){i(this);try{a(e)}catch(e){u(this,"throw",e)}return _?o(_,this,e):new y(s(this),{mapper:e})}})},50130:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enableNotificationChannel=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:r.ENABLE_NOTIFICATION_CHANNEL,payload:{...t},meta:{channel:e}}},t.enableNotificationChannelFinish=function(e){let{params:t,error:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var o={type:r.ENABLE_NOTIFICATION_CHANNEL_FINISH,meta:{channel:e}};return n?(o.error=!0,o.payload=new Error(n),o.payload.channelEnabled=t.channelEnabled):o.payload={...t},o},t.externalNotification=function(e){return o((arguments.length>1&&void 0!==arguments[1]?arguments[1]:"PUSH").toUpperCase(),e)},t.notificationReceived=function(e,t){return{type:r.NOTIFICATION_RECEIVED,payload:e,error:e instanceof Error,meta:{channel:t}}},t.processNotificationFinish=function(e){return{type:r.PROCESS_NOTIFICATION_FINISH,payload:e,error:e instanceof Error,meta:{}}},t.registerAndroidPushNotification=function(e,t){return{type:r.REGISTER_ANDROID_PUSH_NOTIFICATION,payload:{...e,pushProvider:"google"},meta:{deferred:t}}},t.registerApplePushNotification=function(e,t){return{type:r.REGISTER_APPLE_PUSH_NOTIFICATION,payload:{...e,pushProvider:"apple"},meta:{deferred:t}}},t.unregisterAndroidPushNotification=function(e,t){return{type:r.UNREGISTER_ANDROID_PUSH_NOTIFICATION,payload:{registration:e},meta:{deferred:t}}},t.unregisterApplePushNotification=function(e,t){return{type:r.UNREGISTER_APPLE_PUSH_NOTIFICATION,payload:{registration:e},meta:{deferred:t}}},t.websocketNotification=function(e){return o("WEBSOCKET",e)},n(97107);var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(70506));function o(e,t){return{type:r.PROCESS_NOTIFICATION,payload:t,meta:{channel:e}}}},50217:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(80406)),o=l(n(99890)),a=l(n(95397)),i=l(n(48545)),s=l(n(21203)),c=l(n(43692));function l(e){return e&&e.__esModule?e:{default:e}}t.default={localDescription:r.default,localTracks:o.default,remoteDescription:a.default,remoteTracks:i.default,remoteTracksAll:s.default,senderTracks:c.default}},50332:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallRequests:n,CallstackWebrtc:s,emitEvent:c,logManager:l}=e;return async function(e,u){const d=l.getLogger("CALL",e.id);d.info("Received session status completed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId});const{reasonText:f,statusCode:p}=u;if(f){let e;e=p||0===p?p:o.STATUS_CODES.JOIN_SUCCESS,d.debug(`Session completed notice caused by ${f} (${e}).`)}d.info(`Ending webRTC session with id: ${e.webrtcSessionId}, locally ...`),await s.closeCall(e.webrtcSessionId),t.dispatch(r.callActions.joinFinish(e.id,{transition:{reasonText:o.COMPLEX_OPERATION_MESSAGES.JOIN_SUCCESS,statusCode:o.STATUS_CODES.JOIN_SUCCESS}}));try{d.debug("Ending call session on server-side."),await n.endSession({callId:e.id,wrtcsSessionId:e.wrtcsSessionId,isAnonymous:e.isAnonymous,account:e.account})}catch(e){d.debug(`Error received when attempting to end the session: ${e}`)}finally{d.info(`Finished ending call. Changing call state to ${o.CALL_STATES.ENDED}.`),t.dispatch(r.callActions.endCallFinish(e.id,(0,i.generateEndParams)(e.state,!0,u))),c(a.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),c(a.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}})}}};var r=n(35),o=n(77126),a=n(51918),i=n(69752)},50361:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n}=e;return async function(e){const r=t.getLogger("CALLSTACK"),a=await n.sessionManager.get(e);if(!a){const t=`WebRTC session ${e} not found.`;throw r.debug(t),new o.default({message:t})}let i;try{i=await a.rollbackLocalDescription()}catch(e){throw r.debug("Failed to rollback local description offer SDP:",e),e}return{offer:i}}};var r,o=(r=n(75412))&&r.__esModule?r:{default:r}},50424:(e,t,n)=>{var r=n(58898),o=n(92480),a=n(78340),i=n(18069),s=n(92264);e.exports=function(e,t,n){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return o(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,n);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return a(e);case"[object Symbol]":return i(e)}}},50527:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addBasicMedia=function(e,t){return s(a.ADD_BASIC_MEDIA,e,t)},t.addMedia=function(e,t){return s(a.ADD_MEDIA,e,t)},t.addMediaFinish=function(e,t){return s(a.ADD_MEDIA_FINISH,e,t)},t.answerCall=function(e,t){return s(a.ANSWER_CALL,e,t)},t.answerCallFinish=function(e,t,n){return s(a.ANSWER_CALL_FINISH,e,t,n)},t.availableCodecsRetrieved=function(e){const t={type:a.AVAILABLE_CODECS_RETRIEVED,payload:{...e}};return e.error&&(t.error=!0),t},t.callAccepted=function(e,t){return s(a.CALL_ACCEPTED,e,t)},t.callActionHelper=s,t.callCancelled=function(e,t){return s(a.CALL_CANCELLED,e,t)},t.callIncoming=function(e,t){return s(a.CALL_INCOMING,e,t)},t.callRinging=function(e,t){return s(a.CALL_RINGING,e,t)},t.consultativeTransfer=function(e,t){return s(a.CONSULTATIVE_TRANSFER,e,t)},t.consultativeTransferFinish=function(e,t){return s(a.CONSULTATIVE_TRANSFER_FINISH,e,t)},t.customParametersReceived=function(e,t){return s(a.CUSTOM_PARAMETERS_RECEIVED,e,t)},t.directTransfer=function(e,t){return s(a.DIRECT_TRANSFER,e,t)},t.directTransferFinish=function(e,t){return s(a.DIRECT_TRANSFER_FINISH,e,t)},t.endCall=function(e,t){return s(a.END_CALL,e,t)},t.endCallFinish=function(e,t){return s(a.END_CALL_FINISH,e,t)},t.forwardCall=function(e,t){return s(a.FORWARD_CALL,e,t)},t.forwardCallFinish=function(e,t){return s(a.FORWARD_CALL_FINISH,e,t)},t.getAvailableCodecs=function(e,t){return{type:a.GET_AVAILABLE_CODECS,payload:{...e},meta:{deferred:t}}},t.getStats=function(e,t,n){return{type:a.GET_STATS,payload:{...t,id:e},meta:{deferred:n}}},t.getStatsFinish=function(e,t){return s(a.GET_STATS_FINISH,e,t)},t.holdCall=function(e,t){return s(a.CALL_HOLD,e,t)},t.holdCallFinish=function(e,t){return s(a.CALL_HOLD_FINISH,e,t)},t.ignoreCall=function(e,t){return s(a.IGNORE_CALL,e,t)},t.ignoreCallFinish=function(e,t){return s(a.IGNORE_CALL_FINISH,e,t)},t.join=function(e,t){return s(a.JOIN,e,t)},t.joinFinish=function(e,t){return s(a.JOIN_FINISH,e,t)},t.joinStart=function(e,t){return s(a.JOIN_START,e,t)},t.makeAnonymousCall=function(e,t){return{type:a.MAKE_ANONYMOUS_CALL,payload:{id:e,callee:t.callee,credentials:t.credentials,mediaConstraints:t.mediaConstraints,callOptions:t.callOptions}}},t.makeAnonymousCallFinish=function(e,t){return s(a.MAKE_ANONYMOUS_CALL_FINISH,e,t)},t.makeCall=function(e,t){return s(a.MAKE_CALL,e,t)},t.makeCallFinish=function(e,t){return s(a.MAKE_CALL_FINISH,e,t)},t.operationUpdate=function(e,t,n,r){let{transition:o,operationData:i,eventId:s,isBlocking:c,operationId:l}=r;return{type:a.OPERATION_UPDATE,payload:{id:e,operation:t,operationId:l,transition:o,operationData:i,eventId:s,isLocal:n,isBlocking:c}}},t.pendingConsultativeTransfer=function(e,t){return s(a.PENDING_CONSULTATIVE_TRANSFER,e,t)},t.pendingJoin=function(e,t){return s(a.PENDING_JOIN,e,t)},t.pendingMakeCall=function(e,t){return s(a.PENDING_MAKE_CALL,e,t)},t.pendingOperation=function(e,t){return s(a.PENDING_OPERATION,e,t)},t.playAudio=function(e,t){return{type:a.PLAY_AUDIO,payload:{id:e,filePath:t}}},t.playAudioFinish=function(e,t){return{type:a.PLAY_AUDIO_FINISH,payload:{id:e,error:t},error:void 0!==t}},t.playAudioPending=function(e){return{type:a.PENDING_PLAY_AUDIO,payload:{id:e}}},t.rejectCall=function(e,t){return s(a.REJECT_CALL,e,t)},t.rejectCallFinish=function(e,t){return s(a.REJECT_CALL_FINISH,e,t)},t.remoteAddMediaFinish=function(e,t){return s(a.REMOTE_ADD_MEDIA_FINISH,e,t)},t.remoteHoldFinish=function(e,t){return s(a.CALL_REMOTE_HOLD_FINISH,e,t)},t.remoteRemoveMediaFinish=function(e,t){return s(a.REMOTE_REMOVE_MEDIA_FINISH,e,t)},t.remoteSlowStart=function(e,t){return s(a.REMOTE_SLOW_START,e,t)},t.remoteStartMohFinish=function(e,t){return s(a.REMOTE_START_MOH_FINISH,e,t)},t.remoteStopMohFinish=function(e,t){return s(a.REMOTE_STOP_MOH_FINISH,e,t)},t.remoteUnholdFinish=function(e,t){return s(a.CALL_REMOTE_UNHOLD_FINISH,e,t)},t.removeBasicMedia=function(e,t){return s(a.REMOVE_BASIC_MEDIA,e,t)},t.removeMedia=function(e,t){return s(a.REMOVE_MEDIA,e,t)},t.removeMediaFinish=function(e,t){return s(a.REMOVE_MEDIA_FINISH,e,t)},t.replaceTrack=function(e,t){return s(a.REPLACE_TRACK,e,t)},t.replaceTrackFinish=function(e,t){return s(a.REPLACE_TRACK_FINISH,e,t)},t.restartMedia=function(e,t){return s(a.MEDIA_RESTART,e,t)},t.restartMediaFinish=function(e,t){return s(a.MEDIA_RESTART_FINISH,e,t)},t.resync=function(e,t){return s(a.RESYNC,e,t)},t.resyncFinish=function(e,t){return s(a.RESYNC_FINISH,e,t)},t.sendCustomParameters=function(e,t){return s(a.SEND_CUSTOM_PARAMETERS,e,t)},t.sendCustomParametersFinish=function(e,t){return s(a.SEND_CUSTOM_PARAMETERS_FINISH,e,t)},t.sendDTMF=function(e,t){return s(a.SEND_DTMF,e,t)},t.sendDTMFFinish=function(e,t){return s(a.SEND_DTMF_FINISH,e,t)},t.sendRingingFeedback=function(e){return s(a.SEND_RINGING_FEEDBACK,e)},t.sendRingingFeedbackFinish=function(e,t){return s(a.SEND_RINGING_FEEDBACK_FINISH,e,t)},t.sessionCreated=function(e,t){return s(a.SESSION_CREATED,e,t)},t.sessionProgress=function(e,t){return s(a.SESSION_PROGRESS,e,t)},t.setCustomParameters=function(e,t){return{type:a.SET_CUSTOM_PARAMETERS,payload:{id:e,customParameters:(0,r.default)(t)?t.customParameters:t,customBodies:(0,r.default)(t)?t.customBodies:void 0}}},t.unholdCall=function(e,t){return s(a.CALL_UNHOLD,e,t)},t.unholdCallFinish=function(e,t){return s(a.CALL_UNHOLD_FINISH,e,t)},t.updateCall=function(e,t){return s(a.UPDATE_CALL,e,t)};var r=i(n(36705)),o=i(n(84499)),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(21836));function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a={type:e,payload:{...n,id:t}};return(0,o.default)(r)||(a.meta=r),n.error&&(a.error=!0),a}},50539:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("NotificationsOperations.registerPushDeviceToken",()=>(0,r.default)(e.container)),e.factory("NotificationsOperations.unregisterPushDeviceToken",()=>(0,o.default)(e.container))};var r=a(n(57195)),o=a(n(52910));function a(e){return e&&e.__esModule?e:{default:e}}},50578:(e,t,n)=>{var r=n(23945),o=n(58638),a=n(36850),i=n(8813),s=r(function(e,t){var n=i(t,a(s));return o(e,32,void 0,t,n)});s.placeholder={},e.exports=s},50593:(e,t,n)=>{var r=n(92673)("includes",n(87526));r.placeholder=n(22991),e.exports=r},50642:e=>{e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},50680:(e,t,n)=>{"use strict";var r=n(5234);e.exports=!r(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},50774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(81045),n(84915);var r=s(n(90636)),o=s(n(35968)),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997)),i=n(45775);function s(e){return e&&e.__esModule?e:{default:e}}const c={};c[a.MEDIA_NEW]={next:(e,t)=>(0,o.default)(e,{...t.payload})},c[a.MEDIA_REMOVED]={next:(e,t)=>(0,r.default)(e=>e.id===t.payload.id)(e)};const l={};l[a.MEDIA_NEW_TRACK]={next:(e,t)=>({...e,tracks:(0,o.default)(e.tracks,[t.payload.trackId])})},l[a.MEDIA_TRACK_ENDED]={next:(e,t)=>({...e,tracks:(0,r.default)(e=>e===t.payload.trackId,e.tracks)})};const u=(0,i.handleActions)(l,{});c[(0,i.combineActions)(a.MEDIA_NEW_TRACK,a.MEDIA_TRACK_ENDED)]=(e,t)=>e.map(e=>e.id===t.payload.id?u(e,t):e);const d=(0,i.handleActions)(c,[]);t.default=d},50804:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(49528)),o=a(n(43375));function a(e){return e&&e.__esModule?e:{default:e}}t.name="logs"},50805:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"setCredentials",{enumerable:!0,get:function(){return o.default}});var r,o=(r=n(62527))&&r.__esModule?r:{default:r}},50933:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n}=e;return function(e,i){const s=i.reasonText||o.COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_FAILURE,c=i.statusCode||o.STATUS_CODES.DIRECT_TRANSFER_FAILURE,l=n.getLogger("CALL",e.id);l.info("Received call operation failed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId}),l.debug(`Processing as a local direct transfer failure (${c}).`),l.info("Finished handling call operation failed notice.");const u=new a.default({message:`Direct transfer operation failed: ${s} (${c})`,code:a.callCodes.GENERIC_ERROR});return t.dispatch(r.callActions.directTransferFinish(e.id,{error:u,transition:{reasonText:s,statusCode:c}})),u}};var r=n(35),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},50961:(e,t,n)=>{var r=n(83476),o=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],a=o.call(r,t)?n.length:0;a--;){var i=n[a],s=i.func;if(null==s||s==e)return i.name}return t}},51025:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n){let{duration:r,intertoneGap:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};await c(e,t,n,{duration:r,intertoneGap:o})}},t.localChanges=c;var r,o=n(8882),a=(r=n(58532))&&r.__esModule?r:{default:r},i=n(40481),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412));async function c(e,t,n,r){let{duration:c,intertoneGap:l}=r;const{context:u,logManager:d,WebRTC:f}=e,p=d.getLogger("CALL",t),g=(0,i.getCallById)(u.getState(),t),_=await f.sessionManager.get(g.webrtcSessionId),E=await _.getRemoteDescription(),y=(0,a.default)(E.sdp);try{y?(p.debug(`Sending DTMF tones out-of-band for call ${g.id}.`),await(0,o.playOutBand)(_,{tone:n,duration:c,intertoneGap:l})):(p.debug(`Sending DTMF tones in-band for call ${g.id}.`),await(0,o.playInBand)(_,{tone:n,duration:c,intertoneGap:l})),p.info(`Successfully sent DTMF tones for call ${g.id}.`)}catch(e){throw p.debug(`Failed to send DTMF tones for call ${g.id}.`),new s.default({code:s.callCodes.GENERIC_ERROR,message:`Unable to send DTMF tones for call ${g.id}.`})}}},51185:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(80621))&&r.__esModule?r:{default:r};t.default=o.default},51187:(e,t,n)=>{var r=n(87379),o=n(80547);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},51340:(e,t,n)=>{var r=n(1386),o=n(64103),a=n(21779),i=n(34162),s=n(7462),c=n(96638);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=o,l.prototype.delete=a,l.prototype.get=i,l.prototype.has=s,l.prototype.set=c,e.exports=l},51465:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,API_LOG_TAG:n,context:a,MixinsMessaging:i}=e,s=t.getLogger("MESSAGING");return{conversation:{get:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"im"};s.debug(n+"conversation.get: ",e,t);const r=Array.isArray(e)?[...e]:[e];let c,l,u="Conversation";const d=(0,o.findConversation)(a.getState(),r,t.type);if(d){if(t.type===d.type)return u=d.description,c=d.messages,l=d.id,i.Conversation({destination:r,type:t.type,id:l,description:u,messages:c,lastMessage:d.lastMessage,isTypingList:d.isTypingList,lastReceived:d?d.lastReceived:void 0,lastPull:d?d.lastPull:void 0});s.info("Conversation found with matching destination, but conversation type does not match the type requested. Please specify the appropriate type, or call client.conversation.create() for a new type of conversation")}else s.info("Requested conversation not in state. Please use the create function if you would like a new conversation object.")},create:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:"im"};s.debug(n+"conversation.create: ",e,t);const c=Array.isArray(e)?e:[e];return(0,o.findConversation)(a.getState(),c,t.type)||a.dispatch(r.convoActions.createConversation(c,t)),i.Conversation({destination:c,type:t.type})},getAll:function(){return s.debug(n+"conversation.getAll"),(0,o.getConversations)(a.getState()).map(e=>i.Conversation(e))}}}},n(81045),n(84915);var r=n(29889),o=n(33603)},51471:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:(t,n,r)=>async function(e,t,n,r){const{context:o,Callstack:i,logManager:s}=e,{answerWebrtcSession:l}=i.utils,u=s.getLogger("CALL",t);u.info("Answering incoming call.");const d=(0,a.getCallById)(o.getState(),t),f=(0,c.checkBandwidthControls)(r.bandwidth),p={sessionId:d.webrtcSessionId,bandwidth:f,dscpControls:r.dscpControls,callId:d.id};let g;try{g=await l(n,p)}catch(e){throw u.info("Failed to answer incoming call."),e}return{webrtcInfo:g,bandwidth:f}}(e,t,n,r),signalling:(t,n,c,f)=>async function(e,t,n,c,f){const{context:p,Callstack:g,CallRequests:_,CallReporter:E,emitEvent:y,logManager:S}=e,{webrtcInfo:v,bandwidth:h}=f,T=(0,a.getCallById)(p.getState(),t),C=S.getLogger("CALL",T.id),I={id:T.id,answer:v.answerSDP,wrtcsSessionId:T.wrtcsSessionId,customParameters:c.customParameters,customBodies:c.customBodies};try{await _.answerSession(I),C.info(`Finished answering call. Changing to ${s.CALL_STATES.CONNECTED}.`);const e=((0,d.getSessionById)(p.getState(),T.webrtcSessionId)||{}).localTracks,t=await(0,l.getIncomingRemoteTracks)(v.session);p.dispatch(r.callActions.answerCallFinish(T.id,{state:s.CALL_STATES.CONNECTED,startTime:Date.now(),mediaIds:v.mediaIds,webrtcSessionId:v.sessionId,mediaConstraints:n,bandwidth:h,customParameters:c.customParameters,customBodies:c.customBodies,localTracks:e,remoteTracks:t},{isSlowStart:!1})),y(o.CALL_TRACKS_ADDED,{callId:T.id,trackIds:[...e,...t]}),y(o.CALL_STATE_CHANGE,{callId:T.id,previous:{state:T.state,localHold:T.localHold,remoteHold:T.remoteHold}})}catch(t){if(C.info("Failed to answer call."),55===t.code){const t=E.getReport(T.id),n=T.currentOperations.find(e=>e.isLocal&&e.type===i.OPERATIONS.ANSWER),r=t.getEvent(n.eventId).addEvent(u.REPORT_EVENTS.RESYNC);await g.operations.resyncCallState.stages.signalling(e,T.id),r.endEvent()}throw t}}(e,t,n,c,f)}},n(81045),n(45950);var r=n(35),o=n(51918),a=n(40481),i=n(59090),s=n(77126),c=n(69752),l=n(48151),u=n(84581),d=n(69260)},51709:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TRACK_SOURCE_UNMUTED=t.TRACK_SOURCE_MUTED=t.TRACK_RENDERED=t.TRACK_ENDED=t.TRACKS_UNMUTED=t.TRACKS_MUTED=t.INITIALIZE_DEVICES_ERROR=t.DEVICES_CHANGED=void 0,t.DEVICES_CHANGED="devices:change",t.INITIALIZE_DEVICES_ERROR="devices:error",t.TRACKS_MUTED="media:muted",t.TRACKS_UNMUTED="media:unmuted",t.TRACK_SOURCE_MUTED="media:sourceMuted",t.TRACK_SOURCE_UNMUTED="media:sourceUnmuted",t.TRACK_RENDERED="media:trackRendered",t.TRACK_ENDED="media:trackEnded"},51918:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STATS_RECEIVED=t.MEDIA_RESTART=t.MEDIA_CONNECTION_CHANGE=t.CUSTOM_PARAMETERS=t.CALL_TRACK_REPLACED=t.CALL_TRACKS_REMOVED=t.CALL_TRACKS_ADDED=t.CALL_STATE_CHANGE=t.CALL_STARTED=t.CALL_REMOVED_MEDIA=t.CALL_OPERATION=t.CALL_JOIN=t.CALL_INCOMING=t.CALL_ADDED_MEDIA=t.AVAILABLE_CODECS=void 0,t.CALL_OPERATION="call:operation",t.CALL_STARTED="call:start",t.CALL_JOIN="call:join",t.CALL_INCOMING="call:receive",t.CALL_STATE_CHANGE="call:stateChange",t.CALL_ADDED_MEDIA="call:newMedia",t.CALL_REMOVED_MEDIA="call:removedMedia",t.CALL_TRACKS_ADDED="call:tracksAdded",t.CALL_TRACKS_REMOVED="call:tracksRemoved",t.STATS_RECEIVED="call:statsReceived",t.CALL_TRACK_REPLACED="call:trackReplaced",t.CUSTOM_PARAMETERS="call:customParameters",t.AVAILABLE_CODECS="call:availableCodecs",t.MEDIA_CONNECTION_CHANGE="call:mediaConnectionChange",t.MEDIA_RESTART="call:mediaRestart"},51942:(e,t,n)=>{var r=n(528),o=n(41439),a=n(65196),i=n(50961),s=n(53142),c=n(46648);e.exports=function(e){return o(function(t){var n=t.length,o=n,l=r.prototype.thru;for(e&&t.reverse();o--;){var u=t[o];if("function"!=typeof u)throw new TypeError("Expected a function");if(l&&!d&&"wrapper"==i(u))var d=new r([],!0)}for(o=d?o:n;++o<n;){u=t[o];var f=i(u),p="wrapper"==f?a(u):void 0;d=p&&c(p[0])&&424==p[1]&&!p[4].length&&1==p[9]?d[i(p[0])].apply(d,p[3]):1==u.length&&c(u)?d[f]():d.thru(u)}return function(){var e=arguments,r=e[0];if(d&&1==e.length&&s(r))return d.plant(r).value();for(var o=0,a=n?t[o].apply(this,e):r;++o<n;)a=t[o].call(this,a);return a}})}},52037:(e,t,n)=>{"use strict";var r,o,a,i=n(5234),s=n(14188),c=n(80831),l=n(77065),u=n(91786),d=n(97509),f=n(4282),p=n(1942),g=f("iterator"),_=!1;[].keys&&("next"in(a=[].keys())?(o=u(u(a)))!==Object.prototype&&(r=o):_=!0),!c(r)||i(function(){var e={};return r[g].call(e)!==e})?r={}:p&&(r=l(r)),s(r[g])||d(r,g,function(){return this}),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:_}},52063:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConfiguration=function(e){return(0,o.default)(e.config)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},52068:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const{context:i,logManager:s}=e,c=t.calls.reduce((e,t)=>(e[t.callId]=!1,e),{});let l=!1;function u(){return t.calls.every(e=>!0===c[e.callId])}const d={respondCallUpdate:async function(e,o){c[e.id]=!0;const i=e.wrtcsSessionId,l=s.getLogger("CALL",e?e.id:void 0);if(t.tracker.resume(),e.state===r.CALL_STATES.ENDED)return void l.info("Join response for ended call. Ignoring.",{wrtcsSessionId:i});const d=(0,a.getMediaState)(e);l.info(`Processing remote response for local ${t.type} operation. Call state: ${e.state}, MediaState: ${d}.`);try{await n.remoteAnswer(e,o)}catch(e){f(e)}u()&&f()},callEnd:async function(e,r){let a;await t.calls.map(async e=>{const t=(0,o.getCallById)(i.getState(),e.callId);if("joined"===e.role)return n.joinedFailure(t,r);a=await n.remoteFailure(t,r)}),f(a)},sessionComplete:async function(e,t){c[e.id]=!0,await n.remoteSuccess(e,t),u()&&f()},sessionFail:async function(e,t){f(await n.remoteFailure(e,t))}};function f(e){if(!l&&(l=!0,t.reportEvent.endEvent(e),t.tracker.finish(e),e))throw e}return{start:async function(e,r){t.tracker.start();const o=n.validate(i.getState(),e);o&&f(o);try{const o=await n.localOffer(e,...r);t.tracker.update(),await n.signalling(e,o)}catch(e){f(e)}},receiveResponse:async function(e,n){const r=n.eventType;if(!r)throw new Error(`No event type provided for ${t.type} feedback!`);if(void 0===d[r])throw new Error(`No ${r} on the flow!`);return d[r](e,n)}}},n(97107),n(81045),n(42042),n(84915),n(55367);var r=n(77126),o=n(40481),a=n(73520)},52107:(e,t,n)=>{var r=n(40091),o=n(41580);e.exports=function e(t,n,a,i,s,c){return o(t)&&o(n)&&(c.set(n,t),r(t,n,void 0,e,c),c.delete(n)),t}},52118:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionIntervals.resubInterval",()=>(0,o.default)(e.container))};var r,o=(r=n(59805))&&r.__esModule?r:{default:r}},52291:(e,t,n)=>{var r=n(65650),o=n(65111),a=n(53142),i=n(51187),s=r?r.prototype:void 0,c=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(a(t))return o(t,e)+"";if(i(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},52410:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallstackSDP.compareMedia",()=>(0,r.default)(e.container)),e.factory("CallstackSDP.runPipeline",()=>(0,o.default)(e.container))};var r=a(n(87520)),o=a(n(38773));function a(e){return e&&e.__esModule?e:{default:e}}},52502:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{emitEvent:t,PresenceOperations:n,logManager:a,API_LOG_TAG:i,context:s}=e,c=a.getLogger("PRESENCE");return{presence:{async update(e,o,a){c.debug(i+"presence.update: ",e,o,a);try{await n.update(e,o,a),t(r.SELF_CHANGE,{})}catch(e){t(r.ERROR,{error:e})}},async fetch(e){c.debug(i+"presence.fetch: ",e);const o=Array.isArray(e)?e:[e];try{await n.fetch(o)}catch(e){t(r.ERROR,{error:e})}},async subscribe(e){c.debug(i+"presence.subscribe: ",e),e=Array.isArray(e)?e:[e];try{await n.subscribe(e)}catch(e){t(r.ERROR,{error:e})}},async unsubscribe(e){c.debug(i+"presence.unsubscribe: ",e),e=Array.isArray(e)?e:[e];try{await n.unsubscribe(e)}catch(e){t(r.ERROR,{error:e})}},get(e){c.debug(i+"presence.get: ",e);const t=Array.isArray(e)?e:[e],n=o.getPresence(s.getState(),t);return Array.isArray(t)?n:n.length?n[0]:void 0},getAll:()=>(c.debug(i+"presence.getAll: "),o.getAllPresence(s.getState())),getSelf:()=>(c.debug(i+"presence.getSelf: "),o.getSelfPresence(s.getState()))}}};var r=n(84341),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(22612))},52692:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(81045),n(30163),n(9925);var r=l(n(35968)),o=l(n(3e4)),a=l(n(15353)),i=l(n(27748)),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81322)),c=n(45775);function l(e){return e&&e.__esModule?e:{default:e}}const u={};u[s.FETCH_CALL_HISTORY_FINISH]={next(e,t){const n=e.filter(function(e){return 36===e.recordId.length&&"0"!==e.duration}),s=e.filter(function(e){return""!==e.resourceLocation}),c=n.filter(function(e){return!t.payload.some(f,e)}),l=(0,r.default)((0,o.default)("recordId",t.payload,s),c);return(0,i.default)((0,a.default)("startTime",l))}},u[s.DELETE_CALL_HISTORY_FINISH]={next:(e,t)=>"all"===t.payload?[]:e.filter(function(e){return e.recordId!==t.payload})},u[s.ADD_CALL_HISTORY_ENTRY]={next:(e,t)=>(0,r.default)(t.payload,e)},u[s.SET_CACHE]={next:(e,t)=>t.payload};const d=(0,c.handleActions)(u,[]);t.default=d;const f=function(e){return!(Math.abs(e.startTime-this.startTime)>1e4||Math.abs(e.duration-this.duration)>5e3||e.direction!==this.direction)}},52837:e=>{e.exports=function(e){return e.split("")}},52899:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionOperations.onConnectionLost",t=>(0,o.default)(e.container))};var r,o=(r=n(97856))&&r.__esModule?r:{default:r}},52910:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,NotificationRequests:r}=e,s=n.getLogger("NOTIFICATIONS");return async function(e){const n=(0,i.getConnectionInfo)(t.getState()),{pushRegistration:c}=(0,a.getNotificationConfig)(t.getState());return c&&(n.server=(0,o.default)(n.server,c)),s.info("Un-registering device token for PUSH notifications..."),await r.pushNotificationsDeRegistration(n,{registration:e})}};var r,o=(r=n(38142))&&r.__esModule?r:{default:r},a=n(82803),i=n(87075)},52932:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validationResults=t.validation=t.parse=t.errorMessages=t.enums=void 0;var r=p(n(97679)),o=p(n(5968)),a=p(n(80880)),i=p(n(84499)),s=p(n(90283)),c=p(n(8637)),l=p(n(35968)),u=p(n(25666)),d=n(69932),f=p(n(87014));function p(e){return e&&e.__esModule?e:{default:e}}f.default.extend({function:()=>e=>"function"==typeof e}),t.validation=(0,f.default)(),t.enums=e=>{const t=(0,o.default)(e=>(0,f.default)().exact(e))(e);return(0,f.default)().passesAnyOf(...t)};const g=e=>t=>n=>(0,c.default)(E(e))(_(t)(n));t.errorMessages=g;const _=e=>t=>e.testAll(t);t.validationResults=_,t.parse=(e,t)=>n=>{const r=g(e)(t)(n);return(0,i.default)(r)||d.logManager.getLogger("VALIDATION").info(h(r)),n};const E=e=>t=>y([])(e)(t),y=e=>t=>n=>{let{cause:r,rule:o,target:i,value:u}=n;const d=(0,l.default)(e)(i||t);if((0,s.default)(r)){const e=y(d)(i);return(0,c.default)(e)(r)}return`${(0,a.default)(".")(d)} has value of '${u}', but it should be ${S(o)}`},S=e=>{let{name:t,args:n}=e;switch(t){case"schema":return"Schema";case"passesAnyOf":return`any of '${(0,a.default)("', '")((0,o.default)(v)(n))}'`;case"between":return`between ${n.join(", ")}`;default:return`${T(t)} ${t}`}},v=e=>e.chain[0].args,h=(0,r.default)(JSON.stringify)([u.default,null,4]),T=e=>/[aeiou]/i.test(e[0])?"an":"a"},53040:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"api",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(41100)),o=a(n(19083));function a(e){return e&&e.__esModule?e:{default:e}}t.name="clickToCall"},53142:e=>{var t=Array.isArray;e.exports=t},53229:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const{context:r}=e,o=t.calls.reduce((e,t)=>(e[t.callId]=!1,e),{});let a=!1;function i(){return t.calls.every(e=>!0===o[e.callId])}function s(e){if(!a&&(a=!0,t.reportEvent.endEvent(e),t.tracker.finish(e),e))throw e}const c={sessionComplete:async function(e,t){if(o[e.id]=!0,await n.remoteSuccess(e,t),i())return s()},sessionFail:async function(e,t){return s(await n.remoteFailure(e,t))},callEnd:async function(e,t){if(o[e.id]=!0,await n.remoteSuccess(e,t),i())return s()}};return{start:async function(e){t.tracker.start();const o=n.validate(r.getState(),e);if(o)throw t.reportEvent.endEvent(o),t.tracker.finish(o),o;try{t.tracker.update(),await n.signalling(e)}catch(e){throw t.reportEvent.endEvent(e),t.tracker.finish(e),e}},receiveResponse:async function(e,n){const r=n.eventType;if(!r)throw new Error(`No event type provided for ${t.type} feedback!`);if(void 0===c[r])throw new Error(`No ${r} on the flow!`);return c[r](e,n)}}},n(97107),n(81045),n(42042),n(55367)},53254:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,CallstackWebrtc:l,logManager:u}=e;return async function(e){let{reasonText:d,statusCode:f,remoteName:p,remoteNumber:g}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const _=(0,o.getCallByWrtcsSessionId)(t.getState(),e),E=u.getLogger("CALL",(_||{}).id);if(E.info("Received call status ended notice; handling.",{wrtcsSessionId:e}),!_)return void E.info("Call ended notice for unknown wrtcsSession. Ignoring.",{wrtcsSessionId:e});if(_.state===i.CALL_STATES.ENDED)return void E.info("Call ended notice for already Ended call. Ignoring.",{wrtcsSessionId:e});const y=_;E.debug(`Call ended notice caused by ${d} (Status Code: ${f}).`);try{await l.closeCall(_.webrtcSessionId)}catch(e){E.warn(`Could not succesfully complete closing local webrtc call: ${e.message}`)}E.info(`Finished handling call ended notice. Changing to ${i.CALL_STATES.ENDED}.`),t.dispatch(r.callActions.endCallFinish(_.id,(0,c.generateEndParams)(_.state,!1,{reasonText:d,statusCode:f,remoteName:p,remoteNumber:g}))),n(s.CALL_OPERATION,{callId:_.id,operation:a.OPERATIONS.END,transition:a.OP_TRANSITIONS.FINISH,isLocal:!1,previous:{}}),n(s.CALL_TRACKS_REMOVED,{callId:_.id,trackIds:[...y.localTracks,...y.remoteTracks]}),n(s.CALL_STATE_CHANGE,{callId:_.id,transition:{reasonText:d,statusCode:f},previous:{state:y.state,localHold:y.localHold,remoteHold:y.remoteHold}})}};var r=n(35),o=n(40481),a=n(59090),i=n(77126),s=n(51918),c=n(69752)},53453:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(54507);t.default={trickleIceMode:r.PEER.TRICKLE_ICE.FULL,removeBundling:!1,halfTrickleThreshold:function(e){let{sdp:t,iceCandidate:n,time:r}=e;return-1!==n.candidate.indexOf("relay")}}},53661:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(43328))&&r.__esModule?r:{default:r};t.default={name:"config",reducer:o.default}},54049:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container;return async function(r){if(!i(r))return;const s=r.payload.notificationMessage,{sessionData:c}=s.sessionParams,l=(0,a.getCallByWrtcsSessionId)(e.getState(),c),u=n.getLogger("CALL",l?l.id:void 0);l?l&&l.state!==o.CALL_STATES.RINGING&&l.state!==o.CALL_STATES.EARLY_MEDIA&&l.state!==o.CALL_STATES.INITIATED?u.info(`Received call cancel notification when state is ${l.state}. Ignoring.`):l&&l.isHandling?u.info("Received call cancel notification while handling is in-progress. Ignoring."):await t.callCancelled(c):u.info(`Received ${s.eventType} notification for unknown call; ignoring.`)}},t.shouldHandlePattern=i;var r=n(70506),o=n(77126),a=n(40481);function i(e){return e.type===r.NOTIFICATION_RECEIVED&&"callCancel"===e.payload.notificationMessage.eventType}},54471:(e,t,n)=>{"use strict";var r=n(5604),o=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},a=function(e){return{size:e,has:function(){return!0},keys:function(){throw new Error("e")}}};e.exports=function(e,t){var n=r("Set");try{(new n)[e](o(0));try{return(new n)[e](o(-1)),!1}catch(r){if(!t)return!0;try{return(new n)[e](a(-1/0)),!1}catch(r){var i=new n;return i.add(1),i.add(2),t(i[e](a(1/0)))}}}catch(e){return!1}}},54493:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n(63604)),o=s(n(70216)),a=s(n(43621)),i=s(n(14102));function s(e){return e&&e.__esModule?e:{default:e}}const c=[r.default,o.default,a.default,i.default];t.default=c},54502:(e,t,n)=>{var r=n(92673)("isUndefined",n(58771),n(76648));r.placeholder=n(22991),e.exports=r},54507:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PEER=t.MEDIA_DIR=t.ICE_COLLECTION_RESULT_TYPES=t.ICE_COLLECTION_CHECK_REASONS=void 0,t.PEER={TRICKLE_ICE:{FULL:"FULL",HALF:"HALF",NONE:"NONE"},ICE_GATHERING_STATE:{NEW:"new",GATHERING:"gathering",COMPLETE:"complete"},ENDPOINT:{LOCAL:"local",REMOTE:"remote"}},t.MEDIA_DIR={INACTIVE:"inactive",SEND_ONLY:"sendonly",RECV_ONLY:"recvonly",SEND_RECV:"sendrecv"},t.ICE_COLLECTION_CHECK_REASONS={ICE_GATHERING_STATE_CHANGE:"IceGatheringStateChanged",NEW_CANDIDATE:"NewCandidate",SCHEDULED:"Scheduled"},t.ICE_COLLECTION_RESULT_TYPES={START_CALL:"StartCall",WAIT:"Wait",ERROR:"Error"}},54628:()=>{},54722:(e,t,n)=>{var r=n(2427),o=n(923),a=n(9323);t.grammar=a,t.write=o,t.parse=r.parse,t.parseParams=r.parseParams,t.parseFmtpConfig=r.parseFmtpConfig,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates,t.parseImageAttributes=r.parseImageAttributes,t.parseSimulcastStreamList=r.parseSimulcastStreamList},54728:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t);return n?[o.CALL_STATES.INITIATED,o.CALL_STATES.RINGING].includes(n.state)?n.direction!==o.CALL_DIRECTION.INCOMING?new a.default({message:"Failed to reject call. Call must be incoming.",code:a.callCodes.INVALID_STATE}):void 0:new a.default({message:`Failed to reject call. Call must be in ${o.CALL_STATES.INITIATED} or ${o.CALL_STATES.RINGING} state.`,code:a.callCodes.INVALID_STATE}):new a.default({message:`Failed to reject call. Call ${t} not found.`,code:a.callCodes.INVALID_PARAM})},n(62234);var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},54732:(e,t,n)=>{var r=n(44700);e.exports=function(e){return r(this,e).has(e)}},54974:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"api",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(52502)),o=a(n(37601));function a(e){return e&&e.__esModule?e:{default:e}}t.name="presence"},54980:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(81045),n(30163),n(84915);var r=l(n(36582)),o=l(n(15353)),a=l(n(37273)),i=l(n(3e4)),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(87834)),c=n(45775);function l(e){return e&&e.__esModule?e:{default:e}}const u={};u[s.CREATE_CONVERSATION]={next:(e,t)=>({...e,conversations:[...e.conversations,{...t.payload}]})},u[s.FETCH_CONVERSATIONS_FINISHED]={next:(e,t)=>({...e,conversations:(0,a.default)((e,t)=>(0,r.default)(e.destination,t.destination)&&e.type===t.type,t.payload.conversations,e.conversations)})},u[s.UPDATE_CONVERSATION]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,...t.payload}:e)})},u[s.FETCH_MESSAGES]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,isPending:!0}:e)})},u[s.FETCH_MESSAGES_FINISHED]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:(0,o.default)("timestamp",(0,i.default)("messageId",t.payload.messages,e.messages)),isTypingList:[],isPending:!1}:e)})},u[s.SEND_MESSAGE]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.message.type?{...e,messages:[...e.messages,t.payload.message]}:e)})},u[s.INCOMING_MESSAGE_READ]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:e.messages.map(e=>e.messageId===t.payload.messageId?{...e,read:!0}:e)}:e)})},u[s.SEND_MESSAGE_READ_FINISH]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:e.messages.map(e=>e.messageId===t.payload.messageId?{...e,read:!0}:e)}:e)})},u[s.MESSAGE_RECEIVED]={next:(e,t)=>t.meta.newConversation?{...e,conversations:[...e.conversations,{destination:t.payload.destination,messages:[t.payload.message],type:t.meta.type,lastReceived:t.payload.message.timestamp}]}:{...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.meta.type?{...e,messages:[...e.messages,t.payload.message],lastReceived:t.payload.message.timestamp}:e)}},u[s.SEND_MESSAGE_FINISH]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:e.messages.map(e=>function(e,t){return e.timestamp===t.payload.timestamp?(e=t.payload.error?{...e,sender:t.payload.sender,isPending:!1,messageId:null,error:t.payload.error}:{...e,sender:t.payload.sender,isPending:!1,messageId:t.payload.messageId,parts:t.payload.parts},t.payload.deliveryStatus&&(e.deliveryStatus=t.payload.deliveryStatus)):e={...e},e}(e,t))}:e)}),throw:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:e.messages.filter(e=>e.timestamp!==t.payload.timestamp&&!e.isPending)}:e)})},u[s.CLEAR_MESSAGES]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:[]}:e)})},u[s.DELETE_MESSAGE_FINISH]={next:(e,t)=>({...e,conversations:e.conversations.map(e=>(0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type?{...e,messages:e.messages.filter(e=>e.messageId!==t.payload.messageId)}:e)}),throw:(e,t)=>({...e,errors:e.errors.concat(t.payload)})},u[s.DELETE_CONVERSATION_FINISH]={next:(e,t)=>({...e,conversations:e.conversations.filter(e=>!((0,r.default)(e.destination,t.payload.destination)&&e.type===t.payload.type))}),throw:(e,t)=>({...e,errors:e.errors.concat(t.payload)})};const d=(0,c.handleActions)(u,{conversations:[],errors:[]});t.default=d},55318:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.container.logManager.getLogger("MESSAGING");return t=(0,o.default)(t,n),n.info("Messaging features in use: "+t.features),e.factory("MixinsMessaging",r.createMixins),e.defer(function(e){const{context:n}=e;n.dispatch((0,c.update)(t,r.name))}),e.factory("MessagingOperations",a.default),e.factory("MessagingRequests",s.default),{api:r.createAPI,capabilities:["simpleMessagingOnly","onlyInternalMessaging"],middleware:i.default,name:r.name,reducer:r.reducer}};var r=n(78817),o=l(n(39174));n(63934);var a=l(n(57830)),i=l(n(2748)),s=l(n(39266)),c=n(87310);function l(e){return e&&e.__esModule?e:{default:e}}},55367:(e,t,n)=>{"use strict";n(74786)},55558:(e,t,n)=>{"use strict";var r=n(44977),o=n(3770),a=n(39944),i=n(76744),s=n(96002),c="Invalid size",l=RangeError,u=TypeError,d=Math.max,f=function(e,t){this.set=e,this.size=d(t,0),this.has=r(e.has),this.keys=r(e.keys)};f.prototype={getIterator:function(){return s(o(a(this.keys,this.set)))},includes:function(e){return a(this.has,this.set,e)}},e.exports=function(e){o(e);var t=+e.size;if(t!=t)throw new u(c);var n=i(t);if(n<0)throw new l(c);return new f(e,n)}},55603:(e,t,n)=>{"use strict";const r=n(33839),{stdout:o,stderr:a}=n(20223),{stringReplaceAll:i,stringEncaseCRLFWithFirstIndex:s}=n(5179),{isArray:c}=Array,l=["ansi","ansi","ansi256","ansi16m"],u=Object.create(null);class d{constructor(e){return f(e)}}const f=e=>{const t={};return((e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const n=o?o.level:0;e.level=void 0===t.level?n:t.level})(t,e),t.template=(...e)=>h(t.template,...e),Object.setPrototypeOf(t,p.prototype),Object.setPrototypeOf(t.template,t),t.template.constructor=()=>{throw new Error("`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.")},t.template.Instance=d,t.template};function p(e){return f(e)}for(const[e,t]of Object.entries(r))u[e]={get(){const n=y(this,E(t.open,t.close,this._styler),this._isEmpty);return Object.defineProperty(this,e,{value:n}),n}};u.visible={get(){const e=y(this,this._styler,!0);return Object.defineProperty(this,"visible",{value:e}),e}};const g=["rgb","hex","keyword","hsl","hsv","hwb","ansi","ansi256"];for(const e of g)u[e]={get(){const{level:t}=this;return function(...n){const o=E(r.color[l[t]][e](...n),r.color.close,this._styler);return y(this,o,this._isEmpty)}}};for(const e of g)u["bg"+e[0].toUpperCase()+e.slice(1)]={get(){const{level:t}=this;return function(...n){const o=E(r.bgColor[l[t]][e](...n),r.bgColor.close,this._styler);return y(this,o,this._isEmpty)}}};const _=Object.defineProperties(()=>{},{...u,level:{enumerable:!0,get(){return this._generator.level},set(e){this._generator.level=e}}}),E=(e,t,n)=>{let r,o;return void 0===n?(r=e,o=t):(r=n.openAll+e,o=t+n.closeAll),{open:e,close:t,openAll:r,closeAll:o,parent:n}},y=(e,t,n)=>{const r=(...e)=>c(e[0])&&c(e[0].raw)?S(r,h(r,...e)):S(r,1===e.length?""+e[0]:e.join(" "));return Object.setPrototypeOf(r,_),r._generator=e,r._styler=t,r._isEmpty=n,r},S=(e,t)=>{if(e.level<=0||!t)return e._isEmpty?"":t;let n=e._styler;if(void 0===n)return t;const{openAll:r,closeAll:o}=n;if(-1!==t.indexOf(""))for(;void 0!==n;)t=i(t,n.close,n.open),n=n.parent;const a=t.indexOf("\n");return-1!==a&&(t=s(t,o,r,a)),r+t+o};let v;const h=(e,...t)=>{const[r]=t;if(!c(r)||!c(r.raw))return t.join(" ");const o=t.slice(1),a=[r.raw[0]];for(let e=1;e<r.length;e++)a.push(String(o[e-1]).replace(/[{}\\]/g,"\\$&"),String(r.raw[e]));return void 0===v&&(v=n(69912)),v(e,a.join(""))};Object.defineProperties(p.prototype,u);const T=p();T.supportsColor=o,T.stderr=p({level:a?a.level:0}),T.stderr.supportsColor=a,e.exports=T},55608:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,SubscriptionRequests:r}=e,i=n.getLogger("SUBSCRIPTION");return async function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i.info("Updating subscription using new services: ",e);const s=(0,a.getSubscriptionInfo)(t.getState()),c=e.map(e=>e.service);s[0].service=n?(0,o.default)(c,s[0].service):s[0].service.filter(e=>c.includes(e));const l=await r.resubscribe(s),u={...l.subscriptionParams,servicesInfo:l.servicesInfo,url:l.subscription};return i.info(`Subscribed to the following services: ${s[0].service}`),{subscriptions:[u]}}},n(62234),n(81045),n(30163),n(84915);var r,o=(r=n(43813))&&r.__esModule?r:{default:r},a=n(56512)},55620:(e,t,n)=>{var r=n(90313),o=n(23945),a=n(15630),i=n(65406),s=o(function(e){return a(r(e,1,i,!0))});e.exports=s},56027:(e,t,n)=>{var r=n(87379),o=n(80547);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},56137:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:c,WebRTC:l,CallstackSDP:u}=e;return async function(e,d){const{customParameters:f}=d,p=(0,o.getCallByWrtcsSessionId)(t.getState(),e),g=c.getLogger("CALL",(p||{}).id);if(g.info("Received early media notice; handling.",{wrtcsSessionId:e}),!p)return void g.info("Early media notice for unknown wrtcsSession. Ignoring.",{wrtcsSessionId:e});const _=await l.sessionManager.get(p.webrtcSessionId);if(!_)return void g.info("Early media notice for missing wrtcsSession. Ignoring.",{wrtcsSessionId:e});if(f){const e=f.map(e=>e.name);g.debug(`Received custom parameters as part of the Call: ${e}.`),t.dispatch(r.callActions.customParametersReceived(p.id,{customParameters:f})),n(i.CUSTOM_PARAMETERS,{callId:p.id,customParameters:f})}try{const e=(0,o.getOptions)(t.getState()),n=u.runPipeline(e.sdpHandlers,d.sdp,{callId:p.id,type:"pranswer",step:"set",endpoint:"remote"});await _.processAnswer({type:"pranswer",sdp:n})}catch(e){throw g.debug(`Failed to process pranswer for Call ${p.id}; ignoring.`),e}const E=await(0,a.getAllRemoteTracks)(_);g.info(`Finished handling early media notice. Changing to ${s.CALL_STATES.EARLY_MEDIA}.`),t.dispatch(r.callActions.sessionProgress(p.id,{remoteParticipant:{displayNumber:d.remoteNumber,displayName:d.remoteName},remoteTracks:E})),n(i.CALL_TRACKS_ADDED,{callId:p.id,trackIds:E}),n(i.CALL_STATE_CHANGE,{callId:p.id,previous:{state:p.state,localHold:p.localHold,remoteHold:p.remoteHold}})}},n(81045),n(84915);var r=n(35),o=n(40481),a=n(48151),i=n(51918),s=n(77126)},56176:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,SipEventsOperations:a,logManager:i,API_LOG_TAG:s}=e,c=i.getLogger("SIPEVENTS");async function l(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];l||c.debug(s+"sip.subscribeAsync: ",e,t,r,i),await a.subscribe(e,t,r,i),l||n(o.EVENT_SUBSCRIPTION_CHANGED,{eventType:e,change:"newSubscription",subscribedUsers:t})}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||c.debug(s+"sip.unsubscribeAsync: ",e),await a.unsubscribe(e),t||n(o.EVENT_SUBSCRIPTION_CHANGED,{eventType:e,change:"unsubscribe"})}async function d(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i||c.debug(s+"sip.updateAsync: ",e,t,r),await a.update(e,t,r),i||n(o.EVENT_SUBSCRIPTION_CHANGED,{eventType:e,change:"updateSubscription",subscribeUserList:t?.subscribeUserList||[],unsubscribeUserList:t?.unsubscribeUserList||[]})}return{sip:{...{getDetails(e){const{getState:n}=t;return c.debug(s+"sip.getDetails: ",e),(0,r.getSipEventInfo)(n(),e)}},subscribe:async function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c.debug(s+"sip.subscribe: ",e,t,r,a);try{await l(e,t,r,a,!0)}catch(e){return void n(o.EVENT_ERROR,{error:e})}n(o.EVENT_SUBSCRIPTION_CHANGED,{eventType:e,change:"newSubscription",subscribedUsers:t})},subscribeAsync:l,unsubscribe:async function(e){c.debug(s+"sip.unsubscribe: ",e);try{await u(e,!0)}catch(e){return void n(o.EVENT_ERROR,{error:e})}n(o.EVENT_SUBSCRIPTION_CHANGED,{eventType:e,change:"unsubscribe"})},unsubscribeAsync:u,update:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];c.debug(s+"sip.update: ",e,t,r);try{await d(e,t,r,!0)}catch(e){return void n(o.EVENT_ERROR,{error:e})}n(o.EVENT_SUBSCRIPTION_CHANGED,{eventType:e,change:"updateSubscription",subscribeUserList:t.subscribeUserList||[],unsubscribeUserList:t.unsubscribeUserList||[]})},updateAsync:d}}};var r=n(29962),o=n(40943)},56294:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.organizeTracks=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={audio:[],video:[],screen:[],all:[]};return await Promise.all(e.map(async e=>{if(["audio","video","screen"].includes(e.type)){const n=await e.media.getTracks();t[e.type]=t[e.type].concat(n),t.all=t.all.concat(n)}})),t},n(62234),n(81045),n(84915)},56341:(e,t,n)=>{var r=n(86912),o=n(64364),a=n(78942);e.exports=function(e,t,n,i){var s=1&t,c=o(e);return function t(){for(var o=-1,l=arguments.length,u=-1,d=i.length,f=Array(d+l),p=this&&this!==a&&this instanceof t?c:e;++u<d;)f[u]=i[u];for(;l--;)f[u++]=arguments[++o];return r(p,s?n:this,f)}}},56512:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPendingOperation=function(e){return e.subscription.pendingOperation},t.getRegisteredServices=function(e){return(0,r.default)(e.subscription.registeredServices)},t.getServiceUnavailableMaxRetries=function(e){return e.config.subscription.serviceUnavailableMaxRetries},t.getSubscribedServices=function(e,t){let n=i(e);return t&&(n=n.filter(e=>e.channelType===t)),n.reduce((e,t)=>e.concat(t.service),[])},t.getSubscriptionConfig=function(e){return(0,r.default)(e.config.subscription)},t.getSubscriptionExpiry=function(e){const t=e.config.subscription,n=e.config.authentication;return n.subscription&&n.subscription.expires?n.subscription.expires:t.expires},t.getSubscriptionInfo=i,t.getSubscriptions=function(e,t,n){let o=e.subscription.subscriptions;return o=o.filter(e=>e.service===t&&e.channelType===n),(0,r.default)(o)},t.getWebsocketConfig=function(e){const t=e.config.subscription,n=e.config.authentication;return(0,o.default)(t.websocket,n.websocket)},t.getWebsocketId=function(e,t){let n,r=i(e);if(r=Array.isArray(r)?r:[r],n=t?r.find(e=>"service"===e.service||e.service.includes(t)):r[0],n&&"string"==typeof n.notificationChannel)return n.notificationChannel.split("/websocket/")[1]},n(62234),n(81045),n(30163),n(45950),n(55367);var r=a(n(89321)),o=a(n(7485));function a(e){return e&&e.__esModule?e:{default:e}}function i(e){return(0,r.default)(e.subscription.subscriptions)}},56539:(e,t,n)=>{"use strict";var r=n(5613),o=n(65077),a=n(27420);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("union")||!a("union")},{union:o})},56713:(e,t,n)=>{var r=n(64364),o=n(78942);e.exports=function(e,t,n){var a=1&t,i=r(e);return function t(){return(this&&this!==o&&this instanceof t?i:e).apply(a?n:this,arguments)}}},56731:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallOperations.setTurnCredentials",()=>(0,o.default)(e.container))};var r,o=(r=n(49116))&&r.__esModule?r:{default:r}},57073:(e,t,n)=>{var r=n(72532);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},57082:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.CallManager;return async function(e){if(!o(e))return;const n=e.payload.notificationMessage,r=n.callNotificationParams||{},a=n.sessionParams.sessionData,i={eventType:n.eventType,sdp:n.sessionParams.sdp,remoteName:r.callerName,remoteNumber:r.callerDisplayNumber,calleeNumber:r.calleeDisplayNumber,customParameters:n.customParameters};await t.establishOffer(a,i,e.meta.channel)}},t.shouldHandlePattern=o;var r=n(70506);function o(e){return e.type===r.NOTIFICATION_RECEIVED&&"call"===e.payload.notificationMessage.eventType}},57137:(e,t,n)=>{"use strict";var r=n(21843),o=n(61274);e.exports=Object.keys||function(e){return r(e,o)}},57182:(e,t,n)=>{"use strict";var r=n(5613),o=n(79117),a=n(5604),i=n(39123),s=n(64466).f,c=n(74418),l=n(40286),u=n(44166),d=n(69866),f=n(38015),p=n(87308),g=n(96893),_=n(1942),E="DOMException",y=a("Error"),S=a(E),v=function(){l(this,h);var e=arguments.length,t=d(e<1?void 0:arguments[0]),n=d(e<2?void 0:arguments[1],"Error"),r=new S(t,n),o=new y(t);return o.name=E,s(r,"stack",i(1,p(o.stack,1))),u(r,this,v),r},h=v.prototype=S.prototype,T="stack"in new y(E),C="stack"in new S(1,2),I=S&&g&&Object.getOwnPropertyDescriptor(o,E),m=!(!I||I.writable&&I.configurable),O=T&&!m&&!C;r({global:!0,constructor:!0,forced:_||O},{DOMException:O?v:S});var A=a(E),R=A.prototype;if(R.constructor!==A)for(var b in _||s(R,"constructor",i(1,A)),f)if(c(f,b)){var N=f[b],M=N.s;c(A,M)||s(A,M,i(6,N.c))}},57188:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallReporter:n,WebRTCMediaOperations:r}=e;return async function(e,c){const l=(0,a.getCallById)(t.getState(),c),u=n.getReport(c),d=l.currentOperations.find(e=>e.isLocal&&e.status===i.OP_STATUS.ONGOING&&(e.isBlocking||[i.OPERATIONS.REPLACE_TRACK,i.OPERATIONS.JOIN].includes(e.type))),f=u.getEvent(d.eventId).addEvent(s.REPORT_EVENTS.GET_USER_MEDIA);f.addData("mediaConstraints",(0,o.default)(e));let p=[];try{p=await r.createLocal(e)}catch(e){throw f.setError(e),f.endEvent(),e}return f.endEvent(),p}},n(62234),n(81045),n(45950);var r,o=(r=n(89321))&&r.__esModule?r:{default:r},a=n(40481),i=n(59090),s=n(84581)},57195:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,NotificationRequests:n}=e,r=t.getLogger("NOTIFICATIONS");return async function(e){return r.info("Registering device token for PUSH notifications..."),await n.pushNotificationsRegistration(e)}}},57200:(e,t,n)=>{var r=n(41580),o=n(84882),a=n(38546),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return a(e);var t=o(e),n=[];for(var s in e)("constructor"!=s||!t&&i.call(e,s))&&n.push(s);return n}},57224:e=>{e.exports=function(e,t){return function n(){null==t&&(t=e.length);var r=[].slice.call(arguments);return r.length>=t?e.apply(this,r):function(){return n.apply(this,r.concat([].slice.call(arguments)))}}}},57327:(e,t,n)=>{"use strict";var r=n(5613),o=n(39944),a=n(38873),i=n(44977),s=n(3770),c=n(96002),l=n(88500),u=n(20850)("forEach",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(e){s(this);try{i(e)}catch(e){l(this,"throw",e)}if(u)return o(u,this,e);var t=c(this),n=0;a(t,function(t){e(t,n++)},{IS_RECORD:!0})}})},57452:(e,t,n)=>{var r=n(94497);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},57553:(e,t,n)=>{var r=n(39747),o=n(75962);function a(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}a.prototype=r(o.prototype),a.prototype.constructor=a,e.exports=a},57761:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return r.default}});var r=a(n(45207)),o=a(n(27177));function a(e){return e&&e.__esModule?e:{default:e}}},57830:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:l,MessagingRequests:u}=e,d=l.getLogger("MESSAGING");return{messageReceived:function(e){const{dispatch:i,getState:s}=t;if(![c.NOTIFICATION_RECEIVED].includes(e.type))return;if(!e.payload.notificationMessage||"IM"!==e.payload.notificationMessage.eventType)return;const l=e.payload.notificationMessage.imnotificationParams.msgText,u=e.payload.notificationMessage.imnotificationParams.primaryContact.split("sip:")[1],d=e.payload.notificationMessage.eventId,f="im";if((0,o.getConversations)(s()).find(e=>e.destination[0]===u)){i(r.messageActions.messageReceived([u],[{mimeType:"text/plain",type:"text",text:l}],d,u,Date.now(),{newConversation:!1,type:f}));const e={destination:[u],messageId:d,type:f};n(a.MESSAGES_CHANGE,e)}else{i(r.messageActions.messageReceived([u],[{mimeType:"text/plain",type:"text",text:l}],d,u,Date.now(),{newConversation:!0,type:"im"}));const e=[{destination:[u],type:f}];n(a.CONVERSATIONS_CHANGE,e)}},sendMessage:async function(e,o,c){const l=(0,s.getConnectionInfo)(t.getState()),f="im";let p;if(!l)throw d.debug("Sending mesage was aborted due to: no connection info available. Ensure user is authenticated."),p=new i.default({code:i.messagingCodes.SEND_MESSAGE_FAIL,message:"Failed to send message; no user connection info available."}),t.dispatch(r.messageActions.sendMessageFinish({sender:void 0,destination:[e],type:f,parts:c,timestamp:o,error:p})),n(a.MESSAGES_ERROR,{error:p}),p;const{username:g}=l;try{const i=await u.sendMessage(e,c);t.dispatch(r.messageActions.sendMessageFinish({sender:g,destination:[e],type:f,parts:c,timestamp:o,messageId:i.messageId})),n(a.MESSAGES_CHANGE,{destination:[e],type:f,messageId:i.messageId,sender:g})}catch(p){throw t.dispatch(r.messageActions.sendMessageFinish({sender:g,destination:[e],type:f,parts:c,timestamp:o,error:p})),n(a.MESSAGES_ERROR,{error:p}),p}}}},n(62234),n(81045),n(45950);var r=n(29889),o=n(33603),a=l(n(35180)),i=l(n(75412)),s=n(87075),c=n(70506);function l(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},57923:(e,t,n)=>{var r=n(93526),o=n(66040);e.exports=function(e,t){for(var n=0,a=(t=r(t,e)).length;null!=e&&n<a;)e=e[o(t[n++])];return n&&n==a?e:void 0}},57946:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return o.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return r.default}});var r=a(n(67261)),o=a(n(93725));function a(e){return e&&e.__esModule?e:{default:e}}t.name="subscription"},57989:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,log:n}=this;return t.onnegotiationneeded=function(t){n.debug("Peer received negotiationneeded event."),e(t)},!0}},58384:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=function(e){const t=(0,o.default)();return{createReport:function(){const n=e.getLogger(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1]),o=t.createReport(...arguments),a=o.addMetric;return o.addMetric=(e,t)=>{if("number"==typeof t)n.debug(`Metric collected: ${e} is ${t} ms`);else if(t.duration&&t.operation)n.debug(`Metric collected: ${e} is ${t.duration} ms, during operation: ${t.operation}`);else if(t.candidates&&t.operation)for(const r of t.candidates)r.duration&&n.debug(`Metric collected: ${e} is ${r.duration} ms, during operation: ${t.operation}`);a(e,t)},r.default.registerAllMetricHandlers(o),o},getReport:t.getReport,deleteReport:t.deleteReport}}(e.container.logManager);e.value("CallReporter",t)};var r=a(n(93339)),o=a(n(14132));function a(e){return e&&e.__esModule?e:{default:e}}},58422:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.slowStart",()=>{const t=(0,r.default)(e.container);return{remote:{localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,o.default)(e.container)}}}),e.factory("Callstack.operations.slowStart",()=>{const t=e.container.Callstack.models.Negotiation;return{remote:function(n){return t.instance({type:i.OPERATIONS.SLOW_START,isLocal:!1,stages:e.container.Callstack.stages.slowStart.remote,createFlow:(e,t,n)=>{const r=(0,a.default)(e,t,n);return{...r,start:function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];return r.start(e,o)}}}},{callId:n,deferred:{resolve:()=>{},reject:()=>{}}})}}})};var r=s(n(77406)),o=s(n(87351)),a=s(n(98307)),i=n(59090);function s(e){return e&&e.__esModule?e:{default:e}}},58526:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,UsersOperations:a,logManager:i,API_LOG_TAG:s}=e,c=i.getLogger("USERS");return{async fetch(e){let t;c.debug(s+"user.fetch: ",e);try{t=await a.fetchUser(e),t&&n(o.USERS_CHANGE,{results:[t]})}catch(e){n(o.USERS_ERROR,{error:e})}},get:e=>(c.debug(s+"user.get: ",e),(0,r.getUser)(t.getState(),e)),getAll:()=>(c.debug(s+"user.getAll"),(0,r.getUsers)(t.getState())),async search(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c.debug(s+"user.search: ",t,r);try{e=await a.searchDirectory(t,r)}catch(e){return void n(o.DIRECTORY_ERROR,{error:e})}n(o.DIRECTORY_CHANGE,{results:e})}}};var r=n(49639),o=n(62318)},58532:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return o.default.parse(e).media.filter(e=>"audio"===e.type).some(e=>e.rtp.some(e=>"telephone-event"===e.codec))},n(81045),n(30163),n(9925);var r,o=(r=n(54722))&&r.__esModule?r:{default:r}},58638:(e,t,n)=>{var r=n(4943),o=n(56713),a=n(42443),i=n(23504),s=n(56341),c=n(65196),l=n(47028),u=n(65512),d=n(5620),f=n(67642),p=Math.max;e.exports=function(e,t,n,g,_,E,y,S){var v=2&t;if(!v&&"function"!=typeof e)throw new TypeError("Expected a function");var h=g?g.length:0;if(h||(t&=-97,g=_=void 0),y=void 0===y?y:p(f(y),0),S=void 0===S?S:f(S),h-=_?_.length:0,64&t){var T=g,C=_;g=_=void 0}var I=v?void 0:c(e),m=[e,t,n,g,_,T,C,E,y,S];if(I&&l(m,I),e=m[0],t=m[1],n=m[2],g=m[3],_=m[4],!(S=m[9]=void 0===m[9]?v?0:e.length:p(m[9]-h,0))&&24&t&&(t&=-25),t&&1!=t)O=8==t||16==t?a(e,t,S):32!=t&&33!=t||_.length?i.apply(void 0,m):s(e,t,n,g);else var O=o(e,t,n);return d((I?r:u)(O,m),e,t)}},58771:e=>{e.exports=function(e){return void 0===e}},58871:(e,t,n)=>{"use strict";var r=n(5613),o=n(31657),a=n(27420);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("symmetricDifference")||!a("symmetricDifference")},{symmetricDifference:o})},58898:(e,t,n)=>{var r=n(31623);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},58998:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.container),n=(0,s.default)(e.container);e.factory("Callstack.stages.hold",()=>({local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,i.default)(e.container),rollback:(0,a.default)(e.container)},remote:{remoteOffer:n.localChanges,signalling:n.signalling}})),e.factory("Callstack.operations.hold",()=>{const t=e.container.Callstack,n=t.models.Negotiation;function r(e){return(r,o)=>{const a=t.stages.hold[e?"local":"remote"];return n.instance({type:c.OPERATIONS.HOLD,isLocal:e,stages:a},{callId:r,deferred:o})}}return{local:r(!0),remote:r(!1)}}),e.factory("Callstack.utils.rollbackHold",()=>(0,a.default)(e.container))};var r=l(n(38877)),o=l(n(35590)),a=l(n(8506)),i=l(n(99808)),s=l(n(18893)),c=n(59090);function l(e){return e&&e.__esModule?e:{default:e}}},59068:(e,t,n)=>{var r=n(44700);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},59090:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OP_TRANSITIONS=t.OP_STATUS=t.OPERATIONS=t.NO_FINISH_OPS=t.ENDPOINTS=void 0;const n=t.OPERATIONS={MAKE:"MAKE",MAKE_ANONYMOUS:"MAKE_ANONYMOUS",ANSWER:"ANSWER",SLOW_ANSWER:"SLOW_ANSWER",REJECT:"REJECT",IGNORE:"IGNORE",END:"END",SEND_RINGING_FEEDBACK:"SEND_RINGING_FEEDBACK",FORWARD_CALL:"FORWARD_CALL",HOLD:"HOLD",UNHOLD:"UNHOLD",SEND_CUSTOM_PARAMETERS:"SEND_CUSTOM_PARAMETERS",ADD_MEDIA:"ADD_MEDIA",ADD_BASIC_MEDIA:"ADD_BASIC_MEDIA",REMOVE_MEDIA:"REMOVE_MEDIA",REMOVE_BASIC_MEDIA:"REMOVE_BASIC_MEDIA",GET_STATS:"GET_STATS",SEND_DTMF:"SEND_DTMF",CONSULTATIVE_TRANSFER:"CONSULTATIVE_TRANSFER",DIRECT_TRANSFER:"DIRECT_TRANSFER",JOIN:"JOIN",REPLACE_TRACK:"REPLACE_TRACK",MEDIA_RESTART:"MEDIA_RESTART",RESYNC:"RESYNC",PLAY_AUDIO:"PLAY_AUDIO",GET_AVAILABLE_CODECS:"GET_AVAILABLE_CODECS",START_MOH:"START_MOH",STOP_MOH:"STOP_MOH",SLOW_START:"SLOW_START",GENERIC_REMOTE:"GENERIC_REMOTE",CALL_CANCEL:"CALL_CANCEL"};t.ENDPOINTS={LOCAL:"LOCAL",REMOTE:"REMOTE"},t.OP_STATUS={NOT_STARTED:"NOT_STARTED",ONGOING:"ONGOING",PENDING:"PENDING",RESOLVING:"RESOLVING",FINISHED:"FINISHED"},t.OP_TRANSITIONS={START:"START",UPDATE:"UPDATE",RESUME:"RESUME",FINISH:"FINISH"},t.NO_FINISH_OPS=[n.ADD_BASIC_MEDIA,n.REMOVE_BASIC_MEDIA,n.GET_AVAILABLE_CODECS,n.MAKE_ANONYMOUS]},59191:(e,t,n)=>{var r=n(80547),o=n(48360);e.exports=function(e){return r(e)&&1===e.nodeType&&!o(e)}},59195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e=(0,a.default)(i,e),c(e),e},t.parseOptions=t.defaultOptions=void 0;var r,o=n(52932),a=(r=n(7485))&&r.__esModule?r:{default:r};const i=t.defaultOptions={restTimeout:3e4},s=o.validation.schema({restTimeout:o.validation.number()}),c=t.parseOptions=(0,o.parse)("request",s)},59221:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n){await a(e,t,n)}},t.signalling=a;var r=n(40481),o=n(77126);async function a(e,t,n){const{CallRequests:a,CallstackWebrtc:i,context:s,logManager:c}=e,l=c.getLogger("CALL",t);l.info("Forwarding incoming call.");const u=(0,r.getCallById)(s.getState(),t),d={wrtcsSessionId:u.wrtcsSessionId,address:n};try{await a.forwardSession(d),await i.closeCall(u.webrtcSessionId),l.info(`Finished forwarding call. Changing to ${o.CALL_STATES.ENDED}.`)}catch(e){throw l.info("Failed to forward call."),e}}},59246:(e,t,n)=>{const r=n(76931),o={};for(const e of Object.keys(r))o[r[e]]=e;const a={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};e.exports=a;for(const e of Object.keys(a)){if(!("channels"in a[e]))throw new Error("missing channels property: "+e);if(!("labels"in a[e]))throw new Error("missing channel labels property: "+e);if(a[e].labels.length!==a[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:n}=a[e];delete a[e].channels,delete a[e].labels,Object.defineProperty(a[e],"channels",{value:t}),Object.defineProperty(a[e],"labels",{value:n})}function i(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}a.rgb.hsl=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.min(t,n,r),a=Math.max(t,n,r),i=a-o;let s,c;a===o?s=0:t===a?s=(n-r)/i:n===a?s=2+(r-t)/i:r===a&&(s=4+(t-n)/i),s=Math.min(60*s,360),s<0&&(s+=360);const l=(o+a)/2;return c=a===o?0:l<=.5?i/(a+o):i/(2-a-o),[s,100*c,100*l]},a.rgb.hsv=function(e){let t,n,r,o,a;const i=e[0]/255,s=e[1]/255,c=e[2]/255,l=Math.max(i,s,c),u=l-Math.min(i,s,c),d=function(e){return(l-e)/6/u+.5};return 0===u?(o=0,a=0):(a=u/l,t=d(i),n=d(s),r=d(c),i===l?o=r-n:s===l?o=1/3+t-r:c===l&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*a,100*l]},a.rgb.hwb=function(e){const t=e[0],n=e[1];let r=e[2];const o=a.rgb.hsl(e)[0],i=1/255*Math.min(t,Math.min(n,r));return r=1-1/255*Math.max(t,Math.max(n,r)),[o,100*i,100*r]},a.rgb.cmyk=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.min(1-t,1-n,1-r);return[100*((1-t-o)/(1-o)||0),100*((1-n-o)/(1-o)||0),100*((1-r-o)/(1-o)||0),100*o]},a.rgb.keyword=function(e){const t=o[e];if(t)return t;let n,a=1/0;for(const t of Object.keys(r)){const o=i(e,r[t]);o<a&&(a=o,n=t)}return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){let t=e[0]/255,n=e[1]/255,r=e[2]/255;return t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,[100*(.4124*t+.3576*n+.1805*r),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){const t=a.rgb.xyz(e);let n=t[0],r=t[1],o=t[2];return n/=95.047,r/=100,o/=108.883,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,[116*r-16,500*(n-r),200*(r-o)]},a.hsl.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;let o,a,i;if(0===n)return i=255*r,[i,i,i];o=r<.5?r*(1+n):r+n-r*n;const s=2*r-o,c=[0,0,0];for(let e=0;e<3;e++)a=t+1/3*-(e-1),a<0&&a++,a>1&&a--,i=6*a<1?s+6*(o-s)*a:2*a<1?o:3*a<2?s+(o-s)*(2/3-a)*6:s,c[e]=255*i;return c},a.hsl.hsv=function(e){const t=e[0];let n=e[1]/100,r=e[2]/100,o=n;const a=Math.max(r,.01);return r*=2,n*=r<=1?r:2-r,o*=a<=1?a:2-a,[t,100*(0===r?2*o/(a+o):2*n/(r+n)),(r+n)/2*100]},a.hsv.rgb=function(e){const t=e[0]/60,n=e[1]/100;let r=e[2]/100;const o=Math.floor(t)%6,a=t-Math.floor(t),i=255*r*(1-n),s=255*r*(1-n*a),c=255*r*(1-n*(1-a));switch(r*=255,o){case 0:return[r,c,i];case 1:return[s,r,i];case 2:return[i,r,c];case 3:return[i,s,r];case 4:return[c,i,r];case 5:return[r,i,s]}},a.hsv.hsl=function(e){const t=e[0],n=e[1]/100,r=e[2]/100,o=Math.max(r,.01);let a,i;i=(2-n)*r;const s=(2-n)*o;return a=n*o,a/=s<=1?s:2-s,a=a||0,i/=2,[t,100*a,100*i]},a.hwb.rgb=function(e){const t=e[0]/360;let n=e[1]/100,r=e[2]/100;const o=n+r;let a;o>1&&(n/=o,r/=o);const i=Math.floor(6*t),s=1-r;a=6*t-i,1&i&&(a=1-a);const c=n+a*(s-n);let l,u,d;switch(i){default:case 6:case 0:l=s,u=c,d=n;break;case 1:l=c,u=s,d=n;break;case 2:l=n,u=s,d=c;break;case 3:l=n,u=c,d=s;break;case 4:l=c,u=n,d=s;break;case 5:l=s,u=n,d=c}return[255*l,255*u,255*d]},a.cmyk.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},a.xyz.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100;let o,a,i;return o=3.2406*t+-1.5372*n+-.4986*r,a=-.9689*t+1.8758*n+.0415*r,i=.0557*t+-.204*n+1.057*r,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),i=Math.min(Math.max(0,i),1),[255*o,255*a,255*i]},a.xyz.lab=function(e){let t=e[0],n=e[1],r=e[2];return t/=95.047,n/=100,r/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,[116*n-16,500*(t-n),200*(n-r)]},a.lab.xyz=function(e){let t,n,r;n=(e[0]+16)/116,t=e[1]/500+n,r=n-e[2]/200;const o=n**3,a=t**3,i=r**3;return n=o>.008856?o:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=i>.008856?i:(r-16/116)/7.787,t*=95.047,n*=100,r*=108.883,[t,n,r]},a.lab.lch=function(e){const t=e[0],n=e[1],r=e[2];let o;return o=360*Math.atan2(r,n)/2/Math.PI,o<0&&(o+=360),[t,Math.sqrt(n*n+r*r),o]},a.lch.lab=function(e){const t=e[0],n=e[1],r=e[2]/360*2*Math.PI;return[t,n*Math.cos(r),n*Math.sin(r)]},a.rgb.ansi16=function(e,t=null){const[n,r,o]=e;let i=null===t?a.rgb.hsv(e)[2]:t;if(i=Math.round(i/50),0===i)return 30;let s=30+(Math.round(o/255)<<2|Math.round(r/255)<<1|Math.round(n/255));return 2===i&&(s+=60),s},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){const t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},a.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let n=t[0];3===t[0].length&&(n=n.split("").map(e=>e+e).join(""));const r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,o=Math.max(Math.max(t,n),r),a=Math.min(Math.min(t,n),r),i=o-a;let s,c;return s=i<1?a/(1-i):0,c=i<=0?0:o===t?(n-r)/i%6:o===n?2+(r-t)/i:4+(t-n)/i,c/=6,c%=1,[360*c,100*i,100*s]},a.hsl.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=n<.5?2*t*n:2*t*(1-n);let o=0;return r<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},a.hsv.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=t*n;let o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.hcg.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];const o=[0,0,0],a=t%1*6,i=a%1,s=1-i;let c=0;switch(Math.floor(a)){case 0:o[0]=1,o[1]=i,o[2]=0;break;case 1:o[0]=s,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=i;break;case 3:o[0]=0,o[1]=s,o[2]=1;break;case 4:o[0]=i,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=s}return c=(1-n)*r,[255*(n*o[0]+c),255*(n*o[1]+c),255*(n*o[2]+c)]},a.hcg.hsv=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);let r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){const t=e[1]/100,n=e[2]/100*(1-t)+.5*t;let r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){const t=e[1]/100,n=1-e[2]/100,r=n-t;let o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=function(e){return[0,0,e[0]]},a.gray.hsv=a.gray.hsl,a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},59371:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clickToCall=function(e,t,n){return{type:r.CLICK_TO_CALL,payload:{callId:e,caller:t,callee:n}}},t.clickToCallError=function(e){return{type:r.CLICK_TO_CALL_ERROR,error:!0,payload:{error:e}}},t.clickToCallFinish=function(e){let{callId:t,caller:n,callee:o,requestTime:a}=e;return{type:r.CLICK_TO_CALL_FINISH,error:!1,payload:{callId:t,caller:n,callee:o,requestTime:a}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(18995))},59419:(e,t,n)=>{var r=n(92673)("trimCharsStart",n(90959));r.placeholder=n(22991),e.exports=r},59475:e=>{"use strict";e.exports=function(e,t){var n="function"==typeof Iterator&&Iterator.prototype[e];if(n)try{n.call({next:null},t).next()}catch(e){return!0}}},59534:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAll=function(e){return(0,o.default)(e.clickToCall)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},59756:(e,t,n)=>{var r=n(2478);e.exports=function(e,t){return!(null==e||!e.length)&&r(e,t,0)>-1}},59805:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,TimerTracker:n,SubscriptionRequests:s,SubscriptionOperations:c,emitEvent:l}=e;let u=1;function d(e,t){let r=1e3*t/Math.pow(2,u);const o=a.MINIMUM_EXPIRY_SUBSCRIPTION_INTERVAL/2;r=r>o?r:o;const i=.8*r,s=1.2*r,c=Math.floor(Math.random()*(s-i)+1);n.create("subscription",e,i+c,{id:"resubscribe"})}function f(){n.clearAllById("resubscribe")}return{startResubInterval:async function(){n.getAllById("resubscribe").some(e=>n.isRunning(e.handle))&&f();const e=(0,r.getSubscriptionInfo)(t.getState());e&&e[0]?e.length>0&&d(async function n(){try{await s.resubscribe(e),t.dispatch(o.resubscribeFinished({attemptNum:u})),l(i.SUB_RESUB,{attemptNum:u,isFailure:!1}),u=1,f(),d(n,e[0].expires)}catch(r){if(39===r.code)return f(),void await c.onSubscriptionGone();t.dispatch(o.resubscribeFinished({error:r,attemptNum:u})),l(i.SUB_RESUB,{attemptNum:u,isFailure:!0}),u++,f(),d(n,e[0].expires)}},e[0].expires):f()},stopResubInterval:function(){f()}}},n(81045),n(9925);var r=n(56512),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(49561)),a=n(22191),i=n(34889)},60033:(e,t,n)=>{var r=n(79968),o=n(59756),a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(a,function(n){var r="_."+n[0];t&n[1]&&!o(e,r)&&e.push(r)}),e.sort()}},60088:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e={};return{renderTrack:function(t,n,a){const i=r.logManager.getLogger("Track",t.id);let s;if("string"==typeof n){if(i.info(`Rendering track in element using selector: ${n}`),s=document.querySelector(n),!s)return i.error(`Unable to get container with selector: ${n}.`),!1}else i.info("Rendering track in provided HTMLElement."),s=n;const c=t.getState().kind,l=`${c}-${(0,o.makeSafeForCSS)(t.id)}`;let u=e[t.id];if(u){if(u.containers.indexOf(s)>-1)return i.warn("Failed to render track; already rendered in element."),!1}else u={containers:[],rendererId:l};u.containers.push(s);const d=document.createElement(c);d.id=l,d.style.height="100%",d.style.width="100%";const f=t.getStream();try{d.srcObject=f}catch(e){i.debug("srcObject property not supported; reverting to createObjectURL."),d.src=window.URL.createObjectURL(f)}return d.autoplay="true","video"===c&&(d.muted="true",d.playsInline="true",d.play().catch(e=>{i.debug(`Could not autoplay renderer #${d.id}: ${e.message}`)})),a&&void 0!==d.setSinkId?d.setSinkId(a).then(()=>{i.debug(`Set to use speaker: ${a}.`)}).catch(e=>{i.debug(`Could not set speaker to use ${a}: ${e.message}`)}):a&&void 0===d.setSinkId&&i.info("Failed to set speaker; setSinkId not supported in this browser."),s.appendChild(d),e[t.id]=u,!0},unrenderTrack:function(t,n){const o=r.logManager.getLogger("Track",t),a=e[t];if(!a)return o.info("Failed to unrender track; not rendered anywhere."),!1;let i;if("string"==typeof n){if(o.info(`Unrendering track from element using selector: ${n}`),i=document.querySelector(n),!i)return o.error(`Unable to get container with selector: ${n}.`),!1}else o.info("Unrendering track from provided HTMLElement."),i=n;const s=a.containers.findIndex(e=>e===i);if(-1===s)return o.info("Failed to unrender track; not rendered in element."),!1;const c=i.querySelector(`#${a.rendererId}`);return c.srcObject?c.srcObject=null:c.src&&(c.src=null),i.removeChild(c),a.containers.splice(s,1),0===a.containers.length&&delete e[t],!0}}},n(69375),n(61412),n(91883),n(70286);var r=n(40271),o=n(76555)},60142:e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},60431:()=>{},60437:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_FINISH=t.UPDATE=t.UNSUBSCRIBE_FINISH=t.UNSUBSCRIBE=t.SUBSCRIBE_FINISH=t.SUBSCRIBE=t.RECEIVED=t.GET_PRESENCE_LIST=t.GET_FINISH=t.GET=t.DELETE_PRESENCE_LIST=t.CREATE_PRESENCE_LIST_FINISH=t.CREATE_PRESENCE_LIST=void 0;const n="@@KANDY/PRESENCE/";t.UPDATE=n+"UPDATE",t.UPDATE_FINISH=n+"UPDATE_FINISH",t.GET=n+"GET",t.GET_FINISH=n+"GET_FINISH",t.SUBSCRIBE=n+"SUBSCRIBE",t.SUBSCRIBE_FINISH=n+"SUBSCRIBE_FINISH",t.UNSUBSCRIBE=n+"UNSUBSCRIBE",t.UNSUBSCRIBE_FINISH=n+"UNSUBSCRIBE_FINISH",t.RECEIVED=n+"RECEIVED",t.CREATE_PRESENCE_LIST=n+"CREATE_PRESENCE_LIST",t.CREATE_PRESENCE_LIST_FINISH=n+"CREATE_PRESENCE_LIST_FINISH",t.DELETE_PRESENCE_LIST=n+"DELETE_PRESENCE_LIST",t.GET_PRESENCE_LIST=n+"GET_PRESENCE_LIST"},60441:(e,t,n)=>{var r=n(87379),o=n(80547),a=n(48360);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!a(e)}},60508:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,SubscriptionRequests:i,Connectivity:s}=e,c=n.getLogger("SUBSCRIPTION");return async function(e){c.info("Unsubscribing from existing subscription:",e),e||(e=(0,r.getSubscriptionInfo)(t.getState())),e=e[0];const n=(0,o.getConnectionInfo)(t.getState());e&&n&&(await i.unsubscribe(e.url),(0,a.getConnectionState)(t.getState()).connected&&s.disconnect())}};var r=n(56512),o=n(87075),a=n(94482)},60530:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,sendRequest:r}=e,s=n.getLogger("NOTIFICATIONS");return{pushNotificationsRegistration:async function(e){let{services:n,pushProvider:c,bundleId:l,deviceToken:u,voipDeviceToken:d,standardDeviceToken:f,clientCorrelator:p,realm:g,isProduction:_}=e;const E="POST";c=c.toLowerCase();const{pushRegistration:y}=(0,o.getNotificationConfig)(t.getState());let S,v;if(y){const e=(0,a.getConnectionInfo)(t.getState),n=e.server;S=`${n.protocol}://${n.server}:${n.port}/rest/version/${n.version}/user/${e.username}/push/`+c+"/devices/",s.debug(`Sending PUSH register request: ${E} ${S}`)}else v=`push/${c}/devices/`,s.debug(`Sending PUSH register request: ${E} ${v}`);let h={bundleID:l,service:n,clientCorrelator:p,realm:g,isProduction:_};"apple"===c?(h.voipDeviceToken=d,h.standardDeviceToken=f):h.deviceToken=u,h=JSON.stringify(h);const T=await r({endpoint:v,url:S,method:E,body:h}),{body:C,error:I,result:m}=T;let O;const A=c+"DeviceRegistrationResponse";if(C&&C[A]&&(O=C[A]),I){if(s.info("Failed to register device token for PUSH notifications."),O){const e=O.statusCode;throw s.debug(`Device registration request for PUSH notifications failed with status code: ${e}`),new i.default({code:e,message:`Failed to register device token for PUSH notifications. Code: ${e}`})}{const{message:e}=m;throw s.debug(`Device registration request for PUSH notifications failed with message: ${e}.`),new i.default({code:m.code,message:`Failed to register device token for PUSH notifications. Error: ${m.message}`})}}if(O&&0!==O.statusCode)throw s.info(`Failed to register device token for PUSH notifications. Code: ${O.statuscode}`),new i.default({code:O.statusCode,message:`Failed to register device token for PUSH notifications. Error: ${O.statusCode}`});return s.info("Successfully registered device token for PUSH notifications."),{error:!1,...O}},pushNotificationsDeRegistration:async function(e,t){let{registration:n}=t;const{server:o}=e,a=`${o.protocol}://${o.server}:${o.port}${n}`,c="DELETE";s.debug(`Sending PUSH unregister request: ${c} ${a}`);const l=await r({url:a,method:c,responseType:"none"});if(l.error){if(s.info("Failed to unregister device token for PUSH notifications."),l.payload.body){const{statusCode:e}=l.payload.body;throw s.debug(`Failed to unregister device token for PUSH notifications. Status code: ${e}.`),new i.default({code:e,message:`Failed to unregister device token for PUSH notifications. Code: ${e}.`})}{const{message:e}=l.payload.result;throw s.debug(`Device token unregistration request failed for PUSH notifications: ${e}`),new i.default({code:l.payload.result.code,message:`Device token unregistration request failed for PUSH notifications: ${e}`})}}return s.info("Successfully unregistered device token for PUSH notifications."),{error:!1}}}};var r,o=n(82803),a=n(87075),i=(r=n(75412))&&r.__esModule?r:{default:r}},60986:(e,t,n)=>{var r=n(87379),o=n(80547);e.exports=function(e){return"number"==typeof e||o(e)&&"[object Number]"==r(e)}},61274:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},61397:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:(t,n)=>async function(e,t,n){const{CallReporter:u,Callstack:d,context:f,emitEvent:p,logManager:g}=e,{setupOutgoingSession:_}=d.utils,E=t[0].id,y=t[1].id,S=t[2].id,v=g.getLogger("CALL",E);v.info(`Performing join on calls ${E} and ${y}.`);const h=(0,s.getCallById)(f.getState(),E),T=(0,s.getCallById)(f.getState(),y),C=h.remoteParticipant.displayName,I=T.remoteParticipant.displayName;let m;C&&I?m=`${C},${I}`:C?m=`${C},`:I&&(m=`,${I}`);const O=`${h.direction===r.CALL_DIRECTION.OUTGOING?h.to:h.from},${T.direction===r.CALL_DIRECTION.OUTGOING?T.to:T.from}`,A={video:!1,audio:h.mediaConstraints&&h.mediaConstraints.audio||!0},R=(0,a.checkBandwidthControls)(h.bandwidth),b=h.dscpControls,N=(0,s.getTurnInfo)(f.getState()),{trickleIceMode:M,defaultPeerConfig:w,removeBundling:P,serverTurnCredentials:L}=(0,s.getOptions)(f.getState()),D=u.getReport(S).findLastOngoingEvent(l.REPORTER_OPERATION_EVENTS_MAP.JOIN),k=h.currentOperations.find(e=>e.type===c.OPERATIONS.JOIN);let j;f.dispatch(o.callActions.joinStart(S,{mediaConstraints:A,participantAddress:O,participantName:m,from:n,usedCallIds:[h.id,T.id],customParameters:h.customParameters,dscpControls:b,bandwidth:R,eventId:D.id,operationId:k.id}));try{j=await _(A,{defaultPeerConfig:w,turnInfo:N,trickleIceMode:M,dscpControls:b,removeBundling:P,bandwidth:R,callId:S,serverTurnCredentials:L})}catch(e){throw v.info(`Failed to initiate call. Changing to ${r.CALL_STATES.ENDED}.`),f.dispatch(o.callActions.joinFinish(S,{usedCallIds:[h.id,T.id],error:e})),p(i.CALL_STATE_CHANGE,{callId:S,previous:{state:r.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1},error:e}),p(i.CALL_OPERATION,{callId:S,isLocal:!0,operation:c.OPERATIONS.JOIN,transition:c.OP_TRANSITIONS.FINISH,previous:void 0,error:e}),e}return{webrtcInfo:j}}(e,t,n),signalling:(t,n)=>async function(e,t,n){const{CallRequests:a,CallstackWebrtc:l,context:d,emitEvent:f,logManager:p}=e,{webrtcInfo:g}=n,_=t[0].id,E=t[1].id,y=t[2].id,S=p.getLogger("CALL",_),v=(0,s.getCallById)(d.getState(),_),h=(0,s.getCallById)(d.getState(),E),{offerSdp:T,sessionId:C,mediaIds:I}=g,m={id:_,wrtcsSessionId:v.wrtcsSessionId,otherWrtcsSessionId:h.wrtcsSessionId,sdp:T,customParameters:v.customParameters};let O;try{O=await a.joinSessions(m)}catch(e){throw S.info("Failed to join call."),d.dispatch(o.callActions.joinFinish(y,{error:e,usedCallIds:[_,E]})),f(i.CALL_STATE_CHANGE,{callId:y,previous:{state:r.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1},error:e}),f(i.CALL_OPERATION,{callId:y,isLocal:!0,operation:c.OPERATIONS.JOIN,transition:c.OP_TRANSITIONS.FINISH,previous:void 0,error:e}),await l.closeCall(C),e}S.info("Finished local portion of join. Waiting on remote response.");const A=(0,u.getSessionById)(d.getState(),C);d.dispatch(o.callActions.pendingJoin(y,{wrtcsSessionId:O,webrtcSessionId:C,mediaIds:I,usedCallIds:[v.id,h.id],localTracks:A.localTracks,state:r.CALL_STATES.INITIATED})),f(i.CALL_JOIN,{callId:y}),f(i.CALL_TRACKS_ADDED,{callId:y,trackIds:A.localTracks})}(e,t,n)}},n(81045),n(45950);var r=n(77126),o=n(35),a=n(69752),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),s=n(40481),c=n(59090),l=n(84581),u=n(69260)},61412:(e,t,n)=>{"use strict";var r=n(97509),o=n(16881),a=n(92618),i=n(89445),s=URLSearchParams,c=s.prototype,l=o(c.append),u=o(c.delete),d=o(c.forEach),f=o([].push),p=new s("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&r(c,"delete",function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return u(this,e);var r=[];d(this,function(e,t){f(r,{key:t,value:e})}),i(t,1);for(var o,s=a(e),c=a(n),p=0,g=0,_=!1,E=r.length;p<E;)o=r[p++],_||o.key===s?(_=!0,u(this,o.key)):g++;for(;g<E;)(o=r[g++]).key===s&&o.value===c||l(this,o.key,o.value)},{enumerable:!0,unsafe:!0})},61727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const i=(0,o.getCallById)(e,t[0].id),s=(0,o.getCallById)(e,t[1].id);return i&&s?i.state!==r.CALL_STATES.ON_HOLD?new a.default({code:a.callCodes.INVALID_STATE,message:`Call is in an invalid state: state=${i.state}. It should be: state=${r.CALL_STATES.ON_HOLD}.`}):s.state!==r.CALL_STATES.ON_HOLD?new a.default({code:a.callCodes.INVALID_STATE,message:`Call is in an invalid state: state=${s.state}. It should be: state=${r.CALL_STATES.ON_HOLD}.`}):void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(77126),o=n(40481),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},61869:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:t=>i(e,t),signalling:t=>s(e,t)}},t.localChanges=i,t.signalling=s;var r=n(40481),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(77126);async function i(e,t){const{context:n,CallstackWebrtc:o,logManager:a}=e,i=a.getLogger("CALL",t);i.info("Ending call.");const s=(0,r.getCallById)(n.getState(),t);o.closeCall(s.webrtcSessionId).catch(e=>{i.warn(`Could not successfully complete closing webrtc call: ${e}`)})}async function s(e,t){const{context:n,CallRequests:i,logManager:s,emitEvent:c}=e,l=(0,r.getCallById)(n.getState(),t),u=s.getLogger("CALL",l.id),{wrtcsSessionId:d,isAnonymous:f,account:p}=l;try{await i.endSession({callId:t,wrtcsSessionId:d,isAnonymous:f,account:p})}catch(e){}finally{u.info(`Finished ending call. Changing to ${a.CALL_STATES.ENDED}.`),c(o.CALL_TRACKS_REMOVED,{callId:t,trackIds:[...l.localTracks,...l.remoteTracks]})}}},62049:(e,t,n)=>{var r=n(97034),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},62168:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallReporter:u,CallstackSDP:d,WebRTC:f}=e;return async function(p,g){const _=n.getLogger("CALL",g.callId);let E;_.info("Setting up local WebRTC portions of call.");try{let e=g.defaultPeerConfig.iceServers;g.turnInfo&&(e=e.map(e=>({...e,username:g.turnInfo.username,credential:g.turnInfo.password}))),E=await f.sessionManager.create({peer:{rtcConfig:{...g.defaultPeerConfig,iceServers:e},trickleIceMode:g.trickleIceMode,removeBundling:g.removeBundling}}),_.debug("Created WebRTC Session for Call.",{webrtcSessionId:E.id})}catch(e){throw _.debug("Failed to create WebRTC Session for Call.",e.message),new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR})}const y=(0,o.getCallById)(t.getState(),g.callId),S=u.getReport(y.id),v=y.currentOperations.find(e=>e.isLocal&&e.status===a.OP_STATUS.ONGOING),h=S.getEvent(v.eventId);let T=[];if(p.medias)for(const e of p.medias)T.push({type:e.type,media:await f.media.get(e.media.id)});if(p.audio||p.video||p.screen)try{const t=await e.CallstackWebrtc.createLocal(p,g.callId);T=T.concat(t)}catch(e){_.debug("Failed to get media requested for the call. Cleaning up created session.");try{await E.end()}catch(e){_.debug("Failed to end WebRTC Session after media failure: ",e.message)}throw e}t.dispatch(r.callActions.sessionCreated(g.callId,{webrtcSessionId:E.id}));const C=await(0,i.organizeTracks)(T),I=(0,s.getTrackDscpMapping)(C,g.dscpControls);try{await E.addTracks(C.all,I)}catch(e){throw e}const m=(0,o.getOptions)(t.getState());let O,A,R,b;try{b=h.addEvent(l.REPORT_EVENTS.CREATE_OFFER),A=await E.createOffer(),b.endEvent()}catch(e){_.debug("Failed to create local SDP offer.",e.message);const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw b.endEvent(t),t}try{A.sdp=d.runPipeline(m.sdpHandlers,A.sdp,{callId:g.callId,type:A.type,step:"set",endpoint:"local",bandwidth:g.bandwidth}),R=h.addEvent(l.REPORT_EVENTS.PROCESS_MEDIA_LOCAL),R.addData("operation",v.type),A=await E.setLocalDescription(A),R.endEvent(),O=d.runPipeline(m.sdpHandlers,A.sdp,{callId:g.callId,type:A.type,step:"send",endpoint:"local",bandwidth:g.bandwidth})}catch(e){_.debug("Failed to set local SDP.",e.message);const t=new c.default({message:e.message,code:c.callCodes.GENERIC_ERROR});throw R.endEvent(t),t}return _.info("Finished setting up local WebRTC portions of call."),{offerSdp:O,sessionId:E.id,mediaIds:T.map(e=>e.media.id)}}},n(69375),n(81045),n(45950),n(84915);var r=n(35),o=n(40481),a=n(59090),i=n(56294),s=n(69752),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),l=n(84581)},62234:(e,t,n)=>{"use strict";var r=n(5613),o=n(81458).includes,a=n(5234),i=n(95458);r({target:"Array",proto:!0,forced:a(function(){return!Array(1).includes()})},{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},62318:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USERS_ERROR=t.USERS_CHANGE=t.DIRECTORY_ERROR=t.DIRECTORY_CHANGE=t.CONTACTS_NEW=t.CONTACTS_ERROR=t.CONTACTS_CHANGE=void 0,t.CONTACTS_NEW="contacts:new",t.CONTACTS_ERROR="contacts:error",t.CONTACTS_CHANGE="contacts:change",t.DIRECTORY_CHANGE="directory:change",t.DIRECTORY_ERROR="directory:error",t.USERS_CHANGE="users:change",t.USERS_ERROR="users:error"},62350:(e,t,n)=>{"use strict";var r=n(39944),o=n(44977),a=n(3770),i=n(13174),s=n(69874),c=TypeError;e.exports=function(e,t){var n=arguments.length<2?s(e):t;if(o(n))return a(r(n,e));throw new c(i(e)+" is not iterable")}},62527:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(t){try{const{userInfo:n,connection:l}=function(e,t){let{username:n,password:r,authname:l,hmacToken:u,bearerAccessToken:d,anonUsername:f,realm:p}=t;const{logManager:g,context:_}=e,E=g.getLogger("AUTH"),{username:y}=(0,o.getUserInfo)(_.getState()),S=(0,a.getSubscribedServices)(_.getState());if(y!==n&&S.length>0)throw new i.default({message:"Cannot change credentials while previous user has an active subscription.",code:i.authCodes.INVALID_STATE});const v=[r,u,d].filter(e=>Boolean(e)).length;if(n&&v>=2)throw new i.default({message:"Multiple methods of authentication detected. Use only one authorization method: Basic authorization (using a password) or Bearer authorization or HMAC authorization.",code:i.authCodes.INVALID_CREDENTIALS});const h={headers:{"Content-Type":"application/json",Accept:"application/json"},...p&&{queryParams:{tokenrealm:p}}};if(n&&u)E.info("Setting the info for hmacToken scenario."),h.headers["x-token"]=u;else if(l&&r)E.info("Setting the info for authname/password scenario."),h.headers.Authorization="Basic "+s.default.encode(c.default.encode(l+":"+r));else if(n&&d)E.info("Setting the info for bearerAccessToken/username scenario."),h.headers.Authorization=`Bearer ${d}`;else if(n&&r)E.info("Setting the info for username/password scenario."),h.headers.Authorization="Basic "+s.default.encode(c.default.encode(n+":"+r));else if(!n||!f)throw E.info("Unexpected credentials scenario."),new i.default({message:"This credentials signature is not valid.",code:i.authCodes.INVALID_CREDENTIALS});return{userInfo:{username:f||n,isAnonymous:!!f},connection:{username:n,userId:n,userType:f?"anonymous":"user",bearerAccessToken:d,requestOptions:h}}}(e,t);e.context.dispatch(r.setCredentialsFinished(n,l))}catch(t){throw e.context.dispatch(r.setCredentialsError(t)),t}}};var r=u(n(44130)),o=n(87075),a=n(56512),i=u(n(75412)),s=l(n(86125)),c=l(n(82094));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},62694:(e,t,n)=>{"use strict";var r=n(1942),o=n(79117),a=n(14798),i="__core-js_shared__",s=e.exports=o[i]||a(i,{});(s.versions||(s.versions=[])).push({version:"3.45.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"})},62918:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,a.default)(i,e);return(0,o.parse)("authentication",s)(n),n.server.base||t.error("No server configuration provided. Please provide proper authentication configurations."),n};var r,o=n(52932),a=(r=n(7485))&&r.__esModule?r:{default:r};const i={server:{protocol:"https",base:null,port:443,version:"1"}},s=o.validation.schema({server:o.validation.schema({protocol:(0,o.enums)(["http","https"]),base:o.validation.string(),port:o.validation.positive(),version:(0,o.enums)(["1"])})})},62945:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},63008:(e,t,n)=>{"use strict";var r,o,a=n(79117),i=n(98060),s=a.process,c=a.Deno,l=s&&s.versions||c&&c.version,u=l&&l.v8;u&&(o=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!o&&i&&(!(r=i.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=i.match(/Chrome\/(\d+)/))&&(o=+r[1]),e.exports=o},63344:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,r=t.getLogger("CALLHISTORY");return async function(e){let t;t="all"===e?"logHistory":`logRecord/${e}`;const i={method:"DELETE",endpoint:t,responseType:"none"},s={4:a.callHistoryCodes.NOT_AUTHENTICATED,27:a.callHistoryCodes.FORBIDDEN,35:a.callHistoryCodes.FORBIDDEN,42:a.callHistoryCodes.NOT_FOUND},c=await n(i),{body:l,error:u,result:d}=c;if(!u)return void r.info("Call log(s) removed successfully.");let f="",p="";if((0,o.default)(l)){const{code:e,message:t}=d;p=`Failed to remove log(s) from call history. ${t}`,f=403===e?a.callHistoryCodes.FORBIDDEN:a.callHistoryCodes.UNKNOWN_ERROR}else{const{statusCode:e}=l.logRecord;p=`Failed to remove log(s) from call history. Status Code ${e}`,f=s[e]||a.callHistoryCodes.UNKNOWN_ERROR}throw r.info(p),new a.default({code:f,message:p})}};var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},63361:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t){await o(e,t)}},t.signalling=o;var r=n(40481);async function o(e,t){const{context:n,CallRequests:o,logManager:a}=e,i=a.getLogger("CALL",t);i.info("Sending custom parameters for call.");const s=(0,r.getCallById)(n.getState(),t),{wrtcsSessionId:c,isAnonymous:l,account:u,customParameters:d}=s,f={wrtcsSessionId:c,isAnonymous:l,account:u,customParameters:d,id:t};try{await o.updateCustomParameters(f),i.info("Finished sending custom parameters.")}catch(e){throw i.info("Failed to send custom parameters."),e}}},63410:(e,t,n)=>{var r=n(57553),o=n(528),a=n(84354);e.exports=function(e){if(e instanceof r)return e.clone();var t=new o(e.__wrapped__,e.__chain__);return t.__actions__=a(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},63521:(e,t,n)=>{var r=n(51187);e.exports=function(e,t){if(e!==t){var n=void 0!==e,o=null===e,a=e==e,i=r(e),s=void 0!==t,c=null===t,l=t==t,u=r(t);if(!c&&!u&&!i&&e>t||i&&s&&l&&!c&&!u||o&&s&&l||!n&&l||!a)return 1;if(!o&&!i&&!u&&e<t||u&&n&&a&&!o&&!i||c&&n&&a||!s&&a||!l)return-1}return 0}},63604:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,Callstack:n,CallRequests:c,CallstackWebrtc:u,emitEvent:d}=e.container;return async function(f){if(!l(f))return;if(!(0,i.getOptions)(e.getState()).resyncOnConnect)return;const p=(0,i.getCalls)(e.getState()).filter(e=>e.state!==s.CALL_STATES.CANCELLED&&e.state!==s.CALL_STATES.ENDED);function g(e){return 0===e.currentOperations.length}for(const l of p){const f=t.getLogger("CALL",l.id),p=l.state;if(g(l))try{const t=await c.getSession({wrtcsSessionId:l.wrtcsSessionId,id:l.id}),r=(0,i.getCallById)(e.getState(),l.id);g(r)&&(r.state!==s.CALL_STATES.RINGING&&p===s.CALL_STATES.RINGING||await n.operations.resyncCallState.local(l.id,t))}catch(t){const n=(0,i.getCallById)(e.getState(),l.id);g(n)&&(n.state!==s.CALL_STATES.RINGING&&p===s.CALL_STATES.RINGING||(47===t.code?(await u.closeCall(l.webrtcSessionId),f.info(`Call re-sync found that call is ended. Changing to ${s.CALL_STATES.ENDED}.`),e.dispatch(r.callActions.endCallFinish(l.id,{isLocal:!0,error:t})),d(o.CALL_OPERATION,{callId:l.id,isLocal:!0,operation:a.OPERATIONS.END,transition:a.OP_TRANSITIONS.FINISH,previous:{},error:t}),d(o.CALL_TRACKS_REMOVED,{callId:l.id,trackIds:[...l.localTracks,...l.remoteTracks]}),d(o.CALL_STATE_CHANGE,{callId:l.id,previous:{state:l.state,localHold:l.localHold,remoteHold:l.remoteHold},error:t})):f.debug(`Call re-sync failure (${t.code}).`,t)))}}}},t.shouldHandlePattern=l,n(81045),n(30163);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090),i=n(40481),s=n(77126),c=n(9719);function l(e){return e.type===c.WS_CONNECT_FINISHED}},63657:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("SubscriptionRequests.unsubscribe",t=>(0,r.default)(e.container)),e.factory("SubscriptionOperations.unsubscribe",t=>(0,o.default)(e.container))};var r=a(n(27388)),o=a(n(60508));function a(e){return e&&e.__esModule?e:{default:e}}},63702:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="authentication";return t=(0,a.default)(t,e.container.logManager.getLogger("AUTH")),e.defer(function(e){e.context.dispatch((0,s.update)(t,n))}),e.factory("AuthenticationOperations.setCredentials",()=>i.setCredentials(e.container)),{api:o.createAPI,capabilities:["auth","userCredentialsAuth","hmacTokenAuth","bearerAccessTokenAuth"],name:n,reducer:o.reducer}};var r,o=n(57761),a=(r=n(62918))&&r.__esModule?r:{default:r},i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(50805)),s=n(87310)},63858:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.utils.getRemoteOperationInfo",()=>(0,r.default)(e.container)),e.factory("Callstack.utils.createEarlyPeer",()=>(0,o.default)(e.container))};var r=a(n(17918)),o=a(n(9077));function a(e){return e&&e.__esModule?e:{default:e}}},63934:()=>{},64025:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallHistoryOperations:n,logManager:r,API_LOG_TAG:l,emitEvent:u}=e,d=r.getLogger("CALLHISTORY");return{call:{history:{get:()=>(d.debug(`${l}call.history.get`),(0,i.getCallHistory)(t.getState())),async fetch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(d.debug(`${l}call.history.fetch, amount: ${e}, offset: ${r}`),t.dispatch(a.retrieveCallLogs(e,r)),!(0,o.default)(e)||e<0||!(0,o.default)(r)){d.info("Unable to retrieve log(s); invalid input.");const e=new c.default({code:c.callHistoryCodes.BAD_REQUEST,message:"Unable to retrieve log(s); invalid input."});return t.dispatch(a.retrieveCallLogsFinish({error:e})),void u(s.CALL_HISTORY_ERROR,{validationError:e})}try{await n.fetch(e,r)}catch(e){return d.info(`call.history.fetch error: ${e.message}`),void u(s.CALL_HISTORY_ERROR,{error:e})}u(s.CALL_HISTORY_CHANGE,{}),u(s.CALL_HISTORY_CACHE_CHANGE,{})},async remove(e){if(d.debug(`${l}call.history.remove, recordId: ${e}`),t.dispatch(a.removeCallLogs(e)),!e){d.info("Could not remove call logs from history; invalid input.");const e=new c.default({code:c.callHistoryCodes.BAD_REQUEST,message:"Could not remove call logs; invalid input."});return void t.dispatch(a.removeCallLogsFinish({error:e}))}try{await n.removeCallLogs(e)}catch(e){return d.info(`call.history.remove error: ${e.message}`),void u(s.CALL_HISTORY_ERROR,{error:e})}u(s.CALL_HISTORY_CHANGE,{}),u(s.CALL_HISTORY_CACHE_CHANGE,{})},async clear(){d.debug(`${l}call.history.clear`),t.dispatch(a.removeCallLogs("all"));try{await n.removeCallLogs("all")}catch(e){return d.info(`call.history.clear error: ${e.message}`),void u(s.CALL_HISTORY_ERROR,{error:e})}u(s.CALL_HISTORY_CHANGE,{}),u(s.CALL_HISTORY_CACHE_CHANGE,{})},getCache:()=>(d.debug(`${l}call.history.getCache`),JSON.stringify((0,i.getCachedHistory)(t.getState()))),setCache(e){let t;d.debug(`${l}call.history.setCache, data: ${e}`);try{if("string"!=typeof e)throw new Error("data is not a valid string");t=JSON.parse(e)}catch(e){throw d.info(`Invalid data provided: ${e}`),e}n.setCache(t),u(s.CALL_HISTORY_CHANGE,{}),u(s.CALL_HISTORY_CACHE_CHANGE,{})}}}}},n(97107);var r,o=(r=n(17174))&&r.__esModule?r:{default:r},a=l(n(31122)),i=n(33907),s=l(n(91708)),c=l(n(75412));function l(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},64066:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},64103:(e,t,n)=>{var r=n(1386);e.exports=function(){this.__data__=new r,this.size=0}},64181:(e,t,n)=>{var r=n(92673)("isNull",n(49310),n(76648));r.placeholder=n(22991),e.exports=r},64207:(e,t,n)=>{var r=n(39032),o=n(25288);e.exports=function(e){return r(e,o(e))}},64364:(e,t,n)=>{var r=n(39747),o=n(41580);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),a=e.apply(n,t);return o(a)?a:n}}},64400:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},n={[c]:{handler:e.handler?(0,i.checkHandler)(e.handler):o.default,level:e.level?(0,i.checkLevel)(e.level):a.logLevels.INFO}};function s(e){return n[e=e||c]&&n[e].level||n[c].level}function l(e){return n[e=e||c]&&n[e].handler||n[c].handler}return{getLogger:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n=String(n);const o=n?`${e}-${n}`:e;let a=t[o];if(!a){const i={type:e,id:n,name:o},c={level:s(e),handler:l(e)};a=(0,r.default)(i,c),t[o]=a}return a},getLoggers:function(e){return e?Object.values(t).filter(t=>t.type===e):Object.values(t)},setLevel:function(e,t){void 0===t&&(t=e,e=c),n[e]||(n[e]={}),n[e].level=(0,i.checkLevel)(t)},getLevel:s,setHandler:function(e,t){"function"==typeof e&&void 0===t&&(t=e,e=c),n[e]||(n[e]={}),n[e].handler=(0,i.checkHandler)(t)},getHandler:l}},n(81045),n(30163);var r=s(n(16469)),o=s(n(92807)),a=n(75188),i=n(87398);function s(e){return e&&e.__esModule?e:{default:e}}const c=Symbol("Default")},64466:(e,t,n)=>{"use strict";var r=n(96893),o=n(39622),a=n(23315),i=n(3770),s=n(42344),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",f="configurable",p="writable";t.f=r?a?function(e,t,n){if(i(e),t=s(t),i(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=u(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:f in n?n[f]:r[f],enumerable:d in n?n[d]:r[d],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(i(e),t=s(t),i(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},64512:(e,t,n)=>{var r=n(94715)(n(78942),"Set");e.exports=r},64584:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,Connectivity:n,SubscriptionOperations:a,logManager:i,API_LOG_TAG:s}=e,c=i.getLogger("CONNECTIVITY");return{connection:{getSocketState:()=>(c.debug(s+"connection.getSocketState"),(0,o.getConnectionState)(t.getState())),enableConnectivityChecking(e){c.debug(s+"connection.enableConnectivityChecking: ",e),t.dispatch((0,r.changeConnectivityChecking)(e)),n.setPinging(e)},resetConnection(){c.debug(s+"connection.resetConnection");const e=(0,o.getConnectionState)(t.getState());if(!e.connected)return void c.debug(s+"connection.resetConnection: No active websocket connection. Ignoring request.");n.disconnect();const i=(0,o.getConnectivityConfig)(t.getState()).autoReconnect;c.info(`Websocket disconnected. (autoReconnect?: ${i})`),i?n.connect(e.wsInfo,!0).catch(()=>{t.dispatch((0,r.wsReconnectFailed)()),a.onConnectionLost()}):(t.dispatch((0,r.wsReconnectFailed)()),a.onConnectionLost())}}}};var r=n(47183),o=n(94482)},64759:(e,t,n)=>{var r,o=n(41950),a=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!a&&a in e}},64858:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=e.getLogger("SDP"),r=[];return t.media.forEach((e,o)=>{const a=e.mid,i=o;e.ssrcGroups&&e.ssrcGroups.length>1&&n.debug(`Media section contains multiple ssrc groups. Summary for ${a} will be wrong.`);const s=e.direction||t.direction;let c,l,u,d;s?(c=s.includes("send"),l=s.includes("recv")):(c=!0,l=!0),c?e.msid?[u,d]=e.msid.split(" "):e.ssrcs&&(u=e.ssrcs.find(e=>"mslabel"===e.attribute).value,d=e.ssrcs.find(e=>"label"===e.attribute).value):(u=void 0,d=void 0);const f={sectionId:a,sectionIndex:i,type:e.type,willSend:c,willReceive:l,mediaId:u,trackId:d};r.push(f)}),r},n(62234),n(69375),n(81045),n(45950),n(5350)},64871:(e,t,n)=>{var r=n(11129),o=n(90313),a=n(84354),i=n(53142);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],s=e;s--;)t[s-1]=arguments[s];return r(i(n)?a(n):[n],o(t,1))}},65077:(e,t,n)=>{"use strict";var r=n(42937),o=n(33243).add,a=n(679),i=n(55558),s=n(37032);e.exports=function(e){var t=r(this),n=i(e).getIterator(),c=a(t);return s(n,function(e){o(c,e)}),c}},65079:(e,t,n)=>{var r=n(3334),o=n(16653);e.exports=function(e,t){var n=[];if(!e||!e.length)return n;var a=-1,i=[],s=e.length;for(t=r(t,3);++a<s;){var c=e[a];t(c,a,e)&&(n.push(c),i.push(a))}return o(e,i),n}},65111:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},65187:(e,t,n)=>{var r=n(53142),o=n(51187),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||i.test(e)||!a.test(e)||null!=t&&e in Object(t)}},65196:(e,t,n)=>{var r=n(46065),o=n(79071),a=r?function(e){return r.get(e)}:o;e.exports=a},65275:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e="API invoked: ",t={};return{createReport:function(n,a){if(!n||!(0,r.default)(n))throw new Error(`${e}reporter.createReport: Invalid type (${typeof n}), must be of type string.`);if(!a||!(0,r.default)(a))throw new Error(`${e}reporter.createReport: Invalid id (${typeof a}), must be of type string.`);if(t.hasOwnProperty(a))throw new Error(`${e}reporter.createReport: Cannot create report. One already exists for id: ${a}`);const i=(0,o.default)(n,a);return t[a]=i,i},getReport:function(e){return t[e]},deleteReport:function(n){if(!n||!(0,r.default)(n))throw new Error(`${e}reporter.deleteReport: Invalid id ${typeof n} (must be of type string).`);delete t[n]}}},n(97107);var r=a(n(73173)),o=a(n(38724));function a(e){return e&&e.__esModule?e:{default:e}}},65387:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},65406:(e,t,n)=>{var r=n(36529),o=n(80547);e.exports=function(e){return o(e)&&r(e)}},65438:(e,t,n)=>{"use strict";var r=n(79345),o=n(14188),a=n(38689),i=n(4282)("toStringTag"),s=Object,c="Arguments"===a(function(){return arguments}());e.exports=r?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=s(e),i))?n:c?a(t):"Object"===(r=a(t))&&o(t.callee)?"Arguments":r}},65512:(e,t,n)=>{var r=n(4943),o=n(3316)(r);e.exports=o},65568:e=>{e.exports=function(e,t){return e.has(t)}},65650:(e,t,n)=>{var r=n(78942).Symbol;e.exports=r},65891:(e,t,n)=>{var r=n(92673)("unset",n(73450));r.placeholder=n(22991),e.exports=r},65926:(e,t,n)=>{"use strict";var r=n(79117),o=n(80831),a=r.document,i=o(a)&&o(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},65939:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t);return n?!0!==n.localHold?new o.default({code:o.callCodes.INVALID_STATE,message:"Call is in an invalid state: localHold=false. It should be: localHold=true."}):void 0:new o.default({code:o.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(40481),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},66040:(e,t,n)=>{var r=n(51187);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},66209:(e,t,n)=>{"use strict";var r=n(16881),o=0,a=Math.random(),i=r(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+i(++o+a,36)}},66342:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,context:n,logManager:r,API_LOG_TAG:d,emitEvent:f}=e,p=r.getLogger("CALL");async function g(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r||p.debug(d+"call.holdAsync: ",e),n.dispatch(a.callActions.holdCall(e));const o=(0,s.getCallById)(n.getState(),e);let l;try{await t.hold(e)}catch(t){l=t,n.dispatch(a.callActions.holdCallFinish(e,{local:!0,error:l}))}if(l){const t=(0,s.getCallById)(n.getState(),e);throw r||t?.state!==c.CALL_STATES.ENDED||o.state===c.CALL_STATES.ENDED||f(i.CALL_STATE_CHANGE,{callId:e,previous:{state:o.state,localHold:o.localHold,remoteHold:o.remoteHold}}),l}}async function _(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r||p.debug(d+"call.unhold: ",e),n.dispatch(a.callActions.unholdCall(e));const o=(0,s.getCallById)(n.getState(),e);let l;try{await t.unhold(e)}catch(t){l=t,n.dispatch(a.callActions.unholdCallFinish(e,{local:!0,error:l}))}if(l){const t=(0,s.getCallById)(n.getState(),e);throw r||t.state!==c.CALL_STATES.ENDED||o.state===c.CALL_STATES.ENDED||f(i.CALL_STATE_CHANGE,{callId:e,previous:{state:o.state,localHold:o.localHold,remoteHold:o.remoteHold}}),l}}async function E(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};arguments.length>3&&void 0!==arguments[3]&&arguments[3]||p.debug(d+"call.startVideoAsync: ",e,i);const s={audio:!1,video:!!(0,o.default)(r)||r,screen:!1},c=a.callActions.addBasicMedia(e,{mediaConstraints:s,kind:"video",...i});n.dispatch(c);try{const{affectedLocalTracks:n,mediaIds:r}=await t.addBasicMedia(e,s,i);return{tracks:n,mediaId:r}}catch(t){throw n.dispatch(a.callActions.addMediaFinish(e,{local:!0,error:t})),t}}async function y(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||p.debug(d+"call.stopVideoAsync: ",e),n.dispatch(a.callActions.removeBasicMedia(e,{kind:"video"}));const r=(0,u.getLocalTracks)(n,e,"video").map(e=>e.trackId);try{await t.removeBasicMedia(e,r)}catch(t){throw n.dispatch(a.callActions.removeMediaFinish(e,{local:!0,error:t})),t}}async function S(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||p.debug(`${d}call.restartMediaAsync:`,e),n.dispatch(a.callActions.restartMedia(e));try{await t.iceRestart(e)}catch(t){throw n.dispatch(a.callActions.restartMediaFinish(e,{local:!0,error:t})),t}}async function v(e){let r;arguments.length>1&&void 0!==arguments[1]&&arguments[1]||p.debug(`${d}call.resyncAsync:`,e),n.dispatch(a.callActions.resync(e));try{await t.resyncCallState(e)}catch(e){r=e}if(n.dispatch(a.callActions.resyncFinish(e,{error:r})),r)throw r}return{hold:async function(e){p.debug(d+"call.hold: ",e);const t=(0,s.getCallById)(n.getState(),e);try{await g(e,!0)}catch(n){f(i.CALL_STATE_CHANGE,{callId:e,previous:{state:t?t.state:void 0,localHold:t?t.localHold:void 0,remoteHold:t?t.remoteHold:void 0},error:n})}},holdAsync:g,unhold:async function(e){p.debug(d+"call.unhold: ",e);const t=(0,s.getCallById)(n.getState(),e);try{await _(e,!0)}catch(n){f(i.CALL_STATE_CHANGE,{callId:e,previous:{state:t?t.state:void 0,localHold:t?t.localHold:void 0,remoteHold:t?t.remoteHold:void 0},error:n})}},unholdAsync:_,addMedia:async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p.debug(d+"call.addMedia: ",e,r,o);try{const s=(0,l.formatMediaConstraints)(r);n.dispatch(a.callActions.addMedia(e,{mediaConstraints:s,...o}));const{affectedLocalTracks:c,mediaIds:u}=await t.addMedia(e,s,o);f(i.CALL_ADDED_MEDIA,{callId:e,local:!0,tracks:c,mediaId:u})}catch(t){n.dispatch(a.callActions.addMediaFinish(e,{local:!0,error:t})),f(i.CALL_ADDED_MEDIA,{callId:e,local:!0,error:t})}},addMediaAsync:async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p.debug(d+"call.addMediaAsync: ",e,r,o);try{const i=(0,l.formatMediaConstraints)(r);n.dispatch(a.callActions.addMedia(e,{mediaConstraints:i,...o}));const{affectedLocalTracks:s,mediaIds:c}=await t.addMedia(e,i,o);return{tracks:s,mediaId:c}}catch(t){throw n.dispatch(a.callActions.addMediaFinish(e,{local:!0,error:t})),t}},removeMedia:async function(e,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p.debug(d+"call.removeMedia: ",e,r),n.dispatch(a.callActions.removeMedia(e,{tracks:r,...o}));try{const{affectedLocalTracks:n}=await t.removeMedia(e,r,o);f(i.CALL_REMOVED_MEDIA,{callId:e,local:!0,tracks:n})}catch(t){n.dispatch(a.callActions.removeMediaFinish(e,{local:!0,error:t})),f(i.CALL_REMOVED_MEDIA,{callId:e,local:!0,error:t})}},removeMediaAsync:async function(e,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p.debug(d+"call.removeMediaAsync: ",e,r),n.dispatch(a.callActions.removeMedia(e,{tracks:r,...o}));try{await t.removeMedia(e,r,o)}catch(t){throw n.dispatch(a.callActions.removeMediaFinish(e,{local:!0,error:t})),t}},startVideo:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};p.debug(d+"call.startVideo: ",e,n);try{const{affectedLocalTracks:r,mediaIds:o}=await E(e,t,n,!0);f(i.CALL_ADDED_MEDIA,{callId:e,local:!0,tracks:r,mediaId:o})}catch(t){f(i.CALL_ADDED_MEDIA,{callId:e,local:!0,error:t})}},startVideoAsync:E,stopVideo:async function(e){let t;p.debug(d+"call.stopVideo: ",e);try{await y(e)}catch(e){t=e}finally{f(i.CALL_REMOVED_MEDIA,{callId:e,local:!0,error:t})}},stopVideoAsync:y,replaceTrack:async function(e,r,o){let s;p.debug(d+"call.replaceTrack: ",e,r,o);let c={};try{const i=(0,l.formatMediaConstraints)(o);n.dispatch(a.callActions.replaceTrack(e,{trackId:r,mediaConstraints:i})),c=await t.replaceTrack(e,r,i)}catch(e){s=e}n.dispatch(a.callActions.replaceTrackFinish(e,{...c,error:s})),f(i.CALL_TRACK_REPLACED,{callId:e,newTrackId:s?void 0:c.newTrackId,oldTrack:s?void 0:c.oldTrackState,error:s})},replaceTrackAsync:async function(e,r,o){p.debug(d+"call.replaceTrackAsync: ",e,r,o);try{const i=(0,l.formatMediaConstraints)(o);n.dispatch(a.callActions.replaceTrack(e,{trackId:r,mediaConstraints:i}));const s=await t.replaceTrack(e,r,i);return n.dispatch(a.callActions.replaceTrackFinish(e,s)),{newTrackId:s.newTrackId,oldTrack:s.oldTrackState,callId:e}}catch(t){throw n.dispatch(a.callActions.replaceTrackFinish(e,{error:t})),t}},restartMedia:async function(e){p.debug(`${d}call.restartMedia, callId: ${e}`);try{await S(e,!0),f(i.MEDIA_RESTART,{callId:e})}catch(t){f(i.MEDIA_RESTART,{callId:e,error:t})}},restartMediaAsync:S,resync:async function(e){p.debug(`${d}call.resync, callId: ${e}`);try{await v(e,!0)}catch(e){}},resyncAsync:v,playAudioFile:function(e,r){let o;p.debug(`${d}call.playAudioFile`,r);const i=new Promise((i,s)=>{n.dispatch(a.callActions.playAudio(e,r)),t.playAudioFile(e,r,function(e){o&&"function"==typeof o&&o(e)}).then(()=>{n.dispatch(a.callActions.playAudioFinish(e)),i()}).catch(t=>{n.dispatch(a.callActions.playAudioFinish(e,t)),s(t)})});return i.onPlaying=e=>(o=e,i),i}}},n(81045),n(84915);var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=n(35),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),s=n(40481),c=n(77126),l=n(9066),u=n(69752)},66353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,proxyPeer:n,id:r,log:o}=this;return o.info("Adding ICE candidate."),new Promise((a,i)=>{n.remoteDescription.type&&n.remoteDescription.sdp?t.addIceCandidate(e).then(a).catch(i):(o.info("Cannot set remote ICE candidate without a remote description."),i(new Error(`Peer ${r} cannot set remote ICE candidate without a remote description.`)))})},n(97107)},66446:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackActions=t.sessionActions=t.miscActions=t.mediaActions=t.deviceActions=void 0;var r=c(n(93269)),o=c(n(17524)),a=c(n(48377)),i=c(n(80850)),s=c(n(79616));function c(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(c=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}t.deviceActions=r,t.trackActions=o,t.sessionActions=a,t.mediaActions=i,t.miscActions=s},66449:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,WebRTCMediaOperations:n,logManager:i,API_LOG_TAG:s,emitEvent:c}=e,l=i.getLogger("MEDIA");async function u(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||l.debug(s+"media.initializeDevicesAsync: ",e);const t={audio:void 0===e||e.audio,video:void 0===e||e.video};await n.initializeDevices(t)}return{...{getDevices:()=>(l.debug(s+"media.getDevices"),(0,r.getDevices)(t.getState())),getById:e=>(l.debug(s+"media.getById: ",e),(0,r.getMediaById)(t.getState(),e)),getTrackById:e=>(l.debug(s+"media.getTrackById: ",e),(0,r.getTrackById)(t.getState(),e)),createLocalMedia:async e=>(l.debug(`${s}media.createLocalMedia: `,e),(await n.createLocal(e,!0)).map(e=>({type:e.type,media:(0,r.getMediaById)(t.getState(),e.media.id)}))),getLocalMedia(){l.debug(s+"media.getLocalMedia");const e=t.getState();return(0,r.getDetachedMedia)(e).reduce((t,n)=>{const{tracks:o}=n;for(const a of o){const{type:o}=(0,r.getTrackById)(e,a);t.push({type:o,media:n})}return t},[])},async disposeLocalMedia(e){if(l.debug(s+"media.disposeLocalMedia: "+e),e)if(e.media)for(const t of e.media.tracks)await n.disposeLocalMedia(t);else"string"==typeof e&&await n.disposeLocalMedia(e);else l.warn(s+"media.disposeLocalMedia: local media must be provided to dispose local tracks.")}},initializeDevices:async function(e){l.debug(s+"media.initializeDevices: ",e);try{await u(e,!0)}catch(e){return void c(o.INITIALIZE_DEVICES_ERROR,{error:e})}c(o.DEVICES_CHANGED,{})},initializeDevicesAsync:u,renderTracks:async function(e,t){let r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l.debug(s+"media.renderTracks: ",e,(0,a.logCssSelector)(t),i);try{r=await n.renderTracks(e,t,i)}catch(e){return void c(o.TRACK_RENDERED,{trackIds:e.filteredTrackIds,error:e.basicError})}c(o.TRACK_RENDERED,r)},renderTracksAsync:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};l.debug(s+"media.renderTracksAsync: ",e,(0,a.logCssSelector)(t),r);try{await n.renderTracks(e,t,r)}catch(e){throw e.basicError}},muteTracks:async function(e){let t;l.debug(s+"media.muteTracks: ",e);try{t=await n.muteTracks(e)}catch(e){return void c(o.TRACKS_MUTED,{trackIds:e.trackIds,tracks:e.trackIds,error:e.basicError})}c(o.TRACKS_MUTED,{trackIds:t,tracks:t})},muteTracksAsync:async function(e){let t;l.debug(s+"media.muteTracksAsync: ",e);try{t=await n.muteTracks(e)}catch(e){throw e.basicError}return t},unmuteTracks:async function(e){let t;l.debug(s+"media.unmuteTracks: ",e);try{t=await n.unmuteTracks(e)}catch(e){return void c(o.TRACKS_UNMUTED,{trackIds:e.trackIds,tracks:e.trackIds,error:e.basicError})}c(o.TRACKS_UNMUTED,{trackIds:t,tracks:t})},unmuteTracksAsync:async function(e){let t;l.debug(s+"media.unmuteTracksAsync: ",e);try{t=await n.unmuteTracks(e)}catch(e){throw e.basicError}return t},removeTracks:async function(e,t){l.debug(s+"media.removeTracks: ",e,(0,a.logCssSelector)(t)),await n.removeTracks(e,t)},removeTracksAsync:async function(e,t){l.debug(s+"media.removeTracksAsync: ",e,(0,a.logCssSelector)(t)),await n.removeTracks(e,t)}}},n(69375),n(81045),n(84915),n(55367);var r=n(69260),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51709)),a=n(1011)},66652:(e,t,n)=>{var r=n(90313),o=n(40105);e.exports=function(e,t){return r(o(e,t),1)}},66784:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n,emitEvent:r,context:s}=e,c=t.getLogger("WEBRTC"),l={},u={};return{setupProxies:function(e){c.info("Setting up external proxies in WebRTC."),(0,o.default)(e)&&n.webrtcManager.setProxies(e),e.managers&&Object.keys(e.managers).forEach(t=>{t in l||(l[t]=n[t]),n[t]=e.managers[t],c.debug(`Replaced WebRTC ${t} manager with proxy version.`)}),e.managerEventHandlers&&Object.keys(e.managerEventHandlers).forEach(t=>{t in n?(e.managerEventHandlers[t].forEach(e=>{n[t].on(e.eventName,e.eventFn),c.debug(`Added new '${e.eventName}' event handler on ${t} manager.`)}),u[t]=e.managerEventHandlers[t]):c.debug(`Provided '${t}' manager is not a WebRTC manager, skipping event handler proxies.`)}),c.info("Successfully set up external proxies in WebRTC.")},teardownProxies:async function(){c.info("Tearing down all external proxies in WebRTC."),n.webrtcManager.setProxies(void 0),Object.keys(l).forEach(e=>{n[e]=l[e],delete l[e],c.debug(`Reverted WebRTC ${e} manager to original version.`)}),Object.keys(u).forEach(e=>{u[e].forEach(t=>{n[e].off(t.eventName,t.eventFn),c.debug(`Removed added '${t.eventName}' event handler from ${e} manager.`)}),delete u[e]}),c.info("Successfully tore down proxies in WebRTC."),c.info("Updating devices after teardown.");const e=await n.devices.checkDevices();s.dispatch((0,a.devicesChanged)(e)),r(i.DEVICES_CHANGED,{})}}},n(81045),n(5350);var r,o=(r=n(36705))&&r.__esModule?r:{default:r},a=n(93269),i=n(51709)},66890:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container,r=n.getLogger("CALL");return async function(n){if(!s(n))return;const c=n.payload.notificationMessage,{sessionData:l}=c.sessionParams,u=(0,o.getCallByWrtcsSessionId)(e.getState(),l);if(!u)return void r.info(`Received ${c.eventType} notification for unknown call; ignoring.`);if(![a.CALL_STATES.CONNECTED,a.CALL_STATES.ON_HOLD].includes(u.state))return void r.debug(`Call not in correct state to perform a midcall operation: ${u.state}.`);const d=(0,i.getRemoteParticipant)(u,c),f={eventType:c.eventType,wrtcsSessionId:c.sessionParams.sessionData,sdp:c.sessionParams.sdp,...d,customParameters:c.customParameters};try{await t.negotiationOffer(l,f)}catch(e){r.warn(`Cannot handle remote operation. Error: ${e.message}`)}}},t.shouldHandlePattern=s,n(62234);var r=n(70506),o=n(40481),a=n(77126),i=n(82481);function s(e){return e.type===r.NOTIFICATION_RECEIVED&&Boolean("startCallUpdate"===e.payload.notificationMessage.eventType)}},67208:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTimer=function(){return Object.create(n)};const n={start(){return!this.isStarted()&&(this._startTime=r(),!0)},stop(){return!!this.isStarted()&&(this._startTime=void 0,!0)},isStarted(){return Boolean(this._startTime)},timeFromStart(){return this.isStarted()?r()-this._startTime:0},getStartTime(){return this._startTime}};function r(){return(new Date).getTime()}},67230:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.instanceFactory("Callstack.models.Negotiation",(t,n,c)=>{const l=n.createFlow??(n.isLocal?o.default:a.default),{type:u,isLocal:d,stages:f}=n,p=(0,s.v4)(),{callId:g,deferred:_,data:E}=c,y=i.REPORTER_OPERATION_EVENTS_MAP[u+(d?"_LOCAL":"_REMOTE")]||i.REPORTER_OPERATION_EVENTS_MAP[u],S=e.container.CallReporter.getReport(g).addEvent(y);n.isNegotiation=!0;const v=(0,r.default)(e.container,g,p,S.id,n),h={type:u,isNegotiation:!0,isLocal:d,start:void 0,receiveResponse:void 0,receiveUpdate:void 0,callId:g,id:p,data:{...E},tracker:v,get status(){return v.status},reportEvent:S,deferred:_},T=l(e.container,h,f);return Object.assign(h,T),h})};var r=c(n(3226)),o=c(n(98307)),a=c(n(29749)),i=n(84581),s=n(84596);function c(e){return e&&e.__esModule?e:{default:e}}},67261:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(90636))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(34721)),i=n(22191),s=n(45775);const c={};function l(e,t){return(n,r)=>({...n,isPending:e,pendingOperation:t})}c[a.SUBSCRIBE]=l(!0,{operation:i.OPERATIONS.SUBSCRIBE,startTime:Date.now()}),c[a.UNSUBSCRIBE]={next:(e,t)=>e.pendingOperation?.operation===i.OPERATIONS.SUBSCRIBE?e:l(!0,{operation:i.OPERATIONS.UNSUBSCRIBE,startTime:Date.now()})(e,t)},c[a.SUBSCRIBE_FINISHED]={next:(e,t)=>({...e,isPending:!1,pendingOperation:null,error:void 0,subscriptions:t.payload.subscriptions||e.subscriptions}),throw:(e,t)=>({...e,isPending:!1,pendingOperation:null,error:t.payload})},c[a.UNSUBSCRIBE_FINISHED]={next(e,t){const n={...e,isPending:!1,pendingOperation:null};return n.subscriptions=[],t.payload.reason===i.CHANGE_REASONS.LOST_CONNECTION&&(n.subscriptions=[]),n},throw:e=>({...e,isPending:!1,pendingOperation:null})},c[a.PLUGIN_SUBSCRIPTION_FINISHED]={next:(e,t)=>({...e,subscriptions:e.subscriptions.concat(t.payload)})},c[a.PLUGIN_UNSUBSCRIPTION_FINISHED]={next:(e,t)=>({...e,subscriptions:(0,o.default)(function(e){return e.channelType===t.payload.channelType&&e.service===t.payload.service})(e.subscriptions)})},c[a.CHANNEL_OPENED]={next:(e,t)=>({...e,notificationChannels:{...e.notificationChannels,[t.meta.type]:t.payload}})},c[a.CHANNEL_CLOSED]={next:(e,t)=>({...e,notificationChannels:{...e.notificationChannels,[t.meta.type]:void 0}})};const u=(0,s.handleActions)(c,{notificationChannels:{},subscriptions:[],registeredServices:["call","Presence","IM"],isPending:!1,pendingOperation:null});t.default=u},67267:(e,t,n)=>{var r=n(41580);e.exports=function(e){return e==e&&!r(e)}},67337:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.container);e.factory("Callstack.stages.make",()=>({local:{validate:s.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,o.default)(e.container),callStatusUpdateRinging:(0,a.default)(e.container),receiveEarlyMedia:(0,i.default)(e.container)},remote:{remoteOffer:(0,c.default)(e.container)}})),e.factory("Callstack.operations.make",()=>{const t=e.container.Callstack,n=t.models.Negotiation,r=t.models.Update;return{local:function(e,r){return n.instance({type:g.OPERATIONS.MAKE,isLocal:!0,stages:t.stages.make.local,createFlow:function(){return{...(0,u.default)(...arguments),receiveUpdate:(0,d.createPending)(...arguments).start}}},{callId:e,deferred:r})},remote:function(e){return r.instance({type:g.OPERATIONS.MAKE,isLocal:!1,stages:t.stages.make.remote,createFlow:l.default},{callId:e})}}}),e.factory("Callstack.utils.setupIncomingCall",()=>(0,f.default)(e.container)),e.factory("Callstack.utils.setupOutgoingSession",()=>(0,p.default)(e.container))};var r=_(n(5775)),o=_(n(80621)),a=_(n(15838)),i=_(n(56137)),s=_(n(81571)),c=_(n(27030)),l=_(n(8922)),u=_(n(98307)),d=n(46883),f=_(n(94916)),p=_(n(62168)),g=n(59090);function _(e){return e&&e.__esModule?e:{default:e}}},67426:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchResource=async function(e,t){const{requestOptions:n}=t;"/"!==e.charAt()&&(e=`/${e}`);const r=`${t.baseURL}${e}`,o=c(n);s.debug("Making REST request",o);const i=n.queryParams||{};let l=(0,a.default)(i);e.includes("?")&&(l=l.replace("?","&"));const u=await fetch(r+l,n);return s.debug("Received REST response",u),u},t.sanitizeRequest=c,n(62234);var r=i(n(89321)),o=n(69932),a=i(n(2633));function i(e){return e&&e.__esModule?e:{default:e}}const s=o.logManager.getLogger("REQUEST");function c(e){const t=(0,r.default)(e),n=t.headers&&t.headers.Authorization;n&&(t.headers.Authorization=n.substring(0,6)+"...");const o=t.body;if(o)try{t.body=JSON.parse(o)}catch(e){}return t}},67458:(e,t,n)=>{"use strict";var r=n(5604);e.exports=r("document","documentElement")},67475:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,o=t.getLogger("CLICKTOCALL");return{clickToCall:async function(e,t,a){const i={clickToCallRequest:{callingParty:t,calledParty:a}},s={endpoint:"clicktocall",method:"POST",body:JSON.stringify(i)},c=Date.now(),l=await n(s),{error:u,result:d}=l;if(u){const{message:e}=d,t=`ClickToCall request failed. ${e}`;throw o.info(t),new r.default({code:r.clickToCallCodes.RESPONSE_ERROR,message:t})}return{callId:e,caller:t,callee:a,requestTime:c}}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},67588:e=>{"use strict";e.exports={}},67592:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t);return n?n.state===a.CALL_STATES.ENDED?new o.default({code:o.callCodes.INVALID_STATE,message:"Call is already ended."}):void 0:new o.default({code:o.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(40481),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412)),a=n(77126)},67642:(e,t,n)=>{var r=n(43301);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},67769:(e,t,n)=>{var r=n(28486),o=n(80547);e.exports=function(e){return o(e)&&"[object WeakMap]"==r(e)}},67801:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.ignore",()=>({local:{validate:o.default,localOffer:(0,r.default)(e.container)}})),e.factory("Callstack.operations.ignore",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.IGNORE,isLocal:!0,stages:e.container.Callstack.stages.ignore.local},{callId:n})}}})};var r=i(n(74019)),o=i(n(19283)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},68015:(e,t,n)=>{var r=n(92673)("trimEnd",n(17426));r.placeholder=n(22991),e.exports=r},68032:(e,t,n)=>{"use strict";const r=n(7269),o=n(28605),a=n(72851),i=n(90028),s=Symbol("encodeFragmentIdentifier");function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function l(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function u(e,t){return t.decode?o(e):e}function d(e){return Array.isArray(e)?e.sort():"object"==typeof e?d(Object.keys(e)).sort((e,t)=>Number(e)-Number(t)).map(t=>e[t]):e}function f(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function p(e){const t=(e=f(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function g(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function _(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const o="string"==typeof n&&n.includes(e.arrayFormatSeparator),a="string"==typeof n&&!o&&u(n,e).includes(e.arrayFormatSeparator);n=a?u(n,e):n;const i=o||a?n.split(e.arrayFormatSeparator).map(t=>u(t,e)):null===n?n:u(n,e);r[t]=i};case"bracket-separator":return(t,n,r)=>{const o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!o)return void(r[t]=n?u(n,e):n);const a=null===n?[]:n.split(e.arrayFormatSeparator).map(t=>u(t,e));void 0!==r[t]?r[t]=[].concat(r[t],a):r[t]=a};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const o of e.split("&")){if(""===o)continue;let[e,i]=a(t.decode?o.replace(/\+/g," "):o,"=");i=void 0===i?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?i:u(i,t),n(u(e,t),i,r)}for(const e of Object.keys(r)){const n=r[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=g(n[e],t);else r[e]=g(n,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=d(n):e[t]=n,e},Object.create(null))}t.extract=p,t.parse=_,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const o=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[l(t,e),"[",o,"]"].join("")]:[...n,[l(t,e),"[",l(o,e),"]=",l(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[l(t,e),"[]"].join("")]:[...n,[l(t,e),"[]=",l(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[l(t,e),":list="].join("")]:[...n,[l(t,e),":list=",l(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?r:(o=null===o?"":o,0===r.length?[[l(n,e),t,l(o,e)].join("")]:[[r,l(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,l(t,e)]:[...n,[l(t,e),"=",l(r,e)].join("")]}}(t),o={};for(const t of Object.keys(e))n(t)||(o[t]=e[t]);const a=Object.keys(o);return!1!==t.sort&&a.sort(t.sort),a.map(n=>{const o=e[n];return void 0===o?"":null===o?l(n,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?l(n,t)+"[]":o.reduce(r(n),[]).join("&"):l(n,t)+"="+l(o,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,r]=a(e,"#");return Object.assign({url:n.split("?")[0]||"",query:_(p(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:u(r,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0,[s]:!0},n);const r=f(e.url).split("?")[0]||"",o=t.extract(e.url),a=t.parse(o,{sort:!1}),i=Object.assign(a,e.query);let c=t.stringify(i,n);c&&(c=`?${c}`);let u=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(u=`#${n[s]?l(e.fragmentIdentifier,n):e.fragmentIdentifier}`),`${r}${c}${u}`},t.pick=(e,n,r)=>{r=Object.assign({parseFragmentIdentifier:!0,[s]:!1},r);const{url:o,query:a,fragmentIdentifier:c}=t.parseUrl(e,r);return t.stringifyUrl({url:o,query:i(a,n),fragmentIdentifier:c},r)},t.exclude=(e,n,r)=>{const o=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,o,r)}},68244:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=n=>{const r=e.get(n),i=r.getState();delete i.id,(0,a.default)(r,t);const s=o.sessionActions.sessionAdded(n,i);t(s)},r=e=>{const n=o.sessionActions.sessionRemoved(e);t(n)};return e.on("session:new",n),e.on("session:removed",r),()=>{e.off("session:new",n),e.off("session:removed",r)}};var r,o=n(66446),a=(r=n(10975))&&r.__esModule?r:{default:r}},68250:(e,t,n)=>{var r=n(49753),o=n(5681),a=n(80088),i=n(54732),s=n(59068);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=i,c.prototype.set=s,e.exports=c},68336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.end",()=>{const t=(0,r.default)(e.container);return{local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling},remote:{remoteOffer:(0,a.default)(e.container)}}}),e.factory("Callstack.operations.end",()=>{const t=e.container.Callstack.models.Update;function n(n){return r=>{const o=e.container.Callstack.stages.end[n?"local":"remote"],a=n?void 0:i.createEnded;return t.instance({type:s.OPERATIONS.END,isLocal:n,stages:o,createFlow:a},{callId:r})}}return{local:n(!0),remote:n(!1)}})};var r=c(n(61869)),o=c(n(67592)),a=c(n(53254)),i=n(46883),s=n(59090);function c(e){return e&&e.__esModule?e:{default:e}}},68343:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,context:n,logManager:f,API_LOG_TAG:p,emitEvent:g}=e,_=f.getLogger("CALL");async function E(e,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};arguments.length>3&&void 0!==arguments[3]&&arguments[3]||_.debug(p+"call.answer: ",e,a,i);try{const s=(0,l.formatMediaConstraints)(a);n.dispatch(r.callActions.answerCall(e,{mediaConstraints:s,...i}));const c=(0,o.getCallById)(n.getState(),e);c&&c.isSlowStart?await t.answerSlow(e,s,i):await t.answer(e,s,i)}catch(t){throw n.dispatch(r.callActions.answerCallFinish(e,{error:t})),t}}async function y(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||_.debug(p+"call.rejectAsync: ",e),n.dispatch(r.callActions.rejectCall(e));try{await t.reject(e)}catch(t){throw n.dispatch(r.callActions.rejectCallFinish(e,{error:t})),t}const i=(0,o.getCallById)(n.getState(),e);n.dispatch(r.callActions.rejectCallFinish(e));const s={callId:e,previous:{state:i?i.state:void 0,localHold:i?i.localHold:void 0,remoteHold:i?i.remoteHold:void 0}};g(a.CALL_STATE_CHANGE,s)}async function S(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||_.debug(p+"call.ignoreAsync: ",e),n.dispatch(r.callActions.ignoreCall(e));const i=(0,o.getCallById)(n.getState(),e);let s;try{await t.ignore(e)}catch(e){s=e}if(n.dispatch(r.callActions.ignoreCallFinish(e,{error:s})),s)throw s;g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:i?i.state:void 0,localHold:i?i.localHold:void 0,remoteHold:i?i.remoteHold:void 0}})}async function v(e,i){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||_.debug(p+"call.forwardAsync: ",i),(0,o.getOptions)(n.getState()).normalizeDestination&&(i=(0,u.normalizeSipUri)(i,(0,s.getDomain)(n.getState())),_.info("Address normalized to: ",i)),n.dispatch(r.callActions.forwardCall(e,{destination:i}));try{await t.forward(e,i)}catch(t){throw n.dispatch(r.callActions.forwardCallFinish(e,{error:t})),t}const c=(0,o.getCallById)(n.getState(),e);n.dispatch(r.callActions.forwardCallFinish(e)),g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:c?c.state:void 0,localHold:c?c.localHold:void 0,remoteHold:c?c.remoteHold:void 0}})}async function h(e){let i;arguments.length>1&&void 0!==arguments[1]&&arguments[1]||_.debug(p+"call.endAsync: ",e),n.dispatch(r.callActions.endCall(e));try{await t.end(e)}catch(e){if(i=e,[c.callCodes.INVALID_PARAM,c.callCodes.INVALID_STATE].includes(i.code))throw i;_.info(`call.end error: ${i.message}`)}const s=(0,o.getCallById)(n.getState(),e);n.dispatch(r.callActions.endCallFinish(e,{isLocal:!0,error:i})),g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:s?s.state:void 0,localHold:s?s.localHold:void 0,remoteHold:s?s.remoteHold:void 0},error:i})}return{make:function(e,c){let f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_.debug(p+"call.make: ",e,c,f);const E=(0,d.v4)(),y=(0,s.getUserInfo)(n.getState()).username||"",S={to:e,from:(0,u.normalizeSipUri)(y,(0,s.getDomain)(n.getState()))},v=(0,l.formatMediaConstraints)(c);return(0,o.getOptions)(n.getState()).normalizeDestination&&S.to&&"string"==typeof S.to&&(S.to=(0,u.normalizeSipUri)(S.to,(0,s.getDomain)(n.getState())),_.info(`Address normalized to: ${S.to}`)),n.dispatch(r.callActions.makeCall(E,{participantAddress:S.to,from:S.from,mediaConstraints:v,...f})),setTimeout(async()=>{g(a.CALL_STARTED,{callId:E});try{await t.make(E,S,v,f),g(a.CALL_STATE_CHANGE,{callId:E,previous:{state:i.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1}})}catch(e){n.dispatch(r.callActions.makeCallFinish(E,{state:i.CALL_STATES.ENDED,error:e})),g(a.CALL_STATE_CHANGE,{callId:E,previous:{state:i.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1},error:e})}},0),E},makeAsync:async function(e,c){let f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_.debug(p+"call.makeAsync: ",e,c,f);const E=(0,d.v4)(),y=(0,s.getUserInfo)(n.getState()).username||"",S={to:e,from:(0,u.normalizeSipUri)(y,(0,s.getDomain)(n.getState()))},v=(0,l.formatMediaConstraints)(c);(0,o.getOptions)(n.getState()).normalizeDestination&&S.to&&"string"==typeof S.to&&(S.to=(0,u.normalizeSipUri)(S.to,(0,s.getDomain)(n.getState())),_.info(`Address normalized to: ${S.to}`)),n.dispatch(r.callActions.makeCall(E,{participantAddress:S.to,from:S.from,mediaConstraints:v,...f})),g(a.CALL_STARTED,{callId:E});try{await t.make(E,S,v,f),g(a.CALL_STATE_CHANGE,{callId:E,previous:{state:i.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1}})}catch(e){throw n.dispatch(r.callActions.makeCallFinish(E,{state:i.CALL_STATES.ENDED,error:e})),g(a.CALL_STATE_CHANGE,{callId:E,previous:{state:i.CALL_STATES.INITIATING,localHold:!1,remoteHold:!1}}),e}return(0,o.getCallById)(n.getState(),E)},answer:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_.debug(p+"call.answer: ",e,t,r);try{await E(e,t,r,!0)}catch(t){const r=(0,o.getCallById)(n.getState(),e);g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:r?r.state:void 0,localHold:r?r.localHold:void 0,remoteHold:r?r.remoteHold:void 0},error:t})}},answerAsync:E,reject:async function(e){_.debug(p+"call.reject: ",e);try{await y(e,!0)}catch(t){const r=(0,o.getCallById)(n.getState(),e);g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:r?r.state:void 0,localHold:r?r.localHold:void 0,remoteHold:r?r.remoteHold:void 0},error:t})}},rejectAsync:y,ignore:async function(e){_.debug(p+"call.ignore: ",e);const t=(0,o.getCallById)(n.getState(),e);try{await S(e,!0)}catch(n){g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:t?t.state:void 0,localHold:t?t.localHold:void 0,remoteHold:t?t.remoteHold:void 0},error:n})}},ignoreAsync:S,forward:async function(e,t){_.debug(p+"call.forward: ",t);try{await v(e,t,!0)}catch(t){const r=(0,o.getCallById)(n.getState(),e);g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:r?r.state:void 0,localHold:r?r.localHold:void 0,remoteHold:r?r.remoteHold:void 0},error:t})}},forwardAsync:v,end:async function(e){_.debug(p+"call.end: ",e);try{await h(e,!0)}catch(t){const i=(0,o.getCallById)(n.getState(),e);n.dispatch(r.callActions.endCallFinish(e,{isLocal:!0,error:t})),g(a.CALL_STATE_CHANGE,{callId:e,previous:{state:i?i.state:void 0,localHold:i?i.localHold:void 0,remoteHold:i?i.remoteHold:void 0},error:t})}},endAsync:h}},n(62234);var r=n(35),o=n(40481),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),i=n(77126),s=n(87075),c=n(75412),l=n(9066),u=n(89968),d=n(84596)},68489:(e,t,n)=>{"use strict";var r=n(5234),o=n(14188),a=/#|\.prototype\./,i=function(e,t){var n=c[s(e)];return n===u||n!==l&&(o(t)?r(t):!!t)},s=i.normalize=function(e){return String(e).replace(a,".").toLowerCase()},c=i.data={},l=i.NATIVE="N",u=i.POLYFILL="P";e.exports=i},68529:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=o.logManager.getLogger("Session",e);r.info("Creating new Session.");const p=e;let _;const E=t.peerManager,y=t.mediaManager,S=t.trackManager,v=t.deviceManager,h=new f.default,T={dscpControls:{}},C=new Map;let I,m=E.create(n.peer);if(!m)throw new Error(`Peer creation error in Session ${p}.`);function O(){const e=(0,c.getSdpSessionId)(m.remoteDescription.sdp);C.get(e)||C.set(e,m.dtlsRole)}function A(){const e=E.get(_);return e?e.localTracks:[]}function R(){const e=E.get(_);return e?e.senderTracks.map(e=>S.get(e.id)):[]}function b(){const e=E.get(_);return e?e.remoteTracks:[]}function N(e,t){const n=E.get(_);if(n){const o=e.map(async e=>{const o=n.findReusableTransceiver(e.track.kind);if(o){try{await o.sender.replaceTrack(e.track)}catch(e){throw r.error(e),e}o.direction=["sendrecv","recvonly"].includes(o.direction)?"sendrecv":"sendonly",r.info(`Track (${e.track.kind} : ${e.id}) reused transceiver (mid: ${o.mid}).`)}else await n.addTransceiver(e),r.info(`Added track (${e.track.kind} : ${e.id}).`);h.emit("new:track",{local:!0,trackId:e.id}),T.dscpControls=(0,d.default)(T.dscpControls,t),e.once("ended",t=>{let{isUnsolicited:n}=t;const o=E.get(_);o&&("closed"!==o.signalingState?(n?(v.emit("change",!0),setTimeout(()=>{h.emit("track:ended",{local:!0,trackId:e.id,isUnsolicited:n})},50)):(o.removeTrack(e.id),h.emit("track:ended",{local:!0,trackId:e.id,isUnsolicited:n})),T.dscpControls.hasOwnProperty(e.id)&&(r.debug(`Removing track ${e.id} from session dscp settings`),delete T.dscpControls[e.id])):r.debug(`Received ended event for track ${e.id}, but its associated Peer ${o.id} is closed. Ignoring this event...`))})});return Promise.all(o)}}function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((t,n)=>{const o=E.get(_);o||n(new Error(`Peer not found in Session ${p}.`)),e.mediaDirections&&(D(e.mediaDirections),delete e.mediaDirections),o.createOffer(e).then(n=>{(e.sdpHandlers||s.default.getHandlers().length)&&(r.debug("Modifying local offer with SDP pipeline."),n.sdp=s.default.run(e.sdpHandlers,n.sdp,{type:n.type,endpoint:i.PEER.ENDPOINT.LOCAL})),t(n)}).catch(n)})}function w(e){return new Promise((t,n)=>{const r=E.get(_);r||n(new Error(`Peer not found in Session ${p}.`)),r.setLocalDescription(e).then(()=>{"answer"===e.type&&O(),P(),t(r.localDescription)}).catch(n)})}function P(e){if("firefox"===(0,l.getBrowserDetails)().browser)return void r.debug("Setting sender parameters not supported on Firefox; skipping.");const t=[];for(const e in T.dscpControls)t.push(new Promise((t,n)=>{r.debug(`Setting networkPriority ${T.dscpControls[e]} for sender with track ${e}`),L(e,T.dscpControls[e]).then(t).catch(n)}));return Promise.all(t)}async function L(e,t){const n=E.get(_).getSenders().find(t=>t.track.id===e);if(n){const e=await n.getParameters();return e.encodings.forEach(e=>{e.networkPriority=t}),n.setParameters(e)}{const t=`Cannot find sender associated with trackId: ${e}`;return r.info(t),Promise.reject(t)}}function D(e){E.get(_).getTransceivers().forEach(t=>{const n=t.receiver.track.kind;(0,a.setTransceiverDirection)(t,e[n])})}function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((n,o)=>{const a=E.get(_);a||o(new Error(`Peer not found in Session ${p}.`)),(t.sdpHandlers||s.default.getHandlers().length)&&(r.debug("Modifying remote offer with SDP pipeline."),e.sdp=s.default.run(t.sdpHandlers,e.sdp,{type:e.type,endpoint:i.PEER.ENDPOINT.REMOTE})),a.setRemoteDescription(e).then(()=>{I=e,n()}).catch(o)})}function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((t,n)=>{const o=E.get(_);o||n(new Error(`Peer not found in Session ${p}.`)),e.mediaDirections&&(D(e.mediaDirections),delete e.mediaDirections);const a=(0,c.getSdpSessionId)(o.remoteDescription.sdp),l=C.get(a);!o.dtlsRole&&l&&(o.dtlsRole=l),o.createAnswer(e).then(n=>{(e.sdpHandlers||s.default.getHandlers().length)&&(r.debug("Modifying local answer with SDP pipeline."),n.sdp=s.default.run(e.sdpHandlers,n.sdp,{type:n.type,endpoint:i.PEER.ENDPOINT.LOCAL})),t(n)}).catch(n)})}function F(){r.info("Ending Session.");const e=E.get(_);e&&e.close(),h.emit("session:ended",p)}function H(e){e.oniceconnectionstatechange=t=>{h.emit("peer:iceConnectionStateChange",{iceConnectionState:e.iceConnectionState})},e.onicecandidate=e=>{h.emit("onicecandidate",{candidate:e.candidate})},e.onicegatheringstatechange=t=>{e.isIceCollectionCheckOngoing&&(e.iceLoop&&(clearTimeout(e.iceLoop),e.iceLoop=void 0),h.emit("peer:iceGatheringStateChange",{reason:i.ICE_COLLECTION_CHECK_REASONS.ICE_GATHERING_STATE_CHANGE,iceCollectionDuration:e.iceTimer.timeFromStart(),iceCandidates:e.iceCandidates,iceGatheringState:e.iceGatheringState,rtcPeerConnectionConfig:e.config,rtcLocalSessionDescription:e.localDescription}))},e.on("iceCandidateCollected",g(50)(t=>{e.isIceCollectionCheckOngoing&&(e.iceLoop&&(clearTimeout(e.iceLoop),e.iceLoop=void 0),h.emit("peer:iceCandidateCollected",{reason:i.ICE_COLLECTION_CHECK_REASONS.NEW_CANDIDATE,...t}))},{leading:!0})),e.on("scheduledCheck",t=>{e.isIceCollectionCheckOngoing&&(e.iceLoop&&(clearTimeout(e.iceLoop),e.iceLoop=void 0),h.emit("peer:iceCollectionScheduledCheck",{reason:i.ICE_COLLECTION_CHECK_REASONS.SCHEDULED,...t}))}),e.ontrack=e=>{let t=y.get(e.getStream().id);t?t.addTrack(e):t=y.createRemote(e.getStream(),[e]),e.once("ended",()=>{h.emit("track:ended",{local:!1,trackId:e.id,isUnsolicited:!1})});const{kind:n}=e.getState();r.info(`Received new track (${n} : ${e.id})`),h.emit("new:track",{local:!1,trackId:e.id})}}return _=m.id,H(m),{id:p,config:n,get peer(){return m},getState:function(){return{id:p,localTracks:A(),remoteTracks:b(),allLocalTracks:R()}},get localTracks(){return A()},get remoteTracks(){return b()},get allLocalTracks(){return R()},warmup:function(){},addTracks:N,removeTracks:function(e){const t=E.get(_);if(t){const n=t.senderTracks;e.forEach(e=>{n.findIndex(t=>t.id===e)>-1&&(t.removeTrack(e),T.dscpControls.hasOwnProperty(e)&&(r.debug(`Removing track ${e} from session dscp settings`),delete T.dscpControls[e]))})}},replaceTrack:function(e,t){const n=E.get(_),o=S.get(e.id);return n.replaceTrack(o.track,t).then(()=>{o.once("ended",e=>{let{isUnsolicited:t}=e;const n=E.get(_);n&&("closed"!==n.signalingState?(t||n.removeTrack(o.id),h.emit("track:ended",{local:!0,trackId:o.id,isUnsolicited:t}),T.dscpControls.hasOwnProperty(o.id)&&(r.debug(`Removing track ${o.id} from session dscp settings`),delete T.dscpControls[o.id])):r.debug(`Received ended event for track ${o.id}, but its associated Peer ${n.id} is closed. Ignoring this event...`))}),h.emit("track:replaced",{oldTrackId:t.trackId,trackId:e.id})}).catch(e=>e)},setTransceiversDirection:D,createOffer:M,createAnswer:j,setLocalDescription:w,getRemoteDescription:function(){return m.remoteDescription},getLatestRemoteDesc:function(){return I},generateOffer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((t,n)=>{M(e).then(w).then(t).catch(n)})},processOffer:k,generateAnswer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((t,n)=>{j(e).then(w).then(t).catch(n)})},processAnswer:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(t.sdpHandlers||s.default.getHandlers().length)&&(r.debug("Modifying remote answer with SDP pipeline."),e.sdp=s.default.run(t.sdpHandlers,e.sdp,{type:e.type,endpoint:i.PEER.ENDPOINT.REMOTE})),new Promise((t,n)=>{const r=E.get(_);r||n(new Error(`Peer not found in Session ${p}.`)),r.setRemoteDescription(e).then(()=>{O(),I=e,t()}).catch(n)})},iceCollectionCheckResult:function(e){const t=E.get(_);if(!t)return new Error(`Peer not found in Session ${p}.`);e.type===i.ICE_COLLECTION_RESULT_TYPES.START_CALL?(r.info("Proceeding with the negotiation as instructed by the ice collection check."),t.isIceCollectionCheckOngoing=!1,t.emitter.emit("onnegotiationready")):e.type===i.ICE_COLLECTION_RESULT_TYPES.ERROR?(r.info("Cleaning up session as instructed by the ice collection check."),t.isIceCollectionCheckOngoing=!1,A().forEach(e=>e.stop()),F()):e.type===i.ICE_COLLECTION_RESULT_TYPES.WAIT?e.wait&&(r.debug(`Setting a scheduled check for the ice collection check after ${e.wait} ms`),t.iceLoop=setTimeout(()=>(0,u.default)(t),e.wait)):(r.info("Unexpected result type from ICE collection check function, ending call."),t.isIceCollectionCheckOngoing=!1,A().forEach(e=>e.stop()),F())},recreatePeer:async function(e){const t=m,o=E.create(n.peer);if(!o)throw new Error(`Peer creation error in Session ${p}.`);_=o.id,r.debug(`Recreated Peer with ID: ${_}`),m=o,e?(await k({type:"offer",sdp:e}),await N(t.localTracks)):await Promise.all(t.localTracks.map(async e=>{await o.addTransceiver(e)})),H(o),t.close()},rollbackLocalDescription:function(){return new Promise((e,t)=>{const n=E.get(_);n||t(new Error(`Peer not found in Session ${p}.`)),n.setLocalDescription({type:"rollback"}).then(()=>{e(n.localDescription)}).catch(t)})},addIceCandidate:function(e){return new Promise((t,n)=>{const r=E.get(_);r||n(new Error(`Peer not found in Session ${p}.`)),r.addIceCandidate(e).then(t).catch(n)})},restartIce:function(){const e=E.get(_);e&&e.restartIce()},getDtlsRole:function(){const e=E.get(_);if(e)return e.dtlsRole},end:F,sendDTMF:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=E.get(_);return!!n&&n.sendDTMF(e,t)},getStats:function(e){return new Promise((t,n)=>{const r=E.get(_);r?r.getStats(e).then(t).catch(n):n(new Error(`Peer not found in Session ${p}.`))})},setParameters:P,getRemoteTrackIdsFromTransceivers:function(e){const t=m.getTransceivers(),n=[];return t.forEach(t=>{if(e.some(e=>e+""===t.mid)){const e=t.receiver.track.id;n.push(e)}}),n},getIncomingRemoteTrackIds:function(){const e=m.getTransceivers(),t=[];return e.forEach(e=>{null!==e.mid&&e.direction.includes("recv")&&"live"===e.receiver.track.readyState&&t.push(e.receiver.track.id)}),t},getActiveRemoteTrackIds:function(){const e=m.getTransceivers(),t=[];return e.forEach(e=>{null!==e.mid&&e.currentDirection&&e.currentDirection.includes("recv")&&"live"===e.receiver.track.readyState&&t.push(e.receiver.track.id)}),t},insertAudio:function(e){return new Promise((t,n)=>{let o=!1;function a(){o?u.play():o=!0}function i(){r.info(`Stopping track ${c.id} to release the microphone after error.`),c.track.stop(),c.track.onended(new Event("track-error"))}const s=E.get(_),c=s.localTracks.find(e=>"audio"===e.track.kind&&"live"===e.track.readyState);c||n(new Error("No valid local audio track found to insert audio file on."));let l=c.id;const u=new Audio(e);u.volume=.2;const d=new AudioContext,f=d.createMediaElementSource(u),p=d.createMediaStreamDestination();f.connect(p);const g=p.stream.getAudioTracks()[0];s.replaceTrack(g,{trackId:c.id}).then(()=>{l=g.id,r.debug("Replaced audio from file media."),a()}).catch(e=>{r.info(`Failed to replace audio with file media: ${e.message}.`),n(new Error("Failed to replace audio track with file media."))}),u.oncanplaythrough=()=>{r.debug("File media ready to be played."),a()},u.onplay=()=>{r.debug(`Audio file started playing. Duration of ${u.duration} seconds.`),t(u.duration)},u.onerror=()=>{r.info("Encountered error trying to play audio file."),l!==c.id&&s.replaceTrack(c.track,{trackId:g.id}).catch(()=>{i()}),n(new Error("Failed to play audio file.")),h.emit("audioFileEnded",!1)},u.onended=e=>{r.debug("Audio file ended playing."),s.replaceTrack(c.track,{trackId:g.id}).then(()=>{r.debug("Replaced original audio track."),h.emit("audioFileEnded",!0)}).catch(e=>{r.info("Failed to replace original audio track.",e),i(),h.emit("audioFileEnded",!1)})}})},addNewMedia:function(e,n){function o(e){const{audio:t,video:n,screen:r}=e;return new Promise(e=>{t||n?y.createLocal({audio:t,video:n}).then(t=>{e({status:"fulfilled",value:t})}).catch(t=>{e({status:"rejected",value:t})}):r&&y.createLocalScreen({video:r}).then(t=>{e({status:"fulfilled",value:t})}).catch(t=>{e({status:"rejected",value:t})})})}return new Promise((a,i)=>{const{audio:s,video:c,screen:l}=e,u=[];s&&u.push(o({audio:s})),c&&u.push(o({video:c})),l&&u.push(o({screen:l})),Promise.all(u).then(o=>{if(o.some(e=>e&&"rejected"===e.status)){const e=o.filter(e=>e&&"fulfilled"===e.status).map(e=>e.value);Promise.all(e.map(e=>e.stop)).then(()=>{const e=o.find(e=>"rejected"===e.status).value;let t;t="OverconstrainedError"===e.name?`Failed to get media due to constraint: ${e.constraint}.`:`Failed to get media => Name: ${e.name}; Error Message :${e.message}.`,r.info(t);const n=new Error(t);n.name=e.name,i(n)})}else{if(e.medias)for(const n of e.medias){const e=t.mediaManager.get(n.media.id);e&&o.push({value:e})}const r={};N(o.reduce((e,t)=>{if(t){const o=t.value.getTracks();if(n)for(const e of o)"audio"===e.getType()&&n.audioNetworkPriority?r[e.id]=n.audioNetworkPriority:"video"===e.getType()&&n.videoNetworkPriority?r[e.id]=n.videoNetworkPriority:"screen"===e.getType()&&n.screenNetworkPriority&&(r[e.id]=n.screenNetworkPriority);return e.concat(o)}return e},[]),r).then(()=>{const e=o.filter(e=>e&&e.value).map(e=>e.value);a(e)}).catch(i)}})})},on:function(){return h.on(...arguments)},once:function(){return h.once(...arguments)},off:function(){return h.off(...arguments)}}},n(97107),n(62234),n(69375),n(81045),n(30163),n(45950),n(5350),n(84915),n(55367),n(9925);var r=p(n(4255)),o=n(40271),a=n(16106),i=n(54507),s=p(n(28851)),c=n(19556),l=n(76555),u=p(n(74839)),d=p(n(7485)),f=p(n(19353));function p(e){return e&&e.__esModule?e:{default:e}}const g=r.default.convert({fixed:!1})},68580:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallHistoryOperations.storeCallLog",t=>(0,o.default)(e.container))};var r,o=(r=n(73413))&&r.__esModule?r:{default:r}},68729:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{proxyPeer:e}=this;return e.transceivers}},68809:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n,r,i){const s=i||(new Date).getTime(),c=(0,a.v4)(),l=r,u=[],d={},f=[],p="API invoked: ";const g={type:t,id:c,parentId:l,timeline:u,metrics:f,start:s,addEvent:function(t,r){if(this.end)throw new Error(`${p}timelineEvent.addEvent: Cannot add further sub-events. Event has been marked as ended.`);if(!t||!(0,o.default)(t))throw new Error(`${p}timelineEvent.addEvent: Invalid type (${typeof t}), must be of type string.`);if(r&&"number"!=typeof r)throw new Error(`${p}timelineEvent.addEvent: Invalid startTimestamp (${typeof r}), must be of type number.`);const a=e(t,n,c,r);return u.push(a),a},isEnded:function(){return!!this.end},getEvent:function(e){for(let t=0;t<u.length;t++){if(u[t].id===e)return u[t];{const n=u[t].getEvent(e);if(n)return n}}},findLastOngoingEvent:function(e){return[...u].reverse().find(t=>{if(t.type===e&&!t.isEnded())return t})},addData:function(e,t){if(!e||!(0,o.default)(e))throw new Error(`${p}timelineEvent.addData: Invalid type (${typeof e}), must be of type string.`);if(void 0===t)throw new Error(`${p}timelineEvent.addData: No data provided.`);d[e]=t},getData:function(e){return e?d[e]:d},addMetric:function(e,t){if(!e||!(0,o.default)(e))throw new Error(`${p}timelineEvent.addMetric: Invalid type (${typeof e}), must be of type string.`);if(void 0===t)throw new Error(`${p}timelineEvent.addMetric: No data provided.`);f.push({type:e,data:t})},getMetric:function(e){if(!e||!(0,o.default)(e))throw new Error(`${p}timelineEvent.getMetric: Invalid type (${typeof e}), must be of type string.`);return f.filter(t=>t.type===e).map(e=>e.data)},endEvent:function(e){this.end||(e&&(this.error=e),this.end=(new Date).getTime(),n(g))},setError:function(e){if(this.end)throw new Error("Can't set error on an event that has already ended.");this.error=e},getError:function(){return this.error},getSerializable:function(){return{type:t,id:c,parentId:l,timeline:u.map(e=>e.getSerializable()),data:d,metrics:f,start:s,end:this.end,error:this.error}}};return g},n(97107),n(69375),n(81045),n(45950),n(84915);var r,o=(r=n(73173))&&r.__esModule?r:{default:r},a=n(84596)},68903:(e,t,n)=>{"use strict";var r=n(5613),o=n(5234),a=n(13721);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("intersection",function(e){return 2===e.size&&e.has(1)&&e.has(2)})||o(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))})},{intersection:a})},68909:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,API_LOG_TAG:s}=e,c=n.getLogger("CONFIG");return{getConfig:function(){return c.debug(s+"getConfig"),(0,a.getConfiguration)(t.getState())},updateConfig:function(e){c.debug(s+"updateConfig: ",e);const n=(0,r.default)(e);n.call&&(n.call=(0,i.default)(n.call)),t.dispatch(o.update(n))}}};var r=s(n(89321)),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(87310)),a=n(52063),i=s(n(16556));function s(e){return e&&e.__esModule?e:{default:e}}},69011:(e,t,n)=>{var r=n(68250);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var i=e.apply(this,r);return n.cache=a.set(o,i)||a,i};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},69033:(e,t,n)=>{"use strict";var r=n(5613),o=n(37059),a=n(5234);r({target:"Set",proto:!0,real:!0,forced:!n(54471)("difference",function(e){return 0===e.size})||a(function(){var e={size:1,has:function(){return!0},keys:function(){var e=0;return{next:function(){var n=e++>1;return t.has(1)&&t.clear(),{done:n,value:2}}}}},t=new Set([1,2,3,4]);return 3!==t.difference(e).size})},{difference:o})},69260:(e,t,n)=>{"use strict";function r(e){return e.webrtc.sessions}function o(e){return e.webrtc.tracks}function a(e){return e.webrtc.media}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserDetails=function(e){return e.webrtc.browser},t.getDetachedMedia=function(e){return a(e).filter(e=>e.detached)},t.getDevices=function(e){return e.webrtc.devices},t.getMedia=a,t.getMediaById=function(e,t){return a(e).find(e=>e.id===t)},t.getSessionById=function(e,t){return r(e).find(e=>e.id===t)},t.getSessions=r,t.getTrackById=function(e,t){return o(e).find(e=>e.trackId===t)},t.getTracks=o,n(81045),n(30163),n(45950)},69334:(e,t,n)=>{var r=n(51340),o=n(79968),a=n(3422),i=n(37930),s=n(30125),c=n(17099),l=n(84354),u=n(83546),d=n(24733),f=n(80393),p=n(93650),g=n(28486),_=n(97350),E=n(50424),y=n(75964),S=n(53142),v=n(75853),h=n(37681),T=n(41580),C=n(83943),I=n(81211),m=n(25288),O="[object Arguments]",A="[object Function]",R="[object Object]",b={};b[O]=b["[object Array]"]=b["[object ArrayBuffer]"]=b["[object DataView]"]=b["[object Boolean]"]=b["[object Date]"]=b["[object Float32Array]"]=b["[object Float64Array]"]=b["[object Int8Array]"]=b["[object Int16Array]"]=b["[object Int32Array]"]=b["[object Map]"]=b["[object Number]"]=b[R]=b["[object RegExp]"]=b["[object Set]"]=b["[object String]"]=b["[object Symbol]"]=b["[object Uint8Array]"]=b["[object Uint8ClampedArray]"]=b["[object Uint16Array]"]=b["[object Uint32Array]"]=!0,b["[object Error]"]=b[A]=b["[object WeakMap]"]=!1,e.exports=function e(t,n,N,M,w,P){var L,D=1&n,k=2&n,j=4&n;if(N&&(L=w?N(t,M,w,P):N(t)),void 0!==L)return L;if(!T(t))return t;var F=S(t);if(F){if(L=_(t),!D)return l(t,L)}else{var H=g(t),x=H==A||"[object GeneratorFunction]"==H;if(v(t))return c(t,D);if(H==R||H==O||x&&!w){if(L=k||x?{}:y(t),!D)return k?d(t,s(L,t)):u(t,i(L,t))}else{if(!b[H])return w?t:{};L=E(t,H,D)}}P||(P=new r);var U=P.get(t);if(U)return U;P.set(t,L),C(t)?t.forEach(function(r){L.add(e(r,n,N,r,t,P))}):h(t)&&t.forEach(function(r,o){L.set(o,e(r,n,N,o,t,P))});var W=F?void 0:(j?k?p:f:k?m:I)(t);return o(W||t,function(r,o){W&&(r=t[o=r]),a(L,o,e(r,n,N,o,t,P))}),L}},69375:(e,t,n)=>{"use strict";var r=n(5613),o=n(83628),a=n(69389),i=n(14224),s=n(14578);r({target:"Array",proto:!0,arity:1,forced:n(5234)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=o(this),n=a(t),r=arguments.length;s(n+r);for(var c=0;c<r;c++)t[n]=arguments[c],n++;return i(t,n),n}})},69383:(e,t,n)=>{var r=n(86912),o=n(23945),a=n(52107),i=n(48875),s=o(function(e){return e.push(void 0,a),r(i,void 0,e)});e.exports=s},69389:(e,t,n)=>{"use strict";var r=n(97611);e.exports=function(e){return r(e.length)}},69454:e=>{e.exports=function(e){return e!=e}},69540:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEDIA_TRANSITIONS=void 0,t.MEDIA_TRANSITIONS={START:"START",STOP:"STOP",SAME:"SAME"}},69584:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallstackWebrtc:n,emitEvent:s,logManager:c}=e;return async function(e,l){const u=l.reasonText||o.COMPLEX_OPERATION_MESSAGES.JOIN_FAILURE,d=l.statusCode||o.STATUS_CODES.JOIN_FAILURE,f=c.getLogger("CALL",e.id);f.info("Received call operation failed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId}),f.debug(`Processing as a local join failure (${d}).`),await n.closeCall(e.webrtcSessionId);const p=new i.default({message:`Join operation failed: ${u} (${d})`,code:i.callCodes.GENERIC_ERROR});return t.dispatch(r.callActions.endCallFinish(e.id,{error:p})),s(a.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:!0,remoteHold:!1},error:p}),f.info("Finished handling call operation failed notice."),p}};var r=n(35),o=n(77126),a=s(n(51918)),i=s(n(75412));function s(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(s=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},69632:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},69752:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkBandwidthControls=function(e){const t={...e};return e&&e.audio&&"number"==typeof e.audio||(t.audio=null),e&&e.video&&"number"==typeof e.video||(t.video=null),t},t.generateEndParams=function(e,t,n){const r={isLocal:t,remoteParticipant:{displayNumber:n.remoteNumber,displayName:n.remoteName},transition:{prevState:e}};return n.statusCode&&(r.transition.statusCode=n.statusCode),n.reasonText&&(r.transition.reasonText=n.reasonText),r},t.getCallAction=function(e){return e===a.OPERATIONS.SLOW_START?{callAction:o.callActions.remoteSlowStart,eventFns:[]}:{callAction:o.callActions.updateCall,eventFns:[]}},t.getLocalTracks=function(e,t,n){const o=(0,r.getCallById)(e.getState(),t),a=(o?o.localTracks:[]).map(t=>(0,i.getTrackById)(e.getState(),t));return n?a.filter(e=>e.kind===n):a},t.getTrackDscpMapping=function(e,t){const{audio:n,video:r,screen:o}=e,a={};if(t){if(t.screenNetworkPriority)for(const e of o)a[e.id]=t.screenNetworkPriority;if(t.audioNetworkPriority)for(const e of n)a[e.id]=t.audioNetworkPriority;if(t.videoNetworkPriority)for(const e of r)a[e.id]=t.videoNetworkPriority}return a},n(81045),n(30163),n(84915);var r=n(40481),o=n(35),a=n(59090),i=n(69260)},69815:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sipEventReceived=function(e,t){return{type:r.SIP_EVENT_RECEIVED,payload:{event:e,eventType:e.eventType,callId:t}}},t.sipEventSubscribe=function(e,t,n,o){return{type:r.SIP_EVENT_SUBSCRIBE,payload:{eventType:e,subscribeUserList:t,clientCorrelator:n,customParameters:o}}},t.sipEventSubscribeFinish=function(e){let{response:t,error:n,eventType:a}=e;return o(r.SIP_EVENT_SUBSCRIBE_FINISH,{response:t,error:n,eventType:a})},t.sipEventUnsubscribe=function(e){return{type:r.SIP_EVENT_UNSUBSCRIBE,payload:e}},t.sipEventUnsubscribeFinish=function(e){let{response:t,error:n,eventType:a}=e;return o(r.SIP_EVENT_UNSUBSCRIBE_FINISH,{response:t,error:n,eventType:a})},t.sipEventUpdate=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return{type:r.SIP_EVENT_UPDATE,payload:{eventType:e,subscribeUserList:t.subscribeUserList||[],unsubscribeUserList:t.unsubscribeUserList||[],customParameters:n},meta:{isResub:o}}},t.sipEventUpdateFinish=function(e){let{response:t,error:n,eventType:a}=e;return o(r.SIP_EVENT_UPDATE_FINISH,{response:t,error:n,eventType:a})};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(32335));function o(e,t){let{response:n,error:r,eventType:o}=t;return{type:e,error:!!r,payload:r?{error:r,eventType:o}:n}}},69866:(e,t,n)=>{"use strict";var r=n(92618);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},69874:(e,t,n)=>{"use strict";var r=n(65438),o=n(12913),a=n(44318),i=n(49164),s=n(4282)("iterator");e.exports=function(e){if(!a(e))return o(e,s)||o(e,"@@iterator")||i[r(e)]}},69912:e=>{"use strict";const t=/(?:\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,n=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,r=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,o=/\\(u(?:[a-f\d]{4}|{[a-f\d]{1,6}})|x[a-f\d]{2}|.)|([^\\])/gi,a=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e",""],["a",""]]);function i(e){const t="u"===e[0],n="{"===e[1];return t&&!n&&5===e.length||"x"===e[0]&&3===e.length?String.fromCharCode(parseInt(e.slice(1),16)):t&&n?String.fromCodePoint(parseInt(e.slice(2,-1),16)):a.get(e)||e}function s(e,t){const n=[],a=t.trim().split(/\s*,\s*/g);let s;for(const t of a){const a=Number(t);if(Number.isNaN(a)){if(!(s=t.match(r)))throw new Error(`Invalid Chalk template style argument: ${t} (in style '${e}')`);n.push(s[2].replace(o,(e,t,n)=>t?i(t):n))}else n.push(a)}return n}function c(e){n.lastIndex=0;const t=[];let r;for(;null!==(r=n.exec(e));){const e=r[1];if(r[2]){const n=s(e,r[2]);t.push([e].concat(n))}else t.push([e])}return t}function l(e,t){const n={};for(const e of t)for(const t of e.styles)n[t[0]]=e.inverse?null:t.slice(1);let r=e;for(const[e,t]of Object.entries(n))if(Array.isArray(t)){if(!(e in r))throw new Error(`Unknown Chalk style: ${e}`);r=t.length>0?r[e](...t):r[e]}return r}e.exports=(e,n)=>{const r=[],o=[];let a=[];if(n.replace(t,(t,n,s,u,d,f)=>{if(n)a.push(i(n));else if(u){const t=a.join("");a=[],o.push(0===r.length?t:l(e,r)(t)),r.push({inverse:s,styles:c(u)})}else if(d){if(0===r.length)throw new Error("Found extraneous } in Chalk template literal");o.push(l(e,r)(a.join(""))),a=[],r.pop()}else a.push(f)}),o.push(a.join("")),r.length>0){const e=`Chalk template literal is missing ${r.length} closing bracket${1===r.length?"":"s"} (\`}\`)`;throw new Error(e)}return o.join("")}},69932:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logManager=t.API_LOG_TAG=void 0;var r,o=(r=n(44413))&&r.__esModule?r:{default:r},a=n(15375);t.API_LOG_TAG="API invoked: ";const i=(0,o.default)(a.defaultOptions);t.logManager=i},70100:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n}=e;return{localChanges:(t,n,r)=>E(e,t,n,r),signalling:async(r,o,a)=>{try{const{remoteTracks:i,localTracks:s}=await y(e,r,a);if(t.dispatch(l.callActions.remoteUnholdFinish(r.id,{remote:!0,remoteParticipant:{displayNumber:o.remoteNumber,displayName:o.remoteName},localTracks:s,remoteTracks:i})),n(u.CALL_STATE_CHANGE,{callId:r.id,previous:{state:r.state,localHold:r.localHold,remoteHold:r.remoteHold}}),n(u.CALL_TRACKS_ADDED,{callId:r.id,trackIds:[...s,...i]}),!1===r.localHold&&!0===r.remoteHold&&r.remoteTracks.length>0){const e=(0,d.getCallById)(t.getState(),r.id),o=r.remoteTracks.filter(t=>!e.remoteTracks.includes(t));n(u.CALL_TRACKS_REMOVED,{callId:r.id,trackIds:o})}}catch(e){throw t.dispatch(l.callActions.remoteUnholdFinish(r.id,{remote:!0,error:e})),n(u.CALL_STATE_CHANGE,{callId:r.id,previous:{state:r.state,localHold:r.localHold,remoteHold:r.remoteHold},error:e}),e}}}},t.localChanges=E,t.signalling=y,n(97107),n(62234),n(81045),n(30163);var r=n(70949),o=n(73520),a=_(n(48151)),i=g(n(11876)),s=g(n(29819)),c=n(77126),l=n(35),u=_(n(51918)),d=n(40481),f=n(59090),p=n(69260);function g(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(_=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}async function E(e,t,n,a){const{WebRTC:l,CallstackWebrtc:u,CallstackSDP:d,logManager:f}=e,p=f.getLogger("CALL",t.id),g=await l.sessionManager.get(t.webrtcSessionId);if(!g)throw p.debug(`webRTC session ${t.webrtcSessionId} not found.`),new Error(`Session for call ${t.id} not found.`);const _=(0,o.getMediaState)(t);if((0,i.default)(n.sdp)&&[c.CALL_MEDIA_STATES.DUAL_HOLD,c.CALL_MEDIA_STATES.LOCAL_HOLD].includes(_)){if(p.debug("Modifying remote offer to prevent resetting media while in local hold."),n.sdp=(0,s.default)(n.sdp),!n.sdp)return void p.debug("SDP is either undefined or not a string.");a.mediaDiff=d.compareMedia(a.remoteDesc.sdp,n.sdp,!0)}const E=await(0,r.isSameSdpSessionId)(l,t.webrtcSessionId,n.sdp);let y,S=!1;E?E&&t.hasMOH&&(p.debug(`Received offer SDP is both an unhold and stop MoH on the same session. Recreating Peer for call ${t.id}.`),S=!0):(p.debug(`Received offer SDP is for a different session. Recreating Peer for call ${t.id}.`),S=!0),n.sdp.includes("setup:active")&&(p.debug(`Received offer SDP with active role for call ${t.id}. Changing.`),n.sdp=n.sdp.replace(/setup:active/g,"setup:actpass"));try{y=await u.handleOffer(n.sdp,t.webrtcSessionId,t.bandwidth,S)}catch(e){throw p.debug("Failed to receive offer SDP.",e),e}return{answer:y,sameSession:E,session:g,opInfo:a}}async function y(e,t,n){const{context:r,CallRequests:o,logManager:i}=e,{answer:s,sameSession:c,session:l,opInfo:u}=n,d=i.getLogger("CALL",t.id);try{await o.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:s.answerSDP,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),d.info("Finished responding to remote update. Changing state based on the remote operation.");let e=[];e=c?await(0,a.default)(f.OPERATIONS.UNHOLD,u.mediaDiff,l):await(0,a.getAllRemoteTracks)(l);let n=[];return t.localHold||(n=(0,p.getSessionById)(r.getState(),t.webrtcSessionId).localTracks),{remoteTracks:e,localTracks:n}}catch(e){throw d.info("Failed to respond to remote offer with an answer."),e}}},70216:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.Callstack.operations;return async function(e){if(!o(e))return;const{id:n,...r}=e.payload;await t.callIceCollectionCheck(n,r)}},t.shouldHandlePattern=o;var r=n(81997);function o(e){return e.type===r.SESSION_ICE_GATHERING_STATE_CHANGE||e.type===r.SESSION_ICE_CANDIDATE_COLLECTED||e.type===r.SESSION_ICE_COLLECTION_SCHEDULED_CHECK}},70229:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("CallHistoryRequests.removeCallLogs",t=>(0,r.default)(e.container)),e.factory("CallHistoryOperations.removeCallLogs",t=>(0,o.default)(e.container))};var r=a(n(63344)),o=a(n(80328));function a(e){return e&&e.__esModule?e:{default:e}}},70272:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(62234),n(81045),n(84915);var r=s(n(90636)),o=s(n(35968)),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997)),i=n(45775);function s(e){return e&&e.__esModule?e:{default:e}}const c={};c[a.TRACK_ADDED]={next:(e,t)=>(0,o.default)(e,t.payload)},c[a.TRACK_REMOVED]={next:(e,t)=>e.map(e=>t.payload.trackId===e.trackId?{...e,state:"ended"}:e)},c[a.RENDER_TRACKS_FINISH]={next:(e,t)=>e.map(e=>t.payload.trackIds.includes(e.trackId)?{...e,containers:(0,o.default)(e.containers,t.payload.selector)}:e)},c[a.REMOVE_TRACKS_FINISH]={next(e,t){const n=e=>e===t.payload.selector;return e.map(e=>t.payload.trackIds.includes(e.trackId)?{...e,containers:(0,r.default)(n)(e.containers)}:e)}},c[a.MUTE_TRACKS_FINISH]={next:(e,t)=>e.map(e=>t.payload.trackIds.includes(e.trackId)?{...e,muted:!0}:e)},c[a.UNMUTE_TRACKS_FINISH]={next:(e,t)=>e.map(e=>t.payload.trackIds.includes(e.trackId)?{...e,muted:!1}:e)},c[a.TRACK_SOURCE_MUTED]={next:(e,t)=>e.map(e=>t.payload.trackIds.includes(e.trackId)?{...e,sourceMuted:!0}:e)},c[a.TRACK_SOURCE_UNMUTED]={next:(e,t)=>e.map(e=>t.payload.trackIds.includes(e.trackId)?{...e,sourceMuted:!1}:e)};const l=(0,i.handleActions)(c,[]);t.default=l},70286:(e,t,n)=>{"use strict";var r=n(96893),o=n(16881),a=n(10997),i=URLSearchParams.prototype,s=o(i.forEach);r&&!("size"in i)&&a(i,"size",{get:function(){var e=0;return s(this,function(){e++}),e},configurable:!0,enumerable:!0})},70310:(e,t,n)=>{var r=n(65111),o=n(57923),a=n(3334),i=n(41393),s=n(50642),c=n(49460),l=n(46775),u=n(22053),d=n(53142);e.exports=function(e,t,n){t=t.length?r(t,function(e){return d(e)?function(t){return o(t,1===e.length?e[0]:e)}:e}):[u];var f=-1;t=r(t,c(a));var p=i(e,function(e,n,o){return{criteria:r(t,function(t){return t(e)}),index:++f,value:e}});return s(p,function(e,t){return l(e,t,n)})}},70321:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="requests"},70475:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,sendRequest:n,logManager:r,CallReporter:l}=e;return{getSession:async function(e){const r=l.getReport(e.id);let c;const u=(0,o.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.status===a.OP_STATUS.PENDING);u?(c=r.getEvent(u.eventId).addEvent(i.REPORT_EVENTS.REST_REQUEST),c.addData("requestType",i.REPORTER_REQUESTS.GET_SESSION)):(c=r.findLastOngoingEvent(i.REPORT_EVENTS.RECEIVE_CALL).addEvent(i.REPORT_EVENTS.REST_REQUEST),c.addData("requestType",i.REPORTER_REQUESTS.GET_SESSION));const d=await s.linkCallRequest(n,{method:"GET",...e});if(d.error)throw c.setError(d.error),c.endEvent(),d.error;return c.addData("state",d.callControlResponse.state),c.endEvent(),{error:!1,state:d.callControlResponse.state}},updateCallRinging:async function(e){const t=r.getLogger("CALL",e.id);t.info("Updating call session as ringing on server-side.");const o={method:"PUT"};o.body=JSON.stringify({callControlRequest:{type:"ringing"}});const a=l.getReport(e.id).findLastOngoingEvent([i.REPORT_EVENTS.RECEIVE_CALL,i.REPORT_EVENTS.SEND_RINGING_FEEDBACK]).addEvent(i.REPORT_EVENTS.REST_REQUEST);a.addData("requestType",i.REPORTER_REQUESTS.CALL_RINGING_UPDATE_SESSION);const c=await s.linkCallRequest(n,{...o,...e});if(c.error)throw a.setError(c.error),a.endEvent(),t.debug("Failed to update call session as ringing server-side.",c.error),c.error;return t.debug("Call session updated as ringing server-side.",{wrtcsSessionId:e.wrtcsSessionId}),a.addData("wrtcsSessionId",e.wrtcsSessionId),a.endEvent(),{error:!1}},updateCustomParameters:async function(e){const r={method:"PUT"},c=e.isAnonymous?"callMeRequest":"callControlRequest";r.body=JSON.stringify({[c]:{type:"sendCustomHeaders",customParameters:e.customParameters}});const u=l.getReport(e.id),d=(0,o.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.type===a.OPERATIONS.SEND_CUSTOM_PARAMETERS),f=u.getEvent(d.eventId).addEvent(i.REPORT_EVENTS.REST_REQUEST);f.addData("requestType",i.REPORTER_REQUESTS.UPDATE_CUSTOM_PARAMETERS_ON_SESSION);const p=await s.linkCallRequest(n,{...r,...e});if(p.error)throw f.setError(p.error),f.endEvent(),p.error;return f.endEvent(),{error:!1}},auditCall:async function(e){const t={method:"PUT"},r=e.isAnonymous?"callMeRequest":"callControlRequest";t.body=JSON.stringify({[r]:{type:"audit"}});const o=l.getReport(e.id).addEvent(i.REPORT_EVENTS.AUDIT_CALL),a=await s.linkCallRequest(n,{...t,...e});if(a.error)throw o.setError(a.error),o.endEvent(),new c.default({code:a.error.code,message:a.error.message});return o.endEvent(),{status:"Connected",error:!1}}}},n(81045),n(45950);var r,o=n(40481),a=n(59090),i=n(84581),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(47378)),c=(r=n(75412))&&r.__esModule?r:{default:r}},70506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UNREGISTER_APPLE_PUSH_NOTIFICATION=t.UNREGISTER_ANDROID_PUSH_NOTIFICATION=t.REGISTER_APPLE_PUSH_NOTIFICATION=t.REGISTER_ANDROID_PUSH_NOTIFICATION=t.PROCESS_NOTIFICATION_FINISH=t.PROCESS_NOTIFICATION=t.NOTIFICATION_RECEIVED=t.ENABLE_NOTIFICATION_CHANNEL_FINISH=t.ENABLE_NOTIFICATION_CHANNEL=void 0;const n="@@KANDY/";t.PROCESS_NOTIFICATION=n+"PROCESS_NOTIFICATION",t.PROCESS_NOTIFICATION_FINISH=n+"PROCESS_NOTIFICATION_FINISH",t.NOTIFICATION_RECEIVED=n+"NOTIFICATION_RECEIVED",t.ENABLE_NOTIFICATION_CHANNEL=n+"ENABLE_NOTIFICATION_CHANNEL",t.ENABLE_NOTIFICATION_CHANNEL_FINISH=n+"ENABLE_NOTIFICATION_CHANNEL_FINISH",t.REGISTER_APPLE_PUSH_NOTIFICATION=n+"REGISTER_APPLE_PUSH_NOTIFICATION",t.REGISTER_ANDROID_PUSH_NOTIFICATION=n+"REGISTER_ANDROID_PUSH_NOTIFICATION",t.UNREGISTER_APPLE_PUSH_NOTIFICATION=n+"UNREGISTER_APPLE_PUSH_NOTIFICATION",t.UNREGISTER_ANDROID_PUSH_NOTIFICATION=n+"UNREGISTER_ANDROID_PUSH_NOTIFICATION"},70620:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=n=>{const r=e.get(n);(0,a.default)(r,t);const i=r.getTracks().some(e=>e.isDetached()),s=o.mediaActions.newMedia(n,{local:r.getState().isLocal,detached:i,tracks:r.getTracks().map(e=>e.id)});t(s)},r=e=>{const n=o.mediaActions.removedMedia(e);t(n)};return e.on("media:new",n),e.on("media:removed",r),()=>{e.off("media:new",n),e.off("media:removed",r)}},n(81045),n(84915),n(9925);var r,o=n(66446),a=(r=n(18487))&&r.__esModule?r:{default:r}},70674:(e,t,n)=>{var r=n(87379),o=n(65387),a=n(80547),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&o(e.length)&&!!i[r(e)]}},70675:(e,t,n)=>{"use strict";var r=n(76744),o=Math.max,a=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):a(n,t)}},70867:(e,t,n)=>{"use strict";async function r(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=arguments.length>2?arguments[2]:void 0;return Promise.race([e,new Promise((e,o)=>{t=r.create("connectivity",()=>{o(new Error(`Timed-out promise after ${n} milliseconds.`))},n)})]).finally(()=>r.clear(t))}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{delayLimit:n=8*e,multiplier:r=2,limit:o}=t;let a=1,i=e;for(;;){if(o&&o<=a)return i;yield i,i<n&&(i=e*Math.pow(r,a),i=i>n?n:i),a++}}()}Object.defineProperty(t,"__esModule",{value:!0}),t.makeTebSequence=o,t.startTebAttempts=function(e,t,n){let a,{taskTimeout:i=1e3,attemptDelay:s=1e3,delayMultiplier:c=1,maxDelay:l=5e3,maxAttempts:u=5}=e;for(var d=arguments.length,f=new Array(d>3?d-3:0),p=3;p<d;p++)f[p-3]=arguments[p];const g=o(s,{delayLimit:l,multiplier:c,limit:u});return new Promise((e,t)=>{_({resolve:e,reject:t},n)});async function _(e,n){const o=g.next(),s=o.done;s||(a=n.create("connectivity",_,o.value,{params:[e,n]}));try{const s=o.value<i?o.value:i,c=await r(t(...f),s,n);n.clear(a),e.resolve(c)}catch(t){s&&e.reject(t)}}},t.timedPromise=r,n(97107)},70949:(e,t)=>{"use strict";function n(e,t){const n=r(e),o=r(t);if(n&&o)return n===o}function r(e){const t=e.match(/o=.*/gm);if(t&&t[0])return t[0].split(" ")[1]}Object.defineProperty(t,"__esModule",{value:!0}),t.getSdpSessionId=r,t.hasSameSessionId=n,t.isSameSdpSessionId=async function(e,t,r){const o=await e.sessionManager.get(t),a=await o.getRemoteDescription();if(a&&a.sdp)return n(a.sdp,r)}},71025:(e,t,n)=>{"use strict";var r=n(16881),o=n(44977);e.exports=function(e,t,n){try{return r(o(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},71280:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,log:n}=this;return t.onsignalingstatechange=function(r){n.debug(`Peer received signalingstatechange event: ${t.signalingState}`),e(r)},!0}},71404:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{nativePeer:t,proxyPeer:n,id:r,log:o}=this;if(o.info(`Setting remote description ${e.type} in ${n.signalingState} state.`),!this.dtlsRole&&"answer"===e.type){const t=e.sdp.match(/a=setup:(\w*?)[\r\n]/);if(t){const e="active"===t[1]?"passive":"active";o.debug(`Selecting DTLS role ${e}. Remote Peer selected ${t[1]} DTLS role.`),this.dtlsRole=e}}return new Promise((a,i)=>{t.setRemoteDescription(e).then(()=>{o.info(`Finished setting remote description. State is now ${n.signalingState}.`),a()}).catch(e=>{o.info("Failed to set remote description."),o.debug(`Peer ${r}: ${e}`),i(e)})})}},72079:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(92778)),o=a(n(13995));function a(e){return e&&e.__esModule?e:{default:e}}const i=(0,n(45775).handleActions)({...r.default,...o.default},{errors:[],contacts:{},users:{},isPending:!0});t.default=i},72532:(e,t,n)=>{var r=n(94715),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},72597:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:c,CallstackWebrtc:l,CallReporter:u}=e;return async function(e,d){const f=n.getLogger("CALL",e.id);f.info("Processing remote response from regular, local update request.");const p=u.getReport(e.id),g=e.currentOperations.find(e=>e.isLocal&&e.type===i.OPERATIONS.MEDIA_RESTART),_=p.getEvent(g.eventId).addEvent(s.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);_.addData("operation",s.REPORTER_OPERATION_EVENTS_MAP.MEDIA_RESTART);const E=(0,r.getMediaState)(e);f.info(`Processing remote response for local ${g.type} operation. Call state: ${e.state}, MediaState: ${E}.`);try{const t={sessionId:e.webrtcSessionId,answerSdp:d.sdp};await l.receivedAnswer(t,e)}catch(n){throw t.dispatch(o.callActions.endCallFinish(e.id,{error:n})),c(a.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),c(a.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold},error:n}),_.setError(n),_.endEvent(),n}f.info(`Finished processing remote response to local ${g.type}. Changing state based on operation.`),t.dispatch(o.callActions.restartMediaFinish(e.id)),_.endEvent()}},n(81045),n(45950);var r=n(73520),o=n(35),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),i=n(59090),s=n(84581)},72668:(e,t)=>{"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function o(e,t,n,o,a,i){return r((s=r(r(t,e),r(o,i)))<<(c=a)|s>>>32-c,n);var s,c}function a(e,t,n,r,a,i,s){return o(t&n|~t&r,e,t,a,i,s)}function i(e,t,n,r,a,i,s){return o(t&r|n&~r,e,t,a,i,s)}function s(e,t,n,r,a,i,s){return o(t^n^r,e,t,a,i,s)}function c(e,t,n,r,a,i,s){return o(n^(t|~r),e,t,a,i,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,r="0123456789abcdef";for(let o=0;o<n;o+=8){const n=e[o>>5]>>>o%32&255,a=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let o=1732584193,l=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=o,f=l,p=u,g=d;o=a(o,l,u,d,e[t],7,-680876936),d=a(d,o,l,u,e[t+1],12,-389564586),u=a(u,d,o,l,e[t+2],17,606105819),l=a(l,u,d,o,e[t+3],22,-1044525330),o=a(o,l,u,d,e[t+4],7,-176418897),d=a(d,o,l,u,e[t+5],12,1200080426),u=a(u,d,o,l,e[t+6],17,-1473231341),l=a(l,u,d,o,e[t+7],22,-45705983),o=a(o,l,u,d,e[t+8],7,1770035416),d=a(d,o,l,u,e[t+9],12,-1958414417),u=a(u,d,o,l,e[t+10],17,-42063),l=a(l,u,d,o,e[t+11],22,-1990404162),o=a(o,l,u,d,e[t+12],7,1804603682),d=a(d,o,l,u,e[t+13],12,-40341101),u=a(u,d,o,l,e[t+14],17,-1502002290),l=a(l,u,d,o,e[t+15],22,1236535329),o=i(o,l,u,d,e[t+1],5,-165796510),d=i(d,o,l,u,e[t+6],9,-1069501632),u=i(u,d,o,l,e[t+11],14,643717713),l=i(l,u,d,o,e[t],20,-373897302),o=i(o,l,u,d,e[t+5],5,-701558691),d=i(d,o,l,u,e[t+10],9,38016083),u=i(u,d,o,l,e[t+15],14,-660478335),l=i(l,u,d,o,e[t+4],20,-405537848),o=i(o,l,u,d,e[t+9],5,568446438),d=i(d,o,l,u,e[t+14],9,-1019803690),u=i(u,d,o,l,e[t+3],14,-187363961),l=i(l,u,d,o,e[t+8],20,1163531501),o=i(o,l,u,d,e[t+13],5,-1444681467),d=i(d,o,l,u,e[t+2],9,-51403784),u=i(u,d,o,l,e[t+7],14,1735328473),l=i(l,u,d,o,e[t+12],20,-1926607734),o=s(o,l,u,d,e[t+5],4,-378558),d=s(d,o,l,u,e[t+8],11,-2022574463),u=s(u,d,o,l,e[t+11],16,1839030562),l=s(l,u,d,o,e[t+14],23,-35309556),o=s(o,l,u,d,e[t+1],4,-1530992060),d=s(d,o,l,u,e[t+4],11,1272893353),u=s(u,d,o,l,e[t+7],16,-155497632),l=s(l,u,d,o,e[t+10],23,-1094730640),o=s(o,l,u,d,e[t+13],4,681279174),d=s(d,o,l,u,e[t],11,-358537222),u=s(u,d,o,l,e[t+3],16,-722521979),l=s(l,u,d,o,e[t+6],23,76029189),o=s(o,l,u,d,e[t+9],4,-640364487),d=s(d,o,l,u,e[t+12],11,-421815835),u=s(u,d,o,l,e[t+15],16,530742520),l=s(l,u,d,o,e[t+2],23,-995338651),o=c(o,l,u,d,e[t],6,-198630844),d=c(d,o,l,u,e[t+7],10,1126891415),u=c(u,d,o,l,e[t+14],15,-1416354905),l=c(l,u,d,o,e[t+5],21,-57434055),o=c(o,l,u,d,e[t+12],6,1700485571),d=c(d,o,l,u,e[t+3],10,-1894986606),u=c(u,d,o,l,e[t+10],15,-1051523),l=c(l,u,d,o,e[t+1],21,-2054922799),o=c(o,l,u,d,e[t+8],6,1873313359),d=c(d,o,l,u,e[t+15],10,-30611744),u=c(u,d,o,l,e[t+6],15,-1560198380),l=c(l,u,d,o,e[t+13],21,1309151649),o=c(o,l,u,d,e[t+4],6,-145523070),d=c(d,o,l,u,e[t+11],10,-1120210379),u=c(u,d,o,l,e[t+2],15,718787259),l=c(l,u,d,o,e[t+9],21,-343485551),o=r(o,n),l=r(l,f),u=r(u,p),d=r(d,g)}return[o,l,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))}},72738:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t}=e;return function(e){t.dispatch(r.setCache(e))}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(31122))},72802:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){let{duration:i,intertoneGap:s}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const c=(0,r.getCallById)(e,t);return c?[o.CALL_STATES.CONNECTED,o.CALL_STATES.RINGING,o.CALL_STATES.EARLY_MEDIA].includes(c.state)?n&&/^[\d*#]+/.test(n)?void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"No DTMF tone specified."}):new a.default({code:a.callCodes.INVALID_STATE,message:`Call is in an invalid state (${c.state}).`}):new a.default({code:a.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})},n(62234);var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},72846:(e,t,n)=>{var r=n(69334);e.exports=function(e){return r(e,4)}},72851:e=>{"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},72937:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.factory("ClickToCallOperations",a.default),e.factory("ClickToCallRequests",i.default),{api:o.default,capabilities:["clickToCall"],name:r.name,reducer:r.reducer}};var r=n(53040),o=s(n(41100)),a=s(n(96051)),i=s(n(67475));function s(e){return e&&e.__esModule?e:{default:e}}n(18717)},73129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,sendRequest:r}=e,i=n.getLogger("PRESENCE");return{updatePresence:async function(e,n,s){const c=(0,o.getRequestInfo)(t.getState()),l=c.version,u=`${c.baseURL}/rest/version/${l}/user/${c.username}/presence`,d={status:e,activity:n};s&&(d.note=s);const f={method:"POST",url:u,responseType:"json",body:JSON.stringify({presenceRequest:d})},p=await r(f),{body:g,error:_,result:E}=p;if(_){if(g){const{statusCode:e}=g.presenceResponse,t=`Failed to update presence with status code ${e}.`;throw i.debug(t),new a.default({message:t})}{const{message:e}=E,t=`Update presence request failed: ${e}`;throw i.info(t),new a.default({message:t})}}if(0!==g.presenceResponse.statusCode){const e=`Failed to update presence. Code: ${g.presenceResponse.statusCode}.`;throw new a.default({message:e})}return p},watchPresence:async function(e,n){const s=(0,o.getRequestInfo)(t.getState()),c=s.version,l={method:"POST",url:`${s.baseURL}/rest/version/${c}/user/${s.username}/presenceWatcher`,responseType:"json",body:JSON.stringify({presenceWatcherRequest:{userList:e,action:n}})},u=await r(l),{body:d,error:f,result:p}=u;if(f){if(d){const{statusCode:e}=d.presenceWatcherResponse,t=`Failed to watch presence with status code ${e}.`;throw i.debug(t),new a.default({message:t})}{const{message:e}=p,t=`Watch presence request failed: ${e}`;throw i.info(t),new a.default({message:t})}}if(0!==d.presenceWatcherResponse.statusCode){const e=`Failed to execute presence operation (${n}). Code: ${d.presenceWatcherResponse.statusCode}.`;throw new a.default({message:e})}return u.body}}};var r,o=n(87075),a=(r=n(75412))&&r.__esModule?r:{default:r}},73168:(e,t,n)=>{"use strict";var r=n(5604),o=n(16881),a=n(25629),i=n(30156),s=n(3770),c=o([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=a.f(s(e)),n=i.f;return n?c(t,n(e)):t}},73173:(e,t,n)=>{var r=n(92673)("isString",n(8138),n(76648));r.placeholder=n(22991),e.exports=r},73176:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t}=e;return async function(e,n){t.dispatch(r.enableNotificationChannelFinish(e,{params:{channelEnabled:n}}))}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(50130))},73313:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=[],n=()=>Boolean(a());function o(e,n){return t.find(t=>t[e]===n)}function a(){return t.find(e=>e.isNegotiation&&e.tracker.status!==r.OP_STATUS.FINISHED||e.type===r.OPERATIONS.END)}return{add:function(a){const i=`${a.isLocal?"local":"remote"} ${a.type}`;if(e.debug(`Operations: Tracking ${i} operation with ${t.length} other on-going operations.`),a.isNegotiation&&n()){const t=o("isNegotiation",!0);throw e.info(`Cannot track new negotiation because of ${t.status} ${t.type} operation.`),new Error("Cannot track two blocking operations!")}if(o("id",a.id))throw e.warn("Cannot track operation that was previously tracked."),new Error("Operation is already being tracked!");if(a.status!==r.OP_STATUS.NOT_STARTED)throw e.warn("Cannot track operation that was previously started."),new Error("Operation was already started!");t.push(a)},remove:function(n){const a=`${n.isLocal?"local":"remote"} ${n.type}`;if(e.debug(`Operations: Done tracking ${a} operation with ${t.length-1} other on-going operations.`),!o("id",n.id))throw e.warn("Cannot stop tracking operation that was not previously tracked."),new Error("Operation is not being tracked!");if(!(n.tracker.status===r.OP_STATUS.FINISHED||n.isLocal&&[r.OPERATIONS.JOIN,r.OPERATIONS.DIRECT_TRANSFER,r.OPERATIONS.CONSULTATIVE_TRANSFER].includes(n.type)))throw e.warn("Cannot stop tracking operation that has not finished."),new Error(`Cannot remove on-going ${a} operation! (${n.tracker.status})`);const i=t.findIndex(e=>e.id===n.id);t.splice(i,1)},toState:()=>{},getById:e=>o("id",e),getByType:e=>o("type",e),getNegotiation:()=>o("isNegotiation",!0),getPending:function(){return t.filter(e=>e.tracker.status===r.OP_STATUS.PENDING)},getBlocking:a,getAll:function(){return t},get isBlocked(){return n()}}},n(97107),n(62234),n(69375);var r=n(59090)},73331:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{proxyPeer:t,nativePeer:n,log:r}=this;let o;r.info(`Adding new ${e.track.kind} track.`);try{o=n.addTransceiver(e.track,{direction:"sendrecv",streams:[e.getStream()]}),t.transceivers.push(o)}catch(e){r.info(`Failed to add track: ${e.message}`)}return o},n(69375)},73413:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:c}=e,l=n.getLogger("CALLHISTORY");return function(e,n){const u=(0,s.getCallById)(t.getState(),e);if(!u)return void l.debug(`Call (${e}) not in state to create local log.`);if(u.state!==i.CALL_STATES.ENDED)return;const d=(0,a.getUserInfo)(t.getState()),f={recordId:e,startTime:""+u.startTime,duration:""+(u.endTime-u.startTime),callerDisplayNumber:u.isCaller?d.username:u.remoteParticipant.displayNumber,calleeDisplayNumber:u.isCaller?u.remoteParticipant.displayNumber:d.username,calleeName:u.isCaller?u.remoteParticipant.displayName||u.remoteParticipant.displayNumber:d.username,callerName:u.isCaller?u.displayName?u.displayName:d.username:u.remoteParticipant.displayName||u.remoteParticipant.displayNumber,remoteParticipant:u.remoteParticipant,originalRemoteParticipant:null,resourceLocation:""};"incoming"===u.direction?n&&n.prevState===i.CALL_STATES.RINGING&&"9904"!==n.code?f.direction="missed":f.direction="incoming":f.direction="outgoing",l.debug(`Adding ${f.direction} call to the local call history:`,f),t.dispatch(r.addCallLogEntry(f)),c(o.CALL_HISTORY_CHANGE,{}),c(o.CALL_HISTORY_CACHE_CHANGE,{})}};var r=c(n(31122)),o=c(n(91708)),a=n(87075),i=n(77126),s=n(40481);function c(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(c=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},73450:(e,t,n)=>{var r=n(81586);e.exports=function(e,t){return null==e||r(e,t)}},73501:e=>{e.exports=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(o);++r<o;)a[r]=e[r+t];return a}},73504:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,sendRequest:l,CallReporter:u}=e;return{createSession:async function(e,d){const f=n.getLogger("CALL",e.id);f.info("Creating call session on server-side.");const p=(0,r.getOptions)(t.getState()),g=u.getReport(e.id),_=(0,r.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&(e.type===o.OPERATIONS.MAKE||e.type===o.OPERATIONS.MAKE_ANONYMOUS)),E=g.getEvent(_.eventId);let y=e.from;d.displayName&&(y=`${d.displayName}<${y}>`);const S={type:"callStart",to:e.to,from:y,sdp:e.offer};p.earlyMedia&&(S.supported=["earlymedia"]),d.customParameters&&(S.customParameters=d.customParameters),d.customBodies&&(S.customBodies=d.customBodies);const v={...e,method:"POST"};let h;if(e.isAnonymous){h="callMeResponse";const e=(0,i.getWebsocketId)(t.getState(),"callMe");if(!e)throw new c.default({code:c.callCodes.GENERIC_ERROR,message:"Cannot start call without call service subscription."});v.body=JSON.stringify({callMeRequest:{...S,notifyChannelId:e}})}else h="callControlResponse",v.body=JSON.stringify({callControlRequest:S});const T=E.addEvent(a.REPORT_EVENTS.REST_REQUEST);T.addData("requestType",a.REPORTER_REQUESTS.CREATE_SESSION);const C=await s.linkCallRequest(l,v);if(C.error)throw f.debug("Failed to create Call session server-side.",C.error),T.setError(C.error),T.endEvent(),C.error;{const e=C[h].sessionData;return f.debug("Call session created server-side.",{wrtcsSessionId:e}),T.addData("wrtcsSessionId",e),T.endEvent(),e}},answerSession:async function(e){const i=n.getLogger("CALL",e.id);i.info("Answering call session on server-side.");const c=u.getReport(e.id),d=(0,r.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.type===o.OPERATIONS.ANSWER),f=c.getEvent(d.eventId),p={method:"PUT"};p.body=JSON.stringify({callControlRequest:{type:"callAnswer",sdp:e.answer,customParameters:e.customParameters,customBodies:e.customBodies}});const g=f.addEvent(a.REPORT_EVENTS.REST_REQUEST);g.addData("requestType",a.REPORTER_REQUESTS.ANSWER_SESSION);const _=await s.linkCallRequest(l,{...p,...e});if(_.error)throw i.debug("Failed to answer Call session server-side.",_.error),g.setError(_.error),g.endEvent(),_.error;i.debug("Call session answered server-side.",{wrtcsSessionId:e.wrtcsSessionId}),g.endEvent()},rejectSession:async function(e){const i=n.getLogger("CALL",e.id);i.info("Rejecting call session on server-side.");const c=u.getReport(e.id),d=(0,r.getCallById)(t.getState(),e.id).currentOperations.find(e=>e.isLocal&&e.type===o.OPERATIONS.REJECT),f=c.getEvent(d.eventId),p={method:"POST",endUrl:"calldisposition"};p.body=JSON.stringify({callDispositionRequest:{action:"reject",sessionData:e.wrtcsSessionId}});const g=f.addEvent(a.REPORT_EVENTS.REST_REQUEST);g.addData("requestType",a.REPORTER_REQUESTS.REJECT_SESSION);const _=await s.linkCallRequest(l,p);if(_.error)throw i.debug("Failed to reject Call session server-side.",{wrtcsSessionId:e.wrtcsSessionId},_.error),g.setError(_.error),g.endEvent(),_.error;i.debug("Call session rejected server-side.",{wrtcsSessionId:e.wrtcsSessionId}),g.endEvent()},forwardSession:async function(e){const i=(0,r.getCallByWrtcsSessionId)(t.getState(),e.wrtcsSessionId);n.getLogger("CALL",i.id).info("Forwarding call session on server-side.");const c=u.getReport(i.id),d=i.currentOperations.find(e=>e.isLocal&&e.type===o.OPERATIONS.FORWARD_CALL),f=c.getEvent(d.eventId),p={method:"POST",endUrl:"calldisposition"};p.body=JSON.stringify({callDispositionRequest:{action:"forward",sessionData:e.wrtcsSessionId,address:e.address}});const g=f.addEvent(a.REPORT_EVENTS.REST_REQUEST);g.addData("requestType",a.REPORTER_REQUESTS.FORWARD_SESSION);const _=await s.linkCallRequest(l,p);if(_.error)throw g.setError(_.error),g.endEvent(),_.error;g.endEvent()},endSession:async function(e){const i=n.getLogger("CALL",e.callId);i.info("Ending call session on server-side.");const c=u.getReport(e.callId),d=(0,r.getCallById)(t.getState(),e.callId).currentOperations.find(e=>e.isLocal&&[o.OPERATIONS.END,o.OPERATIONS.JOIN,o.OPERATIONS.DIRECT_TRANSFER,o.OPERATIONS.CONSULTATIVE_TRANSFER].includes(e.type)),f=c.getEvent(d.eventId).addEvent(a.REPORT_EVENTS.REST_REQUEST);f.addData("requestType",a.REPORTER_REQUESTS.END_SESSION);const p=await s.linkCallRequest(l,{method:"DELETE",responseType:"none",...e});if(p.error)throw i.info("Failed to end Call session server-side.",p.error),f.setError(p.error),f.endEvent(),p.error;i.info("Call session ended server-side.",{wrtcsSessionId:e.wrtcsSessionId}),f.endEvent()}}},n(62234),n(81045),n(45950);var r=n(40481),o=n(59090),a=n(84581),i=n(56512),s=l(n(47378)),c=l(n(75412));function l(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},73520:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaState=function(e){return o(e)?r.CALL_MEDIA_STATES.CONNECTED:a(e)?r.CALL_MEDIA_STATES.LOCAL_HOLD:i(e)?r.CALL_MEDIA_STATES.REMOTE_HOLD:s(e)?r.CALL_MEDIA_STATES.DUAL_HOLD:void 0},t.hasMedia=o,t.isDualHold=s,t.isLocalHold=a,t.isRemoteHold=i;var r=n(77126);function o(e){return e.state===r.CALL_STATES.CONNECTED&&!e.localHold&&!e.remoteHold}function a(e){return e.state===r.CALL_STATES.ON_HOLD&&e.localHold&&!e.remoteHold}function i(e){return e.state===r.CALL_STATES.ON_HOLD&&!e.localHold&&e.remoteHold}function s(e){return e.state===r.CALL_STATES.ON_HOLD&&e.localHold&&e.remoteHold}},73640:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,TimerTracker:n}=e;t.getLogger("CALL").info("Cleaning up call plugin"),n.clearAllByType("call"),n.clearAllByType("callNegotiation")}},73741:(e,t,n)=>{var r=n(51942)(!0);e.exports=r},73758:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,TimerTracker:a}=e,i=n.getLogger("SIPEVENTS");function s(e){if(!e||"string"!=typeof e)throw new Error("Invalid eventType argument, eventType must be a string.");return a.getAllById(e).some(e=>a.isRunning(e.handle))}function c(e){a.clearAllById(e)}return{isRunning:s,stop:c,startResubInterval:function(n,l){const{SipEventsOperations:u}=e,{getState:d}=t;if(s(n))throw new Error(`There's already an interval running for ${n}.`);if("number"!=typeof l)throw new Error("The value passed for the expires argument must be a number.");const f=1e3*l/2;a.create("sipEvents",()=>{if((0,r.getSipEventInfo)(d(),n)){i.info(`Re-subscribing for sip ${n}.`);try{u.update(n,{},null,!0)}catch(e){e.code===o.sipEventCodes.NOT_SUBSCRIBED&&c(n)}}},f,{id:n,repeating:!0})}}},n(97107),n(81045),n(9925);var r=n(29962),o=n(75412)},73817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:function(t,n){return s(e,t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})},signalling:(t,n)=>c(e,t,n)}},t.localChanges=s,t.signalling=c;var r=n(51918),o=n(35),a=n(40481),i=n(37654);async function s(e,t,n,r){const{context:o,Callstack:i,logManager:s}=e,c=s.getLogger("CALL",t);c.info("Removing media from call.");const{bandwidth:l}=r,u=(0,a.getCallById)(o.getState(),t),{webrtcSessionId:d,bandwidth:f}=u,p={audio:l&&l.audio?l.audio:f.audio,video:l&&l.video?l.video:f.video};let g;try{g=await i.utils.webrtcRemoveMedia({sessionId:d,tracks:n,bandwidth:p})}catch(e){throw c.info("Failed to remove media from call."),e}return{operationData:{local:!0,tracks:n,bandwidth:p},sdp:g}}async function c(e,t,n){const{context:s,CallRequests:c,Callstack:l,CallstackWebrtc:u,emitEvent:d,logManager:f}=e,{sdp:p}=n,g=(0,a.getCallById)(s.getState(),t),_=f.getLogger("CALL",g.id);try{await c.updateSession({wrtcsSessionId:g.wrtcsSessionId,id:g.id,offer:p,isAnonymous:g.isAnonymous,account:g.account,customParameters:g.customParameters,customBodies:g.customBodies})}catch(e){_.info("Failed to remove media from call.");try{await l.utils.rollbackRemoveMedia(g.webrtcSessionId)}catch(t){if(_.debug("Automatic remove media rollback failed:",t),"safari"===(0,i.getBrowserDetails)().browser)throw _.info("Ending call due to unrecoverable state after call remove media failure."),await u.closeCall(g.webrtcSessionId),s.dispatch(o.callActions.endCallFinish(g.id,{isLocal:!0,transition:{reasonText:"Call has ended due to call remove media failure."}})),d(r.CALL_STATE_CHANGE,{callId:g.id,previous:{state:g.state,localHold:g.localHold,remoteHold:g.remoteHold},error:e}),e;_.info("Unable to reset state after remove media operation failure, future operations may not work as intended.")}throw e}_.info("Finished local portion of removing media. Waiting on remote response.")}},74019:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallstackWebrtc:n,logManager:a}=e;return async function(e){const i=a.getLogger("CALL",e);i.info("Ignoring incoming call.");const s=(0,o.getCallById)(t.getState(),e);n.closeCall(s.webrtcSessionId),i.info(`Finished ignoring call. Changing to ${r.CALL_STATES.ENDED}.`)}};var r=n(77126),o=n(40481)},74043:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAddMedia",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"createAnswer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"createCallCancelled",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"createConsultTransfer",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"createDirectTransfer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"createEnd",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"createForward",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"createGenericRemote",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(t,"createGetCodecs",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"createGetStats",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"createHold",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"createIceCollectionCheck",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(t,"createIceRestart",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"createIgnore",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"createJoin",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"createMake",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"createMoH",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(t,"createNormalizeIceFailure",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"createPlayAudioFile",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"createReject",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"createRemoveMedia",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"createReplaceTrack",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"createResyncCallState",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(t,"createSendCallAudit",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"createSendCustom",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(t,"createSendDtmf",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(t,"createSendRingingFeedback",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"createSlowStart",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"createUnhold",{enumerable:!0,get:function(){return _.default}});var r=P(n(4899)),o=P(n(6521)),a=P(n(12509)),i=P(n(67337)),s=P(n(30373)),c=P(n(68336)),l=P(n(99568)),u=P(n(67801)),d=P(n(29072)),f=P(n(89974)),p=P(n(75170)),g=P(n(58998)),_=P(n(82489)),E=P(n(33841)),y=P(n(18284)),S=P(n(75071)),v=P(n(94793)),h=P(n(1441)),T=P(n(25654)),C=P(n(85514)),I=P(n(11228)),m=P(n(97236)),O=P(n(6231)),A=P(n(28450)),R=P(n(21506)),b=P(n(92609)),N=P(n(32466)),M=P(n(9638)),w=P(n(58422));function P(e){return e&&e.__esModule?e:{default:e}}},74089:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};const r=new Uint8Array(16)},74121:(e,t,n)=>{"use strict";var r=n(16712),o=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw new a("Can't set "+o(e)+" as a prototype")}},74133:(e,t,n)=>{var r=n(90313),o=n(3334),a=n(23945),i=n(15630),s=n(65406),c=n(98087),l=a(function(e){var t=c(e);return s(t)&&(t=void 0),i(r(e,1,s,!0),o(t,2))});e.exports=l},74320:(e,t,n)=>{"use strict";var r=n(97509);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},74416:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,o=r&&!n.call({1:2},1);t.f=o?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},74418:(e,t,n)=>{"use strict";var r=n(16881),o=n(83628),a=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return a(o(e),t)}},74530:(e,t,n)=>{"use strict";var r=n(16881),o=n(5234),a=n(14188),i=n(74418),s=n(96893),c=n(92735).CONFIGURABLE,l=n(13029),u=n(43086),d=u.enforce,f=u.get,p=String,g=Object.defineProperty,_=r("".slice),E=r("".replace),y=r([].join),S=s&&!o(function(){return 8!==g(function(){},"length",{value:8}).length}),v=String(String).split("String"),h=e.exports=function(e,t,n){"Symbol("===_(p(t),0,7)&&(t="["+E(p(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||c&&e.name!==t)&&(s?g(e,"name",{value:t,configurable:!0}):e.name=t),S&&n&&i(n,"arity")&&e.length!==n.arity&&g(e,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?s&&g(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=d(e);return i(r,"source")||(r.source=y(v,"string"==typeof t?t:"")),e};Function.prototype.toString=h(function(){return a(this)&&f(this).source||l(this)},"toString")},74535:(e,t,n)=>{var r=n(46285),o=n(36529),a=n(69632),i=n(41580);e.exports=function(e,t,n){if(!i(n))return!1;var s=typeof t;return!!("number"==s?o(n)&&a(t,n.length):"string"==s&&t in n)&&r(n[t],e)}},74582:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=async function(e){const{context:t,logManager:n,WebRTC:o,WebRTCMediaOperations:a}=e;n.getLogger("WEBRTC").info("Cleaning up webrtc plugin.");const i=(0,r.getDetachedMedia)(t.getState());await Promise.all([...i.map(e=>Promise.all(e.tracks.map(e=>a.disposeLocalMedia(e)))),o.devices.cleanup(),o.peerManager.cleanup()])},n(81045),n(84915);var r=n(69260)},74603:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(74089))&&r.__esModule?r:{default:r},a=n(46585);let i,s,c=0,l=0;t.default=function(e,t,n){let r=t&&n||0;const u=t||new Array(16);let d=(e=e||{}).node||i,f=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==f){const t=e.random||(e.rng||o.default)();null==d&&(d=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==f&&(f=s=16383&(t[6]<<8|t[7]))}let p=void 0!==e.msecs?e.msecs:Date.now(),g=void 0!==e.nsecs?e.nsecs:l+1;const _=p-c+(g-l)/1e4;if(_<0&&void 0===e.clockseq&&(f=f+1&16383),(_<0||p>c)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,l=g,s=f,p+=122192928e5;const E=(1e4*(268435455&p)+g)%4294967296;u[r++]=E>>>24&255,u[r++]=E>>>16&255,u[r++]=E>>>8&255,u[r++]=255&E;const y=p/4294967296*1e4&268435455;u[r++]=y>>>8&255,u[r++]=255&y,u[r++]=y>>>24&15|16,u[r++]=y>>>16&255,u[r++]=f>>>8|128,u[r++]=255&f;for(let e=0;e<6;++e)u[r+e]=d[e];return t||(0,a.unsafeStringify)(u)}},74784:(e,t,n)=>{var r=n(3766)(Object.getPrototypeOf,Object);e.exports=r},74786:(e,t,n)=>{"use strict";var r=n(5613),o=n(38873),a=n(44977),i=n(3770),s=n(96002),c=n(88500),l=n(20850),u=n(40646),d=n(5234),f=TypeError,p=d(function(){[].keys().reduce(function(){},void 0)}),g=!p&&l("reduce",f);r({target:"Iterator",proto:!0,real:!0,forced:p||g},{reduce:function(e){i(this);try{a(e)}catch(e){c(this,"throw",e)}var t=arguments.length<2,n=t?void 0:arguments[1];if(g)return u(g,this,t?[e]:[e,n]);var r=s(this),l=0;if(o(r,function(r){t?(t=!1,n=r):n=e(n,r,l),l++},{IS_RECORD:!0}),t)throw new f("Reduce of empty iterator with no initial value");return n}})},74825:(e,t,n)=>{"use strict";function r(e,t,n,r,o,a){if(!e.dtmf)return a.debug("The sender requires DTMF which is not support by this browser."),!1;{const i=e.dtmf;i.ontonechange=o||function(e){""!==e.tone?a.debug("Tone played: "+e.tone):a.debug("All tones have played.")};try{return i.insertDTMF(t,n,r),!0}catch(e){return a.debug(e.message),!1}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let{tone:n,duration:o=100,intertoneGap:a=70}=e,{callback:i,trackId:s}=t;const{proxyPeer:c,log:l}=this;if(l.info("Sending DTMF tones.",n),!c.getSenders)return l.info("Failed to send tones; getSenders is not supported by this browser."),!1;const u=c.getSenders();if(s){const e=u.find(e=>e.track.id===s);return e?(r(e,n,o,a,i,l),!0):(l.info(`Failed to send tones; could not find track ${s}.`),!1)}{let e;for(let t=0;t<u.length;t++)if(e=r(u[t],n,o,a,i,l),e)return!0;return l.info("Failed to send tones; could not find an appropriate track."),!1}},n(81045),n(45950)},74839:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{proxyPeer:t,iceTimer:n,iceCandidates:r,emitter:o,config:a}=e,i=n.timeFromStart();o.emit("scheduledCheck",{iceCollectionDuration:i,iceCandidates:r,iceGatheringState:t.iceGatheringState,rtcPeerConnectionConfig:a,rtcLocalSessionDescription:t.localDescription})}},74967:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},75071:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.playAudioFile",()=>({local:{validate:o.default,localOffer:(0,r.default)(e.container)}})),e.factory("Callstack.operations.playAudioFile",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.PLAY_AUDIO,isLocal:!0,stages:e.container.Callstack.stages.playAudioFile.local},{callId:n})}}})};var r=i(n(98415)),o=i(n(85917)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},75170:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.addMedia",()=>{const t=(0,r.default)(e.container),n=(0,c.default)(e.container);return{local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,l.default)(e.container),rollback:(0,i.default)(e.container)},remote:{remoteOffer:n.localChanges,signalling:n.signalling}}}),e.factory("Callstack.stages.addBasicMedia",()=>{const t=(0,r.default)(e.container);return{local:{validate:s.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,l.default)(e.container),rollback:(0,i.default)(e.container)}}}),e.factory("Callstack.operations.addMedia",()=>{const t=e.container.Callstack,n=t.models.Negotiation;function r(e){return(r,o)=>{const a=t.stages.addMedia[e?"local":"remote"];return n.instance({type:u.OPERATIONS.ADD_MEDIA,isLocal:e,stages:a},{callId:r,deferred:o})}}return{local:r(!0),remote:r(!1)}}),e.factory("Callstack.operations.addBasicMedia",()=>{const t=e.container.Callstack.models.Negotiation;return{local:(n,r)=>t.instance({type:u.OPERATIONS.ADD_BASIC_MEDIA,isLocal:!0,stages:e.container.Callstack.stages.addBasicMedia.local},{callId:n,deferred:r})}}),e.factory("Callstack.utils.webrtcAddMedia",()=>(0,a.default)(e.container)),e.factory("Callstack.utils.rollbackAddMedia",()=>(0,i.default)(e.container))};var r=d(n(48349)),o=d(n(1306)),a=d(n(49676)),i=d(n(17077)),s=d(n(35730)),c=d(n(34705)),l=d(n(12540)),u=n(59090);function d(e){return e&&e.__esModule?e:{default:e}}},75188:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeLevel=t.logMethods=t.logLevels=t.levelValues=void 0;const n=t.logLevels={TRACE:"TRACE",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",SILENT:"SILENT"};t.levelValues={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},t.logMethods={trace:n.TRACE,debug:n.DEBUG,info:n.INFO,warn:n.WARN,error:n.ERROR,log:n.DEBUG,group:n.DEBUG,groupEnd:n.DEBUG,groupCollapsed:n.DEBUG},t.timeLevel=n.DEBUG},75234:(e,t,n)=>{var r=n(86912),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var a=arguments,i=-1,s=o(a.length-t,0),c=Array(s);++i<s;)c[i]=a[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=a[i];return l[t]=n(c),r(e,this,l)}}},75366:(e,t,n)=>{"use strict";var r=n(88500);e.exports=function(e,t,n){for(var o=e.length-1;o>=0;o--)if(void 0!==e[o])try{n=r(e[o].iterator,t,n)}catch(e){t="throw",n=e}if("throw"===t)throw n;return n}},75382:(e,t,n)=>{"use strict";var r=n(88088),o=n(87308),a=n(14582),i=Error.captureStackTrace;e.exports=function(e,t,n,s){a&&(i?i(e,t):r(e,"stack",o(n,s)))}},75412:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NO_CODE=void 0,Object.defineProperty(t,"authCodes",{enumerable:!0,get:function(){return r.authCodes}}),Object.defineProperty(t,"bridgeCodes",{enumerable:!0,get:function(){return r.bridgeCodes}}),Object.defineProperty(t,"callCodes",{enumerable:!0,get:function(){return r.callCodes}}),Object.defineProperty(t,"callHistoryCodes",{enumerable:!0,get:function(){return r.callHistoryCodes}}),Object.defineProperty(t,"clickToCallCodes",{enumerable:!0,get:function(){return r.clickToCallCodes}}),t.default=void 0,Object.defineProperty(t,"groupsCodes",{enumerable:!0,get:function(){return r.groupsCodes}}),Object.defineProperty(t,"messagingCodes",{enumerable:!0,get:function(){return r.messagingCodes}}),Object.defineProperty(t,"mwiCodes",{enumerable:!0,get:function(){return r.mwiCodes}}),Object.defineProperty(t,"presenceCodes",{enumerable:!0,get:function(){return r.presenceCodes}}),Object.defineProperty(t,"proxyCodes",{enumerable:!0,get:function(){return r.proxyCodes}}),Object.defineProperty(t,"sipEventCodes",{enumerable:!0,get:function(){return r.sipEventCodes}}),Object.defineProperty(t,"subscriptionCodes",{enumerable:!0,get:function(){return r.subscriptionCodes}}),Object.defineProperty(t,"usersCodes",{enumerable:!0,get:function(){return r.usersCodes}}),Object.defineProperty(t,"webrtcCodes",{enumerable:!0,get:function(){return r.webrtcCodes}});var r=n(88058);const o=t.NO_CODE="NO_CODE";t.default=class{constructor(e){let{message:t,code:n}=e;this.name="BasicError",this.code=n||o,this.message=t?`${t}`:"An error occurred."}}},75424:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeMediaDirection=function(e){let{audio:t,video:n}=e;function r(e){return Object.values(o.MEDIA_DIR).includes(e)}return(e,o,a)=>(e.media.forEach(e=>{"audio"===e.type&&r(t)?e.direction=t:"video"===e.type&&r(n)&&(e.direction=n)}),e)},t.preventDtlsRoleChange=function(e,t,n){if("local"===t.endpoint&&"answer"===t.type)for(const n of e.media)n.setup&&t.dtlsRole&&n.setup!==t.dtlsRole&&(a.debug(`Changing DTLS role from ${n.setup} to ${t.dtlsRole}.`),n.setup=t.dtlsRole);return e},t.removeBundling=function(e,t,n){return e.groups&&(a.debug("Removing SDP bundling groups."),delete e.groups),e},t.removeTrickleIce=function(e,t,n){return e.media.forEach(e=>{"trickle"===e.iceOptions&&(a.debug(`Removing trickle ICE option from ${e.type} media.`),delete e.iceOptions)}),e},n(62234),n(81045),n(5350);var r=n(40271),o=n(54507);const a=r.logManager.getLogger("SdpPipeline")},75650:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{proxyPeer:t}=this;return t.getTransceivers().find(t=>null==t.sender.track&&t.receiver&&t.receiver.track&&t.receiver.track.kind===e&&"stopped"!==t.currentDirection)},n(81045),n(45950)},75853:(e,t,n)=>{e=n.nmd(e);var r=n(78942),o=n(34772),a=t&&!t.nodeType&&t,i=a&&e&&!e.nodeType&&e,s=i&&i.exports===a?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||o;e.exports=c},75857:(e,t,n)=>{var r=n(90313);e.exports=function(e){return null!=e&&e.length?r(e,1):[]}},75962:e=>{e.exports=function(){}},75964:(e,t,n)=>{var r=n(39747),o=n(74784),a=n(84882);e.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:r(o(e))}},75976:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallRequests:n,CallstackWebrtc:s,emitEvent:c,logManager:l}=e;return async function(e,u){const d=l.getLogger("CALL",e.id);d.info("Received session status completed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId});const{reasonText:f,statusCode:p}=u;if(f){let e;e=p||0===p?p:a.STATUS_CODES.DIRECT_TRANSFER_SUCCESS,d.debug(`Session completed notice caused by ${f} (${e}).`)}d.info(`Ending webRTC session with id: ${e.webrtcSessionId}, locally ...`),await s.closeCall(e.webrtcSessionId),t.dispatch(r.callActions.directTransferFinish(e.id,{transition:{reasonText:a.COMPLEX_OPERATION_MESSAGES.DIRECT_TRANSFER_SUCCESS,statusCode:a.STATUS_CODES.DIRECT_TRANSFER_SUCCESS}}));try{d.debug("Ending call session on server-side."),await n.endSession({callId:e.id,wrtcsSessionId:e.wrtcsSessionId,isAnonymous:e.isAnonymous,account:e.account})}catch(e){d.debug(`Error received when attempting to end the session: ${e}.`)}finally{d.info(`Finished ending call. Changing call state to ${a.CALL_STATES.ENDED}.`),t.dispatch(r.callActions.endCallFinish(e.id,(0,i.generateEndParams)(e.state,!0,u))),c(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}})}}};var r=n(35),o=n(51918),a=n(77126),i=n(69752)},76207:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createHandler=f,t.default=function(e){const{WebRTC:t}=e,n=f(e);(0,r.default)(t.devices,n),(0,o.default)(t.track,n),(0,i.default)(t.media,n),(0,a.default)(t.sessionManager,n)};var r=d(n(42140)),o=d(n(91173)),a=d(n(68244)),i=d(n(70620)),s=n(51709),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997)),l=n(51918),u=n(40481);function d(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(t,n){try{e.context.getState()}catch(e){return}if(t){const n=function(e,t){switch(t.type){case c.SESSION_ICE_CONNECTION_STATE_CHANGE:{const n=(0,u.getCallByWebrtcSessionId)(e.getState(),t.payload.id);if(n)return{type:l.MEDIA_CONNECTION_CHANGE,args:{callId:n.id,previous:{state:n.mediaConnectionState}}};break}case c.SESSION_TRACK_ENDED:{const{trackId:n,local:r,isUnsolicited:o,id:a}=t.payload;if(r&&o){const t=(0,u.getCallByWebrtcSessionId)(e.getState(),a);return{type:s.TRACK_ENDED,args:{callId:t.id,trackId:n,isLocal:r}}}break}}}(e.context,t);e.context.dispatch(t),n&&e.emitEvent(n.type,n.args)}n&&e.emitEvent(n.type,n.args)}}},76208:(e,t,n)=>{"use strict";var r=n(5604),o=n(74418),a=n(88088),i=n(4578),s=n(5054),c=n(98657),l=n(78679),u=n(44166),d=n(69866),f=n(98257),p=n(75382),g=n(96893),_=n(1942);e.exports=function(e,t,n,E){var y="stackTraceLimit",S=E?2:1,v=e.split("."),h=v[v.length-1],T=r.apply(null,v);if(T){var C=T.prototype;if(!_&&o(C,"cause")&&delete C.cause,!n)return T;var I=r("Error"),m=t(function(e,t){var n=d(E?t:e,void 0),r=E?new T(e):new T;return void 0!==n&&a(r,"message",n),p(r,m,r.stack,2),this&&i(C,this)&&u(r,this,m),arguments.length>S&&f(r,arguments[S]),r});if(m.prototype=C,"Error"!==h?s?s(m,I):c(m,I,{name:!0}):g&&y in T&&(l(m,T,y),l(m,T,"prepareStackTrace")),c(m,T),!_)try{C.name!==h&&a(C,"name",h),C.constructor=m}catch(e){}return m}}},76224:e=>{"use strict";e.exports=function(e,t){return{value:e,done:t}}},76555:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserDetails=function(){return o.default.browserDetails},t.makeSafeForCSS=function(e){return e?e.replace(/[^a-z0-9]/g,""):e};var r,o=(r=n(89339))&&r.__esModule?r:{default:r}},76648:e=>{e.exports={cap:!1,curry:!1,fixed:!1,immutable:!1,rearg:!1}},76744:(e,t,n)=>{"use strict";var r=n(60142);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},76765:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=[];return e.value("Notifications.takeAction",function(e,n){if("string"==typeof e){const t=e;e=e=>e.type===t}return new Promise((r,o)=>{let a;"number"==typeof n&&(a=setTimeout(o,n)),t.push({singleTake:!0,pattern:e,callback:r,timeoutId:a})})}),e.value("Notifications.takeEveryAction",function(e,n){if("string"==typeof e){const t=e;e=e=>e.type===t}if("function"!=typeof e||"function"!=typeof n)throw new Error("takeEveryAction parametesr must be functions.");t.push({singleTake:!1,pattern:e,callback:n})}),e=>e=>n=>{const r=e(n);let o=t.length;for(;o--;){const e=t[o];e.pattern(n)&&(e.singleTake&&(t.splice(o,1),e.timeoutId&&clearTimeout(e.timeoutId)),e.callback(n))}return r}},n(97107),n(69375)},76853:(e,t,n)=>{var r=n(69011);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},76857:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n}=e;return function(e,i){const s=i.reasonText||o.COMPLEX_OPERATION_MESSAGES.JOIN_FAILURE,c=i.statusCode||o.STATUS_CODES.JOIN_FAILURE,l=n.getLogger("CALL",e.id);l.info("Received call operation failed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId}),l.debug(`Processing as a local join failure (${c}).`),l.info("Finished handling call operation failed notice.");const u=new a.default({message:`Join operation failed: ${s} (${c})`,code:a.callCodes.GENERIC_ERROR});return t.dispatch(r.callActions.joinFinish(e.id,{error:u,transition:{reasonText:s,statusCode:c}})),u}};var r=n(35),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},76931:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},77065:(e,t,n)=>{"use strict";var r,o=n(3770),a=n(30),i=n(61274),s=n(67588),c=n(67458),l=n(65926),u=n(40168),d="prototype",f="script",p=u("IE_PROTO"),g=function(){},_=function(e){return"<"+f+">"+e+"</"+f+">"},E=function(e){e.write(_("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;y="undefined"!=typeof document?document.domain&&r?E(r):(t=l("iframe"),n="java"+f+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(_("document.F=Object")),e.close(),e.F):E(r);for(var o=i.length;o--;)delete y[d][i[o]];return y()};s[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(g[d]=o(e),n=new g,g[d]=null,n[p]=e):n=y(),void 0===t?n:a.f(n,t)}},77126:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WEBRTC_DEVICE_KINDS=t.STATUS_CODES=t.OPERATIONS=t.ICE_COLLECTION_RESULT_TYPES=t.COMPLEX_OPERATION_MESSAGES=t.COMPLEX_OPERATIONS=t.CALL_STATES=t.CALL_MEDIA_STATES=t.CALL_MEDIA_CONNECTION_STATES=t.CALL_DIRECTION=void 0,t.CALL_STATES={INITIATING:"Initiating",INITIATED:"Initiated",EARLY_MEDIA:"Early Media",RINGING:"Ringing",CANCELLED:"Cancelled",CONNECTED:"Connected",ON_HOLD:"On Hold",ENDED:"Ended"},t.CALL_MEDIA_STATES={CONNECTED:"Connected",LOCAL_HOLD:"Local Hold",REMOTE_HOLD:"Remote Hold",DUAL_HOLD:"Dual Hold"},t.CALL_MEDIA_CONNECTION_STATES={NEW:"new",CHECKING:"checking",CONNECTED:"connected",COMPLETED:"completed",FAILED:"failed",DISCONNECTED:"disconnected",CLOSED:"closed"},t.OPERATIONS={CHANGE_MEDIA:"Change Media",HOLD_MEDIA:"Hold Media",UNHOLD_MEDIA:"Unhold Media",MUSIC_ON_HOLD:"Music on hold"},t.COMPLEX_OPERATIONS={DIRECT_TRANSFER:"Direct Transfer",CONSULTATIVE_TRANSFER:"Consultative Transfer",JOIN:"Join"},t.COMPLEX_OPERATION_MESSAGES={DIRECT_TRANSFER_SUCCESS:"Direct Transfer Successful",CONSULTATIVE_TRANSFER_SUCCESS:"Transfer Successful",JOIN_SUCCESS:"Join Successful",DIRECT_TRANSFER_FAILURE:"Direct Transfer Failed",CONSULTATIVE_TRANSFER_FAILURE:"Transfer Failed",JOIN_FAILURE:"Join Failed"},t.STATUS_CODES={DIRECT_TRANSFER_SUCCESS:9905,CONSULTATIVE_TRANSFER_SUCCESS:9905,JOIN_SUCCESS:9906,DIRECT_TRANSFER_FAILURE:-1,CONSULTATIVE_TRANSFER_FAILURE:-1,JOIN_FAILURE:-2},t.CALL_DIRECTION={INCOMING:"incoming",OUTGOING:"outgoing"},t.WEBRTC_DEVICE_KINDS={audioinput:"microphone",videoinput:"camera",audiooutput:"speaker"},t.ICE_COLLECTION_RESULT_TYPES={START_CALL:"StartCall",WAIT:"Wait",ERROR:"Error"}},77317:(e,t,n)=>{var r=n(3334),o=n(36529),a=n(81211);e.exports=function(e){return function(t,n,i){var s=Object(t);if(!o(t)){var c=r(n,3);t=a(t),n=function(e){return c(s[e],e,s)}}var l=e(t,n,i);return l>-1?s[c?t[l]:l]:void 0}}},77406:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{localChanges:(t,n)=>a(e,t,n),signalling:(t,n)=>i(e,t,n)}},t.localChanges=a,t.signalling=i;var r=n(73520),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(50527));async function a(e,t,n){const{WebRTC:o,CallstackWebrtc:a,logManager:i}=e,s=i.getLogger("CALL",t.id),c=(0,r.getMediaState)(t);s.info(`Processing slow-start update request from remote endpoint. Call state: ${t.state}, MediaState: ${c}.`),s.debug(`Recreating Peer for Session ${t.webrtcSessionId}.`);const l=await o.sessionManager.get(t.webrtcSessionId);await l.recreatePeer();const u={audio:t.localHold?"inactive":"sendrecv",video:t.localHold?"inactive":"sendrecv"};let d;try{d=await a.generateOffer(t.webrtcSessionId,u)}catch(e){throw s.info("Failed to respond to slow-start remote update.",e),e}return{slowOffer:d,...n}}async function i(e,t,n){const{context:r,CallRequests:a,logManager:i}=e,{slowOffer:s,remoteNumber:c,remoteName:l}=n,u=i.getLogger("CALL",t.id);try{await a.updateSessionResponse({wrtcsSessionId:t.wrtcsSessionId,answer:s.sdp,isAnonymous:t.isAnonymous,account:t.account,customParameters:t.customParameters,customBodies:t.customBodies}),r.dispatch(o.remoteSlowStart(t.id,{remoteParticipant:{displayNumber:c,displayName:l}})),u.info("Finished responding to slow-start remote update. Waiting on remote response.")}catch(e){throw r.dispatch(o.remoteSlowStart(t.id,{remote:!0,error:e})),u.info("Failed to respond to slow-start remote update.",e),e}}},77484:(e,t,n)=>{var r=n(90313),o=n(23945),a=n(15630),i=n(65406),s=n(98087),c=o(function(e){var t=s(e);return t="function"==typeof t?t:void 0,a(r(e,1,i,!0),void 0,t)});e.exports=c},77769:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkOptions=t.applyDefaults=void 0,t.default=function(e){if(e=u(e),l(e),"string"==typeof e.method){const t=e.method;e.method={type:t,responsibleParty:a.connCheckResponsibility.CLIENT}}return e},t.defaultValues=void 0;var r,o=(r=n(38142))&&r.__esModule?r:{default:r},a=n(81953),i=n(52932);const s=t.defaultValues={method:a.connCheckMethods.KEEP_ALIVE,pingInterval:3e4,reconnectLimit:5,reconnectDelay:5e3,reconnectTimeMultiplier:1,reconnectTimeLimit:64e4,autoReconnect:!0,checkConnectivity:!0,webSocketOAuthMode:"none"},c=i.validation.schema({method:(0,i.enums)([a.connCheckMethods.KEEP_ALIVE]),pingInterval:i.validation.positive(),reconnectLimit:i.validation.positive(),reconnectDelay:i.validation.positive(),reconnectTimeMultiplier:i.validation.positive(),reconnectTimeLimit:i.validation.positive(),autoReconnect:i.validation.boolean(),checkConnectivity:i.validation.boolean(),webSocketOAuthMode:(0,i.enums)(["none","query"])}),l=t.checkOptions=(0,i.parse)("connectivity",c),u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.default)(s,e)};t.applyDefaults=u},77839:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return a(e)||s(e)?o.OPERATIONS.HOLD:i(e)||c(e)?o.OPERATIONS.UNHOLD:d(e)?o.OPERATIONS.START_MOH:l(e)?o.OPERATIONS.ADD_MEDIA:f(e)?o.OPERATIONS.STOP_MOH:u(e)?o.OPERATIONS.REMOVE_MEDIA:p(e)?"NO_CHANGE":"UNKNOWN"},t.hadMediaFlowing=g,t.hasMediaFlowing=_,t.was3xHold=s,t.was3xUnhold=c,t.wasAddMedia=l,t.wasHold=a,t.wasNoChange=p,t.wasRemoveMedia=u,t.wasStartMoh=d,t.wasStopMoh=f,t.wasUnhold=i,n(81045),n(42042),n(9925);var r=n(69540),o=n(59090);function a(e){const{added:t,removed:n,changed:o,unchanged:a}=e,i=g(e)&&!_(e),s=!t.some(e=>e.willSend||e.willReceive),c=0===n.length,l=o.length>0,u=o.every(e=>{let{media:t,changes:n}=e;const o=n.sending===r.MEDIA_TRANSITIONS.STOP||n.sending===r.MEDIA_TRANSITIONS.SAME&&!t.willSend,a=n.receiving===r.MEDIA_TRANSITIONS.STOP||n.receiving===r.MEDIA_TRANSITIONS.SAME&&!t.willReceive;return o&&a}),d=a.every(e=>!e.willSend&&!e.willReceive);return i&&s&&c&&l&&u&&d}function i(e){const{added:t,removed:n,changed:o,unchanged:a}=e,i=!g(e)&&_(e),s=0===t.length&&0===n.length,c=a.every(e=>!e.willSend&&!e.willReceive),l=o.length>0,u=o.every(e=>{let{media:t,changes:n}=e;const o=n.sending===r.MEDIA_TRANSITIONS.START||n.sending===r.MEDIA_TRANSITIONS.SAME&&!t.willSend,a=n.receiving===r.MEDIA_TRANSITIONS.START||n.receiving===r.MEDIA_TRANSITIONS.SAME&&!t.willReceive;return o&&a});return i&&s&&c&&l&&u}function s(e){const{added:t,removed:n,changed:o,unchanged:a}=e,i=g(e),s=o.every(e=>{let{media:t,changes:n}=e;return"audio"===t.type?n.receiving===r.MEDIA_TRANSITIONS.STOP&&n.sending===r.MEDIA_TRANSITIONS.SAME:n.receiving===r.MEDIA_TRANSITIONS.STOP||n.receiving===r.MEDIA_TRANSITIONS.SAME&&!1===t.willReceive}),c=!t.some(e=>e.willSend||e.willReceive),l=0===n.length,u=a.every(e=>!e.willSend&&!e.willReceive||"video"===e.type&&e.willSend&&!e.willReceive);return i&&s&&c&&l&&u}function c(e){const{added:t,removed:n,changed:o,unchanged:a}=e,i=_(e),s=o.every(e=>{let{media:t,changes:n}=e;return n.sending===r.MEDIA_TRANSITIONS.SAME&&n.receiving===r.MEDIA_TRANSITIONS.START||"video"===t.type&&n.sending===r.MEDIA_TRANSITIONS.START&&n.receiving===r.MEDIA_TRANSITIONS.START}),c=0===t.length&&0===n.length,l=a.every(e=>!e.willSend&&!e.willReceive);return i&&s&&c&&l}function l(e){const{added:t,removed:n,changed:o}=e,a=0===n.length,i=t.length>0||o.length>0,s=t.every(e=>e.willSend),c=o.every(e=>{let{media:t,changes:n}=e;return n.sending===r.MEDIA_TRANSITIONS.START&&(n.receiving===r.MEDIA_TRANSITIONS.SAME||n.receiving===r.MEDIA_TRANSITIONS.START)});return a&&i&&s&&c}function u(e){const{added:t,removed:n,changed:o}=e,a=0===t.length,i=0===n.length,s=o.length>0,c=o.every(e=>{let{media:t,changes:n}=e;return n.sending===r.MEDIA_TRANSITIONS.STOP&&n.receiving!==r.MEDIA_TRANSITIONS.STOP});return a&&i&&s&&c}function d(e){const{added:t,removed:n,changed:o,unchanged:a}=e;if(!l(e))return!1;const i=1===o.length&&"audio"===o[0].media.type&&o[0].changes.sending===r.MEDIA_TRANSITIONS.START&&o[0].changes.receiving===r.MEDIA_TRANSITIONS.SAME&&!o[0].media.willReceive,s=0===t.length&&0===n.length,c=a.every(e=>!e.willSend&&!e.willReceive);return s&&c&&i}function f(e){const{added:t,removed:n,changed:o,unchanged:a}=e;if(!u(e))return!1;const i=1===o.length&&"audio"===o[0].media.type&&o[0].changes.sending===r.MEDIA_TRANSITIONS.STOP&&o[0].changes.receiving===r.MEDIA_TRANSITIONS.SAME&&!o[0].media.willReceive,s=0===t.length&&0===n.length,c=a.every(e=>!e.willSend&&!e.willReceive);return s&&c&&i}function p(e){const{added:t,removed:n,changed:r,unchanged:o}=e,a=0===t.length&&0===n.length&&0===r.length,i=o.length>0;return a&&i}function g(e){const{removed:t,changed:n,unchanged:o}=e,a=o.some(e=>e.willSend&&e.willReceive),i=n.some(e=>{let{media:t,changes:n}=e;const o=n.sending===r.MEDIA_TRANSITIONS.STOP||n.sending===r.MEDIA_TRANSITIONS.SAME&&t.willSend,a=n.receiving===r.MEDIA_TRANSITIONS.STOP||n.receiving===r.MEDIA_TRANSITIONS.SAME&&t.willReceive;return o&&a}),s=t.some(e=>e.willSend&&e.willReceive);return a||i||s}function _(e){const{added:t,changed:n,unchanged:r}=e,o=r.some(e=>e.willSend&&e.willReceive),a=n.some(e=>{let{media:t,changes:n}=e;return t.willSend&&t.willReceive}),i=t.some(e=>e.willSend&&e.willReceive);return o||a||i}},77848:(e,t,n)=>{var r=n(23945),o=n(74535);e.exports=function(e){return r(function(t,n){var r=-1,a=n.length,i=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(a--,i):void 0,s&&o(n[0],n[1],s)&&(i=a<3?void 0:i,a=1),t=Object(t);++r<a;){var c=n[r];c&&e(t,c,r,i)}return t})}},77979:(e,t,n)=>{var r=n(79847),o=n(99306),a=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(e){return null==e?[]:(e=Object(e),r(i(e),function(t){return a.call(e,t)}))}:o;e.exports=s},78039:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WS_STATUS=void 0,t.WS_STATUS={CONNECTED:"CONNECTED",CONNECTING:"CONNECTING",RECONNECTING:"RECONNECTING",NO_SOCKET:"NO_SOCKET"}},78340:e=>{var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},78641:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,r=t.getLogger("SUBSCRIPTION");return async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c={method:"POST",endpoint:"subscription"};c.body=JSON.stringify({subscribeRequest:{expires:e,service:t,localization:"English_US",useTurn:!0,notificationType:"WebSocket",supported:["RingingFeedback"],clientCorrelator:s.clientCorrelator}}),c=(0,a.default)(s,c);const l=await n(c),{body:u,error:d,result:f}=l;if(d){let e=i.authCodes.SUBSCRIBE_FAIL;if(u){let t,n;u.statusCode&&u.reason?(t=u.statusCode,503===t&&(n=u.retryAfter,e=i.authCodes.SUBSCRIBE_UNAVAILABLE)):u.subscribeResponse&&(t=u.subscribeResponse.statusCode,503===t&&(n=u.subscribeResponse.retryAfter,e=i.authCodes.SUBSCRIBE_UNAVAILABLE)),r.debug(`Failed user subscription with status code ${t}.`);const o={message:`Failed to subscribe user. Status Code: ${t}.`,code:e},a={error:new i.default(o)};return n&&n>0&&(a.retryAfter=n),a}return r.debug("Failed user subscription.",f.message),{error:new i.default({message:`Subscribe request failed: ${f.message}.`,code:e})}}{const e=u.subscribeResponse,n=e.subscriptionParams.service,a=(0,o.parseSpidrServices)(t,n);return r.debug(`Subscribed user. Service subscription status: ${a.status}`),{error:!1,servicesInfo:a,...e}}}};var r,o=n(22507),a=(r=n(7485))&&r.__esModule?r:{default:r},i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},78679:(e,t,n)=>{"use strict";var r=n(64466).f;e.exports=function(e,t,n){n in e||r(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})}},78763:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},78817:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"createMixins",{enumerable:!0,get:function(){return o.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return a.default}});var r=i(n(51465)),o=i(n(8703)),a=i(n(54980));function i(e){return e&&e.__esModule?e:{default:e}}t.name="messaging"},78942:(e,t,n)=>{var r=n(74967),o="object"==typeof self&&self&&self.Object===Object&&self,a=r||o||Function("return this")();e.exports=a},78958:e=>{"use strict";e.exports=function(e,t,n,r,o,a,i,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,a,i,s],u=0;(c=new Error(t.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},79067:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},79071:e=>{e.exports=function(){}},79117:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},79130:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=e.container.CallOperations;return async function(n){o(n)&&(await t.setTurnCredentials(n),await e.container.Callstack.utils.createEarlyPeer())}},t.shouldHandlePattern=o;var r=n(34721);function o(e){return!(e.error||e.type!==r.SUBSCRIBE_FINISHED||!e.payload.subscriptions||!e.payload.subscriptions.length||!e.payload.subscriptions[0].turnCredentials)}},79317:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="connectivity"},79345:(e,t,n)=>{"use strict";var r={};r[n(4282)("toStringTag")]="z",e.exports="[object z]"===String(r)},79616:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setBrowserDetails=function(e){return{type:r.SET_BROWSER_DETAILS,payload:e}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997))},79847:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[o++]=i)}return a}},79908:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=r.logManager.getLogger("Manager","Peer"),n=e.trackManager,s=new Map;let c;const l=new i.default;function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=s.get(c);return t?(c=void 0,setTimeout(()=>d(e),1)):(t=new o.default((0,a.v4)(),e,n),t.once("peer:closed",e=>s.delete(e)),s.set(t.id,t),l.emit("peer:new",t.id)),t}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=s.get(c);n&&n.close(),c=void 0;try{const t=u(e);c=t.id}catch(e){t.info("Failed to create an early PeerConnection: ",e.message)}}function f(e){const n=s.get(e);return n||t.debug(`No Peer found with ID: ${e}.`),n}function p(){return Array.from(s.keys())}return{getState:function(){return p().map(e=>f(e).getState())},get:f,getAll:p,create:u,createEarly:d,cleanup:function(){const e=s.get(c);e&&(t.debug("Cleaning up early Peer with id: ",c),e.close()),c=void 0},on:function(){return l.on(...arguments)},once:function(){return l.once(...arguments)},off:function(){return l.off(...arguments)}}},n(81045),n(84915);var r=n(40271),o=s(n(11655)),a=n(84596),i=s(n(19353));function s(e){return e&&e.__esModule?e:{default:e}}},79968:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},80088:(e,t,n)=>{var r=n(44700);e.exports=function(e){return r(this,e).get(e)}},80328:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallHistoryRequests:o}=e,a=n.getLogger("CALLHISTORY");return async function(e){a.info("Attempting to remove call log(s):",e);try{await o.removeCallLogs(e),a.info("Successfully removed log(s) from call history."),t.dispatch(r.removeCallLogsFinish({recordId:e}))}catch(e){throw t.dispatch(r.removeCallLogsFinish({error:e})),e}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(31122))},80393:(e,t,n)=>{var r=n(48244),o=n(77979),a=n(81211);e.exports=function(e){return r(e,a,o)}},80406:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{nativePeer:e}=this,t=e.localDescription;return t&&t.sdp&&t.type?t:void 0}},80547:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},80621:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:l,CallstackWebrtc:u,CallReporter:d,WebRTC:f}=e;return async function(e,p){const g=n.getLogger("CALL",e.id),_=d.getReport(e.id),E=e.currentOperations.find(e=>e.isLocal&&[a.OPERATIONS.MAKE,a.OPERATIONS.MAKE_ANONYMOUS,a.OPERATIONS.JOIN].includes(e.type)),y=_.getEvent(E.eventId).addEvent(c.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);y.addData("operation",a.OPERATIONS.MAKE);try{const t={sessionId:e.webrtcSessionId,answerSdp:p.sdp};await u.receivedAnswer(t,e)}catch(n){return t.dispatch(r.callActions.endCallFinish(e.id,{error:n})),l(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),l(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold},error:n}),y.setError(n),void y.endEvent()}g.info(`Finished processing remote response to local ${E.type}. Changing state based on operation.`);const S=await f.sessionManager.get(e.webrtcSessionId),v=await(0,s.getAllRemoteTracks)(S);t.dispatch(r.callActions.makeCallFinish(e.id,{state:i.CALL_STATES.CONNECTED,startTime:Date.now(),remoteParticipant:{displayNumber:p.remoteNumber,displayName:p.remoteName},remoteTracks:v})),l(o.CALL_TRACKS_ADDED,{callId:e.id,trackIds:v}),l(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}),y.endEvent()}},n(62234),n(81045),n(45950);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090),i=n(77126),s=n(48151),c=n(84581)},80678:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(94733)),o=a(n(96354));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"webrtc",api:r.default,reducer:o.default}},80777:(e,t,n)=>{var r=n(28486),o=n(80547);e.exports=function(e){return o(e)&&"[object Map]"==r(e)}},80796:(e,t,n)=>{var r=n(47403),o=n(3316)(r);e.exports=o},80831:(e,t,n)=>{"use strict";var r=n(14188);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},80850:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mediaNewTrack=function(e,t){return i(a.MEDIA_NEW_TRACK,e,t)},t.mediaTrackEnded=function(e,t){return i(a.MEDIA_TRACK_ENDED,e,t)},t.newMedia=function(e,t){return i(a.MEDIA_NEW,e,t)},t.removedMedia=function(e,t){return i(a.MEDIA_REMOVED,e,t)};var r,o=(r=n(84499))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997));function i(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a={type:e,payload:{...n,id:t}};return(0,o.default)(r)||(a.meta=r),n.error&&(a.error=!0),a}},80880:(e,t,n)=>{var r=n(92673)("join",n(9991));r.placeholder=n(22991),e.exports=r},80994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{WebRTC:t}=e,n=t.logs;return{updateLogLevel:async function(e){e.payload.WEBRTC&&(await n.setLevel(e.payload.WEBRTC),(await n.getLoggers()).map(t=>t.setLevel(e.payload.WEBRTC)))},updateLogHandler:async function(e){e.payload.WEBRTC&&(await n.setHandler(e.payload.WEBRTC),(await n.getLoggers()).map(t=>t.setHandler(e.payload.WEBRTC)))}}},n(81045),n(84915)},81045:(e,t,n)=>{"use strict";n(82438)},81175:(e,t,n)=>{var r=n(92673)("mergeAllWith",n(48875));r.placeholder=n(22991),e.exports=r},81211:(e,t,n)=>{var r=n(10358),o=n(195),a=n(36529);e.exports=function(e){return a(e)?r(e):o(e)}},81275:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t);return n?n.state===o.CALL_STATES.ENDED?new a.default({code:a.callCodes.INVALID_STATE,message:`Invalid call state: ${n.state}. It should be on-going.`}):void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},81322:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET_CACHE=t.FETCH_CALL_HISTORY_FINISH=t.FETCH_CALL_HISTORY=t.DELETE_CALL_HISTORY_FINISH=t.DELETE_CALL_HISTORY=t.ADD_CALL_HISTORY_ENTRY=void 0;const n="@@KANDY/";t.FETCH_CALL_HISTORY=n+"FETCH_CALL_HISTORY",t.FETCH_CALL_HISTORY_FINISH=n+"FETCH_CALL_HISTORY_FINISH",t.DELETE_CALL_HISTORY=n+"DELETE_CALL_HISTORY",t.DELETE_CALL_HISTORY_FINISH=n+"DELETE_CALL_HISTORY_FINISH",t.ADD_CALL_HISTORY_ENTRY=n+"ADD_CALL_HISTORY_ENTRY",t.SET_CACHE=n+"SET_CACHE"},81458:(e,t,n)=>{"use strict";var r=n(10380),o=n(70675),a=n(69389),i=function(e){return function(t,n,i){var s=r(t),c=a(s);if(0===c)return!e&&-1;var l,u=o(i,c);if(e&&n!=n){for(;c>u;)if((l=s[u++])!=l)return!0}else for(;c>u;u++)if((e||u in s)&&s[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:i(!0),indexOf:i(!1)}},81571:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,s){const c=(0,r.getCallById)(e,t);let l=(0,o.validateDestination)(c.to);if(!l)try{(0,a.validateMediaConstraints)(i)}catch(e){l=e}if(!l)try{(0,a.validateDetachedMedia)(i.medias)}catch(e){l=e}return l};var r=n(40481),o=n(25939),a=n(9066)},81586:(e,t,n)=>{var r=n(93526),o=n(98087),a=n(13398),i=n(66040);e.exports=function(e,t){return t=r(t,e),null==(e=a(e,t))||delete e[i(o(t))]}},81935:(e,t,n)=>{var r=n(28486),o=n(80547);e.exports=function(e){return o(e)&&"[object Set]"==r(e)}},81936:(e,t,n)=>{var r=n(77317)(n(92154));e.exports=r},81948:(e,t,n)=>{"use strict";var r=y(n(30744)),o=y(n(5007)),a=y(n(63702)),i=y(n(29799)),s=y(n(41768)),c=y(n(31270)),l=y(n(72937)),u=y(n(55318)),d=y(n(2195)),f=y(n(24011)),p=y(n(1940)),g=y(n(93914)),_=y(n(31486)),E=n(40449);function y(e){return e&&e.__esModule?e:{default:e}}const S=[...o.default.corePlugins,{name:"authentication",fn:a.default},{name:"subscription",fn:i.default},...o.default.commonPlugins,{name:"proxy",fn:_.default},{name:"call",fn:s.default},{name:"callHistory",fn:c.default},{name:"clickToCall",fn:l.default},{name:"messaging",fn:u.default},{name:"mwi",fn:d.default},{name:"presence",fn:f.default},{name:"sipEvents",fn:p.default},{name:"users",fn:g.default}];function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,r.default)(e,[...S,...t])}v.create=v,v.sdpHandlers={createCodecRemover:E.createCodecRemover},e.exports=v},81953:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connCheckResponsibility=t.connCheckMethods=void 0,t.connCheckResponsibility={CLIENT:"client",SERVER:"server"},t.connCheckMethods={KEEP_ALIVE:"keepAlive",PING_PONG:"pingPong"}},81997:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UNMUTE_TRACKS_FINISH=t.UNMUTE_TRACKS=t.TRACK_SOURCE_UNMUTED=t.TRACK_SOURCE_MUTED=t.TRACK_REMOVED=t.TRACK_ADDED=t.SET_BROWSER_DETAILS=t.SESSION_TRACK_REPLACED=t.SESSION_TRACK_ENDED=t.SESSION_REMOVED=t.SESSION_NEW_TRACK=t.SESSION_ICE_GATHERING_STATE_CHANGE=t.SESSION_ICE_CONNECTION_STATE_CHANGE=t.SESSION_ICE_COLLECTION_SCHEDULED_CHECK=t.SESSION_ICE_CANDIDATE_COLLECTED=t.SESSION_AUDIO_ENDED=t.SESSION_ADDED=t.RENDER_TRACKS_FINISH=t.RENDER_TRACKS=t.REMOVE_TRACKS_FINISH=t.REMOVE_TRACKS=t.MUTE_TRACKS_FINISH=t.MUTE_TRACKS=t.MEDIA_TRACK_ENDED=t.MEDIA_REMOVED=t.MEDIA_NEW_TRACK=t.MEDIA_NEW=t.MEDIA_CHANGE=t.INITIALIZE_DEVICES_FINISH=t.INITIALIZE_DEVICES=t.DEVICES_CHANGE=void 0;const n="@@KANDY/WEBRTC/",r=(t.DEVICES_CHANGE=n+"DEVICES/CHANGE",t.INITIALIZE_DEVICES=n+"INITIALIZE_DEVICES",t.INITIALIZE_DEVICES_FINISH=n+"INITIALIZE_DEVICES_FINISH",n+"TRACK/"),o=(t.TRACK_ADDED=r+"ADDED",t.TRACK_REMOVED=r+"REMOVED",t.RENDER_TRACKS=r+"RENDER",t.RENDER_TRACKS_FINISH=r+"RENDER_FINISH",t.REMOVE_TRACKS=r+"REMOVE",t.REMOVE_TRACKS_FINISH=r+"REMOVE_FINISH",t.MUTE_TRACKS=r+"MUTE",t.MUTE_TRACKS_FINISH=r+"MUTE_FINISH",t.UNMUTE_TRACKS=r+"UNMUTE",t.UNMUTE_TRACKS_FINISH=r+"UNMUTE_FINISH",t.TRACK_SOURCE_MUTED=r+"SOURCE_MUTED",t.TRACK_SOURCE_UNMUTED=r+"SOURCE_UNMUTED",n+"SESSION/"),a=(t.SESSION_ADDED=o+"ADDED",t.SESSION_REMOVED=o+"REMOVED",t.SESSION_NEW_TRACK=o+"NEW_TRACK",t.SESSION_TRACK_ENDED=o+"TRACK_ENDED",t.SESSION_TRACK_REPLACED=o+"TRACK_REPLACED",t.SESSION_AUDIO_ENDED=o+"AUDIO_ENDED",t.SESSION_ICE_CONNECTION_STATE_CHANGE=o+"ICE_CONNECTION_STATE_CHANGE",t.SESSION_ICE_GATHERING_STATE_CHANGE=o+"ICE_GATHERING_STATE_CHANGE",t.SESSION_ICE_CANDIDATE_COLLECTED=o+"ICE_CANDIDATE_COLLECTED",t.SESSION_ICE_COLLECTION_SCHEDULED_CHECK=o+"ICE_CANDIDATE_SCHEDULED_CHECK",n+"MEDIA/");t.MEDIA_NEW=a+"NEW",t.MEDIA_REMOVED=a+"REMOVED",t.MEDIA_CHANGE=a+"CHANGE",t.MEDIA_NEW_TRACK=a+"NEW_TRACK",t.MEDIA_TRACK_ENDED=a+"TRACK_ENDED",t.SET_BROWSER_DETAILS=n+"SET_BROWSER_DETAILS"},82094:(e,t)=>{!function(e){var t,n,r,o=String.fromCharCode;function a(e){for(var t,n,r=[],o=0,a=e.length;o<a;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<a?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function i(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function s(e,t){return o(e>>t&63|128)}function c(e){if(!(4294967168&e))return o(e);var t="";return 4294965248&e?4294901760&e?4292870144&e||(t=o(e>>18&7|240),t+=s(e,12),t+=s(e,6)):(i(e),t=o(e>>12&15|224),t+=s(e,6)):t=o(e>>6&31|192),t+o(63&e|128)}function l(){if(r>=n)throw Error("Invalid byte index");var e=255&t[r];if(r++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(){var e,o;if(r>n)throw Error("Invalid byte index");if(r==n)return!1;if(e=255&t[r],r++,!(128&e))return e;if(192==(224&e)){if((o=(31&e)<<6|l())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&e)){if((o=(15&e)<<12|l()<<6|l())>=2048)return i(o),o;throw Error("Invalid continuation byte")}if(240==(248&e)&&(o=(7&e)<<18|l()<<12|l()<<6|l())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}e.version="3.0.0",e.encode=function(e){for(var t=a(e),n=t.length,r=-1,o="";++r<n;)o+=c(t[r]);return o},e.decode=function(e){t=a(e),n=t.length,r=0;for(var i,s=[];!1!==(i=u());)s.push(i);return function(e){for(var t,n=e.length,r=-1,a="";++r<n;)(t=e[r])>65535&&(a+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),a+=o(t);return a}(s)}}(t)},82108:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e={};function t(t){clearTimeout(t),Object.keys(e).forEach(n=>{const r=e[n].findIndex(e=>e.handle===t);r>-1&&e[n].splice(r,1)})}return{create:function(n,r,o,a){if(!n||"string"!=typeof n)throw new Error("No valid type provided for timer operation.");if(!r||"function"!=typeof r)throw new Error("No valid callback function provided for timer operation.");if(!o||"number"!=typeof o||o<0)throw new Error("No valid delay period provided for timer operation.");const{id:i,params:s=[],repeating:c}=a||{},l=c?setInterval(async()=>{await r(...s)},o):setTimeout(function(){t(l),r(...s)},o,...s);return e[n]||(e[n]=[]),e[n].push({id:i,handle:l}),l},getAll:function(){return e},getAllByType:function(t){if(!t||"string"!=typeof t)throw new Error("No valid type provided for timers operation.");return e[t]||[]},getAllById:function(t){if(!t||"string"!=typeof t)throw new Error("No valid id provided for timers operation.");const n=[];return Object.keys(e).forEach(r=>{const o=e[r].filter(e=>e.id===t);n.push(...o)}),n},clear:t,clearAllByType:function(n){if(!n||"string"!=typeof n)throw new Error("No valid type provided for timer operation.");if(e[n]){for(let r=e[n].length-1;r>=0;r--)t(e[n][r].handle);delete e[n]}},clearAllById:function(n){if(!n||"string"!=typeof n)throw new Error("No valid id provided for timer operation.");Object.keys(e).forEach(r=>{let o;for(;(o=e[r].findIndex(e=>e.id===n))>-1;)t(e[r][o].handle)})},isRunning:function(t){let n=!1;return Object.keys(e).forEach(r=>{e[r].findIndex(e=>e.handle===t)>-1&&(n=!0)}),n}}},n(97107),n(69375),n(81045),n(30163),n(5350)},82237:(e,t,n)=>{var r=n(52837),o=n(83417),a=n(92013);e.exports=function(e){return o(e)?a(e):r(e)}},82254:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=y(n(66353)),o=y(n(73331)),a=y(n(18478)),i=y(n(83570)),s=y(n(98016)),c=y(n(75650)),l=y(n(96949)),u=y(n(10503)),d=y(n(68729)),f=y(n(4069)),p=y(n(17111)),g=y(n(74825)),_=y(n(5349)),E=y(n(71404));function y(e){return e&&e.__esModule?e:{default:e}}const S={addIceCandidate:r.default,addTransceiver:o.default,close:a.default,createAnswer:i.default,createOffer:s.default,findReusableTransceiver:c.default,getState:l.default,getStats:u.default,getTransceivers:d.default,removeTrack:f.default,replaceTrack:p.default,sendDTMF:g.default,setLocalDescription:_.default,setRemoteDescription:E.default};t.default=S},82430:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t),i=(0,r.getOptions)(e);return n?"manual"!==i.ringingFeedbackMode?new a.default({message:"Failed to send ringing feedback. Configuration must be set to 'manual' mode.",code:a.callCodes.NOT_SUPPORTED}):n.state!==o.CALL_STATES.INITIATED?new a.default({message:`Failed to send ringing feedback. Call must be in ${o.CALL_STATES.INITIATED} state.`,code:a.callCodes.INVALID_STATE}):n.direction!==o.CALL_DIRECTION.INCOMING?new a.default({message:"Failed to send ringing feedback. Call must be incoming.",code:a.callCodes.INVALID_STATE}):void 0:new a.default({message:`Failed to send ringing feedback. Call ${t} not found.`,code:a.callCodes.INVALID_PARAM})};var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},82438:(e,t,n)=>{"use strict";var r=n(5613),o=n(79117),a=n(40286),i=n(3770),s=n(14188),c=n(91786),l=n(10997),u=n(94417),d=n(5234),f=n(74418),p=n(4282),g=n(52037).IteratorPrototype,_=n(96893),E=n(1942),y="constructor",S="Iterator",v=p("toStringTag"),h=TypeError,T=o[S],C=E||!s(T)||T.prototype!==g||!d(function(){T({})}),I=function(){if(a(this,g),c(this)===g)throw new h("Abstract class Iterator not directly constructable")},m=function(e,t){_?l(g,e,{configurable:!0,get:function(){return t},set:function(t){if(i(this),this===g)throw new h("You can't redefine this property");f(this,e)?this[e]=t:u(this,e,t)}}):g[e]=t};f(g,v)||m(v,S),!C&&f(g,y)&&g[y]!==Object||m(y,I),I.prototype=g,r({global:!0,constructor:!0,forced:C},{Iterator:I})},82451:(e,t,n)=>{var r=n(40091),o=n(77848)(function(e,t,n){r(e,t,n)});e.exports=o},82481:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoteParticipant=function(e,t,n){if(!t.callNotificationParams||!e)return{};let r={};const o=t.callNotificationParams.callerDisplayNumber&&t.callNotificationParams.callerDisplayNumber.startsWith("conference@");return r="incoming"===e.direction||o?{remoteName:t.callNotificationParams.callerName,remoteNumber:t.callNotificationParams.callerDisplayNumber}:{remoteName:t.callNotificationParams.remoteName,remoteNumber:t.callNotificationParams.remoteDisplayNumber},r.remoteNumber&&!r.remoteNumber.includes("@")&&(r.remoteNumber+=n),{remoteName:r.remoteName||e.remoteParticipant.displayName,remoteNumber:r.remoteNumber||e.remoteParticipant.displayNumber}},n(62234)},82489:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=(0,r.default)(e.container),n=(0,i.default)(e.container);e.factory("Callstack.stages.unhold",()=>({local:{validate:o.default,localOffer:t.localChanges,signalling:t.signalling,remoteAnswer:(0,s.default)(e.container),rollback:(0,a.default)(e.container)},remote:{remoteOffer:n.localChanges,signalling:n.signalling}})),e.factory("Callstack.operations.unhold",()=>{const t=e.container.Callstack,n=t.models.Negotiation;function r(e){return(r,o)=>{const a=t.stages.unhold[e?"local":"remote"];return n.instance({type:c.OPERATIONS.UNHOLD,isLocal:e,stages:a},{callId:r,deferred:o})}}return{local:r(!0),remote:r(!1)}}),e.factory("Callstack.utils.rollbackUnhold",()=>(0,a.default)(e.container))};var r=l(n(5075)),o=l(n(65939)),a=l(n(5683)),i=l(n(70100)),s=l(n(15549)),c=n(59090);function l(e){return e&&e.__esModule?e:{default:e}}},82549:(e,t,n)=>{e.exports=n(50593)},82619:e=>{e.exports=function(e){return function(){return e}}},82803:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNotificationConfig=function(e){return(0,o.default)(e.config.notifications)},t.getNotificationsInfo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return t?e.notifications[t]:e.notifications};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},82912:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,sendRequest:n}=e,a=t.getLogger("SUBSCRIPTION");return async function(e){let[t]=e;const i={method:"PUT"};t.clientCorrelator?i.endpoint=`subscription/clientCorrelator/${t.clientCorrelator}`:i.endpoint=`subscription/${t.url.split("/subscription/")[1]}`,i.body=JSON.stringify({subscribeRequest:{expires:t.expires,service:t.service,localization:t.localization||"English_US",useTurn:t.useTurn||!0,notificationType:t.notificationType||"WebSocket",supported:["RingingFeedback"]}});const s=await n(i),{body:c,error:l,result:u}=s;if(l){if(c){const{statusCode:e}=c.subscribeResponse;let t,n;throw a.debug(`Failed to update user subscription with status code ${e}.`),404===u.code&&39===e?(t=`Subscription no longer exists. Code ${e}.`,n=e):(t=`Failed to update user subscription with status code ${e}.`,n=o.authCodes.UPDATE_SUBSCRIPTION_FAIL),new o.default({message:t,code:n})}{const{message:e}=u;throw a.debug("User subscription update request failed.",e),new o.default({message:`Update subscription request failed.: ${e}.`,code:o.authCodes.UPDATE_SUBSCRIPTION_FAIL})}}{const e=c.subscribeResponse;if(0===e.statusCode||2===e.statusCode){const n=e.subscriptionParams.service,o=(0,r.parseSpidrServices)(t.service,n);return a.debug(`Resubscribed user. Service resubscription status: ${o.status}`),{error:!1,servicesInfo:o,...e}}throw new o.default({message:`Unknown error; statusCode: ${e.statusCode}.`,code:o.authCodes.UPDATE_SUBSCRIPTION_FAIL})}}};var r=n(22507),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},82966:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=(0,r.getCallById)(e,t);if(!n)return new a.default({code:a.callCodes.INVALID_PARAM,message:`Invalid Call ID. No call found with Call ID: ${t}`});if(n.state!==o.CALL_STATES.CONNECTED&&n.state!==o.CALL_STATES.ON_HOLD)return new a.default({code:a.callCodes.INVALID_STATE,message:`Call in invalid state for sending custom parameters. Call state: ${n.state}`});{const{customParameters:e}=n;if(!e)return new a.default({code:a.callCodes.INVALID_STATE,message:`No custom parameters set on call: ${t}.`})}};var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},82998:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.instanceFactory("Callstack.models.MultiCall",(t,n,r)=>{const{type:s,isNegotiation:c,stages:l,createFlow:u}=n;n.isLocal=!0;const d=(0,i.v4)(),{callInfo:f,deferred:p,data:g}=r,_=a.REPORTER_OPERATION_EVENTS_MAP[s+"_LOCAL"]||a.REPORTER_OPERATION_EVENTS_MAP[s],E=f.map(t=>{let{id:r,role:a}=t;const i=e.container.CallReporter.getReport(r).addEvent(_);return{callId:r,role:a,reportEvent:i,tracker:(0,o.default)(e.container,r,d,i.id,n,{isJoinedCall:"joined"===a})}}),y={type:s,isNegotiation:c,isLocal:!0,start:void 0,receiveResponse:void 0,calls:E,id:d,data:{...g},tracker:{start:()=>E.forEach(e=>{"joined"!==e.role&&e.tracker.start()}),update:e=>E.forEach(t=>t.tracker.update(e)),resume:()=>E.forEach(e=>e.tracker.resume()),finish:e=>E.forEach(t=>t.tracker.finish(e))},get status(){return E[0].tracker.status},reportEvent:{addEvent:e=>E.forEach(t=>t.reportEvent.addEvent(e)),setError:e=>E.forEach(t=>t.reportEvent.setError(e)),endEvent:e=>E.forEach(t=>t.reportEvent.endEvent(e))},deferred:p},S=u(e.container,y,l);return Object.assign(y,S),y})},n(81045),n(5350),n(84915);var r,o=(r=n(3226))&&r.__esModule?r:{default:r},a=n(84581),i=n(84596)},83417:e=>{var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},83476:e=>{e.exports={}},83546:(e,t,n)=>{var r=n(39032),o=n(77979);e.exports=function(e,t){return r(e,o(e),t)}},83557:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:s,CallstackWebrtc:c,CallReporter:l}=e;return async function(e,u){const d=n.getLogger("CALL",e.id),f=l.getReport(e.id),p=e.currentOperations.find(e=>e.isLocal&&[a.OPERATIONS.REMOVE_MEDIA,a.OPERATIONS.REMOVE_BASIC_MEDIA].includes(e.type)),g=f.getEvent(p.eventId).addEvent(i.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);g.addData("operation",i.REPORTER_OPERATION_EVENTS_MAP.REMOVE_MEDIA);try{const t={sessionId:e.webrtcSessionId,answerSdp:u.sdp};await c.receivedAnswer(t,e)}catch(n){throw t.dispatch(r.callActions.endCallFinish(e.id,{error:n})),s(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),s(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold},error:n}),g.setError(n),g.endEvent(),n}d.info(`Finished processing remote response to local ${p.type}. Changing state based on operation.`);const _=p.operationData.tracks;return t.dispatch(r.callActions.removeMediaFinish(e.id,{bandwidth:p.operationData.bandwidth,localTracks:_})),s(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:_}),g.endEvent(),{affectedLocalTracks:_}}},n(62234),n(81045),n(45950);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090),i=n(84581)},83570:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{nativePeer:t,config:n,dtlsRole:i,log:s}=this;return s.info("Creating local answer."),delete e.mediaDirections,new Promise((c,l)=>{t.createAnswer(e).then(t=>{const l=[];l.push(a.preventDtlsRoleChange),n.trickleIceMode===r.PEER.TRICKLE_ICE.NONE&&l.push(a.removeTrickleIce),n.removeBundling&&l.push(a.removeBundling),e.mediaDirections&&l.push((0,a.changeMediaDirection)(e.mediaDirections)),l.length>0&&(t.sdp=(0,o.runPipeline)(l,t.sdp,{type:t.type,endpoint:r.PEER.ENDPOINT.LOCAL,dtlsRole:i})),s.info("Finished creating local answer."),c(t)}).catch(l)})},n(69375);var r=n(54507),o=n(28851),a=n(75424)},83628:(e,t,n)=>{"use strict";var r=n(39509),o=Object;e.exports=function(e){return o(r(e))}},83840:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:r,SipEventsRequests:d,SipEventsIntervals:f}=e,p=r.getLogger("SIPEVENTS");function g(e,t){f.startResubInterval(e,t)}function _(e){f.isRunning(e)&&f.stop(e)}return{subscribe:async function(e,n,r,i){const{dispatch:s,getState:l}=t;s(a.sipEventSubscribe(e,n,r,i)),p.debug(`Subscribing for sip ${e}.`,r);const f=(0,c.getSubscribedServices)(l()).filter(e=>e.startsWith("event:"));if(!(0,o.default)(e,f)){p.info(`Cannot subscribe to sip ${e}; service was not provisioned during user subscription.`);const t=new u.default({code:u.sipEventCodes.NOT_PROVISIONED,message:"Cannot subscribe to sip event; service was not provisioned during user subscription."});throw s(a.sipEventSubscribeFinish({error:t,eventType:e})),t}const{expires:_}=(0,c.getSubscriptionInfo)(l());try{const t=await d.subscribe(e,n,r,i,_);p.info(`Successfully subscribed to sip event ${e}.`);const o=a.sipEventSubscribeFinish({response:{...t.body.eventSubscriptionResponse,eventType:e,subscribedUsers:n}});g(e,o.payload.expires),s(o)}catch(t){throw s(a.sipEventSubscribeFinish({error:t,eventType:e})),t}},unsubscribe:async function(e){const{dispatch:n,getState:r}=t;n(a.sipEventUnsubscribe(e)),p.debug(`Unsubscribing from sip event subscriptions: ${e}.`);const o=(0,s.getSipEventInfo)(r(),e);if(!o){p.info(`Cannot unsubscribe from sip event ${e}; no subscription exists.`);const t=new u.default({code:u.sipEventCodes.NOT_SUBSCRIBED,message:`Cannot unsubscribe from ${e}; no subscription found.`});throw n(a.sipEventUnsubscribeFinish({error:t,eventType:e})),t}try{await d.unsubscribe(e,o),p.info(`Successfully unsubscribed from sip ${e}.`);const t=a.sipEventUnsubscribeFinish({response:{eventType:e}});_(e),n(t)}catch(t){throw n(a.sipEventUnsubscribeFinish({error:t,eventType:e})),t}},update:async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const{dispatch:i,getState:c}=t;i(a.sipEventUpdate(e,n,r)),p.debug(`Updating sip event subscription: ${e}.`);const l=(0,s.getSipEventInfo)(c(),e);if(!l){let t;throw t=o?new u.default({code:u.sipEventCodes.NOT_SUBSCRIBED,message:`Cannot resubscribe for ${e} subscription; user not subscribed.`}):new u.default({code:u.sipEventCodes.NOT_SUBSCRIBED,message:`Cannot update subscription for ${e}; user not subscribed.`}),i(a.sipEventUpdateFinish({error:t,eventType:e})),t}try{const{subscribeUserList:t,unsubscribeUserList:o}=n,s={};t&&t.length>0&&(s.subscribeUserList=t),o&&o.length>0&&(s.unsubscribeUserList=o),r||(r=[]);const c=await d.update(e,l,s,r);c&&(p.info(`Updated sip event subscription: ${e}.`),i(a.sipEventUpdateFinish({response:{...c,eventType:e,subscribeUserList:t||[],unsubscribeUserList:o||[]}})))}catch(t){throw i(a.sipEventUpdateFinish({error:t,eventType:e})),t}},startSipEventResub:g,stopSipEventResub:_,receiveEvent:function(e){const r=(0,c.getSubscribedServices)(t.getState()).filter(e=>e.startsWith("event:")),o=e.genericNotificationParams;let u="";if(o.sessionDataType&&"call"===o.sessionDataType){const e=(0,l.getCallByWrtcsSessionId)(t.getState(),o.sessionData);e?u=e.id:p.warn("Call associated with received SIP notification cannot be found.")}r.includes(e.eventType)?(0,s.getSipEventInfo)(t.getState(),e.eventType)?p.info(`Received solicited SIP event notification of type ${e.eventType}.`,e):p.info(`Received solicited SIP event notification for untracked event of type ${e.eventType}.`,e):p.info(`Received unsolicited SIP event notification of type ${e.eventType}.`,e),t.dispatch(a.sipEventReceived(e,u)),n(i.EVENT_RECEIVED,{eventType:e.eventType,eventId:e.eventId,links:{callId:u},event:e})}}},n(62234),n(81045),n(30163);var r,o=(r=n(50593))&&r.__esModule?r:{default:r},a=d(n(69815)),i=d(n(40943)),s=n(29962),c=n(56512),l=n(40481),u=d(n(75412));function d(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(d=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},83943:(e,t,n)=>{var r=n(81935),o=n(49460),a=n(2306),i=a&&a.isSet,s=i?o(i):r;e.exports=s},84157:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListFinish=function(e){return{type:o.CREATE_PRESENCE_LIST_FINISH,error:e instanceof Error||e instanceof a.default,payload:e}},t.createPresenceList=function(e){return{type:o.CREATE_PRESENCE_LIST,payload:e}},t.deletePresenceList=function(e){return{type:o.DELETE_PRESENCE_LIST,payload:e}},t.getPresence=function(e){return{type:o.GET,payload:e}},t.getPresenceFinish=function(e){return{type:o.GET_FINISH,error:e instanceof Error||e instanceof a.default,payload:e}},t.getPresenceList=function(e){return{type:o.GET_PRESENCE_LIST,payload:e}},t.presenceReceived=function(e){return{type:o.RECEIVED,payload:e}},t.subscribePresence=function(e){return{type:o.SUBSCRIBE,payload:e}},t.subscribePresenceFinish=function(e){return Array.isArray(e.presentityUserId)||(e.presentityUserId=[e.presentityUserId]),{type:o.SUBSCRIBE_FINISH,error:e instanceof Error||e instanceof a.default,payload:e}},t.unsubscribePresence=function(e){return{type:o.UNSUBSCRIBE,payload:e}},t.unsubscribePresenceFinish=function(e){return e.presentityUserId&&!Array.isArray(e.presentityUserId)&&(e.presentityUserId=[e.presentityUserId]),{type:o.UNSUBSCRIBE_FINISH,error:e instanceof Error||e instanceof a.default,payload:e}},t.updatePresence=function(e,t,n){return{type:o.UPDATE,payload:{status:e,activity:t,note:n}}},t.updatePresenceFinish=function(e){return{type:o.UPDATE_FINISH,error:e instanceof Error||e instanceof a.default,payload:e}},n(97107);var r,o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(60437)),a=(r=n(75412))&&r.__esModule?r:{default:r}},84341:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UNSUBSCRIBE=t.SUBSCRIBE=t.SELF_CHANGE=t.RECEIVED=t.ERROR=void 0,t.RECEIVED="presence:change",t.SELF_CHANGE="presence:selfChange",t.SUBSCRIBE="presence:subscribe",t.UNSUBSCRIBE="presence:unsubscribe",t.ERROR="presence:error"},84354:e=>{e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},84499:(e,t,n)=>{var r=n(92673)("isEmpty",n(3514),n(76648));r.placeholder=n(22991),e.exports=r},84570:(e,t,n)=>{var r=n(47170),o=n(45770)(r);e.exports=o},84581:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REPORT_METRICS=t.REPORT_EVENTS=t.REPORTER_REQUESTS=t.REPORTER_OPERATION_EVENTS_MAP=t.ICE_COLLECTION_OPERATIONS=void 0;var r=n(59090);const o=t.REPORT_EVENTS={MAKE:"MAKE",SEND_RINGING_FEEDBACK:"SEND_RINGING_FEEDBACK",ANSWER:"ANSWER",GET_USER_MEDIA:"GET_USER_MEDIA",PROCESS_MEDIA_LOCAL:"PROCESS_MEDIA_LOCAL",PROCESS_MEDIA_REMOTE:"PROCESS_MEDIA_REMOTE",ICE_COLLECTION:"ICE_COLLECTION",RELAY_CANDIDATE_COLLECTED:"RELAY_CANDIDATE_COLLECTED",IGNORE:"IGNORE",REJECT:"REJECT",FORWARD_CALL:"FORWARD_CALL",END_LOCAL:"END_LOCAL",END_REMOTE:"END_REMOTE",ADD_BASIC_MEDIA:"ADD_BASIC_MEDIA_LOCAL",ADD_MEDIA:"ADD_MEDIA_LOCAL",ADD_MEDIA_REMOTE:"ADD_MEDIA_REMOTE",ADD_TRACKS:"ADD_TRACKS",REMOVE_BASIC_MEDIA:"REMOVE_BASIC_MEDIA_LOCAL",REMOVE_MEDIA:"REMOVE_MEDIA_LOCAL",REMOVE_MEDIA_REMOTE:"REMOVE_MEDIA_REMOTE",MEDIA_RESTART:"MEDIA_RESTART",REPLACE_TRACK:"REPLACE_TRACK",HOLD_LOCAL:"HOLD_LOCAL",HOLD_REMOTE:"HOLD_REMOTE",UNHOLD_LOCAL:"UNHOLD_LOCAL",UNHOLD_REMOTE:"UNHOLD_REMOTE",PLAY_AUDIO:"PLAY_AUDIO",START_MOH:"START_MOH",STOP_MOH:"START_MOH",SEND_CUSTOM_PARAMETERS:"SEND_CUSTOM_PARAMETERS",GET_STATS:"GET_STATS",SEND_DTMF:"SEND_DTMF",RESYNC:"RESYNC",DIRECT_TRANSFER:"DIRECT_TRANSFER",CONSULTATIVE_TRANSFER:"CONSULTATIVE_TRANSFER",JOIN:"JOIN",GET_AVAILABLE_CODECS:"GET_AVAILABLE_CODECS",SLOW_START:"SLOW_START",RECEIVE_CALL:"RECEIVE_CALL",REMOTE_RINGING:"REMOTE_RINGING",REST_REQUEST:"REST_REQUEST",AUDIT_CALL:"AUDIT_CALL",CREATE_OFFER:"CREATE_OFFER",CREATE_ANSWER:"CREATE_ANSWER"};t.REPORTER_REQUESTS={CREATE_SESSION:"CREATE_SESSION",ANSWER_SESSION:"ANSWER_SESSION",REJECT_SESSION:"REJECT_SESSION",FORWARD_SESSION:"FORWARD_SESSION",UPDATE_SESSION:"UPDATE_SESSION",GET_SESSION:"GET_SESSION",CALL_RINGING_UPDATE_SESSION:"CALL_RINGING_UPDATE_SESSION",UPDATE_CUSTOM_PARAMETERS_ON_SESSION:"UPDATE_CUSTOM_PARAMETERS_ON_SESSION",END_SESSION:"END_SESSION"},t.REPORT_METRICS={CALL_DURATION:"CALL_DURATION",MAKE_CALL_PRE_LOCAL_SETUP:"MAKE_CALL_PRE_LOCAL_SETUP",MAKE_CALL_LOCAL_SETUP:"MAKE_CALL_LOCAL_SETUP",MAKE_CALL_REMOTE_SETUP:"MAKE_CALL_REMOTE_SETUP",TIME_TO_MAKE:"TIME_TO_MAKE",ANSWER_CALL_PRE_LOCAL_SETUP:"ANSWER_CALL_PRE_LOCAL_SETUP",ANSWER_CALL_LOCAL_SETUP:"ANSWER_CALL_LOCAL_SETUP",TIME_TO_ANSWER:"TIME_TO_ANSWER",TIME_FROM_RECEIVE_TO_ANSWER:"TIME_FROM_RECEIVE_TO_ANSWER",TIME_TO_CALL_SETUP_DURATION:"TIME_TO_CALL_SETUP_DURATION",TIME_TO_RINGING:"TIME_TO_RINGING",TIME_TO_IGNORE:"TIME_TO_IGNORE",TIME_TO_REJECT:"TIME_TO_REJECT",TIME_TO_ADD_MEDIA:"TIME_TO_ADD_MEDIA",TIME_TO_ADD_MEDIA_REMOTE:"TIME_TO_ADD_MEDIA_REMOTE",TIME_TO_REMOVE_MEDIA:"TIME_TO_REMOVE_MEDIA",TIME_TO_REMOVE_MEDIA_REMOTE:"TIME_TO_REMOVE_MEDIA_REMOTE",TIME_TO_RESTART_MEDIA:"TIME_TO_RESTART_MEDIA",TIME_TO_HOLD_LOCAL:"TIME_TO_HOLD_LOCAL",TIME_TO_HOLD_REMOTE:"TIME_TO_HOLD_REMOTE",TIME_TO_UNHOLD_LOCAL:"TIME_TO_UNHOLD_LOCAL",TIME_TO_UNHOLD_REMOTE:"TIME_TO_UNHOLD_REMOTE",TIME_TO_COLLECT_ICE_CANDIDATES:"TIME_TO_COLLECT_ICE_CANDIDATES",TIME_TO_RELAY_CANDIDATES:"TIME_TO_RELAY_CANDIDATES",TIME_TO_SEND_CUSTOM_PARAMETERS:"TIME_TO_SEND_CUSTOM_PARAMETERS",TIME_TO_FORWARD:"TIME_TO_FORWARD",TIME_TO_DIRECT_TRANSFER:"TIME_TO_DIRECT_TRANSFER",TIME_TO_CONSULTATIVE_TRANSFER:"TIME_TO_CONSULTATIVE_TRANSFER",TIME_TO_JOIN:"TIME_TO_JOIN"},t.REPORTER_OPERATION_EVENTS_MAP={MAKE:"MAKE",MAKE_REMOTE:o.RECEIVE_CALL,MAKE_ANONYMOUS:"MAKE",ANSWER:"ANSWER",REJECT:"REJECT",IGNORE:"IGNORE",SEND_RINGING_FEEDBACK:"SEND_RINGING_FEEDBACK",FORWARD_CALL:"FORWARD_CALL",HOLD:"HOLD_LOCAL",UNHOLD:"UNHOLD_LOCAL",HOLD_REMOTE:"HOLD_REMOTE",UNHOLD_REMOTE:"UNHOLD_REMOTE",SEND_CUSTOM_PARAMETERS:"SEND_CUSTOM_PARAMETERS",ADD_MEDIA:"ADD_MEDIA_LOCAL",ADD_MEDIA_REMOTE:"ADD_MEDIA_REMOTE",ADD_BASIC_MEDIA:"ADD_BASIC_MEDIA_LOCAL",ADD_BASIC_MEDIA_REMOTE:"ADD_BASIC_MEDIA_REMOTE",REMOVE_MEDIA:"REMOVE_MEDIA_LOCAL",REMOVE_MEDIA_REMOTE:"REMOVE_MEDIA_REMOTE",REMOVE_BASIC_MEDIA:"REMOVE_BASIC_MEDIA_LOCAL",REMOVE_BASIC_MEDIA_REMOTE:"REMOVE_BASIC_MEDIA_REMOTE",GET_STATS:"GET_STATS",SEND_DTMF:"SEND_DTMF",CONSULTATIVE_TRANSFER:"CONSULTATIVE_TRANSFER",DIRECT_TRANSFER:"DIRECT_TRANSFER",JOIN:"JOIN",REPLACE_TRACK:"REPLACE_TRACK",MEDIA_RESTART:"MEDIA_RESTART",RESYNC:"RESYNC",PLAY_AUDIO:"PLAY_AUDIO",GET_AVAILABLE_CODECS:"GET_AVAILABLE_CODECS",END:"END_LOCAL",END_REMOTE:"END_REMOTE",START_MOH_REMOTE:"START_MOH",STOP_MOH_REMOTE:"STOP_MOH",SLOW_START_REMOTE:"SLOW_START",UNKNOWN_REMOTE:"UNKNOWN",GENERIC_REMOTE:"UNKNOWN",NO_CHANGE_REMOTE:"UNKNOWN",callStatusUpdateEnded:o.END_REMOTE,receiveEarlyMedia:"EARLY_MEDIA",callStatusUpdateRinging:o.REMOTE_RINGING,[r.OPERATIONS.CALL_CANCEL]:r.OPERATIONS.CALL_CANCEL},t.ICE_COLLECTION_OPERATIONS={MAKE:"MAKE",ANSWER:"ANSWER",JOIN:"JOIN",HOLD:"HOLD_LOCAL",UNHOLD:"UNHOLD_LOCAL",UNHOLD_REMOTE:"UNHOLD_REMOTE",ADD_MEDIA:"ADD_MEDIA_LOCAL",ADD_BASIC_MEDIA:"ADD_BASIC_MEDIA_LOCAL",ADD_MEDIA_REMOTE:"ADD_MEDIA_REMOTE",REMOVE_MEDIA:"REMOVE_MEDIA_LOCAL",REMOVE_BASIC_MEDIA:"REMOVE_BASIC_MEDIA_LOCAL",MEDIA_RESTART:"MEDIA_RESTART",START_MOH:"START_MOH",STOP_MOH:"STOP_MOH",SLOW_START:"SLOW_START",UNKNOWN:"UNKNOWN"}},84596:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return c.default}});var r=f(n(74603)),o=f(n(99917)),a=f(n(42712)),i=f(n(93423)),s=f(n(35911)),c=f(n(24072)),l=f(n(4564)),u=f(n(46585)),d=f(n(29975));function f(e){return e&&e.__esModule?e:{default:e}}},84882:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},84915:(e,t,n)=>{"use strict";n(50020)},84989:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,WebRTC:n}=e;return async function(e){const r=t.getLogger("CALL");if("audio"!==e&&"video"!==e){const t=`Cannot retrieve codecs for media kind ${e}. Only 'audio' or 'video' kind supported.`;throw r.info(t),new o.default({message:t})}r.info(`Retrieving list of available codecs for media kind '${e}'.`);const a=await n.webrtcManager.getAvailableCodecs(e);return r.debug("Successfully retrieved codec list:",a),a}};var r,o=(r=n(75412))&&r.__esModule?r:{default:r}},85222:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e,t=a.WS_STATUS.NO_SOCKET,n=!1;const r=(0,i.default)();let s;function c(){return t}function l(){const r=c();if(r===a.WS_STATUS.CONNECTED)s&&u(void 0),e&&((0,o.cleanupWebSocket)(e),e=void 0),t=a.WS_STATUS.NO_SOCKET;else{if(r!==a.WS_STATUS.CONNECTING)throw new Error("Websocket is not connected.");n=!0}}function u(t){if(c()!==a.WS_STATUS.CONNECTED)throw new Error("Websocket is not connected.");if(s){if(t)throw new Error("Websocket is already pinging.");n()}else{if(!t.message||!t.interval)throw new Error("All options must be provided to start pinging.");s=setInterval(function(){c()!==a.WS_STATUS.CONNECTED&&n();try{if(!e||1!==e.readyState)throw new Error("websocket was not in readyState");e.send(t.message)}catch(e){n(),l(),r.emit("disconnected",e)}},t.interval)}function n(){clearInterval(s),s=void 0}}return{connect:function(i){return new Promise((s,u)=>{c()===a.WS_STATUS.NO_SOCKET?(t=a.WS_STATUS.CONNECTING,(0,o.openWebsocket)(i).then(o=>{if(t=a.WS_STATUS.CONNECTED,e=o,n)throw n=!1,l(),new Error("Websocket connection interrupted by request.");o.onmessage=e=>{let t;try{t=JSON.parse(e.data)}catch(n){t=e.data}r.emit("message",t)},o.onclose=e=>{l(),r.emit("close",e)},o.onerror=e=>{l(),r.emit("error",e)},s()}).catch(e=>{t=a.WS_STATUS.NO_SOCKET,u(e)})):u(new Error("Websocket already exists."))})},disconnect:l,setPinging:u,on:r.on,off:r.off,get status(){return c()},get isPinging(){return Boolean(s)}}},n(97107);var r,o=n(40751),a=n(78039),i=(r=n(19353))&&r.__esModule?r:{default:r}},85514:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.resyncCallState",()=>({local:{validate:o.default,localOffer:()=>{},signalling:(0,r.default)(e.container)}})),e.factory("Callstack.operations.resyncCallState",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.RESYNC,isLocal:!0,stages:e.container.Callstack.stages.resyncCallState.local},{callId:n})},stages:{signalling:(0,r.default)(e.container)}}})};var r=i(n(96049)),o=i(n(11102)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},85524:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const i=(0,r.getCallById)(e,t);return i?i.state===o.CALL_STATES.ENDED?new a.default({code:a.callCodes.INVALID_STATE,message:"Failed to get call stats; call must not be ended."}):n&&!i.localTracks.includes(n)?new a.default({code:a.callCodes.INVALID_PARAM,message:"Provided trackId is not a local track on the call."}):void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})},n(62234);var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},85755:e=>{var t=Math.max;e.exports=function(e,n,r,o){for(var a=-1,i=e.length,s=-1,c=r.length,l=-1,u=n.length,d=t(i-c,0),f=Array(d+u),p=!o;++a<d;)f[a]=e[a];for(var g=a;++l<u;)f[g+l]=n[l];for(;++s<c;)(p||a<i)&&(f[g+r[s]]=e[a++]);return f}},85821:(e,t,n)=>{"use strict";var r=n(95691),o=n(44977),a=n(89055),i=r(r.bind);e.exports=function(e,t){return o(e),void 0===t?e:a?i(e,t):function(){return e.apply(t,arguments)}}},85832:(e,t,n)=>{var r=n(11129),o=n(74784),a=n(77979),i=n(99306),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,a(e)),e=o(e);return t}:i;e.exports=s},85899:(e,t,n)=>{var r=n(93526),o=n(3283),a=n(53142),i=n(69632),s=n(65387),c=n(66040);e.exports=function(e,t,n){for(var l=-1,u=(t=r(t,e)).length,d=!1;++l<u;){var f=c(t[l]);if(!(d=null!=e&&n(e,f)))break;e=e[f]}return d||++l!=u?d:!!(u=null==e?0:e.length)&&s(u)&&i(f,u)&&(a(e)||o(e))}},85917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){const s=(0,r.getCallById)(e,t);return s?s.state!==o.CALL_STATES.CONNECTED?new a.default({code:a.callCodes.INVALID_STATE,message:`Invalid call state: ${s.state}. It should be: ${o.CALL_STATES.CONNECTED}.`}):void 0:new a.default({code:a.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=n(40481),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},86125:function(e,t,n){var r;e=n.nmd(e),function(){var o=(e&&e.exports,"object"==typeof n.g&&n.g);o.global!==o&&o.window;var a=function(e){this.message=e};(a.prototype=new Error).name="InvalidCharacterError";var i=function(e){throw new a(e)},s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,l={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&i("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,r,o,a=e.length%3,c="",l=-1,u=e.length-a;++l<u;)t=e.charCodeAt(l)<<16,n=e.charCodeAt(++l)<<8,r=e.charCodeAt(++l),c+=s.charAt((o=t+n+r)>>18&63)+s.charAt(o>>12&63)+s.charAt(o>>6&63)+s.charAt(63&o);return 2==a?(t=e.charCodeAt(l)<<8,n=e.charCodeAt(++l),c+=s.charAt((o=t+n)>>10)+s.charAt(o>>4&63)+s.charAt(o<<2&63)+"="):1==a&&(o=e.charCodeAt(l),c+=s.charAt(o>>2)+s.charAt(o<<4&63)+"=="),c},decode:function(e){var t=(e=String(e).replace(c,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&i("Invalid character: the string to be decoded is not correctly encoded.");for(var n,r,o=0,a="",l=-1;++l<t;)r=s.indexOf(e.charAt(l)),n=o%4?64*n+r:r,o++%4&&(a+=String.fromCharCode(255&n>>(-2*o&6)));return a},version:"1.0.0"};void 0===(r=function(){return l}.call(t,n,t,e))||(e.exports=r)}()},86403:(e,t,n)=>{var r=n(62945),o=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e}},86462:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallHistoryRequests:o}=e,a=n.getLogger("CALLHISTORY");return async function(e,n){const{dispatch:i}=t;a.info(`Attempting to retrieve ${e} call history log(s), with an offset of ${n}.`);try{const t=await o.fetchCallLogs({amount:e,offset:n});return a.info(`Successfully retrieved ${t.length} call history log(s).`),i(r.retrieveCallLogsFinish({logs:t})),t}catch(e){throw i(r.retrieveCallLogsFinish({error:e})),e}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(31122))},86596:e=>{e.exports=function(e){return function(t,n,r){for(var o=-1,a=Object(t),i=r(t),s=i.length;s--;){var c=i[e?s:++o];if(!1===n(a[c],c,a))break}return t}}},86606:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS=t.ACTIVITY=void 0,t.STATUS={OPEN:"open",CLOSED:"closed"},t.ACTIVITY={ACTIVE:"active",IDLE:"idle",AWAY:"away",LUNCH:"lunch",OTHER:"other",BUSY:"busy",VACATION:"vacation",ON_THE_PHONE:"on-the-phone",UNKNOWN:"unknown"}},86912:e=>{e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},87014:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>C});var r=function(e,t,n,r){this.name=e,this.fn=t,this.args=n,this.modifiers=r};function o(e,t){return void 0===t&&(t="simple"),"object"==typeof e?e[t]:e}function a(e,t,n){if(e.length){var r=e.shift(),i=a(e,t,n);return r.perform(i,n)}return o(t)}function i(e,t,n){if(e.length){var r=e.shift(),a=i(e,t,n);return r.performAsync(a,n)}return function(e){return Promise.resolve(o(t,"async")(e))}}r.prototype._test=function(e){var t=this.fn;try{a(this.modifiers.slice(),t,this)(e)}catch(e){t=function(){return!1}}try{return a(this.modifiers.slice(),t,this)(e)}catch(e){return!1}},r.prototype._check=function(e){try{a(this.modifiers.slice(),this.fn,this)(e)}catch(e){if(a(this.modifiers.slice(),function(e){return e},this)(!1))return}if(!a(this.modifiers.slice(),this.fn,this)(e))throw null},r.prototype._testAsync=function(e){var t=this;return new Promise(function(n,r){i(t.modifiers.slice(),t.fn,t)(e).then(function(t){t?n(e):r(null)}).catch(function(e){return r(e)})})};var s=function(e,t,n){this.name=e,this.perform=t,this.performAsync=n},c=function(e){function t(n,r,o,a){for(var i=[],s=arguments.length-4;s-- >0;)i[s]=arguments[s+4];e.call(this,i),e.captureStackTrace&&e.captureStackTrace(this,t),this.rule=n,this.value=r,this.cause=o,this.target=a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),l=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.chain=e,this.nextRuleModifiers=t};function u(e,t,n,r){if(t.length){var o=t.shift();o._testAsync(e).then(function(){u(e,t,n,r)},function(t){r(new c(o,e,t))})}else n(e)}l.prototype._applyRule=function(e,t){var n=this;return function(){for(var o=[],a=arguments.length;a--;)o[a]=arguments[a];return n.chain.push(new r(t,e.apply(n,o),o,n.nextRuleModifiers)),n.nextRuleModifiers=[],n}},l.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new s(t,e.simple,e.async)),this},l.prototype._clone=function(){return new l(this.chain.slice(),this.nextRuleModifiers.slice())},l.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})},l.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(n){try{n._check(e)}catch(r){t.push(new c(n,e,r))}}),t},l.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(n){throw new c(t,e,n)}})},l.prototype.testAsync=function(e){var t=this;return new Promise(function(n,r){u(e,t.chain.slice(),n,r)})};var d=function(e,t){return!(!t||"string"!=typeof e||0!==e.trim().length)||null==e};function f(){return"undefined"!=typeof Proxy?g(new l):_(new l)}var p={};function g(e){return new Proxy(e,{get:function(t,n){if(n in t)return t[n];var r=g(e._clone());return n in E?r._applyModifier(E[n],n):n in p?r._applyRule(p[n],n):n in v?r._applyRule(v[n],n):void 0}})}function _(e){var t=function(e,t){return Object.keys(e).forEach(function(n){t[n]=function(){for(var r=[],o=arguments.length;o--;)r[o]=arguments[o];return _(t._clone())._applyRule(e[n],n).apply(void 0,r)}}),t},n=t(v,e),r=t(p,n);return Object.keys(E).forEach(function(e){Object.defineProperty(r,e,{get:function(){return _(r._clone())._applyModifier(E[e],e)}})}),r}f.extend=function(e){Object.assign(p,e)},f.clearCustomRules=function(){p={}};var E={not:{simple:function(e){return function(t){return!e(t)}},async:function(e){return function(t){return Promise.resolve(e(t)).then(function(e){return!e}).catch(function(){return!0})}}},some:{simple:function(e){return function(t){return S(t).some(function(t){try{return e(t)}catch(e){return!1}})}},async:function(e){return function(t){return Promise.all(S(t).map(function(t){try{return e(t).catch(function(){return!1})}catch(e){return!1}})).then(function(e){return e.some(Boolean)})}}},every:{simple:function(e){return function(t){return!1!==t&&S(t).every(e)}},async:function(e){return function(t){return Promise.all(S(t).map(e)).then(function(e){return e.every(Boolean)})}}},strict:{simple:function(e,t){return function(n){return y(t)&&n&&"object"==typeof n?Object.keys(t.args[0]).length===Object.keys(n).length&&e(n):e(n)}},async:function(e,t){return function(n){return Promise.resolve(e(n)).then(function(e){return y(t)&&n&&"object"==typeof n?Object.keys(t.args[0]).length===Object.keys(n).length&&e:e}).catch(function(){return!1})}}}};function y(e){return e&&"schema"===e.name&&e.args.length>0&&"object"==typeof e.args[0]}function S(e){return"string"==typeof e?e.split(""):e}var v={equal:function(e){return function(t){return t==e}},exact:function(e){return function(t){return t===e}},number:function(e){return void 0===e&&(e=!0),function(t){return"number"==typeof t&&(e||isFinite(t))}},integer:function(){return function(e){return(Number.isInteger||T)(e)}},numeric:function(){return function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},string:function(){return h("string")},boolean:function(){return h("boolean")},undefined:function(){return h("undefined")},null:function(){return h("null")},array:function(){return h("array")},object:function(){return h("object")},instanceOf:function(e){return function(t){return t instanceof e}},pattern:function(e){return function(t){return e.test(t)}},lowercase:function(){return function(e){return"boolean"==typeof e||e===e.toLowerCase()&&""!==e.trim()}},uppercase:function(){return function(e){return e===e.toUpperCase()&&""!==e.trim()}},vowel:function(){return function(e){return/^[aeiou]+$/i.test(e)}},consonant:function(){return function(e){return/^(?=[^aeiou])([a-z]+)$/i.test(e)}},first:function(e){return function(t){return t[0]==e}},last:function(e){return function(t){return t[t.length-1]==e}},empty:function(){return function(e){return 0===e.length}},length:function(e,t){return function(n){return n.length>=e&&n.length<=(t||e)}},minLength:function(e){return function(t){return t.length>=e}},maxLength:function(e){return function(t){return t.length<=e}},negative:function(){return function(e){return e<0}},positive:function(){return function(e){return e>=0}},between:function(e,t){return function(n){return n>=e&&n<=t}},range:function(e,t){return function(n){return n>=e&&n<=t}},lessThan:function(e){return function(t){return t<e}},lessThanOrEqual:function(e){return function(t){return t<=e}},greaterThan:function(e){return function(t){return t>e}},greaterThanOrEqual:function(e){return function(t){return t>=e}},even:function(){return function(e){return e%2==0}},odd:function(){return function(e){return e%2!=0}},includes:function(e){return function(t){return~t.indexOf(e)}},schema:function(e){return function(e){return{simple:function(t){var n=[];if(Object.keys(e).forEach(function(r){var o=e[r];try{o.check((t||{})[r])}catch(e){e.target=r,n.push(e)}}),n.length>0)throw n;return!0},async:function(t){var n=[],r=Object.keys(e).map(function(r){return e[r].testAsync((t||{})[r]).catch(function(e){e.target=r,n.push(e)})});return Promise.all(r).then(function(){if(n.length>0)throw n;return!0})}}}(e)},passesAnyOf:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t){return e.some(function(e){return e.test(t)})}},optional:function(e,t){return void 0===t&&(t=!1),{simple:function(n){return d(n,t)||void 0===e.check(n)},async:function(n){return d(n,t)||e.testAsync(n)}}}};function h(e){return function(t){return Array.isArray(t)&&"array"===e||null===t&&"null"===e||typeof t===e}}function T(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}const C=f},87075:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthConfig=a,t.getConnectionInfo=i,t.getDomain=function(e){const{username:t="",identity:n=t}=s(e),[,r=""]=n.split("@");return r},t.getRequestInfo=function(e){const{subscription:t}=a(e);let{server:n}=a(e);const r=s(e);n||(n={protocol:t.protocol,base:t.server,port:t.port,version:t.version});const o=i(e);return{baseURL:`${n.protocol}://${n.base}:${n.port}`,version:n.version,username:r.username,userId:o?.userId,userType:o?.userType,requestOptions:o?.requestOptions}},t.getUserInfo=s;var r,o=(r=n(89321))&&r.__esModule?r:{default:r};function a(e){return(0,o.default)(e.config.authentication)}function i(e){if(e.authentication.connection){const t=a(e);return{server:{server:t.server.base,port:t.server.port,protocol:t.server.protocol,version:t.server.version},...(0,o.default)(e.authentication.connection)}}}function s(e){return(0,o.default)(e.authentication.userInfo)||{}}},87096:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallManager:t,logManager:n}=e.container;return async function(a){if(!s(a))return;const c=a.payload.notificationMessage,{sessionData:l,reasonText:u,statusCode:d}=c.sessionParams,f=(0,r.getCallByWrtcsSessionId)(e.getState(),l);if(!f)return void n.getLogger("CALL").info(`Received ${c.eventType} notification for unknown call; ignoring.`);const p=(0,i.getDomain)(e.getState()),g=(0,o.getRemoteParticipant)(f,c,p),_={eventType:c.eventType,reasonText:u,statusCode:d,...g};await t.callStatusUpdateFailed(l,_)}},t.shouldHandlePattern=s;var r=n(40481),o=n(82481),a=n(70506),i=n(87075);function s(e){return e.type===a.NOTIFICATION_RECEIVED&&"sessionFail"===e.payload.notificationMessage.eventType}},87173:(e,t,n)=>{"use strict";var r=n(71025),o=n(33243);e.exports=r(o.proto,"size","get")||function(e){return e.size}},87237:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=o.logManager.getLogger("Media",e.id);n.info(`Creating new ${t?"local":"remote"} Media.`);const r=e.id,i=e,s=new a.default,c=new Map;function l(){return Array.from(c.values())}function u(e){return c.get(e)}return{id:r,tracks:c,isLocal:t,getState:function(){return{id:r,tracks:Array.from(c.values()).map(e=>e.getState()),isLocal:t}},getTracks:l,getTrack:u,addTrack:function(e){c.has(e.id)?n.debug(`Track (${e.id}) is already in Media (${r}).`):(i.getTracks().find(t=>t.id===e.id)||i.addTrack(e.track),c.set(e.id,e),e.on("ended",()=>{const t=function(e){const t=u(e);if(t)return c.delete(e),t}(e.id);t&&s.emit("track:ended",{mediaId:r,trackId:t.id})}),s.emit("track:new",{mediaId:r,trackId:e.id}),e.on("muted",e=>{const t=u(e.trackId);t&&t.track&&t.track.muted&&s.emit("track:muted",{mediaId:r,trackId:e.trackId})}),e.on("unmuted",e=>{const t=u(e.trackId);t&&t.track&&!1===t.track.muted&&s.emit("track:unmuted",{mediaId:r,trackId:e.trackId})}))},stop:function(){l().forEach(e=>{e.stop()}),s.emit("media:stopped",this.id)},on:function(){return s.on(...arguments)},once:function(){return s.once(...arguments)},off:function(){return s.off(...arguments)}}},n(81045),n(45950),n(5350),n(84915);var r,o=n(40271),a=(r=n(19353))&&r.__esModule?r:{default:r}},87308:(e,t,n)=>{"use strict";var r=n(16881),o=Error,a=r("".replace),i=String(new o("zxcasd").stack),s=/\n\s*at [^:]*:[^\n]*/,c=s.test(i);e.exports=function(e,t){if(c&&"string"==typeof e&&!o.prepareStackTrace)for(;t--;)e=a(e,s,"");return e}},87310:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSdpHandlers=function(e){return e.push(o.sanitizeSdesFromSdp),e.push(a.modifySdpBandwidth),{type:r.SET_SDP_HANDLERS,payload:{sdpHandlers:e}}},t.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";var n;return n=t?{[t]:e}:e,{type:r.CONFIG_UPDATE,payload:n}},n(69375);var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(18470)),o=n(88851),a=n(46484)},87351:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n){await _(e,t,n)}},t.localChanges=_,n(97107),n(62234),n(81045),n(45950);var r=n(73520),o=g(n(11876)),a=g(n(48151)),i=n(77126),s=n(59090),c=p(n(50527)),l=p(n(21836)),u=p(n(51918)),d=n(84581),f=n(69260);function p(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(p=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}function g(e){return e&&e.__esModule?e:{default:e}}async function _(e,t,n){const{context:p,WebRTC:g,Callstack:_,CallstackSDP:E,CallstackWebrtc:y,emitEvent:S,logManager:v,CallReporter:h}=e,T=await async function(e,t){const n=v.getLogger("CALL",e.id);let{remoteOp:o,mediaDiff:a,remoteDesc:i}=await _.utils.getRemoteOperationInfo(e,t);const c=(0,r.getMediaState)(e);return n.info(`Handling state change as remote ${o} in ${c} scenario.`),o===s.OPERATIONS.UNHOLD&&!0===e.localHold&&["sendrecv","sendonly","recvonly"].some(e=>t.includes(e))&&(n.debug("Modifying remote SDP to prevent media in local hold scenario."),t=t.replace(/sendrecv|sendonly|recvonly/gi,"inactive"),a=E.compareMedia(i.sdp,t,!0)),{remoteOp:o,mediaDiff:a,remoteDesc:i,sdp:t}}(t,n.sdp),C=await async function(e,t){const n=v.getLogger("CALL",e.id);n.info("Processing remote response from slow-start remote update request.");const r=await g.sessionManager.get(e.webrtcSessionId);if(!r)throw n.debug(`webRTC session ${e.webrtcSessionId} not found.`),new Error(`Session for call ${e.id} not found.`);const a=h.getReport(e.id),c=e.currentOperations.find(e=>!e.isLocal&&e.type===s.OPERATIONS.SLOW_START),l=a.getEvent(c.eventId),u=l.addEvent(d.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);u.addData("operation",l.type);try{await y.receivedAnswer({sessionId:e.webrtcSessionId,answerSdp:t},e),u.endEvent()}catch(e){throw n.debug("Failed to receive answer SDP",e),u.endEvent(e),e}const f=(0,o.default)(t)?i.CALL_STATES.CONNECTED:i.CALL_STATES.ON_HOLD;return n.info(`Finished processing remote slow-start response. Changing to ${f}.`),r}(t,T.sdp);await async function(e,t,n,r){const{remoteOp:d,mediaDiff:g}=n,_=await(0,a.default)(d,g,r);let E=[];!e.localHold&&[s.OPERATIONS.HOLD,s.OPERATIONS.UNHOLD].includes(d)&&(E=(0,f.getSessionById)(p.getState(),e.webrtcSessionId).localTracks);const y=(0,o.default)(t.sdp)?i.CALL_STATES.CONNECTED:i.CALL_STATES.ON_HOLD,v=function(e){const t={[s.OPERATIONS.HOLD]:c.remoteHoldFinish,[s.OPERATIONS.UNHOLD]:c.remoteUnholdFinish,[s.OPERATIONS.ADD_MEDIA]:c.remoteAddMediaFinish,[s.OPERATIONS.REMOVE_MEDIA]:c.remoteRemoveMediaFinish,[s.OPERATIONS.START_MOH]:c.remoteStartMohFinish,[s.OPERATIONS.STOP_MOH]:c.remoteStopMohFinish,[s.OPERATIONS.SLOW_START]:c.remoteSlowStart};return function(){const n=(t[e]||c.updateCall)(...arguments);return n.type===l.UPDATE_CALL&&(n.meta={isRemote:!0}),n}}(d);p.dispatch(v(e.id,{state:y,remoteParticipant:{displayNumber:t.remoteNumber,displayName:t.remoteName},remoteTracks:_,localTracks:E})),s.OPERATIONS.HOLD===d?(S(u.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}),S(u.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...E,..._]})):s.OPERATIONS.UNHOLD===d?(S(u.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}),S(u.CALL_TRACKS_ADDED,{callId:e.id,trackIds:[...E,..._]})):[s.OPERATIONS.ADD_MEDIA,s.OPERATIONS.START_MOH].includes(d)?S(u.CALL_TRACKS_ADDED,{callId:e.id,trackIds:_}):[s.OPERATIONS.REMOVE_MEDIA,s.OPERATIONS.STOP_MOH].includes(d)&&S(u.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:_})}(t,n,T,C)}},87361:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchMedias=function(e,t){const n=[...e],r=[...t],o=[];let a=[];const i=[],s=function(e,t){return t.findIndex(t=>(void 0===e.sectionId||void 0===t.sectionId)&&e.mediaId===t.mediaId&&e.trackId===t.trackId)};return n.filter(e=>["number","string"].includes(typeof e.sectionId)).forEach(e=>{const t=function(e,t){return t.findIndex(t=>t.sectionId===e.sectionId)}(e,r);if(t>=0){const[n]=r.splice(t,1);i.push({previous:e,current:n})}else{const t=s(e,r);if(t>=0){const[n]=r.splice(t,1);i.push({previous:e,current:n})}else o.push(e)}}),n.filter(e=>void 0===e.sectionId).forEach(e=>{const t=s(e,r);if(t>=0){const[n]=r.splice(t,1);i.push({previous:e,current:n})}else o.push(e)}),a=r,{prevUnmatched:o,currUnmatched:a,matched:i}},t.matchMediasNaive=function(e,t){const n=[...e],r=[...t],o=[],a=[],i=[],s=n.length<=r.length?r.length:n.length;for(let e=0;e<s;e++)void 0===n[e]?a.push(r[e]):void 0===r[e]?o.push(n[e]):i.push({previous:n[e],current:r[e]});return{prevUnmatched:o,currUnmatched:a,matched:i}},n(62234),n(69375),n(81045),n(5350)},87379:(e,t,n)=>{var r=n(65650),o=n(8870),a=n(29005),i=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):a(e)}},87398:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkHandler=function(e){if(e&&"function"==typeof e)return e;throw new Error("Provided log handler is not a function.")},t.checkLevel=function(e){const t=e&&e.toUpperCase&&e.toUpperCase();if(t&&r.logLevels[t])return r.logLevels[t];throw new Error("Provided level is not a valid log level.")},n(97107);var r=n(75188)},87481:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s){const c=(0,r.getCallById)(e,t);if(!c)return new i.default({message:`Failed to answer call. Call ${t} not found.`,code:i.callCodes.INVALID_PARAM});if(![o.CALL_STATES.INITIATED,o.CALL_STATES.RINGING].includes(c.state))return new i.default({message:`Failed to answer call. Call must be in ${o.CALL_STATES.INITIATED} or ${o.CALL_STATES.RINGING} state.`,code:i.callCodes.INVALID_STATE});if(c.direction!==o.CALL_DIRECTION.INCOMING)return new i.default({message:"Failed to answer call. Call must be incoming.",code:i.callCodes.INVALID_STATE});if(!c.isSlowStart)return new i.default({message:"Failed to answer call. Call is not slow-start.",code:i.callCodes.INVALID_STATE});try{(0,a.validateMediaConstraints)(n)}catch(e){return e}if(n.medias)try{(0,a.validateDetachedMedia)(n.medias)}catch(e){return e}},n(62234);var r=n(40481),o=n(77126),a=n(9066),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},87520:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t}=e;return function(e,n){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=s.default.parse(e),u=s.default.parse(n),d=(0,r.default)(t,l),f=(0,r.default)(t,u);let p;p=c?(0,o.matchMediasNaive)(d,f):(0,o.matchMedias)(d,f);const g=p.prevUnmatched,_=p.currUnmatched,E=[],y=[];return p.matched.forEach(e=>{let{previous:t,current:n}=e;const r=(0,a.default)(t,n);r.sending===i.MEDIA_TRANSITIONS.SAME&&r.receiving===i.MEDIA_TRANSITIONS.SAME?y.push(t):E.push({media:n,changes:r})}),{added:_,removed:g,changed:E,unchanged:y}}},n(69375),n(81045),n(5350);var r=c(n(64858)),o=n(87361),a=c(n(13504)),i=n(69540),s=c(n(54722));function c(e){return e&&e.__esModule?e:{default:e}}},87526:(e,t,n)=>{var r=n(2478),o=n(36529),a=n(8138),i=n(67642),s=n(39817),c=Math.max;e.exports=function(e,t,n,l){e=o(e)?e:s(e),n=n&&!l?i(n):0;var u=e.length;return n<0&&(n=c(u+n,0)),a(e)?n<=u&&e.indexOf(t,n)>-1:!!u&&r(e,t,n)>-1}},87834:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_CONVERSATION=t.SEND_MESSAGE_READ_FINISH=t.SEND_MESSAGE_READ=t.SEND_MESSAGE_FINISH=t.SEND_MESSAGE=t.MESSAGE_RECEIVED=t.INCOMING_MESSAGE_READ=t.FILE_UPLOAD_FAIL=t.FETCH_MESSAGES_FINISHED=t.FETCH_MESSAGES=t.FETCH_CONVERSATIONS_FINISHED=t.FETCH_CONVERSATIONS=t.DELETE_MESSAGE_FINISH=t.DELETE_MESSAGE=t.DELETE_CONVERSATION_FINISH=t.DELETE_CONVERSATION=t.CREATE_CONVERSATION=t.CLEAR_MESSAGES_FINISH=t.CLEAR_MESSAGES=void 0;const n="@@KANDY/";t.CREATE_CONVERSATION=n+"CREATE_CONVERSATION",t.SEND_MESSAGE=n+"SEND_MESSAGE",t.SEND_MESSAGE_FINISH=n+"SEND_MESSAGE_FINISH",t.MESSAGE_RECEIVED=n+"MESSAGE_RECEIVED",t.INCOMING_MESSAGE_READ=n+"INCOMING_MESSAGE_READ",t.SEND_MESSAGE_READ=n+"SEND_MESSAGE_READ",t.SEND_MESSAGE_READ_FINISH=n+"SEND_MESSAGE_READ_FINISH",t.CLEAR_MESSAGES=n+"CLEAR_MESSAGES",t.CLEAR_MESSAGES_FINISH=n+"CLEAR_MESSAGES_FINISH",t.DELETE_CONVERSATION=n+"DELETE_CONVERSATION",t.DELETE_CONVERSATION_FINISH=n+"DELETE_CONVERSATION_FINISH",t.DELETE_MESSAGE=n+"DELETE_MESSAGES",t.DELETE_MESSAGE_FINISH=n+"DELETE_MESSAGES_FINISH",t.FETCH_CONVERSATIONS=n+"FETCH_CONVERSATIONS",t.FETCH_CONVERSATIONS_FINISHED=n+"FETCH_CONVERSATIONS_FINISHED",t.UPDATE_CONVERSATION=n+"UPDATE_CONVERSATION",t.FETCH_MESSAGES=n+"FETCH_MESSAGES",t.FETCH_MESSAGES_FINISHED=n+"FETCH_MESSAGES_FINISHED",t.FILE_UPLOAD_FAIL=n+"FILE_UPLOAD_FAIL"},87851:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const c=(0,i.getCallById)(e,t);return c?c.state!==a.CALL_STATES.CONNECTED?new s.default({code:s.callCodes.INVALID_STATE,message:`Invalid call state: ${c.state}. It should be: ${a.CALL_STATES.CONNECTED}.`}):!(0,o.default)(n)||(0,r.default)(n)?new s.default({code:s.callCodes.INVALID_PARAM,message:'Invalid parameter"; no track IDs specified to remove.'}):void 0:new s.default({code:s.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."})};var r=c(n(84499)),o=c(n(90283)),a=n(77126),i=n(40481),s=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412));function c(e){return e&&e.__esModule?e:{default:e}}},87937:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{emitEvent:t,context:n,logManager:r}=e;return async function(e){const f=(0,l.getRequestInfo)(n.getState()),p=(0,l.getConnectionInfo)(n.getState());if(!f.username)throw new u.default({code:u.authCodes.INVALID_CREDENTIALS,message:"Cannot make request: No username set. Please set credentials."});if(!p||!p.server||!p.server.server)throw new u.default({code:u.authCodes.INVALID_STATE,message:"Cannot make request: No connection info set. Please ensure a server is configured and user credentials set."});if(!e.url&&e.endpoint){const{baseURL:t,version:n,userType:r,userId:o}=f,a=`${t}/rest/version/${n}/${r}/${o}`;e.url=a+(e.endpoint.startsWith("/")?"":"/")+e.endpoint}const g=f.requestOptions;e=(0,d.default)(g,e);const _=o.request(e);n.dispatch(_);const E=r.getLogger("REQUEST",_.meta.requestId),y=(0,c.sanitizeRequest)(_.payload);E.debug(`Making REST request ${_.meta.requestId}.`,y);const S=await(0,s.default)(_.payload,_.meta.requestId,n);E.debug(`Received REST response ${_.meta.requestId}.`,S);const v=i.linkAuthorization(S);return v&&t(a.REQUEST_ERROR,{error:v}),n.dispatch(o.response(_.meta.requestId,S,!!S.error)),S}},t.logFakeAction=function(e,t){let{getState:n,container:o}=e;const a=o.logManager.getLogger("ACTION"),i=n().config.logs,{logActions:s,logLevel:c}=i;if(!s)return;const{collapsed:l,actionOnly:u,exposePayloads:d}=s,f=l?"groupCollapsed":"group",p=!1===d||t.meta&&t.meta.isSensitive?(0,r.default)("payload",t):t;a[f](`action ${t.type} @ ${function(){const e=new Date,t=(e,t)=>{return n=t-e.toString().length,new Array(n+1).join("0")+e;var n};return`${t(e.getHours(),2)}:${t(e.getMinutes(),2)}:${t(e.getSeconds(),2)}.${t(e.getMilliseconds(),3)}`}()} (in 0.00 ms)`),"DEBUG"===c&&(u?a.debug("action    ",p):(a.debug("prev state",n()),a.debug("action    ",p),a.debug("next state",n()))),a.groupEnd()};var r=p(n(14017)),o=f(n(91619)),a=f(n(19251)),i=f(n(38577)),s=p(n(18439)),c=n(67426),l=n(87075),u=f(n(75412)),d=p(n(7485));function f(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(f=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}function p(e){return e&&e.__esModule?e:{default:e}}},88058:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.webrtcCodes=t.usersCodes=t.subscriptionCodes=t.sipEventCodes=t.proxyCodes=t.presenceCodes=t.mwiCodes=t.messagingCodes=t.groupsCodes=t.connectivityCodes=t.clickToCallCodes=t.callHistoryCodes=t.callCodes=t.bridgeCodes=t.authCodes=void 0,t.authCodes={INVALID_CREDENTIALS:"authentication:1",CONNECT_FAIL_WS_ERROR:"authentication:2",UNSUBSCRIBE_FAIL:"authentication:3",SUBSCRIBE_FAIL:"authentication:4",UPDATE_SUBSCRIPTION_FAIL:"authentication:6",INVALID_STATE:"authentication:7",MISSING_SERVICE:"authentication:12",SUBSCRIBE_UNAVAILABLE:"authentication:13"},t.callCodes={UNKNOWN_ERROR:"call:1",GENERIC_ERROR:"call:2",INIT_MEDIA_FAILED:"call:3",USER_MEDIA_ERROR:"call:4",NOT_SUPPORTED:"call:5",INVALID_STATE:"call:6",INVALID_PARAM:"call:7",STATE_DESYNC:"call:8",INVALID_OFFER:"call:9",NO_ICE_CANDIDATES:"call:10",SESSION_MISMATCH:"call:11",GLARE:"call:12"},t.callHistoryCodes={UNKNOWN_ERROR:"callHistory:1",BAD_REQUEST:"callHistory:2",NOT_FOUND:"callHistory:3",NOT_AUTHENTICATED:"callHistory:4",FORBIDDEN:"callHistory:5"},t.clickToCallCodes={MISSING_ARGS:"clickToCall:1",RESPONSE_ERROR:"clickToCall:2"},t.groupsCodes={UNKNOWN_ERROR:"groups:1",GENERIC_ERROR:"groups:2",MISSING_PARAMETERS:"groups:3"},t.messagingCodes={SEND_MESSAGE_FAIL:"messaging:5"},t.mwiCodes={FETCH_MWI_FAIL:"mwi:1"},t.sipEventCodes={UNKNOWN_ERROR:"sipEvents:1",NOT_PROVISIONED:"sipEvents:2",NOT_SUBSCRIBED:"sipEvents:3"},t.bridgeCodes={UNKNOWN_ERROR:"audioBridge:1",INVALID_INPUT:"audioBridge:2",ALREADY_EXISTS:"audioBridge:3",NOT_FOUND:"audioBridge:4",NOT_SUPPORTED:"audioBridge:5",MEDIA_NOT_FOUND:"audioBridge:6",INVALID_STATE:"audioBridge:7"},t.subscriptionCodes={WS_CONNECTION_ERROR:"subscription:1",NO_SERVICE_PROVIDED:"subscription:2",GENERIC_ERROR:"subscription:3",INVALID_STATE:"subscription:4"},t.connectivityCodes={WS_MESSAGE_ERROR:"connectivity:1"},t.presenceCodes={INVALID_STATUS:"presence:1",INVALID_ACTIVITY:"presence:2",INVALID_REQUEST:"presence:3",INVALID_PARAM:"presence:4"},t.usersCodes={UNKNOWN:"users:1",REFRESH_CONTACTS_FAIL:"users:2",DIRECTORY_REQUEST_FAIL:"users:3",INVALID_PARAM:"users:4"},t.webrtcCodes={INVALID_PARAM:"webrtc:1",INVALID_TRACK_ID:"webrtc:2",TRACK_IN_USE:"webrtc:3",TRACK_NOT_LOCAL:"webrtc:4"},t.proxyCodes={INVALID_PARAM:"proxy:1",SET_PROXY_CHANNEL_FAIL:"proxy:2",IN_ACTIVE_CALL:"proxy:3",VERSION_MISMATCH:"proxy:4",INVALID_STATE:"proxy:5",TIMEOUT:"proxy:6",UNKNOWN:"proxy:7"}},88088:(e,t,n)=>{"use strict";var r=n(96893),o=n(64466),a=n(39123);e.exports=r?function(e,t,n){return o.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},88131:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"setTurnCredentials",{enumerable:!0,get:function(){return o.default}});var r,o=(r=n(56731))&&r.__esModule?r:{default:r}},88185:(e,t,n)=>{"use strict";var r=n(14848).compose;t.__esModule=!0,t.composeWithDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}}},88351:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,l){const u=s.default.parse(t);if(!(0,o.default)(e))return s.default.write(u);const d=Object.freeze(u);let f,p,g=(0,a.default)(d);const _=[],E=e.map((e,t)=>e.name||`<anonymous> at index ${t}`);l.debug(`Running SDP handlers: ${E}`),e.forEach((e,t)=>{const o=E[t];if((0,r.default)(e))try{p=(0,a.default)(g),g=e(g,n,d),f=(0,c.default)(p,g),_.push({name:o,diff:f.text})}catch(e){l.info(`Currently running pipeline to ${n.step} ${n.endpoint} ${n.type} for callId: ${n.callId}`),l.error(`Error running SDP handler: ${o}`,e)}else l.error("SDP handler not a function; skipping."),_.push({name:o,diff:"No diff, not a function."})}),f=(0,c.default)(d,g);const y=(0,i.sdpToYaml)(n)(d)(g)(_)(f);return l.debug(`SDP Handler changes: ${y}`),s.default.write(g)},n(69375),n(81045),n(5350),n(84915);var r=l(n(30524)),o=l(n(90283)),a=l(n(89321)),i=n(88784),s=l(n(54722)),c=l(n(94574));function l(e){return e&&e.__esModule?e:{default:e}}},88398:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{contacts:(0,o.default)(e),user:(0,r.default)(e)}};var r=a(n(58526)),o=a(n(2321));function a(e){return e&&e.__esModule?e:{default:e}}},88401:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{calls:(0,r.default)(e.calls,t),turn:(0,o.default)(e.turn,t)}};var r=a(n(41905)),o=a(n(92834));function a(e){return e&&e.__esModule?e:{default:e}}},88500:(e,t,n)=>{"use strict";var r=n(39944),o=n(3770),a=n(12913);e.exports=function(e,t,n){var i,s;o(e);try{if(!(i=a(e,"return"))){if("throw"===t)throw n;return n}i=r(i,e)}catch(e){s=!0,i=e}if("throw"===t)throw n;if(s)throw i;return o(i),n}},88784:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sdpToYaml=void 0;var r=l(n(68015)),o=l(n(59419)),a=l(n(5968)),i=l(n(80880)),s=l(n(93054)),c=l(n(54722));function l(e){return e&&e.__esModule?e:{default:e}}t.sdpToYaml=e=>t=>n=>r=>o=>`\n---\nsdp-pipeline-run:\n  info:\n    callId: ${e.callId}\n    type: ${e.type}\n    step: ${e.step}\n    endpoint: ${e.endpoint}\n    bandwidth: ${u(e.bandwidth)}\n  sdp: |\n    ${d(g)(t)}\n  handlers:\n    ${f(r)}\n  final:\n    diff: |\n      ${p(_)(o.text)}\n    sdp: |\n      ${o.changed?d(_)(n):"No changes to the SDP"}\n...\n`;const u=e=>e&&JSON.stringify(e,null," ").replace(/\n/g," ").replace(/ {2}/g," "),d=e=>t=>c.default.write(t).replace(/\n/g,`\n${e}`).trimEnd(),f=(0,s.default)([r.default,(0,o.default)(" \n"),(0,i.default)(""),(0,a.default)(e=>{let{name:t,diff:n}=e;return`${g}- name: ${t.replace(/\n/g,"")}\n      diff: |\n        ${p(E)(n)}\n`})]),p=e=>t=>t?t.replace(/\n/g,`\n${e}`):"No changes found",g="    ",_="      ",E="        "},88851:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeSdesFromSdp=function(e,t,n){for(const t of e.media)t.crypto&&t.fingerprint&&delete t.crypto;return e}},88861:(e,t,n)=>{var r=n(65650),o=n(31623),a=n(46285),i=n(33934),s=n(95894),c=n(49828),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,d,f){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var g=1&r;if(p||(p=c),e.size!=t.size&&!g)return!1;var _=f.get(e);if(_)return _==t;r|=2,f.set(e,t);var E=i(p(e),p(t),r,l,d,f);return f.delete(e),E;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},89055:(e,t,n)=>{"use strict";var r=n(5234);e.exports=!r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},89077:()=>{},89129:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearMessages=function(e,t){return{type:r.CLEAR_MESSAGES,payload:{destination:e,type:t}}},t.deleteMessage=function(e,t,n){return{type:r.DELETE_MESSAGE,payload:{destination:e,type:t,messageId:n}}},t.deleteMessageFinish=function(e){let{destination:t,type:n,messageId:o,error:a}=e;return{type:r.DELETE_MESSAGE_FINISH,payload:a||{destination:t,type:n,messageId:o},error:!!a}},t.fetchMessages=function(e,t,n){return{type:r.FETCH_MESSAGES,payload:{destination:e,amount:t,type:n}}},t.fetchMessagesFinished=function(e,t,n,o){return{type:r.FETCH_MESSAGES_FINISHED,payload:o||{destination:e,type:t,messages:n},error:!!o}},t.incomingMessageRead=void 0,t.messageReceived=function(e,t,n,o,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{type:"im",newConversation:!1};return{type:r.MESSAGE_RECEIVED,meta:i,payload:{destination:e,message:{timestamp:a,isPending:!1,read:!1,parts:t,sender:o,messageId:n}}}},t.sendMessageRead=t.sendMessageFinish=t.sendMessage=void 0,t.sendMessageReadFinish=function(e){let{messageId:t,participant:n,error:o}=e;return{type:r.SEND_MESSAGE_READ_FINISH,payload:o||{messageId:t,participant:n},error:Boolean(o)}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(87834));function o(e,t,n){return{type:e,payload:{messageId:t,participant:n}}}t.sendMessage=(e,t,n,o,a)=>function(e,t,n,r,o,a){return{type:e,payload:{destination:t,id:a,message:{timestamp:r,isPending:!0,read:!1,parts:n,type:o}}}}(r.SEND_MESSAGE,e,t,n,o,a),t.sendMessageFinish=e=>{let{destination:t,sender:n,type:o,parts:a,timestamp:i,messageId:s,deliveryStatus:c,error:l}=e;return{type:r.SEND_MESSAGE_FINISH,payload:{destination:t,sender:n,type:o,parts:a,timestamp:i,messageId:s,deliveryStatus:c,error:l},error:Boolean(l)}},t.incomingMessageRead=(e,t)=>o(r.INCOMING_MESSAGE_READ,e,t),t.sendMessageRead=(e,t)=>o(r.SEND_MESSAGE_READ,e,t)},89321:(e,t,n)=>{var r=n(92673)("cloneDeep",n(46108),n(76648));r.placeholder=n(22991),e.exports=r},89339:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>se});var r={};n.r(r),n.d(r,{fixNegotiationNeeded:()=>b,shimAddTrackRemoveTrack:()=>A,shimAddTrackRemoveTrackWithNative:()=>O,shimGetSendersWithDtmf:()=>I,shimGetUserMedia:()=>h,shimMediaStream:()=>T,shimOnTrack:()=>C,shimPeerConnection:()=>R,shimSenderReceiverGetStats:()=>m});var o={};n.r(o),n.d(o,{shimAddTransceiver:()=>F,shimCreateAnswer:()=>U,shimCreateOffer:()=>x,shimGetDisplayMedia:()=>M,shimGetParameters:()=>H,shimGetUserMedia:()=>N,shimOnTrack:()=>w,shimPeerConnection:()=>P,shimRTCDataChannel:()=>j,shimReceiverGetStats:()=>D,shimRemoveStream:()=>k,shimSenderGetStats:()=>L});var a={};n.r(a),n.d(a,{shimAudioContext:()=>z,shimCallbacksAPI:()=>G,shimConstraints:()=>V,shimCreateOfferLegacy:()=>Y,shimGetUserMedia:()=>$,shimLocalStreamsAPI:()=>W,shimRTCIceServerUrls:()=>K,shimRemoteStreamsAPI:()=>B,shimTrackEventTransceiver:()=>q});var i={};n.r(i),n.d(i,{removeExtmapAllowMixed:()=>re,shimAddIceCandidateNullOrEmpty:()=>oe,shimConnectionState:()=>ne,shimMaxMessageSize:()=>ee,shimParameterlessSetLocalDescription:()=>ae,shimRTCIceCandidate:()=>Q,shimRTCIceCandidateRelayProtocol:()=>Z,shimSendThrowTypeError:()=>te});let s=!0,c=!0;function l(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseFloat(r[n],10)}function u(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);const a=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,a),o.apply(this,[e,a])};const a=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function d(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(s=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function f(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function p(){if("object"==typeof window){if(s)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function g(e,t){c&&console.warn(e+" is deprecated, please use "+t+" instead.")}function _(e){return"[object Object]"===Object.prototype.toString.call(e)}function E(e){return _(e)?Object.keys(e).reduce(function(t,n){const r=_(e[n]),o=r?E(e[n]):e[n],a=r&&!Object.keys(o).length;return void 0===o||a?t:Object.assign(t,{[n]:o})},{}):e}function y(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(r=>{r.endsWith("Id")?y(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(t=>{y(e,e.get(t),n)})}))}function S(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;const a=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&y(e,n,o)})}),o}const v=p;function h(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[o("min",n)]=r.ideal,t.optional.push(e),e={},e[o("max",n)]=r.ideal,t.optional.push(e)):(e[o("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,o){if(t.version>=61)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});const i=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||i)){let t;if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?t=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{let i=(n=n.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!i&&n.length&&t.includes("back")&&(i=n[n.length-1]),i&&(e.video.deviceId=a.exact?{exact:i.deviceId}:{ideal:i.deviceId}),e.video=r(e.video),v("chrome: "+JSON.stringify(e)),o(e)})}e.video=r(e.video)}return v("chrome: "+JSON.stringify(e)),o(e)},a=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){o(e,e=>{n.webkitGetUserMedia(e,t,e=>{r&&r(a(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return o(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(a(e))))}}}function T(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function C(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const o=new Event("track");o.track=n.track,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],this.dispatchEvent(o)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=[t.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else u(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function I(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function m(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>S(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),u(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>S(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function O(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),o.apply(this,arguments)}}function A(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return O(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const o=e.RTCPeerConnection.prototype.removeStream;function a(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(o.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(e=>e.track===t))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=a(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>a(this,e))}};e.RTCPeerConnection.prototype[t]=r[t]});const i=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),o.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),i.apply(this,arguments)):i.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:a(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function R(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]})}function b(e,t){u(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}function N(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){g("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function M(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function w(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function P(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,o,a]=arguments;return r.apply(this,[e||null]).then(e=>{if(t.version<53&&!o)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(o,a)}}function L(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function D(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),u(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function k(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){g("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function j(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function F(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach(e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return r})}function H(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function x(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function U(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function W(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function B(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function G(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,i=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};let s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}function $(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(V(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function V(e){return e&&void 0!==e.video?Object.assign({},e,{video:E(e.video)}):e}function K(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];void 0===r.urls&&r.url?(g("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function q(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Y(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function z(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var J=n(39986),X=n.n(J);function Q(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),r=X().parseCandidate(e.candidate);for(const e in r)e in n||Object.defineProperty(n,e,{value:r[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,u(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Z(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||u(e,"icecandidate",e=>{if(e.candidate){const t=X().parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function ee(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=X().splitSections(e.sdp);return t.shift(),t.some(e=>{const t=X().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),r=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const o=X().matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?r=parseInt(o[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],e);let o;o=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>o}),this._sctp=a}return n.apply(this,arguments)}}function te(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],o=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},u(e,"datachannel",e=>(t(e.channel,e.target),e))}function ne(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function re(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function oe(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ae(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?n.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(e=>n.apply(this,[e]))})}const ie=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=p,s=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const e=n.userAgentData.brands.find(e=>"Chromium"===e.brand);if(e)return{browser:"chrome",version:parseInt(e.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(l(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(l(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(l(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=l(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),c={browserDetails:s,commonShim:i,extractVersion:l,disableLog:d,disableWarnings:f,sdp:J};switch(s.browser){case"chrome":if(!r||!R||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),c;if(null===s.version)return n("Chrome shim can not determine version, not shimming."),c;n("adapter.js shimming chrome."),c.browserShim=r,oe(e,s),ae(e),h(e,s),T(e),R(e,s),C(e),A(e,s),I(e),m(e),b(e,s),Q(e),Z(e),ne(e),ee(e,s),te(e),re(e,s);break;case"firefox":if(!o||!P||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),c;n("adapter.js shimming firefox."),c.browserShim=o,oe(e,s),ae(e),N(e,s),P(e,s),w(e),k(e),L(e),D(e),j(e),F(e),H(e),x(e),U(e),Q(e),ne(e),ee(e,s),te(e);break;case"safari":if(!a||!t.shimSafari)return n("Safari shim is not included in this adapter release."),c;n("adapter.js shimming safari."),c.browserShim=a,oe(e,s),ae(e),K(e),Y(e),G(e),W(e),B(e),q(e),$(e),z(e),Q(e),Z(e),ee(e,s),te(e),re(e,s);break;default:n("Unsupported browser!")}return c}({window:"undefined"==typeof window?void 0:window}),se=ie},89413:(e,t,n)=>{var r=n(94715)(n(78942),"Promise");e.exports=r},89445:e=>{"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},89536:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const{context:r}=e;return{start:async function(e,o){if(t.tracker.start(),n.validate){const a=n.validate(r.getState(),e,...o);if(a)throw t.reportEvent.endEvent(a),t.tracker.finish(a),a}try{const r=await n.localOffer(e,...o);return n.signalling&&(t.tracker.update(),await n.signalling(e,...o,r)),t.reportEvent.endEvent(),t.tracker.finish(),r}catch(e){throw t.reportEvent.endEvent(e),t.tracker.finish(e),e}}}}},89624:(e,t,n)=>{var r=n(93655),o=n(64759),a=n(41580),i=n(64066),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,f=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||o(e))&&(r(e)?f:s).test(i(e))}},89809:(e,t,n)=>{"use strict";var r=n(48944);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},89968:(e,t)=>{"use strict";function n(e){return e.replace(/[ \-.()+]/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSipUri=function(e,t){const r=function(e,t){const n=function(e){const t=e.lastIndexOf("@");return 0!==t&&t!==e.length-1&&-1!==t?e.substr(t+1):""}(e);return n?{address:e.substr(0,e.length-n.length-1),domain:n}:{address:e,domain:t}}(e=e.trim(),t);t=r.domain;const o=function(e){const t=e.match(/^.*:/g);return t&&t[0]?t[0]:""}(e=r.address),a=function(e){const t=e.match(/^[#+*]+[\d|(][\d \-.()+]*$/g);return t&&t[0]?t[0].match(/[#+*]+/g)[0]:""}(e=e.substr(o.length));return e=e.substr(a.length),"sip:"+a+(function(e){const t=n(e).match(/^\d+$/g);return t&&1===t.length}(s=e)?n(s):s)+(""===(i=t)||void 0===i?"":0===i.indexOf("@")?i:"@"+i);var i,s}},89974:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.callCancelled",()=>({remote:{remoteOffer:(0,o.default)(e.container)}})),e.factory("Callstack.operations.callCancelled",()=>{const t=e.container.Callstack.models.Update;return n=>t.instance({type:a.OPERATIONS.CALL_CANCEL,isLocal:!1,stages:e.container.Callstack.stages.callCancelled.remote},{callId:n})})};var r,o=(r=n(350))&&r.__esModule?r:{default:r},a=n(59090)},90028:e=>{"use strict";e.exports=function(e,t){for(var n={},r=Object.keys(e),o=Array.isArray(t),a=0;a<r.length;a++){var i=r[a],s=e[i];(o?-1!==t.indexOf(i):t(i,s,e))&&(n[i]=s)}return n}},90103:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{CallReporter:t,context:n,emitEvent:l,logManager:u,WebRTC:d}=e;return async function(e,f){let p=(0,r.getCallByWebrtcSessionId)(n.getState(),e);const g=(0,r.getOptions)(n.getState()),_=u.getLogger("CALL",p?p.id:""),E=t.getReport(p.id).findLastOngoingEvent(Object.values(i.ICE_COLLECTION_OPERATIONS));let y,S;if(E){const e=E.timeline.find(e=>e.type===i.REPORT_EVENTS.PROCESS_MEDIA_LOCAL);if(e){const t=f.iceCandidates.filter(e=>"rtp"===e.component&&"relay"===e.type);if(y=e.timeline.find(e=>e.type===i.REPORT_EVENTS.ICE_COLLECTION),y||(y=e.addEvent(i.REPORT_EVENTS.ICE_COLLECTION)),t.length>0){const e=y.getData("relayCandidates")||[];t.forEach(n=>{if(!e.includes(n)){const e=y.addEvent(i.REPORT_EVENTS.RELAY_CANDIDATE_COLLECTED);e.addData("address",n.address),e.addData("port",n.port),e.endEvent(),y.addData("relayCandidates",t)}})}}}else _.error("ICE collection process could not determine current operation.");_.debug("Calling ICE collection check function for reason:",f.reason);try{const e=p.currentOperations.find(e=>{if(E)return e.eventId===E.id});S=g.iceCollectionCheckFunction({callId:p.id,callOperation:e?e.type:"UNKNOWN",...f},{iceCollectionIdealTimeout:g.iceCollectionIdealTimeout,iceCollectionMaxTimeout:g.iceCollectionMaxTimeout}),"object"==typeof S&&Object.values(a.ICE_COLLECTION_RESULT_TYPES).includes(S.type)?S.type===a.ICE_COLLECTION_RESULT_TYPES.ERROR&&(S={type:a.ICE_COLLECTION_RESULT_TYPES.ERROR,error:new c.default({message:S.error,code:c.callCodes.GENERIC_ERROR})}):(_.error("Configured IceCollectionCheckFunction returned an invalid result type. Ending call.",S),S={type:a.ICE_COLLECTION_RESULT_TYPES.ERROR,error:new c.default({code:c.callCodes.INVALID_PARAM,message:"Malformed IceCollectionCheckResult provided by configured IceCollectionCheckFunction."})})}catch(e){_.info("Error thrown by the iceCollectionCheckFunction. Ending call.",e),S={type:a.ICE_COLLECTION_RESULT_TYPES.ERROR,error:new c.default({code:c.callCodes.UNKNOWN_ERROR,message:"Configured IceCollectionCheckFunction threw an error during ICE collection."})}}const v=await d.sessionManager.get(e);v&&(_.debug("Handling ICE collection check result:",S.type),await v.iceCollectionCheckResult(S),y&&!y.isEnded()&&S.type!==a.ICE_COLLECTION_RESULT_TYPES.WAIT&&(S.type===a.ICE_COLLECTION_RESULT_TYPES.ERROR&&y.setError(S),y.endEvent()),p=(0,r.getCallByWebrtcSessionId)(n.getState(),e),S.type===a.ICE_COLLECTION_RESULT_TYPES.ERROR&&p.state!==a.CALL_STATES.ENDED&&(n.dispatch(o.callActions.endCallFinish(p.id,{isLocal:!0,error:S.error})),l(s.CALL_STATE_CHANGE,{callId:p.id,previous:{state:p.state,localHold:p.localHold,remoteHold:p.remoteHold},error:S.error})))}},n(62234),n(81045),n(30163),n(45950),n(5350);var r=n(40481),o=n(35),a=n(77126),i=n(84581),s=n(51918),c=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},90283:(e,t,n)=>{var r=n(92673)("isArray",n(53142),n(76648));r.placeholder=n(22991),e.exports=r},90313:(e,t,n)=>{var r=n(11129),o=n(20714);e.exports=function e(t,n,a,i,s){var c=-1,l=t.length;for(a||(a=o),s||(s=[]);++c<l;){var u=t[c];n>0&&a(u)?n>1?e(u,n-1,a,i,s):r(s,u):i||(s[s.length]=u)}return s}},90353:(e,t,n)=>{var r=n(51340),o=n(33934),a=n(88861),i=n(31182),s=n(28486),c=n(53142),l=n(75853),u=n(8666),d="[object Arguments]",f="[object Array]",p="[object Object]",g=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,_,E,y){var S=c(e),v=c(t),h=S?f:s(e),T=v?f:s(t),C=(h=h==d?p:h)==p,I=(T=T==d?p:T)==p,m=h==T;if(m&&l(e)){if(!l(t))return!1;S=!0,C=!1}if(m&&!C)return y||(y=new r),S||u(e)?o(e,t,n,_,E,y):a(e,t,h,n,_,E,y);if(!(1&n)){var O=C&&g.call(e,"__wrapped__"),A=I&&g.call(t,"__wrapped__");if(O||A){var R=O?e.value():e,b=A?t.value():t;return y||(y=new r),E(R,b,n,_,y)}}return!!m&&(y||(y=new r),i(e,t,n,_,E,y))}},90636:(e,t,n)=>{var r=n(92673)("remove",n(65079));r.placeholder=n(22991),e.exports=r},90959:(e,t,n)=>{var r=n(52291),o=n(28931),a=n(17905),i=n(82237),s=n(95243),c=/^\s+/;e.exports=function(e,t,n){if((e=s(e))&&(n||void 0===t))return e.replace(c,"");if(!e||!(t=r(t)))return e;var l=i(e),u=a(l,i(t));return o(l,u).join("")}},91173:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){const n=n=>{const r=e.get(n),a=r.getState();a.sourceMuted=a.muted,a.muted=!a.enabled,delete a.enabled,delete a.id,(0,i.default)(r,t);const s=o.trackActions.trackAdded(n,a);t(s)},r=n=>{const r=o.trackActions.trackRemoved(n),i=e.get(n).isDetached()?{type:a.TRACK_ENDED,args:{trackId:n,isLocal:!0,detached:!0}}:void 0;t(r,i)};return e.on("add",n),e.on("remove",r),()=>{e.off("add",n),e.off("remove",r)}};var r,o=n(66446),a=n(51709),i=(r=n(48240))&&r.__esModule?r:{default:r}},91375:()=>{},91463:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WS_CHANGE=void 0,t.WS_CHANGE="ws:change"},91619:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authorizationError=function(e){return{error:!0,type:r.AUTHORIZATION_ERROR,payload:e}},t.request=function(e){return{type:r.REQUEST,payload:e,meta:{requestId:o++}}},t.response=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:r.RESPONSE,payload:t,error:n,meta:{requestId:e}}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(40603)),o=0},91708:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CALL_HISTORY_ERROR=t.CALL_HISTORY_CHANGE=t.CALL_HISTORY_CACHE_CHANGE=void 0,t.CALL_HISTORY_CHANGE="callHistory:change",t.CALL_HISTORY_ERROR="callHistory:error",t.CALL_HISTORY_CACHE_CHANGE="callHistoryCache:change"},91786:(e,t,n)=>{"use strict";var r=n(74418),o=n(14188),a=n(83628),i=n(40168),s=n(50680),c=i("IE_PROTO"),l=Object,u=l.prototype;e.exports=s?l.getPrototypeOf:function(e){var t=a(e);if(r(t,c))return t[c];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?u:null}},91822:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{logManager:t,TimerTracker:n,Connectivity:o}=e,a=t.getLogger("CONNECTIVITY");a.info("Cleaning up connectivity plugin"),n.clearAllByType("connectivity");const i=(0,r.getConnectionState)(e.context.getState());i&&i.connected&&(a.debug("Closing websocket."),o.disconnect())};var r=n(94482)},91856:(e,t,n)=>{var r=n(92673)("flowRight",n(73741));r.placeholder=n(22991),e.exports=r},91883:(e,t,n)=>{"use strict";var r=n(97509),o=n(16881),a=n(92618),i=n(89445),s=URLSearchParams,c=s.prototype,l=o(c.getAll),u=o(c.has),d=new s("a=1");!d.has("a",2)&&d.has("a",void 0)||r(c,"has",function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return u(this,e);var r=l(this,e);i(t,1);for(var o=a(n),s=0;s<r.length;)if(r[s++]===o)return!0;return!1},{enumerable:!0,unsafe:!0})},92013:e=>{var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",a="[^"+t+"]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+r+"|"+o+")?",l="[\\ufe0e\\ufe0f]?",u=l+c+"(?:\\u200d(?:"+[a,i,s].join("|")+")"+l+c+")*",d="(?:"+[a+r+"?",r,i,s,n].join("|")+")",f=RegExp(o+"(?="+o+")|"+d+u,"g");e.exports=function(e){return e.match(f)||[]}},92140:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,s){const c=(0,r.getCallById)(e,t);if(!c)return new i.default({code:i.callCodes.INVALID_PARAM,message:"Call state not found; invalid call ID."});if([o.CALL_STATES.CANCELLED,o.CALL_STATES.ENDED,o.CALL_STATES.INITIATING].includes(c.state))return new i.default({code:i.callCodes.INVALID_STATE,message:`Call is in an invalid state: ${c.state}.`});try{(0,a.validateMediaConstraints)(s)}catch(e){return e}if(s&&s.medias){if(s.medias.length>1)return new i.default({code:i.callCodes.INVALID_PARAM,message:"Only one detached media can be passed to replace an existing track."});try{(0,a.validateDetachedMedia)(s.medias)}catch(e){return e}}},n(62234);var r=n(40481),o=n(77126),a=n(9066),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},92154:(e,t,n)=>{var r=n(37250),o=n(3334),a=n(67642),i=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var c=null==n?0:a(n);return c<0&&(c=i(s+c,0)),r(e,o(t,3),c)}},92264:(e,t,n)=>{var r=n(58898);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},92480:(e,t,n)=>{var r=n(58898);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},92521:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROXY_ERROR=t.PROXY_CHANGE=void 0,t.PROXY_CHANGE="proxy:change",t.PROXY_ERROR="proxy:error"},92609:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.sendRingingFeedback",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.SEND_RINGING_FEEDBACK,isLocal:!0,stages:{validate:o.default,localOffer:()=>{},signalling:(0,r.default)(e.container)}},{callId:n})}}})};var r=i(n(26021)),o=i(n(82430)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},92618:(e,t,n)=>{"use strict";var r=n(65438),o=String;e.exports=function(e){if("Symbol"===r(e))throw new TypeError("Cannot convert a Symbol value to a string");return o(e)}},92673:(e,t,n)=>{var r=n(93579),o=n(48055);e.exports=function(e,t,n){return r(o,e,t,n)}},92735:(e,t,n)=>{"use strict";var r=n(96893),o=n(74418),a=Function.prototype,i=r&&Object.getOwnPropertyDescriptor,s=o(a,"name"),c=s&&"something"===function(){}.name,l=s&&(!r||r&&i(a,"name").configurable);e.exports={EXISTS:s,PROPER:c,CONFIGURABLE:l}},92742:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,CallstackSDP:i,WebRTC:s,CallReporter:c}=e;return async function(e,l,u){let d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const f=n.getLogger("CALLSTACK"),p=await s.sessionManager.get(l);if(!p)return void f.debug(`webRTC session ${l} not found.`);const{id:g}=(0,r.getCallByWebrtcSessionId)(t.getState(),l),_=(0,r.getOptions)(t.getState());e=i.runPipeline(_.sdpHandlers,e,{callId:g,type:"offer",step:"set",endpoint:"remote"},f);const E=(0,r.getCallById)(t.getState(),g),y=c.getReport(E.id),S=E.currentOperations.find(e=>!e.isLocal),v=y.getEvent(S.eventId),h=v.addEvent(o.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);let T,C,I;try{let t;if(d?await p.recreatePeer(e):t=await p.processOffer({type:"offer",sdp:e}),t)return h.endEvent(t),{error:t};h.endEvent()}catch(e){const t=new a.default({message:e.message,code:a.callCodes.GENERIC_ERROR});throw h.endEvent(t),t}try{I=v.addEvent(o.REPORT_EVENTS.CREATE_ANSWER),T=await p.createAnswer(),I.endEvent()}catch(e){const t=new a.default({message:e.message,code:a.callCodes.GENERIC_ERROR});throw I.endEvent(t),t}try{T.sdp=i.runPipeline(_.sdpHandlers,T.sdp,{callId:g,type:T.type,step:"set",endpoint:"local",bandwidth:u},f),C=v.addEvent(o.REPORT_EVENTS.PROCESS_MEDIA_LOCAL),C.addData("operation",v.type),T=await p.setLocalDescription(T),C.endEvent()}catch(e){const t=new a.default({message:e.message,code:a.callCodes.GENERIC_ERROR});throw C.endEvent(t),t}return{answerSDP:i.runPipeline(_.sdpHandlers,T.sdp,{callId:g,type:T.type,step:"send",endpoint:"local",bandwidth:u},f)}}},n(81045),n(45950);var r=n(40481),o=n(84581),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},92778:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n(65891))&&r.__esModule?r:{default:r},a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(28686));const i={},s={next:e=>({...e,isPending:!0})};i[a.ADD_CONTACT]=s,i[a.REFRESH_CONTACTS]=s,i[a.FETCH_CONTACT]=s,i[a.UPDATE_CONTACT]=s,i[a.ADD_CONTACT_FINISH]={next:(e,t)=>({...e,contacts:{...e.contacts,[t.payload.contactId]:t.payload},isPending:!1}),throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},i[a.REFRESH_CONTACTS_FINISH]={next(e,t){const n={};for(const e of t.payload)n[e.contactId]=e;return{...e,contacts:n,isPending:!1}},throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},i[a.FETCH_CONTACT_FINISH]={next:(e,t)=>({...e,contacts:{...e.contacts,[t.payload.contactId]:t.payload},isPending:!1}),throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},i[a.REMOVE_CONTACT_FINISH]={next:(e,t)=>({...e,contacts:(0,o.default)(t.payload,e.contacts),isPending:!1}),throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},i[a.UPDATE_CONTACT_FINISH]={next:(e,t)=>({...e,contacts:{...e.contacts,[t.payload.contactId]:t.payload},isPending:!1}),throw:(e,t)=>({...e,isPending:!1,errors:e.errors.concat(t.payload)})},t.default=i},92807:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let{method:t}=e;t.includes("time")&&(t="debug");const n=(0,o.default)(e),r=e.messages.slice(1);console[t](n,...r)},n(62234);var r,o=(r=n(42501))&&r.__esModule?r:{default:r}},92834:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(21836)),o=n(45775);const a={};a[r.TURN_CHANGED]={next:(e,t)=>({...e,...t.payload.credentials})};const i=(0,o.handleActions)(a,{});t.default=i},93054:(e,t,n)=>{e.exports=n(91856)},93117:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{api:o.default,capabilities:["config"],name:r.default.name,reducer:r.default.reducer}};var r=a(n(53661)),o=a(n(68909));function a(e){return e&&e.__esModule?e:{default:e}}},93269:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.devicesChanged=function(e){return{type:r.DEVICES_CHANGE,payload:e}},t.initializeDevice=function(e){return{type:r.INITIALIZE_DEVICES,payload:e}},t.initializeDeviceFinish=function(e){let{devices:t,error:n}=e;return{payload:n||t,error:Boolean(n),type:r.INITIALIZE_DEVICES_FINISH}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(81997))},93321:(e,t,n)=>{var r=n(57553),o=n(528),a=n(75962),i=n(53142),s=n(80547),c=n(63410),l=Object.prototype.hasOwnProperty;function u(e){if(s(e)&&!i(e)&&!(e instanceof r)){if(e instanceof o)return e;if(l.call(e,"__wrapped__"))return c(e)}return new o(e)}u.prototype=a.prototype,u.prototype.constructor=u,e.exports=u},93339:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(62234),n(69375),n(81045),n(45950);var r=n(84581);function o(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(o,a){let i;for(let e=o.timeline.length-1;e>=0;e--){const n=o.timeline[e];if(t.includes(n.type)){i=n;break}for(let e=0;e<=n.timeline.length-1;e++){const r=n.timeline[e];if(t.includes(r.type)){i=r;break}}if(i)break}return!(!i||a.type===r.REPORT_EVENTS.PROCESS_MEDIA_REMOTE&&"MAKE_CALL_REMOTE_SETUP"===e&&"MAKE"!==a.getData("operation")||(e===r.REPORT_METRICS.TIME_TO_COLLECT_ICE_CANDIDATES?o.addMetric(e,{operation:i.getData("operation"),duration:a.end-i.start}):(o.addMetric(e,a.end-i.start),n&&o.unregisterMetricHandler(e)),0))}}function a(e,t){return function(n,r){const o=n.timeline.find(e=>t.includes(e.type));return!!o&&(n.addMetric(e,r.start-o.start),n.unregisterMetricHandler(e),!0)}}function i(e,t){return function(n,r){const o=n.timeline.find(e=>t.includes(e.type));return!(!o||o===r||(n.addMetric(e,r.end-o.start),n.unregisterMetricHandler(e),0))}}function s(){const e=[];return(t,n)=>{if(n.type===r.REPORT_EVENTS.RELAY_CANDIDATE_COLLECTED){const t={...n.getData(),duration:n.start};e.push(t)}else n.type===r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL&&(e.map(t=>(t.duration=t.duration-n.start,e)),e.length&&t.addMetric(r.REPORT_METRICS.TIME_TO_RELAY_CANDIDATES,{operation:n.getData("operation"),candidates:[...e]}),e.length=0)}}t.default={handlers:{durationHandler:o,joinedCallDurationHandler:i,relayCandidatesHandler:s},registerAllMetricHandlers:function(e){e.registerMetricHandler(r.REPORT_METRICS.CALL_DURATION,[r.REPORT_EVENTS.END_LOCAL,r.REPORT_EVENTS.END_REMOTE,r.REPORT_EVENTS.JOIN,r.REPORT_EVENTS.DIRECT_TRANSFER,r.REPORT_EVENTS.CONSULTATIVE_TRANSFER],i(r.REPORT_METRICS.CALL_DURATION,[r.REPORT_EVENTS.MAKE,r.REPORT_EVENTS.RECEIVE_CALL,r.REPORT_EVENTS.JOIN])),e.registerMetricHandler(r.REPORT_METRICS.MAKE_CALL_LOCAL_SETUP,[r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL],o(r.REPORT_METRICS.MAKE_CALL_LOCAL_SETUP,[r.REPORT_EVENTS.MAKE])),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_COLLECT_ICE_CANDIDATES,[r.REPORT_EVENTS.ICE_COLLECTION],o(r.REPORT_METRICS.TIME_TO_COLLECT_ICE_CANDIDATES,[r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL],!1)),e.registerMetricHandler(r.REPORT_METRICS.MAKE_CALL_REMOTE_SETUP,[r.REPORT_EVENTS.PROCESS_MEDIA_REMOTE],o(r.REPORT_METRICS.MAKE_CALL_REMOTE_SETUP,[r.REPORT_EVENTS.REST_REQUEST])),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_RINGING,[r.REPORT_EVENTS.REMOTE_RINGING],o(r.REPORT_METRICS.TIME_TO_RINGING,[r.REPORT_EVENTS.MAKE])),e.registerMetricHandler(r.REPORT_METRICS.TIME_FROM_RECEIVE_TO_ANSWER,r.REPORT_EVENTS.ANSWER,o(r.REPORT_METRICS.TIME_FROM_RECEIVE_TO_ANSWER,[r.REPORT_EVENTS.RECEIVE_CALL])),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_CALL_SETUP_DURATION,r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL,o(r.REPORT_METRICS.TIME_TO_CALL_SETUP_DURATION,[r.REPORT_EVENTS.RECEIVE_CALL])),e.registerMetricHandler(r.REPORT_METRICS.ANSWER_CALL_LOCAL_SETUP,r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL,o(r.REPORT_METRICS.ANSWER_CALL_LOCAL_SETUP,[r.REPORT_EVENTS.ANSWER])),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_RELAY_CANDIDATES,[r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL,r.REPORT_EVENTS.RELAY_CANDIDATE_COLLECTED],s()),e.registerMetricHandler(r.REPORT_METRICS.ANSWER_CALL_PRE_LOCAL_SETUP,r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL,a(r.REPORT_METRICS.ANSWER_CALL_PRE_LOCAL_SETUP,[r.REPORT_EVENTS.ANSWER])),e.registerMetricHandler(r.REPORT_METRICS.MAKE_CALL_PRE_LOCAL_SETUP,r.REPORT_EVENTS.PROCESS_MEDIA_LOCAL,a(r.REPORT_METRICS.MAKE_CALL_PRE_LOCAL_SETUP,[r.REPORT_EVENTS.MAKE])),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_REJECT,[r.REPORT_EVENTS.REJECT],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_REJECT,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_IGNORE,[r.REPORT_EVENTS.IGNORE],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_IGNORE,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_ADD_MEDIA,[r.REPORT_EVENTS.ADD_MEDIA,r.REPORT_EVENTS.ADD_BASIC_MEDIA],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_ADD_MEDIA,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_ADD_MEDIA_REMOTE,[r.REPORT_EVENTS.ADD_MEDIA_REMOTE],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_ADD_MEDIA_REMOTE,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_HOLD_LOCAL,[r.REPORT_EVENTS.HOLD_LOCAL],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_HOLD_LOCAL,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_HOLD_REMOTE,[r.REPORT_EVENTS.HOLD_REMOTE],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_HOLD_REMOTE,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_UNHOLD_LOCAL,[r.REPORT_EVENTS.UNHOLD_LOCAL],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_UNHOLD_LOCAL,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_UNHOLD_REMOTE,[r.REPORT_EVENTS.UNHOLD_REMOTE],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_UNHOLD_REMOTE,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_REMOVE_MEDIA,[r.REPORT_EVENTS.REMOVE_MEDIA,r.REPORT_EVENTS.REMOVE_BASIC_MEDIA],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_REMOVE_MEDIA,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_REMOVE_MEDIA_REMOTE,[r.REPORT_EVENTS.REMOVE_MEDIA_REMOTE],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_REMOVE_MEDIA_REMOTE,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_RESTART_MEDIA,r.REPORT_EVENTS.MEDIA_RESTART,(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_RESTART_MEDIA,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_SEND_CUSTOM_PARAMETERS,r.REPORT_EVENTS.SEND_CUSTOM_PARAMETERS,(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_SEND_CUSTOM_PARAMETERS,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_FORWARD,[r.REPORT_EVENTS.FORWARD_CALL],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_FORWARD,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_DIRECT_TRANSFER,[r.REPORT_EVENTS.DIRECT_TRANSFER],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_DIRECT_TRANSFER,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_CONSULTATIVE_TRANSFER,[r.REPORT_EVENTS.CONSULTATIVE_TRANSFER],(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_CONSULTATIVE_TRANSFER,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_JOIN,r.REPORT_EVENTS.JOIN,i(r.REPORT_METRICS.TIME_TO_JOIN,[r.REPORT_EVENTS.JOIN])),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_MAKE,r.REPORT_EVENTS.MAKE,(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_MAKE,n.end-n.start)}),e.registerMetricHandler(r.REPORT_METRICS.TIME_TO_ANSWER,r.REPORT_EVENTS.ANSWER,(t,n)=>{e.addMetric(r.REPORT_METRICS.TIME_TO_ANSWER,n.end-n.start)})}}},93423:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(14782)),o=a(n(34271));function a(e){return e&&e.__esModule?e:{default:e}}var i=(0,r.default)("v5",80,o.default);t.default=i},93449:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,logManager:l,PresenceRequests:u}=e,d=l.getLogger("PRESENCE");return{presenceReceived:function(e){const{dispatch:s,getState:c}=t;if(![i.NOTIFICATION_RECEIVED].includes(e.type))return;if(!e.payload.notificationMessage||"presenceWatcher"!==e.payload.notificationMessage.eventType)return;const l=e.payload.notificationMessage.presenceWatcherNotificationParams,u=(0,a.getAllPresence)(c()).find(e=>e.userId===l.name);if(u&&!u.isPending){d.info(`Received notification of the user(s): ${l.name} present presence.`);const e={userId:l.name,activity:l.activity,status:l.status,note:l.note};s(r.presenceReceived(e)),n(o.RECEIVED,e)}},update:async function(e,n,o){const{dispatch:a}=t;if(a(r.updatePresence(e,n,o)),-1===Object.values(c.STATUS).indexOf(e)){d.debug("Invalid presence status present.");const e=new s.default({code:s.presenceCodes.INVALID_STATUS,message:"Invalid status in presence update request."});throw a(r.updatePresenceFinish(e)),e}if(-1===Object.values(c.ACTIVITY).indexOf(n)){d.debug("Invalid presence activity present.");const e=new s.default({code:s.presenceCodes.INVALID_ACTIVITY,message:"Invalid activity in presence update request."});throw a(r.updatePresenceFinish(e)),e}try{await u.updatePresence(e,n,o),d.debug("Successfully updated presence."),a(r.updatePresenceFinish({status:e,activity:n,note:o}))}catch(e){throw d.debug(`Failed to update presence. Error is: ${e}`),a(r.updatePresenceFinish(e)),e}},fetch:async function(e){const{dispatch:n}=t;n(r.getPresence(e));try{const t=await u.watchPresence(e,"get");n(r.getPresenceFinish(t))}catch(e){throw n(r.getPresenceFinish(e)),e}},subscribe:async function(e){const{dispatch:n}=t;if(n(r.subscribePresence(e)),!e||1===e.length&&!e[0])throw new s.default({message:"No users provided to subscribe to."});try{d.info(`Subscribing to the user(s) ${e} presence.`);const t=await u.watchPresence(e,"watch");d.info(`Finished subscribing to user(s): ${e} with status code: ${t.presenceWatcherResponse.statusCode}`),t.presentityUserId=e,n(r.subscribePresenceFinish(t))}catch(t){throw d.info(`Failed to subscribe to users(s): ${e}. ${t.message}`),t.presentityUserId=e,n(r.subscribePresenceFinish(t)),t}},unsubscribe:async function(e){const{dispatch:n}=t;if(n(r.unsubscribePresence(e)),!e||1===e.length&&!e[0])throw new s.default({message:"No users provided to unsubscribe to."});try{d.info(`UnSubscribing to the user(s) ${e} presence.`);const t=await u.watchPresence(e,"stopwatch");d.info(`Finished unSubscribing to user(s): ${e} with status code: ${t.presenceWatcherResponse.statusCode}`),t.presentityUserId=e,n(r.unsubscribePresenceFinish(t))}catch(t){throw d.info(`Failed to unsubscribe to users(s): ${e}. ${t.message}`),t.presentityUserId=e,n(r.unsubscribePresenceFinish(t)),t}}}},n(62234),n(81045),n(45950);var r=l(n(84157)),o=l(n(84341)),a=n(22612),i=n(70506),s=l(n(75412)),c=n(86606);function l(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},93526:(e,t,n)=>{var r=n(53142),o=n(65187),a=n(96493),i=n(95243);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:a(i(e))}},93579:(e,t,n)=>{var r=n(43565),o=n(22991),a=Array.prototype.push;function i(e,t){return 2==t?function(t,n){return e(t,n)}:function(t){return e(t)}}function s(e){for(var t=e?e.length:0,n=Array(t);t--;)n[t]=e[t];return n}function c(e,t){return function(){var n=arguments.length;if(n){for(var r=Array(n);n--;)r[n]=arguments[n];var o=r[0]=t.apply(void 0,r);return e.apply(void 0,r),o}}}e.exports=function e(t,n,l,u){var d="function"==typeof n,f=n===Object(n);if(f&&(u=l,l=n,n=void 0),null==l)throw new TypeError;u||(u={});var p=!("cap"in u)||u.cap,g=!("curry"in u)||u.curry,_=!("fixed"in u)||u.fixed,E=!("immutable"in u)||u.immutable,y=!("rearg"in u)||u.rearg,S=d?l:o,v="curry"in u&&u.curry,h="fixed"in u&&u.fixed,T="rearg"in u&&u.rearg,C=d?l.runInContext():void 0,I=d?l:{ary:t.ary,assign:t.assign,clone:t.clone,curry:t.curry,forEach:t.forEach,isArray:t.isArray,isError:t.isError,isFunction:t.isFunction,isWeakMap:t.isWeakMap,iteratee:t.iteratee,keys:t.keys,rearg:t.rearg,toInteger:t.toInteger,toPath:t.toPath},m=I.ary,O=I.assign,A=I.clone,R=I.curry,b=I.forEach,N=I.isArray,M=I.isError,w=I.isFunction,P=I.isWeakMap,L=I.keys,D=I.rearg,k=I.toInteger,j=I.toPath,F=L(r.aryMethod),H={castArray:function(e){return function(){var t=arguments[0];return N(t)?e(s(t)):e.apply(void 0,arguments)}},iteratee:function(e){return function(){var t=arguments[1],n=e(arguments[0],t),r=n.length;return p&&"number"==typeof t?(t=t>2?t-2:1,r&&r<=t?n:i(n,t)):n}},mixin:function(e){return function(t){var n=this;if(!w(n))return e(n,Object(t));var r=[];return b(L(t),function(e){w(t[e])&&r.push([e,n.prototype[e]])}),e(n,Object(t)),b(r,function(e){var t=e[1];w(t)?n.prototype[e[0]]=t:delete n.prototype[e[0]]}),n}},nthArg:function(e){return function(t){var n=t<0?1:k(t)+1;return R(e(t),n)}},rearg:function(e){return function(t,n){var r=n?n.length:0;return R(e(t,n),r)}},runInContext:function(n){return function(r){return e(t,n(r),u)}}};function x(e,t,n){if(_&&(h||!r.skipFixed[e])){var o=r.methodSpread[e],i=o&&o.start;return void 0===i?m(t,n):function(e,t){return function(){for(var n=arguments.length,r=n-1,o=Array(n);n--;)o[n]=arguments[n];var i=o[t],s=o.slice(0,t);return i&&a.apply(s,i),t!=r&&a.apply(s,o.slice(t+1)),e.apply(this,s)}}(t,i)}return t}function U(e,t,n){return y&&n>1&&(T||!r.skipRearg[e])?D(t,r.methodRearg[e]||r.aryRearg[n]):t}function W(e,t){for(var n=-1,r=(t=j(t)).length,o=r-1,a=A(Object(e)),i=a;null!=i&&++n<r;){var s=t[n],c=i[s];null==c||w(c)||M(c)||P(c)||(i[s]=A(n==o?c:Object(c))),i=i[s]}return a}function B(t,n){var o=r.aliasToReal[t]||t,a=r.remap[o]||o,i=u;return function(t){var r=d?C:I,s=d?C[a]:n,c=O(O({},i),t);return e(r,o,s,c)}}function G(e,t){return function(){var n=arguments.length;if(!n)return e();for(var r=Array(n);n--;)r[n]=arguments[n];var o=y?0:n-1;return r[o]=t(r[o]),e.apply(void 0,r)}}function $(e,t,n){var o,a=r.aliasToReal[e]||e,l=t,u=H[a];return u?l=u(t):E&&(r.mutate.array[a]?l=c(t,s):r.mutate.object[a]?l=c(t,function(e){return function(t){return e({},t)}}(t)):r.mutate.set[a]&&(l=c(t,W))),b(F,function(e){return b(r.aryMethod[e],function(t){if(a==t){var n=r.methodSpread[a],s=n&&n.afterRearg;return o=s?x(a,U(a,l,e),e):U(a,x(a,l,e),e),o=function(e,t,n){return v||g&&n>1?R(t,n):t}(0,o=function(e,t){if(p){var n=r.iterateeRearg[e];if(n)return function(e,t){return G(e,function(e){var n=t.length;return function(e,t){return 2==t?function(t,n){return e.apply(void 0,arguments)}:function(t){return e.apply(void 0,arguments)}}(D(i(e,n),t),n)})}(t,n);var o=!d&&r.iterateeAry[e];if(o)return function(e,t){return G(e,function(e){return"function"==typeof e?i(e,t):e})}(t,o)}return t}(a,o),e),!1}}),!o}),o||(o=l),o==t&&(o=v?R(o,1):function(){return t.apply(this,arguments)}),o.convert=B(a,t),o.placeholder=t.placeholder=n,o}if(!f)return $(n,l,S);var V=l,K=[];return b(F,function(e){b(r.aryMethod[e],function(e){var t=V[r.remap[e]||e];t&&K.push([e,$(e,t,V)])})}),b(L(V),function(e){var t=V[e];if("function"==typeof t){for(var n=K.length;n--;)if(K[n][0]==e)return;t.convert=B(e,t),K.push([e,t])}}),b(K,function(e){V[e[0]]=e[1]}),V.convert=function(e){return V.runInContext.convert(e)(void 0)},V.placeholder=V,b(L(V),function(e){b(r.realToAlias[e]||[],function(t){V[t]=V[e]})}),V}},93650:(e,t,n)=>{var r=n(48244),o=n(85832),a=n(25288);e.exports=function(e){return r(e,a,o)}},93655:(e,t,n)=>{var r=n(87379),o=n(41580);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},93722:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(94922)),o=a(n(34621));function a(e){return e&&e.__esModule?e:{default:e}}t.default={name:"proxy",api:r.default,reducer:o.default}},93725:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,SubManager:n,logManager:u,API_LOG_TAG:d,emitEvent:f}=e,p=u.getLogger("SUBSCRIPTION");async function g(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments.length>2&&void 0!==arguments[2]&&arguments[2]||p.debug(d+"services.subscribeAsync: ",e,a.type),"string"==typeof a&&Object.values(i.notificationTypes).includes(a)&&(a={type:a}),a.type||(a.type=i.notificationTypes.WEBSOCKET);const u=(0,s.getUserInfo)(t.getState());if(!u||!u.username)throw new l.default({message:"Failed to subscribe user. Please ensure credentials are set.",code:l.subscriptionCodes.INVALID_STATE});e=(0,c.normalizeServices)(e),t.dispatch(r.subscribe(e,a)),f(o.SUB_CHANGE,{reason:void 0});try{await n.subscribe(e,a)}catch(e){throw p.debug(`Subscription failed: ${e.message}`),e}f(o.SUB_CHANGE,{reason:void 0})}async function _(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.notificationTypes.WEBSOCKET;arguments.length>2&&void 0!==arguments[2]&&arguments[2]||p.debug(d+"services.unsubscribeAsync: ",e,a);const c=(0,s.getUserInfo)(t.getState());if(!c||!c.username)throw new l.default({message:"Failed to unsubscribe user: Found no existing subscription with a valid username or a valid access token.",code:l.subscriptionCodes.INVALID_STATE});t.dispatch(r.unsubscribe(e,a)),f(o.SUB_CHANGE,{reason:void 0});try{await n.unsubscribe(e,a)?p.info("Successfully unsubscribed from specified services."):p.info("Successfully unsubscribed from all services.")}catch(e){throw p.debug(`Unsubscribe failed: ${e.message}`),e}f(o.SUB_CHANGE,{})}return{services:{subscribe:async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p.debug(d+"services.subscribe: ",e,n.type);try{const r=(0,s.getUserInfo)(t.getState());if(!r||!r.username)return void f(o.SUB_ERROR,{error:new l.default({message:"Failed to subscribe user. Please ensure credentials are set.",code:l.subscriptionCodes.INVALID_STATE})});await g(e,n,!0)}catch(e){f(o.SUB_ERROR,{error:e})}},subscribeAsync:g,unsubscribe:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.notificationTypes.WEBSOCKET;p.debug(d+"services.unsubscribe: ",e,t);try{await _(e,t,!0)}catch(e){f(o.SUB_ERROR,{error:e})}},unsubscribeAsync:_,getSubscriptions:()=>(p.debug(d+"services.getSubscriptions"),{subscribed:(0,a.getSubscribedServices)(t.getState()),available:(0,a.getRegisteredServices)(t.getState()),isPending:t.getState().subscription.isPending}),changeReasons:i.CHANGE_REASONS}}},n(62234);var r=u(n(49561)),o=u(n(34889)),a=n(56512),i=n(22191),s=n(87075),c=n(1011),l=u(n(75412));function u(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},93914:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.factory("UsersOperations",o.default),e.factory("UsersRequests",a.default),{api:r.createAPI,capabilities:["addContactAsFriend","limitedSearch"],name:r.name,reducer:r.reducer}};var r=n(2549),o=i(n(36786)),a=i(n(33558));function i(e){return e&&e.__esModule?e:{default:e}}n(1698)},94236:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return function(n,r,o){const a=n.media[0].setup;return t.debug(`Changing SDP DTLS role from ${a} to ${e}.`),n.media.map(t=>(t.setup=e,t)),n}},n(81045),n(84915)},94361:(e,t,n)=>{"use strict";var r=n(42937),o=n(87173),a=n(29800),i=n(55558);e.exports=function(e){var t=r(this),n=i(e);return!(o(t)>n.size)&&!1!==a(t,function(e){if(!n.includes(e))return!1},!0)}},94417:(e,t,n)=>{"use strict";var r=n(96893),o=n(64466),a=n(39123);e.exports=function(e,t,n){r?o.f(e,t,a(0,n)):e[t]=n}},94482:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCheckConnectivity=function(e){return e[o.default].checkConnectivity},t.getConnectionState=function(e){return(0,r.default)(e[o.default])},t.getConnectivityConfig=function(e){return e.config[o.default]};var r=a(n(89321)),o=a(n(79317));function a(e){return e&&e.__esModule?e:{default:e}}},94495:(e,t,n)=>{var r=n(78942);e.exports=function(){return r.Date.now()}},94497:(e,t,n)=>{var r=n(94715)(Object,"create");e.exports=r},94574:(e,t,n)=>{"use strict";var r=n(55603),o={modified:"yellow",added:"green",removed:"red"},a={indent:"  ",newLine:"\n",wrap:function(e,t){return r[o[e]](t)},color:!0};function i(e){return"object"==typeof e&&e&&!Array.isArray(e)}function s(e){return"function"==typeof e?e.toString().replace(/\{.+\}/,"{}"):"object"!=typeof e&&"string"!=typeof e||e instanceof RegExp?""+e:JSON.stringify(e)}function c(e,t,n){return n.indent+e+": "+function(e,t){return e.split(t.newLine).map(function(e,n){return 0===n?e:t.indent+e}).join(t.newLine)}(t,n)+n.newLine}function l(e,t,n){return n.wrap("removed","- "+e+": "+s(t))+n.newLine}function u(e,t,n){return n.wrap("added","+ "+e+": "+s(t))+n.newLine}function d(e,t,n){var r,o,a="",f=!1,p="";if(Array.isArray(e)&&Array.isArray(t)){for(var g=0;g<e.length;g++)g<t.length?(r=d(e[g],t[g],n)).changed&&(p+=c(g,r.text,n),f=!0):(p+=l(g,e[g],n),f=!0);if(t.length>e.length){for(;g<t.length;g++)p+=u(g,t[g],n);f=!0}f&&(a="["+n.newLine+p+"]")}else if(i(e)&&i(t)){o=Object.keys(e);var _,E=Object.assign({},t);for(o.sort(),g=0;g<o.length;g++)_=o[g],t.hasOwnProperty(_)?((r=d(e[_],t[_],n)).changed&&(p+=c(_,r.text,n),f=!0),delete E[_]):(p+=l(_,e[_],n),f=!0);var y=Object.keys(E);for(g=0;g<y.length;g++)p+=u(y[g],t[y[g]],n),f=!0;f&&(a="{"+n.newLine+p+"}")}else e!==t&&(a=n.wrap("modified",s(e)+" => "+s(t)),f=!0);return{changed:f,text:a}}e.exports=function(e,t,n){if(!(n=n||{}).color&&n.wrap)throw new Error("Can't specify wrap and color options together.");var r=Object.assign({},a,n);return r.color||(r.wrap=function(e,t){return t}),d(e,t,r)}},94687:(e,t,n)=>{var r=n(90353),o=n(80547);e.exports=function e(t,n,a,i,s){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,a,i,e,s))}},94715:(e,t,n)=>{var r=n(89624),o=n(20155);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},94733:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,API_LOG_TAG:i,WebRTCOperations:s}=e,c=n.getLogger("WEBRTC");return{media:(0,a.default)(e),getBrowserDetails:function(){return c.debug(i+"getBrowserDetails"),(0,o.getBrowserDetails)(t.getState())},webrtc:{setupProxy:function(e){c.debug(i+"webrtc.setupProxy"),(0,r.default)(e)?s.setupProxies(e):c.error("Provided proxies is not an appropriate object.")},teardownProxy:async function(){c.debug(i+"webrtc.teardownProxy"),await s.teardownProxies()}}}};var r=i(n(36705)),o=n(69260),a=i(n(66449));function i(e){return e&&e.__esModule?e:{default:e}}},94793:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.operations.getAvailableCodecs",()=>(0,o.default)(e.container))};var r,o=(r=n(84989))&&r.__esModule?r:{default:r}},94916:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,WebRTC:s,CallstackSDP:c,CallReporter:l}=e;return async function(e){const{defaultPeerConfig:u,turnInfo:d,trickleIceMode:f,callId:p,removeBundling:g}=e,_=e.offer,E=n.getLogger("CALL",p);let y;E.info("Setting up remote WebRTC portions of call.");try{let e=u.iceServers;d&&(e=e.map(e=>({...e,username:d.username,credential:d.password}))),y=await s.sessionManager.create({peer:{rtcConfig:{...u,iceServers:e},trickleIceMode:f,removeBundling:g}})}catch(e){throw E.debug("Failed to create WebRTC Session for incoming Call.",e.message),new i.default({message:e.message,code:i.callCodes.GENERIC_ERROR})}t.dispatch(r.callActions.sessionCreated(p,{webrtcSessionId:y.id}));const S=l.getReport(p).findLastOngoingEvent(a.REPORT_EVENTS.RECEIVE_CALL).addEvent(a.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);S.addData("operation",a.REPORTER_OPERATION_EVENTS_MAP.MAKE_REMOTE),S.addData("isSlowStart",!1);const v=(0,o.getOptions)(t.getState());try{_.sdp=c.runPipeline(v.sdpHandlers,_.sdp,{callId:p,type:_.type,step:"set",endpoint:"remote"}),await y.processOffer({type:"offer",sdp:_.sdp}),S.endEvent(),E.info("Finished setting up remote WebRTC portions of call.")}catch(e){throw S.setError(e),S.endEvent(),e}return y.id}},n(81045),n(84915);var r=n(35),o=n(40481),a=n(84581),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},94922:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,emitEvent:n,ProxyOperations:a,logManager:i,API_LOG_TAG:s}=e,c=i.getLogger("PROXY");async function l(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||c.debug(s+"proxy.setChannelAsync: ",e),await a.setChannel(e),t||n(o.PROXY_CHANGE)}async function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||c.debug(s+"proxy.setProxyModeAsync: ",e),await a.setProxyMode(e),t||n(o.PROXY_CHANGE)}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||c.debug(s+"proxy.initializeRemoteAsync: ",e),await a.initializeRemote(e),t||n(o.PROXY_CHANGE)}return{proxy:{...{getProxyMode(){const{getState:e}=t;return c.debug(s+"proxy.getProxyMode"),(0,r.getProxyState)(e()).proxyMode},getInfo(){const{getState:e}=t;return c.debug(s+"proxy.getInfo"),(0,r.getProxyState)(e())},getProxyDetails(){const{getState:e}=t;return c.debug(s+"proxy.getProxyDetails"),(0,r.getProxyState)(e()).browser}},setChannel:async function(e){c.debug(s+"proxy.setChannel: ",e);try{await l(e,!0)}catch(e){return void n(o.PROXY_ERROR,{error:e})}n(o.PROXY_CHANGE)},setChannelAsync:l,setProxyMode:async function(e){c.debug(s+"proxy.setProxyMode: ",e);try{await u(e,!0)}catch(e){return void n(o.PROXY_ERROR,{error:e})}n(o.PROXY_CHANGE)},setProxyModeAsync:u,initializeRemote:async function(e){c.debug(s+"proxy.initializeRemote: ",e);try{await d(e,!0)}catch(e){return void n(o.PROXY_ERROR,{error:e})}n(o.PROXY_CHANGE)},initializeRemoteAsync:d}}};var r=n(96448),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(92521))},95243:(e,t,n)=>{var r=n(52291);e.exports=function(e){return null==e?"":r(e)}},95397:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{nativePeer:e}=this,t=e.remoteDescription;return t&&t.sdp&&t.type?t:void 0}},95398:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.id="manager";const n=i.logManager.getLogger("PROXY",e.modelType);return new Proxy(e,{get:function(e,i,c){return e.proxyMode&&e.channel?e[i]||"then"!==i?e[i]?e[i]:new Proxy(()=>{},{apply:function(e,t,c){const l={modelType:t.modelType,id:t.id,operation:i,params:c};if(t.proxyMode&&t.channel&&t.channel.send)return new Promise((e,i)=>{const c=Date.now(),u=(0,s.v4)().substring(0,8);n.debug(`Sending manager ${l.operation} operation (${u}).`,l),t.channel.send(u,l,function(s,d){if(s){const{opTiming:e}=s;if(s=s.result,e){const t=Date.now();n.debug(`Received manager ${l.operation} response (${u}).`,s),e&&n.debug(`Remote operation ${l.operation} timing sent: ${c}, receivedRemote: ${e.start}, remoteReplied: ${e.end}, receivedLocal: ${t}`)}}function f(e){if(e&&"multiple"===e.modelType){const t={};return Object.keys(e).forEach(n=>{"modelType"===n||(Array.isArray(n)?t[n]=e[n].map(f):t[n]=f(e[n]))}),t}if(e&&e.modelType)return(0,a.default)(e,t.channel);if(!(0,r.default)(e)){if(!(e&&e.error&&e.name))return e;{const t=new Error;for(const[n,r]of Object.entries(e))t[n]=r;i(t)}}}if(d)i(d);else if((0,o.default)(s)){const t=s.map(f);e(t)}else e(f(s))})})}}):void 0:t[i]}})},n(97107),n(81045),n(5350),n(84915);var r=c(n(64181)),o=c(n(90283)),a=c(n(16128)),i=n(69932),s=n(84596);function c(e){return e&&e.__esModule?e:{default:e}}},95449:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(41181)),o=n(45775);const a={};a[r.MWI_UPDATE]={next:(e,t)=>({...t.payload})};const i=(0,o.handleActions)(a,{});t.default=i},95458:(e,t,n)=>{"use strict";var r=n(4282),o=n(77065),a=n(64466).f,i=r("unscopables"),s=Array.prototype;void 0===s[i]&&a(s,i,{configurable:!0,value:o(null)}),e.exports=function(e){s[i][e]=!0}},95469:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=new Map,t=new o.default;function n(t){return e.get(t)}function a(r){let{trackId:o}=r;const i=n(o);return i&&(t.emit("remove",o),e.delete(o),i.off("ended",a)),Boolean(i)}return{get:n,getTracks:function(t){return t?t.map(t=>e.get(t)):Array.from(e.values())},add:function(n,o,i,s,c){const l=e.get(n.id);if(l&&!l.getStream().active&&i.active)return l.setStream(i),l;if(l)return l;{const l=new r.default(n,i);return l.setType(o),l.setIsLocal(s),l.setIsDetached(c),e.set(n.id,l),l.once("ended",e=>{e.isUnsolicited&&!e.isDetached||a({trackId:n.id})}),t.emit("add",l.id),l}},remove:a,on:function(){return t.on(...arguments)},once:function(){return t.once(...arguments)},off:function(){return t.off(...arguments)}}},n(81045),n(84915);var r=a(n(15626)),o=a(n(19353));function a(e){return e&&e.__esModule?e:{default:e}}},95691:(e,t,n)=>{"use strict";var r=n(38689),o=n(16881);e.exports=function(e){if("Function"===r(e))return o(e)}},95894:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},96002:e=>{"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},96042:(e,t,n)=>{var r=n(92673)("merge",n(82451));r.placeholder=n(22991),e.exports=r},96049:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n){await s(e,t,n)}},t.signalling=s;var r=n(35),o=n(40481),a=n(77126),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918));async function s(e,t,n){const{context:s,CallRequests:c,CallstackWebrtc:l,logManager:u,emitEvent:d}=e,f=u.getLogger("CALL",t),p=(0,o.getCallById)(s.getState(),t);try{if("ANSWERED"===(n||await c.getSession({wrtcsSessionId:p.wrtcsSessionId,id:t})).state&&p.state!==a.CALL_STATES.CONNECTED&&p.state!==a.CALL_STATES.ON_HOLD){f.info("Call re-sync found that call was answered elsewhere. Cancelling call."),await l.closeCall(p.webrtcSessionId);const e=(0,o.getCallById)(s.getState(),t);e.state!==a.CALL_STATES.ENDED&&e.state!==a.CALL_STATES.CANCELLED&&(s.dispatch(r.callActions.callCancelled(p.id)),d(i.CALL_STATE_CHANGE,{callId:t,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}))}else f.info("Call re-sync found that there are no changes necessary for the call"),s.dispatch(r.callActions.resyncFinish(p.id))}catch(e){if(47!==e.code)throw f.info(`Call re-sync failure (${e.code}).`,e),e;{f.info("Call re-sync found that the call has ended. Ending Call."),await l.closeCall(p.webrtcSessionId);const n=(0,o.getCallById)(s.getState(),t);n.state!==a.CALL_STATES.ENDED&&n.state!==a.CALL_STATES.CANCELLED&&(s.dispatch(r.callActions.endCallFinish(p.id,{isLocal:!0})),d(i.CALL_TRACKS_REMOVED,{callId:t,trackIds:[...p.localTracks,...p.remoteTracks]}),d(i.CALL_STATE_CHANGE,{callId:t,previous:{state:p.state,localHold:p.localHold,remoteHold:p.remoteHold},error:e}))}}}},96051:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,ClickToCallRequests:a}=e,i=n.getLogger("CLICKTOCALL");return{clickToCall:async function(e,n,s){const{dispatch:c}=t;if(c(r.clickToCall(e,n,s)),!n||!s){i.info("Missing call participant information");const e=new o.default({message:"callee and/or caller were not provided in CLICK_TO_CALL action payload",code:o.clickToCallCodes.MISSING_ARGS});throw c(r.clickToCallFinish({error:e})),e}try{const t=await a.clickToCall(e,n,s);return i.info("Successfully initiated a click to call."),c(r.clickToCallFinish({...t})),t}catch(e){throw c(r.clickToCallError(e)),e}}}};var r=a(n(59371)),o=a(n(75412));function a(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(a=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},96354:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{devices:(0,r.default)(e.devices,t),tracks:(0,a.default)(e.tracks,t),sessions:(0,i.default)(e.sessions,t),media:(0,o.default)(e.media,t),browser:(0,s.default)(e.browser,t)}};var r=c(n(7249)),o=c(n(50774)),a=c(n(70272)),i=c(n(18133)),s=c(n(2178));function c(e){return e&&e.__esModule?e:{default:e}}},96448:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxyState=function(e){return(0,o.default)(e.proxy)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},96493:(e,t,n)=>{var r=n(76853),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,i=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,n,r,o){t.push(r?o.replace(a,"$1"):n||e)}),t});e.exports=i},96576:(e,t,n)=>{var r=n(23212),o=n(59756),a=n(43316),i=n(65111),s=n(49460),c=n(65568);e.exports=function(e,t,n,l){var u=-1,d=o,f=!0,p=e.length,g=[],_=t.length;if(!p)return g;n&&(t=i(t,s(n))),l?(d=a,f=!1):t.length>=200&&(d=c,f=!1,t=new r(t));e:for(;++u<p;){var E=e[u],y=null==n?E:n(E);if(E=l||0!==E?E:0,f&&y==y){for(var S=_;S--;)if(t[S]===y)continue e;g.push(E)}else d(t,y,l)||g.push(E)}return g}},96638:(e,t,n)=>{var r=n(1386),o=n(19770),a=n(68250);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var i=n.__data__;if(!o||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(i)}return n.set(e,t),this.size=n.size,this}},96893:(e,t,n)=>{"use strict";var r=n(5234);e.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},96949:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{proxyPeer:e,config:t,id:n}=this;return{id:n,config:t,localDesc:e.localDescription,signalingState:e.signalingState,localTracks:e.localTracks,remoteTracks:e.remoteTracks,senderTracks:e.senderTracks}}},97002:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{mediaDevices:t,peerConnection:n}=(0,g.getWebRTCSupportCapabilities)();if(!t||!n)return void E.warn("Calls are not supported on this platform due to lack of WebRTC support. Media APIs will not be available.");const c=(0,g.default)();return e.factory("WebRTCMediaOperations",a.default),e.factory("WebRTCLogOperations",i.default),e.factory("WebRTCOperations",s.default),e.factory("WebRTC",()=>c.managers),e.defer(y),e.defer(S),e.defer(l.default),{api:o.default,middleware:u.default,name:"webrtc",reducer:r.default.reducer,cleanup:d.default}},t.initLogLevel=S,t.initWebrtc=y;var r=_(n(80678)),o=_(n(94733)),a=_(n(39781)),i=_(n(80994)),s=_(n(66784)),c=n(66446),l=_(n(76207)),u=_(n(3480)),d=_(n(74582));n(20939);var f=n(69932),p=n(98530),g=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(37654));function _(e){return e&&e.__esModule?e:{default:e}}const E=f.logManager.getLogger("WEBRTC");function y(e){const{logManager:t,context:n}=e,r=t.getLogger("WEBRTC"),o=(0,g.getBrowserDetails)();r.info(`Browser details: ${o.browser}, version ${o.version}.`),n.dispatch(c.miscActions.setBrowserDetails(o))}function S(e){const{context:t,WebRTCLogOperations:n}=e,r=(0,p.getLevel)(t.getState(),"WEBRTC");n.updateLogLevel({payload:{WEBRTC:r}})}},97034:(e,t,n)=>{var r=n(46285);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},97082:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_HMAC_TOKEN=t.SET_CREDENTIALS_FINISH=t.SET_CREDENTIALS_ERROR=void 0;const n="@@KANDY/";t.SET_CREDENTIALS_FINISH=n+"SET_CREDENTIALS_FINISH",t.SET_CREDENTIALS_ERROR=n+"SET_CREDENTIALS_ERROR",t.UPDATE_HMAC_TOKEN=n+"UPDATE_HMAC_TOKEN"},97107:(e,t,n)=>{"use strict";var r=n(5613),o=n(79117),a=n(40646),i=n(76208),s="WebAssembly",c=o[s],l=7!==new Error("e",{cause:7}).cause,u=function(e,t){var n={};n[e]=i(e,t,l),r({global:!0,constructor:!0,arity:1,forced:l},n)},d=function(e,t){if(c&&c[e]){var n={};n[e]=i(s+"."+e,t,l),r({target:s,stat:!0,constructor:!0,arity:1,forced:l},n)}};u("Error",function(e){return function(t){return a(e,this,arguments)}}),u("EvalError",function(e){return function(t){return a(e,this,arguments)}}),u("RangeError",function(e){return function(t){return a(e,this,arguments)}}),u("ReferenceError",function(e){return function(t){return a(e,this,arguments)}}),u("SyntaxError",function(e){return function(t){return a(e,this,arguments)}}),u("TypeError",function(e){return function(t){return a(e,this,arguments)}}),u("URIError",function(e){return function(t){return a(e,this,arguments)}}),d("CompileError",function(e){return function(t){return a(e,this,arguments)}}),d("LinkError",function(e){return function(t){return a(e,this,arguments)}}),d("RuntimeError",function(e){return function(t){return a(e,this,arguments)}})},97186:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(["group","groupCollapsed"].includes(e.method))return void console[e.method](...e.messages);if("groupEnd"===e.method)return void console.groupEnd();const{prefix:t,style:n,payload:r}=function(e){const{timestamp:t,level:n}=e,r=`${t} - ACTION - ${n}`;let o,[a,i]=e.messages,s="";return a.includes("state")?o=`${r} - ${a.toUpperCase()}`:a.includes("ADDED")||a.includes("DELETED")||a.includes("ARRAY")?(o=`${e.messages[0]}: ${e.messages[2]}`,s=e.messages[1],i=e.messages[3]):a.includes("CHANGED")?(o=`${e.messages[0]}: ${e.messages[2]}`,s=e.messages[1],i=`${e.messages[3]} ${e.messages[4]} ${e.messages[5]}`):a.includes("no diff")?(o=`${r} - NO DIFF`,i=""):o=`${r} - ${i.type} - ${a}`,{prefix:o,style:s,payload:i}}(e);console[e.method](t,n,r)},n(62234)},97236:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.getStats",()=>({local:{validate:o.default,localOffer:(0,r.default)(e.container)}})),e.factory("Callstack.operations.getStats",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.GET_STATS,isLocal:!0,stages:e.container.Callstack.stages.getStats.local},{callId:n})}}})};var r=i(n(18129)),o=i(n(85524)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},97350:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},97509:(e,t,n)=>{"use strict";var r=n(14188),o=n(64466),a=n(74530),i=n(14798);e.exports=function(e,t,n,s){s||(s={});var c=s.enumerable,l=void 0!==s.name?s.name:t;if(r(n)&&a(n,l,s),s.global)c?e[t]=n:i(t,n);else{try{s.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:o.f(e,t,{value:n,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},97528:(e,t,n)=>{"use strict";var r=n(42937),o=n(33243).has,a=n(87173),i=n(55558),s=n(37032),c=n(88500);e.exports=function(e){var t=r(this),n=i(e);if(a(t)<n.size)return!1;var l=n.getIterator();return!1!==s(l,function(e){if(!o(t,e))return c(l,"normal",!1)})}},97611:(e,t,n)=>{"use strict";var r=n(76744),o=Math.min;e.exports=function(e){var t=r(e);return t>0?o(t,9007199254740991):0}},97679:(e,t,n)=>{var r=n(92673)("partial",n(50578));r.placeholder=n(22991),e.exports=r},97706:e=>{e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},97769:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t){await a(e,t)}},t.signalling=a;var r=n(40481),o=n(77126);async function a(e,t){const{context:n,CallRequests:a,CallstackWebrtc:i,logManager:s}=e,c=s.getLogger("CALL",t);c.info("Rejecting incoming call.");const l=(0,r.getCallById)(n.getState(),t),u={id:t,wrtcsSessionId:l.wrtcsSessionId};try{await a.rejectSession(u)}catch(e){throw c.info("Failed to reject call."),e}await i.closeCall(l.webrtcSessionId),c.info(`Finished rejecting call. Changing to ${o.CALL_STATES.ENDED}.`)}},97856:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{emitEvent:t,SubManager:n}=e;return async function(){n.clear(o.CHANGE_REASONS.LOST_CONNECTION),t(r.SUB_CHANGE,{reason:o.CHANGE_REASONS.LOST_CONNECTION})}};var r=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(34889)),o=n(22191)},97935:(e,t,n)=>{var r=n(44139);e.exports=function(e){return r(e).replace(/\s(\w)/g,function(e,t){return t.toUpperCase()})}},97969:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAPI",{enumerable:!0,get:function(){return r.default}}),t.name=void 0,Object.defineProperty(t,"reducer",{enumerable:!0,get:function(){return o.default}});var r=a(n(64025)),o=a(n(52692));function a(e){return e&&e.__esModule?e:{default:e}}t.name="callHistory"},98016:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{nativePeer:t,config:n,log:i}=this;return i.info("Creating local offer."),delete e.mediaDirections,new Promise((s,c)=>{t.createOffer(e).then(t=>{const c=[];n.trickleIceMode===r.PEER.TRICKLE_ICE.NONE&&c.push(a.removeTrickleIce),n.removeBundling&&c.push(a.removeBundling),e.mediaDirections&&c.push((0,a.changeMediaDirection)(e.mediaDirections)),c.length>0&&(t.sdp=(0,o.runPipeline)(c,t.sdp,{type:t.type,endpoint:r.PEER.ENDPOINT.LOCAL})),i.info("Finished creating local offer."),s(t)}).catch(c)})},n(69375);var r=n(54507),o=n(28851),a=n(75424)},98060:(e,t,n)=>{"use strict";var r=n(79117).navigator,o=r&&r.userAgent;e.exports=o?String(o):""},98087:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},98121:(e,t,n)=>{var r=n(3766)(Object.keys,Object);e.exports=r},98257:(e,t,n)=>{"use strict";var r=n(80831),o=n(88088);e.exports=function(e,t){r(t)&&"cause"in t&&o(e,"cause",t.cause)}},98307:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){const{context:u,emitEvent:d,logManager:f}=e;let p,g=!1,_=!1;async function E(e,l){g=!0;const p=e.wrtcsSessionId,_=f.getLogger("CALL",e?e.id:void 0);if(t.tracker.resume(),e.state!==r.CALL_STATES.ENDED){if(l.sdp||49!==l.code||!l.retryAfter){if(l.customParameters){const t=l.customParameters,n=t.map(e=>e.name);_.debug(`Received custom parameters as part of the Call: ${n}.`),u.dispatch(a.callActions.customParametersReceived(e.id,{customParameters:t})),d(i.CUSTOM_PARAMETERS,{callId:e.id,customParameters:t})}return await async function(e,r){const o=f.getLogger("CALL",e.id),a=(0,s.getMediaState)(e);let i;o.info(`Processing remote response for local ${t.type} operation. Call state: ${e.state}, MediaState: ${a}.`);try{i=await n.remoteAnswer(e,r)}catch(e){throw t.reportEvent.endEvent(e),t.tracker.finish(e),e}return t.reportEvent.endEvent(),t.tracker.finish(),i}(e,l)}await async function(e,r){const a=f.getLogger("CALL",e.id);a.debug(`Response indicates an error scenario (${r.message}). Aborting operation.`);const i=new c.default({message:"Operation failed on remote side; aborting local operation by reverting it.",code:c.callCodes.GENERIC_ERROR});if(t.reportEvent.endEvent(i),n.rollback){let r;if(t.type===o.OPERATIONS.ADD_MEDIA||t.type===o.OPERATIONS.ADD_BASIC_MEDIA){const n=e.currentOperations.find(e=>e.id===t.id);n&&n.operationData&&(r=n.operationData)}try{await n.rollback(e.webrtcSessionId,r)}catch(e){throw a.info(`Rollbacking back local ${t.type} failed. Error: ${e.message}`),t.tracker.finish(e),e}}t.tracker.finish(i)}(e,l)}else _.info("Update response for ended call. Ignoring.",{wrtcsSessionId:p})}return{start:async function(e,r){if(t.status!==o.OP_STATUS.NOT_STARTED)throw new Error("Flow cannot be started a second time.");return async function(e,r){if(t.tracker.start(),n.validate){const o=n.validate(u.getState(),e,...r);if(o)throw t.reportEvent.endEvent(o),t.tracker.finish(o),o}try{const a=await n.localOffer(e,...r);if(t.tracker.update(a),await n.signalling(e,a),_=!0,p&&t.status===o.OP_STATUS.PENDING){const{params:t,promise:n}=p,r=(0,l.getCallById)(u.getState(),e);p=void 0,E(r,t).then(n.resolve).catch(n.reject)}return a}catch(e){if(t.status===o.OP_STATUS.FINISHED||g)return;throw t.reportEvent.endEvent(e),t.tracker.finish(e),e}}(e,r)},receiveResponse:async function(e,n){if(t.status!==o.OP_STATUS.PENDING)throw new Error("Cannot receive response in current state.");if(g||p)throw new Error("Negotiations should only receive one response.");if(_)return E(e,n);{const r=f.getLogger("CALL",e.id);return r.debug(`Received negotiation answer for local ${t.type} too early; delaying processing.`),Promise.race([new Promise((e,t)=>{p={params:n,promise:{resolve:e,reject:t}}}),new Promise(e=>setTimeout(()=>{p&&e(new Error("timeout"))},500))]).then(t=>t&&"timeout"===t.message?(r.debug("Timed-out waiting for signaling response; attempting to process."),p=void 0,E(e,n)):t)}}}},n(97107),n(81045),n(45950),n(84915);var r=n(77126),o=n(59090),a=n(35),i=u(n(51918)),s=n(73520),c=u(n(75412)),l=n(40481);function u(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(u=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}},98415:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return async function(t,n,r){await u(e,t,n,r)}},t.localChanges=u,n(81045),n(45950);var r=n(35),o=n(40481),a=l(n(51918)),i=n(59090),s=l(n(75412)),c=n(81997);function l(e,t){if("function"==typeof WeakMap)var n=new WeakMap,r=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var o,a,i={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return i;if(o=t?r:n){if(o.has(e))return o.get(e);o.set(e,i)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((a=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(a.get||a.set)?o(i,t,a):i[t]=e[t]);return i})(e,t)}async function u(e,t,n,l){const{context:u,WebRTC:d,emitEvent:f,Notifications:p,logManager:g}=e,_=g.getLogger("CALL",t);_.info("Replacing call audio with file media.");const E=(0,o.getCallById)(u.getState(),t),y=await d.sessionManager.get(E.webrtcSessionId);if(!y)throw new s.default({code:s.callCodes.INVALID_STATE,message:"Call's WebRTC session not found."});let S;try{S=await y.insertAudio(n),_.info("Audio file has started to play.");const e=E.currentOperations.find(e=>e.isLocal&&e.type===i.OPERATIONS.PLAY_AUDIO);u.dispatch(r.callActions.operationUpdate(t,i.OP_TRANSITIONS.PLAY_AUDIO,!0,{transition:i.OP_TRANSITIONS.UPDATE,eventId:e.eventId})),f(a.CALL_OPERATION,{callId:t,isLocal:!0,operation:i.OPERATIONS.PLAY_AUDIO,transition:i.OP_TRANSITIONS.UPDATE,previous:{operations:i.OPERATIONS.PLAY_AUDIO,status:i.OP_STATUS.ONGOING}})}catch(e){let t;switch(_.info("Failed to start playing audio file."),e.message){case"Failed to play audio file.":t=s.callCodes.INVALID_PARAM;break;case"No valid local audio track found to insert audio file on.":t=s.callCodes.NOT_SUPPORTED;break;default:t=s.callCodes.UNKNOWN_ERROR}throw new s.default({code:t,message:e.message})}l({duration:S});const v=1e3*S+3e3;let h;try{h=await p.takeAction(e=>e.type===c.SESSION_AUDIO_ENDED&&e.payload.id===y.id,v)}catch(e){throw _.info("No response from audio file after expected duration; timing-out."),new s.default({code:s.callCodes.STATE_DESYNC,message:"Play audio file operation timed-out."})}if(h.error)throw _.info("Audio file encountered an error while playing."),new s.default({code:s.callCodes.UNKNOWN_ERROR,message:"Encountered error while playing audio file."});_.info("Audio file has finished playing.")}},98530:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLevel=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DEFAULT";return(0,o.default)(e).logs[t]},t.getTypes=function(e){const t=(0,o.default)(e);return Object.keys(t.logs)};var r,o=(r=n(89321))&&r.__esModule?r:{default:r}},98657:(e,t,n)=>{"use strict";var r=n(74418),o=n(73168),a=n(9304),i=n(64466);e.exports=function(e,t,n){for(var s=o(t),c=i.f,l=a.f,u=0;u<s.length;u++){var d=s[u];r(e,d)||n&&r(n,d)||c(e,d,l(t,d))}}},98788:e=>{var t=/\{\n\/\* \[wrapped with (.+)\] \*/,n=/,? & /;e.exports=function(e){var r=e.match(t);return r?r[1].split(n):[]}},98876:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const t=r.logManager.getLogger("Manager","Session"),n=new Map,s=new i.default;return{create:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=new o.default((0,a.v4)(),e,t);return r.once("session:ended",e=>{n.delete(e),s.emit("session:removed",e)}),n.set(r.id,r),s.emit("session:new",r.id),r},get:function(e){const r=n.get(e);return r||t.debug(`No session found with ID: ${e}.`),r},getAll:function(){return Array.from(n.values())},getWithMedia:function(e,r,o){const a=n.get(e);if(a)return new Promise((e,t)=>{a.addNewMedia(r,o).then(t=>{e({session:a,medias:t})}).catch(t)});t.debug(`No session found with ID: ${e}.`)},on:function(){return s.on(...arguments)},once:function(){return s.once(...arguments)},off:function(){return s.off(...arguments)}}};var r=n(40271),o=s(n(68529)),a=n(84596),i=s(n(19353));function s(e){return e&&e.__esModule?e:{default:e}}},98880:(e,t,n)=>{var r=n(57923);e.exports=function(e){return function(t){return r(t,e)}}},98953:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.value("logManager",d.logManager),e.constant("API_LOG_TAG",d.API_LOG_TAG),e.factory("LogsOperations",i.default);const n=d.logManager.getLogger("LOGS");t=(0,s.default)(t,n),d.logManager.setLevel(t.logLevel),t.handler&&d.logManager.setHandler(t.handler),Object.values(d.logManager.getLoggers()).forEach(e=>{e.setLevel(t.logLevel),t.handler&&e.setHandler(t.handler)});const f={api:r.createAPI,capabilities:["logs"],name:r.name,reducer:r.reducer};return u.logLevels[t.logLevel]<=u.logLevels.INFO&&!1!==t.logActions&&(f.middleware=(0,c.default)(t)),e.defer(function(e){const{context:n,WebRTC:i}=e;if(n.dispatch((0,l.update)(t,r.name)),n.dispatch(o.levelsChanged((0,a.getLevelMap)(d.logManager))),i){const e=i.logs;t.handler&&e.setHandler(t.handler),Object.values(e.getLoggers()).forEach(e=>{e.setLevel(t.logLevel),t.handler&&e.setHandler(t.handler)})}}),f},n(81045),n(5350);var r=n(50804),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(45183)),a=n(28445),i=f(n(28088)),s=f(n(15375)),c=f(n(26672)),l=n(87310),u=n(44413),d=n(69932);function f(e){return e&&e.__esModule?e:{default:e}}n(14849)},99047:(e,t,n)=>{const r=n(59246),o=n(30802),a={};Object.keys(r).forEach(e=>{a[e]={},Object.defineProperty(a[e],"channels",{value:r[e].channels}),Object.defineProperty(a[e],"labels",{value:r[e].labels});const t=o(e);Object.keys(t).forEach(n=>{const r=t[n];a[e][n]=function(e){const t=function(...t){const n=t[0];if(null==n)return n;n.length>1&&(t=n);const r=e(t);if("object"==typeof r)for(let e=r.length,t=0;t<e;t++)r[t]=Math.round(r[t]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}(r),a[e][n].raw=function(e){const t=function(...t){const n=t[0];return null==n?n:(n.length>1&&(t=n),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)})}),e.exports=a},99051:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,CallstackWebrtc:n,CallRequests:c,TimerTracker:l,logManager:u,emitEvent:d}=e;let f,p,g;function _(e){return Date.now()-e}function E(e,t){return{triggerTimeout:new Promise((t,n)=>{f=l.create("call",t,4e3,{id:e.id,params:[{timeout:4e3}]})}),triggerAudit:new Promise((n,r)=>{l.clear(f);const o=e.isCaller?t:e.wrtcsSessionId;c.auditCall({wrtcsSessionId:o,isAnonymous:e.isAnonymous,account:e.account,id:e.id}).then(e=>{n({audit:{status:e.status}})}).catch(e=>{let t="Retry";e&&42===e.code&&(t="Closed"),n({audit:{status:t,error:e}})})})}}async function y(e,c,l,u){const f=(0,r.getOptions)(t.getState());if(p=Math.max(1e4,f.callAuditTimer),g=Math.min(5e3,.45*f.callAuditTimer),"Retry"===e.audit.status){const t=e.audit.error,n=_(l);return u.debug(`Call audit failed, caused by ${t.message} (${t.code}); will retry failed audit for call in: ${g-n} ms`),g-n}if("Closed"===e.audit.status){u.info(`Ending audit loop and Call due to Closed status. Changing to ${o.CALL_STATES.ENDED}.`),await n.closeCall(c.webrtcSessionId);const l=(0,r.getCallById)(t.getState(),c.id);return l.state!==o.CALL_STATES.ENDED&&l.state!==o.CALL_STATES.CANCELLED&&(t.dispatch(a.callActions.endCallFinish(c.id,{isLocal:!0,transition:{statusCode:9909,reasonText:"Call has ended due to call audit failure."}})),d(i.CALL_OPERATION,{callId:c.id,isLocal:!0,operation:s.OPERATIONS.END,transition:s.OP_TRANSITIONS.FINISH,previous:{},error:void 0}),d(i.CALL_TRACKS_REMOVED,{callId:c.id,trackIds:[...c.localTracks,...c.remoteTracks]}),d(i.CALL_STATE_CHANGE,{callId:c.id,previous:{state:c.state,localHold:c.localHold,remoteHold:c.remoteHold},transition:{statusCode:9909,reasonText:"Call has ended due to call audit failure."},error:e.audit.error})),-1}{const t=_(l);return u.debug(`Call audit status is ${e.audit.status}. Will retry in ${p-t} ms`),p-t}}async function S(e,n){const a=u.getLogger("CALL",e||""),i=(0,r.getCallById)(t.getState(),e);if([o.CALL_STATES.ENDED,o.CALL_STATES.CANCELLED].includes(i.state))return void a.info(`Call is in ${i.state} state; stopping audit loop.`);const s=E(i,n),c=Date.now();return Promise.race([s.triggerTimeout,s.triggerAudit]).then(e=>e.timeout?(a.debug("Audit request timed out, retrying in 1 second."),1e3):e.audit?y(e,i,c,a):(a.debug("Audit loop encountered an unknown scenario; ending."),-1)).then(t=>{t>=0&&l.create("call",function(){S(e,n)},t,{id:e})})}return{sendCallAudit:async function(e,n){const o=n.wrtcsSessionId,a=(0,r.getCallById)(t.getState(),e),i=u.getLogger("CALL",a?e:"");a?(i.info("Starting audit loop for new call."),S(e,o)):i.debug(`Call ${e} not found; no audit loop needed.`)},prepareRaceTriggers:E,handleAuditResult:y,repeatingTask:S,errorDelay:g,successDelay:p}},n(62234);var r=n(40481),o=n(77126),a=n(35),i=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),s=n(59090)},99306:e=>{e.exports=function(){return[]}},99475:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n}=e;return function(e,i){const s=i.reasonText||o.COMPLEX_OPERATION_MESSAGES.CONSULTATIVE_TRANSFER_FAILURE,c=i.statusCode||o.STATUS_CODES.CONSULTATIVE_TRANSFER_FAILURE,l=n.getLogger("CALL",e.id);l.info("Received call operation failed notice; handling.",{wrtcsSessionId:e.wrtcsSessionId}),l.debug(`Processing as a local consultative transfer failure (${c}).`),l.info("Finished handling call operation failed notice.");const u=new a.default({message:`Consultative transfer operation failed: ${s} (${c})`,code:a.callCodes.GENERIC_ERROR});return t.dispatch(r.callActions.consultativeTransferFinish(e.id,{error:u,transition:{reasonText:s,statusCode:c}})),u}};var r=n(35),o=n(77126),a=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(75412))},99568:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.factory("Callstack.stages.forward",()=>({local:{validate:o.default,localOffer:()=>{},signalling:(0,r.default)(e.container)}})),e.factory("Callstack.operations.forward",()=>{const t=e.container.Callstack.models.Update;return{local:function(n){return t.instance({type:a.OPERATIONS.FORWARD_CALL,isLocal:!0,stages:e.container.Callstack.stages.forward.local},{callId:n})}}})};var r=i(n(59221)),o=i(n(47336)),a=n(59090);function i(e){return e&&e.__esModule?e:{default:e}}},99644:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NOTI_RECEIVED=t.NOTI_ERROR=t.NOTI_CHANGE=void 0,t.NOTI_CHANGE="notifications:change",t.NOTI_ERROR="notifications:error",t.NOTI_RECEIVED="notification:received"},99808:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{context:t,logManager:n,emitEvent:s,CallstackWebrtc:c,CallReporter:l}=e;return async function(e,u){const d=n.getLogger("CALL",e.id),f=l.getReport(e.id),p=e.currentOperations.find(e=>e.isLocal&&e.type===a.OPERATIONS.HOLD),g=f.getEvent(p.eventId).addEvent(i.REPORT_EVENTS.PROCESS_MEDIA_REMOTE);g.addData("operation",i.REPORTER_OPERATION_EVENTS_MAP.HOLD);try{const t={sessionId:e.webrtcSessionId,answerSdp:u.sdp};await c.receivedAnswer(t,e)}catch(n){throw t.dispatch(r.callActions.endCallFinish(e.id,{error:n})),s(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),g.setError(n),g.endEvent(),n}d.info(`Finished processing remote response to local ${p.type}. Changing state based on operation.`),t.dispatch(r.callActions.holdCallFinish(e.id,{...p.operationData,localTracks:e.localTracks,remoteTracks:e.remoteTracks})),s(o.CALL_TRACKS_REMOVED,{callId:e.id,trackIds:[...e.localTracks,...e.remoteTracks]}),s(o.CALL_STATE_CHANGE,{callId:e.id,previous:{state:e.state,localHold:e.localHold,remoteHold:e.remoteHold}}),g.endEvent()}},n(81045),n(45950);var r=n(35),o=function(e){if("function"==typeof WeakMap){var t=new WeakMap;new WeakMap}return function(e){if(e&&e.__esModule)return e;var n,r,o={__proto__:null,default:e};if(null===e||"object"!=typeof e&&"function"!=typeof e)return o;if(n=t){if(n.has(e))return n.get(e);n.set(e,o)}for(const t in e)"default"!==t&&{}.hasOwnProperty.call(e,t)&&((r=(n=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,t))&&(r.get||r.set)?n(o,t,r):o[t]=e[t]);return o}(e)}(n(51918)),a=n(59090),i=n(84581)},99819:(e,t,n)=>{"use strict";var r=n(5613),o=n(39944),a=n(38873),i=n(44977),s=n(3770),c=n(96002),l=n(88500),u=n(20850)("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(e){s(this);try{i(e)}catch(e){l(this,"throw",e)}if(u)return o(u,this,e);var t=c(this),n=0;return a(t,function(t,r){if(e(t,n++))return r(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},99890:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const{proxyPeer:e,trackManager:t}=this;return e.getSenders().filter(e=>Boolean(e.track)).map(e=>t.get(e.track.id)).filter(e=>e&&"live"===e.getState().state&&e.getStream().active)},n(81045),n(30163),n(84915)},99917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n(14782)),o=a(n(72668));function a(e){return e&&e.__esModule?e:{default:e}}var i=(0,r.default)("v3",48,o.default);t.default=i},99978:(e,t,n)=>{"use strict";var r=n(42937),o=n(33243).has,a=n(87173),i=n(55558),s=n(29800),c=n(37032),l=n(88500);e.exports=function(e){var t=r(this),n=i(e);if(a(t)<=n.size)return!1!==s(t,function(e){if(n.includes(e))return!1},!0);var u=n.getIterator();return!1!==c(u,function(e){if(o(t,e))return l(u,"normal",!1)})}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(81948)})());
//# sourceMappingURL=webrtc.js.map